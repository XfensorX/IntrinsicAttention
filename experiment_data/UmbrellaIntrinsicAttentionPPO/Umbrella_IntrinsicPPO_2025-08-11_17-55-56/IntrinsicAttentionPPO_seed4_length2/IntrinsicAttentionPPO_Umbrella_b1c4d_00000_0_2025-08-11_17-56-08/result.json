{"timers": {"training_iteration": 10.610484375036322, "restore_env_runners": 1.200009137392044e-05, "training_step": 10.610331790987402, "env_runner_sampling_timer": 1.7178652500733733, "learner_update_timer": 8.684758499963209, "synch_weights": 0.001444249995984137}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.066781341492969e-05, "listify_data_for_vector_env": 1.1221151321744733e-05, "get_actions": 4.9920235166012196e-05, "tensor_to_numpy": 1.6295060042274272e-05, "remove_single_ts_time_rank_from_batch": 1.2468208192256185e-05, "un_batch_to_individual_items": 6.9869875838307425e-06}}, "connector_pipeline_timer": 0.00013565222927446418}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 4.389580216648943e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.578006957488571e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.900288572624965e-06, "numpy_to_tensor": 1.4207627364471528e-05, "add_time_dim_to_batch_and_zero_pad": 7.661473653631535e-06, "batch_individual_items": 1.3208368608787844e-05, "add_observations_from_episodes_to_batch": 3.12594043252686e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_step_timer": 1.5770938909626082e-05, "num_episodes_lifetime": 31375.0, "sample": 0.0069452376292357945, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.38, "weights_seq_no": 0.0, "module_episode_returns_mean": {"default_policy": 3.38}, "episode_duration_sec_mean": 0.005528576124925168, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0007022407296027202, "agent_episode_returns_mean": {"default_agent": 3.38}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 0.00010054195908224321, "num_env_steps_sampled_lifetime_throughput": 2897.450333575798}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.17085412505548447, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009194875019602478, "add_observations_from_episodes_to_batch": 0.0008479580283164978, "add_columns_from_episodes_to_train_batch": 0.04219679208472371, "add_time_dim_to_batch_and_zero_pad": 0.10256083309650421, "add_states_from_episodes_to_batch": 0.003491541021503508, "batch_individual_items": 0.01236470800358802, "numpy_to_tensor": 6.591598503291607e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 35964, "diff_num_grad_updates_vs_sampler_policy": 6.0, "vf_explained_var": 0.0028580427169799805, "weights_seq_no": 6.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.387237548828125, "total_loss": 0.20405499637126923, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.26340532302856445, "mean_kl_loss": 5.5641780818405095e-06, "entropy": 0.6881213188171387, "policy_loss": -9.021673758979887e-05}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 35964, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 53094.770696633524}}}, "default_policy": {"weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -9.261145169148222e-05, "total_loss": 0.20407138764858246, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 5994, "use_intrinsic_rewards": 0.0, "vf_explained_var": -0.003084421157836914, "vf_loss_unclipped": 38.558204650878906, "num_trainable_parameters": 16595, "vf_loss": 0.26342928409576416, "mean_kl_loss": 5.951690582151059e-06, "entropy": 0.6881096959114075, "curr_kl_coeff": 0.08079196512699127, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 717.4638398918537}, "IntrinsicAttentionMask": [[[0.33732345700263977, 0.33151766657829285, 0.33115893602371216], [0.3363024592399597, 0.3319825530052185, 0.3317149877548218], [0.3362388610839844, 0.33201152086257935, 0.33174967765808105]], [[0.33049148321151733, 0.33422601222991943, 0.33528247475624084], [0.3300410211086273, 0.33436694741249084, 0.3355920910835266], [0.32991454005241394, 0.33440646529197693, 0.3356790244579315]], [[0.3313453793525696, 0.3349541127681732, 0.3337005376815796], [0.33072325587272644, 0.33546245098114014, 0.3338143527507782], [0.3309384882450104, 0.3352864384651184, 0.33377501368522644]], [[0.33396148681640625, 0.3326270580291748, 0.3334115147590637], [0.3338976204395294, 0.332698792219162, 0.3334035873413086], [0.3339351713657379, 0.3326565623283386, 0.3334082365036011]], [[0.34153297543525696, 0.3264535367488861, 0.33201348781585693], [0.3392066955566406, 0.3283955156803131, 0.33239781856536865], [0.34007593989372253, 0.3276689648628235, 0.332255095243454]], [[0.3200283646583557, 0.36282825469970703, 0.31714335083961487], [0.2985609173774719, 0.40961289405822754, 0.2918262779712677], [0.3215212821960449, 0.3595395088195801, 0.3189392685890198]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 5994, "num_module_steps_trained_lifetime_throughput": 717.4752427720813}, "__all_modules__": {"num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3770.5827039533265, "num_module_steps_trained_throughput": 31306884.612369962, "num_module_steps_trained_lifetime_throughput": 12414521.460141793}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.686587226625239e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2514619164679206e-05, "add_time_dim_to_batch_and_zero_pad": 8.18114656562572e-06, "batch_individual_items": 1.2618579187503983e-05, "add_observations_from_episodes_to_batch": 3.3516283647035555e-06, "add_states_from_episodes_to_batch": 2.7591845120042978e-06}}, "connector_pipeline_timer": 6.426314292754974e-05}, "num_episodes_lifetime": 20, "sample": 0.11692283302545547, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 11.5, "num_env_steps_sampled_lifetime": 5400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001266030537104431, "timers": {"connectors": {"get_actions": 4.44252878251781e-05, "remove_single_ts_time_rank_from_batch": 1.2713233205762755e-05, "normalize_and_clip_actions": 9.284753738510897e-06, "tensor_to_numpy": 1.7055587831692423e-05, "un_batch_to_individual_items": 6.696578300211161e-06, "listify_data_for_vector_env": 1.0540822199811904e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.15}, "episode_duration_sec_mean": 0.005314689496299252, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 2.15}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_step_timer": 1.559129583635895e-05, "num_env_steps_sampled": 400, "episode_return_mean": 2.15, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 1.0, "env_reset_timer": 0.0005437079817056656}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-04-25", "timestamp": 1754928265, "time_this_iter_s": 10.741642951965332, "time_total_s": 10.741642951965332, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.741642951965332, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 38.7875, "ram_util_percent": 80.73124999999999}}
{"timers": {"training_iteration": 10.613785006705438, "restore_env_runners": 1.194759039208293e-05, "training_step": 10.613631508906838, "env_runner_sampling_timer": 1.7157910104829353, "learner_update_timer": 8.688472114964389, "synch_weights": 0.001444285416509956, "restore_eval_env_runners": 4.3665990233421326e-05, "evaluation_iteration": 0.12878858391195536, "synch_eval_env_connectors": 0.000174832995980978, "synch_env_connectors": 4.375004209578037e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.051835093755999e-06, "listify_data_for_vector_env": 1.0450027708058599e-05, "get_actions": 3.820494498207497e-05, "tensor_to_numpy": 1.5103969768248578e-05, "remove_single_ts_time_rank_from_batch": 1.1853198097282788e-05, "un_batch_to_individual_items": 6.607718245988947e-06}}, "connector_pipeline_timer": 0.00011667468445161469}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.115077219354187e-05, "env_to_module_connector": {"connector_pipeline_timer": 5.875541332727166e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.707579281826928e-06, "numpy_to_tensor": 1.2334682307859786e-05, "add_time_dim_to_batch_and_zero_pad": 6.825458885894483e-06, "batch_individual_items": 1.2263402029698705e-05, "add_observations_from_episodes_to_batch": 2.7743419521603243e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3812148109618748e-05, "num_episodes_lifetime": 500.0, "sample": 0.005762554711408548, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.8600000000000008, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "episode_duration_sec_mean": 0.005198426806367935, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03403085040886888, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.4017694079860706e-05, "num_env_steps_sampled_lifetime_throughput": 3290.0690514137705}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17240176046499983, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009189622518606484, "add_observations_from_episodes_to_batch": 0.0008477696985937655, "add_columns_from_episodes_to_train_batch": 0.04218457750394009, "add_time_dim_to_batch_and_zero_pad": 0.10255933559616096, "add_states_from_episodes_to_batch": 0.003493453951086849, "batch_individual_items": 0.013929783013882115, "numpy_to_tensor": 6.606390583328903e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 71928, "diff_num_grad_updates_vs_sampler_policy": 11.0, "vf_explained_var": 0.0028447508811950684, "weights_seq_no": 12.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.509681701660156, "total_loss": 0.2039516568183899, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2633931040763855, "mean_kl_loss": 1.1995132808806375e-05, "entropy": 0.6876727342605591, "policy_loss": -0.0001857842580648139}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 71928, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 52792.3884207007}}}, "default_policy": {"weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.00019155941845383495, "total_loss": 0.20398592948913574, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 11988, "use_intrinsic_rewards": 0.0, "vf_explained_var": -0.0017781257629394531, "vf_loss_unclipped": 38.650142669677734, "num_trainable_parameters": 16595, "vf_loss": 0.263445645570755, "mean_kl_loss": 1.2870456885138992e-05, "entropy": 0.6876543760299683, "curr_kl_coeff": 0.040395982563495636, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 716.0547582092144}, "IntrinsicAttentionMask": [[[0.33732345700263977, 0.33151766657829285, 0.33115893602371216], [0.3363024592399597, 0.3319825530052185, 0.3317149877548218], [0.3362388610839844, 0.33201152086257935, 0.33174967765808105]], [[0.33398523926734924, 0.33697548508644104, 0.32903918623924255], [0.33411216735839844, 0.33770596981048584, 0.3281819224357605], [0.33377009630203247, 0.3357534408569336, 0.33047640323638916]], [[0.33006560802459717, 0.32965022325515747, 0.34028416872024536], [0.3301105797290802, 0.3297008275985718, 0.34018853306770325], [0.32897377014160156, 0.3284226655960083, 0.34260353446006775]], [[0.33237332105636597, 0.3359522521495819, 0.3316744863986969], [0.3322124779224396, 0.33638978004455566, 0.33139768242836], [0.33240485191345215, 0.3358662724494934, 0.33172884583473206]], [[0.3317210078239441, 0.3325875699520111, 0.3356913924217224], [0.33163395524024963, 0.3325471580028534, 0.33581894636154175], [0.33132392168045044, 0.33240288496017456, 0.3362731635570526]], [[0.3217943608760834, 0.3668142557144165, 0.31139135360717773], [0.308113157749176, 0.4040347635746002, 0.28785207867622375], [0.32501617074012756, 0.35768747329711914, 0.3172963559627533]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 11988, "num_module_steps_trained_lifetime_throughput": 716.0659924455118}, "__all_modules__": {"num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 23976, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3763.1759962840256, "num_module_steps_trained_throughput": 30855071.36590843, "num_module_steps_trained_lifetime_throughput": 12405670.599622086}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.217716715929534e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2678595485751061e-05, "add_time_dim_to_batch_and_zero_pad": 7.101025060356369e-06, "batch_individual_items": 1.269036445541217e-05, "add_observations_from_episodes_to_batch": 3.0281204624766193e-06, "add_states_from_episodes_to_batch": 2.6986317602763186e-06}}, "connector_pipeline_timer": 6.0679565953431275e-05}, "num_episodes_lifetime": 40, "sample": 0.11694851261447184, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 10400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011887502063329611, "timers": {"connectors": {"get_actions": 3.846325268257696e-05, "remove_single_ts_time_rank_from_batch": 1.2138942159413322e-05, "normalize_and_clip_actions": 8.07956835128952e-06, "tensor_to_numpy": 1.587072651449965e-05, "un_batch_to_individual_items": 6.8091523135600015e-06, "listify_data_for_vector_env": 1.1096007188810775e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.65}, "episode_duration_sec_mean": 0.005384336522547528, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "module_episode_returns_mean": {"default_policy": 2.65}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_step_timer": 1.4777654858555097e-05, "num_env_steps_sampled": 400, "episode_return_mean": 2.65, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 2.0, "env_reset_timer": 0.0005418609024491161, "time_between_sampling": 10.988527041045018}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-04-36", "timestamp": 1754928276, "time_this_iter_s": 11.071380853652954, "time_total_s": 21.813023805618286, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.813023805618286, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.318749999999994, "ram_util_percent": 79.825}}
{"timers": {"training_iteration": 10.620244217888509, "restore_env_runners": 1.189186351839453e-05, "training_step": 10.620089630067698, "env_runner_sampling_timer": 1.7145973953772453, "learner_update_timer": 8.69573227131511, "synch_weights": 0.001453615062334575, "restore_eval_env_runners": 4.3623490491881966e-05, "evaluation_iteration": 0.12878041640273294, "synch_eval_env_connectors": 0.00017461799667216837, "synch_env_connectors": 4.384174244478345e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.346049374571056e-06, "listify_data_for_vector_env": 1.0925275033569005e-05, "get_actions": 4.117926342449095e-05, "tensor_to_numpy": 1.5864148745198232e-05, "remove_single_ts_time_rank_from_batch": 1.2309253575531605e-05, "un_batch_to_individual_items": 6.825894231750646e-06}}, "connector_pipeline_timer": 0.00012260314236493212}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.30732168919966e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.117898615502104e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.792217186605478e-06, "numpy_to_tensor": 1.3112113523319567e-05, "add_time_dim_to_batch_and_zero_pad": 7.177310688154589e-06, "batch_individual_items": 1.2775009290927098e-05, "add_observations_from_episodes_to_batch": 2.9111857960746e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4645862190688735e-05, "num_episodes_lifetime": -30375.0, "sample": 0.005771226446653288, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.62, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": 3.62}, "episode_duration_sec_mean": 0.005476748848799614, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03845685930726386, "agent_episode_returns_mean": {"default_agent": 3.62}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.140768849940267e-05, "num_env_steps_sampled_lifetime_throughput": 3157.40570588826}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17259797411046457, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009194203372625633, "add_observations_from_episodes_to_batch": 0.0008492190818535164, "add_columns_from_episodes_to_train_batch": 0.042214876309095414, "add_time_dim_to_batch_and_zero_pad": 0.10269780515044694, "add_states_from_episodes_to_batch": 0.003497739831288345, "batch_individual_items": 0.013944340592750815, "numpy_to_tensor": 6.744243713328615e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 107892, "diff_num_grad_updates_vs_sampler_policy": 16.0, "vf_explained_var": 0.002988874912261963, "weights_seq_no": 18.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.091426849365234, "total_loss": 0.2040971964597702, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2634064257144928, "mean_kl_loss": 9.656169822847005e-06, "entropy": 0.6869597434997559, "policy_loss": -5.13540071551688e-05}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 107892, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 52246.79149103614}}}, "default_policy": {"weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -5.207553112995811e-05, "total_loss": 0.204057514667511, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 17982, "use_intrinsic_rewards": 0.0, "vf_explained_var": 0.0009818077087402344, "vf_loss_unclipped": 38.088714599609375, "num_trainable_parameters": 16595, "vf_loss": 0.263357937335968, "mean_kl_loss": 9.840225175139494e-06, "entropy": 0.6869549751281738, "curr_kl_coeff": 0.020197991281747818, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 713.4201664791012}, "IntrinsicAttentionMask": [[[0.3257259726524353, 0.33727580308914185, 0.3369981646537781], [0.3190632164478302, 0.34073272347450256, 0.34020400047302246], [0.3192198574542999, 0.34065142273902893, 0.34012871980667114]], [[0.3340008854866028, 0.3325827419757843, 0.3334163725376129], [0.33393704891204834, 0.33265450596809387, 0.3334084749221802], [0.33397459983825684, 0.3326122760772705, 0.33341312408447266]], [[0.32799890637397766, 0.3338475525379181, 0.33815351128578186], [0.32697793841362, 0.3339404761791229, 0.3390815556049347], [0.3262384533882141, 0.3340066969394684, 0.3397548794746399]], [[0.33187136054039, 0.33663201332092285, 0.33149662613868713], [0.3307398557662964, 0.3391807973384857, 0.3300793468952179], [0.33196085691452026, 0.33643022179603577, 0.3316088914871216]], [[0.3355369567871094, 0.32986435294151306, 0.3345986306667328], [0.33520686626434326, 0.33038330078125, 0.3344098627567291], [0.33548274636268616, 0.3299495577812195, 0.334567666053772]], [[0.31613653898239136, 0.3649049401283264, 0.31895849108695984], [0.2852701246738434, 0.42243698239326477, 0.29229292273521423], [0.3142571747303009, 0.3683771789073944, 0.3173656165599823]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 17982, "num_module_steps_trained_lifetime_throughput": 713.4311082915281}, "__all_modules__": {"num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 35964, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3749.3278381731348, "num_module_steps_trained_throughput": 30187243.357655115, "num_module_steps_trained_lifetime_throughput": 12401917.980536276}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 7.335796585569343e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.291821682429268e-05, "add_time_dim_to_batch_and_zero_pad": 1.573916304546504e-05, "batch_individual_items": 2.910494865232356e-05, "add_observations_from_episodes_to_batch": 6.228320634339497e-06, "add_states_from_episodes_to_batch": 5.228143382045424e-06}}, "connector_pipeline_timer": 0.00013017929652056005}, "num_episodes_lifetime": 60, "sample": 0.11929163456779207, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 15400, "module_to_env_connector": {"connector_pipeline_timer": 0.00026929220330713005, "timers": {"connectors": {"get_actions": 0.00010287487764193764, "remove_single_ts_time_rank_from_batch": 2.3162343030295784e-05, "normalize_and_clip_actions": 1.688184827249945e-05, "tensor_to_numpy": 3.645369878841166e-05, "un_batch_to_individual_items": 1.2958830920808208e-05, "listify_data_for_vector_env": 2.364108167063906e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.15}, "episode_duration_sec_mean": 0.008715834096074104, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "module_episode_returns_mean": {"default_policy": 2.15}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_step_timer": 3.9992984884760124e-05, "num_env_steps_sampled": 400, "episode_return_mean": 2.15, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 3.0, "env_reset_timer": 0.0006428639640682377, "time_between_sampling": 10.992011352294357}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-04-47", "timestamp": 1754928287, "time_this_iter_s": 11.669548988342285, "time_total_s": 33.48257279396057, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.48257279396057, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.34375, "ram_util_percent": 80.48124999999999}}
{"timers": {"training_iteration": 10.626233290709928, "restore_env_runners": 1.1854614888085053e-05, "training_step": 10.62607761293701, "env_runner_sampling_timer": 1.716749080173329, "learner_update_timer": 8.69711852610216, "synch_weights": 0.0014515122520185543, "restore_eval_env_runners": 4.443725462770089e-05, "evaluation_iteration": 0.13155293389848666, "synch_eval_env_connectors": 0.00017500723692355678, "synch_env_connectors": 4.494083381723613e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.954649286463792e-06, "listify_data_for_vector_env": 1.249586762711059e-05, "get_actions": 5.383441443655659e-05, "tensor_to_numpy": 1.8526653445734434e-05, "remove_single_ts_time_rank_from_batch": 1.3906202416816712e-05, "un_batch_to_individual_items": 7.6165203960686085e-06}}, "connector_pipeline_timer": 0.00014699069322025076}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 4.048652249641458e-05, "env_to_module_connector": {"connector_pipeline_timer": 7.271277896962342e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.2620198136698998e-06, "numpy_to_tensor": 1.6429217807134604e-05, "add_time_dim_to_batch_and_zero_pad": 8.584973061610421e-06, "batch_individual_items": 1.5000289212861859e-05, "add_observations_from_episodes_to_batch": 3.3628742189600147e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.7851895437850715e-05, "num_episodes_lifetime": -61250.0, "sample": 0.0066983489778963835, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.8600000000000008, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "episode_duration_sec_mean": 0.0065552343451418, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04095787629364027, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.597217082965936e-05, "num_env_steps_sampled_lifetime_throughput": 2780.154909486098}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17486140936931993, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009231545088164973, "add_observations_from_episodes_to_batch": 0.0008505548110378441, "add_columns_from_episodes_to_train_batch": 0.042834422545444104, "add_time_dim_to_batch_and_zero_pad": 0.10426749834842712, "add_states_from_episodes_to_batch": 0.0035181524333187846, "batch_individual_items": 0.013957713016320138, "numpy_to_tensor": 6.873468315030913e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 143856, "diff_num_grad_updates_vs_sampler_policy": 21.0, "vf_explained_var": 0.0029909610748291016, "weights_seq_no": 24.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.11076354980469, "total_loss": 0.20376507937908173, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2634025812149048, "mean_kl_loss": 2.7867567041539587e-05, "entropy": 0.6861239671707153, "policy_loss": -0.00038468424463644624}, "intrinsic_reward_module": {"weights_seq_no": 24.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 143856, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 756000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 287712, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 51529.540656792524}}}, "default_policy": {"weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.0003988038224633783, "total_loss": 0.2037089467048645, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 23976, "use_intrinsic_rewards": 0.0, "vf_explained_var": 0.0009642839431762695, "vf_loss_unclipped": 38.11404800415039, "num_trainable_parameters": 16595, "vf_loss": 0.263353556394577, "mean_kl_loss": 3.004832979058847e-05, "entropy": 0.686090350151062, "curr_kl_coeff": 0.010098995640873909, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 710.4108476936759}, "IntrinsicAttentionMask": [[[0.3336942791938782, 0.33333319425582886, 0.3329724967479706], [0.33368852734565735, 0.33333319425582886, 0.3329782485961914], [0.3336828052997589, 0.33333322405815125, 0.3329840302467346]], [[0.33049148321151733, 0.33422601222991943, 0.33528247475624084], [0.33004099130630493, 0.33436691761016846, 0.3355920612812042], [0.32991454005241394, 0.33440646529197693, 0.3356790244579315]], [[0.33194851875305176, 0.3314448595046997, 0.33660659193992615], [0.33196428418159485, 0.33146634697914124, 0.33656933903694153], [0.33180364966392517, 0.33124783635139465, 0.33694854378700256]], [[0.33237332105636597, 0.3359522521495819, 0.3316744863986969], [0.3322124779224396, 0.33638978004455566, 0.33139768242836], [0.33240485191345215, 0.3358662724494934, 0.33172881603240967]], [[0.33324575424194336, 0.33411628007888794, 0.3326379656791687], [0.33324098587036133, 0.3341585695743561, 0.3326004445552826], [0.3332490622997284, 0.33408668637275696, 0.33266422152519226]], [[0.34311142563819885, 0.3156101107597351, 0.34127843379974365], [0.31433823704719543, 0.3681240975856781, 0.3175376355648041], [0.34131482243537903, 0.31885647773742676, 0.33982861042022705]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 23976, "num_module_steps_trained_lifetime_throughput": 710.421412874253}, "__all_modules__": {"num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 47952, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3733.509607209864, "num_module_steps_trained_throughput": 29427305.849841684, "num_module_steps_trained_lifetime_throughput": 12400329.85628145}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.198895368908291e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2383077706213608e-05, "add_time_dim_to_batch_and_zero_pad": 6.98404064985463e-06, "batch_individual_items": 1.2822189628382482e-05, "add_observations_from_episodes_to_batch": 2.882707082511562e-06, "add_states_from_episodes_to_batch": 2.7551962599528816e-06}}, "connector_pipeline_timer": 6.0117093553630006e-05}, "num_episodes_lifetime": 80, "sample": 0.11925243614206546, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 20400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011752804673816587, "timers": {"connectors": {"get_actions": 3.745257178774858e-05, "remove_single_ts_time_rank_from_batch": 1.231234215303485e-05, "normalize_and_clip_actions": 8.09636901817999e-06, "tensor_to_numpy": 1.553798235006384e-05, "un_batch_to_individual_items": 6.773779080641929e-06, "listify_data_for_vector_env": 1.0761524612246823e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_duration_sec_mean": 0.00785294848465128, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "module_episode_returns_mean": {"default_policy": 1.15}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_step_timer": 1.4395637765422388e-05, "num_env_steps_sampled": 400, "episode_return_mean": 1.15, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 4.0, "env_reset_timer": 0.000639976573743741, "time_between_sampling": 10.995116068350931}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-04-59", "timestamp": 1754928299, "time_this_iter_s": 11.346900939941406, "time_total_s": 44.82947373390198, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.82947373390198, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.7375, "ram_util_percent": 82.23125}}
{"timers": {"training_iteration": 10.628352782382384, "restore_env_runners": 1.1790228639377747e-05, "training_step": 10.628196300967593, "env_runner_sampling_timer": 1.715289977291763, "learner_update_timer": 8.70051467542049, "synch_weights": 0.0014484612994457994, "restore_eval_env_runners": 4.427205300808418e-05, "evaluation_iteration": 0.13148552788979873, "synch_eval_env_connectors": 0.00017569008412736005, "synch_env_connectors": 4.5020533116767185e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.285981807592894e-06, "listify_data_for_vector_env": 1.0822645054476479e-05, "get_actions": 4.030773144065509e-05, "tensor_to_numpy": 1.555132824257773e-05, "remove_single_ts_time_rank_from_batch": 1.2058717517856025e-05, "un_batch_to_individual_items": 6.731156018413486e-06}}, "connector_pipeline_timer": 0.00012064660019621448}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.2498418976323714e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.063405761527672e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7770205456027717e-06, "numpy_to_tensor": 1.2911161355674248e-05, "add_time_dim_to_batch_and_zero_pad": 7.066466897958124e-06, "batch_individual_items": 1.2719656690302005e-05, "add_observations_from_episodes_to_batch": 2.854905687041751e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4328053395500856e-05, "num_episodes_lifetime": -92125.0, "sample": 0.006102942639150038, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.019999999999998, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "episode_duration_sec_mean": 0.005363911168649792, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03852480031610282, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.039870230792096e-05, "num_env_steps_sampled_lifetime_throughput": 3142.8801597731303}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17488915694480764, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009273745057351377, "add_observations_from_episodes_to_batch": 0.0008509609326474299, "add_columns_from_episodes_to_train_batch": 0.04282267956900648, "add_time_dim_to_batch_and_zero_pad": 0.10427246711515034, "add_states_from_episodes_to_batch": 0.003521534658971366, "batch_individual_items": 0.013946010056586942, "numpy_to_tensor": 6.880150736989104e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 179820, "diff_num_grad_updates_vs_sampler_policy": 26.0, "vf_explained_var": 0.0029140710830688477, "weights_seq_no": 30.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.3648567199707, "total_loss": 0.20398138463497162, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2633606791496277, "mean_kl_loss": 2.1564788767136633e-05, "entropy": 0.6854593753814697, "policy_loss": -0.0001357376459054649}, "intrinsic_reward_module": {"weights_seq_no": 30.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 179820, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 945000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 359640, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 50699.006163110054}}}, "default_policy": {"weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.00013793881225865334, "total_loss": 0.20394505560398102, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 29970, "use_intrinsic_rewards": 0.0, "vf_explained_var": -0.0003477334976196289, "vf_loss_unclipped": 38.454280853271484, "num_trainable_parameters": 16595, "vf_loss": 0.26332104206085205, "mean_kl_loss": 2.218290501332376e-05, "entropy": 0.6854481101036072, "curr_kl_coeff": 0.0050494978204369545, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 706.9980253351491}, "IntrinsicAttentionMask": [[[0.3270823657512665, 0.33868029713630676, 0.3342374265193939], [0.3215881288051605, 0.3434291183948517, 0.3349827527999878], [0.32366544008255005, 0.34162813425064087, 0.3347064256668091]], [[0.33433473110198975, 0.3390057682991028, 0.32665953040122986], [0.3344581127166748, 0.3397369384765625, 0.3258048892021179], [0.3341253697872162, 0.33778244256973267, 0.3280922472476959]], [[0.33448994159698486, 0.3339824378490448, 0.3315277099609375], [0.3344767689704895, 0.33397504687309265, 0.33154812455177307], [0.3344130516052246, 0.33393940329551697, 0.3316476345062256]], [[0.3306243419647217, 0.334184467792511, 0.3351912200450897], [0.3301737308502197, 0.3343254327774048, 0.3355008065700531], [0.33004727959632874, 0.33436498045921326, 0.3355877697467804]], [[0.33085957169532776, 0.33218643069267273, 0.3369540274143219], [0.3307724893093109, 0.3321457505226135, 0.33708176016807556], [0.33046239614486694, 0.33200082182884216, 0.3375368118286133]], [[0.3407233655452728, 0.3167575001716614, 0.3425191342830658], [0.3215913474559784, 0.3593822419643402, 0.3190264403820038], [0.34203895926475525, 0.31379058957099915, 0.3441705107688904]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 29970, "num_module_steps_trained_lifetime_throughput": 707.0081619359466}, "__all_modules__": {"num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 59940, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3715.5703647910623, "num_module_steps_trained_throughput": 28625407.664284904, "num_module_steps_trained_lifetime_throughput": 12388490.11933721}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.5469976483280535e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3508701975691893e-05, "add_time_dim_to_batch_and_zero_pad": 7.311374635857419e-06, "batch_individual_items": 1.3296645806239412e-05, "add_observations_from_episodes_to_batch": 3.0538406426179416e-06, "add_states_from_episodes_to_batch": 2.797271146518342e-06}}, "connector_pipeline_timer": 6.297048970100788e-05}, "num_episodes_lifetime": 100, "sample": 0.11983177511056758, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 25400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001277825503105383, "timers": {"connectors": {"get_actions": 4.3649312518957315e-05, "remove_single_ts_time_rank_from_batch": 1.2726870493964407e-05, "normalize_and_clip_actions": 8.500032467247117e-06, "tensor_to_numpy": 1.6688394718716378e-05, "un_batch_to_individual_items": 7.027931022571208e-06, "listify_data_for_vector_env": 1.137191124207563e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.95}, "episode_duration_sec_mean": 0.007880262106191367, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "module_episode_returns_mean": {"default_policy": 0.95}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_step_timer": 1.559666836743565e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.95, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 5.0, "env_reset_timer": 0.0006392263981725892, "time_between_sampling": 10.993911792247891}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-05-10", "timestamp": 1754928310, "time_this_iter_s": 11.02910304069519, "time_total_s": 55.85857677459717, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.85857677459717, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 37.94375, "ram_util_percent": 82.225}}
{"timers": {"training_iteration": 10.62939862996948, "restore_env_runners": 1.1767746171519417e-05, "training_step": 10.629240896708271, "env_runner_sampling_timer": 1.7137034229383472, "learner_update_timer": 8.703079899075922, "synch_weights": 0.0014501029372995153, "restore_eval_env_runners": 4.394058245200081e-05, "evaluation_iteration": 0.13204748302049507, "synch_eval_env_connectors": 0.0001755515122560121, "synch_env_connectors": 4.52495296977344e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.21822726291684e-06, "listify_data_for_vector_env": 1.0682555752305116e-05, "get_actions": 3.987280875798892e-05, "tensor_to_numpy": 1.5423418960071484e-05, "remove_single_ts_time_rank_from_batch": 1.2055917495182357e-05, "un_batch_to_individual_items": 6.683554909523841e-06}}, "connector_pipeline_timer": 0.00011959943976894582}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.2277930965145234e-05, "env_to_module_connector": {"connector_pipeline_timer": 5.987816206532432e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7353390282228154e-06, "numpy_to_tensor": 1.2622853957912847e-05, "add_time_dim_to_batch_and_zero_pad": 6.950950800353141e-06, "batch_individual_items": 1.2612259022263879e-05, "add_observations_from_episodes_to_batch": 2.810886124382164e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4125199183073975e-05, "num_episodes_lifetime": -123000.0, "sample": 0.0057592419975093815, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.420000000000002, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": 4.420000000000002}, "episode_duration_sec_mean": 0.0053320633289404215, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03845832547263351, "agent_episode_returns_mean": {"default_agent": 4.420000000000002}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.4556801990196765e-05, "num_env_steps_sampled_lifetime_throughput": 3209.880887181881}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17483436287565401, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009271170526146458, "add_observations_from_episodes_to_batch": 0.0008517888239900176, "add_columns_from_episodes_to_train_batch": 0.04280131069435983, "add_time_dim_to_batch_and_zero_pad": 0.10425107244436585, "add_states_from_episodes_to_batch": 0.0035229055630258293, "batch_individual_items": 0.013934240786289038, "numpy_to_tensor": 6.888849237665839e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 215784, "diff_num_grad_updates_vs_sampler_policy": 31.0, "vf_explained_var": 0.0029102563858032227, "weights_seq_no": 36.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.36762619018555, "total_loss": 0.20398114621639252, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2634028196334839, "mean_kl_loss": 1.4089030628383625e-05, "entropy": 0.6847936511039734, "policy_loss": -0.0001686396572040394}, "intrinsic_reward_module": {"weights_seq_no": 36.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 215784, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1134000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 431568, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 49807.7652583626}}}, "default_policy": {"weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.00017359154298901558, "total_loss": 0.2039027214050293, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 35964, "use_intrinsic_rewards": 0.0, "vf_explained_var": -0.0007117986679077148, "vf_loss_unclipped": 38.4625358581543, "num_trainable_parameters": 16595, "vf_loss": 0.26331132650375366, "mean_kl_loss": 1.492864430474583e-05, "entropy": 0.6847736239433289, "curr_kl_coeff": 0.0025247489102184772, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 703.3705113328732}, "IntrinsicAttentionMask": [[[0.3284511864185333, 0.33591267466545105, 0.335636168718338], [0.325679749250412, 0.33737823367118835, 0.33694204688072205], [0.3257811367511749, 0.3373245894908905, 0.33689427375793457]], [[0.33232590556144714, 0.3360811769962311, 0.3315928876399994], [0.33216503262519836, 0.3365188241004944, 0.33131611347198486], [0.3323574960231781, 0.33599522709846497, 0.3316473066806793]], [[0.33448994159698486, 0.3339824378490448, 0.3315277099609375], [0.3344767987728119, 0.33397504687309265, 0.33154815435409546], [0.3344130516052246, 0.3339393734931946, 0.3316476345062256]], [[0.33187782764434814, 0.3337913751602173, 0.3343307673931122], [0.3314264416694641, 0.3339330554008484, 0.3346404731273651], [0.33129969239234924, 0.3339728116989136, 0.3347274363040924]], [[0.34153297543525696, 0.3264535367488861, 0.33201348781585693], [0.3392066955566406, 0.3283955156803131, 0.33239781856536865], [0.34007593989372253, 0.3276689648628235, 0.33225512504577637]], [[0.34664928913116455, 0.30923083424568176, 0.3441199064254761], [0.31807422637939453, 0.36124539375305176, 0.32068032026290894], [0.3448673486709595, 0.3124416768550873, 0.34269097447395325]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 35964, "num_module_steps_trained_lifetime_throughput": 703.380491315261}, "__all_modules__": {"num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 71928, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3696.5024581462417, "num_module_steps_trained_throughput": 27786291.473603167, "num_module_steps_trained_lifetime_throughput": 12351706.66720061}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.3493689799729665e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2723043892770129e-05, "add_time_dim_to_batch_and_zero_pad": 7.093251761299956e-06, "batch_individual_items": 1.2676860156035642e-05, "add_observations_from_episodes_to_batch": 2.902148061314706e-06, "add_states_from_episodes_to_batch": 2.7224619933557313e-06}}, "connector_pipeline_timer": 6.0270059498134464e-05}, "num_episodes_lifetime": 120, "sample": 0.1198481961095937, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 30400, "module_to_env_connector": {"connector_pipeline_timer": 0.00012065453467207697, "timers": {"connectors": {"get_actions": 4.005547299235352e-05, "remove_single_ts_time_rank_from_batch": 1.2411946456034929e-05, "normalize_and_clip_actions": 8.159668307718494e-06, "tensor_to_numpy": 1.567775400055873e-05, "un_batch_to_individual_items": 6.787870899522795e-06, "listify_data_for_vector_env": 1.077686256824776e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.45}, "episode_duration_sec_mean": 0.007911168345017358, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "module_episode_returns_mean": {"default_policy": -0.45}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_step_timer": 1.470699286130211e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.45, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 6.0, "env_reset_timer": 0.0006364316342264025, "time_between_sampling": 10.991670522665443}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-05-21", "timestamp": 1754928321, "time_this_iter_s": 10.867385864257812, "time_total_s": 66.72596263885498, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.72596263885498, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.25333333333333, "ram_util_percent": 82.25333333333334}}
{"timers": {"training_iteration": 10.62660292826068, "restore_env_runners": 1.1752159126280353e-05, "training_step": 10.626444169411219, "env_runner_sampling_timer": 1.7139919532993395, "learner_update_timer": 8.69991651591519, "synch_weights": 0.0014529044087090545, "restore_eval_env_runners": 4.3907426519447383e-05, "evaluation_iteration": 0.13204087444027426, "synch_eval_env_connectors": 0.00017573641703088908, "synch_env_connectors": 4.533452394163201e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.285876597853253e-06, "listify_data_for_vector_env": 1.0944563072523754e-05, "get_actions": 4.133483396697911e-05, "tensor_to_numpy": 1.589460236668201e-05, "remove_single_ts_time_rank_from_batch": 1.220468902259321e-05, "un_batch_to_individual_items": 6.790701735882484e-06}}, "connector_pipeline_timer": 0.0001227496934843232}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.298048924807735e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.101498342402663e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7697253589250093e-06, "numpy_to_tensor": 1.3130850932634917e-05, "add_time_dim_to_batch_and_zero_pad": 7.109474392454137e-06, "batch_individual_items": 1.2655770155293789e-05, "add_observations_from_episodes_to_batch": 2.884089686643737e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4551816285310215e-05, "num_episodes_lifetime": -153875.0, "sample": 0.005812106267565933, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.5400000000000005, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "episode_duration_sec_mean": 0.005457195198629051, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.038398301081973396, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.594279980958338e-05, "num_env_steps_sampled_lifetime_throughput": 3125.9007330501054}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17478760215692485, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009267762160949355, "add_observations_from_episodes_to_batch": 0.0008525155253508295, "add_columns_from_episodes_to_train_batch": 0.04278501883652723, "add_time_dim_to_batch_and_zero_pad": 0.10423213880957648, "add_states_from_episodes_to_batch": 0.0035265227566220517, "batch_individual_items": 0.013921601298959864, "numpy_to_tensor": 6.904752776264403e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 251748, "diff_num_grad_updates_vs_sampler_policy": 36.0, "vf_explained_var": 0.0028824210166931152, "weights_seq_no": 42.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.49153518676758, "total_loss": 0.20388785004615784, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2633572518825531, "mean_kl_loss": 1.4418407772609498e-05, "entropy": 0.6841592192649841, "policy_loss": -0.0002274498256156221}, "intrinsic_reward_module": {"weights_seq_no": 42.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 251748, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1323000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 503496, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 48893.07046300717}}}, "default_policy": {"weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.00023635930847376585, "total_loss": 0.20384354889392853, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 41958, "use_intrinsic_rewards": 0.0, "vf_explained_var": -0.00044846534729003906, "vf_loss_unclipped": 38.58726119995117, "num_trainable_parameters": 16595, "vf_loss": 0.26331469416618347, "mean_kl_loss": 1.562633042340167e-05, "entropy": 0.6841297745704651, "curr_kl_coeff": 0.0012623744551092386, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 700.1554701567662}, "IntrinsicAttentionMask": [[[0.3257259726524353, 0.33727580308914185, 0.3369981646537781], [0.3190632164478302, 0.34073272347450256, 0.34020400047302246], [0.3192198574542999, 0.34065142273902893, 0.34012871980667114]], [[0.3343725800514221, 0.3321652412414551, 0.3334621489048004], [0.3343087136745453, 0.33223697543144226, 0.33345428109169006], [0.33434629440307617, 0.3321947753429413, 0.33345890045166016]], [[0.33584293723106384, 0.33033645153045654, 0.3338206708431244], [0.3351697027683258, 0.33113881945610046, 0.33369144797325134], [0.3355969488620758, 0.33062946796417236, 0.33377358317375183]], [[0.33187782764434814, 0.3337913751602173, 0.3343307673931122], [0.3314264416694641, 0.3339330554008484, 0.3346404731273651], [0.33129969239234924, 0.3339728116989136, 0.3347274363040924]], [[0.3371471166610718, 0.33236995339393616, 0.33048295974731445], [0.33646252751350403, 0.3325440287590027, 0.3309934139251709], [0.3361895978450775, 0.3326133191585541, 0.3311971426010132]], [[0.3407233655452728, 0.316757470369339, 0.3425191342830658], [0.321591317653656, 0.359382301568985, 0.3190264105796814], [0.34203895926475525, 0.31379058957099915, 0.3441705107688904]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 41958, "num_module_steps_trained_lifetime_throughput": 700.1651819999136}, "__all_modules__": {"num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 83916, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3679.602039792011, "num_module_steps_trained_throughput": 26993414.302179836, "num_module_steps_trained_lifetime_throughput": 12333221.851042202}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.1303815313169566e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2126804183574167e-05, "add_time_dim_to_batch_and_zero_pad": 6.979168646744627e-06, "batch_individual_items": 1.2816848392372028e-05, "add_observations_from_episodes_to_batch": 2.8120432667175347e-06, "add_states_from_episodes_to_batch": 2.8920182968856885e-06}}, "connector_pipeline_timer": 6.003221191147217e-05}, "num_episodes_lifetime": 140, "sample": 0.11983248872858154, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 35400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011509620662291089, "timers": {"connectors": {"get_actions": 3.668715529973615e-05, "remove_single_ts_time_rank_from_batch": 1.205452385518293e-05, "normalize_and_clip_actions": 7.936991498006132e-06, "tensor_to_numpy": 1.5159281473863689e-05, "un_batch_to_individual_items": 6.624519720676506e-06, "listify_data_for_vector_env": 1.0620008993592644e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.65}, "episode_duration_sec_mean": 0.007896662906277925, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "module_episode_returns_mean": {"default_policy": -0.65}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_step_timer": 1.4286911544564736e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.65, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 7.0, "env_reset_timer": 0.0006334548174847874, "time_between_sampling": 10.985626019108517}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-05-31", "timestamp": 1754928331, "time_this_iter_s": 10.480041980743408, "time_total_s": 77.20600461959839, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.20600461959839, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.04, "ram_util_percent": 82.40666666666668}}
{"timers": {"training_iteration": 10.629099419817303, "restore_env_runners": 1.1694636827733933e-05, "training_step": 10.62893980187647, "env_runner_sampling_timer": 1.7173974850162734, "learner_update_timer": 8.698858277844996, "synch_weights": 0.0014536553645561007, "restore_eval_env_runners": 4.379752239748466e-05, "evaluation_iteration": 0.13199316652530294, "synch_eval_env_connectors": 0.000175745303795032, "synch_env_connectors": 4.538117086793019e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.302379498988277e-06, "listify_data_for_vector_env": 1.234854825912557e-05, "get_actions": 5.0626135355459154e-05, "tensor_to_numpy": 1.8209824806622004e-05, "remove_single_ts_time_rank_from_batch": 1.359537683199271e-05, "un_batch_to_individual_items": 7.5981787833037665e-06}}, "connector_pipeline_timer": 0.00014197066187557922}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 8.132034305604183e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.811581056938324e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.08375300297186e-06, "numpy_to_tensor": 1.5331681972612648e-05, "add_time_dim_to_batch_and_zero_pad": 8.044688429167532e-06, "batch_individual_items": 1.4214557507778637e-05, "add_observations_from_episodes_to_batch": 3.2114357506621644e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.77110112336028e-05, "num_episodes_lifetime": -184750.0, "sample": 0.006656873379377515, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.5400000000000005, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "episode_duration_sec_mean": 0.007184899480082093, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.035856754740690604, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.9324267125789523e-05, "num_env_steps_sampled_lifetime_throughput": 2960.8329882856597}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17481461988532654, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009268191619659758, "add_observations_from_episodes_to_batch": 0.0008522670396386951, "add_columns_from_episodes_to_train_batch": 0.042773634478219816, "add_time_dim_to_batch_and_zero_pad": 0.10424953992140264, "add_states_from_episodes_to_batch": 0.0035304846193661365, "batch_individual_items": 0.013938205695970426, "numpy_to_tensor": 6.927664155934613e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 287712, "diff_num_grad_updates_vs_sampler_policy": 41.0, "vf_explained_var": 0.002887547016143799, "weights_seq_no": 48.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.429969787597656, "total_loss": 0.2040787786245346, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.26339852809906006, "mean_kl_loss": 9.028711247083265e-06, "entropy": 0.6834961771965027, "policy_loss": -6.884104368509725e-05}, "intrinsic_reward_module": {"weights_seq_no": 48.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 287712, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1512000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 575424, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 47977.04422760107}}}, "default_policy": {"weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -6.958789163036272e-05, "total_loss": 0.2040065973997116, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 47952, "use_intrinsic_rewards": 0.0, "vf_explained_var": -0.00015175342559814453, "vf_loss_unclipped": 38.50741958618164, "num_trainable_parameters": 16595, "vf_loss": 0.26330867409706116, "mean_kl_loss": 9.305642379331402e-06, "entropy": 0.683487594127655, "curr_kl_coeff": 0.0006311872275546193, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 697.0780159533036}, "IntrinsicAttentionMask": [[[0.3336942791938782, 0.33333319425582886, 0.3329724967479706], [0.33368852734565735, 0.33333319425582886, 0.3329782485961914], [0.3336828052997589, 0.33333322405815125, 0.3329840302467346]], [[0.3317370116710663, 0.33693477511405945, 0.3313281834125519], [0.3306048512458801, 0.33948469161987305, 0.3299104869365692], [0.3318265676498413, 0.3367328941822052, 0.33144044876098633]], [[0.33005985617637634, 0.3336545526981354, 0.3362855613231659], [0.32903629541397095, 0.3337513208389282, 0.3372124135494232], [0.32829490303993225, 0.33382028341293335, 0.3378848433494568]], [[0.33237332105636597, 0.3359522521495819, 0.3316744863986969], [0.3322124779224396, 0.33638978004455566, 0.33139768242836], [0.33240485191345215, 0.3358662724494934, 0.33172881603240967]], [[0.33085957169532776, 0.33218643069267273, 0.3369540274143219], [0.3307724893093109, 0.3321457505226135, 0.33708176016807556], [0.33046239614486694, 0.33200082182884216, 0.3375368118286133]], [[0.3170467019081116, 0.3693820834159851, 0.3135712146759033], [0.29538631439208984, 0.41645777225494385, 0.2881559133529663], [0.31855547428131104, 0.36606812477111816, 0.315376341342926]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 47952, "num_module_steps_trained_lifetime_throughput": 697.0873959766483}, "__all_modules__": {"num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 95904, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3663.4246221662625, "num_module_steps_trained_throughput": 26232874.035935163, "num_module_steps_trained_lifetime_throughput": 12322856.568272758}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.063729826522714e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1927795113818562e-05, "add_time_dim_to_batch_and_zero_pad": 6.881349055903586e-06, "batch_individual_items": 1.2322374502766755e-05, "add_observations_from_episodes_to_batch": 2.8044431454173576e-06, "add_states_from_episodes_to_batch": 2.6371540459642525e-06}}, "connector_pipeline_timer": 5.828509397138393e-05}, "num_episodes_lifetime": 160, "sample": 0.11978452259131495, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 40400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011327766041601691, "timers": {"connectors": {"get_actions": 3.568771279232339e-05, "remove_single_ts_time_rank_from_batch": 1.2020634581367795e-05, "normalize_and_clip_actions": 7.903264306255536e-06, "tensor_to_numpy": 1.49144588618343e-05, "un_batch_to_individual_items": 6.542662088965972e-06, "listify_data_for_vector_env": 1.0436538975534931e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -1.05}, "episode_duration_sec_mean": 0.005867912044050172, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "module_episode_returns_mean": {"default_policy": -1.05}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_step_timer": 1.3910455338045801e-05, "num_env_steps_sampled": 400, "episode_return_mean": -1.05, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 8.0, "env_reset_timer": 0.0006307856790593134, "time_between_sampling": 10.984820333498337}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-05-42", "timestamp": 1754928342, "time_this_iter_s": 11.003451108932495, "time_total_s": 88.20945572853088, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 88.20945572853088, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 44.5625, "ram_util_percent": 82.55624999999999}}
{"timers": {"training_iteration": 10.629276988119214, "restore_env_runners": 1.1643940090801866e-05, "training_step": 10.629116139278057, "env_runner_sampling_timer": 1.7154781818363745, "learner_update_timer": 8.699459397146551, "synch_weights": 0.001454866731753381, "restore_eval_env_runners": 4.378162722093842e-05, "evaluation_iteration": 0.13191452070056495, "synch_eval_env_connectors": 0.00017613951091258664, "synch_env_connectors": 4.536065698709073e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.109918620721823e-06, "listify_data_for_vector_env": 1.050004022087398e-05, "get_actions": 3.8732209592715905e-05, "tensor_to_numpy": 1.5234412914112213e-05, "remove_single_ts_time_rank_from_batch": 1.1856549111669507e-05, "un_batch_to_individual_items": 6.590603663144745e-06}}, "connector_pipeline_timer": 0.0001174627219366987}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.1311069749223763e-05, "env_to_module_connector": {"connector_pipeline_timer": 5.908209323630882e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7081067124799985e-06, "numpy_to_tensor": 1.258121063614204e-05, "add_time_dim_to_batch_and_zero_pad": 6.891346944916969e-06, "batch_individual_items": 1.2249787570420075e-05, "add_observations_from_episodes_to_batch": 2.7932566544250603e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.381084868069277e-05, "num_episodes_lifetime": -215625.0, "sample": 0.006552855690966412, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.7, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": 3.7}, "episode_duration_sec_mean": 0.005226383502595125, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03636158563751438, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.779107558634305e-05, "num_env_steps_sampled_lifetime_throughput": 3253.39463553752}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1761995836865267, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009261575953686825, "add_observations_from_episodes_to_batch": 0.000854208119465006, "add_columns_from_episodes_to_train_batch": 0.04275490396257071, "add_time_dim_to_batch_and_zero_pad": 0.1042231828532219, "add_states_from_episodes_to_batch": 0.003532376433586813, "batch_individual_items": 0.015371241558534735, "numpy_to_tensor": 6.925262412414071e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 323676, "diff_num_grad_updates_vs_sampler_policy": 46.0, "vf_explained_var": 0.002881348133087158, "weights_seq_no": 54.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.47181701660156, "total_loss": 0.20398488640785217, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2633970081806183, "mean_kl_loss": 1.9503855583025143e-05, "entropy": 0.6826465725898743, "policy_loss": -0.0001645539450692013}, "intrinsic_reward_module": {"weights_seq_no": 54.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 323676, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1701000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 647352, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 47072.6762682543}}}, "default_policy": {"weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.00016775692347437143, "total_loss": 0.20391228795051575, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 53946, "use_intrinsic_rewards": 0.0, "vf_explained_var": -1.621246337890625e-05, "vf_loss_unclipped": 38.550193786621094, "num_trainable_parameters": 16595, "vf_loss": 0.2633119225502014, "mean_kl_loss": 2.0331386622274294e-05, "entropy": 0.6826279759407043, "curr_kl_coeff": 0.00031559361377730966, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 693.995265531884}, "IntrinsicAttentionMask": [[[0.3284511864185333, 0.33591267466545105, 0.335636168718338], [0.325679749250412, 0.33737823367118835, 0.33694204688072205], [0.3257811367511749, 0.3373245894908905, 0.33689427375793457]], [[0.33398523926734924, 0.33697548508644104, 0.32903918623924255], [0.33411216735839844, 0.33770596981048584, 0.3281819224357605], [0.33377009630203247, 0.3357534408569336, 0.33047640323638916]], [[0.32799890637397766, 0.3338475525379181, 0.33815351128578186], [0.32697793841362, 0.3339404761791229, 0.3390815556049347], [0.3262384533882141, 0.3340066969394684, 0.3397548794746399]], [[0.33258217573165894, 0.3353832960128784, 0.33203449845314026], [0.3324216902256012, 0.3358204960823059, 0.3317578136920929], [0.3326137363910675, 0.33529743552207947, 0.3320888876914978]], [[0.3386920690536499, 0.32373806834220886, 0.3375698924064636], [0.33718281984329224, 0.3264361321926117, 0.33638110756874084], [0.33858129382133484, 0.32393595576286316, 0.337482750415802]], [[0.31613656878471375, 0.36490488052368164, 0.3189585506916046], [0.2852702736854553, 0.4224367141723633, 0.29229307174682617], [0.3142572343349457, 0.368377149105072, 0.3173656761646271]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 53946, "num_module_steps_trained_lifetime_throughput": 694.0042783940091}, "__all_modules__": {"num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 107892, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3647.219353314656, "num_module_steps_trained_throughput": 25497332.76838376, "num_module_steps_trained_lifetime_throughput": 12306617.062049538}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.091538256084406e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1887694826591191e-05, "add_time_dim_to_batch_and_zero_pad": 6.99782869733668e-06, "batch_individual_items": 1.2371188870581229e-05, "add_observations_from_episodes_to_batch": 2.8355170766497805e-06, "add_states_from_episodes_to_batch": 2.6855422557936847e-06}}, "connector_pipeline_timer": 5.8683796090311986e-05}, "num_episodes_lifetime": 180, "sample": 0.11974250320594389, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 45400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011457631084171646, "timers": {"connectors": {"get_actions": 3.61802189144698e-05, "remove_single_ts_time_rank_from_batch": 1.2085219136823249e-05, "normalize_and_clip_actions": 7.88031465151415e-06, "tensor_to_numpy": 1.5057188928405032e-05, "un_batch_to_individual_items": 6.724396314827609e-06, "listify_data_for_vector_env": 1.0650172725541846e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.85}, "episode_duration_sec_mean": 0.0058683224499691275, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "module_episode_returns_mean": {"default_policy": -0.85}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.4053575236093667e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.85, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 9.0, "env_reset_timer": 0.0006276482317413795, "time_between_sampling": 10.981731312243049}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-05-53", "timestamp": 1754928353, "time_this_iter_s": 10.775004863739014, "time_total_s": 98.9844605922699, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.9844605922699, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.87333333333333, "ram_util_percent": 81.87333333333332}}
{"timers": {"training_iteration": 10.633256441988385, "restore_env_runners": 1.1587920241922026e-05, "training_step": 10.633095001636349, "env_runner_sampling_timer": 1.713623093347736, "learner_update_timer": 8.705247288175874, "synch_weights": 0.0014595605636923538, "restore_eval_env_runners": 4.3863391156494134e-05, "evaluation_iteration": 0.13184538465311682, "synch_eval_env_connectors": 0.00017796103598409445, "synch_env_connectors": 4.543204859406275e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.119704996192904e-06, "listify_data_for_vector_env": 1.059283494782828e-05, "get_actions": 3.8697912633832546e-05, "tensor_to_numpy": 1.5191363958288028e-05, "remove_single_ts_time_rank_from_batch": 1.1890861231511189e-05, "un_batch_to_individual_items": 6.629422028405376e-06}}, "connector_pipeline_timer": 0.0001176399219537316}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.15891628478913e-05, "env_to_module_connector": {"connector_pipeline_timer": 5.937632606138374e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7362974322417614e-06, "numpy_to_tensor": 1.2420815834062565e-05, "add_time_dim_to_batch_and_zero_pad": 6.92314423719427e-06, "batch_individual_items": 1.2466378762681508e-05, "add_observations_from_episodes_to_batch": 2.8106147444745874e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3947438272433574e-05, "num_episodes_lifetime": -246500.0, "sample": 0.00568543443160737, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.2200000000000006, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": 3.2200000000000006}, "episode_duration_sec_mean": 0.00525174736743793, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03746720403443034, "agent_episode_returns_mean": {"default_agent": 3.2200000000000006}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.008066333307245e-05, "num_env_steps_sampled_lifetime_throughput": 3263.817924295977}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1761301507596911, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009255439363699377, "add_observations_from_episodes_to_batch": 0.0008538802079179006, "add_columns_from_episodes_to_train_batch": 0.04273217867366816, "add_time_dim_to_batch_and_zero_pad": 0.10420587894418738, "add_states_from_episodes_to_batch": 0.0035363397495407406, "batch_individual_items": 0.015344637472856446, "numpy_to_tensor": 6.920509813763466e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 359640, "diff_num_grad_updates_vs_sampler_policy": 51.0, "vf_explained_var": 0.0028810501098632812, "weights_seq_no": 60.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.51306915283203, "total_loss": 0.20363973081111908, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.26335451006889343, "mean_kl_loss": 2.5786292098928243e-05, "entropy": 0.6815917491912842, "policy_loss": -0.0004792579566128552}, "intrinsic_reward_module": {"weights_seq_no": 60.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 359640, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1890000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 719280, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 46185.72007934211}}}, "default_policy": {"weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.0005027084844186902, "total_loss": 0.2035740166902542, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 59940, "use_intrinsic_rewards": 0.0, "vf_explained_var": 0.0002434849739074707, "vf_loss_unclipped": 38.58672332763672, "num_trainable_parameters": 16595, "vf_loss": 0.2633054852485657, "mean_kl_loss": 2.8468581149354577e-05, "entropy": 0.6815366744995117, "curr_kl_coeff": 0.00015779680688865483, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 690.5743163774539}, "IntrinsicAttentionMask": [[[0.3257259726524353, 0.33727580308914185, 0.3369981646537781], [0.3190632164478302, 0.34073272347450256, 0.34020400047302246], [0.3192198574542999, 0.34065142273902893, 0.34012871980667114]], [[0.33253487944602966, 0.3355121314525604, 0.33195292949676514], [0.33237430453300476, 0.3359494209289551, 0.3316762447357178], [0.33256644010543823, 0.3354262411594391, 0.3320073187351227]], [[0.33239421248435974, 0.33205172419548035, 0.3355540335178375], [0.33240997791290283, 0.3320731818675995, 0.33551687002182007], [0.3322497010231018, 0.33185485005378723, 0.33589544892311096]], [[0.33394762873649597, 0.3367602527141571, 0.3292921185493469], [0.33407488465309143, 0.33749058842658997, 0.3284344971179962], [0.33373185992240906, 0.3355383276939392, 0.33072978258132935]], [[0.33316516876220703, 0.32753270864486694, 0.33930209279060364], [0.3331948220729828, 0.32840022444725037, 0.3384050130844116], [0.3331317603588104, 0.3266049027442932, 0.34026333689689636]], [[0.32179442048072815, 0.36681419610977173, 0.3113914132118225], [0.3081132769584656, 0.4040345549583435, 0.2878522276878357], [0.32501620054244995, 0.35768744349479675, 0.3172963857650757]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 59940, "num_module_steps_trained_lifetime_throughput": 690.5829127945804}, "__all_modules__": {"num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 119880, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3629.236846705305, "num_module_steps_trained_throughput": 24805098.438636076, "num_module_steps_trained_lifetime_throughput": 12304121.189534351}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.3529475776841254e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2858755832398857e-05, "add_time_dim_to_batch_and_zero_pad": 7.165524291632006e-06, "batch_individual_items": 1.2834194944900857e-05, "add_observations_from_episodes_to_batch": 2.9310796402781025e-06, "add_states_from_episodes_to_batch": 2.7228286118859653e-06}}, "connector_pipeline_timer": 6.147056163686727e-05}, "num_episodes_lifetime": 200, "sample": 0.11976891483380392, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 50400, "module_to_env_connector": {"connector_pipeline_timer": 0.00012157900593318692, "timers": {"connectors": {"get_actions": 4.0498802286282396e-05, "remove_single_ts_time_rank_from_batch": 1.2400455425500016e-05, "normalize_and_clip_actions": 8.183859066942053e-06, "tensor_to_numpy": 1.618924832497191e-05, "un_batch_to_individual_items": 6.8446548078160145e-06, "listify_data_for_vector_env": 1.0931928129538964e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.25}, "episode_duration_sec_mean": 0.005389243712415919, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "module_episode_returns_mean": {"default_policy": -0.25}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.5319936851388476e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.25, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 10.0, "env_reset_timer": 0.0006244004989122598, "time_between_sampling": 10.982482691620856}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-06-04", "timestamp": 1754928364, "time_this_iter_s": 11.163624048233032, "time_total_s": 110.14808464050293, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 110.14808464050293, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.887499999999996, "ram_util_percent": 82.11875}}
{"timers": {"training_iteration": 10.651802392148698, "restore_env_runners": 1.1534540933332032e-05, "training_step": 10.651639914119452, "env_runner_sampling_timer": 1.7159130265745086, "learner_update_timer": 8.721226480294714, "synch_weights": 0.001462418287693077, "restore_eval_env_runners": 4.387767803941619e-05, "evaluation_iteration": 0.13185268789682078, "synch_eval_env_connectors": 0.00018000392620890057, "synch_env_connectors": 4.541522852907992e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0459689167604421e-05, "listify_data_for_vector_env": 1.2845181566106938e-05, "get_actions": 5.267463272231061e-05, "tensor_to_numpy": 1.9055359525001112e-05, "remove_single_ts_time_rank_from_batch": 1.3528649971286243e-05, "un_batch_to_individual_items": 7.821962184380609e-06}}, "connector_pipeline_timer": 0.00014962578561691068}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 4.03937738028313e-05, "env_to_module_connector": {"connector_pipeline_timer": 7.310325405226903e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.2316431801278427e-06, "numpy_to_tensor": 1.673995296120483e-05, "add_time_dim_to_batch_and_zero_pad": 8.608228855893505e-06, "batch_individual_items": 1.5101341436435711e-05, "add_observations_from_episodes_to_batch": 3.598057064144569e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.8218325709150088e-05, "num_episodes_lifetime": -277375.0, "sample": 0.006519960455954272, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.66, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": 4.66}, "episode_duration_sec_mean": 0.006664045983459801, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03905674593789511, "agent_episode_returns_mean": {"default_agent": 4.66}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.9871399795638534e-05, "num_env_steps_sampled_lifetime_throughput": 2808.6767954513775}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17620880175239842, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009267387051002093, "add_observations_from_episodes_to_batch": 0.0008538022467475321, "add_columns_from_episodes_to_train_batch": 0.04280467938662764, "add_time_dim_to_batch_and_zero_pad": 0.10422422182514743, "add_states_from_episodes_to_batch": 0.003539405511949232, "batch_individual_items": 0.015317285267809774, "numpy_to_tensor": 6.935554716862627e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 395604, "diff_num_grad_updates_vs_sampler_policy": 56.0, "vf_explained_var": 0.0029510855674743652, "weights_seq_no": 66.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.255043029785156, "total_loss": 0.20380447804927826, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2633577585220337, "mean_kl_loss": 2.9066512070130557e-05, "entropy": 0.6800397038459778, "policy_loss": -0.0003199572383891791}, "intrinsic_reward_module": {"weights_seq_no": 66.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 395604, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2079000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 791208, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 45292.474510528125}}}, "default_policy": {"weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.0003291124012321234, "total_loss": 0.20375017821788788, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 65934, "use_intrinsic_rewards": 0.0, "vf_explained_var": 0.00024062395095825195, "vf_loss_unclipped": 38.29431915283203, "num_trainable_parameters": 16595, "vf_loss": 0.2633057236671448, "mean_kl_loss": 3.087788718403317e-05, "entropy": 0.6800020933151245, "curr_kl_coeff": 7.889840344432741e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 686.0852422586345}, "IntrinsicAttentionMask": [[[0.33549806475639343, 0.3351350426673889, 0.32936689257621765], [0.33546367287635803, 0.3351064622402191, 0.32942983508110046], [0.33491188287734985, 0.3346477448940277, 0.3304404020309448]], [[0.3317370116710663, 0.33693477511405945, 0.3313281834125519], [0.3306048512458801, 0.33948469161987305, 0.3299105167388916], [0.3318265676498413, 0.3367328941822052, 0.33144044876098633]], [[0.33411872386932373, 0.3337744474411011, 0.3321068286895752], [0.33410558104515076, 0.3337670862674713, 0.33212730288505554], [0.3340418338775635, 0.3337313234806061, 0.3322269022464752]], [[0.328871488571167, 0.33771437406539917, 0.3334141969680786], [0.3270350396633148, 0.3395288288593292, 0.33343613147735596], [0.3279215097427368, 0.338652104139328, 0.3334263265132904]], [[0.3332315981388092, 0.3295483887195587, 0.33722004294395447], [0.3332575857639313, 0.3304176330566406, 0.3363247811794281], [0.3332020044326782, 0.32861870527267456, 0.3381792902946472]], [[0.34072333574295044, 0.31675755977630615, 0.3425191044807434], [0.32159143686294556, 0.3593820333480835, 0.31902652978897095], [0.3420388996601105, 0.3137906491756439, 0.344170480966568]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 65934, "num_module_steps_trained_lifetime_throughput": 686.0934139988788}, "__all_modules__": {"num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 131868, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3605.641229682787, "num_module_steps_trained_throughput": 24145220.6351245, "num_module_steps_trained_lifetime_throughput": 12307218.697468497}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.534237874964062e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3751468149015995e-05, "add_time_dim_to_batch_and_zero_pad": 7.45461319397164e-06, "batch_individual_items": 1.335618683841784e-05, "add_observations_from_episodes_to_batch": 3.068810333028263e-06, "add_states_from_episodes_to_batch": 2.8117871668237774e-06}}, "connector_pipeline_timer": 6.359701705482407e-05}, "num_episodes_lifetime": 220, "sample": 0.11977306109636816, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 55400, "module_to_env_connector": {"connector_pipeline_timer": 0.00012704776321050397, "timers": {"connectors": {"get_actions": 4.2194336209570095e-05, "remove_single_ts_time_rank_from_batch": 1.2899808922547732e-05, "normalize_and_clip_actions": 8.6303012486879e-06, "tensor_to_numpy": 1.6686967812834237e-05, "un_batch_to_individual_items": 7.07579404453326e-06, "listify_data_for_vector_env": 1.1410172349739841e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.35}, "episode_duration_sec_mean": 0.00539241123246029, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "module_episode_returns_mean": {"default_policy": 0.35}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.5569952364322312e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.35, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 11.0, "env_reset_timer": 0.0006215519144222833, "time_between_sampling": 10.997858084285086}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-06-17", "timestamp": 1754928377, "time_this_iter_s": 12.619909763336182, "time_total_s": 122.76799440383911, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 122.76799440383911, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 55.11666666666667, "ram_util_percent": 82.77777777777777}}
{"timers": {"training_iteration": 10.675181176567193, "restore_env_runners": 1.1475865338510845e-05, "training_step": 10.67501792831863, "env_runner_sampling_timer": 1.714848039227937, "learner_update_timer": 8.745562285071061, "synch_weights": 0.0014652957654388025, "restore_eval_env_runners": 4.3891401794197235e-05, "evaluation_iteration": 0.13182360476755417, "synch_eval_env_connectors": 0.00017988471697471964, "synch_env_connectors": 4.538607365918271e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.428661694642677e-06, "listify_data_for_vector_env": 1.103669526542762e-05, "get_actions": 4.1859563293702976e-05, "tensor_to_numpy": 1.605055682617137e-05, "remove_single_ts_time_rank_from_batch": 1.243001154987105e-05, "un_batch_to_individual_items": 6.929187663934077e-06}}, "connector_pipeline_timer": 0.00012428173674452957}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.338093388356666e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.236274856418279e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.824126925603063e-06, "numpy_to_tensor": 1.3408689018844785e-05, "add_time_dim_to_batch_and_zero_pad": 7.365332646269828e-06, "batch_individual_items": 1.2955911897809189e-05, "add_observations_from_episodes_to_batch": 2.947504710850809e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4783150342202531e-05, "num_episodes_lifetime": -308250.0, "sample": 0.006375276133742471, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.100000000000001, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": 4.100000000000001}, "episode_duration_sec_mean": 0.005499447502195839, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04302818403341287, "agent_episode_returns_mean": {"default_agent": 4.100000000000001}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.336339586028262e-05, "num_env_steps_sampled_lifetime_throughput": 3067.7752266607336}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17619271998548874, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00926592901125401, "add_observations_from_episodes_to_batch": 0.0008541063044130925, "add_columns_from_episodes_to_train_batch": 0.04278337676322966, "add_time_dim_to_batch_and_zero_pad": 0.10424735168767094, "add_states_from_episodes_to_batch": 0.0035436139574491063, "batch_individual_items": 0.015295934084769832, "numpy_to_tensor": 6.963074179752284e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 431568, "diff_num_grad_updates_vs_sampler_policy": 61.0, "vf_explained_var": 0.0028842687606811523, "weights_seq_no": 72.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.495277404785156, "total_loss": 0.2038380354642868, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2633558511734009, "mean_kl_loss": 1.8337281289859675e-05, "entropy": 0.6793457269668579, "policy_loss": -0.00028424683841876686}, "intrinsic_reward_module": {"weights_seq_no": 72.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 431568, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2268000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 863136, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 44384.04483063618}}}, "default_policy": {"weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.0002965270250570029, "total_loss": 0.2037852555513382, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 71928, "use_intrinsic_rewards": 0.0, "vf_explained_var": 3.796815872192383e-05, "vf_loss_unclipped": 38.57312774658203, "num_trainable_parameters": 16595, "vf_loss": 0.2633075714111328, "mean_kl_loss": 1.9946573956985958e-05, "entropy": 0.6793027520179749, "curr_kl_coeff": 3.944920172216371e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 680.5870968843623}, "IntrinsicAttentionMask": [[[0.33732345700263977, 0.33151766657829285, 0.33115893602371216], [0.3363024592399597, 0.3319825530052185, 0.3317149877548218], [0.3362388610839844, 0.33201152086257935, 0.33174967765808105]], [[0.3320882022380829, 0.3367278277873993, 0.3311839699745178], [0.33192700147628784, 0.33716583251953125, 0.33090710639953613], [0.33211982250213623, 0.33664175868034363, 0.33123835921287537]], [[0.33584293723106384, 0.33033645153045654, 0.3338206708431244], [0.3351697027683258, 0.33113881945610046, 0.33369141817092896], [0.3355969786643982, 0.33062949776649475, 0.33377358317375183]], [[0.33652442693710327, 0.3343868851661682, 0.3290887475013733], [0.3363206386566162, 0.33432039618492126, 0.3293590247631073], [0.3358098566532135, 0.33415326476097107, 0.3300369381904602]], [[0.3351779878139496, 0.33042874932289124, 0.33439332246780396], [0.3348477780818939, 0.3309480845928192, 0.33420416712760925], [0.3351237177848816, 0.33051395416259766, 0.3343622386455536]], [[0.3466492295265198, 0.3092309236526489, 0.3441198468208313], [0.31807443499565125, 0.36124515533447266, 0.32068049907684326], [0.3448673188686371, 0.31244173645973206, 0.34269094467163086]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained_lifetime_throughput": 680.5946740206425}, "__all_modules__": {"num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 143856, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3576.7437828355696, "num_module_steps_trained_throughput": 23473287.18520485, "num_module_steps_trained_lifetime_throughput": 12268053.727486724}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 5.3000811338283444e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.9957210566156144e-05, "add_time_dim_to_batch_and_zero_pad": 1.0369546191139671e-05, "batch_individual_items": 1.7944057911186073e-05, "add_observations_from_episodes_to_batch": 4.26966685729995e-06, "add_states_from_episodes_to_batch": 4.051538464262572e-06}}, "connector_pipeline_timer": 8.71249688631016e-05}, "num_episodes_lifetime": 240, "sample": 0.12036727548511794, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 60400, "module_to_env_connector": {"connector_pipeline_timer": 0.00018148064611661093, "timers": {"connectors": {"get_actions": 6.35590965332208e-05, "remove_single_ts_time_rank_from_batch": 1.6779477410500035e-05, "normalize_and_clip_actions": 1.1715522525348877e-05, "tensor_to_numpy": 2.333633333251919e-05, "un_batch_to_individual_items": 8.685149302523553e-06, "listify_data_for_vector_env": 1.6646411734338524e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.45}, "episode_duration_sec_mean": 0.0059337208035867665, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "module_episode_returns_mean": {"default_policy": -0.45}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 2.399529376701612e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.45, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 12.0, "env_reset_timer": 0.000619828895143652, "time_between_sampling": 11.018159480111935}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-06-30", "timestamp": 1754928390, "time_this_iter_s": 13.187439203262329, "time_total_s": 135.95543360710144, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.95543360710144, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 55.078947368421055, "ram_util_percent": 82.90526315789474}}
{"timers": {"training_iteration": 10.681324576051809, "restore_env_runners": 1.1428606617027431e-05, "training_step": 10.681159211955677, "env_runner_sampling_timer": 1.714964570915973, "learner_update_timer": 8.751502331380296, "synch_weights": 0.0014687086484887811, "restore_eval_env_runners": 4.359915711191858e-05, "evaluation_iteration": 0.13242662704999097, "synch_eval_env_connectors": 0.00018096461931524577, "synch_env_connectors": 4.538641894223086e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.921924849486704e-06, "listify_data_for_vector_env": 1.1817221281847814e-05, "get_actions": 4.5574921218143714e-05, "tensor_to_numpy": 1.704142884442866e-05, "remove_single_ts_time_rank_from_batch": 1.301198937879135e-05, "un_batch_to_individual_items": 7.233352509467232e-06}}, "connector_pipeline_timer": 0.00013243830619277702}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.567594456853622e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.559102406768254e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9568590240138062e-06, "numpy_to_tensor": 1.4640754096700344e-05, "add_time_dim_to_batch_and_zero_pad": 7.73215699961679e-06, "batch_individual_items": 1.3661129579599131e-05, "add_observations_from_episodes_to_batch": 3.0644864499609766e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.6099293209347057e-05, "num_episodes_lifetime": -339125.0, "sample": 0.0062753495485252985, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.5, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": 4.5}, "episode_duration_sec_mean": 0.005895257526542991, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04670788219264591, "agent_episode_returns_mean": {"default_agent": 4.5}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.30215667177011e-05, "num_env_steps_sampled_lifetime_throughput": 2972.1296258235952}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17616023694506153, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009261761390298991, "add_observations_from_episodes_to_batch": 0.0008538769018636169, "add_columns_from_episodes_to_train_batch": 0.042773496745017486, "add_time_dim_to_batch_and_zero_pad": 0.10425351984012535, "add_states_from_episodes_to_batch": 0.003547382398118292, "batch_individual_items": 0.015268045574030732, "numpy_to_tensor": 6.967318505710341e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 467532, "diff_num_grad_updates_vs_sampler_policy": 66.0, "vf_explained_var": 0.0028796792030334473, "weights_seq_no": 78.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.458213806152344, "total_loss": 0.20394429564476013, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2633967995643616, "mean_kl_loss": 2.1491494408110157e-05, "entropy": 0.6781671047210693, "policy_loss": -0.00021221434872131795}, "intrinsic_reward_module": {"weights_seq_no": 78.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 467532, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2457000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 935064, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 43492.96244916236}}}, "default_policy": {"weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.000217097534914501, "total_loss": 0.20386585593223572, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 77922, "use_intrinsic_rewards": 0.0, "vf_explained_var": -0.00010669231414794922, "vf_loss_unclipped": 38.53215026855469, "num_trainable_parameters": 16595, "vf_loss": 0.26330673694610596, "mean_kl_loss": 2.260125256725587e-05, "entropy": 0.678138256072998, "curr_kl_coeff": 1.9724600861081854e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 675.4641536978119}, "IntrinsicAttentionMask": [[[0.33732345700263977, 0.33151766657829285, 0.33115893602371216], [0.3363024592399597, 0.3319825530052185, 0.3317149877548218], [0.3362388610839844, 0.33201152086257935, 0.33174967765808105]], [[0.3320882022380829, 0.3367278277873993, 0.3311839699745178], [0.33192700147628784, 0.33716583251953125, 0.33090710639953613], [0.33211982250213623, 0.33664175868034363, 0.33123835921287537]], [[0.33005985617637634, 0.33365458250045776, 0.3362855613231659], [0.32903626561164856, 0.33375129103660583, 0.33721238374710083], [0.32829487323760986, 0.33382028341293335, 0.3378848135471344]], [[0.3321356475353241, 0.3365987539291382, 0.33126556873321533], [0.3319745659828186, 0.33703672885894775, 0.33098873496055603], [0.33216729760169983, 0.3365127146244049, 0.3313199579715729]], [[0.3391157388687134, 0.3284715712070465, 0.3324126601219177], [0.3367961645126343, 0.3304159641265869, 0.33278781175613403], [0.3376629054546356, 0.32968851923942566, 0.3326485753059387]], [[0.34072333574295044, 0.31675758957862854, 0.3425191044807434], [0.32159146666526794, 0.3593819737434387, 0.31902655959129333], [0.3420388996601105, 0.3137906789779663, 0.344170480966568]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 77922, "num_module_steps_trained_lifetime_throughput": 675.4711920862504}, "__all_modules__": {"num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 155844, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3549.8180239727326, "num_module_steps_trained_throughput": 22840827.39145834, "num_module_steps_trained_lifetime_throughput": 12232047.557240803}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.41560300316419e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2899938215649309e-05, "add_time_dim_to_batch_and_zero_pad": 7.363387670278514e-06, "batch_individual_items": 1.3246297261108674e-05, "add_observations_from_episodes_to_batch": 2.9447522319084884e-06, "add_states_from_episodes_to_batch": 2.980531327619662e-06}}, "connector_pipeline_timer": 6.209816717652688e-05}, "num_episodes_lifetime": 260, "sample": 0.12058259606012889, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 65400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001242417356922863, "timers": {"connectors": {"get_actions": 4.0249044104709136e-05, "remove_single_ts_time_rank_from_batch": 1.2710172278989413e-05, "normalize_and_clip_actions": 8.604198099841438e-06, "tensor_to_numpy": 1.6479398890088653e-05, "un_batch_to_individual_items": 7.177240070953294e-06, "listify_data_for_vector_env": 1.1272756675298147e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.85}, "episode_duration_sec_mean": 0.006179857909446582, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "module_episode_returns_mean": {"default_policy": -0.85}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.530309891843443e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.85, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 13.0, "env_reset_timer": 0.000617200186341121, "time_between_sampling": 11.021402526151201}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-06-42", "timestamp": 1754928402, "time_this_iter_s": 11.443576097488403, "time_total_s": 147.39900970458984, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 147.39900970458984, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 50.268750000000004, "ram_util_percent": 82.42500000000001}}
{"timers": {"training_iteration": 10.684059911120578, "restore_env_runners": 1.142557052485463e-05, "training_step": 10.683893509005795, "env_runner_sampling_timer": 1.716125444376131, "learner_update_timer": 8.75302270681706, "synch_weights": 0.0014707753123914724, "restore_eval_env_runners": 4.353900658655157e-05, "evaluation_iteration": 0.1326112045304168, "synch_eval_env_connectors": 0.000181287473643932, "synch_env_connectors": 4.55117559034941e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.562285770668089e-06, "listify_data_for_vector_env": 1.1146875533892093e-05, "get_actions": 4.3242159655267316e-05, "tensor_to_numpy": 1.6336141535642768e-05, "remove_single_ts_time_rank_from_batch": 1.2391202716208066e-05, "un_batch_to_individual_items": 6.892060244019709e-06}}, "connector_pipeline_timer": 0.00012626889639905586}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 7.017288070413262e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.28135387716997e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8342281308692287e-06, "numpy_to_tensor": 1.3765064318010209e-05, "add_time_dim_to_batch_and_zero_pad": 7.392484730994183e-06, "batch_individual_items": 1.2999522500402107e-05, "add_observations_from_episodes_to_batch": 2.9848914958611565e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.551390072299192e-05, "num_episodes_lifetime": -370000.0, "sample": 0.006695104426529698, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.299999999999998, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "episode_duration_sec_mean": 0.006376940003596245, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04008681672214173, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.9314113620430056e-05, "num_env_steps_sampled_lifetime_throughput": 3110.415250913446}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17610338832584763, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009266173355733686, "add_observations_from_episodes_to_batch": 0.0008539973035526685, "add_columns_from_episodes_to_train_batch": 0.04275914385771808, "add_time_dim_to_batch_and_zero_pad": 0.10423117631211953, "add_states_from_episodes_to_batch": 0.0035490298241984274, "batch_individual_items": 0.01524189595835203, "numpy_to_tensor": 6.972770339719272e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 503496, "diff_num_grad_updates_vs_sampler_policy": 71.0, "vf_explained_var": 0.002953648567199707, "weights_seq_no": 84.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.10335922241211, "total_loss": 0.2036682665348053, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.26336172223091125, "mean_kl_loss": 2.6267944122082554e-05, "entropy": 0.6761902570724487, "policy_loss": -0.0004647688183467835}, "intrinsic_reward_module": {"weights_seq_no": 84.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 503496, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2646000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1006992, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 42651.61905911313}}}, "default_policy": {"weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.0004870422708336264, "total_loss": 0.20359919965267181, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 83916, "use_intrinsic_rewards": 0.0, "vf_explained_var": -0.00021636486053466797, "vf_loss_unclipped": 38.1007080078125, "num_trainable_parameters": 16595, "vf_loss": 0.26330700516700745, "mean_kl_loss": 2.90003590635024e-05, "entropy": 0.676123321056366, "curr_kl_coeff": 9.862300430540927e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 671.0761917674317}, "IntrinsicAttentionMask": [[[0.3336942791938782, 0.33333319425582886, 0.3329724967479706], [0.33368852734565735, 0.33333319425582886, 0.3329782485961914], [0.3336828052997589, 0.33333322405815125, 0.3329840302467346]], [[0.33253490924835205, 0.3355121314525604, 0.33195292949676514], [0.33237433433532715, 0.3359494209289551, 0.3316762447357178], [0.33256644010543823, 0.3354262411594391, 0.3320073187351227]], [[0.3313453793525696, 0.3349541127681732, 0.3337005376815796], [0.33072325587272644, 0.33546245098114014, 0.3338143527507782], [0.33093851804733276, 0.3352864682674408, 0.33377501368522644]], [[0.33394762873649597, 0.3367602527141571, 0.3292921185493469], [0.33407488465309143, 0.33749058842658997, 0.3284344971179962], [0.33373185992240906, 0.3355383276939392, 0.33072978258132935]], [[0.3387392461299896, 0.33196312189102173, 0.32929763197898865], [0.33805322647094727, 0.3321387469768524, 0.3298080265522003], [0.337779700756073, 0.33220866322517395, 0.33001166582107544]], [[0.31613656878471375, 0.36490491032600403, 0.3189585208892822], [0.28527018427848816, 0.4224368929862976, 0.2922929525375366], [0.3142571747303009, 0.368377149105072, 0.3173656165599823]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 83916, "num_module_steps_trained_lifetime_throughput": 671.0827319932336}, "__all_modules__": {"num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 167832, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3526.754745889072, "num_module_steps_trained_throughput": 22238753.397801712, "num_module_steps_trained_lifetime_throughput": 12193467.959047092}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.082627980609985e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2043662174517567e-05, "add_time_dim_to_batch_and_zero_pad": 7.093244303353906e-06, "batch_individual_items": 1.2569134531636546e-05, "add_observations_from_episodes_to_batch": 2.8308586477698067e-06, "add_states_from_episodes_to_batch": 2.675023253707647e-06}}, "connector_pipeline_timer": 5.913543898010805e-05}, "num_episodes_lifetime": 280, "sample": 0.12053597217998041, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 70400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011394528465438294, "timers": {"connectors": {"get_actions": 3.624489940004195e-05, "remove_single_ts_time_rank_from_batch": 1.1994574488475011e-05, "normalize_and_clip_actions": 7.876703361489364e-06, "tensor_to_numpy": 1.5042819576943757e-05, "un_batch_to_individual_items": 6.593618446788862e-06, "listify_data_for_vector_env": 1.0462204130222761e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.65}, "episode_duration_sec_mean": 0.00618394125602208, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "module_episode_returns_mean": {"default_policy": -0.65}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3924788666255033e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.65, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 14.0, "env_reset_timer": 0.0006141819349178155, "time_between_sampling": 11.021067267138855}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-06-53", "timestamp": 1754928413, "time_this_iter_s": 11.082921028137207, "time_total_s": 158.48193073272705, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 158.48193073272705, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 45.912499999999994, "ram_util_percent": 80.98125}}
{"timers": {"training_iteration": 10.68042055450959, "restore_env_runners": 1.144089438602521e-05, "training_step": 10.680253409756185, "env_runner_sampling_timer": 1.7158021949323965, "learner_update_timer": 8.749614523499137, "synch_weights": 0.001471031729090191, "restore_eval_env_runners": 4.344361561715414e-05, "evaluation_iteration": 0.13253342039554708, "synch_eval_env_connectors": 0.0001811966795405369, "synch_env_connectors": 4.542753755979977e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.11539538776648e-06, "listify_data_for_vector_env": 1.0619260237915259e-05, "get_actions": 3.923892875026749e-05, "tensor_to_numpy": 1.5324576592366654e-05, "remove_single_ts_time_rank_from_batch": 1.1897248932594323e-05, "un_batch_to_individual_items": 6.63581038124036e-06}}, "connector_pipeline_timer": 0.00011839671262695523}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 5.8357578708321705e-05, "env_to_module_connector": {"connector_pipeline_timer": 5.960092214364486e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7374430100622753e-06, "numpy_to_tensor": 1.268175555104184e-05, "add_time_dim_to_batch_and_zero_pad": 6.965879880730505e-06, "batch_individual_items": 1.240824376467133e-05, "add_observations_from_episodes_to_batch": 2.8115201766228975e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3995453752339024e-05, "num_episodes_lifetime": -400875.0, "sample": 0.006032822807026189, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.0600000000000005, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": 5.0600000000000005}, "episode_duration_sec_mean": 0.00586226349649951, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03779203087632508, "agent_episode_returns_mean": {"default_agent": 5.0600000000000005}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.20041118993889e-05, "num_env_steps_sampled_lifetime_throughput": 3233.532497406823}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17609618736281074, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009260474963049247, "add_observations_from_episodes_to_batch": 0.000853725250282927, "add_columns_from_episodes_to_train_batch": 0.04275641116991635, "add_time_dim_to_batch_and_zero_pad": 0.10424968746940644, "add_states_from_episodes_to_batch": 0.003551306606313741, "batch_individual_items": 0.01522285324834636, "numpy_to_tensor": 6.967000632057188e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 539460, "diff_num_grad_updates_vs_sampler_policy": 76.0, "vf_explained_var": 0.0029363632202148438, "weights_seq_no": 90.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.154727935791016, "total_loss": 0.20375800132751465, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2633630037307739, "mean_kl_loss": 3.0501283617923036e-05, "entropy": 0.6747362613677979, "policy_loss": -0.00037894464912824333}, "intrinsic_reward_module": {"weights_seq_no": 90.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 539460, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2835000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1078920, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 41871.88982421835}}}, "default_policy": {"weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.00038996955845505, "total_loss": 0.20369812846183777, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 89910, "use_intrinsic_rewards": 0.0, "vf_explained_var": -2.9206275939941406e-05, "vf_loss_unclipped": 38.14346694946289, "num_trainable_parameters": 16595, "vf_loss": 0.26330652832984924, "mean_kl_loss": 3.2653759262757376e-05, "entropy": 0.6746847629547119, "curr_kl_coeff": 4.931150215270463e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 667.7744971391948}, "IntrinsicAttentionMask": [[[0.33732345700263977, 0.33151763677597046, 0.33115893602371216], [0.3363024592399597, 0.3319825530052185, 0.3317149877548218], [0.3362388610839844, 0.33201152086257935, 0.33174967765808105]], [[0.33546409010887146, 0.33403971791267395, 0.3304961323738098], [0.3352603316307068, 0.333972692489624, 0.3307669758796692], [0.33474960923194885, 0.3338041603565216, 0.33144623041152954]], [[0.3313453793525696, 0.3349541127681732, 0.3337005376815796], [0.33072325587272644, 0.33546245098114014, 0.3338143527507782], [0.33093851804733276, 0.3352864682674408, 0.33377501368522644]], [[0.3325822055339813, 0.3353832960128784, 0.33203449845314026], [0.3324216902256012, 0.3358204960823059, 0.3317578136920929], [0.3326137363910675, 0.33529743552207947, 0.3320888876914978]], [[0.33316516876220703, 0.32753270864486694, 0.33930209279060364], [0.3331948220729828, 0.32840022444725037, 0.3384050130844116], [0.33313173055648804, 0.3266049027442932, 0.340263307094574]], [[0.32179445028305054, 0.36681413650512695, 0.3113914430141449], [0.30811336636543274, 0.4040343165397644, 0.28785234689712524], [0.32501623034477234, 0.35768741369247437, 0.31729641556739807]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 89910, "num_module_steps_trained_lifetime_throughput": 667.7805876763609}, "__all_modules__": {"num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 179820, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3509.4000726367926, "num_module_steps_trained_throughput": 21684179.622047268, "num_module_steps_trained_lifetime_throughput": 12168296.443862306}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.163501709634556e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2298664289280703e-05, "add_time_dim_to_batch_and_zero_pad": 7.023842202814606e-06, "batch_individual_items": 1.2468745987073761e-05, "add_observations_from_episodes_to_batch": 2.8241183279402653e-06, "add_states_from_episodes_to_batch": 2.6677720583224538e-06}}, "connector_pipeline_timer": 5.8971309535662796e-05}, "num_episodes_lifetime": 300, "sample": 0.12049251870823463, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 75400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011605747329216291, "timers": {"connectors": {"get_actions": 3.739881686309024e-05, "remove_single_ts_time_rank_from_batch": 1.2052951826019995e-05, "normalize_and_clip_actions": 8.096155469099661e-06, "tensor_to_numpy": 1.531564599274954e-05, "un_batch_to_individual_items": 6.636416226098723e-06, "listify_data_for_vector_env": 1.0572933533868887e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -1.05}, "episode_duration_sec_mean": 0.006122187077999115, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "module_episode_returns_mean": {"default_policy": -1.05}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.4350300787141262e-05, "num_env_steps_sampled": 400, "episode_return_mean": -1.05, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 15.0, "env_reset_timer": 0.0006119388658607746, "time_between_sampling": 11.014351601546794}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-07-03", "timestamp": 1754928423, "time_this_iter_s": 10.447996139526367, "time_total_s": 168.92992687225342, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 168.92992687225342, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.846666666666664, "ram_util_percent": 81.42666666666668}}
{"timers": {"training_iteration": 10.687765525214706, "restore_env_runners": 1.142565499821645e-05, "training_step": 10.68759779774848, "env_runner_sampling_timer": 1.7139536559030562, "learner_update_timer": 8.758765321174883, "synch_weights": 0.0014717101611063106, "restore_eval_env_runners": 4.355376917233578e-05, "evaluation_iteration": 0.13245559035186544, "synch_eval_env_connectors": 0.00018097888204331844, "synch_env_connectors": 4.543986643561631e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.133225017981476e-06, "listify_data_for_vector_env": 1.051248219976319e-05, "get_actions": 3.9293772494388354e-05, "tensor_to_numpy": 1.5361074033013143e-05, "remove_single_ts_time_rank_from_batch": 1.1956000892466262e-05, "un_batch_to_individual_items": 6.627617307879189e-06}}, "connector_pipeline_timer": 0.00011838625405927655}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.163667526229837e-05, "env_to_module_connector": {"connector_pipeline_timer": 5.935119792567645e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7112574615955353e-06, "numpy_to_tensor": 1.2667977057447594e-05, "add_time_dim_to_batch_and_zero_pad": 6.922800629366679e-06, "batch_individual_items": 1.2366459596588126e-05, "add_observations_from_episodes_to_batch": 2.7804960941243558e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.393384402235375e-05, "num_episodes_lifetime": -431750.0, "sample": 0.006015129777660014, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.0600000000000005, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": 5.0600000000000005}, "episode_duration_sec_mean": 0.005263423326425254, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03579921931559402, "agent_episode_returns_mean": {"default_agent": 5.0600000000000005}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 3.8310781617099607e-05, "num_env_steps_sampled_lifetime_throughput": 3255.7593795480816}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17603442673963143, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009255390633038733, "add_observations_from_episodes_to_batch": 0.0008536938273900282, "add_columns_from_episodes_to_train_batch": 0.04274034288768392, "add_time_dim_to_batch_and_zero_pad": 0.1042292618451939, "add_states_from_episodes_to_batch": 0.003553735210994352, "batch_individual_items": 0.01519998096626262, "numpy_to_tensor": 6.998663644128939e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 575424, "diff_num_grad_updates_vs_sampler_policy": 81.0, "vf_explained_var": 0.0028815269470214844, "weights_seq_no": 96.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.43010711669922, "total_loss": 0.20368041098117828, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2634013295173645, "mean_kl_loss": 2.3702674297965132e-05, "entropy": 0.6739921569824219, "policy_loss": -0.00048643231275491416}, "intrinsic_reward_module": {"weights_seq_no": 96.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 575424, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3024000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1150848, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 41131.1350526593}}}, "default_policy": {"weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.0005149061908014119, "total_loss": 0.20357820391654968, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 95904, "use_intrinsic_rewards": 0.0, "vf_explained_var": 0.00034183263778686523, "vf_loss_unclipped": 38.47328567504883, "num_trainable_parameters": 16595, "vf_loss": 0.2633114457130432, "mean_kl_loss": 2.654347372299526e-05, "entropy": 0.6739144921302795, "curr_kl_coeff": 2.4655751076352317e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 664.6025723590534}, "IntrinsicAttentionMask": [[[0.3336942791938782, 0.33333319425582886, 0.33297252655029297], [0.33368852734565735, 0.33333319425582886, 0.3329782485961914], [0.3336828052997589, 0.33333322405815125, 0.3329840302467346]], [[0.33398526906967163, 0.33697548508644104, 0.32903918623924255], [0.33411216735839844, 0.33770594000816345, 0.3281819224357605], [0.33377009630203247, 0.3357534408569336, 0.33047640323638916]], [[0.33133527636528015, 0.3310796618461609, 0.3375850319862366], [0.33138009905815125, 0.33113014698028564, 0.3374897837638855], [0.33024850487709045, 0.3298560082912445, 0.33989548683166504]], [[0.335338294506073, 0.33399835228919983, 0.33066338300704956], [0.33513450622558594, 0.33393120765686035, 0.3309342563152313], [0.334623783826828, 0.3337625563144684, 0.3316136598587036]], [[0.3351779580116272, 0.33042871952056885, 0.3343932628631592], [0.33484774827957153, 0.3309480845928192, 0.33420413732528687], [0.3351237177848816, 0.33051398396492004, 0.3343622386455536]], [[0.34994277358055115, 0.3076721429824829, 0.34238505363464355], [0.3100302219390869, 0.3704366385936737, 0.3195331394672394], [0.3432613015174866, 0.31791433691978455, 0.3388243615627289]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 95904, "num_module_steps_trained_lifetime_throughput": 664.6082411643396}, "__all_modules__": {"num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 191808, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3492.7274384944644, "num_module_steps_trained_throughput": 21150567.828213453, "num_module_steps_trained_lifetime_throughput": 12144302.208817162}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.511903001226488e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.5247848075155563e-05, "add_time_dim_to_batch_and_zero_pad": 7.432641398867568e-06, "batch_individual_items": 1.3238486623598272e-05, "add_observations_from_episodes_to_batch": 3.0136412562671186e-06, "add_states_from_episodes_to_batch": 2.7612342198105246e-06}}, "connector_pipeline_timer": 6.450359097673915e-05}, "num_episodes_lifetime": 320, "sample": 0.12049139894123435, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 80400, "module_to_env_connector": {"connector_pipeline_timer": 0.00012746158993537916, "timers": {"connectors": {"get_actions": 4.2593101670627555e-05, "remove_single_ts_time_rank_from_batch": 1.2558631957875288e-05, "normalize_and_clip_actions": 8.81099101872952e-06, "tensor_to_numpy": 1.720272878287539e-05, "un_batch_to_individual_items": 6.9850568257200956e-06, "listify_data_for_vector_env": 1.1426887529932359e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.25}, "episode_duration_sec_mean": 0.006119855826254934, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "module_episode_returns_mean": {"default_policy": -0.25}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.6123012646480042e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.25, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 16.0, "env_reset_timer": 0.0006090694775020527, "time_between_sampling": 11.01863658553125}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-07-15", "timestamp": 1754928435, "time_this_iter_s": 11.54758906364441, "time_total_s": 180.47751593589783, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 180.47751593589783, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 47.93125, "ram_util_percent": 81.86875}}
{"timers": {"training_iteration": 10.693566487882588, "restore_env_runners": 1.141306860539862e-05, "training_step": 10.693398484351354, "env_runner_sampling_timer": 1.7125933822543897, "learner_update_timer": 8.765889667963425, "synch_weights": 0.0014656618100197683, "restore_eval_env_runners": 4.346240173806158e-05, "evaluation_iteration": 0.1324251940383806, "synch_eval_env_connectors": 0.00018075492252741648, "synch_env_connectors": 4.542296819221795e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.277350635679207e-06, "listify_data_for_vector_env": 1.0710929072903457e-05, "get_actions": 4.109291819045091e-05, "tensor_to_numpy": 1.5777482841754794e-05, "remove_single_ts_time_rank_from_batch": 1.2047638534306428e-05, "un_batch_to_individual_items": 6.738451226840452e-06}}, "connector_pipeline_timer": 0.00012151761258252989}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.272191084523697e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.067051119068282e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7587377309399887e-06, "numpy_to_tensor": 1.3080721077698679e-05, "add_time_dim_to_batch_and_zero_pad": 7.139738188072335e-06, "batch_individual_items": 1.2642772363832552e-05, "add_observations_from_episodes_to_batch": 2.8593816121049367e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4444025151652578e-05, "num_episodes_lifetime": -462625.0, "sample": 0.00575565133777095, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.579999999999998, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": 4.579999999999998}, "episode_duration_sec_mean": 0.0054180947272107, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.040248809045426645, "agent_episode_returns_mean": {"default_agent": 4.579999999999998}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.063360849856146e-05, "num_env_steps_sampled_lifetime_throughput": 3183.54716757404}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17596547831167855, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009251224646531053, "add_observations_from_episodes_to_batch": 0.0008536418896966772, "add_columns_from_episodes_to_train_batch": 0.04272501778863472, "add_time_dim_to_batch_and_zero_pad": 0.104202379226269, "add_states_from_episodes_to_batch": 0.003555904949262216, "batch_individual_items": 0.015175481995898585, "numpy_to_tensor": 6.992676912938616e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 611388, "diff_num_grad_updates_vs_sampler_policy": 86.0, "vf_explained_var": 0.002871215343475342, "weights_seq_no": 102.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.43227005004883, "total_loss": 0.20402635633945465, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.26336151361465454, "mean_kl_loss": 1.4865696357446723e-05, "entropy": 0.6728031039237976, "policy_loss": -0.00010987612040480599}, "intrinsic_reward_module": {"weights_seq_no": 102.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 611388, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3213000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1222776, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 40431.605123475674}}}, "default_policy": {"weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.0001113432299462147, "total_loss": 0.2039794921875, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 101898, "use_intrinsic_rewards": 0.0, "vf_explained_var": 1.722574234008789e-05, "vf_loss_unclipped": 38.483642578125, "num_trainable_parameters": 16595, "vf_loss": 0.26330628991127014, "mean_kl_loss": 1.534520197310485e-05, "entropy": 0.6727858185768127, "curr_kl_coeff": 1.2327875538176158e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 661.4137836227343}, "IntrinsicAttentionMask": [[[0.335500031709671, 0.32972559332847595, 0.33477434515953064], [0.3349473774433136, 0.3306448757648468, 0.3344077169895172], [0.33543112874031067, 0.32984018325805664, 0.3347286880016327]], [[0.33232590556144714, 0.3360811769962311, 0.3315929174423218], [0.33216503262519836, 0.336518794298172, 0.33131614327430725], [0.3323574960231781, 0.3359951972961426, 0.33164727687835693]], [[0.3344506621360779, 0.32640552520751953, 0.3391438126564026], [0.334253191947937, 0.32766199111938477, 0.3380848169326782], [0.3345624804496765, 0.32568737864494324, 0.33975011110305786]], [[0.335338294506073, 0.33399835228919983, 0.33066338300704956], [0.33513450622558594, 0.33393120765686035, 0.3309342563152313], [0.334623783826828, 0.3337625563144684, 0.3316136598587036]], [[0.335536926984787, 0.32986438274383545, 0.3345986008644104], [0.33520686626434326, 0.3303833305835724, 0.33440983295440674], [0.33548274636268616, 0.32994961738586426, 0.334567666053772]], [[0.346649169921875, 0.30923107266426086, 0.3441197872161865], [0.31807461380958557, 0.36124473810195923, 0.3206806480884552], [0.3448672592639923, 0.3124418258666992, 0.34269091486930847]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 101898, "num_module_steps_trained_lifetime_throughput": 661.4190403760521}, "__all_modules__": {"num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 203796, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3475.9662741312213, "num_module_steps_trained_throughput": 20654066.685769815, "num_module_steps_trained_lifetime_throughput": 12127110.482536826}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.1140085563858025e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2208282969448885e-05, "add_time_dim_to_batch_and_zero_pad": 6.876444190699095e-06, "batch_individual_items": 1.242935975284144e-05, "add_observations_from_episodes_to_batch": 2.8204033785457763e-06, "add_states_from_episodes_to_batch": 2.6587537081469997e-06}}, "connector_pipeline_timer": 5.8712986660125316e-05}, "num_episodes_lifetime": 340, "sample": 0.12046935287138252, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 85400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001151596816546865, "timers": {"connectors": {"get_actions": 3.594842872409495e-05, "remove_single_ts_time_rank_from_batch": 1.2285482972669475e-05, "normalize_and_clip_actions": 8.015256849253452e-06, "tensor_to_numpy": 1.531730405059441e-05, "un_batch_to_individual_items": 6.681666546389068e-06, "listify_data_for_vector_env": 1.0619090761028678e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.15}, "episode_duration_sec_mean": 0.0055800666543655095, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "module_episode_returns_mean": {"default_policy": 0.15}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.4054445266476865e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.15, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 17.0, "env_reset_timer": 0.0006059012822794013, "time_between_sampling": 11.021414932176043}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-07-26", "timestamp": 1754928446, "time_this_iter_s": 11.39700984954834, "time_total_s": 191.87452578544617, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 191.87452578544617, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 43.2125, "ram_util_percent": 82.4}}
{"timers": {"training_iteration": 10.693233225082915, "restore_env_runners": 1.135726781634602e-05, "training_step": 10.693064666587437, "env_runner_sampling_timer": 1.7116369959321673, "learner_update_timer": 8.766379223784835, "synch_weights": 0.001466449351427322, "restore_eval_env_runners": 4.3116118323496114e-05, "evaluation_iteration": 0.13236293167823132, "synch_eval_env_connectors": 0.00017990529328533559, "synch_env_connectors": 4.5368741556093115e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.340637536506458e-06, "listify_data_for_vector_env": 1.0964547414365053e-05, "get_actions": 4.2075310100172455e-05, "tensor_to_numpy": 1.5993849662345304e-05, "remove_single_ts_time_rank_from_batch": 1.2203937007666144e-05, "un_batch_to_individual_items": 6.85255836295953e-06}}, "connector_pipeline_timer": 0.00012375592421698031}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.369925884013329e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.196744487036515e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8215101339564173e-06, "numpy_to_tensor": 1.3251720404911163e-05, "add_time_dim_to_batch_and_zero_pad": 7.25785984018719e-06, "batch_individual_items": 1.2945599633908774e-05, "add_observations_from_episodes_to_batch": 2.929830491567191e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.505096223963401e-05, "num_episodes_lifetime": -493500.0, "sample": 0.005869010418154248, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.18, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": 4.18}, "episode_duration_sec_mean": 0.005545589960645886, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03989919728943527, "agent_episode_returns_mean": {"default_agent": 4.18}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.4225456935584074e-05, "num_env_steps_sampled_lifetime_throughput": 3112.104076903065}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17593939060762526, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009253088230442262, "add_observations_from_episodes_to_batch": 0.0008537263012853076, "add_columns_from_episodes_to_train_batch": 0.04272728969156097, "add_time_dim_to_batch_and_zero_pad": 0.10418712543388665, "add_states_from_episodes_to_batch": 0.0035592629900477128, "batch_individual_items": 0.01515648342661723, "numpy_to_tensor": 7.004416074147435e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 647352, "diff_num_grad_updates_vs_sampler_policy": 91.0, "vf_explained_var": 0.002865433692932129, "weights_seq_no": 108.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.4683952331543, "total_loss": 0.20404817163944244, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.26336145401000977, "mean_kl_loss": 2.3831147700548172e-05, "entropy": 0.6714716553688049, "policy_loss": -9.152240090770647e-05}, "intrinsic_reward_module": {"weights_seq_no": 108.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 647352, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3402000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1294704, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 39776.008079042454}}}, "default_policy": {"weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -9.226849215338007e-05, "total_loss": 0.2040005326271057, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 107892, "use_intrinsic_rewards": 0.0, "vf_explained_var": -5.1021575927734375e-05, "vf_loss_unclipped": 38.53049087524414, "num_trainable_parameters": 16595, "vf_loss": 0.2633061707019806, "mean_kl_loss": 2.4141929316101596e-05, "entropy": 0.6714619398117065, "curr_kl_coeff": 6.163937769088079e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 658.6624943404154}, "IntrinsicAttentionMask": [[[0.33732345700263977, 0.33151763677597046, 0.33115893602371216], [0.3363024592399597, 0.3319825530052185, 0.3317149877548218], [0.3362388610839844, 0.33201152086257935, 0.33174967765808105]], [[0.33546411991119385, 0.33403971791267395, 0.3304961621761322], [0.3352603316307068, 0.33397266268730164, 0.3307669758796692], [0.33474960923194885, 0.3338041603565216, 0.33144623041152954]], [[0.3313453793525696, 0.3349541127681732, 0.3337005078792572], [0.33072325587272644, 0.3354624807834625, 0.3338143527507782], [0.33093851804733276, 0.3352864682674408, 0.33377498388290405]], [[0.33429813385009766, 0.33879026770591736, 0.3269116282463074], [0.33442193269729614, 0.3395213782787323, 0.32605674862861633], [0.33408814668655396, 0.3375670611858368, 0.32834479212760925]], [[0.3386920392513275, 0.32373806834220886, 0.33756986260414124], [0.33718279004096985, 0.3264361321926117, 0.33638107776641846], [0.33858126401901245, 0.32393598556518555, 0.3374827206134796]], [[0.34994274377822876, 0.3076722323894501, 0.34238502383232117], [0.31003037095069885, 0.3704363703727722, 0.31953325867652893], [0.3432612717151642, 0.31791436672210693, 0.3388243317604065]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 107892, "num_module_steps_trained_lifetime_throughput": 658.6673584472364}, "__all_modules__": {"num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 215784, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3461.504340753259, "num_module_steps_trained_throughput": 20183971.010818534, "num_module_steps_trained_lifetime_throughput": 12111354.158345545}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.02028191125874e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.189600374954735e-05, "add_time_dim_to_batch_and_zero_pad": 6.732849216346888e-06, "batch_individual_items": 1.2253417962283811e-05, "add_observations_from_episodes_to_batch": 2.78122584402725e-06, "add_states_from_episodes_to_batch": 2.6852211610696775e-06}}, "connector_pipeline_timer": 5.817486258111778e-05}, "num_episodes_lifetime": 360, "sample": 0.12039650059313114, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 90400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001126304385584261, "timers": {"connectors": {"get_actions": 3.504931978967129e-05, "remove_single_ts_time_rank_from_batch": 1.1960227272568806e-05, "normalize_and_clip_actions": 7.950090084962605e-06, "tensor_to_numpy": 1.4755124548284513e-05, "un_batch_to_individual_items": 6.524144255776971e-06, "listify_data_for_vector_env": 1.0509600762491904e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.75}, "episode_duration_sec_mean": 0.005320933314505965, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "module_episode_returns_mean": {"default_policy": 0.75}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3763994090382331e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.75, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 18.0, "env_reset_timer": 0.0006028951890940191, "time_between_sampling": 11.018096239934382}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-07-37", "timestamp": 1754928457, "time_this_iter_s": 10.785767078399658, "time_total_s": 202.66029286384583, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 202.66029286384583, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.21333333333333, "ram_util_percent": 81.97333333333333}}
{"timers": {"training_iteration": 10.690461794502196, "restore_env_runners": 1.1299114652138272e-05, "training_step": 10.690292477841984, "env_runner_sampling_timer": 1.7122625480524312, "learner_update_timer": 8.76293342904766, "synch_weights": 0.0014662806888959723, "restore_eval_env_runners": 4.306162706310473e-05, "evaluation_iteration": 0.13226093403135405, "synch_eval_env_connectors": 0.0001798787404614097, "synch_env_connectors": 4.538595411732214e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.277827346817824e-06, "listify_data_for_vector_env": 1.0959456383533686e-05, "get_actions": 4.075280751223266e-05, "tensor_to_numpy": 1.562650518650595e-05, "remove_single_ts_time_rank_from_batch": 1.2071033743097357e-05, "un_batch_to_individual_items": 6.713346085591665e-06}}, "connector_pipeline_timer": 0.00012128646624417572}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 7.537879176944116e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.069110819655041e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7680667909185567e-06, "numpy_to_tensor": 1.2996414272997355e-05, "add_time_dim_to_batch_and_zero_pad": 7.16558474669401e-06, "batch_individual_items": 1.2651338917731615e-05, "add_observations_from_episodes_to_batch": 2.8615602641651317e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4388750987388502e-05, "num_episodes_lifetime": -524375.0, "sample": 0.006515117308599796, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.5, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": 4.5}, "episode_duration_sec_mean": 0.006171734329778701, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03749306579052796, "agent_episode_returns_mean": {"default_agent": 4.5}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.8388092442100475e-05, "num_env_steps_sampled_lifetime_throughput": 3144.273220814854}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1758841242013827, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009247945687590286, "add_observations_from_episodes_to_batch": 0.0008535286279669694, "add_columns_from_episodes_to_train_batch": 0.0427153017949901, "add_time_dim_to_batch_and_zero_pad": 0.10417097417958199, "add_states_from_episodes_to_batch": 0.003560889529464049, "batch_individual_items": 0.015133283172801637, "numpy_to_tensor": 7.001788957598513e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 683316, "diff_num_grad_updates_vs_sampler_policy": 96.0, "vf_explained_var": 0.002866029739379883, "weights_seq_no": 114.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.43458938598633, "total_loss": 0.2037854641675949, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.2633620500564575, "mean_kl_loss": 2.2266267478698865e-05, "entropy": 0.6699744462966919, "policy_loss": -0.0003567479143384844}, "intrinsic_reward_module": {"weights_seq_no": 114.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 683316, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3591000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1366632, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 39164.64217335187}}}, "default_policy": {"weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.0003713889454957098, "total_loss": 0.2037237584590912, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 113886, "use_intrinsic_rewards": 0.0, "vf_explained_var": -5.4717063903808594e-05, "vf_loss_unclipped": 38.48567199707031, "num_trainable_parameters": 16595, "vf_loss": 0.2633061110973358, "mean_kl_loss": 2.428160405543167e-05, "entropy": 0.6699112057685852, "curr_kl_coeff": 3.0819688845440396e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 656.6251715038179}, "IntrinsicAttentionMask": [[[0.3336942791938782, 0.33333319425582886, 0.3329724967479706], [0.33368852734565735, 0.33333319425582886, 0.3329782485961914], [0.3336828052997589, 0.33333322405815125, 0.3329840302467346]], [[0.33071640133857727, 0.33589813113212585, 0.3333854377269745], [0.328876256942749, 0.3377096354961395, 0.33341410756111145], [0.32976454496383667, 0.3368343710899353, 0.3334011137485504]], [[0.32799893617630005, 0.3338475823402405, 0.33815351128578186], [0.32697793841362, 0.3339405059814453, 0.3390815556049347], [0.3262384235858917, 0.3340066969394684, 0.3397548198699951]], [[0.33652442693710327, 0.3343868553638458, 0.3290887176990509], [0.3363206386566162, 0.3343203663825989, 0.3293590247631073], [0.3358098566532135, 0.3341532349586487, 0.3300369381904602]], [[0.3351779580116272, 0.33042874932289124, 0.3343932628631592], [0.33484774827957153, 0.3309480845928192, 0.33420413732528687], [0.3351237177848816, 0.33051401376724243, 0.3343622386455536]], [[0.3466491401195526, 0.30923110246658325, 0.3441197872161865], [0.31807467341423035, 0.3612445890903473, 0.3206806778907776], [0.3448672294616699, 0.3124418556690216, 0.3426908850669861]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 113886, "num_module_steps_trained_lifetime_throughput": 656.6296728062104}, "__all_modules__": {"num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 227772, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3450.794582072045, "num_module_steps_trained_throughput": 19738965.77979133, "num_module_steps_trained_lifetime_throughput": 12096883.110706931}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.0313006792974785e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.189063762245435e-05, "add_time_dim_to_batch_and_zero_pad": 6.753020651018834e-06, "batch_individual_items": 1.2224640587404284e-05, "add_observations_from_episodes_to_batch": 2.8024065378506256e-06, "add_states_from_episodes_to_batch": 2.6540422084485663e-06}}, "connector_pipeline_timer": 5.8042476249889146e-05}, "num_episodes_lifetime": 380, "sample": 0.12033735183750732, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 95400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011281133116910883, "timers": {"connectors": {"get_actions": 3.524794414283433e-05, "remove_single_ts_time_rank_from_batch": 1.18713708618796e-05, "normalize_and_clip_actions": 7.826457321348597e-06, "tensor_to_numpy": 1.486420280100237e-05, "un_batch_to_individual_items": 6.616158444814088e-06, "listify_data_for_vector_env": 1.0525317277880521e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.15}, "episode_duration_sec_mean": 0.0053065833216533066, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "module_episode_returns_mean": {"default_policy": 0.15}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3983290032914118e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.15, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 19.0, "env_reset_timer": 0.0006002170776188844, "time_between_sampling": 11.012385722115113}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-07-48", "timestamp": 1754928468, "time_this_iter_s": 10.542357921600342, "time_total_s": 213.20265078544617, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 213.20265078544617, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 32.98666666666667, "ram_util_percent": 81.79999999999998}}
{"timers": {"training_iteration": 10.695211866557171, "restore_env_runners": 1.124487366193007e-05, "training_step": 10.695041244314298, "env_runner_sampling_timer": 1.7125557359017693, "learner_update_timer": 8.767339564346939, "synch_weights": 0.0014719558017116288, "restore_eval_env_runners": 4.2987680563027395e-05, "evaluation_iteration": 0.13216862636177065, "synch_eval_env_connectors": 0.00017955495264664113, "synch_env_connectors": 4.532379720950001e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.365088364710567e-06, "listify_data_for_vector_env": 1.0928105360019111e-05, "get_actions": 4.139372848754219e-05, "tensor_to_numpy": 1.6285076741670013e-05, "remove_single_ts_time_rank_from_batch": 1.2154429985598589e-05, "un_batch_to_individual_items": 6.827076788543702e-06}}, "connector_pipeline_timer": 0.00012330621175760722}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.2954028531366475e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.120818120844449e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7683306516170522e-06, "numpy_to_tensor": 1.3209180878356813e-05, "add_time_dim_to_batch_and_zero_pad": 7.155387011773519e-06, "batch_individual_items": 1.2668806946604568e-05, "add_observations_from_episodes_to_batch": 2.889348219999393e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4473068384897417e-05, "num_episodes_lifetime": -555250.0, "sample": 0.005950333627098452, "episode_len_max": 20, "num_episodes": 250.0, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.579999999999998, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": 4.579999999999998}, "episode_duration_sec_mean": 0.005462829818483442, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_min": -7.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.036234464548140166, "agent_episode_returns_mean": {"default_agent": 4.579999999999998}, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.6275803711652325e-05, "num_env_steps_sampled_lifetime_throughput": 3149.9211905942157}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17583166045887286, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009245079980592864, "add_observations_from_episodes_to_batch": 0.0008532820916466196, "add_columns_from_episodes_to_train_batch": 0.042699518776678026, "add_time_dim_to_batch_and_zero_pad": 0.10415227901791861, "add_states_from_episodes_to_batch": 0.003562718134601542, "batch_individual_items": 0.015116147841375145, "numpy_to_tensor": 7.039605067231634e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 719280, "diff_num_grad_updates_vs_sampler_policy": 101.0, "vf_explained_var": 0.002804577350616455, "weights_seq_no": 120.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.59333038330078, "total_loss": 0.20378810167312622, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "vf_loss": 0.26335930824279785, "mean_kl_loss": 2.133020097971894e-05, "entropy": 0.6689023971557617, "policy_loss": -0.00035345114883966744}, "intrinsic_reward_module": {"weights_seq_no": 120.0, "num_module_steps_trained": 35964, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 719280, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3780000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1438560, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime_throughput": 38576.189690952575}}}, "default_policy": {"weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "policy_loss": -0.00036940263817086816, "total_loss": 0.20372629165649414, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 119880, "use_intrinsic_rewards": 0.0, "vf_explained_var": 0.00015056133270263672, "vf_loss_unclipped": 38.68016052246094, "num_trainable_parameters": 16595, "vf_loss": 0.2633047103881836, "mean_kl_loss": 2.3319800675380975e-05, "entropy": 0.6688373684883118, "curr_kl_coeff": 1.5409844422720198e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 654.7204749696381}, "IntrinsicAttentionMask": [[[0.32708343863487244, 0.33451390266418457, 0.338402658700943], [0.32353848218917847, 0.3351600468158722, 0.34130150079727173], [0.3217213749885559, 0.3354845643043518, 0.3427940905094147]], [[0.3317447900772095, 0.33383315801620483, 0.33442211151123047], [0.3312934637069702, 0.33397477865219116, 0.334731787443161], [0.33116674423217773, 0.33401450514793396, 0.3348187506198883]], [[0.3300924599170685, 0.3359784185886383, 0.333929181098938], [0.32947131991386414, 0.33648696541786194, 0.3340417444705963], [0.3296862244606018, 0.33631089329719543, 0.334002822637558]], [[0.33093562722206116, 0.33568283915519714, 0.33338162302970886], [0.3290950357913971, 0.3374939560890198, 0.3334110379219055], [0.32998353242874146, 0.3366188406944275, 0.33339765667915344]], [[0.3331984877586365, 0.33453476428985596, 0.3322667181491852], [0.33319368958473206, 0.3345770835876465, 0.3322291970252991], [0.3332018256187439, 0.334505170583725, 0.33229297399520874]], [[0.3217945694923401, 0.3668139576911926, 0.31139153242111206], [0.30811363458633423, 0.4040336608886719, 0.2878526747226715], [0.3250162601470947, 0.35768723487854004, 0.31729644536972046]]], "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 119880, "num_module_steps_trained_lifetime_throughput": 654.7245815317067}, "__all_modules__": {"num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 239760, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 3440.7823297961995, "num_module_steps_trained_throughput": 19299119.77123345, "num_module_steps_trained_lifetime_throughput": 12066583.224366661}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.170873578079407e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2556426470047492e-05, "add_time_dim_to_batch_and_zero_pad": 7.121028682899318e-06, "batch_individual_items": 1.2653370943933834e-05, "add_observations_from_episodes_to_batch": 2.8713813802521536e-06, "add_states_from_episodes_to_batch": 2.73338612572733e-06}}, "connector_pipeline_timer": 6.032467274565839e-05}, "num_episodes_lifetime": 400, "sample": 0.12040234914935335, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 100400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011810088475576561, "timers": {"connectors": {"get_actions": 3.7660288316180455e-05, "remove_single_ts_time_rank_from_batch": 1.2352020889740848e-05, "normalize_and_clip_actions": 8.16663769416818e-06, "tensor_to_numpy": 1.5583915383810428e-05, "un_batch_to_individual_items": 6.883060889825934e-06, "listify_data_for_vector_env": 1.0866065575475441e-05}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.05}, "episode_duration_sec_mean": 0.00539232834125869, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "module_episode_returns_mean": {"default_policy": -0.05}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.4654902272466182e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.05, "episode_len_max": 20, "num_episodes": 20, "weights_seq_no": 20.0, "env_reset_timer": 0.0005980686567921806, "time_between_sampling": 11.014240930303357}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b1c4d_00000", "date": "2025-08-11_18-07-59", "timestamp": 1754928479, "time_this_iter_s": 11.307050943374634, "time_total_s": 224.5097017288208, "pid": 10209, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17bfb18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 224.5097017288208, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 45.535294117647055, "ram_util_percent": 81.77058823529411}}
