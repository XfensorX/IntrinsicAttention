{"timers": {"training_iteration": 10.176932999980636, "restore_env_runners": 1.2874952517449856e-05, "training_step": 10.176738500013016, "env_runner_sampling_timer": 1.6491060829721391, "learner_update_timer": 8.30774558300618, "synch_weights": 0.0016146249836310744}, "env_runners": {"weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_duration_sec_mean": 0.005349594514816999, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.541851962338038e-05, "normalize_and_clip_actions": 1.030128190352304e-05, "tensor_to_numpy": 1.575776004044444e-05, "un_batch_to_individual_items": 6.852286253336204e-06, "listify_data_for_vector_env": 1.0814295862794806e-05, "remove_single_ts_time_rank_from_batch": 1.2329000930286056e-05}}, "connector_pipeline_timer": 0.00012876792524341152}, "num_env_steps_sampled_lifetime": 627500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.344012126456452e-05, "add_observations_from_episodes_to_batch": 2.998182963779474e-06, "batch_individual_items": 1.2986972361372796e-05, "add_time_dim_to_batch_and_zero_pad": 7.442203573774576e-06, "add_states_from_episodes_to_batch": 2.8626150343718496e-06}}, "connector_pipeline_timer": 6.39768160466689e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "time_between_sampling": 0.0006640894879409684, "module_episode_returns_mean": {"default_policy": 1.0999999999999996}, "episode_return_min": -10.5, "env_step_timer": 1.4959745871641506e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.0999999999999996}, "episode_return_mean": 1.0999999999999996, "rlmodule_inference_timer": 3.5560180912397014e-05, "num_episodes_lifetime": 31375.0, "sample": 0.00649398424415337, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_reset_timer": 8.525018968716211e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3008.6101468116267}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.1776804159162566, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009419625042937696, "add_observations_from_episodes_to_batch": 0.0009133339626714587, "add_columns_from_episodes_to_train_batch": 0.04489908297546208, "add_time_dim_to_batch_and_zero_pad": 0.10533770907204598, "add_states_from_episodes_to_batch": 0.0038442080840468407, "batch_individual_items": 0.012993249925784767, "numpy_to_tensor": 6.845803000032902e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20453904569149017, "mean_kl_loss": 7.965802069520578e-06, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6904801726341248, "vf_loss": 0.26405924558639526, "diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained_lifetime": 35964, "policy_loss": -0.00011236008140258491, "weights_seq_no": 6.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.65879821777344, "vf_explained_var": -0.0015561580657958984}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 52355.48998114245}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35964, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3734.593247121559, "num_module_steps_trained_throughput": 33449660.619308967, "num_module_steps_trained_lifetime_throughput": 15605121.379833225}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime": 5994, "num_module_steps_trained_lifetime_throughput": 710.6405705408351}, "default_policy": {"policy_loss": -0.00011472822370706126, "weights_seq_no": 1.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 38.804412841796875, "curr_kl_coeff": 0.08079196512699127, "num_trainable_parameters": 16595, "vf_explained_var": -0.00608515739440918, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20390787720680237, "mean_kl_loss": 8.302547030325513e-06, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.690474271774292, "vf_loss": 0.26325201988220215, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5994, "num_module_steps_trained_lifetime_throughput": 710.6287805176255}, "IntrinsicAttentionMask": [[[0.33669593930244446, 0.3367311656475067, 0.32657283544540405], [0.336710661649704, 0.3367460370063782, 0.32654324173927307], [0.33236798644065857, 0.33235806226730347, 0.3352739214897156]], [[0.33446359634399414, 0.33355918526649475, 0.33197715878486633], [0.33224835991859436, 0.33311352133750916, 0.3346381187438965], [0.3283649981021881, 0.3323029577732086, 0.3393319845199585]], [[0.33526355028152466, 0.33237311244010925, 0.3323633372783661], [0.32638421654701233, 0.3367899954319, 0.33682581782341003], [0.32635432481765747, 0.3368048369884491, 0.33684083819389343]], [[0.33558303117752075, 0.3335411250591278, 0.33087581396102905], [0.334492027759552, 0.33344176411628723, 0.332066148519516], [0.33305928111076355, 0.3333072364330292, 0.3336334824562073]], [[0.3342568576335907, 0.3332541584968567, 0.3324889540672302], [0.33262574672698975, 0.33339300751686096, 0.3339812755584717], [0.3313797414302826, 0.33349594473838806, 0.33512431383132935]], [[0.34616565704345703, 0.3073454201221466, 0.346488893032074], [0.1570417582988739, 0.687725841999054, 0.15523242950439453], [0.3474827706813812, 0.304675817489624, 0.34784138202667236]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.146356311285537e-06, "un_batch_to_individual_items": 6.7904645031268645e-06, "tensor_to_numpy": 1.7640542097448487e-05, "listify_data_for_vector_env": 1.0321755155769813e-05, "remove_single_ts_time_rank_from_batch": 1.2871975785575648e-05, "get_actions": 4.976001554040485e-05}}, "connector_pipeline_timer": 0.0001332316721792717}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4267086333569384e-06, "batch_individual_items": 1.2718847994344258e-05, "numpy_to_tensor": 1.33763496872287e-05, "add_time_dim_to_batch_and_zero_pad": 8.204703392563634e-06, "add_states_from_episodes_to_batch": 2.823818225337718e-06}}, "connector_pipeline_timer": 6.547377891676712e-05}, "module_episode_returns_mean": {"default_policy": 1.2}, "rlmodule_inference_timer": 3.9519873958167966e-05, "num_episodes_lifetime": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12919374997727573, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.2, "episode_duration_sec_mean": 0.005856047960696742, "num_env_steps_sampled_lifetime": 5400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 1.2}, "env_reset_timer": 0.0005999170243740082, "env_step_timer": 1.551896816295777e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "weights_seq_no": 1.0, "num_agent_steps_sampled_lifetime": {"default_agent": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-18-45", "timestamp": 1754929125, "time_this_iter_s": 10.32039189338684, "time_total_s": 10.32039189338684, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.32039189338684, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.64666666666666, "ram_util_percent": 82.27333333333333}}
{"timers": {"training_iteration": 10.184371044561267, "restore_env_runners": 1.2844952289015055e-05, "training_step": 10.184175363343675, "env_runner_sampling_timer": 1.648368088803254, "learner_update_timer": 8.310947059675819, "synch_weights": 0.001613496234640479, "restore_eval_env_runners": 6.154191214591265e-05, "evaluation_iteration": 0.14102774998173118, "synch_eval_env_connectors": 0.00019445805810391903, "synch_env_connectors": 4.541943781077862e-06}, "env_runners": {"weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005408630170393736, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9773916456937384e-05, "normalize_and_clip_actions": 8.093974525713851e-06, "tensor_to_numpy": 1.553498319421493e-05, "un_batch_to_individual_items": 6.672323745370535e-06, "listify_data_for_vector_env": 1.0579301195989397e-05, "remove_single_ts_time_rank_from_batch": 1.208330631889522e-05}}, "connector_pipeline_timer": 0.00011952869439093311}, "num_env_steps_sampled_lifetime": 10000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2810987832891792e-05, "add_observations_from_episodes_to_batch": 2.8853171640969553e-06, "batch_individual_items": 1.2648755907276494e-05, "add_time_dim_to_batch_and_zero_pad": 7.052423903135164e-06, "add_states_from_episodes_to_batch": 2.8120859923337333e-06}}, "connector_pipeline_timer": 6.069176108374978e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "time_between_sampling": 0.03276122890741904, "module_episode_returns_mean": {"default_policy": 0.4600000000000001}, "episode_return_min": -10.5, "env_step_timer": 1.4145604198286925e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.4600000000000001}, "episode_return_mean": 0.4600000000000001, "rlmodule_inference_timer": 3.201700491492254e-05, "num_episodes_lifetime": 500.0, "sample": 0.005780479618958657, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.577220437354638e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3216.757868726759}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18156472300644963, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009467730881879107, "add_observations_from_episodes_to_batch": 0.000928912702947855, "add_columns_from_episodes_to_train_batch": 0.0449760358966887, "add_time_dim_to_batch_and_zero_pad": 0.10595045282156206, "add_states_from_episodes_to_batch": 0.003849409343674779, "batch_individual_items": 0.016115866176551207, "numpy_to_tensor": 7.072719978168607e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20402348041534424, "mean_kl_loss": 1.2813178727810737e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6902493238449097, "vf_loss": 0.26373037695884705, "diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained_lifetime": 71928, "policy_loss": -0.00037285356665961444, "weights_seq_no": 12.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 36.005680084228516, "vf_explained_var": -0.0016436576843261719}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 52057.80154121554}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 23976, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3730.7981373719936, "num_module_steps_trained_throughput": 32956213.326082025, "num_module_steps_trained_lifetime_throughput": 15528328.553290343}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime": 11988, "num_module_steps_trained_lifetime_throughput": 709.9183877965995}, "default_policy": {"policy_loss": -0.0003928696969524026, "weights_seq_no": 2.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 35.923099517822266, "curr_kl_coeff": 0.040395982563495636, "num_trainable_parameters": 16595, "vf_explained_var": -0.002199530601501465, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20356930792331696, "mean_kl_loss": 1.4358823136717547e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6902266144752502, "vf_loss": 0.2631741762161255, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 11988, "num_module_steps_trained_lifetime_throughput": 709.9067714422966}, "IntrinsicAttentionMask": [[[0.33669593930244446, 0.3367311656475067, 0.32657283544540405], [0.336710661649704, 0.3367460370063782, 0.32654324173927307], [0.33236798644065857, 0.33235806226730347, 0.3352739214897156]], [[0.33386677503585815, 0.3338583707809448, 0.3322748839855194], [0.3338570296764374, 0.333848774433136, 0.33229419589042664], [0.3320172429084778, 0.3320378363132477, 0.33594486117362976]], [[0.3325098156929016, 0.33374178409576416, 0.33374834060668945], [0.3288779556751251, 0.335543155670166, 0.3355788588523865], [0.32885879278182983, 0.33555272221565247, 0.33558857440948486]], [[0.33928197622299194, 0.3283817172050476, 0.33233627676963806], [0.33209168910980225, 0.33437323570251465, 0.3335350453853607], [0.33472001552581787, 0.3321745693683624, 0.3331054151058197]], [[0.3338068425655365, 0.3332929313182831, 0.3329002261161804], [0.3321765661239624, 0.3334304392337799, 0.3343930244445801], [0.3309312164783478, 0.33353233337402344, 0.3355364203453064]], [[0.3583580553531647, 0.2869764268398285, 0.3546655774116516], [0.14619150757789612, 0.6965777277946472, 0.15723073482513428], [0.3491879105567932, 0.3038797080516815, 0.34693244099617004]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.915126445295413e-06, "un_batch_to_individual_items": 6.54088697817698e-06, "tensor_to_numpy": 1.5614427888537366e-05, "listify_data_for_vector_env": 1.0252495546257233e-05, "remove_single_ts_time_rank_from_batch": 1.189719936943226e-05, "get_actions": 3.822177827250143e-05}}, "connector_pipeline_timer": 0.00011658654014884449}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.757771219348138e-06, "batch_individual_items": 1.2340479341131173e-05, "numpy_to_tensor": 1.2151866005113167e-05, "add_time_dim_to_batch_and_zero_pad": 6.910932371927782e-06, "add_states_from_episodes_to_batch": 2.6886192296121513e-06}}, "connector_pipeline_timer": 5.878240067386371e-05}, "module_episode_returns_mean": {"default_policy": 1.2}, "rlmodule_inference_timer": 3.201967457746174e-05, "num_episodes_lifetime": 40, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12907269830815493, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.2, "episode_duration_sec_mean": 0.005590869853040204, "num_env_steps_sampled_lifetime": 10400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 1.2}, "env_reset_timer": 0.0005973970144987106, "env_step_timer": 1.3763903201292447e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "weights_seq_no": 2.0, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "time_between_sampling": 10.979874499957077}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-18-56", "timestamp": 1754929136, "time_this_iter_s": 11.049237966537476, "time_total_s": 21.369629859924316, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.369629859924316, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.48125, "ram_util_percent": 82.36250000000001}}
{"timers": {"training_iteration": 10.193687501195306, "restore_env_runners": 1.2883173418231308e-05, "training_step": 10.193490796370222, "env_runner_sampling_timer": 1.6473690641643943, "learner_update_timer": 8.321234066159011, "synch_weights": 0.0016149791922420262, "restore_eval_env_runners": 6.1325243441388e-05, "evaluation_iteration": 0.1408744387316983, "synch_eval_env_connectors": 0.0001943055575247854, "synch_env_connectors": 4.5452744234353305e-06}, "env_runners": {"weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005304528506472705, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.02393657120032e-05, "normalize_and_clip_actions": 8.104413375641113e-06, "tensor_to_numpy": 1.551411793924922e-05, "un_batch_to_individual_items": 6.745360795533804e-06, "listify_data_for_vector_env": 1.0683806652819743e-05, "remove_single_ts_time_rank_from_batch": 1.2059450545897065e-05}}, "connector_pipeline_timer": 0.0001202292399201172}, "num_env_steps_sampled_lifetime": -607500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.285983330063351e-05, "add_observations_from_episodes_to_batch": 2.8521390851814323e-06, "batch_individual_items": 1.2768440725679224e-05, "add_time_dim_to_batch_and_zero_pad": 7.0713508878470186e-06, "add_states_from_episodes_to_batch": 2.807070342820038e-06}}, "connector_pipeline_timer": 6.112455008441837e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "time_between_sampling": 0.0380233171581298, "module_episode_returns_mean": {"default_policy": 0.7000000000000002}, "episode_return_min": -10.5, "env_step_timer": 1.4172880268036117e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.7000000000000002}, "episode_return_mean": 0.7000000000000002, "rlmodule_inference_timer": 3.207877872354724e-05, "num_episodes_lifetime": -30375.0, "sample": 0.005769737622679799, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.252671335079241e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3213.640093663482}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1815227678664494, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009462706913461443, "add_observations_from_episodes_to_batch": 0.0009283031553961337, "add_columns_from_episodes_to_train_batch": 0.04495464845844545, "add_time_dim_to_batch_and_zero_pad": 0.10595981287335743, "add_states_from_episodes_to_batch": 0.0038511031709145753, "batch_individual_items": 0.01609057084500091, "numpy_to_tensor": 7.087992734741419e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20397594571113586, "mean_kl_loss": 2.5099230697378516e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.689553439617157, "vf_loss": 0.2634417712688446, "diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained_lifetime": 107892, "policy_loss": -0.0001986440474865958, "weights_seq_no": 18.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 37.467506408691406, "vf_explained_var": -0.001633763313293457}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 51530.31749393549}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107892, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 35964, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3720.481193057068, "num_module_steps_trained_throughput": 32203519.054825816, "num_module_steps_trained_lifetime_throughput": 15397705.37598201}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime": 17982, "num_module_steps_trained_lifetime_throughput": 707.9551692554452}, "default_policy": {"policy_loss": -0.00020216240955051035, "weights_seq_no": 3.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.35596466064453, "curr_kl_coeff": 0.020197991281747818, "num_trainable_parameters": 16595, "vf_explained_var": 0.00013762712478637695, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2036897987127304, "mean_kl_loss": 2.5987519620684907e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.689542829990387, "vf_loss": 0.263082891702652, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 17982, "num_module_steps_trained_lifetime_throughput": 707.9438490181562}, "IntrinsicAttentionMask": [[[0.3334498703479767, 0.3340177536010742, 0.3325323760509491], [0.33347922563552856, 0.334191232919693, 0.33232948184013367], [0.33340218663215637, 0.3337368667125702, 0.33286091685295105]], [[0.33357855677604675, 0.33357471227645874, 0.3328467905521393], [0.333568811416626, 0.3335650861263275, 0.3328661024570465], [0.3317274749279022, 0.33175256848335266, 0.33651989698410034]], [[0.3343668282032013, 0.33281925320625305, 0.3328140079975128], [0.32549962401390076, 0.3372299373149872, 0.33727043867111206], [0.3254697322845459, 0.33724477887153625, 0.33728542923927307]], [[0.33795803785324097, 0.33100253343582153, 0.3310394585132599], [0.33439257740974426, 0.3327994644641876, 0.3328079879283905], [0.33441162109375, 0.3327898383140564, 0.3327985107898712]], [[0.33392515778541565, 0.3339158296585083, 0.33215901255607605], [0.3339154124259949, 0.3339062035083771, 0.3321782946586609], [0.33207595348358154, 0.3320956230163574, 0.33582836389541626]], [[0.34616562724113464, 0.307345449924469, 0.3464888632297516], [0.15704220533370972, 0.6877249479293823, 0.15523287653923035], [0.34748274087905884, 0.3046758770942688, 0.34784138202667236]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.058370656017828e-06, "un_batch_to_individual_items": 6.69643875799496e-06, "tensor_to_numpy": 1.579387172605851e-05, "listify_data_for_vector_env": 1.0348087273478878e-05, "remove_single_ts_time_rank_from_batch": 1.2440648463711542e-05, "get_actions": 3.922367429998299e-05}}, "connector_pipeline_timer": 0.00011877396599545676}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7903804489318165e-06, "batch_individual_items": 1.241654311698941e-05, "numpy_to_tensor": 1.2209253343954176e-05, "add_time_dim_to_batch_and_zero_pad": 7.046125148466906e-06, "add_states_from_episodes_to_batch": 2.79685046922649e-06}}, "connector_pipeline_timer": 5.927211904862442e-05}, "module_episode_returns_mean": {"default_policy": 0.5333333333333333}, "rlmodule_inference_timer": 3.310112021702219e-05, "num_episodes_lifetime": 60, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12897515632552092, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.5333333333333333, "episode_duration_sec_mean": 0.005534788164853429, "num_env_steps_sampled_lifetime": 15400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.5333333333333333}, "env_reset_timer": 0.0005953909639734774, "env_step_timer": 1.4091856863438116e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "weights_seq_no": 3.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "time_between_sampling": 10.98156549953739}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-19-08", "timestamp": 1754929148, "time_this_iter_s": 11.248693943023682, "time_total_s": 32.618323802948, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.618323802948, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.8625, "ram_util_percent": 82.35624999999999}}
{"timers": {"training_iteration": 10.199059517853899, "restore_env_runners": 1.2874752379721031e-05, "training_step": 10.198861676735623, "env_runner_sampling_timer": 1.646567938522882, "learner_update_timer": 8.327326365078079, "synch_weights": 0.00164962482085824, "restore_eval_env_runners": 6.116199094103648e-05, "evaluation_iteration": 0.14076186642471003, "synch_eval_env_connectors": 0.00019452750213677064, "synch_env_connectors": 4.5527417561970655e-06}, "env_runners": {"weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005363904666621241, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.982025159635969e-05, "normalize_and_clip_actions": 8.110429169278458e-06, "tensor_to_numpy": 1.5559673070993005e-05, "un_batch_to_individual_items": 6.685714638921319e-06, "listify_data_for_vector_env": 1.0691389987913565e-05, "remove_single_ts_time_rank_from_batch": 1.2072380267055109e-05}}, "connector_pipeline_timer": 0.00011974237999216814}, "num_env_steps_sampled_lifetime": -1225000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2957640079216063e-05, "add_observations_from_episodes_to_batch": 2.908008952050405e-06, "batch_individual_items": 1.270883508820822e-05, "add_time_dim_to_batch_and_zero_pad": 7.099556417364386e-06, "add_states_from_episodes_to_batch": 2.8218348286974384e-06}}, "connector_pipeline_timer": 6.10408606784505e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "time_between_sampling": 0.03927205600830655, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "episode_return_min": -10.5, "env_step_timer": 1.4182889574543693e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "episode_return_mean": 0.9399999999999996, "rlmodule_inference_timer": 3.189717410908447e-05, "num_episodes_lifetime": -61250.0, "sample": 0.00571390998985486, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.2793219793581286e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3198.2025444197116}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1814952676885626, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00945946026423492, "add_observations_from_episodes_to_batch": 0.0009275301246130838, "add_columns_from_episodes_to_train_batch": 0.044934275724896694, "add_time_dim_to_batch_and_zero_pad": 0.10598784057459246, "add_states_from_episodes_to_batch": 0.003852208389638457, "batch_individual_items": 0.01605907805676514, "numpy_to_tensor": 7.10402883591596e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20377510786056519, "mean_kl_loss": 2.0193674572510645e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6890097260475159, "vf_loss": 0.263287752866745, "diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained_lifetime": 143856, "policy_loss": -0.00027952485834248364, "weights_seq_no": 24.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 37.16044616699219, "vf_explained_var": -0.001665949821472168}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 287712, "num_env_steps_trained_lifetime": 756000, "num_env_steps_trained_lifetime_throughput": 50856.215974923456}, "intrinsic_reward_module": {"weights_seq_no": 24.0, "num_module_steps_trained_lifetime": 143856, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 47952, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3706.860281318453, "num_module_steps_trained_throughput": 31337631.19227726, "num_module_steps_trained_lifetime_throughput": 15226852.746686764}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime": 23976, "num_module_steps_trained_lifetime_throughput": 705.3632792538679}, "default_policy": {"policy_loss": -0.0002880638057831675, "weights_seq_no": 4.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.00374221801758, "curr_kl_coeff": 0.010098995640873909, "num_trainable_parameters": 16595, "vf_explained_var": 0.0011566877365112305, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20362700521945953, "mean_kl_loss": 2.1475843823282048e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6889917850494385, "vf_loss": 0.26311224699020386, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 23976, "num_module_steps_trained_lifetime_throughput": 705.3523081085795}, "IntrinsicAttentionMask": [[[0.33279046416282654, 0.33533474802970886, 0.3318747878074646], [0.33216801285743713, 0.3376115560531616, 0.33022040128707886], [0.3330138921737671, 0.3345127999782562, 0.3324732780456543]], [[0.33416563272476196, 0.33326205611228943, 0.332572340965271], [0.33253467082977295, 0.3334006369113922, 0.3340647220611572], [0.33128881454467773, 0.3335033655166626, 0.33520781993865967]], [[0.3323301076889038, 0.3332391083240509, 0.3344308137893677], [0.3311896324157715, 0.3331291973590851, 0.3356812000274658], [0.3297007083892822, 0.33298128843307495, 0.3373180031776428]], [[0.33852559328079224, 0.3307165205478668, 0.33075791597366333], [0.33495718240737915, 0.3325149118900299, 0.33252793550491333], [0.3349762558937073, 0.3325052559375763, 0.33251845836639404]], [[0.3331359624862671, 0.3323996663093567, 0.3344643712043762], [0.3335888683795929, 0.3345576226711273, 0.3318534791469574], [0.33229348063468933, 0.3285242021083832, 0.3391823172569275]], [[0.3477054536342621, 0.3066217005252838, 0.3456728458404541], [0.13647575676441193, 0.7160817980766296, 0.14744247496128082], [0.3382580280303955, 0.3241550624370575, 0.33758699893951416]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.367470888314408e-06, "un_batch_to_individual_items": 6.961664986581512e-06, "tensor_to_numpy": 1.6600155282106923e-05, "listify_data_for_vector_env": 1.0765251176691833e-05, "remove_single_ts_time_rank_from_batch": 1.249167703909243e-05, "get_actions": 4.1034361002163906e-05}}, "connector_pipeline_timer": 0.00012406900353446366}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9120367039677865e-06, "batch_individual_items": 1.3004124554822183e-05, "numpy_to_tensor": 1.3255068580915414e-05, "add_time_dim_to_batch_and_zero_pad": 7.196232955318153e-06, "add_states_from_episodes_to_batch": 2.796030685897912e-06}}, "connector_pipeline_timer": 6.201930734411272e-05}, "module_episode_returns_mean": {"default_policy": 0.45}, "rlmodule_inference_timer": 3.518336676442116e-05, "num_episodes_lifetime": 80, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.129096656432481, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.45, "episode_duration_sec_mean": 0.005747608837555163, "num_env_steps_sampled_lifetime": 20400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.45}, "env_reset_timer": 0.0005934587147585115, "env_step_timer": 1.5141350850105761e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "weights_seq_no": 4.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "time_between_sampling": 10.979390098711253}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-19-19", "timestamp": 1754929159, "time_this_iter_s": 10.889164924621582, "time_total_s": 43.50748872756958, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.50748872756958, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.38666666666668, "ram_util_percent": 81.69333333333333}}
{"timers": {"training_iteration": 10.198632992255414, "restore_env_runners": 1.289267419158714e-05, "training_step": 10.198434699128185, "env_runner_sampling_timer": 1.6459546678878687, "learner_update_timer": 8.327487828507465, "synch_weights": 0.001642554403444156, "restore_eval_env_runners": 6.121412113809492e-05, "evaluation_iteration": 0.14090469651037582, "synch_eval_env_connectors": 0.00019883472641266418, "synch_env_connectors": 4.56513445370365e-06}, "env_runners": {"weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005419986855704336, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0920852239729926e-05, "normalize_and_clip_actions": 8.16046009855292e-06, "tensor_to_numpy": 1.5715435379555353e-05, "un_batch_to_individual_items": 6.74808538852528e-06, "listify_data_for_vector_env": 1.0796435545790087e-05, "remove_single_ts_time_rank_from_batch": 1.213419960277961e-05}}, "connector_pipeline_timer": 0.00012139755563434599}, "num_env_steps_sampled_lifetime": -1842500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3103435958274685e-05, "add_observations_from_episodes_to_batch": 2.8694360616297426e-06, "batch_individual_items": 1.278487615714525e-05, "add_time_dim_to_batch_and_zero_pad": 7.124279247687435e-06, "add_states_from_episodes_to_batch": 2.826036466645157e-06}}, "connector_pipeline_timer": 6.131956870239953e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "time_between_sampling": 0.03800760180603248, "module_episode_returns_mean": {"default_policy": 0.3}, "episode_return_min": -10.5, "env_step_timer": 1.4380881128757642e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.3}, "episode_return_mean": 0.3, "rlmodule_inference_timer": 3.25818076110474e-05, "num_episodes_lifetime": -92125.0, "sample": 0.005789382594946428, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.5332129443561385e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3149.781019017147}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1814396716817586, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009457055250642239, "add_observations_from_episodes_to_batch": 0.0009267114931147824, "add_columns_from_episodes_to_train_batch": 0.044913863387377746, "add_time_dim_to_batch_and_zero_pad": 0.10598612508879068, "add_states_from_episodes_to_batch": 0.00385178922567639, "batch_individual_items": 0.01602982977571439, "numpy_to_tensor": 7.114905469328863e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20389077067375183, "mean_kl_loss": 1.0591347745503299e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6884371042251587, "vf_loss": 0.26319119334220886, "diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained_lifetime": 179820, "policy_loss": -8.796517067821696e-05, "weights_seq_no": 30.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.35197448730469, "vf_explained_var": -0.0016406774520874023}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 359640, "num_env_steps_trained_lifetime": 945000, "num_env_steps_trained_lifetime_throughput": 50094.20584026649}, "intrinsic_reward_module": {"weights_seq_no": 30.0, "num_module_steps_trained_lifetime": 179820, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 59940, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3693.8560616082696, "num_module_steps_trained_throughput": 30442892.644141775, "num_module_steps_trained_lifetime_throughput": 15070520.8059052}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime": 29970, "num_module_steps_trained_lifetime_throughput": 702.8887235149712}, "default_policy": {"policy_loss": -9.05800043256022e-05, "weights_seq_no": 5.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 38.24824523925781, "curr_kl_coeff": 0.0050494978204369545, "num_trainable_parameters": 16595, "vf_explained_var": 0.0017145872116088867, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2037767618894577, "mean_kl_loss": 1.0814795132318977e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6884326338768005, "vf_loss": 0.26305025815963745, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 29970, "num_module_steps_trained_lifetime_throughput": 702.8781538557625}, "IntrinsicAttentionMask": [[[0.33279046416282654, 0.33533474802970886, 0.3318747878074646], [0.33216801285743713, 0.3376115560531616, 0.33022040128707886], [0.3330138921737671, 0.3345127999782562, 0.3324732780456543]], [[0.3337153494358063, 0.33371150493621826, 0.33257314562797546], [0.33370018005371094, 0.3336964547634125, 0.3326033353805542], [0.3291964828968048, 0.32923752069473267, 0.3415660560131073]], [[0.332722932100296, 0.3336330056190491, 0.3336440920829773], [0.3320291042327881, 0.33397361636161804, 0.33399733901023865], [0.33202064037323, 0.33397769927978516, 0.3340016007423401]], [[0.3379580080509186, 0.33100253343582153, 0.3310394287109375], [0.33439257740974426, 0.3327994644641876, 0.3328079879283905], [0.33441162109375, 0.3327898383140564, 0.3327985107898712]], [[0.3325994610786438, 0.33261099457740784, 0.334789514541626], [0.332589715719223, 0.332601398229599, 0.33480891585350037], [0.3307432532310486, 0.33078354597091675, 0.33847320079803467]], [[0.35835790634155273, 0.2869766056537628, 0.3546654284000397], [0.1461927443742752, 0.6965752840042114, 0.15723197162151337], [0.34918785095214844, 0.3038797974586487, 0.34693238139152527]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.100913936808791e-06, "un_batch_to_individual_items": 6.676129664233589e-06, "tensor_to_numpy": 1.588270852009346e-05, "listify_data_for_vector_env": 1.0361144316942094e-05, "remove_single_ts_time_rank_from_batch": 1.2241620070631824e-05, "get_actions": 3.9547309545924476e-05}}, "connector_pipeline_timer": 0.00011987113106500265}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.826779508543272e-06, "batch_individual_items": 1.2564800187295168e-05, "numpy_to_tensor": 1.2507021230870613e-05, "add_time_dim_to_batch_and_zero_pad": 6.954760622542368e-06, "add_states_from_episodes_to_batch": 2.7022275468714033e-06}}, "connector_pipeline_timer": 5.980170009363208e-05}, "module_episode_returns_mean": {"default_policy": -0.4}, "rlmodule_inference_timer": 3.4234227541794595e-05, "num_episodes_lifetime": 100, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12898042444871957, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.4, "episode_duration_sec_mean": 0.005667723750229925, "num_env_steps_sampled_lifetime": 25400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_reset_timer": 0.0005909474679967061, "env_step_timer": 1.423063086771341e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "weights_seq_no": 5.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "time_between_sampling": 10.971509833553837}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-19-29", "timestamp": 1754929169, "time_this_iter_s": 10.285691022872925, "time_total_s": 53.793179750442505, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.793179750442505, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.45333333333333, "ram_util_percent": 81.62666666666665}}
{"timers": {"training_iteration": 10.210700414833191, "restore_env_runners": 1.282374790654087e-05, "training_step": 10.21050163713649, "env_runner_sampling_timer": 1.645044707039876, "learner_update_timer": 8.34046859564256, "synch_weights": 0.0016421796999048686, "restore_eval_env_runners": 6.069114940662053e-05, "evaluation_iteration": 0.14076072121416702, "synch_eval_env_connectors": 0.00019808720931852817, "synch_env_connectors": 4.5653123289102224e-06}, "env_runners": {"weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005338283124379811, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9648912958509665e-05, "normalize_and_clip_actions": 8.035546544404564e-06, "tensor_to_numpy": 1.5532414458746443e-05, "un_batch_to_individual_items": 6.682994031712231e-06, "listify_data_for_vector_env": 1.0671002018388284e-05, "remove_single_ts_time_rank_from_batch": 1.198657877776298e-05}}, "connector_pipeline_timer": 0.00011926688472875085}, "num_env_steps_sampled_lifetime": -2460000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.281796495970822e-05, "add_observations_from_episodes_to_batch": 2.877584615987106e-06, "batch_individual_items": 1.2777737635977071e-05, "add_time_dim_to_batch_and_zero_pad": 7.099056170925979e-06, "add_states_from_episodes_to_batch": 2.8162359615699568e-06}}, "connector_pipeline_timer": 6.088646134325706e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "time_between_sampling": 0.03558910896739415, "module_episode_returns_mean": {"default_policy": 0.06}, "episode_return_min": -10.5, "env_step_timer": 1.4161192482133797e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.06}, "episode_return_mean": 0.06, "rlmodule_inference_timer": 3.194142693146524e-05, "num_episodes_lifetime": -123000.0, "sample": 0.005758130721508093, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.352034707581925e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3198.137375147442}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1813782941350781, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009452020117965006, "add_observations_from_episodes_to_batch": 0.000925991457234548, "add_columns_from_episodes_to_train_batch": 0.04489516100309352, "add_time_dim_to_batch_and_zero_pad": 0.10597557758685665, "add_states_from_episodes_to_batch": 0.0038509563339901172, "batch_individual_items": 0.016004854397771162, "numpy_to_tensor": 7.131464416591919e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20287801325321198, "mean_kl_loss": 7.377143629128113e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6870477795600891, "vf_loss": 0.2631227970123291, "diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained_lifetime": 215784, "policy_loss": -0.0010597595246508718, "weights_seq_no": 36.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.5538444519043, "vf_explained_var": -0.0016064643859863281}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 431568, "num_env_steps_trained_lifetime": 1134000, "num_env_steps_trained_lifetime_throughput": 49259.06541230699}, "intrinsic_reward_module": {"weights_seq_no": 36.0, "num_module_steps_trained_lifetime": 215784, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 71928, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3676.499455626256, "num_module_steps_trained_throughput": 29542537.360573627, "num_module_steps_trained_lifetime_throughput": 14917733.28802811}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35964, "num_module_steps_trained_lifetime_throughput": 699.5859578317259}, "default_policy": {"policy_loss": -0.0010979435173794627, "weights_seq_no": 6.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.50529861450195, "curr_kl_coeff": 0.0025247489102184772, "num_trainable_parameters": 16595, "vf_explained_var": 0.0012312531471252441, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20276576280593872, "mean_kl_loss": 7.895802264101803e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6870015263557434, "vf_loss": 0.2630423605442047, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 35964, "num_module_steps_trained_lifetime_throughput": 699.5758244248742}, "IntrinsicAttentionMask": [[[0.33795487880706787, 0.3342511057853699, 0.3277939558029175], [0.335809588432312, 0.33383163809776306, 0.3303588330745697], [0.3320174217224121, 0.33306241035461426, 0.3349202573299408]], [[0.3341656029224396, 0.33326202630996704, 0.3325723111629486], [0.33253467082977295, 0.3334006369113922, 0.3340647220611572], [0.3312888443470001, 0.3335033655166626, 0.33520781993865967]], [[0.3343667984008789, 0.33281925320625305, 0.3328140079975128], [0.32549962401390076, 0.3372299373149872, 0.33727043867111206], [0.3254697620868683, 0.33724477887153625, 0.33728542923927307]], [[0.3355829417705536, 0.3308505713939667, 0.33356645703315735], [0.33304569125175476, 0.333651602268219, 0.33330267667770386], [0.3345056474208832, 0.33203813433647156, 0.33345627784729004]], [[0.3331369459629059, 0.3331439197063446, 0.3337191343307495], [0.33313265442848206, 0.3331398069858551, 0.33372762799263], [0.33277854323387146, 0.3327982723712921, 0.3344232141971588]], [[0.3583579361438751, 0.2869766056537628, 0.35466545820236206], [0.1461927592754364, 0.6965752243995667, 0.15723200142383575], [0.34918785095214844, 0.3038797676563263, 0.34693238139152527]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.024329843509378e-06, "un_batch_to_individual_items": 6.604237360910335e-06, "tensor_to_numpy": 1.5729239450244607e-05, "listify_data_for_vector_env": 1.0227554404795608e-05, "remove_single_ts_time_rank_from_batch": 1.1926350703037903e-05, "get_actions": 3.8275347871922615e-05}}, "connector_pipeline_timer": 0.00011717243980495898}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.831345522364965e-06, "batch_individual_items": 1.2445440756613873e-05, "numpy_to_tensor": 1.2150841637951925e-05, "add_time_dim_to_batch_and_zero_pad": 6.916055845894027e-06, "add_states_from_episodes_to_batch": 2.7116322648802796e-06}}, "connector_pipeline_timer": 5.9163715420398896e-05}, "module_episode_returns_mean": {"default_policy": -0.6}, "rlmodule_inference_timer": 3.2444533418752145e-05, "num_episodes_lifetime": 120, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12888548770410357, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.6, "episode_duration_sec_mean": 0.005580953740281985, "num_env_steps_sampled_lifetime": 30400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.6}, "env_reset_timer": 0.0005902704929962896, "env_step_timer": 1.3996188486979635e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "weights_seq_no": 6.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "time_between_sampling": 10.976140143548271}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-19-40", "timestamp": 1754929180, "time_this_iter_s": 11.537830829620361, "time_total_s": 65.33101058006287, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.33101058006287, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 45.38235294117647, "ram_util_percent": 82.43529411764706}}
{"timers": {"training_iteration": 10.220148183184808, "restore_env_runners": 1.2845930664808044e-05, "training_step": 10.219948550764967, "env_runner_sampling_timer": 1.6459202970592832, "learner_update_timer": 8.348929177185951, "synch_weights": 0.0016442499820129106, "restore_eval_env_runners": 6.06700677516647e-05, "evaluation_iteration": 0.14064628858223058, "synch_eval_env_connectors": 0.00019827466689078022, "synch_env_connectors": 4.575489665662882e-06}, "env_runners": {"weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005510253674350678, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1560665707837435e-05, "normalize_and_clip_actions": 8.27111880780896e-06, "tensor_to_numpy": 1.595745789849539e-05, "un_batch_to_individual_items": 6.770432841816171e-06, "listify_data_for_vector_env": 1.0798031073169973e-05, "remove_single_ts_time_rank_from_batch": 1.2273617450043311e-05}}, "connector_pipeline_timer": 0.00012282979984000288}, "num_env_steps_sampled_lifetime": -3077500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3415829632456493e-05, "add_observations_from_episodes_to_batch": 2.90611124577542e-06, "batch_individual_items": 1.2960683665371046e-05, "add_time_dim_to_batch_and_zero_pad": 7.205522036370414e-06, "add_states_from_episodes_to_batch": 2.8611282200931146e-06}}, "connector_pipeline_timer": 6.220493210617651e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "time_between_sampling": 0.04052690748078955, "module_episode_returns_mean": {"default_policy": 1.0999999999999996}, "episode_return_min": -10.5, "env_step_timer": 1.4566635670974462e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.0999999999999996}, "episode_return_mean": 1.0999999999999996, "rlmodule_inference_timer": 3.312082967009698e-05, "num_episodes_lifetime": -153875.0, "sample": 0.005823783306344869, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.49519161562163e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3128.534516850032}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18138432661404014, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009453523247483145, "add_observations_from_episodes_to_batch": 0.0009271727921314977, "add_columns_from_episodes_to_train_batch": 0.04488784731234698, "add_time_dim_to_batch_and_zero_pad": 0.10601900014121954, "add_states_from_episodes_to_batch": 0.003850141360350766, "batch_individual_items": 0.015973392513932712, "numpy_to_tensor": 7.148482808245232e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2033531367778778, "mean_kl_loss": 3.719863889273256e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6861956119537354, "vf_loss": 0.2630796432495117, "diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained_lifetime": 251748, "policy_loss": -0.0005464475834742188, "weights_seq_no": 42.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.3698616027832, "vf_explained_var": -0.0016353130340576172}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 503496, "num_env_steps_trained_lifetime": 1323000, "num_env_steps_trained_lifetime_throughput": 48381.01234020665}, "intrinsic_reward_module": {"weights_seq_no": 42.0, "num_module_steps_trained_lifetime": 251748, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 83916, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3659.8854941935224, "num_module_steps_trained_throughput": 28655529.8050471, "num_module_steps_trained_lifetime_throughput": 14755688.361637866}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime": 41958, "num_module_steps_trained_lifetime_throughput": 696.4244773435303}, "default_policy": {"policy_loss": -0.0005660962196998298, "weights_seq_no": 7.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 38.31037139892578, "curr_kl_coeff": 0.0012623744551092386, "num_trainable_parameters": 16595, "vf_explained_var": 0.0002429485321044922, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20328818261623383, "mean_kl_loss": 3.989790639025159e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6861592531204224, "vf_loss": 0.26302897930145264, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 41958, "num_module_steps_trained_lifetime_throughput": 696.4148228213106}, "IntrinsicAttentionMask": [[[0.33672016859054565, 0.33302992582321167, 0.3302498757839203], [0.33514732122421265, 0.3331732749938965, 0.33167940378189087], [0.33395272493362427, 0.3332793116569519, 0.33276796340942383]], [[0.3338525891304016, 0.3334375023841858, 0.3327099084854126], [0.33163806796073914, 0.3329886198043823, 0.3353733718395233], [0.32775604724884033, 0.3321724832057953, 0.3400714695453644]], [[0.3343667984008789, 0.33281925320625305, 0.3328140079975128], [0.32549962401390076, 0.3372299373149872, 0.33727043867111206], [0.3254697620868683, 0.33724477887153625, 0.33728542923927307]], [[0.34151220321655273, 0.32922330498695374, 0.3292645215988159], [0.3327004313468933, 0.33365142345428467, 0.3336481750011444], [0.33273032307624817, 0.33363640308380127, 0.33363330364227295]], [[0.3345874547958374, 0.3335837721824646, 0.3318287432193756], [0.3323720395565033, 0.33313873410224915, 0.3344891667366028], [0.3284884989261627, 0.33232933282852173, 0.33918216824531555]], [[0.31836000084877014, 0.365536630153656, 0.3161033093929291], [0.14535439014434814, 0.7207921147346497, 0.13385356962680817], [0.32662060856819153, 0.3478141129016876, 0.3255652189254761]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.371871716754526e-06, "un_batch_to_individual_items": 7.130467604150895e-06, "tensor_to_numpy": 1.764056112414463e-05, "listify_data_for_vector_env": 1.1409515420785093e-05, "remove_single_ts_time_rank_from_batch": 1.2360531133803563e-05, "get_actions": 4.349475525989017e-05}}, "connector_pipeline_timer": 0.0001286771874351454}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0028374626902772e-06, "batch_individual_items": 1.346005215097587e-05, "numpy_to_tensor": 1.362920775719604e-05, "add_time_dim_to_batch_and_zero_pad": 7.536784767792205e-06, "add_states_from_episodes_to_batch": 2.9002419182748563e-06}}, "connector_pipeline_timer": 6.451537229516447e-05}, "module_episode_returns_mean": {"default_policy": -1.4}, "rlmodule_inference_timer": 3.541126584905273e-05, "num_episodes_lifetime": 140, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12901269241747298, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.4, "episode_duration_sec_mean": 0.005798014583997428, "num_env_steps_sampled_lifetime": 35400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.4}, "env_reset_timer": 0.0005876394579142173, "env_step_timer": 1.5690984367129523e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "weights_seq_no": 7.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "time_between_sampling": 10.97824208461308}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-19-52", "timestamp": 1754929192, "time_this_iter_s": 11.310465812683105, "time_total_s": 76.64147639274597, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.64147639274597, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.29375, "ram_util_percent": 80.64375000000001}}
{"timers": {"training_iteration": 10.228167453852258, "restore_env_runners": 1.2807891138622944e-05, "training_step": 10.227967358587717, "env_runner_sampling_timer": 1.6493755986786691, "learner_update_timer": 8.352783789584066, "synch_weights": 0.0016446203925186069, "restore_eval_env_runners": 6.0519197087527506e-05, "evaluation_iteration": 0.140754781115524, "synch_eval_env_connectors": 0.00019813816943717725, "synch_env_connectors": 4.575154206817032e-06}, "env_runners": {"weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006930877695791423, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.838749750821937e-05, "normalize_and_clip_actions": 9.013070403045969e-06, "tensor_to_numpy": 1.7828896950387576e-05, "un_batch_to_individual_items": 7.443146695741941e-06, "listify_data_for_vector_env": 1.2031551949768533e-05, "remove_single_ts_time_rank_from_batch": 1.3359934725677489e-05}}, "connector_pipeline_timer": 0.0001378368358624664}, "num_env_steps_sampled_lifetime": -3695000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.5100694206853404e-05, "add_observations_from_episodes_to_batch": 3.2434725611186255e-06, "batch_individual_items": 1.4383467753390607e-05, "add_time_dim_to_batch_and_zero_pad": 8.079220497243997e-06, "add_states_from_episodes_to_batch": 3.1635685788575152e-06}}, "connector_pipeline_timer": 6.897808469539652e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "time_between_sampling": 0.03910754938412728, "module_episode_returns_mean": {"default_policy": 0.6199999999999999}, "episode_return_min": -10.5, "env_step_timer": 1.6526529953440395e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.6199999999999999}, "episode_return_mean": 0.6199999999999999, "rlmodule_inference_timer": 7.543080069608817e-05, "num_episodes_lifetime": -184750.0, "sample": 0.006531535056339612, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.848391631405405e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 2872.89066677614}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18187530209802602, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009477515934993668, "add_observations_from_episodes_to_batch": 0.0009275639841208074, "add_columns_from_episodes_to_train_batch": 0.04507957633874101, "add_time_dim_to_batch_and_zero_pad": 0.10628049388936389, "add_states_from_episodes_to_batch": 0.0038640332770083696, "batch_individual_items": 0.015972844838159413, "numpy_to_tensor": 7.178497938126604e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20368927717208862, "mean_kl_loss": 2.7485335522214882e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6851008534431458, "vf_loss": 0.263070672750473, "diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained_lifetime": 287712, "policy_loss": -0.0002034402423305437, "weights_seq_no": 48.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.27770233154297, "vf_explained_var": -0.001604318618774414}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 575424, "num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained_lifetime_throughput": 47486.44640644659}, "intrinsic_reward_module": {"weights_seq_no": 48.0, "num_module_steps_trained_lifetime": 287712, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 95904, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3644.1354138892693, "num_module_steps_trained_throughput": 27794706.15450798, "num_module_steps_trained_lifetime_throughput": 14607320.21383046}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime": 47952, "num_module_steps_trained_lifetime_throughput": 693.4273681457844}, "default_policy": {"policy_loss": -0.00020796443277504295, "weights_seq_no": 8.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.2617073059082, "curr_kl_coeff": 0.0006311872275546193, "num_trainable_parameters": 16595, "vf_explained_var": -0.00021779537200927734, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20366224646568298, "mean_kl_loss": 2.835546911228448e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6850860714912415, "vf_loss": 0.26304739713668823, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 47952, "num_module_steps_trained_lifetime_throughput": 693.4182029248877}, "IntrinsicAttentionMask": [[[0.33547040820121765, 0.33550551533699036, 0.32902413606643677], [0.3354797959327698, 0.33551502227783203, 0.3290051817893982], [0.33372586965560913, 0.3337322473526001, 0.33254188299179077]], [[0.33371567726135254, 0.33330073952674866, 0.3329836428165436], [0.3320855498313904, 0.3334379494190216, 0.3344764709472656], [0.3308403491973877, 0.3335396945476532, 0.3356199562549591]], [[0.3323301076889038, 0.3332391083240509, 0.3344308137893677], [0.3311896324157715, 0.3331291675567627, 0.33568117022514343], [0.3297007381916046, 0.33298128843307495, 0.3373180031776428]], [[0.3346824645996094, 0.33264610171318054, 0.3326714038848877], [0.3340281844139099, 0.33297938108444214, 0.33299246430397034], [0.33403635025024414, 0.33297523856163025, 0.3329884707927704]], [[0.3339763879776001, 0.3334622085094452, 0.33256131410598755], [0.3317617177963257, 0.33301401138305664, 0.3352242708206177], [0.3278794586658478, 0.33219897747039795, 0.3399215340614319]], [[0.30850937962532043, 0.3865417242050171, 0.3049488663673401], [0.1364631950855255, 0.738434374332428, 0.12510235607624054], [0.3170241415500641, 0.3683931827545166, 0.3145827054977417]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.139609978554335e-06, "un_batch_to_individual_items": 6.882257968164886e-06, "tensor_to_numpy": 1.8635348111556965e-05, "listify_data_for_vector_env": 1.0412350123910185e-05, "remove_single_ts_time_rank_from_batch": 1.2056701801142856e-05, "get_actions": 4.109085177636481e-05}}, "connector_pipeline_timer": 0.000124005799443902}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.860081887452652e-06, "batch_individual_items": 1.3246347763171855e-05, "numpy_to_tensor": 1.2732947278220474e-05, "add_time_dim_to_batch_and_zero_pad": 7.064895446176537e-06, "add_states_from_episodes_to_batch": 2.7492199867773126e-06}}, "connector_pipeline_timer": 6.124373340208102e-05}, "module_episode_returns_mean": {"default_policy": -1.4}, "rlmodule_inference_timer": 3.3497065086798345e-05, "num_episodes_lifetime": 160, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12896491382269518, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.4, "episode_duration_sec_mean": 0.005847711316309869, "num_env_steps_sampled_lifetime": 40400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.4}, "env_reset_timer": 0.0005855301432416132, "env_step_timer": 1.4736330477072429e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "weights_seq_no": 8.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "time_between_sampling": 10.978972236687365}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-20-03", "timestamp": 1754929203, "time_this_iter_s": 11.15837287902832, "time_total_s": 87.79984927177429, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.79984927177429, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.537499999999994, "ram_util_percent": 81.625}}
{"timers": {"training_iteration": 10.239613265143467, "restore_env_runners": 1.2831901860284296e-05, "training_step": 10.239411642081768, "env_runner_sampling_timer": 1.6483615472828625, "learner_update_timer": 8.363756855438531, "synch_weights": 0.0016502762684133087, "restore_eval_env_runners": 6.035150553761003e-05, "evaluation_iteration": 0.14068056038472473, "synch_eval_env_connectors": 0.00019803303835069837, "synch_env_connectors": 4.578152744917109e-06}, "env_runners": {"weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005306636320427061, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.972505397441934e-05, "normalize_and_clip_actions": 8.075736086115996e-06, "tensor_to_numpy": 1.5525399053512014e-05, "un_batch_to_individual_items": 6.666569283602486e-06, "listify_data_for_vector_env": 1.0585437574498894e-05, "remove_single_ts_time_rank_from_batch": 1.2058497746228837e-05}}, "connector_pipeline_timer": 0.00011943938501999263}, "num_env_steps_sampled_lifetime": -4312500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.294631550671942e-05, "add_observations_from_episodes_to_batch": 2.877157615176843e-06, "batch_individual_items": 1.2651902075338758e-05, "add_time_dim_to_batch_and_zero_pad": 7.073008429465581e-06, "add_states_from_episodes_to_batch": 2.8089810718142394e-06}}, "connector_pipeline_timer": 6.0884831849218904e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "time_between_sampling": 0.03745820082269544, "module_episode_returns_mean": {"default_policy": 0.3}, "episode_return_min": -10.5, "env_step_timer": 1.4118246700386425e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.3}, "episode_return_mean": 0.3, "rlmodule_inference_timer": 3.184658768284072e-05, "num_episodes_lifetime": -215625.0, "sample": 0.006530066425696734, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.6732404735142325e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3163.6141965786837}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1832864899063787, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009473150365109439, "add_observations_from_episodes_to_batch": 0.0009281966735094012, "add_columns_from_episodes_to_train_batch": 0.04505559057497973, "add_time_dim_to_batch_and_zero_pad": 0.10625693645048194, "add_states_from_episodes_to_batch": 0.0038648050243157406, "batch_individual_items": 0.017435480140135, "numpy_to_tensor": 7.177753895491042e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20350655913352966, "mean_kl_loss": 2.1355806893552653e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6844627261161804, "vf_loss": 0.26304614543914795, "diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained_lifetime": 323676, "policy_loss": -0.00036707334220409393, "weights_seq_no": 54.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.06313705444336, "vf_explained_var": -0.001638174057006836}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 647352, "num_env_steps_trained_lifetime": 1701000, "num_env_steps_trained_lifetime_throughput": 46590.4811304078}, "intrinsic_reward_module": {"weights_seq_no": 54.0, "num_module_steps_trained_lifetime": 323676, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 107892, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3625.9195244870834, "num_module_steps_trained_throughput": 26890987.01969513, "num_module_steps_trained_lifetime_throughput": 14378167.468155177}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime": 53946, "num_module_steps_trained_lifetime_throughput": 689.9612497608204}, "default_policy": {"policy_loss": -0.0003822960425168276, "weights_seq_no": 9.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 38.01418685913086, "curr_kl_coeff": 0.00031559361377730966, "num_trainable_parameters": 16595, "vf_explained_var": -0.00019109249114990234, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20346273481845856, "mean_kl_loss": 2.3118791432352737e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6844279766082764, "vf_loss": 0.2630137801170349, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 53946, "num_module_steps_trained_lifetime_throughput": 689.9524024005489}, "IntrinsicAttentionMask": [[[0.3334498703479767, 0.3340177536010742, 0.3325323760509491], [0.33347922563552856, 0.334191232919693, 0.33232951164245605], [0.33340218663215637, 0.3337368667125702, 0.33286094665527344]], [[0.3337153494358063, 0.33371150493621826, 0.33257314562797546], [0.33370018005371094, 0.3336964547634125, 0.3326033651828766], [0.3291964828968048, 0.32923752069473267, 0.3415660262107849]], [[0.33297309279441833, 0.333510160446167, 0.3335166871547699], [0.3322790265083313, 0.3338508903980255, 0.3338700830936432], [0.3322705626487732, 0.3338550329208374, 0.333874374628067]], [[0.3355829119682312, 0.3308505713939667, 0.33356645703315735], [0.33304569125175476, 0.333651602268219, 0.33330267667770386], [0.3345056474208832, 0.33203813433647156, 0.33345627784729004]], [[0.3331369459629059, 0.3331439197063446, 0.3337191343307495], [0.33313265442848206, 0.3331398069858551, 0.33372762799263], [0.33277854323387146, 0.3327982723712921, 0.3344232141971588]], [[0.3183600902557373, 0.36553654074668884, 0.31610339879989624], [0.1453552097082138, 0.720790445804596, 0.13385434448719025], [0.3266206383705139, 0.34781408309936523, 0.32556524872779846]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0408128877064573e-05, "un_batch_to_individual_items": 8.03898429940498e-06, "tensor_to_numpy": 2.0251199362596926e-05, "listify_data_for_vector_env": 1.3547607619168018e-05, "remove_single_ts_time_rank_from_batch": 1.4185464957325751e-05, "get_actions": 5.933917639783686e-05}}, "connector_pipeline_timer": 0.0001580558027872136}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.3616210432162042e-06, "batch_individual_items": 1.5487982170360568e-05, "numpy_to_tensor": 1.7171132746727983e-05, "add_time_dim_to_batch_and_zero_pad": 8.399742488050333e-06, "add_states_from_episodes_to_batch": 3.175969438272767e-06}}, "connector_pipeline_timer": 7.359753891174923e-05}, "module_episode_returns_mean": {"default_policy": -1.4}, "rlmodule_inference_timer": 4.4603391282287685e-05, "num_episodes_lifetime": 180, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13012767218470916, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.4, "episode_duration_sec_mean": 0.006816378815565258, "num_env_steps_sampled_lifetime": 45400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.4}, "env_reset_timer": 0.00058449901125498, "env_step_timer": 1.976467783498683e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 9.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "time_between_sampling": 10.983315523900457}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-20-15", "timestamp": 1754929215, "time_this_iter_s": 11.63495922088623, "time_total_s": 99.43480849266052, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.43480849266052, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 48.837500000000006, "ram_util_percent": 80.7625}}
{"timers": {"training_iteration": 10.252013872901252, "restore_env_runners": 1.2818582553194972e-05, "training_step": 10.251810291071333, "env_runner_sampling_timer": 1.6495889705601645, "learner_update_timer": 8.37485681438382, "synch_weights": 0.0016561510055740545, "restore_eval_env_runners": 6.020299045436875e-05, "evaluation_iteration": 0.14185895061120213, "synch_eval_env_connectors": 0.00019983687880712693, "synch_env_connectors": 4.581121297636185e-06}, "env_runners": {"weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006058227144181727, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.690158459191009e-05, "normalize_and_clip_actions": 9.077024311126395e-06, "tensor_to_numpy": 1.744573722318595e-05, "un_batch_to_individual_items": 7.374209914339725e-06, "listify_data_for_vector_env": 1.2134808144585229e-05, "remove_single_ts_time_rank_from_batch": 1.3162528293017876e-05}}, "connector_pipeline_timer": 0.0001356008881070452}, "num_env_steps_sampled_lifetime": -4930000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.5013687085687917e-05, "add_observations_from_episodes_to_batch": 3.1484507826074137e-06, "batch_individual_items": 1.418165844823279e-05, "add_time_dim_to_batch_and_zero_pad": 8.068822584371854e-06, "add_states_from_episodes_to_batch": 3.113948421604752e-06}}, "connector_pipeline_timer": 6.806806887081426e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "time_between_sampling": 0.040732751150688626, "module_episode_returns_mean": {"default_policy": 2.460000000000001}, "episode_return_min": -10.5, "env_step_timer": 1.6331403642691062e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 2.460000000000001}, "episode_return_mean": 2.460000000000001, "rlmodule_inference_timer": 3.683768011689791e-05, "num_episodes_lifetime": -246500.0, "sample": 0.0063883701655640035, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 5.3640196002257774e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 2894.710370057691}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18325388333808287, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009472035110963775, "add_observations_from_episodes_to_batch": 0.0009286005360561141, "add_columns_from_episodes_to_train_batch": 0.045052420919828286, "add_time_dim_to_batch_and_zero_pad": 0.1062686808367005, "add_states_from_episodes_to_batch": 0.003864066974028029, "batch_individual_items": 0.017396141168898427, "numpy_to_tensor": 7.196017437957208e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2038538157939911, "mean_kl_loss": 1.475418542895568e-07, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6844995021820068, "vf_loss": 0.26305970549583435, "diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained_lifetime": 359640, "policy_loss": -2.6889905711868778e-05, "weights_seq_no": 60.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 37.146610260009766, "vf_explained_var": -0.0016727447509765625}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 719280, "num_env_steps_trained_lifetime": 1890000, "num_env_steps_trained_lifetime_throughput": 45698.264855822454}, "intrinsic_reward_module": {"weights_seq_no": 60.0, "num_module_steps_trained_lifetime": 359640, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 119880, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3606.2808207399985, "num_module_steps_trained_throughput": 26049037.172700755, "num_module_steps_trained_lifetime_throughput": 14185980.920057325}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime": 59940, "num_module_steps_trained_lifetime_throughput": 686.224236112706}, "default_policy": {"policy_loss": -2.7739286451833323e-05, "weights_seq_no": 10.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.078857421875, "curr_kl_coeff": 0.00015779680688865483, "num_trainable_parameters": 16595, "vf_explained_var": -0.0003355741500854492, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20383979380130768, "mean_kl_loss": 1.4489195621081308e-07, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6844962239265442, "vf_loss": 0.2630428671836853, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 59940, "num_module_steps_trained_lifetime_throughput": 686.2158098106977}, "IntrinsicAttentionMask": [[[0.33795487880706787, 0.3342511057853699, 0.32779398560523987], [0.335809588432312, 0.33383163809776306, 0.3303588330745697], [0.3320174217224121, 0.33306238055229187, 0.3349202275276184]], [[0.33311107754707336, 0.3331190049648285, 0.33376991748809814], [0.33310678601264954, 0.3331148624420166, 0.33377838134765625], [0.33275264501571655, 0.3327732980251312, 0.33447402715682983]], [[0.3325098156929016, 0.33374178409576416, 0.33374834060668945], [0.3288780152797699, 0.335543155670166, 0.3355788588523865], [0.3288588225841522, 0.3355526924133301, 0.3355885446071625]], [[0.34001222252845764, 0.32777732610702515, 0.3322104513645172], [0.3328154981136322, 0.33376678824424744, 0.33341774344444275], [0.33544620871543884, 0.3315688371658325, 0.33298495411872864]], [[0.3325994610786438, 0.33261099457740784, 0.334789514541626], [0.332589715719223, 0.332601398229599, 0.33480891585350037], [0.3307432532310486, 0.33078354597091675, 0.3384731709957123]], [[0.3165733218193054, 0.36649468541145325, 0.3169320225715637], [0.1250191181898117, 0.7482197880744934, 0.12676109373569489], [0.3150869905948639, 0.3694379925727844, 0.3154750168323517]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0024498239764827e-05, "un_batch_to_individual_items": 7.29545138216e-06, "tensor_to_numpy": 1.922101324181677e-05, "listify_data_for_vector_env": 1.2590442609141454e-05, "remove_single_ts_time_rank_from_batch": 1.3522312611669412e-05, "get_actions": 4.981345745135448e-05}}, "connector_pipeline_timer": 0.00014287843499286777}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7488071209366177e-06, "batch_individual_items": 1.5653247475503896e-05, "numpy_to_tensor": 1.5640714511375955e-05, "add_time_dim_to_batch_and_zero_pad": 8.550673595091112e-06, "add_states_from_episodes_to_batch": 3.896054998994055e-06}}, "connector_pipeline_timer": 7.492489992009353e-05}, "module_episode_returns_mean": {"default_policy": 0.0}, "rlmodule_inference_timer": 4.1483969781443594e-05, "num_episodes_lifetime": 200, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13035904421227876, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.0, "episode_duration_sec_mean": 0.007140927974833175, "num_env_steps_sampled_lifetime": 50400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_reset_timer": 0.0005825973515179078, "env_step_timer": 1.7465740327691393e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 10.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "time_between_sampling": 10.988742906991055}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-20-26", "timestamp": 1754929226, "time_this_iter_s": 11.649477005004883, "time_total_s": 111.0842854976654, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.0842854976654, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 48.48823529411764, "ram_util_percent": 81.86470588235295}}
{"timers": {"training_iteration": 10.25540910876279, "restore_env_runners": 1.2797476704832655e-05, "training_step": 10.255204661080647, "env_runner_sampling_timer": 1.650691394604331, "learner_update_timer": 8.377083032069876, "synch_weights": 0.0016568486548765324, "restore_eval_env_runners": 6.012804139677548e-05, "evaluation_iteration": 0.14210599735490803, "synch_eval_env_connectors": 0.00020124100973392193, "synch_env_connectors": 4.586979861099489e-06}, "env_runners": {"weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006011110673192891, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.686559337659821e-05, "normalize_and_clip_actions": 8.948118163929297e-06, "tensor_to_numpy": 1.730087064511273e-05, "un_batch_to_individual_items": 7.262599985491356e-06, "listify_data_for_vector_env": 1.1815292075702275e-05, "remove_single_ts_time_rank_from_batch": 1.3231561496017084e-05}}, "connector_pipeline_timer": 0.00013469789187151165}, "num_env_steps_sampled_lifetime": -5547500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4774240519847224e-05, "add_observations_from_episodes_to_batch": 3.1446851426870414e-06, "batch_individual_items": 1.4141957355919264e-05, "add_time_dim_to_batch_and_zero_pad": 8.039396514997328e-06, "add_states_from_episodes_to_batch": 3.053602188804465e-06}}, "connector_pipeline_timer": 6.737924538130007e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "time_between_sampling": 0.04023554426441959, "module_episode_returns_mean": {"default_policy": 1.1800000000000002}, "episode_return_min": -10.5, "env_step_timer": 1.624794407946422e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.1800000000000002}, "episode_return_mean": 1.1800000000000002, "rlmodule_inference_timer": 3.625680738540172e-05, "num_episodes_lifetime": -277375.0, "sample": 0.0064703568047280455, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 6.0096907417953456e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 2891.460098548991}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1832387524154141, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009496825589535667, "add_observations_from_episodes_to_batch": 0.0009290211913350477, "add_columns_from_episodes_to_train_batch": 0.045040438371180984, "add_time_dim_to_batch_and_zero_pad": 0.10627439652915664, "add_states_from_episodes_to_batch": 0.003868770474841358, "batch_individual_items": 0.01735769350618305, "numpy_to_tensor": 7.209765250304993e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20369940996170044, "mean_kl_loss": 2.1228806872386485e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6835337281227112, "vf_loss": 0.2630327343940735, "diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained_lifetime": 395604, "policy_loss": -0.0001651666680118069, "weights_seq_no": 66.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 37.73297882080078, "vf_explained_var": -0.0016124248504638672}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 791208, "num_env_steps_trained_lifetime": 2079000, "num_env_steps_trained_lifetime_throughput": 44826.73979949484}, "intrinsic_reward_module": {"weights_seq_no": 66.0, "num_module_steps_trained_lifetime": 395604, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 131868, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3589.0809245940454, "num_module_steps_trained_throughput": 25284699.643463545, "num_module_steps_trained_lifetime_throughput": 14034120.111270431}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime": 65934, "num_module_steps_trained_lifetime_throughput": 682.9512873922937}, "default_policy": {"policy_loss": -0.00016860556206665933, "weights_seq_no": 11.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.669212341308594, "curr_kl_coeff": 7.889840344432741e-05, "num_trainable_parameters": 16595, "vf_explained_var": 0.00014394521713256836, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20368686318397522, "mean_kl_loss": 2.1874564481549896e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6835199594497681, "vf_loss": 0.2630254328250885, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 65934, "num_module_steps_trained_lifetime_throughput": 682.9432801348239}, "IntrinsicAttentionMask": [[[0.33795487880706787, 0.3342511057853699, 0.32779398560523987], [0.335809588432312, 0.33383163809776306, 0.3303588330745697], [0.3320174217224121, 0.33306238055229187, 0.3349202275276184]], [[0.3331098258495331, 0.332276850938797, 0.3346133232116699], [0.33356335759162903, 0.3344346582889557, 0.3320019245147705], [0.332266241312027, 0.328401654958725, 0.33933210372924805]], [[0.3352634906768799, 0.33237311244010925, 0.3323633372783661], [0.3263842761516571, 0.33678996562957764, 0.33682578802108765], [0.32635435461997986, 0.3368048071861267, 0.33684080839157104]], [[0.3359224200248718, 0.3320283889770508, 0.3320491313934326], [0.3323677182197571, 0.33382004499435425, 0.33381223678588867], [0.33238670229911804, 0.3338104486465454, 0.33380281925201416]], [[0.3339763879776001, 0.3334622085094452, 0.33256134390830994], [0.3317617177963257, 0.33301401138305664, 0.3352242708206177], [0.32787951827049255, 0.33219900727272034, 0.3399215340614319]], [[0.3611231744289398, 0.2857399582862854, 0.3531368672847748], [0.12625806033611298, 0.724553108215332, 0.1491888165473938], [0.3387734293937683, 0.32390257716178894, 0.33732402324676514]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.904206704055762e-06, "un_batch_to_individual_items": 6.513915069520245e-06, "tensor_to_numpy": 1.5407121337179074e-05, "listify_data_for_vector_env": 1.0152782214527426e-05, "remove_single_ts_time_rank_from_batch": 1.1895240291785132e-05, "get_actions": 3.714932938047571e-05}}, "connector_pipeline_timer": 0.00011519066159371198}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7482155066412085e-06, "batch_individual_items": 1.2307523330682552e-05, "numpy_to_tensor": 1.186971201430664e-05, "add_time_dim_to_batch_and_zero_pad": 6.774564354149077e-06, "add_states_from_episodes_to_batch": 2.6769030777294417e-06}}, "connector_pipeline_timer": 5.838453236072684e-05}, "module_episode_returns_mean": {"default_policy": -0.2}, "rlmodule_inference_timer": 3.161238472317196e-05, "num_episodes_lifetime": 220, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1302066066903667, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.2, "episode_duration_sec_mean": 0.007106452552834526, "num_env_steps_sampled_lifetime": 55400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_reset_timer": 0.000579985127735551, "env_step_timer": 1.3735468979879535e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 11.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "time_between_sampling": 10.98513276959112}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-20-37", "timestamp": 1754929237, "time_this_iter_s": 10.7186279296875, "time_total_s": 121.8029134273529, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.8029134273529, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.88666666666667, "ram_util_percent": 81.53999999999999}}
{"timers": {"training_iteration": 10.272204206005977, "restore_env_runners": 1.277950161122538e-05, "training_step": 10.271999457380003, "env_runner_sampling_timer": 1.6504897494074164, "learner_update_timer": 8.394126522588886, "synch_weights": 0.0016497747481905704, "restore_eval_env_runners": 5.990509098814055e-05, "evaluation_iteration": 0.141925565720942, "synch_eval_env_connectors": 0.00020082110070320782, "synch_env_connectors": 4.584860104584274e-06}, "env_runners": {"weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.0055779751925729235, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.220309859287774e-05, "normalize_and_clip_actions": 8.426472918866716e-06, "tensor_to_numpy": 1.619616322556809e-05, "un_batch_to_individual_items": 6.879381905452588e-06, "listify_data_for_vector_env": 1.1086419771728704e-05, "remove_single_ts_time_rank_from_batch": 1.2439678446266251e-05}}, "connector_pipeline_timer": 0.0001247014622342342}, "num_env_steps_sampled_lifetime": -6165000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.370935256760478e-05, "add_observations_from_episodes_to_batch": 2.960981527332972e-06, "batch_individual_items": 1.3121435823441333e-05, "add_time_dim_to_batch_and_zero_pad": 7.4200412695037404e-06, "add_states_from_episodes_to_batch": 2.8778047813763444e-06}}, "connector_pipeline_timer": 6.324215720868939e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "time_between_sampling": 0.036743512860279645, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "episode_return_min": -10.5, "env_step_timer": 1.4886307522314201e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "episode_return_mean": 0.9399999999999996, "rlmodule_inference_timer": 3.361831560438583e-05, "num_episodes_lifetime": -308250.0, "sample": 0.005977653641645535, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.8331934695926285e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3090.006252211423}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18314266739045365, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009493466503835027, "add_observations_from_episodes_to_batch": 0.0009290430596410852, "add_columns_from_episodes_to_train_batch": 0.04501706190726454, "add_time_dim_to_batch_and_zero_pad": 0.10624929631476175, "add_states_from_episodes_to_batch": 0.0038707531903689456, "batch_individual_items": 0.017312109900782188, "numpy_to_tensor": 7.216708595463593e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20374253392219543, "mean_kl_loss": 1.56858022819506e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6826767325401306, "vf_loss": 0.26302841305732727, "diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained_lifetime": 431568, "policy_loss": -0.00011909897875739262, "weights_seq_no": 72.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.0580940246582, "vf_explained_var": -0.0015984773635864258}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 863136, "num_env_steps_trained_lifetime": 2268000, "num_env_steps_trained_lifetime_throughput": 43971.90545327563}, "intrinsic_reward_module": {"weights_seq_no": 72.0, "num_module_steps_trained_lifetime": 431568, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 143856, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3569.9470240121827, "num_module_steps_trained_throughput": 24572137.85034362, "num_module_steps_trained_lifetime_throughput": 13906558.493211266}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained_lifetime_throughput": 679.3103205898068}, "default_policy": {"policy_loss": -0.00012146110384492204, "weights_seq_no": 12.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.99447250366211, "curr_kl_coeff": 3.944920172216371e-05, "num_trainable_parameters": 16595, "vf_explained_var": 0.0003789663314819336, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2037382423877716, "mean_kl_loss": 1.618880378373433e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6826639771461487, "vf_loss": 0.26302915811538696, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained_lifetime_throughput": 679.3027278745164}, "IntrinsicAttentionMask": [[[0.3334498703479767, 0.3340177536010742, 0.3325323760509491], [0.33347922563552856, 0.334191232919693, 0.33232954144477844], [0.33340218663215637, 0.3337368667125702, 0.33286094665527344]], [[0.33371567726135254, 0.33330076932907104, 0.3329836428165436], [0.3320855498313904, 0.3334379494190216, 0.3344764709472656], [0.3308403491973877, 0.3335396647453308, 0.3356199264526367]], [[0.33491531014442444, 0.33306655287742615, 0.3320181667804718], [0.3302474915981293, 0.33384349942207336, 0.335908979177475], [0.32760176062583923, 0.33427000045776367, 0.3381282687187195]], [[0.34151217341423035, 0.32922330498695374, 0.3292645215988159], [0.3327004313468933, 0.3336513936519623, 0.333648145198822], [0.33273035287857056, 0.33363640308380127, 0.33363330364227295]], [[0.3325994610786438, 0.33261099457740784, 0.334789514541626], [0.332589715719223, 0.332601398229599, 0.33480891585350037], [0.3307432532310486, 0.33078354597091675, 0.3384731709957123]], [[0.31657329201698303, 0.36649468541145325, 0.3169320225715637], [0.12501902878284454, 0.7482200860977173, 0.12676097452640533], [0.3150870203971863, 0.3694380223751068, 0.3154750168323517]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.052656805542726e-06, "un_batch_to_individual_items": 7.48350591842215e-06, "tensor_to_numpy": 1.865621914986066e-05, "listify_data_for_vector_env": 1.2683450654840693e-05, "remove_single_ts_time_rank_from_batch": 1.2988469325173526e-05, "get_actions": 5.464399066998463e-05}}, "connector_pipeline_timer": 0.0001466051954049179}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.022698903780264e-06, "batch_individual_items": 1.5211954946781185e-05, "numpy_to_tensor": 1.578403119399025e-05, "add_time_dim_to_batch_and_zero_pad": 7.87271788046184e-06, "add_states_from_episodes_to_batch": 3.564255228374324e-06}}, "connector_pipeline_timer": 6.930269062342251e-05}, "module_episode_returns_mean": {"default_policy": 0.4}, "rlmodule_inference_timer": 4.101369467580387e-05, "num_episodes_lifetime": 240, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13018720479418458, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.4, "episode_duration_sec_mean": 0.006990157113177702, "num_env_steps_sampled_lifetime": 60400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.4}, "env_reset_timer": 0.0005776744462160087, "env_step_timer": 1.759687511987491e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 12.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "time_between_sampling": 10.994931682305326}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-20-49", "timestamp": 1754929249, "time_this_iter_s": 12.077578067779541, "time_total_s": 133.88049149513245, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 133.88049149513245, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 47.82941176470588, "ram_util_percent": 81.89411764705882}}
{"timers": {"training_iteration": 10.282431331445235, "restore_env_runners": 1.271753713129982e-05, "training_step": 10.282226380726112, "env_runner_sampling_timer": 1.6502674264943245, "learner_update_timer": 8.404445623203744, "synch_weights": 0.0016486020009854538, "restore_eval_env_runners": 5.942437043213013e-05, "evaluation_iteration": 0.1418839179841725, "synch_eval_env_connectors": 0.0002001241394943395, "synch_env_connectors": 4.5802621086745866e-06}, "env_runners": {"weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005570051356218757, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.180741016957559e-05, "normalize_and_clip_actions": 8.315852295111608e-06, "tensor_to_numpy": 1.616645392085066e-05, "un_batch_to_individual_items": 6.795450638370392e-06, "listify_data_for_vector_env": 1.1047096262522833e-05, "remove_single_ts_time_rank_from_batch": 1.2523403580609699e-05}}, "connector_pipeline_timer": 0.00012417670490141638}, "num_env_steps_sampled_lifetime": -6782500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3450856272563032e-05, "add_observations_from_episodes_to_batch": 2.9113571562571857e-06, "batch_individual_items": 1.3152458026493386e-05, "add_time_dim_to_batch_and_zero_pad": 7.267350706540929e-06, "add_states_from_episodes_to_batch": 2.8533814639732128e-06}}, "connector_pipeline_timer": 6.257843726765375e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "time_between_sampling": 0.04194003454885749, "module_episode_returns_mean": {"default_policy": 1.9799999999999998}, "episode_return_min": -10.5, "env_step_timer": 1.483505729384743e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.9799999999999998}, "episode_return_mean": 1.9799999999999998, "rlmodule_inference_timer": 3.3135563878011775e-05, "num_episodes_lifetime": -339125.0, "sample": 0.005944999987249612, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.7863028890798796e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3123.5039607700014}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1831442911270452, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009491241839259507, "add_observations_from_episodes_to_batch": 0.0009286013786114975, "add_columns_from_episodes_to_train_batch": 0.045027843787607616, "add_time_dim_to_batch_and_zero_pad": 0.10627868001138929, "add_states_from_episodes_to_batch": 0.003877379408778404, "batch_individual_items": 0.01727008880235514, "numpy_to_tensor": 7.21862449502932e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20383568108081818, "mean_kl_loss": 2.351053808524739e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6821678876876831, "vf_loss": 0.26303115487098694, "diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained_lifetime": 467532, "policy_loss": -3.0143528420012444e-05, "weights_seq_no": 78.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 35.595882415771484, "vf_explained_var": -0.0017050504684448242}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 935064, "num_env_steps_trained_lifetime": 2457000, "num_env_steps_trained_lifetime_throughput": 43140.13436664254}, "intrinsic_reward_module": {"weights_seq_no": 78.0, "num_module_steps_trained_lifetime": 467532, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 155844, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3550.5003582680247, "num_module_steps_trained_throughput": 23883593.1307728, "num_module_steps_trained_lifetime_throughput": 13778513.404437758}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime": 77922, "num_module_steps_trained_lifetime_throughput": 675.609841505451}, "default_policy": {"policy_loss": -3.115185609203763e-05, "weights_seq_no": 13.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 35.48710250854492, "curr_kl_coeff": 1.9724600861081854e-05, "num_trainable_parameters": 16595, "vf_explained_var": 5.418062210083008e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20382963120937347, "mean_kl_loss": 2.3511536710429937e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6821678280830383, "vf_loss": 0.2630296051502228, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 77922, "num_module_steps_trained_lifetime_throughput": 675.6026566400748}, "IntrinsicAttentionMask": [[[0.3334498703479767, 0.3340177536010742, 0.3325323760509491], [0.33347922563552856, 0.334191232919693, 0.33232954144477844], [0.33340218663215637, 0.3337368667125702, 0.33286094665527344]], [[0.3329803943634033, 0.3316710293292999, 0.335348516702652], [0.33343708515167236, 0.33382824063301086, 0.33273470401763916], [0.3321312665939331, 0.3277970850467682, 0.3400716483592987]], [[0.3352634906768799, 0.33237308263778687, 0.3323633372783661], [0.3263842761516571, 0.33678996562957764, 0.33682578802108765], [0.32635435461997986, 0.3368048071861267, 0.33684080839157104]], [[0.34151217341423035, 0.32922330498695374, 0.3292645215988159], [0.3327004313468933, 0.33365142345428467, 0.3336481750011444], [0.33273035287857056, 0.33363640308380127, 0.33363330364227295]], [[0.33363696932792664, 0.3336321711540222, 0.33273082971572876], [0.33362722396850586, 0.33362260460853577, 0.332750141620636], [0.33178627490997314, 0.33181047439575195, 0.3364033102989197]], [[0.3611232042312622, 0.285739928483963, 0.35313689708709717], [0.12625785171985626, 0.7245535850524902, 0.14918860793113708], [0.3387734293937683, 0.32390257716178894, 0.33732402324676514]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.493584425431289e-06, "un_batch_to_individual_items": 7.0371043940835644e-06, "tensor_to_numpy": 1.677119090858449e-05, "listify_data_for_vector_env": 1.0834052278351414e-05, "remove_single_ts_time_rank_from_batch": 1.2549497505339752e-05, "get_actions": 4.423447061343624e-05}}, "connector_pipeline_timer": 0.00012737331052959283}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9247000029692237e-06, "batch_individual_items": 1.3931569696241957e-05, "numpy_to_tensor": 1.3394038633304423e-05, "add_time_dim_to_batch_and_zero_pad": 7.418450451279614e-06, "add_states_from_episodes_to_batch": 3.218503086231017e-06}}, "connector_pipeline_timer": 6.408382113586352e-05}, "module_episode_returns_mean": {"default_policy": 0.2}, "rlmodule_inference_timer": 3.6363630758486075e-05, "num_episodes_lifetime": 260, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1301596994160652, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.2, "episode_duration_sec_mean": 0.007017129613086581, "num_env_steps_sampled_lifetime": 65400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.2}, "env_reset_timer": 0.0005751418614970385, "env_step_timer": 1.5143615523645408e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 13.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "time_between_sampling": 10.99827791965289}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-21-01", "timestamp": 1754929261, "time_this_iter_s": 11.442704916000366, "time_total_s": 145.3231964111328, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.3231964111328, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 46.682352941176475, "ram_util_percent": 82.48823529411766}}
{"timers": {"training_iteration": 10.294091190211194, "restore_env_runners": 1.2819952565234247e-05, "training_step": 10.293885483168815, "env_runner_sampling_timer": 1.6520226259792072, "learner_update_timer": 8.414293633221815, "synch_weights": 0.001647329311019079, "restore_eval_env_runners": 5.9248457037721395e-05, "evaluation_iteration": 0.14182699089396358, "synch_eval_env_connectors": 0.00019957081832123148, "synch_env_connectors": 4.57403953285578e-06}, "env_runners": {"weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006323909822385757, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.4506730491264385e-05, "normalize_and_clip_actions": 8.490693638424168e-06, "tensor_to_numpy": 1.669922837250563e-05, "un_batch_to_individual_items": 7.050918900601498e-06, "listify_data_for_vector_env": 1.1492239985303808e-05, "remove_single_ts_time_rank_from_batch": 1.2808593338866173e-05}}, "connector_pipeline_timer": 0.0001293499694706226}, "num_env_steps_sampled_lifetime": -7400000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.412692121652559e-05, "add_observations_from_episodes_to_batch": 3.0342527193429107e-06, "batch_individual_items": 1.3447901733293414e-05, "add_time_dim_to_batch_and_zero_pad": 7.6219129713951e-06, "add_states_from_episodes_to_batch": 2.9881496471450023e-06}}, "connector_pipeline_timer": 6.488976931504434e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "time_between_sampling": 0.04001876425742665, "module_episode_returns_mean": {"default_policy": 1.1800000000000002}, "episode_return_min": -10.5, "env_step_timer": 1.5475178064534875e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.1800000000000002}, "episode_return_mean": 1.1800000000000002, "rlmodule_inference_timer": 6.680542906183967e-05, "num_episodes_lifetime": -370000.0, "sample": 0.006544509834909044, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 5.052161015056368e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 2982.961646351647}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18311425279624863, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00949589734083647, "add_observations_from_episodes_to_batch": 0.0009287332840346095, "add_columns_from_episodes_to_train_batch": 0.04503108701957385, "add_time_dim_to_batch_and_zero_pad": 0.10627890905175737, "add_states_from_episodes_to_batch": 0.003877784784962002, "batch_individual_items": 0.01723204000365916, "numpy_to_tensor": 7.223730340360871e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2036799043416977, "mean_kl_loss": 1.0254892004013527e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6814910769462585, "vf_loss": 0.2630273997783661, "diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained_lifetime": 503496, "policy_loss": -0.00018189156253356487, "weights_seq_no": 84.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 35.60054397583008, "vf_explained_var": -0.0016883611679077148}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1006992, "num_env_steps_trained_lifetime": 2646000, "num_env_steps_trained_lifetime_throughput": 42347.618795681425}, "intrinsic_reward_module": {"weights_seq_no": 84.0, "num_module_steps_trained_lifetime": 503496, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 167832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3531.0305949137123, "num_module_steps_trained_throughput": 23187821.34862422, "num_module_steps_trained_lifetime_throughput": 13618348.299844751}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime": 83916, "num_module_steps_trained_lifetime_throughput": 671.9047714120566}, "default_policy": {"policy_loss": -0.00018901705334428698, "weights_seq_no": 14.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 35.49338150024414, "curr_kl_coeff": 9.862300430540927e-06, "num_trainable_parameters": 16595, "vf_explained_var": -0.00011336803436279297, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20367097854614258, "mean_kl_loss": 1.0917739018623251e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6814695596694946, "vf_loss": 0.263027161359787, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 83916, "num_module_steps_trained_lifetime_throughput": 671.898153571298}, "IntrinsicAttentionMask": [[[0.3334498703479767, 0.3340177536010742, 0.3325323760509491], [0.33347922563552856, 0.334191232919693, 0.33232954144477844], [0.33340218663215637, 0.3337368667125702, 0.33286094665527344]], [[0.3329803943634033, 0.3316710293292999, 0.335348516702652], [0.33343708515167236, 0.33382824063301086, 0.33273470401763916], [0.3321312665939331, 0.3277970850467682, 0.3400716483592987]], [[0.3319382071495056, 0.3340253233909607, 0.3340364396572113], [0.328309565782547, 0.33582502603530884, 0.3358653485774994], [0.3282903730869293, 0.3358345627784729, 0.3358750343322754]], [[0.3364883065223694, 0.33174318075180054, 0.3317684531211853], [0.33293062448501587, 0.3335363268852234, 0.33353307843208313], [0.33294960856437683, 0.33352673053741455, 0.33352363109588623]], [[0.3333847224712372, 0.3326478898525238, 0.3339673578739166], [0.33326467871665955, 0.33423247933387756, 0.33250290155410767], [0.3334762156009674, 0.33139944076538086, 0.33512431383132935]], [[0.3461655378341675, 0.3073457181453705, 0.3464887738227844], [0.15704436600208282, 0.6877206563949585, 0.15523496270179749], [0.34748268127441406, 0.30467602610588074, 0.3478413224220276]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.980771566298768e-06, "un_batch_to_individual_items": 6.533270799943067e-06, "tensor_to_numpy": 1.5392495060500384e-05, "listify_data_for_vector_env": 1.0153078684028064e-05, "remove_single_ts_time_rank_from_batch": 1.176616814843186e-05, "get_actions": 3.6986673888441504e-05}}, "connector_pipeline_timer": 0.00011479582053453306}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7559930756872346e-06, "batch_individual_items": 1.2244536390150006e-05, "numpy_to_tensor": 1.174415282876851e-05, "add_time_dim_to_batch_and_zero_pad": 6.939042649341432e-06, "add_states_from_episodes_to_batch": 2.6797168254867122e-06}}, "connector_pipeline_timer": 5.8171147879314604e-05}, "module_episode_returns_mean": {"default_policy": 0.0}, "rlmodule_inference_timer": 3.168023900871602e-05, "num_episodes_lifetime": 280, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1300079457523996, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.0, "episode_duration_sec_mean": 0.005819100438384339, "num_env_steps_sampled_lifetime": 70400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_reset_timer": 0.0005728350325565409, "env_step_timer": 1.367233631970913e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 14.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "time_between_sampling": 11.003100741285785}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-21-12", "timestamp": 1754929272, "time_this_iter_s": 11.579754114151001, "time_total_s": 156.9029505252838, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 156.9029505252838, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 47.743750000000006, "ram_util_percent": 82.925}}
{"timers": {"training_iteration": 10.298234306219689, "restore_env_runners": 1.2839252416489849e-05, "training_step": 10.298027872916876, "env_runner_sampling_timer": 1.653648838889647, "learner_update_timer": 8.41665553772995, "synch_weights": 0.0016470660179395847, "restore_eval_env_runners": 5.918597301056601e-05, "evaluation_iteration": 0.14164830139462528, "synch_eval_env_connectors": 0.0001994430300654821, "synch_env_connectors": 4.5641282811258975e-06}, "env_runners": {"weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006298115482088179, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.343899825631675e-05, "normalize_and_clip_actions": 8.50835738993869e-06, "tensor_to_numpy": 1.6577838124679516e-05, "un_batch_to_individual_items": 7.008188018692381e-06, "listify_data_for_vector_env": 1.1199498931262067e-05, "remove_single_ts_time_rank_from_batch": 1.2608497780149948e-05}}, "connector_pipeline_timer": 0.00012739919060323073}, "num_env_steps_sampled_lifetime": -8017500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3988251676619851e-05, "add_observations_from_episodes_to_batch": 3.06676555908169e-06, "batch_individual_items": 1.3382252196026263e-05, "add_time_dim_to_batch_and_zero_pad": 7.564379939761597e-06, "add_states_from_episodes_to_batch": 2.9553371391710194e-06}}, "connector_pipeline_timer": 6.445405324874537e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "time_between_sampling": 0.039658644656702664, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "episode_return_min": -10.5, "env_step_timer": 1.5166615372477772e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "episode_return_mean": 0.9399999999999996, "rlmodule_inference_timer": 6.28317045921492e-05, "num_episodes_lifetime": -400875.0, "sample": 0.006480750455870891, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 5.121073222410358e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3007.797980389081}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1832171227676912, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009490186697760443, "add_observations_from_episodes_to_batch": 0.0009278747022196123, "add_columns_from_episodes_to_train_batch": 0.04501277906863852, "add_time_dim_to_batch_and_zero_pad": 0.10638950704143794, "add_states_from_episodes_to_batch": 0.0039037873477243837, "batch_individual_items": 0.017223395443635298, "numpy_to_tensor": 7.24170105794984e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2035226672887802, "mean_kl_loss": 4.3017647840315476e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6793687343597412, "vf_loss": 0.26303809881210327, "diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained_lifetime": 539460, "policy_loss": -0.00035599153488874435, "weights_seq_no": 90.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.03329849243164, "vf_explained_var": -0.001517176628112793}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1078920, "num_env_steps_trained_lifetime": 2835000, "num_env_steps_trained_lifetime_throughput": 41592.074131236186}, "intrinsic_reward_module": {"weights_seq_no": 90.0, "num_module_steps_trained_lifetime": 539460, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 179820, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3515.0816933801243, "num_module_steps_trained_throughput": 22569309.688415345, "num_module_steps_trained_lifetime_throughput": 13501313.15705857}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime": 89910, "num_module_steps_trained_lifetime_throughput": 668.8697238329869}, "default_policy": {"policy_loss": -0.00036339429789222777, "weights_seq_no": 15.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.988555908203125, "curr_kl_coeff": 4.931150215270463e-06, "num_trainable_parameters": 16595, "vf_explained_var": -0.0001169443130493164, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20350345969200134, "mean_kl_loss": 4.4675231038127095e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6793394088745117, "vf_loss": 0.2630317509174347, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 89910, "num_module_steps_trained_lifetime_throughput": 668.8636067975339}, "IntrinsicAttentionMask": [[[0.33669593930244446, 0.3367311656475067, 0.3265729248523712], [0.336710661649704, 0.3367460370063782, 0.32654330134391785], [0.33236801624298096, 0.33235809206962585, 0.3352738618850708]], [[0.333391398191452, 0.332557737827301, 0.3340508043766022], [0.3332716226577759, 0.33414214849472046, 0.33258622884750366], [0.3334827125072479, 0.33130943775177, 0.33520784974098206]], [[0.3341805040836334, 0.3331908881664276, 0.33262860774993896], [0.329517126083374, 0.33396226167678833, 0.33652061223983765], [0.32687392830848694, 0.33438554406166077, 0.3387405276298523]], [[0.3364883065223694, 0.3317432105541229, 0.3317684531211853], [0.33293062448501587, 0.3335363268852234, 0.33353307843208313], [0.3329496383666992, 0.33352673053741455, 0.33352363109588623]], [[0.3342568576335907, 0.3332541882991791, 0.332489013671875], [0.33262574672698975, 0.33339300751686096, 0.3339812755584717], [0.3313797414302826, 0.33349594473838806, 0.33512425422668457]], [[0.34770533442497253, 0.3066219389438629, 0.34567275643348694], [0.13647787272930145, 0.7160775661468506, 0.14744460582733154], [0.3382579982280731, 0.3241550624370575, 0.33758699893951416]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.941789649320864e-06, "un_batch_to_individual_items": 6.596176128097778e-06, "tensor_to_numpy": 1.5594776000788557e-05, "listify_data_for_vector_env": 1.0238596641655474e-05, "remove_single_ts_time_rank_from_batch": 1.1906788908535896e-05, "get_actions": 3.916349020993803e-05}}, "connector_pipeline_timer": 0.00011757438618009957}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.71796294660725e-06, "batch_individual_items": 1.2258313861501403e-05, "numpy_to_tensor": 1.205183908827276e-05, "add_time_dim_to_batch_and_zero_pad": 6.759413087657561e-06, "add_states_from_episodes_to_batch": 2.684937300544591e-06}}, "connector_pipeline_timer": 5.827182678886852e-05}, "module_episode_returns_mean": {"default_policy": -0.8}, "rlmodule_inference_timer": 3.255333839638212e-05, "num_episodes_lifetime": 300, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12991519004442528, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.8, "episode_duration_sec_mean": 0.005523462530691177, "num_env_steps_sampled_lifetime": 75400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_reset_timer": 0.0005707495923910998, "env_step_timer": 1.3849681429837874e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 15.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "time_between_sampling": 11.000458829712972}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-21-23", "timestamp": 1754929283, "time_this_iter_s": 10.843562364578247, "time_total_s": 167.74651288986206, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 167.74651288986206, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.46, "ram_util_percent": 82.24}}
{"timers": {"training_iteration": 10.309861475236534, "restore_env_runners": 1.2855029791028644e-05, "training_step": 10.3096545133576, "env_runner_sampling_timer": 1.6539920521710099, "learner_update_timer": 8.426693493182528, "synch_weights": 0.0016458849479885377, "restore_eval_env_runners": 5.909827311469626e-05, "evaluation_iteration": 0.141530180041126, "synch_eval_env_connectors": 0.00019917234979358652, "synch_env_connectors": 4.561406999165793e-06}, "env_runners": {"weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.0057517019729129955, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1321517143418305e-05, "normalize_and_clip_actions": 8.19928036937103e-06, "tensor_to_numpy": 1.6322149817354866e-05, "un_batch_to_individual_items": 6.74643579406774e-06, "listify_data_for_vector_env": 1.0991067401645028e-05, "remove_single_ts_time_rank_from_batch": 1.2220210494535574e-05}}, "connector_pipeline_timer": 0.00012367263768673235}, "num_env_steps_sampled_lifetime": -8635000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.384286502828049e-05, "add_observations_from_episodes_to_batch": 2.887217657147142e-06, "batch_individual_items": 1.3063127908917758e-05, "add_time_dim_to_batch_and_zero_pad": 7.288823018954637e-06, "add_states_from_episodes_to_batch": 2.890326869192908e-06}}, "connector_pipeline_timer": 6.322769821066119e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "time_between_sampling": 0.036943599516968066, "module_episode_returns_mean": {"default_policy": 1.2600000000000002}, "episode_return_min": -10.5, "env_step_timer": 1.5167751267027355e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.2600000000000002}, "episode_return_mean": 1.2600000000000002, "rlmodule_inference_timer": 3.3363522546111835e-05, "num_episodes_lifetime": -431750.0, "sample": 0.006241973474797193, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.411218691678778e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3211.533153556167}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18399161237080258, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009630345661383398, "add_observations_from_episodes_to_batch": 0.0009614209553251937, "add_columns_from_episodes_to_train_batch": 0.045105562108069895, "add_time_dim_to_batch_and_zero_pad": 0.10691724030108478, "add_states_from_episodes_to_batch": 0.003906557804235411, "batch_individual_items": 0.017198770239465897, "numpy_to_tensor": 7.260493123715309e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2036982923746109, "mean_kl_loss": 1.4686730537505355e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6783960461616516, "vf_loss": 0.2630205452442169, "diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained_lifetime": 575424, "policy_loss": -0.00016362183669116348, "weights_seq_no": 96.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.35721206665039, "vf_explained_var": -0.001493215560913086}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1150848, "num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained_lifetime_throughput": 40857.06602248337}, "intrinsic_reward_module": {"weights_seq_no": 96.0, "num_module_steps_trained_lifetime": 575424, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 191808, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3499.8418632791827, "num_module_steps_trained_throughput": 22007864.024891786, "num_module_steps_trained_lifetime_throughput": 13413477.456709497}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime": 95904, "num_module_steps_trained_lifetime_throughput": 665.9696087623969}, "default_policy": {"policy_loss": -0.0001681064022704959, "weights_seq_no": 16.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 38.31205749511719, "curr_kl_coeff": 2.4655751076352317e-06, "num_trainable_parameters": 16595, "vf_explained_var": 0.00014030933380126953, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2036987841129303, "mean_kl_loss": 1.5357431038864888e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6783751249313354, "vf_loss": 0.26302990317344666, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 95904, "num_module_steps_trained_lifetime_throughput": 665.9639695249341}, "IntrinsicAttentionMask": [[[0.3334430456161499, 0.33599230647087097, 0.3305646479129791], [0.3335496485233307, 0.33901581168174744, 0.3274344801902771], [0.33329862356185913, 0.3325602412223816, 0.3341411352157593]], [[0.33386674523353577, 0.33385834097862244, 0.3322749137878418], [0.3338570296764374, 0.333848774433136, 0.332294225692749], [0.33201727271080017, 0.33203789591789246, 0.33594486117362976]], [[0.332722932100296, 0.3336330056190491, 0.3336440920829773], [0.3320291042327881, 0.33397358655929565, 0.33399730920791626], [0.33202067017555237, 0.33397769927978516, 0.3340016007423401]], [[0.34001219272613525, 0.32777732610702515, 0.3322104513645172], [0.3328154981136322, 0.33376678824424744, 0.33341774344444275], [0.33544620871543884, 0.3315688371658325, 0.33298495411872864]], [[0.3338063657283783, 0.3338015675544739, 0.33239203691482544], [0.33379119634628296, 0.3337865471839905, 0.3324222266674042], [0.32928869128227234, 0.3293288052082062, 0.3413824439048767]], [[0.3183601200580597, 0.3655364513397217, 0.3161034882068634], [0.14535585045814514, 0.7207891941070557, 0.13385500013828278], [0.3266206681728363, 0.34781405329704285, 0.32556527853012085]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.31253191209911e-06, "un_batch_to_individual_items": 6.5631669508235005e-06, "tensor_to_numpy": 1.535951895145416e-05, "listify_data_for_vector_env": 1.0449581022533986e-05, "remove_single_ts_time_rank_from_batch": 1.183335231669151e-05, "get_actions": 3.6707291074667034e-05}}, "connector_pipeline_timer": 0.00011554685597141355}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7388367953562368e-06, "batch_individual_items": 1.2490022696033244e-05, "numpy_to_tensor": 1.1818045672730998e-05, "add_time_dim_to_batch_and_zero_pad": 6.849143115296846e-06, "add_states_from_episodes_to_batch": 2.6843077589569883e-06}}, "connector_pipeline_timer": 5.877445357058515e-05}, "module_episode_returns_mean": {"default_policy": -1.2}, "rlmodule_inference_timer": 3.132916907255478e-05, "num_episodes_lifetime": 320, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12976792856456876, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.2, "episode_duration_sec_mean": 0.0055238650389947, "num_env_steps_sampled_lifetime": 80400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_reset_timer": 0.0005681929272110232, "env_step_timer": 1.3522719039462725e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 16.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "time_between_sampling": 11.005377401835409}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-21-35", "timestamp": 1754929295, "time_this_iter_s": 11.590173959732056, "time_total_s": 179.33668684959412, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.33668684959412, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 45.99411764705883, "ram_util_percent": 82.39999999999998}}
{"timers": {"training_iteration": 10.318842264644783, "restore_env_runners": 1.2897728759832215e-05, "training_step": 10.318634804884296, "env_runner_sampling_timer": 1.6542354716498473, "learner_update_timer": 8.435480160331029, "synch_weights": 0.0016388973487409615, "restore_eval_env_runners": 5.906229111713346e-05, "evaluation_iteration": 0.14136105616155353, "synch_eval_env_connectors": 0.00019866145596481328, "synch_env_connectors": 4.9345434983984925e-06}, "env_runners": {"weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005748729849699885, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.5701852443385026e-05, "normalize_and_clip_actions": 8.713027194035644e-06, "tensor_to_numpy": 1.7462904594389717e-05, "un_batch_to_individual_items": 7.140387103164339e-06, "listify_data_for_vector_env": 1.2066356974149162e-05, "remove_single_ts_time_rank_from_batch": 1.2880538005645304e-05}}, "connector_pipeline_timer": 0.00013339557299397772}, "num_env_steps_sampled_lifetime": -9252500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4736610050089322e-05, "add_observations_from_episodes_to_batch": 3.085398862526102e-06, "batch_individual_items": 1.3930241885753891e-05, "add_time_dim_to_batch_and_zero_pad": 7.862937785346607e-06, "add_states_from_episodes_to_batch": 2.9825512778616923e-06}}, "connector_pipeline_timer": 6.709560937797509e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "time_between_sampling": 0.04004101286584171, "module_episode_returns_mean": {"default_policy": 1.5800000000000005}, "episode_return_min": -10.5, "env_step_timer": 1.6757086140197588e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.5800000000000005}, "episode_return_mean": 1.5800000000000005, "rlmodule_inference_timer": 3.600088517165917e-05, "num_episodes_lifetime": -462625.0, "sample": 0.006518440322471229, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 5.405683643085895e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 2950.9345866570598}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1839016437477425, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009622833875047278, "add_observations_from_episodes_to_batch": 0.0009606846666901083, "add_columns_from_episodes_to_train_batch": 0.045082518987040604, "add_time_dim_to_batch_and_zero_pad": 0.10690345580852939, "add_states_from_episodes_to_batch": 0.0039058663961555372, "batch_individual_items": 0.01715563295707686, "numpy_to_tensor": 7.253388225566184e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2035093605518341, "mean_kl_loss": 4.408527456689626e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6763280630111694, "vf_loss": 0.26303428411483765, "diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained_lifetime": 611388, "policy_loss": -0.00037122826324775815, "weights_seq_no": 102.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.57223892211914, "vf_explained_var": -0.0014246702194213867}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1222776, "num_env_steps_trained_lifetime": 3213000, "num_env_steps_trained_lifetime_throughput": 40156.43806421552}, "intrinsic_reward_module": {"weights_seq_no": 102.0, "num_module_steps_trained_lifetime": 611388, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 203796, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3484.5108368956944, "num_module_steps_trained_throughput": 21480780.40583166, "num_module_steps_trained_lifetime_throughput": 13334856.171618974}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime": 101898, "num_module_steps_trained_lifetime_throughput": 663.0521880452962}, "default_policy": {"policy_loss": -0.00037938111927360296, "weights_seq_no": 17.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.55973815917969, "curr_kl_coeff": 1.2327875538176158e-06, "num_trainable_parameters": 16595, "vf_explained_var": 0.00011610984802246094, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2034904509782791, "mean_kl_loss": 4.5903740101493895e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6762930750846863, "vf_loss": 0.2630295753479004, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 101898, "num_module_steps_trained_lifetime_throughput": 663.0469602194688}, "IntrinsicAttentionMask": [[[0.33547037839889526, 0.33550548553466797, 0.32902416586875916], [0.3354797959327698, 0.33551502227783203, 0.32900524139404297], [0.33372586965560913, 0.3337322473526001, 0.33254188299179077]], [[0.3329803943634033, 0.3316710293292999, 0.335348516702652], [0.33343708515167236, 0.33382824063301086, 0.33273470401763916], [0.3321312367916107, 0.3277970850467682, 0.3400716185569763]], [[0.3341805040836334, 0.3326338231563568, 0.33318567276000977], [0.3268986642360687, 0.33867934346199036, 0.33442196249961853], [0.3294925093650818, 0.33651724457740784, 0.3339901864528656]], [[0.3364883065223694, 0.3317432105541229, 0.3317684531211853], [0.33293062448501587, 0.3335363268852234, 0.33353307843208313], [0.3329496383666992, 0.33352673053741455, 0.33352363109588623]], [[0.33300939202308655, 0.3330209255218506, 0.33396968245506287], [0.33300507068634033, 0.3330167531967163, 0.33397814631462097], [0.3326508700847626, 0.33267512917518616, 0.33467400074005127]], [[0.3183601498603821, 0.3655363619327545, 0.316103458404541], [0.14535611867904663, 0.7207885980606079, 0.13385525345802307], [0.3266206681728363, 0.34781405329704285, 0.32556527853012085]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.817434039693289e-06, "un_batch_to_individual_items": 6.582494377104055e-06, "tensor_to_numpy": 1.541595462914843e-05, "listify_data_for_vector_env": 1.0041193258259416e-05, "remove_single_ts_time_rank_from_batch": 1.1710595169231549e-05, "get_actions": 3.725978374064345e-05}}, "connector_pipeline_timer": 0.00011499098280451089}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.721958376661478e-06, "batch_individual_items": 1.2231741970096186e-05, "numpy_to_tensor": 1.1733261788599473e-05, "add_time_dim_to_batch_and_zero_pad": 6.749583301006035e-06, "add_states_from_episodes_to_batch": 2.662140830711802e-06}}, "connector_pipeline_timer": 5.8005815969393965e-05}, "module_episode_returns_mean": {"default_policy": -0.8}, "rlmodule_inference_timer": 3.175103894080096e-05, "num_episodes_lifetime": 340, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12961795760945932, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.8, "episode_duration_sec_mean": 0.005407144614728168, "num_env_steps_sampled_lifetime": 85400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_reset_timer": 0.0005656197480363665, "env_step_timer": 1.3525367108519702e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 17.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "time_between_sampling": 11.007708346156944}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-21-46", "timestamp": 1754929306, "time_this_iter_s": 11.33436393737793, "time_total_s": 190.67105078697205, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 190.67105078697205, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 47.41875, "ram_util_percent": 80.19375}}
{"timers": {"training_iteration": 10.322980471998358, "restore_env_runners": 1.2829160546883109e-05, "training_step": 10.322772418085238, "env_runner_sampling_timer": 1.653078739012833, "learner_update_timer": 8.440822537057524, "synch_weights": 0.0016452487847302345, "restore_eval_env_runners": 5.857958753760214e-05, "evaluation_iteration": 0.14117693518997934, "synch_eval_env_connectors": 0.00019776234211893077, "synch_env_connectors": 4.929778146754915e-06}, "env_runners": {"weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005287655305117368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.925885024674727e-05, "normalize_and_clip_actions": 8.021657542323824e-06, "tensor_to_numpy": 1.536761243154481e-05, "un_batch_to_individual_items": 6.608049329177022e-06, "listify_data_for_vector_env": 1.0542370299364634e-05, "remove_single_ts_time_rank_from_batch": 1.1949618831909344e-05}}, "connector_pipeline_timer": 0.00011822721687538225}, "num_env_steps_sampled_lifetime": -9870000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2662055841641654e-05, "add_observations_from_episodes_to_batch": 2.8176634731434523e-06, "batch_individual_items": 1.2624791800880233e-05, "add_time_dim_to_batch_and_zero_pad": 6.995143668604812e-06, "add_states_from_episodes_to_batch": 2.7923449566406084e-06}}, "connector_pipeline_timer": 6.012036358826337e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "time_between_sampling": 0.039268711524717136, "module_episode_returns_mean": {"default_policy": 2.460000000000001}, "episode_return_min": -10.5, "env_step_timer": 1.3961440514451563e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 2.460000000000001}, "episode_return_mean": 2.460000000000001, "rlmodule_inference_timer": 3.171163085463707e-05, "num_episodes_lifetime": -493500.0, "sample": 0.005814680074162139, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.290551474891188e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3235.805668429721}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18380110065020272, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009616595945620752, "add_observations_from_episodes_to_batch": 0.0009602432402201577, "add_columns_from_episodes_to_train_batch": 0.04505469379688894, "add_time_dim_to_batch_and_zero_pad": 0.1068799570800608, "add_states_from_episodes_to_batch": 0.0039051744015172773, "batch_individual_items": 0.017114537457911444, "numpy_to_tensor": 7.256979369991051e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2032824009656906, "mean_kl_loss": 3.178806582582183e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6756414771080017, "vf_loss": 0.2630213499069214, "diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained_lifetime": 647352, "policy_loss": -0.0005871675675734878, "weights_seq_no": 108.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 37.139896392822266, "vf_explained_var": -0.0014922618865966797}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1294704, "num_env_steps_trained_lifetime": 3402000, "num_env_steps_trained_lifetime_throughput": 39497.46805256561}, "intrinsic_reward_module": {"weights_seq_no": 108.0, "num_module_steps_trained_lifetime": 647352, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 215784, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3470.245080560078, "num_module_steps_trained_throughput": 20995392.941922847, "num_module_steps_trained_lifetime_throughput": 13277934.842807373}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107892, "num_module_steps_trained_lifetime_throughput": 660.3375484992299}, "default_policy": {"policy_loss": -0.0006140790064819157, "weights_seq_no": 18.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.06769943237305, "curr_kl_coeff": 6.163937769088079e-07, "num_trainable_parameters": 16595, "vf_explained_var": 4.3392181396484375e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20325800776481628, "mean_kl_loss": 3.4764267184073105e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6755735278129578, "vf_loss": 0.2630310654640198, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 107892, "num_module_steps_trained_lifetime_throughput": 660.3326839372809}, "IntrinsicAttentionMask": [[[0.3334498703479767, 0.3340177536010742, 0.3325324058532715], [0.33347922563552856, 0.334191232919693, 0.33232954144477844], [0.33340218663215637, 0.3337368667125702, 0.33286094665527344]], [[0.3338525593280792, 0.3334374725818634, 0.332709938287735], [0.33163803815841675, 0.3329886198043823, 0.3353733718395233], [0.3277560770511627, 0.3321724832057953, 0.340071439743042]], [[0.33399444818496704, 0.3330053985118866, 0.33300015330314636], [0.3303544819355011, 0.33481088280677795, 0.33483466506004333], [0.33033519983291626, 0.33482038974761963, 0.33484435081481934]], [[0.34001219272613525, 0.32777735590934753, 0.3322104811668396], [0.3328154981136322, 0.33376678824424744, 0.33341774344444275], [0.33544620871543884, 0.3315688371658325, 0.33298495411872864]], [[0.3342550992965698, 0.3342457413673401, 0.3314991593360901], [0.3342399597167969, 0.3342307507991791, 0.33152931928634644], [0.32974329590797424, 0.3297789990901947, 0.34047773480415344]], [[0.3183601498603821, 0.36553630232810974, 0.3161034882068634], [0.14535655081272125, 0.7207877039909363, 0.1338556855916977], [0.3266206681728363, 0.34781402349472046, 0.32556527853012085]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.469711835023236e-06, "un_batch_to_individual_items": 7.1259293339774805e-06, "tensor_to_numpy": 1.7717548512551372e-05, "listify_data_for_vector_env": 1.1003140295808495e-05, "remove_single_ts_time_rank_from_batch": 1.2795858155343128e-05, "get_actions": 4.188102791919072e-05}}, "connector_pipeline_timer": 0.00012669599009496293}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9181038982386227e-06, "batch_individual_items": 1.3721972795214121e-05, "numpy_to_tensor": 1.3488696199268503e-05, "add_time_dim_to_batch_and_zero_pad": 7.3530691136914695e-06, "add_states_from_episodes_to_batch": 2.7718942725022186e-06}}, "connector_pipeline_timer": 6.301035415435943e-05}, "module_episode_returns_mean": {"default_policy": -1.0}, "rlmodule_inference_timer": 3.5109581515736164e-05, "num_episodes_lifetime": 360, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12965483386369253, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.0, "episode_duration_sec_mean": 0.005450178328901529, "num_env_steps_sampled_lifetime": 90400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_reset_timer": 0.0005670139604690658, "env_step_timer": 1.5704801560715237e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 18.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "time_between_sampling": 11.005268156855326}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-21-57", "timestamp": 1754929317, "time_this_iter_s": 10.879894018173218, "time_total_s": 201.55094480514526, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 201.55094480514526, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 43.66666666666667, "ram_util_percent": 79.54}}
{"timers": {"training_iteration": 10.325205728528042, "restore_env_runners": 1.2799199142995397e-05, "training_step": 10.324997450153964, "env_runner_sampling_timer": 1.6542858891224737, "learner_update_timer": 8.44192306960742, "synch_weights": 0.0016388987975563157, "restore_eval_env_runners": 5.857545150450865e-05, "evaluation_iteration": 0.14119916250802764, "synch_eval_env_connectors": 0.0001975255584957449, "synch_env_connectors": 4.9367299204877036e-06}, "env_runners": {"weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006132177994120868, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.280902957805836e-05, "normalize_and_clip_actions": 8.39764402649548e-06, "tensor_to_numpy": 1.63366652696818e-05, "un_batch_to_individual_items": 6.929752812119028e-06, "listify_data_for_vector_env": 1.1194396869857234e-05, "remove_single_ts_time_rank_from_batch": 1.2523095438022623e-05}}, "connector_pipeline_timer": 0.00012590272941537966}, "num_env_steps_sampled_lifetime": -10487500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3695360793816234e-05, "add_observations_from_episodes_to_batch": 2.9832307909502763e-06, "batch_individual_items": 1.3260556423913133e-05, "add_time_dim_to_batch_and_zero_pad": 7.44861383384002e-06, "add_states_from_episodes_to_batch": 2.9414202915973293e-06}}, "connector_pipeline_timer": 6.350750890989511e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "time_between_sampling": 0.038077920353578716, "module_episode_returns_mean": {"default_policy": 1.6599999999999997}, "episode_return_min": -10.5, "env_step_timer": 1.505744543040584e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.6599999999999997}, "episode_return_mean": 1.6599999999999997, "rlmodule_inference_timer": 6.106701448092208e-05, "num_episodes_lifetime": -524375.0, "sample": 0.006319929966935721, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.643325352147348e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3056.7348458830033}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18367586339330552, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00960807082579342, "add_observations_from_episodes_to_batch": 0.0009588141471196765, "add_columns_from_episodes_to_train_batch": 0.0450259543594538, "add_time_dim_to_batch_and_zero_pad": 0.10683836250896038, "add_states_from_episodes_to_batch": 0.003903405578177457, "batch_individual_items": 0.01707242625328192, "numpy_to_tensor": 7.247284676702616e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20367808640003204, "mean_kl_loss": 1.7651209418545477e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.673517644405365, "vf_loss": 0.26301684975624084, "diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained_lifetime": 683316, "policy_loss": -0.00018896815890911967, "weights_seq_no": 114.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.86932373046875, "vf_explained_var": -0.001368403434753418}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1366632, "num_env_steps_trained_lifetime": 3591000, "num_env_steps_trained_lifetime_throughput": 38877.21245376044}, "intrinsic_reward_module": {"weights_seq_no": 114.0, "num_module_steps_trained_lifetime": 683316, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 227772, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3459.032051371251, "num_module_steps_trained_throughput": 20544060.02065227, "num_module_steps_trained_lifetime_throughput": 13230735.518398847}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime": 113886, "num_module_steps_trained_lifetime_throughput": 658.2037732457485}, "default_policy": {"policy_loss": -0.00019451696425676346, "weights_seq_no": 19.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.88188552856445, "curr_kl_coeff": 3.0819688845440396e-07, "num_trainable_parameters": 16595, "vf_explained_var": -0.0002256631851196289, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2036793977022171, "mean_kl_loss": 1.855006121331826e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6734883189201355, "vf_loss": 0.2630292475223541, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 113886, "num_module_steps_trained_lifetime_throughput": 658.1992820922383}, "IntrinsicAttentionMask": [[[0.33547037839889526, 0.33550548553466797, 0.32902416586875916], [0.3354797959327698, 0.33551502227783203, 0.32900527119636536], [0.33372586965560913, 0.3337322473526001, 0.33254188299179077]], [[0.33371567726135254, 0.33330076932907104, 0.3329836428165436], [0.3320855498313904, 0.3334379494190216, 0.3344764709472656], [0.3308403789997101, 0.3335396945476532, 0.3356199264526367]], [[0.3323301076889038, 0.3332390785217285, 0.3344308137893677], [0.33118966221809387, 0.3331291973590851, 0.33568117022514343], [0.329700767993927, 0.33298128843307495, 0.33731797337532043]], [[0.34151214361190796, 0.3292233347892761, 0.3292645514011383], [0.3327004611492157, 0.3336513936519623, 0.333648145198822], [0.33273032307624817, 0.3336363732814789, 0.33363327383995056]], [[0.33300939202308655, 0.3330209255218506, 0.33396968245506287], [0.33300507068634033, 0.3330167531967163, 0.33397814631462097], [0.3326508700847626, 0.33267512917518616, 0.33467400074005127]], [[0.3183601498603821, 0.36553630232810974, 0.3161034882068634], [0.14535655081272125, 0.7207877039909363, 0.1338556855916977], [0.3266206681728363, 0.34781402349472046, 0.32556527853012085]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.878821861595621e-06, "un_batch_to_individual_items": 6.555928088518965e-06, "tensor_to_numpy": 1.5504488353893704e-05, "listify_data_for_vector_env": 1.0109412279725893e-05, "remove_single_ts_time_rank_from_batch": 1.1907155002754597e-05, "get_actions": 3.721118046660072e-05}}, "connector_pipeline_timer": 0.00011524275660787563}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7771765237842178e-06, "batch_individual_items": 1.2263272074128254e-05, "numpy_to_tensor": 1.1897749975475587e-05, "add_time_dim_to_batch_and_zero_pad": 6.710012086126036e-06, "add_states_from_episodes_to_batch": 2.6610844345194767e-06}}, "connector_pipeline_timer": 5.818885902136135e-05}, "module_episode_returns_mean": {"default_policy": -1.2}, "rlmodule_inference_timer": 3.1609753203968686e-05, "num_episodes_lifetime": 380, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.12949912010592968, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.2, "episode_duration_sec_mean": 0.005448740822030232, "num_env_steps_sampled_lifetime": 95400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_reset_timer": 0.0005626892408878016, "env_step_timer": 1.3662647833292406e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 19.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "time_between_sampling": 11.000964751956003}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-22-08", "timestamp": 1754929328, "time_this_iter_s": 10.668974876403809, "time_total_s": 212.21991968154907, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 212.21991968154907, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.980000000000004, "ram_util_percent": 79.46666666666667}}
{"timers": {"training_iteration": 10.33865706207226, "restore_env_runners": 1.2739127342778932e-05, "training_step": 10.338448393152262, "env_runner_sampling_timer": 1.6554033414821965, "learner_update_timer": 8.45432314225209, "synch_weights": 0.0016381018898888769, "restore_eval_env_runners": 5.815886707852958e-05, "evaluation_iteration": 0.14098867505267784, "synch_eval_env_connectors": 0.00019669113348348198, "synch_env_connectors": 4.92611262530614e-06}, "env_runners": {"weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005507987841032446, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.146562900023373e-05, "normalize_and_clip_actions": 8.417994605436064e-06, "tensor_to_numpy": 1.5915768244392573e-05, "un_batch_to_individual_items": 6.823215464754132e-06, "listify_data_for_vector_env": 1.0969044240381198e-05, "remove_single_ts_time_rank_from_batch": 1.2316628647981894e-05}}, "connector_pipeline_timer": 0.00012321950227832444}, "num_env_steps_sampled_lifetime": -11105000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3412485161964104e-05, "add_observations_from_episodes_to_batch": 2.959669641110823e-06, "batch_individual_items": 1.3083082878754412e-05, "add_time_dim_to_batch_and_zero_pad": 7.3390632992732475e-06, "add_states_from_episodes_to_batch": 2.852562641867562e-06}}, "connector_pipeline_timer": 6.266242975819247e-05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "time_between_sampling": 0.0367688815171678, "module_episode_returns_mean": {"default_policy": 1.9}, "episode_return_min": -10.5, "env_step_timer": 1.4685410564528046e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.9}, "episode_return_mean": 1.9, "rlmodule_inference_timer": 3.3203125324987516e-05, "num_episodes_lifetime": -555250.0, "sample": 0.006042938625147809, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 4.6943549451466565e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3080.3304458739944}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18356539266892305, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0096022467873269, "add_observations_from_episodes_to_batch": 0.0009579218448542365, "add_columns_from_episodes_to_train_batch": 0.04499931647572487, "add_time_dim_to_batch_and_zero_pad": 0.10680699305372209, "add_states_from_episodes_to_batch": 0.003902283613170308, "batch_individual_items": 0.017028716570233342, "numpy_to_tensor": 7.239019769366662e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20383836328983307, "mean_kl_loss": 7.176003009590204e-07, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "entropy": 0.6734777092933655, "vf_loss": 0.2630167007446289, "diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained_lifetime": 719280, "policy_loss": -2.5918932806234807e-05, "weights_seq_no": 120.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.26035690307617, "vf_explained_var": -0.0013686418533325195}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1438560, "num_env_steps_trained_lifetime": 3780000, "num_env_steps_trained_lifetime_throughput": 38283.174458302645}, "intrinsic_reward_module": {"weights_seq_no": 120.0, "num_module_steps_trained_lifetime": 719280, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.0}}}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 239760, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3448.0666774073857, "num_module_steps_trained_throughput": 20092340.688506316, "num_module_steps_trained_lifetime_throughput": 13170694.321166042}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime": 119880, "num_module_steps_trained_lifetime_throughput": 656.1171509590881}, "default_policy": {"policy_loss": -2.9321725378395058e-05, "weights_seq_no": 20.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.26100540161133, "curr_kl_coeff": 1.5409844422720198e-07, "num_trainable_parameters": 16595, "vf_explained_var": -0.00033164024353027344, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20384348928928375, "mean_kl_loss": 6.262139322643634e-07, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "entropy": 0.673494815826416, "vf_loss": 0.2630278468132019, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 119880, "num_module_steps_trained_lifetime_throughput": 656.1129910103681}, "IntrinsicAttentionMask": [[[0.3341050446033478, 0.33467403054237366, 0.33122092485427856], [0.334299772977829, 0.3350135385990143, 0.33068662881851196], [0.33310768008232117, 0.3329426646232605, 0.3339496850967407]], [[0.3341656029224396, 0.33326205611228943, 0.332572340965271], [0.33253467082977295, 0.3334006369113922, 0.3340647220611572], [0.3312888443470001, 0.3335033655166626, 0.3352077901363373]], [[0.33274129033088684, 0.333974152803421, 0.33328452706336975], [0.3301250636577606, 0.3368154466152191, 0.33305951952934265], [0.33158665895462036, 0.33522629737854004, 0.33318713307380676]], [[0.3400123715400696, 0.3321690559387207, 0.32781854271888733], [0.33542168140411377, 0.33297598361968994, 0.3316023051738739], [0.3328399658203125, 0.3334168791770935, 0.33374321460723877]], [[0.33300670981407166, 0.33179381489753723, 0.3351994454860687], [0.33346277475357056, 0.3339511454105377, 0.3325861394405365], [0.3321586549282074, 0.3279196321964264, 0.33992165327072144]], [[0.30850955843925476, 0.3865414559841156, 0.3049490451812744], [0.13646461069583893, 0.7384317517280579, 0.12510371208190918], [0.3170241713523865, 0.3683930039405823, 0.3145827651023865]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.919787278212765e-06, "un_batch_to_individual_items": 6.464319186577037e-06, "tensor_to_numpy": 1.5254776044987808e-05, "listify_data_for_vector_env": 1.0079289756725913e-05, "remove_single_ts_time_rank_from_batch": 1.1772197663748306e-05, "get_actions": 3.649157264874075e-05}}, "connector_pipeline_timer": 0.0001145455244401798}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7352542437420475e-06, "batch_individual_items": 1.222293797795263e-05, "numpy_to_tensor": 1.1813059238921359e-05, "add_time_dim_to_batch_and_zero_pad": 6.7941468042326205e-06, "add_states_from_episodes_to_batch": 2.6713795476934675e-06}}, "connector_pipeline_timer": 5.806665180211664e-05}, "module_episode_returns_mean": {"default_policy": -1.2}, "rlmodule_inference_timer": 3.14118116303483e-05, "num_episodes_lifetime": 400, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1293516276540669, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.2, "episode_duration_sec_mean": 0.005397300820332021, "num_env_steps_sampled_lifetime": 100400, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_reset_timer": 0.0005602623483980848, "env_step_timer": 1.3485262414976681e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "time_between_sampling": 11.007910735266933}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "ae5b4_00000", "date": "2025-08-11_18-22-19", "timestamp": 1754929339, "time_this_iter_s": 11.797400951385498, "time_total_s": 224.01732063293457, "pid": 10704, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3892998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 224.01732063293457, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.88823529411765, "ram_util_percent": 80.8}}
