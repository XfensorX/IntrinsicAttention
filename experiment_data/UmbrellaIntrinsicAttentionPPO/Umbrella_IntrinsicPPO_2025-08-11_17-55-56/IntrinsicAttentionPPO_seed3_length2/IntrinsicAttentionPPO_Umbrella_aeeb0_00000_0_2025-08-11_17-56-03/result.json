{"timers": {"training_iteration": 9.885678625083528, "restore_env_runners": 1.1792057193815708e-05, "training_step": 9.88551562500652, "env_runner_sampling_timer": 1.606246041948907, "learner_update_timer": 8.070873499964364, "synch_weights": 0.0008723749779164791}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.810942846889081e-06, "normalize_and_clip_actions": 1.1500744586154704e-05, "listify_data_for_vector_env": 1.0678133867812189e-05, "remove_single_ts_time_rank_from_batch": 1.207630203096634e-05, "tensor_to_numpy": 1.5612383646759156e-05, "get_actions": 4.36674686163876e-05}}, "connector_pipeline_timer": 0.0001277037820025998}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.125939320024661e-06, "add_observations_from_episodes_to_batch": 2.942201194663442e-06, "numpy_to_tensor": 1.322564310809318e-05, "add_states_from_episodes_to_batch": 2.7494855609197107e-06, "batch_individual_items": 1.2717153968637499e-05}}, "connector_pipeline_timer": 6.283226326575942e-05}, "weights_seq_no": 0.0, "episode_return_mean": -1.5, "env_reset_timer": 9.123473086543409e-05, "sample": 0.006779995485805529, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "time_between_sampling": 0.000657556209091585, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.5227103997216402e-05, "rlmodule_inference_timer": 3.473020867771199e-05, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005219968687742952, "module_episode_returns_mean": {"default_policy": -1.5}, "num_episodes_lifetime": 31375.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3091.8063257835333}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.1713910420658067, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008691333001479506, "add_observations_from_episodes_to_batch": 0.0008360000792890787, "add_columns_from_episodes_to_train_batch": 0.04164641699753702, "add_time_dim_to_batch_and_zero_pad": 0.10360966599546373, "add_states_from_episodes_to_batch": 0.0034812919329851866, "batch_individual_items": 0.012932040961459279, "numpy_to_tensor": 5.904200952500105e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26922333240509033, "use_intrinsic_rewards": 1.0, "weights_seq_no": 6.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 35964, "vf_loss_unclipped": 35.76456832885742, "vf_explained_var": 0.005111277103424072, "policy_loss": -2.0006100953651185e-07, "module_train_batch_size_mean": 999.0, "entropy": 0.6870928406715393, "diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.2086806744337082, "mean_kl_loss": 1.4828247913101222e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime_throughput": 52705.64580133281}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 6.0, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35964, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 1.0, "num_module_steps_trained_lifetime": 5994, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 736.3626083973833}, "default_policy": {"entropy": 0.6870956420898438, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20398974418640137, "num_module_steps_trained_lifetime": 5994, "mean_kl_loss": 1.4700114661536645e-05, "vf_loss": 0.2632025480270386, "use_intrinsic_rewards": 0.0, "weights_seq_no": 1.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 35.63774108886719, "vf_explained_var": 0.0017518997192382812, "num_trainable_parameters": 16595, "policy_loss": -6.00183057031245e-07, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.08079196512699127, "num_module_steps_trained_lifetime_throughput": 736.3495529853677}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 11988, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3869.811658515539, "num_module_steps_trained_throughput": 32074513.313375153, "num_module_steps_trained_lifetime_throughput": 12955979.040658657}, "IntrinsicAttentionMask": [[[0.34221482276916504, 0.32203230261802673, 0.33575281500816345], [0.2893804907798767, 0.3922711908817291, 0.31834834814071655], [0.32550764083862305, 0.34345853328704834, 0.3310338854789734]], [[0.3333694040775299, 0.3332499563694, 0.33338063955307007], [0.31691884994506836, 0.3708075284957886, 0.3122735619544983], [0.33485329151153564, 0.3298157751560211, 0.33533090353012085]], [[0.3307735323905945, 0.33881208300590515, 0.330414354801178], [0.3134080469608307, 0.375745952129364, 0.3108460009098053], [0.3315353989601135, 0.33718255162239075, 0.3312821090221405]], [[0.3333950638771057, 0.3332318663597107, 0.3333730101585388], [0.3333815038204193, 0.3332541882991791, 0.3333643078804016], [0.33339324593544006, 0.33323487639427185, 0.3333718478679657]], [[0.3452112078666687, 0.34443363547325134, 0.31035518646240234], [0.3447939455509186, 0.3440450131893158, 0.3111610412597656], [0.324957013130188, 0.325460284948349, 0.3495826721191406]], [[0.3439842164516449, 0.3327745497226715, 0.323241263628006], [0.3269142210483551, 0.333568274974823, 0.3395175039768219], [0.31220823526382446, 0.33380749821662903, 0.3539842963218689]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3119910241566145e-05, "add_time_dim_to_batch_and_zero_pad": 8.165468471981233e-06, "add_observations_from_episodes_to_batch": 3.3744295697157626e-06, "numpy_to_tensor": 1.3051881606848435e-05, "add_states_from_episodes_to_batch": 2.8655169295657132e-06}}, "connector_pipeline_timer": 6.541468814099503e-05}, "agent_episode_returns_mean": {"default_agent": -4.4}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.520805548067786e-05, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.088937799640129e-06, "listify_data_for_vector_env": 1.0606099788627078e-05, "get_actions": 4.375019682235572e-05, "remove_single_ts_time_rank_from_batch": 1.2825368876222938e-05, "un_batch_to_individual_items": 6.734233024970978e-06, "tensor_to_numpy": 1.7235789507177086e-05}}, "connector_pipeline_timer": 0.0001271717172180953}, "module_episode_returns_mean": {"default_policy": -4.4}, "weights_seq_no": 1.0, "episode_return_mean": -4.4, "env_reset_timer": 0.0005336249014362693, "env_step_timer": 1.5446778781718032e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11844087508507073, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 5400, "episode_return_max": 12.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_duration_sec_mean": 0.005375068786088377, "num_episodes_lifetime": 20, "num_module_steps_sampled": {"default_policy": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-47-57", "timestamp": 1754930877, "time_this_iter_s": 10.016272783279419, "time_total_s": 10.016272783279419, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.016272783279419, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.7, "ram_util_percent": 78.22666666666667}}
{"timers": {"training_iteration": 9.885119112172397, "restore_env_runners": 1.1749137192964553e-05, "training_step": 9.884955800427123, "env_runner_sampling_timer": 1.6053093506989535, "learner_update_timer": 8.070299808294513, "synch_weights": 0.0008730295579880476, "restore_eval_env_runners": 9.834067896008492e-06, "evaluation_iteration": 0.12828216690104455, "synch_eval_env_connectors": 0.000158625072799623, "synch_env_connectors": 4.249974153935909e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.540986431160278e-06, "normalize_and_clip_actions": 8.01761718665716e-06, "listify_data_for_vector_env": 1.0356595682458186e-05, "remove_single_ts_time_rank_from_batch": 1.1806588748886473e-05, "tensor_to_numpy": 1.5155736307092344e-05, "get_actions": 3.799283992261578e-05}}, "connector_pipeline_timer": 0.00011652971546586857}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.828512897601569e-06, "add_observations_from_episodes_to_batch": 2.8041565037453615e-06, "numpy_to_tensor": 1.2227697426745123e-05, "add_states_from_episodes_to_batch": 2.689885564750542e-06, "batch_individual_items": 1.225931714036766e-05}}, "connector_pipeline_timer": 5.8860601545422106e-05}, "weights_seq_no": 1.0, "episode_return_mean": -1.9799999999999998, "env_reset_timer": 4.1898550123030284e-05, "sample": 0.00565484308643524, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "time_between_sampling": 0.031724708470947514, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.3674620867212088e-05, "rlmodule_inference_timer": 3.112656746296454e-05, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005202209024224429, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "num_episodes_lifetime": 500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3294.958178006229}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17222587164491415, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008691580501617863, "add_observations_from_episodes_to_batch": 0.000835892999311909, "add_columns_from_episodes_to_train_batch": 0.04164029573788866, "add_time_dim_to_batch_and_zero_pad": 0.1036014280852396, "add_states_from_episodes_to_batch": 0.0034835819236468525, "batch_individual_items": 0.013778635142371059, "numpy_to_tensor": 5.943201016634703e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26753121614456177, "use_intrinsic_rewards": 1.0, "weights_seq_no": 12.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 71928, "vf_loss_unclipped": 38.46282196044922, "vf_explained_var": 0.0050206780433654785, "policy_loss": -0.00023311996483244002, "module_train_batch_size_mean": 999.0, "entropy": 0.686380922794342, "diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.2071303129196167, "mean_kl_loss": 1.3279438462632243e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime_throughput": 52428.33817982532}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 11.0, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 2.0, "num_module_steps_trained_lifetime": 11988, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 735.6872599248841}, "default_policy": {"entropy": 0.686362624168396, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20362605154514313, "num_module_steps_trained_lifetime": 11988, "mean_kl_loss": 1.410665936418809e-05, "vf_loss": 0.2630421221256256, "use_intrinsic_rewards": 0.0, "weights_seq_no": 2.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 38.696067810058594, "vf_explained_var": -0.00039446353912353516, "num_trainable_parameters": 16595, "policy_loss": -0.00023916768259368837, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.040395982563495636, "num_module_steps_trained_lifetime_throughput": 735.674409190333}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 23976, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3866.262175737457, "num_module_steps_trained_throughput": 31623755.80316432, "num_module_steps_trained_lifetime_throughput": 12951322.914475346}, "IntrinsicAttentionMask": [[[0.34774166345596313, 0.30641603469848633, 0.3458423614501953], [0.3280341327190399, 0.3432857096195221, 0.3286800980567932], [0.34690871834754944, 0.30796608328819275, 0.3451251685619354]], [[0.3333286643028259, 0.3333313763141632, 0.3333398997783661], [0.3332825303077698, 0.333312064409256, 0.33340537548065186], [0.3331368565559387, 0.33325111865997314, 0.33361202478408813]], [[0.33351442217826843, 0.333333283662796, 0.33315226435661316], [0.3334875702857971, 0.3333333134651184, 0.3331791162490845], [0.3334607183933258, 0.3333333134651184, 0.3332059681415558]], [[0.34857892990112305, 0.34987831115722656, 0.30154284834861755], [0.34900638461112976, 0.35034507513046265, 0.3006485104560852], [0.3313225209712982, 0.3311651647090912, 0.3375122845172882]], [[0.33287131786346436, 0.3333331346511841, 0.33379560708999634], [0.33284443616867065, 0.3333331048488617, 0.33382245898246765], [0.33281761407852173, 0.3333330750465393, 0.33384934067726135]], [[0.337557852268219, 0.3224303424358368, 0.3400118052959442], [0.33475440740585327, 0.3296828269958496, 0.33556273579597473], [0.33799535036087036, 0.32129213213920593, 0.34071245789527893]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2334467704568573e-05, "add_time_dim_to_batch_and_zero_pad": 6.8023989795767e-06, "add_observations_from_episodes_to_batch": 2.782730944397005e-06, "numpy_to_tensor": 1.1733565812535421e-05, "add_states_from_episodes_to_batch": 2.733439744598112e-06}}, "connector_pipeline_timer": 5.832914769673297e-05}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.020187936768346e-05, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.806276718049514e-06, "listify_data_for_vector_env": 1.0257132377413756e-05, "get_actions": 3.547920742551642e-05, "remove_single_ts_time_rank_from_batch": 1.1719812713931208e-05, "un_batch_to_individual_items": 6.397646740537246e-06, "tensor_to_numpy": 1.5011938120707082e-05}}, "connector_pipeline_timer": 0.00011290570537637251}, "module_episode_returns_mean": {"default_policy": -0.9}, "weights_seq_no": 2.0, "episode_return_mean": -0.9, "env_reset_timer": 0.0005291374027729034, "env_step_timer": 1.3649461584773619e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11837042675470001, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 10400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_duration_sec_mean": 0.00524918754817918, "num_episodes_lifetime": 40, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.871157207991928}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-48-07", "timestamp": 1754930887, "time_this_iter_s": 9.948896884918213, "time_total_s": 19.965169668197632, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.965169668197632, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.85, "ram_util_percent": 77.77142857142857}}
{"timers": {"training_iteration": 9.885828756880143, "restore_env_runners": 1.1702475231140851e-05, "training_step": 9.885664678672933, "env_runner_sampling_timer": 1.604503400101757, "learner_update_timer": 8.071699461461884, "synch_weights": 0.0008728480120189487, "restore_eval_env_runners": 9.815726662054658e-06, "evaluation_iteration": 0.1281650548125617, "synch_eval_env_connectors": 0.00015805382281541824, "synch_env_connectors": 4.248723853379488e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.5913848856258475e-06, "normalize_and_clip_actions": 8.096357640081805e-06, "listify_data_for_vector_env": 1.0578099214824647e-05, "remove_single_ts_time_rank_from_batch": 1.1938219863906915e-05, "tensor_to_numpy": 1.5187018228121419e-05, "get_actions": 3.820116601570942e-05}}, "connector_pipeline_timer": 0.0001173106474827722}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.955397393086284e-06, "add_observations_from_episodes_to_batch": 2.8180184773814125e-06, "numpy_to_tensor": 1.2422316035468863e-05, "add_states_from_episodes_to_batch": 2.71785587506379e-06, "batch_individual_items": 1.2435550204171715e-05}}, "connector_pipeline_timer": 5.943651278810653e-05}, "weights_seq_no": 2.0, "episode_return_mean": -2.1399999999999997, "env_reset_timer": 3.837255778337258e-05, "sample": 0.005580479657713461, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "time_between_sampling": 0.03407413999452681, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.3840991888862262e-05, "rlmodule_inference_timer": 3.1146035563256675e-05, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005243768188636747, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "num_episodes_lifetime": -30375.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3280.3629664729165}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17222346875877118, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0086901384463883, "add_observations_from_episodes_to_batch": 0.0008357844895333983, "add_columns_from_episodes_to_train_batch": 0.041629631531215266, "add_time_dim_to_batch_and_zero_pad": 0.10361789964385097, "add_states_from_episodes_to_batch": 0.0034868140252423472, "batch_individual_items": 0.01376904212096706, "numpy_to_tensor": 5.94676902052015e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26592057943344116, "use_intrinsic_rewards": 1.0, "weights_seq_no": 18.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 107892, "vf_loss_unclipped": 37.25798416137695, "vf_explained_var": 0.005181312561035156, "policy_loss": -0.0008011332829482853, "module_train_batch_size_mean": 999.0, "entropy": 0.6854161620140076, "diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.20531275868415833, "mean_kl_loss": 3.636394831119105e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime_throughput": 51935.249460361156}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 16.0, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107892, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 3.0, "num_module_steps_trained_lifetime": 17982, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 734.4935248811352}, "default_policy": {"entropy": 0.6853739619255066, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2030768245458603, "num_module_steps_trained_lifetime": 17982, "mean_kl_loss": 3.933986590709537e-05, "vf_loss": 0.2630954384803772, "use_intrinsic_rewards": 0.0, "weights_seq_no": 3.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.3792610168457, "vf_explained_var": -0.0007979869842529297, "num_trainable_parameters": 16595, "policy_loss": -0.0008319304324686527, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.020197991281747818, "num_module_steps_trained_lifetime_throughput": 734.4810004079509}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 35964, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3859.9880969777523, "num_module_steps_trained_throughput": 30951424.431307618, "num_module_steps_trained_lifetime_throughput": 12943255.911790324}, "IntrinsicAttentionMask": [[[0.3376840054988861, 0.3310084939002991, 0.3313075602054596], [0.3291302025318146, 0.3355821669101715, 0.3352876305580139], [0.3295147120952606, 0.3353763222694397, 0.3351089656352997]], [[0.33434823155403137, 0.3337564170360565, 0.3318953514099121], [0.3343020975589752, 0.33373722434043884, 0.33196067810058594], [0.33415642380714417, 0.33367666602134705, 0.3321668803691864]], [[0.3307735323905945, 0.33881208300590515, 0.330414354801178], [0.3134080469608307, 0.375745952129364, 0.3108460307121277], [0.3315353989601135, 0.33718252182006836, 0.3312821090221405]], [[0.33366653323173523, 0.33278605341911316, 0.333547443151474], [0.33365294337272644, 0.33280837535858154, 0.333538681268692], [0.3336646854877472, 0.3327890634536743, 0.3335462212562561]], [[0.331096351146698, 0.33093902468681335, 0.33796462416648865], [0.33147674798965454, 0.33134591579437256, 0.3371773660182953], [0.31422746181488037, 0.31298694014549255, 0.3727855682373047]], [[0.375379353761673, 0.3021995425224304, 0.3224210739135742], [0.3028506934642792, 0.35715943574905396, 0.3399898111820221], [0.32377466559410095, 0.34068310260772705, 0.3355422616004944]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2337188829182275e-05, "add_time_dim_to_batch_and_zero_pad": 6.734773994534776e-06, "add_observations_from_episodes_to_batch": 2.8005172306677404e-06, "numpy_to_tensor": 1.1762892473141903e-05, "add_states_from_episodes_to_batch": 2.7518036536401867e-06}}, "connector_pipeline_timer": 5.8397751192881184e-05}, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.059363375796234e-05, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.844901500781653e-06, "listify_data_for_vector_env": 1.0219655884419802e-05, "get_actions": 3.5241461939911294e-05, "remove_single_ts_time_rank_from_batch": 1.1703672975969713e-05, "un_batch_to_individual_items": 6.477055580938572e-06, "tensor_to_numpy": 1.4913719316963916e-05}}, "connector_pipeline_timer": 0.00011268735106902671}, "module_episode_returns_mean": {"default_policy": 0.6}, "weights_seq_no": 3.0, "episode_return_mean": 0.6, "env_reset_timer": 0.0005247451997362077, "env_step_timer": 1.3676702920489499e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11829935332707826, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 15400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_duration_sec_mean": 0.005203287536278367, "num_episodes_lifetime": 60, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.872213308411883}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-48-17", "timestamp": 1754930897, "time_this_iter_s": 10.075855731964111, "time_total_s": 30.041025400161743, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.041025400161743, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.94285714285714, "ram_util_percent": 77.4642857142857}}
{"timers": {"training_iteration": 9.88536590723204, "restore_env_runners": 1.1653780451975761e-05, "training_step": 9.885201379385864, "env_runner_sampling_timer": 1.6038981252606657, "learner_update_timer": 8.071764765177717, "synch_weights": 0.0008720903714047744, "restore_eval_env_runners": 9.832150011789054e-06, "evaluation_iteration": 0.12805276051417458, "synch_eval_env_connectors": 0.00015805162489414216, "synch_env_connectors": 4.246236919425428e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.725451737425607e-06, "normalize_and_clip_actions": 8.165297491289888e-06, "listify_data_for_vector_env": 1.0691197350772654e-05, "remove_single_ts_time_rank_from_batch": 1.2022378720252678e-05, "tensor_to_numpy": 1.5459914321241415e-05, "get_actions": 3.913785783623796e-05}}, "connector_pipeline_timer": 0.00011929406226965523}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.01749213474529e-06, "add_observations_from_episodes_to_batch": 2.842806858864036e-06, "numpy_to_tensor": 1.2666983577756251e-05, "add_states_from_episodes_to_batch": 2.736753957400638e-06, "batch_individual_items": 1.2507611083024986e-05}}, "connector_pipeline_timer": 5.9941664136094746e-05}, "weights_seq_no": 3.0, "episode_return_mean": -2.7799999999999994, "env_reset_timer": 4.067907993697214e-05, "sample": 0.005680687043778114, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "time_between_sampling": 0.034695988323662386, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.3998610351396425e-05, "rlmodule_inference_timer": 3.1642488727963243e-05, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005307431359775366, "module_episode_returns_mean": {"default_policy": -2.7799999999999994}, "num_episodes_lifetime": -61250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.7799999999999994}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3225.3525698687654}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17219280657087777, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008691991651593824, "add_observations_from_episodes_to_batch": 0.0008358928942027269, "add_columns_from_episodes_to_train_batch": 0.04162444312623445, "add_time_dim_to_batch_and_zero_pad": 0.10360034397757716, "add_states_from_episodes_to_batch": 0.003491703805884696, "batch_individual_items": 0.013754618370610289, "numpy_to_tensor": 5.9486764193046834e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.2652108073234558, "use_intrinsic_rewards": 1.0, "weights_seq_no": 24.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 143856, "vf_loss_unclipped": 39.672508239746094, "vf_explained_var": 0.005091607570648193, "policy_loss": -0.0003533305716700852, "module_train_batch_size_mean": 999.0, "entropy": 0.6844435930252075, "diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.20520605146884918, "mean_kl_loss": 1.7271009710384533e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 756000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 287712, "num_env_steps_trained_lifetime_throughput": 51296.43131509281}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 21.0, "weights_seq_no": 24.0, "num_module_steps_trained_lifetime": 143856, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 4.0, "num_module_steps_trained_lifetime": 23976, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 732.9058029814129}, "default_policy": {"entropy": 0.6844116449356079, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2035057693719864, "num_module_steps_trained_lifetime": 23976, "mean_kl_loss": 1.872253415058367e-05, "vf_loss": 0.2630488872528076, "use_intrinsic_rewards": 0.0, "weights_seq_no": 4.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.9750862121582, "vf_explained_var": -0.0007319450378417969, "num_trainable_parameters": 16595, "policy_loss": -0.0003669601574074477, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.010098995640873909, "num_module_steps_trained_lifetime_throughput": 732.8936936512215}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 47952, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3851.643330728104, "num_module_steps_trained_throughput": 30184969.81402139, "num_module_steps_trained_lifetime_throughput": 12937890.74010518}, "IntrinsicAttentionMask": [[[0.34774166345596313, 0.30641603469848633, 0.3458423614501953], [0.3280341327190399, 0.3432857394218445, 0.3286801278591156], [0.34690871834754944, 0.30796608328819275, 0.3451251685619354]], [[0.3532969057559967, 0.2987012565135956, 0.3480018377304077], [0.33283698558807373, 0.3342032730579376, 0.3329596519470215], [0.351489782333374, 0.30180624127388, 0.3467039465904236]], [[0.3328939378261566, 0.3333331346511841, 0.3337729275226593], [0.3328671157360077, 0.3333331346511841, 0.333799809217453], [0.3328402638435364, 0.3333331048488617, 0.3338266611099243]], [[0.3659096956253052, 0.3175552785396576, 0.31653502583503723], [0.33007127046585083, 0.33490902185440063, 0.33501967787742615], [0.32927823066711426, 0.3352919816970825, 0.3354297876358032]], [[0.34693074226379395, 0.3263082504272461, 0.3267609775066376], [0.3125609755516052, 0.3440932035446167, 0.3433458209037781], [0.3133179247379303, 0.34370046854019165, 0.3429815471172333]], [[0.3368171751499176, 0.33326688408851624, 0.32991594076156616], [0.32456129789352417, 0.3333950638771057, 0.34204360842704773], [0.3130286931991577, 0.33324047923088074, 0.3537307679653168]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2458641588557494e-05, "add_time_dim_to_batch_and_zero_pad": 6.7352834579040215e-06, "add_observations_from_episodes_to_batch": 2.7810426492036845e-06, "numpy_to_tensor": 1.181048387904491e-05, "add_states_from_episodes_to_batch": 2.7361835105756663e-06}}, "connector_pipeline_timer": 5.848701180934404e-05}, "agent_episode_returns_mean": {"default_agent": 1.1}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.0283583595225183e-05, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.894503199659403e-06, "listify_data_for_vector_env": 1.0362220925658798e-05, "get_actions": 3.529891357732126e-05, "remove_single_ts_time_rank_from_batch": 1.1883416308934274e-05, "un_batch_to_individual_items": 6.47745066433474e-06, "tensor_to_numpy": 1.4992438666705292e-05}}, "connector_pipeline_timer": 0.0001132335179911782}, "module_episode_returns_mean": {"default_policy": 1.1}, "weights_seq_no": 4.0, "episode_return_mean": 1.1, "env_reset_timer": 0.0005203223279407247, "env_step_timer": 1.378624556838066e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11823862854413977, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 20400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_duration_sec_mean": 0.00519202866271371, "num_episodes_lifetime": 80, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.872083656157448}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-48-27", "timestamp": 1754930907, "time_this_iter_s": 9.959757089614868, "time_total_s": 40.00078248977661, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.00078248977661, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.535714285714285, "ram_util_percent": 77.24285714285713}}
{"timers": {"training_iteration": 9.886929905658922, "restore_env_runners": 1.1595992803769185e-05, "training_step": 9.886765065171756, "env_runner_sampling_timer": 1.6027970444281043, "learner_update_timer": 8.074348637946876, "synch_weights": 0.0008733177983892615, "restore_eval_env_runners": 9.833828108967282e-06, "evaluation_iteration": 0.12794762040842114, "synch_eval_env_connectors": 0.00015751027837395667, "synch_env_connectors": 4.245864509837702e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.485976468941161e-06, "normalize_and_clip_actions": 7.950619287080235e-06, "listify_data_for_vector_env": 1.0418860478669357e-05, "remove_single_ts_time_rank_from_batch": 1.1734393134931535e-05, "tensor_to_numpy": 1.497355916896892e-05, "get_actions": 3.7427776744102854e-05}}, "connector_pipeline_timer": 0.00011543516426328415}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.7952883059038115e-06, "add_observations_from_episodes_to_batch": 2.7727954724527663e-06, "numpy_to_tensor": 1.2144674266648313e-05, "add_states_from_episodes_to_batch": 2.687059895166569e-06, "batch_individual_items": 1.2251240107392177e-05}}, "connector_pipeline_timer": 5.853199373883997e-05}, "weights_seq_no": 4.0, "episode_return_mean": -2.1399999999999997, "env_reset_timer": 3.455307146639129e-05, "sample": 0.005534073472390579, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "time_between_sampling": 0.03422884945917599, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.3579811676611899e-05, "rlmodule_inference_timer": 3.061938678233734e-05, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005159134357236327, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "num_episodes_lifetime": -92125.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3335.7744303095005}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17216744683452187, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00869111965570913, "add_observations_from_episodes_to_batch": 0.0008357427146108601, "add_columns_from_episodes_to_train_batch": 0.04161560703464204, "add_time_dim_to_batch_and_zero_pad": 0.10359370844803377, "add_states_from_episodes_to_batch": 0.0034949130185548136, "batch_individual_items": 0.013741181767551387, "numpy_to_tensor": 6.116314667427446e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26447880268096924, "use_intrinsic_rewards": 1.0, "weights_seq_no": 30.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 179820, "vf_loss_unclipped": 38.873355865478516, "vf_explained_var": 0.005124866962432861, "policy_loss": -0.0003159300540573895, "module_train_batch_size_mean": 999.0, "entropy": 0.6837518811225891, "diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.20467384159564972, "mean_kl_loss": 1.4802050827711355e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 945000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 359640, "num_env_steps_trained_lifetime_throughput": 50554.85264076705}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 26.0, "weights_seq_no": 30.0, "num_module_steps_trained_lifetime": 179820, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 5.0, "num_module_steps_trained_lifetime": 29970, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 730.7922387532063}, "default_policy": {"entropy": 0.683721125125885, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2035386711359024, "num_module_steps_trained_lifetime": 29970, "mean_kl_loss": 1.6064459487097338e-05, "vf_loss": 0.26303982734680176, "use_intrinsic_rewards": 0.0, "weights_seq_no": 5.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.10406494140625, "vf_explained_var": -0.00021314620971679688, "num_trainable_parameters": 16595, "policy_loss": -0.0003278308140579611, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.0050494978204369545, "num_module_steps_trained_lifetime_throughput": 730.7805850712913}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 59940, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3840.534926241385, "num_module_steps_trained_throughput": 29358315.942493383, "num_module_steps_trained_lifetime_throughput": 12915587.454927325}, "IntrinsicAttentionMask": [[[0.3422189950942993, 0.3354538381099701, 0.322327196598053], [0.3247220814228058, 0.3310876190662384, 0.3441902697086334], [0.29024437069892883, 0.32017430663108826, 0.3895813524723053]], [[0.37295398116111755, 0.3153206706047058, 0.31172531843185425], [0.3323925733566284, 0.3337570130825043, 0.3338504433631897], [0.32970213890075684, 0.33496758341789246, 0.3353303372859955]], [[0.3550397753715515, 0.35355713963508606, 0.29140305519104004], [0.35463595390319824, 0.35318344831466675, 0.2921805679798126], [0.33537426590919495, 0.33524614572525024, 0.3293796181678772]], [[0.33366650342941284, 0.33278605341911316, 0.3335474133491516], [0.33365294337272644, 0.33280837535858154, 0.3335387110710144], [0.3336646854877472, 0.3327890634536743, 0.3335462510585785]], [[0.3547864854335785, 0.2933361232280731, 0.351877361536026], [0.33544206619262695, 0.3293805420398712, 0.33517736196517944], [0.3539705276489258, 0.2948482036590576, 0.3511812388896942]], [[0.3318730592727661, 0.3357514441013336, 0.33237549662590027], [0.32619208097457886, 0.3452012240886688, 0.32860666513442993], [0.3311353623867035, 0.33697476983070374, 0.33188992738723755]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2306357359300003e-05, "add_time_dim_to_batch_and_zero_pad": 6.730822313957821e-06, "add_observations_from_episodes_to_batch": 2.779445130517457e-06, "numpy_to_tensor": 1.1675362320139244e-05, "add_states_from_episodes_to_batch": 2.735295720510311e-06}}, "connector_pipeline_timer": 5.83454598458956e-05}, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.070572217493856e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.906524597789859e-06, "listify_data_for_vector_env": 1.0301444699223045e-05, "get_actions": 3.519679625640296e-05, "remove_single_ts_time_rank_from_batch": 1.1890442128771026e-05, "un_batch_to_individual_items": 6.421081553379499e-06, "tensor_to_numpy": 1.4675613223909268e-05}}, "connector_pipeline_timer": 0.00011264393741703862}, "module_episode_returns_mean": {"default_policy": 0.8}, "weights_seq_no": 5.0, "episode_return_mean": 0.8, "env_reset_timer": 0.0005159261853120195, "env_step_timer": 1.369308103991162e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11816865475819509, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 25400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_duration_sec_mean": 0.005177562492899596, "num_episodes_lifetime": 100, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.873982862935314}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-48-37", "timestamp": 1754930917, "time_this_iter_s": 10.161343812942505, "time_total_s": 50.162126302719116, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.162126302719116, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.0, "ram_util_percent": 77.04666666666667}}
{"timers": {"training_iteration": 9.887825350763261, "restore_env_runners": 1.1542532769560718e-05, "training_step": 9.887660222859477, "env_runner_sampling_timer": 1.6027008444035253, "learner_update_timer": 8.07522173364743, "synch_weights": 0.0008756216997899193, "restore_eval_env_runners": 9.808819839096395e-06, "evaluation_iteration": 0.12783657503375762, "synch_eval_env_connectors": 0.00015708642533421513, "synch_env_connectors": 4.246736811676529e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.7945565330022e-06, "normalize_and_clip_actions": 8.361303862643821e-06, "listify_data_for_vector_env": 1.0976927676462836e-05, "remove_single_ts_time_rank_from_batch": 1.2200827634931776e-05, "tensor_to_numpy": 1.585972107192298e-05, "get_actions": 4.0873612247237846e-05}}, "connector_pipeline_timer": 0.00012260711754562818}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.240705895545359e-06, "add_observations_from_episodes_to_batch": 2.967793286168832e-06, "numpy_to_tensor": 1.3064334320282239e-05, "add_states_from_episodes_to_batch": 2.795732194838841e-06, "batch_individual_items": 1.2951220657012144e-05}}, "connector_pipeline_timer": 6.168517265132683e-05}, "weights_seq_no": 5.0, "episode_return_mean": -1.5, "env_reset_timer": 3.8849717173587485e-05, "sample": 0.005695639861953917, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "time_between_sampling": 0.035135719428219414, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.464845099482944e-05, "rlmodule_inference_timer": 3.271598421199422e-05, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005473946956451981, "module_episode_returns_mean": {"default_policy": -1.5}, "num_episodes_lifetime": -123000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3188.4989555232673}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17216639069588605, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008689880128955598, "add_observations_from_episodes_to_batch": 0.0008355561273295122, "add_columns_from_episodes_to_train_batch": 0.04160788512434935, "add_time_dim_to_batch_and_zero_pad": 0.10361310011407066, "add_states_from_episodes_to_batch": 0.0034975384690070035, "batch_individual_items": 0.013727562450111013, "numpy_to_tensor": 6.118026504749325e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.2638629376888275, "use_intrinsic_rewards": 1.0, "weights_seq_no": 36.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 215784, "vf_loss_unclipped": 35.9964599609375, "vf_explained_var": 0.005262911319732666, "policy_loss": -0.00015203584916889668, "module_train_batch_size_mean": 999.0, "entropy": 0.6832475662231445, "diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.20435866713523865, "mean_kl_loss": 1.4448785805143416e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1134000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 431568, "num_env_steps_trained_lifetime_throughput": 49751.62766671378}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 31.0, "weights_seq_no": 36.0, "num_module_steps_trained_lifetime": 215784, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35964, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 728.5149083594391}, "default_policy": {"entropy": 0.6832314729690552, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2037276327610016, "num_module_steps_trained_lifetime": 35964, "mean_kl_loss": 1.5069207620399538e-05, "vf_loss": 0.263059139251709, "use_intrinsic_rewards": 0.0, "weights_seq_no": 6.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 36.041725158691406, "vf_explained_var": 0.00035643577575683594, "num_trainable_parameters": 16595, "policy_loss": -0.00015465618344023824, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.0025247489102184772, "num_module_steps_trained_lifetime_throughput": 728.5037366987947}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3828.5657803628387, "num_module_steps_trained_throughput": 28546029.08879654, "num_module_steps_trained_lifetime_throughput": 12900838.001543643}, "IntrinsicAttentionMask": [[[0.3376840054988861, 0.3310084939002991, 0.3313075602054596], [0.3291302025318146, 0.3355821669101715, 0.3352876305580139], [0.3295147120952606, 0.3353763222694397, 0.3351089656352997]], [[0.3532969057559967, 0.2987012565135956, 0.3480018675327301], [0.33283698558807373, 0.3342032730579376, 0.3329596519470215], [0.351489782333374, 0.30180624127388, 0.34670397639274597]], [[0.35786062479019165, 0.3214426338672638, 0.32069677114486694], [0.3189755380153656, 0.34027406573295593, 0.34075045585632324], [0.3181587755680084, 0.34066838026046753, 0.34117281436920166]], [[0.33313554525375366, 0.3336583375930786, 0.3332061171531677], [0.3331219553947449, 0.333680659532547, 0.33319738507270813], [0.3331336975097656, 0.33366134762763977, 0.3332049250602722]], [[0.3310963213443756, 0.33093902468681335, 0.33796459436416626], [0.33147671818733215, 0.33134591579437256, 0.3371773362159729], [0.31422749161720276, 0.31298696994781494, 0.3727855682373047]], [[0.3318730592727661, 0.33575141429901123, 0.33237549662590027], [0.3261922001838684, 0.3452010452747345, 0.3286067545413971], [0.3311353623867035, 0.33697471022605896, 0.33188992738723755]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2917013472438195e-05, "add_time_dim_to_batch_and_zero_pad": 7.1087074617824705e-06, "add_observations_from_episodes_to_batch": 2.868700686444135e-06, "numpy_to_tensor": 1.3062205044362682e-05, "add_states_from_episodes_to_batch": 2.783422380702844e-06}}, "connector_pipeline_timer": 6.140555938350494e-05}, "agent_episode_returns_mean": {"default_agent": 2.0}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.197241274301716e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.250092612026052e-06, "listify_data_for_vector_env": 1.0799622312536132e-05, "get_actions": 3.859474118028139e-05, "remove_single_ts_time_rank_from_batch": 1.2218483005684232e-05, "un_batch_to_individual_items": 6.721752237252647e-06, "tensor_to_numpy": 1.601517585742293e-05}}, "connector_pipeline_timer": 0.00012024913863843457}, "module_episode_returns_mean": {"default_policy": 2.0}, "weights_seq_no": 6.0, "episode_return_mean": 2.0, "env_reset_timer": 0.0005116290033642454, "env_step_timer": 1.469945292554495e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11816783530120158, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 30400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_duration_sec_mean": 0.005178832095116377, "num_episodes_lifetime": 120, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.875216362226267}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-48-47", "timestamp": 1754930927, "time_this_iter_s": 10.102757930755615, "time_total_s": 60.26488423347473, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60.26488423347473, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.15, "ram_util_percent": 77.52142857142857}}
{"timers": {"training_iteration": 9.888052793085121, "restore_env_runners": 1.1496267456256056e-05, "training_step": 9.887887228130156, "env_runner_sampling_timer": 1.6028663492900967, "learner_update_timer": 8.075178107970741, "synch_weights": 0.0008760400730238708, "restore_eval_env_runners": 9.843652326860987e-06, "evaluation_iteration": 0.12779349928316955, "synch_eval_env_connectors": 0.00015684223125256595, "synch_env_connectors": 4.246769185099122e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.585025809490709e-06, "normalize_and_clip_actions": 8.069023025430116e-06, "listify_data_for_vector_env": 1.0494625753604835e-05, "remove_single_ts_time_rank_from_batch": 1.1869429953259747e-05, "tensor_to_numpy": 1.5239288617891974e-05, "get_actions": 3.8311194729340135e-05}}, "connector_pipeline_timer": 0.00011742730252836725}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.892774225528779e-06, "add_observations_from_episodes_to_batch": 2.8214728169500072e-06, "numpy_to_tensor": 1.2386616991222126e-05, "add_states_from_episodes_to_batch": 2.7227590854722346e-06, "batch_individual_items": 1.2410211809069077e-05}}, "connector_pipeline_timer": 5.9447647896574656e-05}, "weights_seq_no": 6.0, "episode_return_mean": -1.8199999999999996, "env_reset_timer": 4.1778685680093276e-05, "sample": 0.0057343620846310285, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "time_between_sampling": 0.03493793933714734, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.3851032412019739e-05, "rlmodule_inference_timer": 3.138317068126298e-05, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005252763349562887, "module_episode_returns_mean": {"default_policy": -1.8199999999999996}, "num_episodes_lifetime": -153875.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.8199999999999996}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3255.240997262704}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1721616259482916, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008688709248188957, "add_observations_from_episodes_to_batch": 0.0008365184868323011, "add_columns_from_episodes_to_train_batch": 0.041606084612700454, "add_time_dim_to_batch_and_zero_pad": 0.1036131203623573, "add_states_from_episodes_to_batch": 0.003503336414573276, "batch_individual_items": 0.013719125996402974, "numpy_to_tensor": 6.127304284931148e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26377126574516296, "use_intrinsic_rewards": 1.0, "weights_seq_no": 42.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 251748, "vf_loss_unclipped": 38.88867950439453, "vf_explained_var": 0.005067110061645508, "policy_loss": -3.070961611228995e-05, "module_train_batch_size_mean": 999.0, "entropy": 0.68209308385849, "diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.20441080629825592, "mean_kl_loss": 1.7404188838554546e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1323000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 503496, "num_env_steps_trained_lifetime_throughput": 48921.049433720116}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 36.0, "weights_seq_no": 42.0, "num_module_steps_trained_lifetime": 251748, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 7.0, "num_module_steps_trained_lifetime": 41958, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 726.2299482275797}, "default_policy": {"entropy": 0.6820969581604004, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20384013652801514, "num_module_steps_trained_lifetime": 41958, "mean_kl_loss": 1.725941910990514e-05, "vf_loss": 0.2630438208580017, "use_intrinsic_rewards": 0.0, "weights_seq_no": 7.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.088279724121094, "vf_explained_var": 0.0001767873764038086, "num_trainable_parameters": 16595, "policy_loss": -3.189293420291506e-05, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.0012623744551092386, "num_module_steps_trained_lifetime_throughput": 726.2192646179471}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 83916, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3816.5564467514323, "num_module_steps_trained_throughput": 27760107.03048562, "num_module_steps_trained_lifetime_throughput": 12890583.104947327}, "IntrinsicAttentionMask": [[[0.3422189950942993, 0.3354538381099701, 0.3223271667957306], [0.3247220814228058, 0.3310876488685608, 0.3441902697086334], [0.29024437069892883, 0.32017430663108826, 0.3895813524723053]], [[0.3530822694301605, 0.35180172324180603, 0.29511603713035583], [0.35265761613845825, 0.35140693187713623, 0.2959355115890503], [0.3314096927642822, 0.3315233588218689, 0.33706700801849365]], [[0.3550397753715515, 0.35355713963508606, 0.29140305519104004], [0.35463598370552063, 0.35318347811698914, 0.2921805679798126], [0.33537426590919495, 0.33524614572525024, 0.3293795585632324]], [[0.34857895970344543, 0.3498782813549042, 0.3015427589416504], [0.34900644421577454, 0.35034507513046265, 0.3006485104560852], [0.3313225507736206, 0.3311651945114136, 0.3375123143196106]], [[0.37733060121536255, 0.31197550892829895, 0.3106938302516937], [0.3374420404434204, 0.3313443660736084, 0.3312136232852936], [0.3366013765335083, 0.33175137639045715, 0.33164718747138977]], [[0.3318730890750885, 0.33575141429901123, 0.33237552642822266], [0.32619228959083557, 0.34520095586776733, 0.32860681414604187], [0.3311353921890259, 0.33697471022605896, 0.33188995718955994]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2386756648970972e-05, "add_time_dim_to_batch_and_zero_pad": 6.724837040210654e-06, "add_observations_from_episodes_to_batch": 2.75991475507636e-06, "numpy_to_tensor": 1.173005776415133e-05, "add_states_from_episodes_to_batch": 2.7122463641393387e-06}}, "connector_pipeline_timer": 5.828936476829504e-05}, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.0054874020503162e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.746967648423688e-06, "listify_data_for_vector_env": 1.030414985141679e-05, "get_actions": 3.520472108703066e-05, "remove_single_ts_time_rank_from_batch": 1.17739573376688e-05, "un_batch_to_individual_items": 6.426125658245346e-06, "tensor_to_numpy": 1.4800151209285147e-05}}, "connector_pipeline_timer": 0.0001125076795343998}, "module_episode_returns_mean": {"default_policy": 0.8}, "weights_seq_no": 7.0, "episode_return_mean": 0.8, "env_reset_timer": 0.0005077606227163138, "env_step_timer": 1.3675551655743537e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11810714694722493, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 35400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_duration_sec_mean": 0.0051813225145451725, "num_episodes_lifetime": 140, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.875786734433854}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-48-57", "timestamp": 1754930937, "time_this_iter_s": 10.03146505355835, "time_total_s": 70.29634928703308, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.29634928703308, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.18666666666666, "ram_util_percent": 77.52666666666667}}
{"timers": {"training_iteration": 9.888657592235328, "restore_env_runners": 1.1440884979251301e-05, "training_step": 9.888491527939111, "env_runner_sampling_timer": 1.6037073662072139, "learner_update_timer": 8.074864720641262, "synch_weights": 0.0008766446725900162, "restore_eval_env_runners": 9.822715811639004e-06, "evaluation_iteration": 0.127696961369828, "synch_eval_env_connectors": 0.00015659255937738937, "synch_env_connectors": 4.248471794655707e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.736646050111276e-06, "normalize_and_clip_actions": 8.35197826354334e-06, "listify_data_for_vector_env": 1.0872788059965048e-05, "remove_single_ts_time_rank_from_batch": 1.2119178457850308e-05, "tensor_to_numpy": 1.5786777503907015e-05, "get_actions": 4.0598770988995133e-05}}, "connector_pipeline_timer": 0.00012177695432901773}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.193900135205025e-06, "add_observations_from_episodes_to_batch": 2.933307070119973e-06, "numpy_to_tensor": 1.2955794033684555e-05, "add_states_from_episodes_to_batch": 2.7853731678097277e-06, "batch_individual_items": 1.2788680484078877e-05}}, "connector_pipeline_timer": 6.130916261918497e-05}, "weights_seq_no": 7.0, "episode_return_mean": -2.2199999999999998, "env_reset_timer": 4.246401985697223e-05, "sample": 0.00598494645849928, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "time_between_sampling": 0.034307596179652906, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.4531462056149734e-05, "rlmodule_inference_timer": 5.312495028395496e-05, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005852776949759574, "module_episode_returns_mean": {"default_policy": -2.2199999999999998}, "num_episodes_lifetime": -184750.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.2199999999999998}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3180.5696890615864}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1721367051087684, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008688260075815505, "add_observations_from_episodes_to_batch": 0.0008365887224231145, "add_columns_from_episodes_to_train_batch": 0.041600514596536686, "add_time_dim_to_batch_and_zero_pad": 0.10360398415799903, "add_states_from_episodes_to_batch": 0.0035057793008637, "batch_individual_items": 0.013707313487402081, "numpy_to_tensor": 6.121948198707716e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.2634415924549103, "use_intrinsic_rewards": 1.0, "weights_seq_no": 48.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 287712, "vf_loss_unclipped": 37.226478576660156, "vf_explained_var": 0.005088627338409424, "policy_loss": -0.00018292697495780885, "module_train_batch_size_mean": 999.0, "entropy": 0.6818509697914124, "diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.20399999618530273, "mean_kl_loss": 4.022396296932129e-06}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1512000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 575424, "num_env_steps_trained_lifetime_throughput": 48083.87607573397}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 41.0, "weights_seq_no": 48.0, "num_module_steps_trained_lifetime": 287712, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 8.0, "num_module_steps_trained_lifetime": 47952, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 723.9876323325072}, "default_policy": {"entropy": 0.6818268895149231, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20368869602680206, "num_module_steps_trained_lifetime": 47952, "mean_kl_loss": 4.487397291086381e-06, "vf_loss": 0.2630547285079956, "use_intrinsic_rewards": 0.0, "weights_seq_no": 8.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.3619384765625, "vf_explained_var": -6.604194641113281e-05, "num_trainable_parameters": 16595, "policy_loss": -0.00019222003174945712, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.0006311872275546193, "num_module_steps_trained_lifetime_throughput": 723.9774605418817}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 95904, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3804.7713505425277, "num_module_steps_trained_throughput": 26990506.73157818, "num_module_steps_trained_lifetime_throughput": 12869016.661391413}, "IntrinsicAttentionMask": [[[0.34221482276916504, 0.32203227281570435, 0.33575281500816345], [0.2893804907798767, 0.39227116107940674, 0.31834834814071655], [0.32550764083862305, 0.34345850348472595, 0.331033855676651]], [[0.37295395135879517, 0.3153206408023834, 0.311725378036499], [0.33239254355430603, 0.3337570130825043, 0.3338504433631897], [0.3297021687030792, 0.33496755361557007, 0.3353303074836731]], [[0.34559038281440735, 0.31042104959487915, 0.3439885079860687], [0.32577815651893616, 0.34753087162971497, 0.3266909718513489], [0.34475257992744446, 0.31198230385780334, 0.343265175819397]], [[0.33313554525375366, 0.3336583375930786, 0.3332061171531677], [0.3331219553947449, 0.333680659532547, 0.33319738507270813], [0.3331336975097656, 0.33366134762763977, 0.3332049548625946]], [[0.33408528566360474, 0.33333277702331543, 0.33258193731307983], [0.3340584337711334, 0.3333328068256378, 0.33260878920555115], [0.33403152227401733, 0.3333328366279602, 0.3326356112957001]], [[0.3318730890750885, 0.33575141429901123, 0.33237552642822266], [0.32619231939315796, 0.34520089626312256, 0.32860684394836426], [0.3311353623867035, 0.3369746804237366, 0.33188992738723755]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2213015763760389e-05, "add_time_dim_to_batch_and_zero_pad": 6.717365578002483e-06, "add_observations_from_episodes_to_batch": 2.7676801808477553e-06, "numpy_to_tensor": 1.1628470810586334e-05, "add_states_from_episodes_to_batch": 2.6903573673450344e-06}}, "connector_pipeline_timer": 5.769115773498628e-05}, "agent_episode_returns_mean": {"default_agent": 1.0}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.001079128291053e-05, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.902044517076362e-06, "listify_data_for_vector_env": 1.0208202740986456e-05, "get_actions": 3.537581384127488e-05, "remove_single_ts_time_rank_from_batch": 1.1708603528246222e-05, "un_batch_to_individual_items": 6.330738884529761e-06, "tensor_to_numpy": 1.4877575203846134e-05}}, "connector_pipeline_timer": 0.00011250807166634136}, "module_episode_returns_mean": {"default_policy": 1.0}, "weights_seq_no": 8.0, "episode_return_mean": 1.0, "env_reset_timer": 0.0005036063564651485, "env_step_timer": 1.3563148194057949e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.1180381271479594, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 40400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_duration_sec_mean": 0.005181801735889166, "num_episodes_lifetime": 160, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.876730593748483}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-49-07", "timestamp": 1754930947, "time_this_iter_s": 10.067868947982788, "time_total_s": 80.36421823501587, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.36421823501587, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.75, "ram_util_percent": 77.55714285714286}}
{"timers": {"training_iteration": 9.887636593393493, "restore_env_runners": 1.1386475422175172e-05, "training_step": 9.887470179330286, "env_runner_sampling_timer": 1.6026948050449454, "learner_update_timer": 8.073999224275028, "synch_weights": 0.0008760423962950892, "restore_eval_env_runners": 9.805318139773492e-06, "evaluation_iteration": 0.12758414634577156, "synch_eval_env_connectors": 0.00015629121384341205, "synch_env_connectors": 4.245157340044259e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.523397791758173e-06, "normalize_and_clip_actions": 8.054058270869132e-06, "listify_data_for_vector_env": 1.0367438563322645e-05, "remove_single_ts_time_rank_from_batch": 1.1739723231803504e-05, "tensor_to_numpy": 1.5182696880935133e-05, "get_actions": 3.788173536682909e-05}}, "connector_pipeline_timer": 0.00011631436545000255}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.851939842738323e-06, "add_observations_from_episodes_to_batch": 2.8035144286675502e-06, "numpy_to_tensor": 1.2324810708824282e-05, "add_states_from_episodes_to_batch": 2.6964360044856945e-06, "batch_individual_items": 1.2188047499342271e-05}}, "connector_pipeline_timer": 5.878005948982321e-05}, "weights_seq_no": 8.0, "episode_return_mean": -0.54, "env_reset_timer": 3.752753085086262e-05, "sample": 0.005780110252827744, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "time_between_sampling": 0.034082564105351015, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.359251477159753e-05, "rlmodule_inference_timer": 3.084899140664143e-05, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005179061630740763, "module_episode_returns_mean": {"default_policy": -0.54}, "num_episodes_lifetime": -215625.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -0.54}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3311.5794129955534}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17289892138785748, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008685434144205036, "add_observations_from_episodes_to_batch": 0.0008370215855491352, "add_columns_from_episodes_to_train_batch": 0.04158635028102592, "add_time_dim_to_batch_and_zero_pad": 0.10357478764652481, "add_states_from_episodes_to_batch": 0.0035081823379176907, "batch_individual_items": 0.014513220352345967, "numpy_to_tensor": 6.119103666451572e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.2633224427700043, "use_intrinsic_rewards": 1.0, "weights_seq_no": 54.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 323676, "vf_loss_unclipped": 35.54879379272461, "vf_explained_var": 0.005144596099853516, "policy_loss": -0.00017579847190063447, "module_train_batch_size_mean": 999.0, "entropy": 0.6814440488815308, "diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.2039155811071396, "mean_kl_loss": 8.25062033982249e-06}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1701000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 647352, "num_env_steps_trained_lifetime_throughput": 47257.267054740885}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 46.0, "weights_seq_no": 54.0, "num_module_steps_trained_lifetime": 323676, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 9.0, "num_module_steps_trained_lifetime": 53946, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 721.9325549606001}, "default_policy": {"entropy": 0.6814188361167908, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2036920040845871, "num_module_steps_trained_lifetime": 53946, "mean_kl_loss": 8.939208782976493e-06, "vf_loss": 0.263045072555542, "use_intrinsic_rewards": 0.0, "weights_seq_no": 9.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 35.622982025146484, "vf_explained_var": -2.6345252990722656e-05, "num_trainable_parameters": 16595, "policy_loss": -0.00018199435726273805, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.00031559361377730966, "num_module_steps_trained_lifetime_throughput": 721.9229061338984}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 107892, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3793.9703178899404, "num_module_steps_trained_throughput": 26260055.74973904, "num_module_steps_trained_lifetime_throughput": 12852888.70877132}, "IntrinsicAttentionMask": [[[0.34221482276916504, 0.32203227281570435, 0.33575281500816345], [0.2893804907798767, 0.39227116107940674, 0.31834834814071655], [0.32550764083862305, 0.34345850348472595, 0.331033855676651]], [[0.3414744734764099, 0.3143870234489441, 0.344138503074646], [0.3256683349609375, 0.3509441316127777, 0.3233874440193176], [0.3428938090801239, 0.3110560178756714, 0.3460501432418823]], [[0.33077502250671387, 0.33059537410736084, 0.3386296331882477], [0.33115580677986145, 0.3310026228427887, 0.33784162998199463], [0.3138900101184845, 0.3126296103000641, 0.3734804391860962]], [[0.33766284584999084, 0.33109843730926514, 0.33123868703842163], [0.3004855215549469, 0.3503362834453583, 0.3491781949996948], [0.30126261711120605, 0.349932998418808, 0.3488043546676636]], [[0.331096351146698, 0.33093902468681335, 0.33796459436416626], [0.33147671818733215, 0.33134591579437256, 0.3371773362159729], [0.31422749161720276, 0.31298696994781494, 0.3727855682373047]], [[0.342631071805954, 0.31804385781288147, 0.3393249809741974], [0.3370227515697479, 0.3272441029548645, 0.3357331454753876], [0.3419031798839569, 0.31923410296440125, 0.33886268734931946]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2355534624340628e-05, "add_time_dim_to_batch_and_zero_pad": 6.767274380703634e-06, "add_observations_from_episodes_to_batch": 2.76465101003983e-06, "numpy_to_tensor": 1.1704861676688947e-05, "add_states_from_episodes_to_batch": 2.7417576850557003e-06}}, "connector_pipeline_timer": 5.827888470021054e-05}, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 2.9962921299847845e-05, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.81638502261091e-06, "listify_data_for_vector_env": 1.0294219072173862e-05, "get_actions": 3.483171695946838e-05, "remove_single_ts_time_rank_from_batch": 1.1744177082536045e-05, "un_batch_to_individual_items": 6.450284217348903e-06, "tensor_to_numpy": 1.4764213644670958e-05}}, "connector_pipeline_timer": 0.00011218130460655831}, "module_episode_returns_mean": {"default_policy": 0.6}, "weights_seq_no": 9.0, "episode_return_mean": 0.6, "env_reset_timer": 0.0004993523721966835, "env_step_timer": 1.3619627805470494e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11796660795662543, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 45400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005170937571674586, "num_episodes_lifetime": 180, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.876043401561182}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-49-17", "timestamp": 1754930957, "time_this_iter_s": 9.905761957168579, "time_total_s": 90.26998019218445, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 90.26998019218445, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.95714285714286, "ram_util_percent": 76.74285714285715}}
{"timers": {"training_iteration": 9.887314596628846, "restore_env_runners": 1.1331781083578396e-05, "training_step": 9.887147788787225, "env_runner_sampling_timer": 1.6019734274143735, "learner_update_timer": 8.07431190661241, "synch_weights": 0.0008753998921199029, "restore_eval_env_runners": 9.789344745183056e-06, "evaluation_iteration": 0.12747221279254534, "synch_eval_env_connectors": 0.00015594330164336162, "synch_env_connectors": 4.241455770667129e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.612224990647542e-06, "normalize_and_clip_actions": 8.119482166287453e-06, "listify_data_for_vector_env": 1.055245321126912e-05, "remove_single_ts_time_rank_from_batch": 1.1953825388203672e-05, "tensor_to_numpy": 1.5320383835162255e-05, "get_actions": 3.8644342611505435e-05}}, "connector_pipeline_timer": 0.00011797479451020821}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.027317884600373e-06, "add_observations_from_episodes_to_batch": 2.8375344223832562e-06, "numpy_to_tensor": 1.2384601318326995e-05, "add_states_from_episodes_to_batch": 2.7262769430475537e-06, "batch_individual_items": 1.2584884140663196e-05}}, "connector_pipeline_timer": 5.9639189773724014e-05}, "weights_seq_no": 9.0, "episode_return_mean": -1.9799999999999998, "env_reset_timer": 3.750556137076996e-05, "sample": 0.005615757970784588, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "time_between_sampling": 0.03414326030882127, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.3878113022065746e-05, "rlmodule_inference_timer": 3.15556716694902e-05, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0052696323702111835, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "num_episodes_lifetime": -246500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3265.8042462747253}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17288219176367337, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00868560480301109, "add_observations_from_episodes_to_batch": 0.0008371951192663531, "add_columns_from_episodes_to_train_batch": 0.04158816093877812, "add_time_dim_to_batch_and_zero_pad": 0.10357078102083159, "add_states_from_episodes_to_batch": 0.0035103175942003003, "batch_individual_items": 0.014496516898562632, "numpy_to_tensor": 6.115246593710212e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26338261365890503, "use_intrinsic_rewards": 1.0, "weights_seq_no": 60.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 359640, "vf_loss_unclipped": 39.7451057434082, "vf_explained_var": 0.0048743486404418945, "policy_loss": -4.72886094939895e-05, "module_train_batch_size_mean": 999.0, "entropy": 0.6797719597816467, "diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.20409612357616425, "mean_kl_loss": 2.4013354050111957e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1890000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 719280, "num_env_steps_trained_lifetime_throughput": 46445.22579341522}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 51.0, "weights_seq_no": 60.0, "num_module_steps_trained_lifetime": 359640, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 10.0, "num_module_steps_trained_lifetime": 59940, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 719.9781820415088}, "default_policy": {"entropy": 0.6797729730606079, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20382505655288696, "num_module_steps_trained_lifetime": 59940, "mean_kl_loss": 2.397834396106191e-05, "vf_loss": 0.26304060220718384, "use_intrinsic_rewards": 0.0, "weights_seq_no": 10.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.97130584716797, "vf_explained_var": -0.00027883052825927734, "num_trainable_parameters": 16595, "policy_loss": -4.803720730706118e-05, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.00015779680688865483, "num_module_steps_trained_lifetime_throughput": 719.9690340561909}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 119880, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3783.698449403628, "num_module_steps_trained_throughput": 25564456.909878727, "num_module_steps_trained_lifetime_throughput": 12839306.701454354}, "IntrinsicAttentionMask": [[[0.3468731939792633, 0.32641592621803284, 0.3267108201980591], [0.2699057459831238, 0.3658720850944519, 0.3642222583293915], [0.27096766233444214, 0.3653251826763153, 0.36370712518692017]], [[0.3334101438522339, 0.3332906663417816, 0.3332991898059845], [0.30056819319725037, 0.3516765832901001, 0.34775519371032715], [0.30285191535949707, 0.35038846731185913, 0.3467596173286438]], [[0.3280787467956543, 0.3360518515110016, 0.33586934208869934], [0.2947334051132202, 0.3533569276332855, 0.35190966725349426], [0.29546573758125305, 0.3529757857322693, 0.3515584170818329]], [[0.332863986492157, 0.3341047167778015, 0.3330312967300415], [0.3328503966331482, 0.3341270685195923, 0.3330225646495819], [0.33286213874816895, 0.33410772681236267, 0.3330301344394684]], [[0.33109524846076965, 0.3381241261959076, 0.33078068494796753], [0.31374847888946533, 0.37502557039260864, 0.3112259805202484], [0.3318561315536499, 0.33649614453315735, 0.33164769411087036]], [[0.3318730890750885, 0.33575141429901123, 0.33237552642822266], [0.32619234919548035, 0.3452008366584778, 0.32860687375068665], [0.3311353623867035, 0.3369746506214142, 0.33188989758491516]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2259941892650825e-05, "add_time_dim_to_batch_and_zero_pad": 6.726754576094092e-06, "add_observations_from_episodes_to_batch": 2.7563524478932407e-06, "numpy_to_tensor": 1.1782257303459955e-05, "add_states_from_episodes_to_batch": 2.7030842022410225e-06}}, "connector_pipeline_timer": 5.834689770564576e-05}, "agent_episode_returns_mean": {"default_agent": 1.0}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.0284060544213282e-05, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.862445534772107e-06, "listify_data_for_vector_env": 1.0253145982563697e-05, "get_actions": 3.549034805334587e-05, "remove_single_ts_time_rank_from_batch": 1.1762901909667393e-05, "un_batch_to_individual_items": 6.376771768561459e-06, "tensor_to_numpy": 1.4950906377678004e-05}}, "connector_pipeline_timer": 0.00011316170354676213}, "module_episode_returns_mean": {"default_policy": 1.0}, "weights_seq_no": 10.0, "episode_return_mean": 1.0, "env_reset_timer": 0.0004951880177685822, "env_step_timer": 1.3726308980738785e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11790107562714769, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 50400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005173028426943347, "num_episodes_lifetime": 200, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.876044142545679}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-49-27", "timestamp": 1754930967, "time_this_iter_s": 9.975153923034668, "time_total_s": 100.24513411521912, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 100.24513411521912, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 35.378571428571426, "ram_util_percent": 77.35000000000001}}
{"timers": {"training_iteration": 9.887469332752861, "restore_env_runners": 1.1284714068241102e-05, "training_step": 9.887302242149424, "env_runner_sampling_timer": 1.601208013139597, "learner_update_timer": 8.075096455047063, "synch_weights": 0.0008757833923448673, "restore_eval_env_runners": 9.762280707837169e-06, "evaluation_iteration": 0.12736591566396124, "synch_eval_env_connectors": 0.00015555553878252772, "synch_env_connectors": 4.2386212582283976e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.586092920994112e-06, "normalize_and_clip_actions": 8.07567457172947e-06, "listify_data_for_vector_env": 1.0510098581759563e-05, "remove_single_ts_time_rank_from_batch": 1.1829760212828492e-05, "tensor_to_numpy": 1.526481777104622e-05, "get_actions": 3.845075826267507e-05}}, "connector_pipeline_timer": 0.00011742094532180078}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.9377746814360134e-06, "add_observations_from_episodes_to_batch": 2.8105800118272736e-06, "numpy_to_tensor": 1.2468924346776374e-05, "add_states_from_episodes_to_batch": 2.7186972615261515e-06, "batch_individual_items": 1.237244760569331e-05}}, "connector_pipeline_timer": 5.936519382438052e-05}, "weights_seq_no": 10.0, "episode_return_mean": -2.1399999999999997, "env_reset_timer": 3.863736136249363e-05, "sample": 0.005599733880417809, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "time_between_sampling": 0.03430320704810789, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.381621495157997e-05, "rlmodule_inference_timer": 3.140599748198261e-05, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005248662331607191, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "num_episodes_lifetime": -277375.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3272.5455247280147}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17290841234589924, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008687304585278971, "add_observations_from_episodes_to_batch": 0.0008370485880979355, "add_columns_from_episodes_to_train_batch": 0.04156873723992805, "add_time_dim_to_batch_and_zero_pad": 0.10363406904102132, "add_states_from_episodes_to_batch": 0.0035128985876233905, "batch_individual_items": 0.014474942979958251, "numpy_to_tensor": 6.1198441045571e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26324763894081116, "use_intrinsic_rewards": 1.0, "weights_seq_no": 66.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 395604, "vf_loss_unclipped": 37.242008209228516, "vf_explained_var": 0.004899322986602783, "policy_loss": -0.0003292174369562417, "module_train_batch_size_mean": 999.0, "entropy": 0.6793047785758972, "diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.20370793342590332, "mean_kl_loss": 1.2709465408988763e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2079000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 791208, "num_env_steps_trained_lifetime_throughput": 45653.25296650647}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 56.0, "weights_seq_no": 66.0, "num_module_steps_trained_lifetime": 395604, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 11.0, "num_module_steps_trained_lifetime": 65934, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 717.9996766153803}, "default_policy": {"entropy": 0.6792616248130798, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20353372395038605, "num_module_steps_trained_lifetime": 65934, "mean_kl_loss": 1.4054518032935448e-05, "vf_loss": 0.2630463242530823, "use_intrinsic_rewards": 0.0, "weights_seq_no": 11.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.38197326660156, "vf_explained_var": -0.00010251998901367188, "num_trainable_parameters": 16595, "policy_loss": -0.00034459782182238996, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 7.889840344432741e-05, "num_module_steps_trained_lifetime_throughput": 717.9910173855727}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 131868, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3773.299781576629, "num_module_steps_trained_throughput": 24902611.718939785, "num_module_steps_trained_lifetime_throughput": 12829560.559519377}, "IntrinsicAttentionMask": [[[0.3376840054988861, 0.3310084939002991, 0.3313075602054596], [0.3291302025318146, 0.3355821669101715, 0.3352876305580139], [0.3295147120952606, 0.3353763222694397, 0.3351089656352997]], [[0.37295395135879517, 0.3153206706047058, 0.311725378036499], [0.33239254355430603, 0.3337570130825043, 0.3338504433631897], [0.3297021687030792, 0.33496755361557007, 0.3353303074836731]], [[0.33351442217826843, 0.333333283662796, 0.33315226435661316], [0.3334875702857971, 0.3333333134651184, 0.3331791162490845], [0.3334607183933258, 0.3333333134651184, 0.3332059681415558]], [[0.34495824575424194, 0.34404805302619934, 0.31099367141723633], [0.3444919288158417, 0.3436199724674225, 0.3118881285190582], [0.3261963427066803, 0.3267129957675934, 0.3470906615257263]], [[0.3546990752220154, 0.353241890668869, 0.292059063911438], [0.3542947471141815, 0.35286763310432434, 0.29283756017684937], [0.3350119888782501, 0.33490675687789917, 0.33008119463920593]], [[0.3439842760562897, 0.33277440071105957, 0.32324135303497314], [0.3269138038158417, 0.33356839418411255, 0.33951783180236816], [0.3122080862522125, 0.3338077962398529, 0.3539840877056122]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2420742806708024e-05, "add_time_dim_to_batch_and_zero_pad": 6.742277559083766e-06, "add_observations_from_episodes_to_batch": 2.770921019820646e-06, "numpy_to_tensor": 1.1941229275199715e-05, "add_states_from_episodes_to_batch": 2.7378479123576648e-06}}, "connector_pipeline_timer": 5.874098608379997e-05}, "agent_episode_returns_mean": {"default_agent": 1.2}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.036629111744428e-05, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.832349755131494e-06, "listify_data_for_vector_env": 1.0279932027988344e-05, "get_actions": 3.5748147363403385e-05, "remove_single_ts_time_rank_from_batch": 1.1883940344342277e-05, "un_batch_to_individual_items": 6.502297344418345e-06, "tensor_to_numpy": 1.5044636278736244e-05}}, "connector_pipeline_timer": 0.00011367774877752325}, "module_episode_returns_mean": {"default_policy": 1.2}, "weights_seq_no": 11.0, "episode_return_mean": 1.2, "env_reset_timer": 0.0004910190574057066, "env_step_timer": 1.382757064362203e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11784057987085632, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 55400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005125740496441722, "num_episodes_lifetime": 220, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.876518843619897}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-49-37", "timestamp": 1754930977, "time_this_iter_s": 10.023226976394653, "time_total_s": 110.26836109161377, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 110.26836109161377, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.142857142857146, "ram_util_percent": 76.81428571428572}}
{"timers": {"training_iteration": 9.888527164845195, "restore_env_runners": 1.1231867384428291e-05, "training_step": 9.888359856807453, "env_runner_sampling_timer": 1.6006619471678116, "learner_update_timer": 8.076604911747376, "synch_weights": 0.0008763605584893679, "restore_eval_env_runners": 9.731327791415864e-06, "evaluation_iteration": 0.1272686944268154, "synch_eval_env_connectors": 0.00015497040289100028, "synch_env_connectors": 4.239144569118303e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.6255400393387755e-06, "normalize_and_clip_actions": 8.204875239561646e-06, "listify_data_for_vector_env": 1.0605173693582992e-05, "remove_single_ts_time_rank_from_batch": 1.1957123464912408e-05, "tensor_to_numpy": 1.550778534282347e-05, "get_actions": 3.9201018575223966e-05}}, "connector_pipeline_timer": 0.00011904830512998289}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.992502923627811e-06, "add_observations_from_episodes_to_batch": 2.8549454504079322e-06, "numpy_to_tensor": 1.2673816523147222e-05, "add_states_from_episodes_to_batch": 2.73063404603214e-06, "batch_individual_items": 1.2507281599070677e-05}}, "connector_pipeline_timer": 5.987917685931596e-05}, "weights_seq_no": 11.0, "episode_return_mean": -1.9799999999999998, "env_reset_timer": 3.992028281535351e-05, "sample": 0.005628315513803791, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "time_between_sampling": 0.034530825465605125, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.403718328849939e-05, "rlmodule_inference_timer": 3.1719177348122345e-05, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005306643320247531, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "num_episodes_lifetime": -308250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3234.132885259015}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17289367531231387, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008688215700286064, "add_observations_from_episodes_to_batch": 0.000837016012038377, "add_columns_from_episodes_to_train_batch": 0.041567118197375255, "add_time_dim_to_batch_and_zero_pad": 0.1036324591806081, "add_states_from_episodes_to_batch": 0.003517512102268399, "batch_individual_items": 0.014457849800419439, "numpy_to_tensor": 6.143978676487282e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26326555013656616, "use_intrinsic_rewards": 1.0, "weights_seq_no": 72.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 431568, "vf_loss_unclipped": 39.775413513183594, "vf_explained_var": 0.004741251468658447, "policy_loss": -0.0004955788608640432, "module_train_batch_size_mean": 999.0, "entropy": 0.677735447883606, "diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.2035594880580902, "mean_kl_loss": 2.2407093638321385e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2268000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 863136, "num_env_steps_trained_lifetime_throughput": 44885.187115308065}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 61.0, "weights_seq_no": 72.0, "num_module_steps_trained_lifetime": 431568, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 715.9245979076757}, "default_policy": {"entropy": 0.6776788830757141, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2033649981021881, "num_module_steps_trained_lifetime": 71928, "mean_kl_loss": 2.4640774427098222e-05, "vf_loss": 0.26304981112480164, "use_intrinsic_rewards": 0.0, "weights_seq_no": 12.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 39.966651916503906, "vf_explained_var": 0.0005208849906921387, "num_trainable_parameters": 16595, "policy_loss": -0.0005184877081774175, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 3.944920172216371e-05, "num_module_steps_trained_lifetime_throughput": 715.9164292745413}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3762.393719878627, "num_module_steps_trained_throughput": 24276873.930765793, "num_module_steps_trained_lifetime_throughput": 12822700.773883667}, "IntrinsicAttentionMask": [[[0.3376840054988861, 0.3310084939002991, 0.3313075602054596], [0.3291302025318146, 0.3355821669101715, 0.3352876305580139], [0.3295147120952606, 0.3353763222694397, 0.3351089656352997]], [[0.33541449904441833, 0.3341980278491974, 0.33038753271102905], [0.3353683352470398, 0.33417895436286926, 0.33045268058776855], [0.3352227210998535, 0.3341188132762909, 0.3306584358215332]], [[0.35786062479019165, 0.321442574262619, 0.32069674134254456], [0.3189755380153656, 0.34027403593063354, 0.34075042605400085], [0.3181587755680084, 0.34066835045814514, 0.3411727845668793]], [[0.33313554525375366, 0.3336583375930786, 0.3332061171531677], [0.3331219553947449, 0.333680659532547, 0.33319738507270813], [0.333133727312088, 0.33366134762763977, 0.3332049548625946]], [[0.3547864854335785, 0.2933361232280731, 0.351877361536026], [0.33544206619262695, 0.3293805420398712, 0.33517736196517944], [0.3539705276489258, 0.29484823346138, 0.3511812388896942]], [[0.3309657871723175, 0.3393782079219818, 0.3296559751033783], [0.3280298709869385, 0.34681329131126404, 0.32515689730644226], [0.3314244747161865, 0.3382105529308319, 0.3303649127483368]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2277726166643523e-05, "add_time_dim_to_batch_and_zero_pad": 6.623257427311774e-06, "add_observations_from_episodes_to_batch": 2.7148831979149777e-06, "numpy_to_tensor": 1.1755534881632455e-05, "add_states_from_episodes_to_batch": 2.6786838423357896e-06}}, "connector_pipeline_timer": 5.780617665548483e-05}, "agent_episode_returns_mean": {"default_agent": 2.4}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 2.994150001980244e-05, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.829626281250473e-06, "listify_data_for_vector_env": 1.0203913485585514e-05, "get_actions": 3.505940383403084e-05, "remove_single_ts_time_rank_from_batch": 1.1779760767746399e-05, "un_batch_to_individual_items": 6.37343880175151e-06, "tensor_to_numpy": 1.4900087764795395e-05}}, "connector_pipeline_timer": 0.0001122742128105812}, "module_episode_returns_mean": {"default_policy": 2.4}, "weights_seq_no": 12.0, "episode_return_mean": 2.4, "env_reset_timer": 0.00048693594647048827, "env_step_timer": 1.363584400910444e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11777614490248584, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 60400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005124069614103064, "num_episodes_lifetime": 240, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.877927486854244}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-49-47", "timestamp": 1754930987, "time_this_iter_s": 10.112804174423218, "time_total_s": 120.38116526603699, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 120.38116526603699, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.5, "ram_util_percent": 77.11999999999999}}
{"timers": {"training_iteration": 9.886638150696301, "restore_env_runners": 1.1174128870069348e-05, "training_step": 9.88647057531904, "env_runner_sampling_timer": 1.5998588622762022, "learner_update_timer": 8.075433855540181, "synch_weights": 0.0008769102927376444, "restore_eval_env_runners": 9.701934704715194e-06, "evaluation_iteration": 0.12716330664211692, "synch_eval_env_connectors": 0.0001543265288095321, "synch_env_connectors": 4.239673124278275e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.598482707992064e-06, "normalize_and_clip_actions": 8.087951872897212e-06, "listify_data_for_vector_env": 1.0519007279957079e-05, "remove_single_ts_time_rank_from_batch": 1.1874577890633977e-05, "tensor_to_numpy": 1.518817756033494e-05, "get_actions": 3.822315597451083e-05}}, "connector_pipeline_timer": 0.000117256397812291}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.9086427540477355e-06, "add_observations_from_episodes_to_batch": 2.8109654738923995e-06, "numpy_to_tensor": 1.2506176116698663e-05, "add_states_from_episodes_to_batch": 2.7161623005554096e-06, "batch_individual_items": 1.2366322137539215e-05}}, "connector_pipeline_timer": 5.9390926731219e-05}, "weights_seq_no": 12.0, "episode_return_mean": -2.1399999999999997, "env_reset_timer": 3.999312013267102e-05, "sample": 0.005629997616859471, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "time_between_sampling": 0.03478718259435319, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.376170805043124e-05, "rlmodule_inference_timer": 3.1056245041294556e-05, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005232148970011623, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "num_episodes_lifetime": -339125.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3275.740050214118}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1728720827191403, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00868944312338465, "add_observations_from_episodes_to_batch": 0.0008372087622885219, "add_columns_from_episodes_to_train_batch": 0.04156543118511938, "add_time_dim_to_batch_and_zero_pad": 0.1036250729183478, "add_states_from_episodes_to_batch": 0.0035221994815165434, "batch_individual_items": 0.014439406722702273, "numpy_to_tensor": 6.151788893157127e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.2632023096084595, "use_intrinsic_rewards": 1.0, "weights_seq_no": 78.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 467532, "vf_loss_unclipped": 38.09038543701172, "vf_explained_var": 0.004742920398712158, "policy_loss": -0.00025461072800680995, "module_train_batch_size_mean": 999.0, "entropy": 0.6768051981925964, "diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.20375245809555054, "mean_kl_loss": 2.1358047888497822e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2457000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 935064, "num_env_steps_trained_lifetime_throughput": 44147.44477144507}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 66.0, "weights_seq_no": 78.0, "num_module_steps_trained_lifetime": 467532, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 13.0, "num_module_steps_trained_lifetime": 77922, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 714.1415821054568}, "default_policy": {"entropy": 0.6767757534980774, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20362727344036102, "num_module_steps_trained_lifetime": 77922, "mean_kl_loss": 2.2454776626545936e-05, "vf_loss": 0.26305410265922546, "use_intrinsic_rewards": 0.0, "weights_seq_no": 13.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 38.22439193725586, "vf_explained_var": 0.0007827877998352051, "num_trainable_parameters": 16595, "policy_loss": -0.00026094348868355155, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 1.9724600861081854e-05, "num_module_steps_trained_lifetime_throughput": 714.1339029668204}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 155844, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3753.02265357398, "num_module_steps_trained_throughput": 23682581.746718157, "num_module_steps_trained_lifetime_throughput": 12815617.894981502}, "IntrinsicAttentionMask": [[[0.3376840054988861, 0.3310084939002991, 0.3313075602054596], [0.3291302025318146, 0.3355821669101715, 0.3352876305580139], [0.3295147120952606, 0.3353763222694397, 0.3351089656352997]], [[0.3333694040775299, 0.3332499563694, 0.33338063955307007], [0.31691887974739075, 0.3708075284957886, 0.31227365136146545], [0.33485329151153564, 0.3298158049583435, 0.33533087372779846]], [[0.3550397753715515, 0.35355713963508606, 0.29140305519104004], [0.35463598370552063, 0.35318347811698914, 0.2921805679798126], [0.33537426590919495, 0.33524614572525024, 0.3293795585632324]], [[0.33366650342941284, 0.33278611302375793, 0.333547443151474], [0.33365291357040405, 0.33280837535858154, 0.3335387110710144], [0.3336646258831024, 0.3327890634536743, 0.3335462212562561]], [[0.3334917724132538, 0.3333333134651184, 0.3331749439239502], [0.33346492052078247, 0.3333333134651184, 0.3332017958164215], [0.33343806862831116, 0.3333333432674408, 0.3332286477088928]], [[0.3439842760562897, 0.33277440071105957, 0.32324135303497314], [0.3269138038158417, 0.33356842398643494, 0.33951786160469055], [0.3122080862522125, 0.3338078260421753, 0.3539840877056122]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.236359917144387e-05, "add_time_dim_to_batch_and_zero_pad": 6.774240263842512e-06, "add_observations_from_episodes_to_batch": 2.77444118764901e-06, "numpy_to_tensor": 1.1763089184509113e-05, "add_states_from_episodes_to_batch": 2.7465203671394747e-06}}, "connector_pipeline_timer": 5.851811009968437e-05}, "agent_episode_returns_mean": {"default_agent": 1.0}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.0270979956356686e-05, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.822401838832917e-06, "listify_data_for_vector_env": 1.0226094110396739e-05, "get_actions": 3.5207545155080505e-05, "remove_single_ts_time_rank_from_batch": 1.1733030543358283e-05, "un_batch_to_individual_items": 6.4622959859472955e-06, "tensor_to_numpy": 1.4944724477903573e-05}}, "connector_pipeline_timer": 0.00011267033998668062}, "module_episode_returns_mean": {"default_policy": 1.0}, "weights_seq_no": 13.0, "episode_return_mean": 1.0, "env_reset_timer": 0.0004828436674280507, "env_step_timer": 1.380325594193199e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11771599178297502, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 65400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005129302892601118, "num_episodes_lifetime": 260, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.876354666985678}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-49-57", "timestamp": 1754930997, "time_this_iter_s": 9.812714099884033, "time_total_s": 130.19387936592102, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 130.19387936592102, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.371428571428574, "ram_util_percent": 77.0142857142857}}
{"timers": {"training_iteration": 9.885830302529564, "restore_env_runners": 1.1122807133396834e-05, "training_step": 9.885662199145408, "env_runner_sampling_timer": 1.5998994336533676, "learner_update_timer": 8.074506765734569, "synch_weights": 0.0008760557692837038, "restore_eval_env_runners": 9.683665666271091e-06, "evaluation_iteration": 0.1270613069160191, "synch_eval_env_connectors": 0.000153963683452625, "synch_env_connectors": 4.245616691270908e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.5611476483534065e-06, "normalize_and_clip_actions": 7.998597040318125e-06, "listify_data_for_vector_env": 1.0536887813231762e-05, "remove_single_ts_time_rank_from_batch": 1.180535868734749e-05, "tensor_to_numpy": 1.5156060218557304e-05, "get_actions": 3.8058096064432336e-05}}, "connector_pipeline_timer": 0.00011678000941915705}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.8727239239695215e-06, "add_observations_from_episodes_to_batch": 2.810807778566519e-06, "numpy_to_tensor": 1.2323464352292319e-05, "add_states_from_episodes_to_batch": 2.705413856262963e-06, "batch_individual_items": 1.2334352643673801e-05}}, "connector_pipeline_timer": 5.9085550341393206e-05}, "weights_seq_no": 13.0, "episode_return_mean": -2.0599999999999996, "env_reset_timer": 3.83052983420891e-05, "sample": 0.005852340151851543, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "time_between_sampling": 0.03382302241520921, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.3714067287596721e-05, "rlmodule_inference_timer": 5.036912574556618e-05, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005564432641025634, "module_episode_returns_mean": {"default_policy": -2.0599999999999996}, "num_episodes_lifetime": -370000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.0599999999999996}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3274.277786241231}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17284698314229333, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00868975119200425, "add_observations_from_episodes_to_batch": 0.0008372141738455512, "add_columns_from_episodes_to_train_batch": 0.04156198270232044, "add_time_dim_to_batch_and_zero_pad": 0.1036160676094284, "add_states_from_episodes_to_batch": 0.00352525498770892, "batch_individual_items": 0.014423338485921805, "numpy_to_tensor": 6.177312994125728e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26315146684646606, "use_intrinsic_rewards": 1.0, "weights_seq_no": 84.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 503496, "vf_loss_unclipped": 35.96785354614258, "vf_explained_var": 0.004796266555786133, "policy_loss": -0.0003701239184010774, "module_train_batch_size_mean": 999.0, "entropy": 0.6759741902351379, "diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.20359843969345093, "mean_kl_loss": 2.0205061446176842e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2646000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1006992, "num_env_steps_trained_lifetime_throughput": 43442.39386892246}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 71.0, "weights_seq_no": 84.0, "num_module_steps_trained_lifetime": 503496, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 14.0, "num_module_steps_trained_lifetime": 83916, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 712.5398528168596}, "default_policy": {"entropy": 0.6759320497512817, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20350311696529388, "num_module_steps_trained_lifetime": 83916, "mean_kl_loss": 2.169517938455101e-05, "vf_loss": 0.2630493938922882, "use_intrinsic_rewards": 0.0, "weights_seq_no": 14.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 36.062156677246094, "vf_explained_var": 0.0005414485931396484, "num_trainable_parameters": 16595, "policy_loss": -0.0003827335312962532, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 9.862300430540927e-06, "num_module_steps_trained_lifetime_throughput": 712.532641863976}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 167832, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3744.6043137099996, "num_module_steps_trained_throughput": 23115399.902429212, "num_module_steps_trained_lifetime_throughput": 12807564.079497404}, "IntrinsicAttentionMask": [[[0.3468731939792633, 0.32641592621803284, 0.3267108201980591], [0.2699057459831238, 0.3658720850944519, 0.3642222583293915], [0.27096766233444214, 0.3653251826763153, 0.36370712518692017]], [[0.3414744734764099, 0.3143870234489441, 0.344138503074646], [0.3256683349609375, 0.3509441316127777, 0.3233874440193176], [0.3428938090801239, 0.3110560178756714, 0.3460501432418823]], [[0.3307735323905945, 0.33881211280822754, 0.3304143249988556], [0.3134079873561859, 0.3757459819316864, 0.3108460009098053], [0.33153533935546875, 0.33718255162239075, 0.3312820792198181]], [[0.34495824575424194, 0.34404805302619934, 0.3109937012195587], [0.3444919288158417, 0.3436199724674225, 0.3118881285190582], [0.3261963427066803, 0.3267129957675934, 0.3470906615257263]], [[0.33976051211357117, 0.34023189544677734, 0.3200075924396515], [0.3401293456554413, 0.3406286835670471, 0.3192419707775116], [0.32335418462753296, 0.3226778507232666, 0.3539679944515228]], [[0.3439842760562897, 0.33277440071105957, 0.32324135303497314], [0.3269138038158417, 0.33356842398643494, 0.33951786160469055], [0.3122080862522125, 0.3338078260421753, 0.3539840877056122]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2278475762458103e-05, "add_time_dim_to_batch_and_zero_pad": 6.729296077310899e-06, "add_observations_from_episodes_to_batch": 2.7576676284078516e-06, "numpy_to_tensor": 1.1808304564345414e-05, "add_states_from_episodes_to_batch": 2.7038078303934e-06}}, "connector_pipeline_timer": 5.830326485701098e-05}, "agent_episode_returns_mean": {"default_agent": 1.2}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.0194360503260517e-05, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.840825978033326e-06, "listify_data_for_vector_env": 1.027691926036995e-05, "get_actions": 3.5242571655232813e-05, "remove_single_ts_time_rank_from_batch": 1.1741768009387274e-05, "un_batch_to_individual_items": 6.428959756569596e-06, "tensor_to_numpy": 1.5038946528067646e-05}}, "connector_pipeline_timer": 0.00011311371635739155}, "module_episode_returns_mean": {"default_policy": 1.2}, "weights_seq_no": 14.0, "episode_return_mean": 1.2, "env_reset_timer": 0.00047886523024117024, "env_step_timer": 1.3745863794945454e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11766685478501991, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 70400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005145937466295436, "num_episodes_lifetime": 280, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.87585892531589}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-50-07", "timestamp": 1754931007, "time_this_iter_s": 9.907871961593628, "time_total_s": 140.10175132751465, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 140.10175132751465, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 32.91428571428572, "ram_util_percent": 76.8142857142857}}
{"timers": {"training_iteration": 9.885007653673776, "restore_env_runners": 1.1118659039232498e-05, "training_step": 9.884839105484224, "env_runner_sampling_timer": 1.5998981447356833, "learner_update_timer": 8.073610484737227, "synch_weights": 0.0008768860413134501, "restore_eval_env_runners": 9.66057928013896e-06, "evaluation_iteration": 0.12697229592674586, "synch_eval_env_connectors": 0.00015344987631512656, "synch_env_connectors": 4.240250445892261e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.511906671286018e-06, "normalize_and_clip_actions": 8.012667642314752e-06, "listify_data_for_vector_env": 1.0378703682350082e-05, "remove_single_ts_time_rank_from_batch": 1.1777218410936353e-05, "tensor_to_numpy": 1.516138941801461e-05, "get_actions": 3.7825571420267336e-05}}, "connector_pipeline_timer": 0.00011625412808769437}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.860970908317594e-06, "add_observations_from_episodes_to_batch": 2.803225204457965e-06, "numpy_to_tensor": 1.2307810325582955e-05, "add_states_from_episodes_to_batch": 2.688436147993481e-06, "batch_individual_items": 1.2251067808396634e-05}}, "connector_pipeline_timer": 5.89066793217455e-05}, "weights_seq_no": 14.0, "episode_return_mean": -1.9, "env_reset_timer": 3.785428433377095e-05, "sample": 0.005732057481923796, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "time_between_sampling": 0.03383064547061185, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.3642815445315416e-05, "rlmodule_inference_timer": 4.745876621582526e-05, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0055520595372654516, "module_episode_returns_mean": {"default_policy": -1.9}, "num_episodes_lifetime": -400875.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.9}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3292.9108347855918}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17281997665072069, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008690402849632064, "add_observations_from_episodes_to_batch": 0.0008377228622441548, "add_columns_from_episodes_to_train_batch": 0.04156314495572591, "add_time_dim_to_batch_and_zero_pad": 0.10360005943230206, "add_states_from_episodes_to_batch": 0.003527149516960603, "batch_individual_items": 0.01440686010178425, "numpy_to_tensor": 6.331914852852137e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26310935616493225, "use_intrinsic_rewards": 1.0, "weights_seq_no": 90.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 539460, "vf_loss_unclipped": 37.651493072509766, "vf_explained_var": 0.004653751850128174, "policy_loss": -0.00018425469170324504, "module_train_batch_size_mean": 999.0, "entropy": 0.6748972535133362, "diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.2037511020898819, "mean_kl_loss": 7.254117917909753e-06}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2835000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1078920, "num_env_steps_trained_lifetime_throughput": 42770.46371970193}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 76.0, "weights_seq_no": 90.0, "num_module_steps_trained_lifetime": 539460, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 15.0, "num_module_steps_trained_lifetime": 89910, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 711.0639401650758}, "default_policy": {"entropy": 0.6748557686805725, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2036963254213333, "num_module_steps_trained_lifetime": 89910, "mean_kl_loss": 8.100701961666346e-06, "vf_loss": 0.2630530595779419, "use_intrinsic_rewards": 0.0, "weights_seq_no": 15.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 37.80242156982422, "vf_explained_var": -0.0002619028091430664, "num_trainable_parameters": 16595, "policy_loss": -0.00019406419596634805, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 4.931150215270463e-06, "num_module_steps_trained_lifetime_throughput": 711.0571600619347}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 179820, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3736.847087066096, "num_module_steps_trained_throughput": 22577749.31634071, "num_module_steps_trained_lifetime_throughput": 12798250.895555677}, "IntrinsicAttentionMask": [[[0.34774166345596313, 0.3064160645008087, 0.3458423614501953], [0.3280341327190399, 0.3432857394218445, 0.3286800980567932], [0.34690871834754944, 0.30796611309051514, 0.3451251685619354]], [[0.3333694040775299, 0.3332499563694, 0.33338063955307007], [0.31691887974739075, 0.3708075284957886, 0.31227365136146545], [0.33485329151153564, 0.3298158049583435, 0.33533087372779846]], [[0.37807682156562805, 0.31161224842071533, 0.3103109896183014], [0.3381521701812744, 0.3310004472732544, 0.3308473229408264], [0.33731070160865784, 0.33140799403190613, 0.3312813639640808]], [[0.36590978503227234, 0.3175552189350128, 0.31653499603271484], [0.33007127046585083, 0.334909051656723, 0.33501970767974854], [0.32927820086479187, 0.3352919816970825, 0.3354297876358032]], [[0.33287131786346436, 0.3333331346511841, 0.33379560708999634], [0.33284443616867065, 0.3333331048488617, 0.33382245898246765], [0.33281761407852173, 0.3333330750465393, 0.33384934067726135]], [[0.3318730890750885, 0.33575141429901123, 0.33237552642822266], [0.32619237899780273, 0.345200777053833, 0.32860687375068665], [0.3311353921890259, 0.3369746506214142, 0.33188992738723755]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.23732237417299e-05, "add_time_dim_to_batch_and_zero_pad": 6.779243019150813e-06, "add_observations_from_episodes_to_batch": 2.7404620656604784e-06, "numpy_to_tensor": 1.1829638441644915e-05, "add_states_from_episodes_to_batch": 2.7501291100697096e-06}}, "connector_pipeline_timer": 5.8426535547501934e-05}, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.048958157185886e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.866151225694199e-06, "listify_data_for_vector_env": 1.0267072552656269e-05, "get_actions": 3.577298394674715e-05, "remove_single_ts_time_rank_from_batch": 1.1771731542087838e-05, "un_batch_to_individual_items": 6.4869982025890826e-06, "tensor_to_numpy": 1.4947649758523081e-05}}, "connector_pipeline_timer": 0.00011356112040949239}, "module_episode_returns_mean": {"default_policy": 0.8}, "weights_seq_no": 15.0, "episode_return_mean": 0.8, "env_reset_timer": 0.0004748686584752432, "env_step_timer": 1.3806894007023916e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.1176131595679543, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 75400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005151650349143892, "num_episodes_lifetime": 300, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.875345745643145}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-50-17", "timestamp": 1754931017, "time_this_iter_s": 9.913946866989136, "time_total_s": 150.01569819450378, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 150.01569819450378, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.82857142857143, "ram_util_percent": 76.75}}
{"timers": {"training_iteration": 9.884332710056606, "restore_env_runners": 1.1062472867637308e-05, "training_step": 9.88416391234935, "env_runner_sampling_timer": 1.5990203995385965, "learner_update_timer": 8.073735846549553, "synch_weights": 0.0008757688515033971, "restore_eval_env_runners": 9.631883201172094e-06, "evaluation_iteration": 0.12687814296767427, "synch_eval_env_connectors": 0.00015308037827378753, "synch_env_connectors": 4.234098508497027e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.528315232123802e-06, "normalize_and_clip_actions": 8.04229466480514e-06, "listify_data_for_vector_env": 1.0391492742022576e-05, "remove_single_ts_time_rank_from_batch": 1.1745879135427583e-05, "tensor_to_numpy": 1.5184074955142517e-05, "get_actions": 3.797974449525428e-05}}, "connector_pipeline_timer": 0.0001165439714547599}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.865700689495826e-06, "add_observations_from_episodes_to_batch": 2.80355555847496e-06, "numpy_to_tensor": 1.24077662286753e-05, "add_states_from_episodes_to_batch": 2.6803729211527655e-06, "batch_individual_items": 1.2280986756493233e-05}}, "connector_pipeline_timer": 5.9018179873191994e-05}, "weights_seq_no": 15.0, "episode_return_mean": -1.0999999999999996, "env_reset_timer": 3.7847260221739466e-05, "sample": 0.0057827703130008444, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "time_between_sampling": 0.03383991743476871, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.3682458055852407e-05, "rlmodule_inference_timer": 3.099055753059553e-05, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005200542008038613, "module_episode_returns_mean": {"default_policy": -1.0999999999999996}, "num_episodes_lifetime": -431750.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.0999999999999996}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3294.787229570958}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17278887480432767, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008688132151251792, "add_observations_from_episodes_to_batch": 0.0008376339737991002, "add_columns_from_episodes_to_train_batch": 0.04155031725664452, "add_time_dim_to_batch_and_zero_pad": 0.10359390049803531, "add_states_from_episodes_to_batch": 0.0035301121813742227, "batch_individual_items": 0.014394312751353364, "numpy_to_tensor": 6.33888680998143e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.263122022151947, "use_intrinsic_rewards": 1.0, "weights_seq_no": 96.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 575424, "vf_loss_unclipped": 34.66829299926758, "vf_explained_var": 0.0047917962074279785, "policy_loss": -0.0003107754746451974, "module_train_batch_size_mean": 999.0, "entropy": 0.6744779944419861, "diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.20363590121269226, "mean_kl_loss": 1.2398752915032674e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3024000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1150848, "num_env_steps_trained_lifetime_throughput": 42127.444213484036}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 81.0, "weights_seq_no": 96.0, "num_module_steps_trained_lifetime": 575424, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 16.0, "num_module_steps_trained_lifetime": 95904, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 709.5724206831999}, "default_policy": {"entropy": 0.674420952796936, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20355622470378876, "num_module_steps_trained_lifetime": 95904, "mean_kl_loss": 1.3930070963397156e-05, "vf_loss": 0.2630451023578644, "use_intrinsic_rewards": 0.0, "weights_seq_no": 16.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 34.75494384765625, "vf_explained_var": -5.2928924560546875e-05, "num_trainable_parameters": 16595, "policy_loss": -0.00032862654188647866, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 2.4655751076352317e-06, "num_module_steps_trained_lifetime_throughput": 709.5660398022094}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 191808, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3729.0078313913114, "num_module_steps_trained_throughput": 22059390.967666272, "num_module_steps_trained_lifetime_throughput": 12781561.046896758}, "IntrinsicAttentionMask": [[[0.34774166345596313, 0.3064160645008087, 0.3458423614501953], [0.3280341327190399, 0.3432857394218445, 0.3286800980567932], [0.34690871834754944, 0.30796611309051514, 0.3451251685619354]], [[0.3415305018424988, 0.34216970205307007, 0.3162997364997864], [0.3418780565261841, 0.3425455093383789, 0.3155764043331146], [0.3268708884716034, 0.32640156149864197, 0.34672749042510986]], [[0.35786062479019165, 0.321442574262619, 0.32069674134254456], [0.3189755380153656, 0.34027403593063354, 0.34075042605400085], [0.3181587755680084, 0.34066835045814514, 0.3411727845668793]], [[0.34495824575424194, 0.34404805302619934, 0.31099367141723633], [0.3444919288158417, 0.3436199724674225, 0.3118881285190582], [0.3261963427066803, 0.326712965965271, 0.3470906615257263]], [[0.33109524846076965, 0.3381241261959076, 0.33078068494796753], [0.31374844908714294, 0.37502557039260864, 0.3112259805202484], [0.3318561315536499, 0.33649617433547974, 0.33164769411087036]], [[0.33681720495224, 0.33326685428619385, 0.32991594076156616], [0.3245609700679779, 0.33339524269104004, 0.34204384684562683], [0.3130285143852234, 0.333240807056427, 0.35373061895370483]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.238424654879834e-05, "add_time_dim_to_batch_and_zero_pad": 6.739846895878527e-06, "add_observations_from_episodes_to_batch": 2.759324239545864e-06, "numpy_to_tensor": 1.1903592898102431e-05, "add_states_from_episodes_to_batch": 2.7193928509286364e-06}}, "connector_pipeline_timer": 5.870818182444342e-05}, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.0002086544833476e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.831254112455114e-06, "listify_data_for_vector_env": 1.0209202963904725e-05, "get_actions": 3.542449914714639e-05, "remove_single_ts_time_rank_from_batch": 1.1842803788906012e-05, "un_batch_to_individual_items": 6.5535517535179395e-06, "tensor_to_numpy": 1.513235829880991e-05}}, "connector_pipeline_timer": 0.00011353098154242703}, "module_episode_returns_mean": {"default_policy": 0.8}, "weights_seq_no": 16.0, "episode_return_mean": 0.8, "env_reset_timer": 0.0004710078808632906, "env_step_timer": 1.3795503312790174e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11755615839254048, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 80400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.0051508491218555715, "num_episodes_lifetime": 320, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.87497934776655}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-50-27", "timestamp": 1754931027, "time_this_iter_s": 9.931956052780151, "time_total_s": 159.94765424728394, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 159.94765424728394, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 33.48571428571429, "ram_util_percent": 76.83571428571429}}
{"timers": {"training_iteration": 9.909552282545812, "restore_env_runners": 1.1016428374591209e-05, "training_step": 9.909382786135057, "env_runner_sampling_timer": 1.5993186155423926, "learner_update_timer": 8.098581884754466, "synch_weights": 0.0008810186619642062, "restore_eval_env_runners": 9.604314601618487e-06, "evaluation_iteration": 0.12677836070818355, "synch_eval_env_connectors": 0.00015249541405629695, "synch_env_connectors": 4.233008128548212e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.913903188714602e-06, "normalize_and_clip_actions": 8.440868201259343e-06, "listify_data_for_vector_env": 1.0967402842966476e-05, "remove_single_ts_time_rank_from_batch": 1.2293481068952639e-05, "tensor_to_numpy": 1.615232363023985e-05, "get_actions": 4.217266386934497e-05}}, "connector_pipeline_timer": 0.00012490321301942861}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.452248363088597e-06, "add_observations_from_episodes_to_batch": 2.9780248390274846e-06, "numpy_to_tensor": 1.3375827184614247e-05, "add_states_from_episodes_to_batch": 2.874558600917449e-06, "batch_individual_items": 1.3176663302548611e-05}}, "connector_pipeline_timer": 6.295794646237111e-05}, "weights_seq_no": 16.0, "episode_return_mean": -2.1399999999999997, "env_reset_timer": 4.149348636125641e-05, "sample": 0.00582479170401542, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "time_between_sampling": 0.034228631721119396, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.499727656763501e-05, "rlmodule_inference_timer": 3.384549200203308e-05, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005595812667161228, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "num_episodes_lifetime": -462625.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3144.178812197892}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17275282063713612, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008688906250387207, "add_observations_from_episodes_to_batch": 0.0008375359636849722, "add_columns_from_episodes_to_train_batch": 0.041542886583636404, "add_time_dim_to_batch_and_zero_pad": 0.10357885399300101, "add_states_from_episodes_to_batch": 0.0035326256396973903, "batch_individual_items": 0.01437779503415895, "numpy_to_tensor": 6.340080855064293e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.26308128237724304, "use_intrinsic_rewards": 1.0, "weights_seq_no": 102.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 611388, "vf_loss_unclipped": 36.3745002746582, "vf_explained_var": 0.004605650901794434, "policy_loss": -0.0004627636808436364, "module_train_batch_size_mean": 999.0, "entropy": 0.6727564334869385, "diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.20345650613307953, "mean_kl_loss": 2.2683845600113273e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3213000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1222776, "num_env_steps_trained_lifetime_throughput": 41472.399321988465}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 86.0, "weights_seq_no": 102.0, "num_module_steps_trained_lifetime": 611388, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 17.0, "num_module_steps_trained_lifetime": 101898, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 705.9181046601698}, "default_policy": {"entropy": 0.67270427942276, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20340700447559357, "num_module_steps_trained_lifetime": 101898, "mean_kl_loss": 2.447852966724895e-05, "vf_loss": 0.2630445063114166, "use_intrinsic_rewards": 0.0, "weights_seq_no": 17.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 36.48598098754883, "vf_explained_var": 0.00022935867309570312, "num_trainable_parameters": 16595, "policy_loss": -0.00048001407412812114, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 1.2327875538176158e-06, "num_module_steps_trained_lifetime_throughput": 705.9120399351983}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 203796, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3709.8021149367837, "num_module_steps_trained_throughput": 21503885.115303397, "num_module_steps_trained_lifetime_throughput": 12708833.630487606}, "IntrinsicAttentionMask": [[[0.3468731939792633, 0.32641592621803284, 0.32671085000038147], [0.2699057459831238, 0.3658720850944519, 0.3642222583293915], [0.27096766233444214, 0.3653251826763153, 0.36370712518692017]], [[0.3322620093822479, 0.3328838348388672, 0.3348541557788849], [0.332215815782547, 0.3328644037246704, 0.3349197506904602], [0.33207014203071594, 0.33280304074287415, 0.3351268470287323]], [[0.35786062479019165, 0.321442574262619, 0.32069674134254456], [0.3189755380153656, 0.34027403593063354, 0.34075042605400085], [0.3181587755680084, 0.34066835045814514, 0.3411727845668793]], [[0.34857895970344543, 0.3498782813549042, 0.3015427589416504], [0.34900644421577454, 0.35034507513046265, 0.3006485104560852], [0.3313225507736206, 0.3311651945114136, 0.3375123143196106]], [[0.3546990752220154, 0.353241890668869, 0.292059063911438], [0.3542947769165039, 0.35286766290664673, 0.29283758997917175], [0.3350119888782501, 0.33490675687789917, 0.33008119463920593]], [[0.34263110160827637, 0.3180438280105591, 0.3393250107765198], [0.3370227515697479, 0.3272441029548645, 0.3357331454753876], [0.3419032096862793, 0.31923407316207886, 0.33886271715164185]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3597102606994956e-05, "add_time_dim_to_batch_and_zero_pad": 7.340495011791145e-06, "add_observations_from_episodes_to_batch": 2.954822176310288e-06, "numpy_to_tensor": 1.3207866017702055e-05, "add_states_from_episodes_to_batch": 2.8474184772764856e-06}}, "connector_pipeline_timer": 6.296048865597313e-05}, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.41088065113364e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.216376601974965e-06, "listify_data_for_vector_env": 1.144442440973891e-05, "get_actions": 3.9923307340880295e-05, "remove_single_ts_time_rank_from_batch": 1.2278135589763645e-05, "un_batch_to_individual_items": 6.820400342164388e-06, "tensor_to_numpy": 1.607634672703449e-05}}, "connector_pipeline_timer": 0.0001223233398542941}, "module_episode_returns_mean": {"default_policy": 0.6}, "weights_seq_no": 17.0, "episode_return_mean": 0.6, "env_reset_timer": 0.0004713657219012818, "env_step_timer": 1.6322256077673146e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11764381305825984, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 85400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005263499591965228, "num_episodes_lifetime": 340, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.900550010949237}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-50-39", "timestamp": 1754931039, "time_this_iter_s": 12.544004917144775, "time_total_s": 172.4916591644287, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 172.4916591644287, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 51.15, "ram_util_percent": 79.35000000000001}}
{"timers": {"training_iteration": 9.929100953469996, "restore_env_runners": 1.0972103940257737e-05, "training_step": 9.928930529933533, "env_runner_sampling_timer": 1.6015087598066748, "learner_update_timer": 8.115470553827121, "synch_weights": 0.0008908809760815755, "restore_eval_env_runners": 9.655770832510247e-06, "evaluation_iteration": 0.12688813210030048, "synch_eval_env_connectors": 0.00015357796056199733, "synch_env_connectors": 4.247768121086659e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.345951335231787e-06, "normalize_and_clip_actions": 9.142693680300894e-06, "listify_data_for_vector_env": 1.2011484552109104e-05, "remove_single_ts_time_rank_from_batch": 1.3156685121296037e-05, "tensor_to_numpy": 1.8088431594826677e-05, "get_actions": 4.766537856859551e-05}}, "connector_pipeline_timer": 0.00013725255567083395}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.995045648393857e-06, "add_observations_from_episodes_to_batch": 3.2184550237440716e-06, "numpy_to_tensor": 1.4837054342383912e-05, "add_states_from_episodes_to_batch": 3.0416093530146865e-06, "batch_individual_items": 1.4052786403123615e-05}}, "connector_pipeline_timer": 6.719532097065889e-05}, "weights_seq_no": 17.0, "episode_return_mean": -1.4199999999999995, "env_reset_timer": 5.5618068072901206e-05, "sample": 0.006355465788727732, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "time_between_sampling": 0.043546512024414924, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.645718839138005e-05, "rlmodule_inference_timer": 3.798126717756185e-05, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006160019844770432, "module_episode_returns_mean": {"default_policy": -1.4199999999999995}, "num_episodes_lifetime": -493500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.4199999999999995}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2868.184614421968}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17295672618061558, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008693479267318923, "add_observations_from_episodes_to_batch": 0.0008379335241667673, "add_columns_from_episodes_to_train_batch": 0.04168275771792372, "add_time_dim_to_batch_and_zero_pad": 0.10363865712367169, "add_states_from_episodes_to_batch": 0.003537739792511858, "batch_individual_items": 0.0143702858338833, "numpy_to_tensor": 6.474764092646512e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.2630816102027893, "use_intrinsic_rewards": 1.0, "weights_seq_no": 108.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 647352, "vf_loss_unclipped": 36.8021354675293, "vf_explained_var": 0.004523098468780518, "policy_loss": -0.00027305822004564106, "module_train_batch_size_mean": 999.0, "entropy": 0.6713664531707764, "diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.20364800095558167, "mean_kl_loss": 1.899223389045801e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3402000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1294704, "num_env_steps_trained_lifetime_throughput": 40790.83276878124}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 91.0, "weights_seq_no": 108.0, "num_module_steps_trained_lifetime": 647352, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107892, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 701.9953506031535}, "default_policy": {"entropy": 0.6713283061981201, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2036069929599762, "num_module_steps_trained_lifetime": 107892, "mean_kl_loss": 2.0150584532530047e-05, "vf_loss": 0.26304376125335693, "use_intrinsic_rewards": 0.0, "weights_seq_no": 18.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 36.914669036865234, "vf_explained_var": 0.0003508925437927246, "num_trainable_parameters": 16595, "policy_loss": -0.00028156282496638596, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 6.163937769088079e-07, "num_module_steps_trained_lifetime_throughput": 701.9896846840543}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3689.1863413822116, "num_module_steps_trained_throughput": 20950244.575575985, "num_module_steps_trained_lifetime_throughput": 12618772.208611676}, "IntrinsicAttentionMask": [[[0.3376840054988861, 0.3310084939002991, 0.3313075602054596], [0.3291302025318146, 0.3355821669101715, 0.3352876305580139], [0.3295147120952606, 0.3353763222694397, 0.3351089656352997]], [[0.3333694040775299, 0.3333721160888672, 0.3332585096359253], [0.3337275981903076, 0.3337571918964386, 0.33251523971557617], [0.3183002769947052, 0.3172520697116852, 0.3644476532936096]], [[0.3455628454685211, 0.34476104378700256, 0.3096761107444763], [0.3451460599899292, 0.34437295794487, 0.3104809820652008], [0.3253285586833954, 0.3258102536201477, 0.3488611876964569]], [[0.3333950638771057, 0.3332318663597107, 0.3333730101585388], [0.3333815038204193, 0.3332541882991791, 0.3333643078804016], [0.33339324593544006, 0.33323487639427185, 0.3333718478679657]], [[0.33470651507377625, 0.33333146572113037, 0.33196204900741577], [0.33467960357666016, 0.33333149552345276, 0.3319888412952423], [0.33465272188186646, 0.3333315849304199, 0.33201566338539124]], [[0.37537920475006104, 0.3021998405456543, 0.32242095470428467], [0.30285128951072693, 0.357158899307251, 0.33998987078666687], [0.32377469539642334, 0.3406830132007599, 0.3355422914028168]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.248444072555673e-05, "add_time_dim_to_batch_and_zero_pad": 6.994769752436436e-06, "add_observations_from_episodes_to_batch": 2.8716349414294632e-06, "numpy_to_tensor": 1.2232118271218822e-05, "add_states_from_episodes_to_batch": 2.7663572038461683e-06}}, "connector_pipeline_timer": 5.970415896313855e-05}, "agent_episode_returns_mean": {"default_agent": 1.0}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.168698839863624e-05, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.03523769814522e-06, "listify_data_for_vector_env": 1.1202646901309276e-05, "get_actions": 3.661659731193546e-05, "remove_single_ts_time_rank_from_batch": 1.1926408505187055e-05, "un_batch_to_individual_items": 6.564974570652034e-06, "tensor_to_numpy": 1.545922199753423e-05}}, "connector_pipeline_timer": 0.00011660928054704396}, "module_episode_returns_mean": {"default_policy": 1.0}, "weights_seq_no": 18.0, "episode_return_mean": 1.0, "env_reset_timer": 0.00047044581417488447, "env_step_timer": 1.4370336497832744e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11763683617705109, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 90400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005296340421773493, "num_episodes_lifetime": 360, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.920562616259565}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-50-51", "timestamp": 1754931051, "time_this_iter_s": 11.993060827255249, "time_total_s": 184.48471999168396, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 184.48471999168396, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 51.49411764705882, "ram_util_percent": 81.44705882352942}}
{"timers": {"training_iteration": 9.933207662684772, "restore_env_runners": 1.0942383510014628e-05, "training_step": 9.933036654635163, "env_runner_sampling_timer": 1.603159208458596, "learner_update_timer": 8.11784019953923, "synch_weights": 0.0008897700766869671, "restore_eval_env_runners": 1.0042553242265522e-05, "evaluation_iteration": 0.12688622660937374, "synch_eval_env_connectors": 0.00015406468180477494, "synch_env_connectors": 4.2569602163154585e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.912553692388112e-06, "normalize_and_clip_actions": 8.511028231134473e-06, "listify_data_for_vector_env": 1.1110847274177039e-05, "remove_single_ts_time_rank_from_batch": 1.2390489360650792e-05, "tensor_to_numpy": 1.6147624149930554e-05, "get_actions": 4.209838844840277e-05}}, "connector_pipeline_timer": 0.00012499470081041414}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.375110527720764e-06, "add_observations_from_episodes_to_batch": 2.9840263536362364e-06, "numpy_to_tensor": 1.3284535521426291e-05, "add_states_from_episodes_to_batch": 2.832028087267697e-06, "batch_individual_items": 1.3081501617222193e-05}}, "connector_pipeline_timer": 6.245886330662312e-05}, "weights_seq_no": 18.0, "episode_return_mean": -0.7800000000000001, "env_reset_timer": 5.51469664079976e-05, "sample": 0.0067394493769128054, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "time_between_sampling": 0.041535562246681645, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.4877286529857966e-05, "rlmodule_inference_timer": 6.603415678908917e-05, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006105529515538364, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "num_episodes_lifetime": -524375.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3038.4300854307066}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17294561766862898, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008695933644234419, "add_observations_from_episodes_to_batch": 0.0008381662684709552, "add_columns_from_episodes_to_train_batch": 0.04168378097087104, "add_time_dim_to_batch_and_zero_pad": 0.10363854513225428, "add_states_from_episodes_to_batch": 0.0035400332239201044, "batch_individual_items": 0.014353454645907936, "numpy_to_tensor": 6.481474388148533e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.2631274163722992, "use_intrinsic_rewards": 1.0, "weights_seq_no": 114.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 683316, "vf_loss_unclipped": 36.39659881591797, "vf_explained_var": 0.004461526870727539, "policy_loss": -0.0005499576800502837, "module_train_batch_size_mean": 999.0, "entropy": 0.6699944734573364, "diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.20340968668460846, "mean_kl_loss": 2.3998898541321978e-05}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3591000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1366632, "num_env_steps_trained_lifetime_throughput": 40145.48248991808}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 96.0, "weights_seq_no": 114.0, "num_module_steps_trained_lifetime": 683316, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 19.0, "num_module_steps_trained_lifetime": 113886, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 698.6067123406854}, "default_policy": {"entropy": 0.6699233055114746, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20332029461860657, "num_module_steps_trained_lifetime": 113886, "mean_kl_loss": 2.638629848661367e-05, "vf_loss": 0.26304948329925537, "use_intrinsic_rewards": 0.0, "weights_seq_no": 19.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 36.505733489990234, "vf_explained_var": 0.00020992755889892578, "num_trainable_parameters": 16595, "policy_loss": -0.0005748856347054243, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 3.0819688845440396e-07, "num_module_steps_trained_lifetime_throughput": 698.6014317524962}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 227772, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3671.3775753938094, "num_module_steps_trained_throughput": 20443371.737032373, "num_module_steps_trained_lifetime_throughput": 12557442.63279899}, "IntrinsicAttentionMask": [[[0.34221482276916504, 0.32203230261802673, 0.33575284481048584], [0.2893804907798767, 0.3922711908817291, 0.31834834814071655], [0.32550764083862305, 0.34345853328704834, 0.3310338854789734]], [[0.34311193227767944, 0.3425045907497406, 0.3143834173679352], [0.34267327189445496, 0.3420942723751068, 0.31523245573043823], [0.3208044469356537, 0.32151252031326294, 0.3576830327510834]], [[0.3550397753715515, 0.35355713963508606, 0.29140305519104004], [0.35463598370552063, 0.35318347811698914, 0.2921805679798126], [0.33537426590919495, 0.33524614572525024, 0.3293795585632324]], [[0.3328639566898346, 0.3341047167778015, 0.3330312967300415], [0.3328503966331482, 0.3341270685195923, 0.3330225646495819], [0.33286210894584656, 0.33410772681236267, 0.3330301344394684]], [[0.3397507667541504, 0.3195550739765167, 0.3406941592693329], [0.3229406476020813, 0.35552000999450684, 0.3215392529964447], [0.34048551321029663, 0.3179735243320465, 0.34154099225997925]], [[0.3617376983165741, 0.3106614351272583, 0.3276008665561676], [0.3002115488052368, 0.36117085814476013, 0.3386175334453583], [0.32108891010284424, 0.3434390425682068, 0.3354720175266266]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2203602944264842e-05, "add_time_dim_to_batch_and_zero_pad": 6.696990685853338e-06, "add_observations_from_episodes_to_batch": 2.7505512252500767e-06, "numpy_to_tensor": 1.1650075378566272e-05, "add_states_from_episodes_to_batch": 2.718147975443442e-06}}, "connector_pipeline_timer": 5.791974751263678e-05}, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 2.9757381554421474e-05, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.757317909376928e-06, "listify_data_for_vector_env": 1.0168964430424637e-05, "get_actions": 3.509671265821058e-05, "remove_single_ts_time_rank_from_batch": 1.1702088905329185e-05, "un_batch_to_individual_items": 6.447066992003883e-06, "tensor_to_numpy": 1.4865739642341917e-05}}, "connector_pipeline_timer": 0.00011226341307674633}, "module_episode_returns_mean": {"default_policy": 0.6}, "weights_seq_no": 19.0, "episode_return_mean": 0.6, "env_reset_timer": 0.0004665530269399774, "env_step_timer": 1.3711807886113943e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11757519198430019, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 95400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005283978360239416, "num_episodes_lifetime": 380, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.92502662551647}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-51-02", "timestamp": 1754931062, "time_this_iter_s": 10.458797693252563, "time_total_s": 194.94351768493652, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 194.94351768493652, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 38.333333333333336, "ram_util_percent": 80.97999999999999}}
{"timers": {"training_iteration": 9.939878271057182, "restore_env_runners": 1.0890459530671242e-05, "training_step": 9.939706441009417, "env_runner_sampling_timer": 1.6033243130438046, "learner_update_timer": 8.124285537544255, "synch_weights": 0.0008973411253016993, "restore_eval_env_runners": 1.0011717296771353e-05, "evaluation_iteration": 0.12678483392323928, "synch_eval_env_connectors": 0.00015368111481004233, "synch_env_connectors": 4.250641181215993e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.587354722986698e-06, "normalize_and_clip_actions": 8.086172325167396e-06, "listify_data_for_vector_env": 1.053120968528045e-05, "remove_single_ts_time_rank_from_batch": 1.1945716510032241e-05, "tensor_to_numpy": 1.530200447006897e-05, "get_actions": 3.8763977665564555e-05}}, "connector_pipeline_timer": 0.00011797767189724535}, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.919310838818846e-06, "add_observations_from_episodes_to_batch": 2.837474741927349e-06, "numpy_to_tensor": 1.2464747708917859e-05, "add_states_from_episodes_to_batch": 2.722483957218734e-06, "batch_individual_items": 1.23644879255056e-05}}, "connector_pipeline_timer": 5.9432213634146875e-05}, "weights_seq_no": 19.0, "episode_return_mean": -1.1800000000000002, "env_reset_timer": 4.307111066200761e-05, "sample": 0.0057994022042894165, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "time_between_sampling": 0.036080148166347886, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "env_step_timer": 1.391332215618817e-05, "rlmodule_inference_timer": 3.1423614407386574e-05, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005260112347546967, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "num_episodes_lifetime": -555250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 3244.4090177067806}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.172905993151839, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00869498222811874, "add_observations_from_episodes_to_batch": 0.0008378608558737155, "add_columns_from_episodes_to_train_batch": 0.04167633858115483, "add_time_dim_to_batch_and_zero_pad": 0.10362479301136256, "add_states_from_episodes_to_batch": 0.0035422366413416784, "batch_individual_items": 0.01433441592867158, "numpy_to_tensor": 6.4842436280311e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss": 0.2631259560585022, "use_intrinsic_rewards": 1.0, "weights_seq_no": 120.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 719280, "vf_loss_unclipped": 36.80595016479492, "vf_explained_var": 0.004376113414764404, "policy_loss": -0.00014742190251126885, "module_train_batch_size_mean": 999.0, "entropy": 0.6689768433570862, "diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.20381009578704834, "mean_kl_loss": 8.084966793830972e-06}, "__all_modules__": {"num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3780000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1438560, "num_env_steps_trained_lifetime_throughput": 39534.45123930474}, "intrinsic_reward_module": {"total_loss": 0.0, "module_train_batch_size_mean": 999.0, "diff_num_grad_updates_vs_sampler_policy": 101.0, "weights_seq_no": 120.0, "num_module_steps_trained_lifetime": 719280, "num_module_steps_trained": 35964}}}, "intrinsic_reward_module": {"weights_seq_no": 20.0, "num_module_steps_trained_lifetime": 119880, "num_module_steps_trained": 5994, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 695.2275644818152}, "default_policy": {"entropy": 0.6689576506614685, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20374488830566406, "num_module_steps_trained_lifetime": 119880, "mean_kl_loss": 8.434863957518246e-06, "vf_loss": 0.26305022835731506, "use_intrinsic_rewards": 0.0, "weights_seq_no": 20.0, "num_module_steps_trained": 5994, "vf_loss_unclipped": 36.926082611083984, "vf_explained_var": -5.2928924560546875e-05, "num_trainable_parameters": 16595, "policy_loss": -0.00015236025501508266, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 1.5409844422720198e-07, "num_module_steps_trained_lifetime_throughput": 695.2226497665516}, "__all_modules__": {"num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 239760, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3653.618727886951, "num_module_steps_trained_throughput": 19973303.48280372, "num_module_steps_trained_lifetime_throughput": 12505085.720274393}, "IntrinsicAttentionMask": [[[0.34221482276916504, 0.32203230261802673, 0.33575284481048584], [0.2893804907798767, 0.3922711908817291, 0.31834834814071655], [0.32550764083862305, 0.34345853328704834, 0.3310338854789734]], [[0.34311193227767944, 0.3425045907497406, 0.3143834173679352], [0.34267327189445496, 0.3420942723751068, 0.31523245573043823], [0.3208044469356537, 0.32151252031326294, 0.3576830327510834]], [[0.3328939378261566, 0.3333331346511841, 0.3337729275226593], [0.3328671157360077, 0.3333331346511841, 0.333799809217453], [0.3328402638435364, 0.3333331048488617, 0.3338266611099243]], [[0.3355158269405365, 0.3353515863418579, 0.3291325271129608], [0.33503687381744385, 0.33490893244743347, 0.3300541341304779], [0.31630051136016846, 0.3174841105937958, 0.3662153482437134]], [[0.345237135887146, 0.311079204082489, 0.3436836302280426], [0.3254079520702362, 0.34822791814804077, 0.32636409997940063], [0.34439849853515625, 0.31264224648475647, 0.3429592549800873]], [[0.3318730592727661, 0.33575141429901123, 0.33237552642822266], [0.3261922001838684, 0.3452010452747345, 0.3286067247390747], [0.3311353623867035, 0.33697471022605896, 0.33188992738723755]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2730921144536894e-05, "add_time_dim_to_batch_and_zero_pad": 7.007645141076957e-06, "add_observations_from_episodes_to_batch": 2.8611956325872306e-06, "numpy_to_tensor": 1.2457315014918894e-05, "add_states_from_episodes_to_batch": 2.792587537391334e-06}}, "connector_pipeline_timer": 6.0428203502514066e-05}, "agent_episode_returns_mean": {"default_agent": 0.2}, "num_env_steps_sampled": 400, "rlmodule_inference_timer": 3.169853153559035e-05, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.086348260318704e-06, "listify_data_for_vector_env": 1.0623178509790188e-05, "get_actions": 3.7761752261618415e-05, "remove_single_ts_time_rank_from_batch": 1.1975069772716303e-05, "un_batch_to_individual_items": 6.615406900840838e-06, "tensor_to_numpy": 1.570096230401574e-05}}, "connector_pipeline_timer": 0.00011800158814698811}, "module_episode_returns_mean": {"default_policy": 0.2}, "weights_seq_no": 20.0, "episode_return_mean": 0.2, "env_reset_timer": 0.00046514540739158166, "env_step_timer": 1.4694995255597811e-05, "num_episodes": 20, "episode_return_min": -13.5, "sample": 0.11758961090458458, "episode_len_min": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 100400, "episode_return_max": 13.5, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.005335280931321904, "num_episodes_lifetime": 400, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 9.932028891760215}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "aeeb0_00000", "date": "2025-08-11_18-51-13", "timestamp": 1754931073, "time_this_iter_s": 10.731410026550293, "time_total_s": 205.67492771148682, "pid": 11774, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3887258a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 205.67492771148682, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.28, "ram_util_percent": 80.83333333333333}}
