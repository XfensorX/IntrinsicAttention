{"timers": {"training_iteration": 9.608581417007372, "restore_env_runners": 1.1665979400277138e-05, "training_step": 9.60841470793821, "env_runner_sampling_timer": 1.6941271249670535, "learner_update_timer": 7.7278097089147195, "synch_weights": 0.001097499975003302}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8923059628932327e-06, "batch_individual_items": 1.3230264351929671e-05, "numpy_to_tensor": 1.418661045874515e-05, "add_observations_from_episodes_to_batch": 3.0536454083127528e-06, "add_time_dim_to_batch_and_zero_pad": 7.831204311041196e-06}}, "connector_pipeline_timer": 6.726253722528847e-05}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "module_episode_returns_mean": {"default_policy": -3.5}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.0351644505067086e-05, "remove_single_ts_time_rank_from_batch": 1.249669413178412e-05, "listify_data_for_vector_env": 1.121951006965493e-05, "tensor_to_numpy": 1.6578349820493736e-05, "normalize_and_clip_actions": 1.0823274541121722e-05, "un_batch_to_individual_items": 7.0336066714964935e-06}}, "connector_pipeline_timer": 0.0001376911710986796}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "sample": 0.00719956438690132, "episode_duration_sec_mean": 0.005536744507960973, "agent_episode_returns_mean": {"default_agent": -3.5}, "episode_len_min": 20, "weights_seq_no": 0.0, "rlmodule_inference_timer": 3.973906538444657e-05, "time_between_sampling": 0.0006927188573418501, "env_step_timer": 1.5818646462396723e-05, "num_episodes_lifetime": 31375.0, "env_reset_timer": 9.692244619834133e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -3.5, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": 627500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_env_steps_sampled_lifetime_throughput": 2931.0176812694062}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.15075904096011072, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008577833999879658, "add_observations_from_episodes_to_batch": 0.000807833974249661, "add_columns_from_episodes_to_train_batch": 0.04088545800186694, "add_time_dim_to_batch_and_zero_pad": 0.08923145802691579, "add_states_from_episodes_to_batch": 0.0036984171019867063, "batch_individual_items": 0.007391041959635913, "numpy_to_tensor": 5.445897113531828e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 5985, "entropy": 0.6909501552581787, "policy_loss": 0.00010102509259013459, "total_loss": 0.24887874722480774, "vf_loss_unclipped": 43.53081512451172, "curr_kl_coeff": 0.08079196512699127, "mean_kl_loss": 9.048989340953995e-06, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.9117791197002, "use_intrinsic_rewards": 0.0, "vf_loss": 0.32070106267929077, "weights_seq_no": 1.0, "vf_explained_var": -0.00017142295837402344, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 768.2702261193973}, "intrinsic_reward_module": {"weights_seq_no": 1.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.9117791197002, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 5985, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 768.2851392326311}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 11970, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 36000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4626.971385634947, "num_module_steps_trained_throughput": 32591601.187487613, "num_module_steps_trained_lifetime_throughput": 13904312.638166035}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 6.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 998.5423314844973}, "default_policy": {"module_train_batch_size_mean": 998.5423314844973, "use_intrinsic_rewards": 1.0, "weights_seq_no": 6.0, "mean_kl_loss": 9.828207112150267e-06, "vf_loss": 0.32139453291893005, "num_module_steps_trained": 35910, "vf_explained_var": 0.001423478126525879, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "entropy": 0.6909381747245789, "policy_loss": 0.00010648357419995591, "total_loss": 0.24942460656166077, "vf_loss_unclipped": 43.42397689819336}, "__all_modules__": {"num_env_steps_trained_lifetime": 216000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime_throughput": 62250.43741826111}}}, "IntrinsicAttentionMask": [[[0.16579993069171906, 0.16723722219467163, 0.16580891609191895, 0.16772964596748352, 0.16715456545352936, 0.16626973450183868], [0.16814914345741272, 0.1656893938779831, 0.16813360154628754, 0.16485977172851562, 0.16582928597927094, 0.1673388034105301], [0.16581463813781738, 0.16722752153873444, 0.16582345962524414, 0.167711541056633, 0.16714628040790558, 0.1662764847278595], [0.16895127296447754, 0.1651598960161209, 0.16892722249031067, 0.16388796269893646, 0.16537471115589142, 0.1676989048719406], [0.16801436245441437, 0.1657782942056656, 0.1680002361536026, 0.16502343118190765, 0.16590553522109985, 0.16727803647518158], [0.16656909883022308, 0.16673092544078827, 0.16657011210918427, 0.1667860746383667, 0.1667216420173645, 0.1666221171617508]], [[0.16601048409938812, 0.1667853742837906, 0.1667441576719284, 0.16588746011257172, 0.16666176915168762, 0.16791075468063354], [0.1664365530014038, 0.1667085736989975, 0.16669413447380066, 0.16639328002929688, 0.1666652411222458, 0.1671021729707718], [0.16641394793987274, 0.1667126715183258, 0.16669680178165436, 0.16636642813682556, 0.16666507720947266, 0.1671450138092041], [0.16594265401363373, 0.16679750382900238, 0.16675202548503876, 0.16580696403980255, 0.1666611135005951, 0.1680397391319275], [0.1663687378168106, 0.1667208969593048, 0.16670219600200653, 0.16631275415420532, 0.16666477918624878, 0.1672307401895523], [0.16705182194709778, 0.16659580171108246, 0.16661997139453888, 0.16712453961372375, 0.16666831076145172, 0.16593946516513824]], [[0.16561929881572723, 0.16760213673114777, 0.16617071628570557, 0.16699998080730438, 0.16751931607723236, 0.16608859598636627], [0.16954529285430908, 0.16411970555782318, 0.16801217198371887, 0.16574198007583618, 0.16434155404567719, 0.1682393103837967], [0.16671128571033478, 0.16662688553333282, 0.1666877120733261, 0.16665241122245789, 0.16663040220737457, 0.16669121384620667], [0.16835327446460724, 0.1651701182126999, 0.16745813190937042, 0.16612638533115387, 0.165301114320755, 0.1675909459590912], [0.16938133537769318, 0.16426381468772888, 0.16793622076511383, 0.1657949686050415, 0.1644732505083084, 0.16815036535263062], [0.16654866933822632, 0.1667718142271042, 0.1666109710931778, 0.16670429706573486, 0.1667625457048416, 0.16660170257091522]], [[0.16550412774085999, 0.16686929762363434, 0.16535986959934235, 0.1652878075838089, 0.16665120422840118, 0.17032772302627563], [0.16593320667743683, 0.16679680347442627, 0.16584181785583496, 0.16579613089561462, 0.16665901243686676, 0.16897301375865936], [0.16545848548412323, 0.16687683761119843, 0.1653086543083191, 0.1652337908744812, 0.1666502207517624, 0.17047198116779327], [0.16543568670749664, 0.16688062250614166, 0.16528305411338806, 0.16520678997039795, 0.166649729013443, 0.17054416239261627], [0.1658649891614914, 0.16680851578712463, 0.1657651662826538, 0.1657152622938156, 0.1666579395532608, 0.16918812692165375], [0.16699877381324768, 0.166605144739151, 0.1670406013727188, 0.16706152260303497, 0.16666774451732635, 0.16562624275684357]], [[0.16570916771888733, 0.16714566946029663, 0.16626088321208954, 0.16763782501220703, 0.16761021316051483, 0.16563625633716583], [0.16830438375473022, 0.16584235429763794, 0.16735199093818665, 0.16501197218894958, 0.16505838930606842, 0.16843090951442719], [0.16670742630958557, 0.16664621233940125, 0.1666838526725769, 0.16662536561489105, 0.16662654280662537, 0.16671054065227509], [0.16919051110744476, 0.16539375483989716, 0.16771821677684784, 0.16412000358104706, 0.1641911268234253, 0.16938643157482147], [0.16914081573486328, 0.16541895270347595, 0.1676977574825287, 0.16416995227336884, 0.16423970460891724, 0.1693328320980072], [0.16557708382606506, 0.16721157729625702, 0.16620460152626038, 0.16777200996875763, 0.16774055361747742, 0.1654941588640213]], [[0.16574716567993164, 0.16711434721946716, 0.16560271382331848, 0.1669687032699585, 0.16545839607715607, 0.16910859942436218], [0.16608616709709167, 0.1669505536556244, 0.16599468886852264, 0.16685859858989716, 0.1659032553434372, 0.16820675134658813], [0.1657111644744873, 0.1671316772699356, 0.16556109488010406, 0.1669803410768509, 0.16541117429733276, 0.16920453310012817], [0.16605021059513092, 0.1669679880142212, 0.16595308482646942, 0.1668703407049179, 0.1658560335636139, 0.16830229759216309], [0.16567513346672058, 0.16714897751808167, 0.16551947593688965, 0.1669919341802597, 0.16536396741867065, 0.16930049657821655], [0.1665745973587036, 0.1667119711637497, 0.16656002402305603, 0.16669738292694092, 0.16654545068740845, 0.1669105589389801]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": -0.3}, "agent_episode_returns_mean": {"default_agent": -0.3}, "module_to_env_connector": {"connector_pipeline_timer": 0.00015855219912489288, "timers": {"connectors": {"listify_data_for_vector_env": 1.370665031531822e-05, "normalize_and_clip_actions": 1.0896427836539215e-05, "un_batch_to_individual_items": 7.898540165723919e-06, "get_actions": 5.6088007344093414e-05, "remove_single_ts_time_rank_from_batch": 1.6651817150540173e-05, "tensor_to_numpy": 2.144784534134887e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1948654014761916e-06, "add_time_dim_to_batch_and_zero_pad": 9.339101102240767e-06, "numpy_to_tensor": 2.08071466788843e-05, "add_observations_from_episodes_to_batch": 3.7061770221245702e-06, "batch_individual_items": 1.575059560615892e-05}}, "connector_pipeline_timer": 8.197765443508415e-05}, "episode_return_max": 11.5, "num_env_steps_sampled_lifetime": 5400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_step_timer": 2.116969483659124e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13457633298821747, "num_episodes_lifetime": 20, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_duration_sec_mean": 0.006138510355958715, "rlmodule_inference_timer": 4.663076318961307e-05, "env_reset_timer": 0.0005282079800963402, "num_episodes": 20, "episode_return_mean": -0.3, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b7d88_00000", "date": "2025-08-11_18-41-08", "timestamp": 1754930468, "time_this_iter_s": 9.756358861923218, "time_total_s": 9.756358861923218, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.756358861923218, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.67857142857143, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 9.623105969928437, "restore_env_runners": 1.1662659235298633e-05, "training_step": 9.622938124198699, "env_runner_sampling_timer": 1.7017080916278065, "learner_update_timer": 7.733986192656448, "synch_weights": 0.001098279976285994, "restore_eval_env_runners": 1.4125020243227482e-05, "evaluation_iteration": 0.14537108410149813, "synch_eval_env_connectors": 0.00019158306531608105, "synch_env_connectors": 5.542067810893059e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5827339640055756e-06, "batch_individual_items": 1.6970200628643556e-05, "numpy_to_tensor": 2.0556006888899307e-05, "add_observations_from_episodes_to_batch": 4.18366035207051e-06, "add_time_dim_to_batch_and_zero_pad": 1.0530241783170729e-05}}, "connector_pipeline_timer": 8.51017768301577e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -2.6999999999999993}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.75860383084245e-05, "remove_single_ts_time_rank_from_batch": 1.5132507510385896e-05, "listify_data_for_vector_env": 1.4575762434147154e-05, "tensor_to_numpy": 2.301505294722196e-05, "normalize_and_clip_actions": 1.1683023088535852e-05, "un_batch_to_individual_items": 9.412659802619075e-06}}, "connector_pipeline_timer": 0.00017724816146876438}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.007069129579197777, "episode_duration_sec_mean": 0.00858634997997433, "agent_episode_returns_mean": {"default_agent": -2.6999999999999993}, "episode_len_min": 20, "weights_seq_no": 1.0, "rlmodule_inference_timer": 6.611685868337145e-05, "time_between_sampling": 0.030576865525814848, "env_step_timer": 2.1564490069005985e-05, "num_episodes_lifetime": 500.0, "env_reset_timer": 5.115295561506919e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -2.6999999999999993, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": 10000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 2760.7747096068433}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15133785138023087, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008585036909207701, "add_observations_from_episodes_to_batch": 0.0008081523049622774, "add_columns_from_episodes_to_train_batch": 0.040911199251422656, "add_time_dim_to_batch_and_zero_pad": 0.08972765886690467, "add_states_from_episodes_to_batch": 0.0037206679314840587, "batch_individual_items": 0.007417330699972808, "numpy_to_tensor": 5.475480225868523e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 11970, "entropy": 0.6905643939971924, "policy_loss": -0.00012335696374066174, "total_loss": 0.2485601305961609, "vf_loss_unclipped": 46.043399810791016, "curr_kl_coeff": 0.040395982563495636, "mean_kl_loss": 1.8894932509283535e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.828720912135, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205792307853699, "weights_seq_no": 2.0, "vf_explained_var": 0.0003612637519836426, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 766.8084501349675}, "intrinsic_reward_module": {"weights_seq_no": 2.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.828720912135, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 11970, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 766.8231223316222}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 23940, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 72000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4618.112154335434, "num_module_steps_trained_throughput": 32114966.556229718, "num_module_steps_trained_lifetime_throughput": 13862311.749881402}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 12.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 998.2236050808158}, "default_policy": {"module_train_batch_size_mean": 998.2236050808158, "use_intrinsic_rewards": 1.0, "weights_seq_no": 12.0, "mean_kl_loss": 1.8251888832310215e-05, "vf_loss": 0.3212006390094757, "num_module_steps_trained": 35910, "vf_explained_var": 0.0014100074768066406, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "entropy": 0.6905719637870789, "policy_loss": -0.00012115838762838393, "total_loss": 0.24904784560203552, "vf_loss_unclipped": 45.792198181152344}, "__all_modules__": {"num_env_steps_trained_lifetime": 432000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime_throughput": 61912.76014970524}}}, "IntrinsicAttentionMask": [[[0.16561928391456604, 0.16760212182998657, 0.16617070138454437, 0.16754689812660217, 0.16697244346141815, 0.16608858108520508], [0.16954518854618073, 0.16411958634853363, 0.1680120825767517, 0.16426746547222137, 0.1658165156841278, 0.16823920607566833], [0.16671128571033478, 0.16662690043449402, 0.1666877120733261, 0.16662923991680145, 0.1666535884141922, 0.16669122874736786], [0.16943588852882385, 0.16421566903591156, 0.1679614633321762, 0.16435803472995758, 0.16584905982017517, 0.1681799292564392], [0.16829878091812134, 0.16521824896335602, 0.16743268072605133, 0.16530278325080872, 0.1661863774061203, 0.16756120324134827], [0.1665486842393875, 0.16677182912826538, 0.1666109710931778, 0.16676564514636993, 0.16670122742652893, 0.16660170257091522]], [[0.1657472848892212, 0.16567504405975342, 0.1670416295528412, 0.16696882247924805, 0.16545851528644562, 0.16910871863365173], [0.16572926938533783, 0.16565562784671783, 0.1670488566160202, 0.16697463393211365, 0.16543488204479218, 0.16915667057037354], [0.16606824100017548, 0.16602109372615814, 0.16691192984580994, 0.1668645292520523, 0.16587971150875092, 0.16825458407402039], [0.1660502552986145, 0.16600169241428375, 0.16691921651363373, 0.16687040030956268, 0.16585609316825867, 0.16830235719680786], [0.16567526757717133, 0.16559742391109467, 0.16707056760787964, 0.16699206829071045, 0.1653640866279602, 0.1693006306886673], [0.1665746122598648, 0.16656731069087982, 0.1667046993970871, 0.1666973978281021, 0.16654546558856964, 0.1669105738401413]], [[0.16501618921756744, 0.16779614984989166, 0.1649060696363449, 0.16879843175411224, 0.1687421053647995, 0.16474103927612305], [0.16712352633476257, 0.16635149717330933, 0.167154461145401, 0.1660771518945694, 0.16609251499176025, 0.16720084846019745], [0.16493187844753265, 0.1678534597158432, 0.16481620073318481, 0.16890740394592285, 0.1688481718301773, 0.16464285552501678], [0.16787345707416534, 0.1658318191766739, 0.16795554757118225, 0.1651100516319275, 0.16515041887760162, 0.16807876527309418], [0.1678314507007599, 0.16586101055145264, 0.1679106503725052, 0.16516420245170593, 0.16520318388938904, 0.1680295467376709], [0.16480542719364166, 0.16793937981128693, 0.16468143463134766, 0.16907092928886414, 0.1690073162317276, 0.16449561715126038]], [[0.16676056385040283, 0.1664891541004181, 0.16647614538669586, 0.16672146320343018, 0.1664501279592514, 0.16710250079631805], [0.16697289049625397, 0.16608551144599915, 0.16604305803775787, 0.16684487462043762, 0.16595818102359772, 0.16809551417827606], [0.16698302328586578, 0.16606613993644714, 0.16602227091789246, 0.166850745677948, 0.16593457758426666, 0.16814325749874115], [0.16679121553897858, 0.16643111407756805, 0.16641385853290558, 0.1667393445968628, 0.16637934744358063, 0.16724517941474915], [0.167003333568573, 0.16602736711502075, 0.16598068177700043, 0.16686251759529114, 0.16588737070560455, 0.1682387888431549], [0.16649165749549866, 0.1669958382844925, 0.1670200675725937, 0.16656413674354553, 0.16706852614879608, 0.16585978865623474]], [[0.16588996350765228, 0.16732804477214813, 0.16589894890785217, 0.1678207367658615, 0.16724534332752228, 0.16581696271896362], [0.1679917871952057, 0.16553431749343872, 0.1679762452840805, 0.16470547020435333, 0.16567407548427582, 0.16811807453632355], [0.16590316593647003, 0.16731680929660797, 0.16591200232505798, 0.16780109703540802, 0.16723553836345673, 0.16583140194416046], [0.1687069982290268, 0.16492107510566711, 0.16868296265602112, 0.1636509746313095, 0.16513557732105255, 0.16890236735343933], [0.16787150502204895, 0.1656373143196106, 0.16785739362239838, 0.164883092045784, 0.1657644659280777, 0.16798624396324158], [0.16578270494937897, 0.16741923987865448, 0.16579292714595795, 0.1679803729057312, 0.16732507944107056, 0.16569969058036804]], [[0.1665458381175995, 0.16650137305259705, 0.166456937789917, 0.16641250252723694, 0.16636808216571808, 0.16771532595157623], [0.1665419489145279, 0.16649608314037323, 0.16645023226737976, 0.1664043813943863, 0.16635854542255402, 0.16774886846542358], [0.1665380597114563, 0.16649076342582703, 0.16644349694252014, 0.16639623045921326, 0.16634897887706757, 0.16778238117694855], [0.1665342003107071, 0.1664855033159256, 0.1664368063211441, 0.1663881242275238, 0.1663394570350647, 0.1678159534931183], [0.1665303260087967, 0.1664801985025406, 0.16643010079860687, 0.16638000309467316, 0.16632993519306183, 0.16784951090812683], [0.16664694249629974, 0.16663965582847595, 0.16663236916065216, 0.16662508249282837, 0.16661778092384338, 0.1668381541967392]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": -0.3}, "agent_episode_returns_mean": {"default_agent": -0.3}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011490057946273299, "timers": {"connectors": {"listify_data_for_vector_env": 1.0496234882098777e-05, "normalize_and_clip_actions": 8.035134814910014e-06, "un_batch_to_individual_items": 6.507152887745874e-06, "get_actions": 3.6643518930384904e-05, "remove_single_ts_time_rank_from_batch": 1.2065921181213768e-05, "tensor_to_numpy": 1.5278031125020992e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.665574110383005e-06, "add_time_dim_to_batch_and_zero_pad": 6.876573136704548e-06, "numpy_to_tensor": 1.2402055221272817e-05, "add_observations_from_episodes_to_batch": 2.779927879951431e-06, "batch_individual_items": 1.238303265402324e-05}}, "connector_pipeline_timer": 5.883757483100898e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 10400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_step_timer": 1.3906771488777526e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13437868007807993, "num_episodes_lifetime": 40, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_duration_sec_mean": 0.005685096993693151, "rlmodule_inference_timer": 3.1008627343928255e-05, "env_reset_timer": 0.0005265334004070611, "num_episodes": 20, "episode_return_mean": -0.3, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 11.120368125033565}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b7d88_00000", "date": "2025-08-11_18-41-19", "timestamp": 1754930479, "time_this_iter_s": 11.1875638961792, "time_total_s": 20.943922758102417, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.943922758102417, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.03125, "ram_util_percent": 78.46875}}
{"timers": {"training_iteration": 9.623667297318379, "restore_env_runners": 1.161353257484734e-05, "training_step": 9.623499187956645, "env_runner_sampling_timer": 1.7003247086217625, "learner_update_timer": 7.73581206281978, "synch_weights": 0.0010956796769052745, "restore_eval_env_runners": 1.4211689122021198e-05, "evaluation_iteration": 0.14515288743074053, "synch_eval_env_connectors": 0.00019110890454612672, "synch_env_connectors": 5.5303971748799086e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.80472763628416e-06, "batch_individual_items": 1.2753789274801288e-05, "numpy_to_tensor": 1.31823608318226e-05, "add_observations_from_episodes_to_batch": 2.8861395748779373e-06, "add_time_dim_to_batch_and_zero_pad": 7.489499969592033e-06}}, "connector_pipeline_timer": 6.170681849962656e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -3.339999999999999}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.140401248628289e-05, "remove_single_ts_time_rank_from_batch": 1.2112401425373072e-05, "listify_data_for_vector_env": 1.087261442633504e-05, "tensor_to_numpy": 1.593040409288964e-05, "normalize_and_clip_actions": 8.340675163416558e-06, "un_batch_to_individual_items": 6.838907965374602e-06}}, "connector_pipeline_timer": 0.00012278623926770637}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.00774576082253969, "episode_duration_sec_mean": 0.0053781161648221295, "agent_episode_returns_mean": {"default_agent": -3.339999999999999}, "episode_len_min": 20, "weights_seq_no": 2.0, "rlmodule_inference_timer": 5.157090430026075e-05, "time_between_sampling": 0.03520922936547909, "env_step_timer": 1.4488869074456186e-05, "num_episodes_lifetime": -30375.0, "env_reset_timer": 5.166891584985091e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -3.339999999999999, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -607500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_env_steps_sampled_lifetime_throughput": 3096.0876569012144}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1513373474466498, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00858625070946291, "add_observations_from_episodes_to_batch": 0.0008082157822325825, "add_columns_from_episodes_to_train_batch": 0.04091301559860585, "add_time_dim_to_batch_and_zero_pad": 0.08972398061798885, "add_states_from_episodes_to_batch": 0.0037210387525032276, "batch_individual_items": 0.007417150302138179, "numpy_to_tensor": 5.4833503474947065e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 17955, "entropy": 0.6899789571762085, "policy_loss": -0.00023399425845127553, "total_loss": 0.2485087662935257, "vf_loss_unclipped": 40.65205001831055, "curr_kl_coeff": 0.020197991281747818, "mean_kl_loss": 2.1381078113336116e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.7505232584676, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3206550180912018, "weights_seq_no": 3.0, "vf_explained_var": 0.0002697110176086426, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 764.7265095740245}, "intrinsic_reward_module": {"weights_seq_no": 3.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.7505232584676, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 17955, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 764.7407947025853}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 35910, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 108000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4605.475125898942, "num_module_steps_trained_throughput": 31416462.435527377, "num_module_steps_trained_lifetime_throughput": 13814259.159861952}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 18.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 998.0016398003509}, "default_policy": {"module_train_batch_size_mean": 998.0016398003509, "use_intrinsic_rewards": 1.0, "weights_seq_no": 18.0, "mean_kl_loss": 2.0015477275592275e-05, "vf_loss": 0.32100769877433777, "num_module_steps_trained": 35910, "vf_explained_var": 0.001532435417175293, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "entropy": 0.6899958848953247, "policy_loss": -0.00022665760479867458, "total_loss": 0.24879321455955505, "vf_loss_unclipped": 40.60340118408203}, "__all_modules__": {"num_env_steps_trained_lifetime": 648000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime_throughput": 61322.864797430404}}}, "IntrinsicAttentionMask": [[[0.16520026326179504, 0.16798333823680878, 0.16509002447128296, 0.16787123680114746, 0.16893033683300018, 0.16492480039596558], [0.16707256436347961, 0.16630075871944427, 0.16710348427295685, 0.16633152961730957, 0.16604185104370117, 0.1671498566865921], [0.16512535512447357, 0.1680503636598587, 0.165009543299675, 0.16793251037597656, 0.16904623806476593, 0.16483598947525024], [0.16699784994125366, 0.16636815667152405, 0.16702306270599365, 0.16639328002929688, 0.1661568135023117, 0.16706088185310364], [0.16770146787166595, 0.16573254764080048, 0.16778060793876648, 0.16581077873706818, 0.16507522761821747, 0.16789941489696503], [0.16501297056674957, 0.1681508868932724, 0.16488881409168243, 0.16802436113357544, 0.16922014951705933, 0.16470275819301605]], [[0.16669048368930817, 0.16576552391052246, 0.1666015088558197, 0.16655704379081726, 0.16563281416893005, 0.16875259578227997], [0.16670288145542145, 0.16516564786434174, 0.1665547639131546, 0.16648074984550476, 0.1649455726146698, 0.17015042901039124], [0.16669179499149323, 0.16570799052715302, 0.1665971428155899, 0.16654984652996063, 0.16556687653064728, 0.16888634860515594], [0.16669245064258575, 0.16567924618721008, 0.1665949672460556, 0.16654624044895172, 0.1655339151620865, 0.16895326972007751], [0.1667044311761856, 0.165079265832901, 0.16654780507087708, 0.166469544172287, 0.16484665870666504, 0.17035232484340668], [0.1666533350944519, 0.16708892583847046, 0.16669508814811707, 0.16671596467494965, 0.16715171933174133, 0.16569489240646362]], [[0.16580067574977875, 0.16723798215389252, 0.16635270416736603, 0.16718287765979767, 0.16715534031391144, 0.16627047955989838], [0.1681513637304306, 0.1656915694475174, 0.16719983518123627, 0.1657848209142685, 0.16583144664764404, 0.16734100878238678], [0.16670358180999756, 0.16664236783981323, 0.1666800081729889, 0.16664472222328186, 0.16664588451385498, 0.16668352484703064], [0.1680612564086914, 0.16575057804584503, 0.16716766357421875, 0.16583822667598724, 0.16588205099105835, 0.1673002541065216], [0.1680162101984024, 0.16578009724617004, 0.1671515703201294, 0.16586491465568542, 0.1659073531627655, 0.16727986931800842], [0.16656909883022308, 0.16673092544078827, 0.16663140058517456, 0.16672474145889282, 0.1667216569185257, 0.166622132062912]], [[0.16669243574142456, 0.16664794087409973, 0.16572320461273193, 0.16655898094177246, 0.16651451587677002, 0.16786295175552368], [0.16669321060180664, 0.1666473001241684, 0.16569316387176514, 0.1665555089712143, 0.16650962829589844, 0.16790121793746948], [0.16670899093151093, 0.1666334867477417, 0.16506759822368622, 0.1664825975894928, 0.16640719771385193, 0.1687001734972], [0.166694775223732, 0.16664601862430573, 0.16563308238983154, 0.16654855012893677, 0.16649985313415527, 0.16797776520252228], [0.16669553518295288, 0.1666453629732132, 0.16560302674770355, 0.1665450632572174, 0.1664949506521225, 0.16801603138446808], [0.1666710525751114, 0.1666637659072876, 0.16651184856891632, 0.16664919257164001, 0.16664189100265503, 0.16686229407787323]], [[0.16501906514167786, 0.1689140796661377, 0.1660047471523285, 0.1676870882511139, 0.167631134390831, 0.16474391520023346], [0.16795924305915833, 0.1649172455072403, 0.16717739403247833, 0.16586190462112427, 0.16590528190135956, 0.168178990483284], [0.16576886177062988, 0.16788887977600098, 0.1663074940443039, 0.1672234684228897, 0.16719307005405426, 0.16561824083328247], [0.16703957319259644, 0.1661606878042221, 0.16681477427482605, 0.16643483936786652, 0.16644741594791412, 0.1671026200056076], [0.1669975072145462, 0.16621775925159454, 0.16679811477661133, 0.1664610505104065, 0.1664721965789795, 0.1670534312725067], [0.16480904817581177, 0.16920195519924164, 0.1659194976091385, 0.16781672835350037, 0.16775359213352203, 0.1644992232322693]], [[0.1662801057100296, 0.16623902320861816, 0.16619794070720673, 0.16615687310695648, 0.16611582040786743, 0.16901026666164398], [0.16626667976379395, 0.1662241816520691, 0.16618168354034424, 0.16613921523094177, 0.1660967469215393, 0.16909147799015045], [0.16625326871871948, 0.1662093549966812, 0.16616545617580414, 0.16612157225608826, 0.16607768833637238, 0.1691727489233017], [0.16623981297016144, 0.16619449853897095, 0.16614918410778046, 0.16610388457775116, 0.16605859994888306, 0.16925401985645294], [0.1662263721227646, 0.16617964208126068, 0.16613292694091797, 0.16608621180057526, 0.16603952646255493, 0.16933533549308777], [0.16714975237846375, 0.16720226407051086, 0.16725477576255798, 0.1673073023557663, 0.167359858751297, 0.1637260466814041]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": 0.36666666666666664}, "agent_episode_returns_mean": {"default_agent": 0.36666666666666664}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001244343521514126, "timers": {"connectors": {"listify_data_for_vector_env": 1.138425494903546e-05, "normalize_and_clip_actions": 8.231796317979208e-06, "un_batch_to_individual_items": 6.979362828182733e-06, "get_actions": 4.1039270353224126e-05, "remove_single_ts_time_rank_from_batch": 1.2349332915661989e-05, "tensor_to_numpy": 1.7218986529033432e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.806581250562117e-06, "add_time_dim_to_batch_and_zero_pad": 7.138878813352166e-06, "numpy_to_tensor": 1.3114732401939921e-05, "add_observations_from_episodes_to_batch": 3.30478040945603e-06, "batch_individual_items": 1.3194268811187598e-05}}, "connector_pipeline_timer": 6.282945138832241e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 15400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_step_timer": 1.4921498794116918e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13419752577735347, "num_episodes_lifetime": 60, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_duration_sec_mean": 0.005571271607186646, "rlmodule_inference_timer": 3.502180500598942e-05, "env_reset_timer": 0.000522055986255873, "num_episodes": 20, "episode_return_mean": 0.36666666666666664, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 11.10622077378328}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b7d88_00000", "date": "2025-08-11_18-41-29", "timestamp": 1754930489, "time_this_iter_s": 9.804265975952148, "time_total_s": 30.748188734054565, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.748188734054565, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 34.43571428571428, "ram_util_percent": 77.92857142857143}}
{"timers": {"training_iteration": 9.625252208095388, "restore_env_runners": 1.1578226735349745e-05, "training_step": 9.625083607327609, "env_runner_sampling_timer": 1.6996466640348284, "learner_update_timer": 7.73783207552161, "synch_weights": 0.0010938253801800312, "restore_eval_env_runners": 1.4155412232503295e-05, "evaluation_iteration": 0.14492302022656658, "synch_eval_env_connectors": 0.00019038322499254719, "synch_env_connectors": 5.5217641056515275e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8569170431399097e-06, "batch_individual_items": 1.324277402919439e-05, "numpy_to_tensor": 1.3658627309029475e-05, "add_observations_from_episodes_to_batch": 2.937532933731436e-06, "add_time_dim_to_batch_and_zero_pad": 7.5685242530646085e-06}}, "connector_pipeline_timer": 6.327473895675118e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -3.8199999999999994}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.320278617345872e-05, "remove_single_ts_time_rank_from_batch": 1.2315580504884669e-05, "listify_data_for_vector_env": 1.1200959307114981e-05, "tensor_to_numpy": 1.653619217169789e-05, "normalize_and_clip_actions": 8.480572322874157e-06, "un_batch_to_individual_items": 7.022193801868542e-06}}, "connector_pipeline_timer": 0.00012669475997002306}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006127250866055901, "episode_duration_sec_mean": 0.005631996842566878, "agent_episode_returns_mean": {"default_agent": -3.8199999999999994}, "episode_len_min": 20, "weights_seq_no": 3.0, "rlmodule_inference_timer": 3.394307296765181e-05, "time_between_sampling": 0.03368764176675684, "env_step_timer": 1.5041251065418022e-05, "num_episodes_lifetime": -61250.0, "env_reset_timer": 4.208052616304453e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -3.8199999999999994, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -1225000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_env_steps_sampled_lifetime_throughput": 3067.7725177119655}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1514539268920856, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008610541532392614, "add_observations_from_episodes_to_batch": 0.0008090244546234607, "add_columns_from_episodes_to_train_batch": 0.040954243363109995, "add_time_dim_to_batch_and_zero_pad": 0.08977199081144946, "add_states_from_episodes_to_batch": 0.0037213883645968748, "batch_individual_items": 0.007418738389953039, "numpy_to_tensor": 5.499266858876217e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 23940, "entropy": 0.6896252036094666, "policy_loss": -0.00021408178145065904, "total_loss": 0.24843090772628784, "vf_loss_unclipped": 45.2120246887207, "curr_kl_coeff": 0.010098995640873909, "mean_kl_loss": 1.5308229194488376e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.6769017198101, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205295205116272, "weights_seq_no": 4.0, "vf_explained_var": 0.00014388561248779297, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 762.3640778861683}, "intrinsic_reward_module": {"weights_seq_no": 4.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.6769017198101, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 23940, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 762.3778672025085}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 47880, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 144000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4591.120675106877, "num_module_steps_trained_throughput": 30620488.189365573, "num_module_steps_trained_lifetime_throughput": 13764952.565798245}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 24.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 143640, "module_train_batch_size_mean": 997.847060245087}, "default_policy": {"module_train_batch_size_mean": 997.847060245087, "use_intrinsic_rewards": 1.0, "weights_seq_no": 24.0, "mean_kl_loss": 1.4177639059198555e-05, "vf_loss": 0.32091426849365234, "num_module_steps_trained": 35910, "vf_explained_var": 0.0014778375625610352, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "entropy": 0.6896426677703857, "policy_loss": -0.00020662741735577583, "total_loss": 0.2487400621175766, "vf_loss_unclipped": 45.04853820800781}, "__all_modules__": {"num_env_steps_trained_lifetime": 864000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime_throughput": 60549.49010101763}}}, "IntrinsicAttentionMask": [[[0.1648356169462204, 0.16872631013393402, 0.1647256314754486, 0.16750068962574005, 0.16855745017528534, 0.165654256939888], [0.1681036800146103, 0.16505905985832214, 0.16819162666797638, 0.16600453853607178, 0.16518858075141907, 0.16745246946811676], [0.16474229097366333, 0.16883164644241333, 0.16462674736976624, 0.16754291951656342, 0.16865406930446625, 0.16560232639312744], [0.16708122193813324, 0.166202113032341, 0.16710643470287323, 0.16647633910179138, 0.16623975336551666, 0.16689413785934448], [0.1679632067680359, 0.1652158796787262, 0.16804248094558716, 0.16606956720352173, 0.1653328686952591, 0.16737598180770874], [0.16552866995334625, 0.1679452657699585, 0.16546005010604858, 0.16718631982803345, 0.16784082353115082, 0.16603894531726837]], [[0.1661459356546402, 0.166921466588974, 0.16688022017478943, 0.16602280735969543, 0.16598178446292877, 0.16804777085781097], [0.16648422181606293, 0.16675633192062378, 0.16674187779426575, 0.166440948843956, 0.16642653942108154, 0.16715005040168762], [0.16646631062030792, 0.16676513850688934, 0.1667492687702179, 0.16641877591609955, 0.16640295088291168, 0.16719761490821838], [0.16609202325344086, 0.1669476479291916, 0.16690213978290558, 0.16595621407032013, 0.1659109741449356, 0.16819101572036743], [0.16607406735420227, 0.16695636510849, 0.16690942645072937, 0.1659340262413025, 0.16588737070560455, 0.1682387888431549], [0.1669716089963913, 0.1665157973766327, 0.1665399670600891, 0.1670442819595337, 0.16706852614879608, 0.16585978865623474]], [[0.16465218365192413, 0.16853854060173035, 0.16563567519187927, 0.16842608153820038, 0.16836987435817719, 0.16437764465808868], [0.16824811697006226, 0.165200874209404, 0.16746492683887482, 0.1652873009443283, 0.16533052921295166, 0.16846823692321777], [0.16556872427463531, 0.16768619418144226, 0.166106715798378, 0.16762523353099823, 0.1675947606563568, 0.16541829705238342], [0.1681450456380844, 0.16529634594917297, 0.16741320490837097, 0.1653771698474884, 0.1654176115989685, 0.1683506965637207], [0.1680935025215149, 0.16534404456615448, 0.16738730669021606, 0.16542208194732666, 0.16546112298965454, 0.16829191148281097], [0.1643955111503601, 0.16877739131450653, 0.16550317406654358, 0.16865040361881256, 0.16858695447444916, 0.1640864759683609]], [[0.166984423995018, 0.16605782508850098, 0.16601350903511047, 0.16596919298171997, 0.16592489182949066, 0.1690501719713211], [0.1671917885541916, 0.16565003991127014, 0.16557642817497253, 0.1655028611421585, 0.16542932391166687, 0.1706494390964508], [0.16720165312290192, 0.16563042998313904, 0.1655554175376892, 0.16548044979572296, 0.1654054969549179, 0.1707264631986618], [0.16721154749393463, 0.16561082005500793, 0.16553442180156708, 0.16545803844928741, 0.16538169980049133, 0.17080353200435638], [0.16722139716148376, 0.16559118032455444, 0.16551338136196136, 0.16543559730052948, 0.16535785794258118, 0.17088060081005096], [0.16651520133018494, 0.16695043444633484, 0.1669713407754898, 0.16699224710464478, 0.16701316833496094, 0.16555754840373993]], [[0.16579993069171906, 0.16723722219467163, 0.16580891609191895, 0.16772964596748352, 0.16715456545352936, 0.1662697196006775], [0.1681491583585739, 0.1656893789768219, 0.16813361644744873, 0.16485975682735443, 0.16582927107810974, 0.16733881831169128], [0.16581463813781738, 0.16722753643989563, 0.16582347452640533, 0.1677115559577942, 0.16714629530906677, 0.1662764996290207], [0.16895128786563873, 0.16515988111495972, 0.16892723739147186, 0.16388793289661407, 0.16537471115589142, 0.1676989197731018], [0.16801439225673676, 0.1657782942056656, 0.168000265955925, 0.16502343118190765, 0.16590555012226105, 0.16727806627750397], [0.1665690839290619, 0.16673091053962708, 0.16657009720802307, 0.1667860746383667, 0.1667216420173645, 0.1666221171617508]], [[0.16683924198150635, 0.16679471731185913, 0.16586917638778687, 0.16582489013671875, 0.16666118800640106, 0.16801080107688904], [0.1668446958065033, 0.16679874062538147, 0.16584374010562897, 0.16579806804656982, 0.16666094958782196, 0.16805380582809448], [0.16695772111415863, 0.16688209772109985, 0.16531386971473694, 0.16523900628089905, 0.16665548086166382, 0.1689518690109253], [0.1669631004333496, 0.16688606142997742, 0.16528846323490143, 0.16521219909191132, 0.16665518283843994, 0.16899503767490387], [0.16686104238033295, 0.16681082546710968, 0.16576744616031647, 0.16571755707263947, 0.16666024923324585, 0.1681828498840332], [0.16669514775276184, 0.16668786108493805, 0.16653594374656677, 0.1665286421775818, 0.16666598618030548, 0.16688641905784607]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": -0.3}, "agent_episode_returns_mean": {"default_agent": -0.3}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011271479294204733, "timers": {"connectors": {"listify_data_for_vector_env": 1.037990541335455e-05, "normalize_and_clip_actions": 7.846637657235998e-06, "un_batch_to_individual_items": 6.465487716482412e-06, "get_actions": 3.5279870502311895e-05, "remove_single_ts_time_rank_from_batch": 1.1891229064026055e-05, "tensor_to_numpy": 1.5070221137682926e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.635368027454989e-06, "add_time_dim_to_batch_and_zero_pad": 6.664761636678212e-06, "numpy_to_tensor": 1.1881405622173138e-05, "add_observations_from_episodes_to_batch": 2.733311377424772e-06, "batch_individual_items": 1.2368706966387249e-05}}, "connector_pipeline_timer": 5.8106489976105054e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 20400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_step_timer": 1.3609283504006674e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13398948551939605, "num_episodes_lifetime": 80, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_duration_sec_mean": 0.005473711538070347, "rlmodule_inference_timer": 3.0470803945526495e-05, "env_reset_timer": 0.0005204612665747991, "num_episodes": 20, "episode_return_mean": -0.3, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 11.093278889375378}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b7d88_00000", "date": "2025-08-11_18-41-39", "timestamp": 1754930499, "time_this_iter_s": 9.90710186958313, "time_total_s": 40.655290603637695, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.655290603637695, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.42857142857143, "ram_util_percent": 79.5}}
{"timers": {"training_iteration": 9.622208061014828, "restore_env_runners": 1.1520784842376598e-05, "training_step": 9.622039159584187, "env_runner_sampling_timer": 1.6979561561444394, "learner_update_timer": 7.736346298936304, "synch_weights": 0.0010905579566149787, "restore_eval_env_runners": 1.4115528267342596e-05, "evaluation_iteration": 0.14469565544453064, "synch_eval_env_connectors": 0.00018970648241217714, "synch_env_connectors": 5.506965864333323e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.739963742898916e-06, "batch_individual_items": 1.2456542952151794e-05, "numpy_to_tensor": 1.2497175615173383e-05, "add_observations_from_episodes_to_batch": 2.7842961477011526e-06, "add_time_dim_to_batch_and_zero_pad": 7.183897216469608e-06}}, "connector_pipeline_timer": 5.977783538562878e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -3.4200000000000017}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.908296083179069e-05, "remove_single_ts_time_rank_from_batch": 1.1842195104769213e-05, "listify_data_for_vector_env": 1.0572375327734534e-05, "tensor_to_numpy": 1.5318008126531066e-05, "normalize_and_clip_actions": 8.084900396840351e-06, "un_batch_to_individual_items": 6.7155015482306365e-06}}, "connector_pipeline_timer": 0.00011842696697987709}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.0057178536317079535, "episode_duration_sec_mean": 0.005280615336727349, "agent_episode_returns_mean": {"default_agent": -3.4200000000000017}, "episode_len_min": 20, "weights_seq_no": 4.0, "rlmodule_inference_timer": 3.1519142743605646e-05, "time_between_sampling": 0.03367241680735666, "env_step_timer": 1.391764992538233e-05, "num_episodes_lifetime": -92125.0, "env_reset_timer": 3.631508798780003e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -3.4200000000000017, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -1842500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_env_steps_sampled_lifetime_throughput": 3264.4868287978243}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15145970845216877, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008612780277536074, "add_observations_from_episodes_to_batch": 0.0008092925403102487, "add_columns_from_episodes_to_train_batch": 0.04096124551915858, "add_time_dim_to_batch_and_zero_pad": 0.08976570757354332, "add_states_from_episodes_to_batch": 0.003723246560767739, "batch_individual_items": 0.00741947850673546, "numpy_to_tensor": 5.500441090609296e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 29925, "entropy": 0.6889055371284485, "policy_loss": -0.0003756571386475116, "total_loss": 0.24826091527938843, "vf_loss_unclipped": 42.75930404663086, "curr_kl_coeff": 0.0050494978204369545, "mean_kl_loss": 2.8505863156169653e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.6075885025957, "use_intrinsic_rewards": 0.0, "vf_loss": 0.32051730155944824, "weights_seq_no": 5.0, "vf_explained_var": -5.2928924560546875e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 760.1610448892782}, "intrinsic_reward_module": {"weights_seq_no": 5.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.6075885025957, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 29925, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 760.174269651576}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 59850, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 180000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4577.705874132106, "num_module_steps_trained_throughput": 29793932.827877663, "num_module_steps_trained_lifetime_throughput": 13711586.341318334}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 30.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 179550, "module_train_batch_size_mean": 997.7394089995611}, "default_policy": {"module_train_batch_size_mean": 997.7394089995611, "use_intrinsic_rewards": 1.0, "weights_seq_no": 30.0, "mean_kl_loss": 2.62286212091567e-05, "vf_loss": 0.3208085000514984, "num_module_steps_trained": 35910, "vf_explained_var": 0.0015475749969482422, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "entropy": 0.6889337301254272, "policy_loss": -0.00036048184847459197, "total_loss": 0.2485068291425705, "vf_loss_unclipped": 42.67447280883789}, "__all_modules__": {"num_env_steps_trained_lifetime": 1080000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime_throughput": 59677.338245535306}}}, "IntrinsicAttentionMask": [[[0.16598089039325714, 0.16741974651813507, 0.16598987579345703, 0.16736458241939545, 0.16733701527118683, 0.1659078449010849], [0.16783703863620758, 0.16538183391094208, 0.1678215116262436, 0.16547490656375885, 0.16552145779132843, 0.1679632067680359], [0.16599254310131073, 0.16740696132183075, 0.16600139439105988, 0.16735273599624634, 0.16732564568519592, 0.16592074930667877], [0.16776619851589203, 0.16545958817005157, 0.16775162518024445, 0.16554705798625946, 0.1655908226966858, 0.1678846776485443], [0.16773079335689545, 0.16549848020076752, 0.16771669685840607, 0.16558314859867096, 0.16562551259994507, 0.16784542798995972], [0.16588620841503143, 0.16752375662326813, 0.1658964306116104, 0.16746093332767487, 0.16742953658103943, 0.16580313444137573]], [[0.16698627173900604, 0.16694170236587524, 0.1660153567790985, 0.16597102582454681, 0.1659267246723175, 0.1681588739156723], [0.16699641942977905, 0.16695043444633484, 0.1659945547580719, 0.16594882309436798, 0.16590312123298645, 0.16820663213729858], [0.1672070473432541, 0.16713131964206696, 0.1655607521533966, 0.16548578441143036, 0.1654108315706253, 0.16920419037342072], [0.16721713542938232, 0.16713997721672058, 0.16553995013237, 0.16546356678009033, 0.16538722813129425, 0.1692521721124649], [0.16722719371318817, 0.167148619890213, 0.165519118309021, 0.1654413342475891, 0.1653635948896408, 0.1693001389503479], [0.16671927273273468, 0.1667119711637497, 0.16656002402305603, 0.16655273735523224, 0.16654545068740845, 0.1669105589389801]], [[0.16501936316490173, 0.16779938340187073, 0.1649092435836792, 0.1688016802072525, 0.16763144731521606, 0.16583892703056335], [0.16712377965450287, 0.16635173559188843, 0.1671546995639801, 0.1660773754119873, 0.16639789938926697, 0.16689446568489075], [0.1649353802204132, 0.16785703599452972, 0.16481970250606537, 0.16891099512577057, 0.16768047213554382, 0.1657964289188385], [0.16787517070770264, 0.16583353281021118, 0.16795727610588074, 0.1651117354631424, 0.16595518589019775, 0.16726712882518768], [0.1669975072145462, 0.1664387583732605, 0.16701987385749817, 0.16624002158641815, 0.1664721816778183, 0.1668316274881363], [0.1656428575515747, 0.16737103462219238, 0.16557417809963226, 0.16799142956733704, 0.16726695001125336, 0.1661534607410431]], [[0.16598588228225708, 0.16735504567623138, 0.1658412218093872, 0.16576893627643585, 0.16569669544696808, 0.16935217380523682], [0.16623736917972565, 0.16710256040096283, 0.16614581644535065, 0.16610004007816315, 0.16605429351329803, 0.1683599054813385], [0.16595913469791412, 0.16738177835941315, 0.16580885648727417, 0.16573376953601837, 0.16565871238708496, 0.16945774853229523], [0.16594575345516205, 0.16739514470100403, 0.16579265892505646, 0.16571617126464844, 0.1656397134065628, 0.16951055824756622], [0.16593237221240997, 0.1674085110425949, 0.16577646136283875, 0.1656985580921173, 0.16562069952487946, 0.16956336796283722], [0.16659870743751526, 0.16673609614372253, 0.16658413410186768, 0.1665768325328827, 0.1665695607662201, 0.16693471372127533]], [[0.1658899486064911, 0.16787602007389069, 0.16589893400669098, 0.1672728806734085, 0.1672453135251999, 0.16581693291664124], [0.1687869280576706, 0.1633855700492859, 0.1687619388103485, 0.16500058770179749, 0.1650749146938324, 0.16899007558822632], [0.16590312123298645, 0.1678554266691208, 0.1659119576215744, 0.16726259887218475, 0.16723549365997314, 0.16583135724067688], [0.16791152954101562, 0.16473670303821564, 0.16789694130420685, 0.16569046676158905, 0.16573426127433777, 0.16803011298179626], [0.16787143051624298, 0.16479869186878204, 0.1678573191165924, 0.16572199761867523, 0.16576439142227173, 0.1679861694574356], [0.16578267514705658, 0.1680433452129364, 0.16579289734363556, 0.1673564314842224, 0.16732504963874817, 0.16569964587688446]], [[0.16622550785541534, 0.16615305840969086, 0.16608063876628876, 0.16600824892520905, 0.16593590378761292, 0.16959665715694427], [0.16621680557727814, 0.16614294052124023, 0.16606910526752472, 0.16599532961845398, 0.16592155396938324, 0.16965429484844208], [0.16620808839797974, 0.1661328226327896, 0.16605757176876068, 0.16598238050937653, 0.16590720415115356, 0.16971194744110107], [0.16619938611984253, 0.166122704744339, 0.16604605317115784, 0.16596943140029907, 0.16589286923408508, 0.16976962983608246], [0.16619065403938293, 0.16611255705356598, 0.1660345047712326, 0.16595648229122162, 0.16587848961353302, 0.16982729732990265], [0.1666228175163269, 0.16661551594734192, 0.16660822927951813, 0.16660094261169434, 0.16659365594387054, 0.16695886850357056]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": 0.3}, "agent_episode_returns_mean": {"default_agent": 0.3}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001132775838680348, "timers": {"connectors": {"listify_data_for_vector_env": 1.0398104259564873e-05, "normalize_and_clip_actions": 7.880718887809022e-06, "un_batch_to_individual_items": 6.51828483959043e-06, "get_actions": 3.55368377631679e-05, "remove_single_ts_time_rank_from_batch": 1.1923853452142119e-05, "tensor_to_numpy": 1.5002392612098168e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.65491080552528e-06, "add_time_dim_to_batch_and_zero_pad": 6.689607968790752e-06, "numpy_to_tensor": 1.1846355944955739e-05, "add_observations_from_episodes_to_batch": 2.696046933905437e-06, "batch_individual_items": 1.2243448828129798e-05}}, "connector_pipeline_timer": 5.798563256486452e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 25400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_step_timer": 1.3605275489769564e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13376511983469475, "num_episodes_lifetime": 100, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_duration_sec_mean": 0.005405397968133912, "rlmodule_inference_timer": 3.111636031095964e-05, "env_reset_timer": 0.0005161329038873699, "num_episodes": 20, "episode_return_mean": 0.3, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 11.075844663811546}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b7d88_00000", "date": "2025-08-11_18-41-48", "timestamp": 1754930508, "time_this_iter_s": 9.440469026565552, "time_total_s": 50.09575963020325, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.09575963020325, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.89999999999999, "ram_util_percent": 78.62142857142858}}
{"timers": {"training_iteration": 9.618769772074323, "restore_env_runners": 1.1460996507908545e-05, "training_step": 9.618600594659323, "env_runner_sampling_timer": 1.696193309172619, "learner_update_timer": 7.734564164697063, "synch_weights": 0.0010878257070373234, "restore_eval_env_runners": 1.404062378016766e-05, "evaluation_iteration": 0.14441751223114974, "synch_eval_env_connectors": 0.0001888356687085482, "synch_env_connectors": 5.491896510269725e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7320422691628245e-06, "batch_individual_items": 1.2369439133122685e-05, "numpy_to_tensor": 1.2397668801843672e-05, "add_observations_from_episodes_to_batch": 2.7758586765935867e-06, "add_time_dim_to_batch_and_zero_pad": 7.062645051130289e-06}}, "connector_pipeline_timer": 5.9403007644055494e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -3.2599999999999985}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.895290125902549e-05, "remove_single_ts_time_rank_from_batch": 1.1919272918987173e-05, "listify_data_for_vector_env": 1.0475080472170122e-05, "tensor_to_numpy": 1.524108471391501e-05, "normalize_and_clip_actions": 8.035546344352189e-06, "un_batch_to_individual_items": 6.693264935602127e-06}}, "connector_pipeline_timer": 0.00011805504725279126}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005623920160281969, "episode_duration_sec_mean": 0.005259586006868628, "agent_episode_returns_mean": {"default_agent": -3.2599999999999985}, "episode_len_min": 20, "weights_seq_no": 5.0, "rlmodule_inference_timer": 3.143610430499399e-05, "time_between_sampling": 0.03229655871621817, "env_step_timer": 1.3791058920101837e-05, "num_episodes_lifetime": -123000.0, "env_reset_timer": 3.619209997149952e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -3.2599999999999985, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -2460000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_env_steps_sampled_lifetime_throughput": 3282.1176976396755}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1514479617877216, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00861199872532271, "add_observations_from_episodes_to_batch": 0.0008094508651629992, "add_columns_from_episodes_to_train_batch": 0.04096117014394386, "add_time_dim_to_batch_and_zero_pad": 0.08975569424856487, "add_states_from_episodes_to_batch": 0.003724113265356863, "batch_individual_items": 0.00741782830199359, "numpy_to_tensor": 5.50106166670194e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 35910, "entropy": 0.6878936886787415, "policy_loss": -0.0011699938913807273, "total_loss": 0.24747323989868164, "vf_loss_unclipped": 45.179229736328125, "curr_kl_coeff": 0.0025247489102184772, "mean_kl_loss": 6.285890412982553e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.5423314844973, "use_intrinsic_rewards": 0.0, "vf_loss": 0.32052379846572876, "weights_seq_no": 6.0, "vf_explained_var": 1.52587890625e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 758.1354990569508}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.5423314844973, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 35910, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 758.1481430786431}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 71820, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 216000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4565.350044285134, "num_module_steps_trained_throughput": 28967741.167354897, "num_module_steps_trained_lifetime_throughput": 13662631.858934922}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 36.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 215460, "module_train_batch_size_mean": 997.6644392492373}, "default_policy": {"module_train_batch_size_mean": 997.6644392492373, "use_intrinsic_rewards": 1.0, "weights_seq_no": 36.0, "mean_kl_loss": 5.5841723224148154e-05, "vf_loss": 0.32075005769729614, "num_module_steps_trained": 35910, "vf_explained_var": 0.0015292167663574219, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "entropy": 0.6879591345787048, "policy_loss": -0.0011038684751838446, "total_loss": 0.24772420525550842, "vf_loss_unclipped": 45.07243347167969}, "__all_modules__": {"num_env_steps_trained_lifetime": 1296000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime_throughput": 58754.94428043707}}}, "IntrinsicAttentionMask": [[[0.16598089039325714, 0.16741974651813507, 0.16598987579345703, 0.16736458241939545, 0.16733701527118683, 0.1659078449010849], [0.16783703863620758, 0.16538181900978088, 0.1678215116262436, 0.16547489166259766, 0.16552145779132843, 0.1679632067680359], [0.16599254310131073, 0.16740696132183075, 0.16600139439105988, 0.16735273599624634, 0.16732564568519592, 0.16592074930667877], [0.16776619851589203, 0.16545957326889038, 0.16775162518024445, 0.16554705798625946, 0.1655908077955246, 0.1678846776485443], [0.16773079335689545, 0.16549846529960632, 0.16771669685840607, 0.16558314859867096, 0.16562549769878387, 0.16784542798995972], [0.16588620841503143, 0.16752375662326813, 0.1658964306116104, 0.16746093332767487, 0.16742953658103943, 0.16580313444137573]], [[0.16574707627296448, 0.1671142727136612, 0.16704143583774567, 0.16553044319152832, 0.1654583066701889, 0.1691085249185562], [0.1660861223936081, 0.1669505089521408, 0.1669045388698578, 0.16594891250133514, 0.1659032106399536, 0.16820672154426575], [0.16606813669204712, 0.1669592261314392, 0.16691182553768158, 0.1659267097711563, 0.16587959229946136, 0.16825447976589203], [0.1656930297613144, 0.1671402007341385, 0.16706308722496033, 0.16546377539634705, 0.16538743674755096, 0.1692523956298828], [0.16567501425743103, 0.1671488732099533, 0.16707032918930054, 0.1654415726661682, 0.1653638333082199, 0.1693003922700882], [0.1665745973587036, 0.1667119711637497, 0.1667046844959259, 0.16655273735523224, 0.16654545068740845, 0.1669105589389801]], [[0.1657099723815918, 0.1671464890241623, 0.1662616729736328, 0.16709141433238983, 0.1676110178232193, 0.16617950797080994], [0.16830672323703766, 0.1658446490764618, 0.16735431551933289, 0.16593797504901886, 0.16506066918373108, 0.16749562323093414], [0.16670742630958557, 0.16664621233940125, 0.1666838526725769, 0.16664856672286987, 0.16662654280662537, 0.16668736934661865], [0.16820719838142395, 0.1658945232629776, 0.1673128306865692, 0.1659822165966034, 0.16515767574310303, 0.16744554042816162], [0.16914618015289307, 0.1654241681098938, 0.1677030771970749, 0.16556476056575775, 0.1642448902130127, 0.1679169088602066], [0.1665589064359665, 0.16672071814537048, 0.16662119328975677, 0.16671454906463623, 0.1667727828025818, 0.1666119247674942]], [[0.16526676714420319, 0.16662999987602234, 0.16512274742126465, 0.1664847731590271, 0.16641221940517426, 0.17008347809314728], [0.16578254103660583, 0.166645348072052, 0.16569122672080994, 0.1665535569190979, 0.16650769114494324, 0.1688195914030075], [0.1652119904756546, 0.16662824153900146, 0.16506239771842957, 0.16647735238075256, 0.1664019525051117, 0.17021805047988892], [0.16572783887386322, 0.16664384305477142, 0.16563092172145844, 0.16654637455940247, 0.16649766266345978, 0.16895340383052826], [0.16570048034191132, 0.16664306819438934, 0.1656007468700409, 0.16654276847839355, 0.16649264097213745, 0.16902033984661102], [0.16706803441047668, 0.16667424142360687, 0.1671098917722702, 0.16671599447727203, 0.16673687100410461, 0.16569490730762482]], [[0.1644725352525711, 0.16835466027259827, 0.1654549539089203, 0.16824232041835785, 0.16818617284297943, 0.16528937220573425], [0.16839495301246643, 0.16534502804279327, 0.16761107742786407, 0.16543152928352356, 0.1654747873544693, 0.16774260997772217], [0.16546981036663055, 0.16758601367473602, 0.16600747406482697, 0.16752509772777557, 0.16749463975429535, 0.16591696441173553], [0.168282151222229, 0.16543109714984894, 0.16754969954490662, 0.16551199555397034, 0.16555245220661163, 0.16767261922359467], [0.1682257503271103, 0.16547411680221558, 0.1675190031528473, 0.16555222868919373, 0.1655912846326828, 0.16763761639595032], [0.16530194878578186, 0.16771523654460907, 0.16591468453407288, 0.16764569282531738, 0.16761094331741333, 0.16581150889396667]], [[0.16669046878814697, 0.16576550900936127, 0.1666015088558197, 0.16655702888965607, 0.16563281416893005, 0.16875259578227997], [0.16670288145542145, 0.16516564786434174, 0.1665547639131546, 0.16648074984550476, 0.1649455726146698, 0.17015042901039124], [0.16669179499149323, 0.16570799052715302, 0.1665971428155899, 0.16654983162879944, 0.16556687653064728, 0.16888634860515594], [0.16669245064258575, 0.1656792312860489, 0.1665949672460556, 0.16654624044895172, 0.1655339151620865, 0.16895326972007751], [0.16670441627502441, 0.1650792509317398, 0.16654780507087708, 0.1664695292711258, 0.16484664380550385, 0.17035232484340668], [0.1666533499956131, 0.16708894073963165, 0.16669510304927826, 0.16671596467494965, 0.16715173423290253, 0.16569489240646362]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": 0.5}, "agent_episode_returns_mean": {"default_agent": 0.5}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011234051352147289, "timers": {"connectors": {"listify_data_for_vector_env": 1.038761979710675e-05, "normalize_and_clip_actions": 7.82053517038051e-06, "un_batch_to_individual_items": 6.3607362920645235e-06, "get_actions": 3.5377316046573424e-05, "remove_single_ts_time_rank_from_batch": 1.1847617684098067e-05, "tensor_to_numpy": 1.5007292580564714e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6408940302047195e-06, "add_time_dim_to_batch_and_zero_pad": 6.6752652892975805e-06, "numpy_to_tensor": 1.1825556657636154e-05, "add_observations_from_episodes_to_batch": 2.714583296983489e-06, "batch_individual_items": 1.2254635353107338e-05}}, "connector_pipeline_timer": 5.7784405780183896e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 30400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_step_timer": 1.3639821809254275e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13354204696723715, "num_episodes_lifetime": 120, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_duration_sec_mean": 0.005204181306762621, "rlmodule_inference_timer": 3.0397262072848263e-05, "env_reset_timer": 0.00051174157489089, "num_episodes": 20, "episode_return_mean": 0.5, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 11.058084660093355}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b7d88_00000", "date": "2025-08-11_18-41-58", "timestamp": 1754930518, "time_this_iter_s": 9.398193836212158, "time_total_s": 59.493953466415405, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.493953466415405, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.23846153846154, "ram_util_percent": 77.76153846153846}}
{"timers": {"training_iteration": 9.617863421023232, "restore_env_runners": 1.1403056357341592e-05, "training_step": 9.617693879132732, "env_runner_sampling_timer": 1.6942876490006482, "learner_update_timer": 7.73545931888059, "synch_weights": 0.0010872220299482922, "restore_eval_env_runners": 1.3967717474267677e-05, "evaluation_iteration": 0.14414340044894336, "synch_eval_env_connectors": 0.00018792522167956687, "synch_env_connectors": 5.47905819154781e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.721246808575946e-06, "batch_individual_items": 1.2272986468049342e-05, "numpy_to_tensor": 1.218333582826345e-05, "add_observations_from_episodes_to_batch": 2.772458389205292e-06, "add_time_dim_to_batch_and_zero_pad": 7.013898459371236e-06}}, "connector_pipeline_timer": 5.9000808947651904e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.6599999999999997}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7889958576937135e-05, "remove_single_ts_time_rank_from_batch": 1.1823525181550909e-05, "listify_data_for_vector_env": 1.0459928165706493e-05, "tensor_to_numpy": 1.5128155142844101e-05, "normalize_and_clip_actions": 8.005696792781769e-06, "un_batch_to_individual_items": 6.653469232132801e-06}}, "connector_pipeline_timer": 0.00011670629139304048}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005546508310603041, "episode_duration_sec_mean": 0.0052039220402948574, "agent_episode_returns_mean": {"default_agent": -1.6599999999999997}, "episode_len_min": 20, "weights_seq_no": 6.0, "rlmodule_inference_timer": 3.10689521705516e-05, "time_between_sampling": 0.03205671674145527, "env_step_timer": 1.360126396827459e-05, "num_episodes_lifetime": -153875.0, "env_reset_timer": 3.338667248723459e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.6599999999999997, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -3077500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_env_steps_sampled_lifetime_throughput": 3310.682110689043}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15143341509040464, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00861233415889325, "add_observations_from_episodes_to_batch": 0.0008096284369607566, "add_columns_from_episodes_to_train_batch": 0.040965243022048195, "add_time_dim_to_batch_and_zero_pad": 0.08973777063612076, "add_states_from_episodes_to_batch": 0.003724117133415868, "batch_individual_items": 0.007416715848902619, "numpy_to_tensor": 5.508384004292647e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 41895, "entropy": 0.6864705681800842, "policy_loss": -0.0005149197531864047, "total_loss": 0.2481212466955185, "vf_loss_unclipped": 37.420127868652344, "curr_kl_coeff": 0.0012623744551092386, "mean_kl_loss": 5.342112126527354e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.4808932973482, "use_intrinsic_rewards": 0.0, "vf_loss": 0.32051214575767517, "weights_seq_no": 7.0, "vf_explained_var": -0.0001583099365234375, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 755.8776852756054}, "intrinsic_reward_module": {"weights_seq_no": 7.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.4808932973482, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 41895, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 755.8897277423578}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 83790, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4551.591435606741, "num_module_steps_trained_throughput": 28149142.56915665, "num_module_steps_trained_lifetime_throughput": 13609715.655077374}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 42.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 251370, "module_train_batch_size_mean": 997.6122293241576}, "default_policy": {"module_train_batch_size_mean": 997.6122293241576, "use_intrinsic_rewards": 1.0, "weights_seq_no": 42.0, "mean_kl_loss": 5.0253871449967846e-05, "vf_loss": 0.32066574692726135, "num_module_steps_trained": 35910, "vf_explained_var": 0.0016602277755737305, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "entropy": 0.6865063309669495, "policy_loss": -0.0004995985655114055, "total_loss": 0.2482641190290451, "vf_loss_unclipped": 37.40519332885742}, "__all_modules__": {"num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime_throughput": 57803.51100360157}}}, "IntrinsicAttentionMask": [[[0.16570912301540375, 0.16769303381443024, 0.16626082360744476, 0.16763778030872345, 0.16706302762031555, 0.16563619673252106], [0.16928955912590027, 0.1638721078634262, 0.1677587479352951, 0.16401974856853485, 0.16556648910045624, 0.16949331760406494], [0.16670742630958557, 0.1666230410337448, 0.1666838526725769, 0.16662536561489105, 0.1666497141122818, 0.16671054065227509], [0.1691901981830597, 0.1639775186777115, 0.16771790385246277, 0.1641196757555008, 0.16560854017734528, 0.1693861335515976], [0.16815541684627533, 0.16507747769355774, 0.16729006171226501, 0.16516193747520447, 0.16604480147361755, 0.16827034950256348], [0.1655770242214203, 0.16783489286899567, 0.1662045419216156, 0.16777196526527405, 0.16711749136447906, 0.16549411416053772]], [[0.16574716567993164, 0.16711434721946716, 0.16560271382331848, 0.1669687181711197, 0.16545838117599487, 0.16910861432552338], [0.16608615219593048, 0.1669505387544632, 0.16599467396736145, 0.16685858368873596, 0.165903240442276, 0.16820675134658813], [0.1657111495733261, 0.1671316772699356, 0.16556110978126526, 0.1669803261756897, 0.16541117429733276, 0.16920454800128937], [0.16605022549629211, 0.16696800291538239, 0.16595309972763062, 0.1668703556060791, 0.16585604846477509, 0.16830232739448547], [0.16567514836788177, 0.16714899241924286, 0.16551947593688965, 0.1669919490814209, 0.16536396741867065, 0.16930052638053894], [0.1665745973587036, 0.1667119711637497, 0.16656002402305603, 0.16669738292694092, 0.16654545068740845, 0.1669105589389801]], [[0.16520020365715027, 0.167983278632164, 0.16508996486663818, 0.16898667812347412, 0.167815163731575, 0.164924755692482], [0.16707256436347961, 0.16630074381828308, 0.16710348427295685, 0.16602647304534912, 0.16634690761566162, 0.1671498566865921], [0.1651252806186676, 0.16805030405521393, 0.1650094836950302, 0.16910548508167267, 0.1678735464811325, 0.16483591496944427], [0.16773875057697296, 0.16569873690605164, 0.1678207814693451, 0.1649775356054306, 0.16582030057907104, 0.16794389486312866], [0.1669604778289795, 0.16640183329582214, 0.16698284447193146, 0.16620314121246338, 0.16643527150154114, 0.1670163869857788], [0.1650128960609436, 0.16815081238746643, 0.16488873958587646, 0.16928377747535706, 0.16796107590198517, 0.16470268368721008]], [[0.1664176881313324, 0.16637657582759857, 0.16633546352386475, 0.16629435122013092, 0.1662532538175583, 0.1683226376771927], [0.16640907526016235, 0.1663665473461151, 0.16632401943206787, 0.16628149151802063, 0.16623899340629578, 0.16837994754314423], [0.16640043258666992, 0.16635648906230927, 0.1663125455379486, 0.16626861691474915, 0.16622470319271088, 0.16843725740909576], [0.1663917750120163, 0.16634641587734222, 0.16630105674266815, 0.16625572741031647, 0.16621039807796478, 0.1684945672750473], [0.16638316214084625, 0.16633637249469757, 0.16628961265087128, 0.16624285280704498, 0.16619610786437988, 0.16855192184448242], [0.16681146621704102, 0.16683565080165863, 0.16685986518859863, 0.16688406467437744, 0.16690827906131744, 0.16570067405700684]], [[0.16483239829540253, 0.16872303187847137, 0.16472241282463074, 0.16861045360565186, 0.1685541868209839, 0.1645575612783432], [0.16810168325901031, 0.16505706310272217, 0.1681896150112152, 0.16514340043067932, 0.16518659889698029, 0.1683216094970703], [0.1647387146949768, 0.16882799565792084, 0.1646231710910797, 0.16870959103107452, 0.16865041851997375, 0.1644500195980072], [0.16800828278064728, 0.1651618480682373, 0.16809044778347015, 0.16524262726306915, 0.16528302431106567, 0.16821375489234924], [0.16796158254146576, 0.16521425545215607, 0.16804085671901703, 0.16529224812984467, 0.16533124446868896, 0.1681598424911499], [0.16459821164608002, 0.1689855009317398, 0.16447436809539795, 0.1688583642244339, 0.16879482567310333, 0.16428877413272858]], [[0.16628175973892212, 0.16624067723751068, 0.16619960963726044, 0.16697536408901215, 0.16611747443675995, 0.16818515956401825], [0.1662684679031372, 0.16622596979141235, 0.1661834716796875, 0.16698595881462097, 0.16609852015972137, 0.16823767125606537], [0.1662551462650299, 0.16621124744415283, 0.16616734862327576, 0.1669965535402298, 0.1660795658826828, 0.16829019784927368], [0.16650545597076416, 0.1664881855249405, 0.16647091507911682, 0.1667965203523636, 0.16643638908863068, 0.16730253398418427], [0.1662285327911377, 0.1661817878484726, 0.16613507270812988, 0.16701771318912506, 0.16604165732860565, 0.1683952808380127], [0.16689151525497437, 0.16691572964191437, 0.16693994402885437, 0.16648422181606293, 0.16698838770389557, 0.1657802015542984]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": 0.5}, "agent_episode_returns_mean": {"default_agent": 0.5}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011826296736870702, "timers": {"connectors": {"listify_data_for_vector_env": 1.0989007321931741e-05, "normalize_and_clip_actions": 8.097995572684153e-06, "un_batch_to_individual_items": 6.620509886661179e-06, "get_actions": 3.8287717862969516e-05, "remove_single_ts_time_rank_from_batch": 1.1997000972767445e-05, "tensor_to_numpy": 1.5791007433339383e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.722316167613907e-06, "add_time_dim_to_batch_and_zero_pad": 6.93658841060237e-06, "numpy_to_tensor": 1.2580242484913076e-05, "add_observations_from_episodes_to_batch": 2.7963955570051397e-06, "batch_individual_items": 1.2555408948045852e-05}}, "connector_pipeline_timer": 5.944931620656669e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 35400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_step_timer": 1.4483596437619166e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13335715524771433, "num_episodes_lifetime": 140, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_duration_sec_mean": 0.005212682908168062, "rlmodule_inference_timer": 3.257795020979824e-05, "env_reset_timer": 0.0005078970698822075, "num_episodes": 20, "episode_return_mean": 0.5, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 11.04301358641247}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b7d88_00000", "date": "2025-08-11_18-42-07", "timestamp": 1754930527, "time_this_iter_s": 9.652369976043701, "time_total_s": 69.1463234424591, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.1463234424591, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.18571428571429, "ram_util_percent": 78.85000000000001}}
{"timers": {"training_iteration": 9.61687758139278, "restore_env_runners": 1.1348616468704947e-05, "training_step": 9.61670763867123, "env_runner_sampling_timer": 1.6933599045907066, "learner_update_timer": 7.73526951027202, "synch_weights": 0.001083906059269202, "restore_eval_env_runners": 1.3918449602609016e-05, "evaluation_iteration": 0.14391599394469964, "synch_eval_env_connectors": 0.00018735888982080319, "synch_env_connectors": 5.465517050615271e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.827508732282634e-06, "batch_individual_items": 1.2847068063685651e-05, "numpy_to_tensor": 1.3042268661349776e-05, "add_observations_from_episodes_to_batch": 2.879965972816197e-06, "add_time_dim_to_batch_and_zero_pad": 7.389536875080991e-06}}, "connector_pipeline_timer": 6.185413157975162e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -2.6200000000000006}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1417233869426334e-05, "remove_single_ts_time_rank_from_batch": 1.225258087567261e-05, "listify_data_for_vector_env": 1.0907148207075206e-05, "tensor_to_numpy": 1.5921992892954756e-05, "normalize_and_clip_actions": 8.35983470164685e-06, "un_batch_to_individual_items": 6.914973307499744e-06}}, "connector_pipeline_timer": 0.00012341174519627017}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005821237040631658, "episode_duration_sec_mean": 0.005505185843911021, "agent_episode_returns_mean": {"default_agent": -2.6200000000000006}, "episode_len_min": 20, "weights_seq_no": 7.0, "rlmodule_inference_timer": 3.3511766092392016e-05, "time_between_sampling": 0.03306956274332654, "env_step_timer": 1.4552630531197403e-05, "num_episodes_lifetime": -184750.0, "env_reset_timer": 4.085248117768471e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -2.6200000000000006, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -3695000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_env_steps_sampled_lifetime_throughput": 3126.4548347655987}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.151448377188419, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0086122337377452, "add_observations_from_episodes_to_batch": 0.0008095942326056461, "add_columns_from_episodes_to_train_batch": 0.0409661793422106, "add_time_dim_to_batch_and_zero_pad": 0.08973973250996947, "add_states_from_episodes_to_batch": 0.00373433637236, "batch_individual_items": 0.007417001600753053, "numpy_to_tensor": 5.69109219608921e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 47880, "entropy": 0.6862130761146545, "policy_loss": -7.583219849038869e-05, "total_loss": 0.24856369197368622, "vf_loss_unclipped": 41.47271728515625, "curr_kl_coeff": 0.0006311872275546193, "mean_kl_loss": 7.084592652972788e-06, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.4230504637324, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205161392688751, "weights_seq_no": 8.0, "vf_explained_var": 7.927417755126953e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 753.721650422082}, "intrinsic_reward_module": {"weights_seq_no": 8.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.4230504637324, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 47880, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 753.733083484989}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 95760, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 288000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4538.444066642942, "num_module_steps_trained_throughput": 27366223.47148327, "num_module_steps_trained_lifetime_throughput": 13560178.568289097}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 48.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 287280, "module_train_batch_size_mean": 997.5758696422192}, "default_policy": {"module_train_batch_size_mean": 997.5758696422192, "use_intrinsic_rewards": 1.0, "weights_seq_no": 48.0, "mean_kl_loss": 6.780670901207486e-06, "vf_loss": 0.3206425905227661, "num_module_steps_trained": 35910, "vf_explained_var": 0.0015969276428222656, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "entropy": 0.6862223744392395, "policy_loss": -7.378803275059909e-05, "total_loss": 0.24866533279418945, "vf_loss_unclipped": 41.40507125854492}, "__all_modules__": {"num_env_steps_trained_lifetime": 1728000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime_throughput": 56834.02589090408}}}, "IntrinsicAttentionMask": [[[0.16579988598823547, 0.1677848994731903, 0.16580887138843536, 0.1671820878982544, 0.16715453565120697, 0.1662696897983551], [0.16904105246067047, 0.16363155841827393, 0.169016033411026, 0.16524900496006012, 0.1653234362602234, 0.16773894429206848], [0.1658146232366562, 0.16776588559150696, 0.16582344472408295, 0.1671733558177948, 0.16714629530906677, 0.1662764698266983], [0.16805924475193024, 0.1648816019296646, 0.16804465651512146, 0.16583621501922607, 0.16588005423545837, 0.16729824244976044], [0.16801433265209198, 0.16493895649909973, 0.1680002063512802, 0.1658630520105362, 0.16590547561645508, 0.1672780066728592], [0.16656909883022308, 0.16679227352142334, 0.16657011210918427, 0.16672475636005402, 0.1667216569185257, 0.166622132062912]], [[0.16550904512405396, 0.1668742597103119, 0.16680152714252472, 0.16672882437705994, 0.16522067785263062, 0.16886566579341888], [0.16593517363071442, 0.16679878532886505, 0.16675284504890442, 0.16670691967010498, 0.16575242578983307, 0.16805385053157806], [0.16591256856918335, 0.16680282354354858, 0.16675545275211334, 0.1667081117630005, 0.16572420299053192, 0.1680968701839447], [0.1658899486064911, 0.16680686175823212, 0.16675806045532227, 0.166709303855896, 0.16569598019123077, 0.16813988983631134], [0.1654185801744461, 0.16689015924930573, 0.1668117195367813, 0.16673333942890167, 0.16510789096355438, 0.16903835535049438], [0.16655050218105316, 0.16668784618377686, 0.16668055951595306, 0.16667327284812927, 0.166521355509758, 0.16688640415668488]], [[0.16520020365715027, 0.167983278632164, 0.16508996486663818, 0.16898667812347412, 0.167815163731575, 0.1649247407913208], [0.16707256436347961, 0.16630074381828308, 0.16710348427295685, 0.16602647304534912, 0.16634690761566162, 0.1671498566865921], [0.1651252806186676, 0.16805030405521393, 0.16500946879386902, 0.16910548508167267, 0.1678735464811325, 0.16483591496944427], [0.16773875057697296, 0.16569873690605164, 0.1678207814693451, 0.1649775356054306, 0.16582030057907104, 0.16794389486312866], [0.1669604778289795, 0.16640183329582214, 0.16698284447193146, 0.16620314121246338, 0.16643527150154114, 0.1670163869857788], [0.1650128960609436, 0.16815081238746643, 0.16488872468471527, 0.16928377747535706, 0.16796107590198517, 0.16470268368721008]], [[0.1657385230064392, 0.1665121465921402, 0.1664709895849228, 0.16642986238002777, 0.16638873517513275, 0.16845980286598206], [0.16634108126163483, 0.16661295294761658, 0.16659851372241974, 0.1665840744972229, 0.16656963527202606, 0.16729378700256348], [0.16630908846855164, 0.16660763323307037, 0.1665917932987213, 0.16657592356204987, 0.1665600836277008, 0.1673555076122284], [0.16627709567546844, 0.16660231351852417, 0.1665850430727005, 0.16656777262687683, 0.16655050218105316, 0.1674172282218933], [0.16624510288238525, 0.16659699380397797, 0.16657830774784088, 0.1665596067905426, 0.16654092073440552, 0.16747897863388062], [0.16784748435020447, 0.16685712337493896, 0.16690953075885773, 0.16696195304393768, 0.16701440513134003, 0.16440947353839874]], [[0.16520343720912933, 0.16798657178878784, 0.16509319841861725, 0.16787448525428772, 0.16781845688819885, 0.16602391004562378], [0.16707280278205872, 0.16630099713802338, 0.16710372269153595, 0.16633176803588867, 0.16634714603424072, 0.16684356331825256], [0.16512884199619293, 0.16805392503738403, 0.16501303017139435, 0.1679360717535019, 0.1678771674633026, 0.1659909039735794], [0.1669980138540268, 0.16636832058429718, 0.16702322661876678, 0.1663934290409088, 0.16640599071979523, 0.1668110340833664], [0.16696061193943024, 0.1664019674062729, 0.1669829785823822, 0.16642425954341888, 0.16643540561199188, 0.1667947620153427], [0.1657572090625763, 0.16748657822608948, 0.16568847000598907, 0.16741713881492615, 0.16738241910934448, 0.16626816987991333]], [[0.16614440083503723, 0.16610334813594818, 0.16606229543685913, 0.1668374389410019, 0.1659802347421646, 0.16887234151363373], [0.1661263108253479, 0.16608384251594543, 0.16604138910770416, 0.16684319078922272, 0.1659565269947052, 0.16894873976707458], [0.16610823571681976, 0.16606435179710388, 0.1660204976797104, 0.16684897243976593, 0.1659328043460846, 0.16902518272399902], [0.16644808650016785, 0.16643083095550537, 0.1664135754108429, 0.1667390614748001, 0.16637906432151794, 0.16758939623832703], [0.1660720407962799, 0.1660253405570984, 0.16597867012023926, 0.16686047613620758, 0.16588535904884338, 0.16917812824249268], [0.16732367873191833, 0.16737623512744904, 0.16742880642414093, 0.1664409041404724, 0.1675339937210083, 0.163896381855011]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": 0.5}, "agent_episode_returns_mean": {"default_agent": 0.5}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011289350121526244, "timers": {"connectors": {"listify_data_for_vector_env": 1.05249227458973e-05, "normalize_and_clip_actions": 7.882944718917533e-06, "un_batch_to_individual_items": 6.426597485670389e-06, "get_actions": 3.5531903620325534e-05, "remove_single_ts_time_rank_from_batch": 1.1902988092752769e-05, "tensor_to_numpy": 1.5059539001334525e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6652413406726707e-06, "add_time_dim_to_batch_and_zero_pad": 6.823189365407231e-06, "numpy_to_tensor": 1.1881634946642173e-05, "add_observations_from_episodes_to_batch": 2.7425150693867865e-06, "batch_individual_items": 1.2386524863646673e-05}}, "connector_pipeline_timer": 5.823039464609468e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 40400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_step_timer": 1.3728460168355924e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13314141869469603, "num_episodes_lifetime": 160, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_duration_sec_mean": 0.005170775851001963, "rlmodule_inference_timer": 3.054809939491389e-05, "env_reset_timer": 0.0005036193485906173, "num_episodes": 20, "episode_return_mean": 0.5, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 11.028013216798655}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b7d88_00000", "date": "2025-08-11_18-42-17", "timestamp": 1754930537, "time_this_iter_s": 9.63900899887085, "time_total_s": 78.78533244132996, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 78.78533244132996, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.535714285714285, "ram_util_percent": 78.73571428571428}}
{"timers": {"training_iteration": 9.616521464748168, "restore_env_runners": 1.1296379897290704e-05, "training_step": 9.616351091453911, "env_runner_sampling_timer": 1.6926291142948944, "learner_update_timer": 7.735389404759188, "synch_weights": 0.0010823753279942288, "restore_eval_env_runners": 1.3840094440543937e-05, "evaluation_iteration": 0.1436439781752836, "synch_eval_env_connectors": 0.00018650988148321976, "synch_env_connectors": 5.450452402756022e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7512189194844005e-06, "batch_individual_items": 1.2439592569585926e-05, "numpy_to_tensor": 1.2439336356257927e-05, "add_observations_from_episodes_to_batch": 2.7900386743596073e-06, "add_time_dim_to_batch_and_zero_pad": 7.134999747927227e-06}}, "connector_pipeline_timer": 5.978596765742743e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.863109062897854e-05, "remove_single_ts_time_rank_from_batch": 1.1946600644975692e-05, "listify_data_for_vector_env": 1.0578148626850442e-05, "tensor_to_numpy": 1.5321473655241024e-05, "normalize_and_clip_actions": 8.061128626450519e-06, "un_batch_to_individual_items": 6.722821906331541e-06}}, "connector_pipeline_timer": 0.00011798286219658502}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005641616858849501, "episode_duration_sec_mean": 0.005285162023268642, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "episode_len_min": 20, "weights_seq_no": 8.0, "rlmodule_inference_timer": 3.1507942537343125e-05, "time_between_sampling": 0.03302762717529984, "env_step_timer": 1.3811551325669431e-05, "num_episodes_lifetime": -215625.0, "env_reset_timer": 3.6535413687915014e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.2600000000000002, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -4312500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_env_steps_sampled_lifetime_throughput": 3263.454819249495}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1515495925864593, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008622422239657548, "add_observations_from_episodes_to_batch": 0.0008105603697595075, "add_columns_from_episodes_to_train_batch": 0.0409985783898031, "add_time_dim_to_batch_and_zero_pad": 0.08978730518470654, "add_states_from_episodes_to_batch": 0.0037359521795609, "batch_individual_items": 0.007425157834430661, "numpy_to_tensor": 5.7082642596486805e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 53865, "entropy": 0.6852999925613403, "policy_loss": -0.000368012668332085, "total_loss": 0.2482721209526062, "vf_loss_unclipped": 43.10515594482422, "curr_kl_coeff": 0.00031559361377730966, "mean_kl_loss": 3.355660373927094e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.3685925840979, "use_intrinsic_rewards": 0.0, "vf_loss": 0.32051512598991394, "weights_seq_no": 9.0, "vf_explained_var": -0.00013506412506103516, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 751.6108542959748}, "intrinsic_reward_module": {"weights_seq_no": 9.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.3685925840979, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 53865, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 751.6216804335525}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 107730, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 324000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4525.567845569583, "num_module_steps_trained_throughput": 26618840.730830602, "num_module_steps_trained_lifetime_throughput": 13512366.281762175}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 54.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 323190, "module_train_batch_size_mean": 997.5505482791133}, "default_policy": {"module_train_batch_size_mean": 997.5505482791133, "use_intrinsic_rewards": 1.0, "weights_seq_no": 54.0, "mean_kl_loss": 3.130729601252824e-05, "vf_loss": 0.3206195533275604, "num_module_steps_trained": 35910, "vf_explained_var": 0.0015905499458312988, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "entropy": 0.6853347420692444, "policy_loss": -0.00035570040927268565, "total_loss": 0.24837078154087067, "vf_loss_unclipped": 43.00785446166992}, "__all_modules__": {"num_env_steps_trained_lifetime": 1944000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime_throughput": 55870.27163356303}}}, "IntrinsicAttentionMask": [[[0.1650223731994629, 0.16780246794223785, 0.1660080999135971, 0.16769050061702728, 0.1676345318555832, 0.1658419519662857], [0.16712403297424316, 0.16635197401046753, 0.16684840619564056, 0.16638275980949402, 0.16639815270900726, 0.16689471900463104], [0.16576984524726868, 0.16728529334068298, 0.16630849242210388, 0.1672244817018509, 0.16719408333301544, 0.16621780395507812], [0.16703978180885315, 0.1664099246263504, 0.16681498289108276, 0.16643504798412323, 0.16644760966300964, 0.16685275733470917], [0.16699764132499695, 0.16643887758255005, 0.16679823398590088, 0.16646115481853485, 0.16647230088710785, 0.16683174669742584], [0.16564403474330902, 0.1673722267150879, 0.1662580370903015, 0.16730283200740814, 0.16726814210414886, 0.1661546528339386]], [[0.16587360203266144, 0.16664785146713257, 0.16579163074493408, 0.16656550765037537, 0.16652435064315796, 0.16859710216522217], [0.16638872027397156, 0.16666065156459808, 0.16635988652706146, 0.1666317731142044, 0.16661733388900757, 0.1673416942358017], [0.16581889986991882, 0.16664636135101318, 0.1657313108444214, 0.16655834019184113, 0.1665143519639969, 0.16873076558113098], [0.16633406281471252, 0.1666593998670578, 0.16629958152770996, 0.16662484407424927, 0.1666075736284256, 0.16747459769248962], [0.16630671918392181, 0.16665874421596527, 0.16626940667629242, 0.1666213423013687, 0.16660265624523163, 0.16754105687141418], [0.1676725596189499, 0.16668321192264557, 0.1677778959274292, 0.16678793728351593, 0.1668403297662735, 0.1642381101846695]], [[0.16520026326179504, 0.16798333823680878, 0.16509002447128296, 0.16787125170230865, 0.16893035173416138, 0.16492481529712677], [0.16707256436347961, 0.16630074381828308, 0.16710348427295685, 0.16633152961730957, 0.16604183614253998, 0.1671498566865921], [0.16512535512447357, 0.1680503785610199, 0.165009543299675, 0.16793252527713776, 0.16904625296592712, 0.16483598947525024], [0.16699784994125366, 0.16636815667152405, 0.16702306270599365, 0.16639326512813568, 0.16615678369998932, 0.16706088185310364], [0.16770146787166595, 0.16573253273963928, 0.16778060793876648, 0.16581076383590698, 0.16507519781589508, 0.16789941489696503], [0.16501297056674957, 0.1681509017944336, 0.16488881409168243, 0.16802437603473663, 0.16922016441822052, 0.16470275819301605]], [[0.16550420224666595, 0.16543206572532654, 0.16679665446281433, 0.16528789699077606, 0.16665129363536835, 0.17032784223556519], [0.16548140347003937, 0.16540786623954773, 0.16679902374744415, 0.165260910987854, 0.16665081679821014, 0.1703999787569046], [0.1659105122089386, 0.16586340963840485, 0.1667533963918686, 0.16576921939849854, 0.16665871441364288, 0.16904476284980774], [0.165435791015625, 0.1653594672679901, 0.1668037325143814, 0.1652069091796875, 0.16664983332157135, 0.1705443114042282], [0.16586503386497498, 0.16581511497497559, 0.16675835847854614, 0.1657153069972992, 0.16665798425674438, 0.16918820142745972], [0.16699878871440887, 0.16701969504356384, 0.1666260063648224, 0.16706153750419617, 0.16666775941848755, 0.16562622785568237]], [[0.16598089039325714, 0.16741976141929626, 0.16598987579345703, 0.16736459732055664, 0.16733703017234802, 0.1659078449010849], [0.16783705353736877, 0.16538181900978088, 0.16782152652740479, 0.16547490656375885, 0.16552145779132843, 0.16796322166919708], [0.16599255800247192, 0.16740697622299194, 0.16600139439105988, 0.16735275089740753, 0.16732566058635712, 0.16592074930667877], [0.16776619851589203, 0.16545957326889038, 0.16775162518024445, 0.16554705798625946, 0.1655908077955246, 0.1678846776485443], [0.16773079335689545, 0.16549846529960632, 0.16771669685840607, 0.16558313369750977, 0.16562549769878387, 0.16784542798995972], [0.16588620841503143, 0.16752377152442932, 0.1658964306116104, 0.16746094822883606, 0.16742955148220062, 0.16580313444137573]], [[0.1667174994945526, 0.16644616425037384, 0.16669145226478577, 0.16667842864990234, 0.16640713810920715, 0.16705936193466187], [0.16683198511600494, 0.165945366024971, 0.16674670577049255, 0.16670408844947815, 0.16581813991069794, 0.16795368492603302], [0.16672854125499725, 0.1663980931043625, 0.16669680178165436, 0.1666809320449829, 0.1663505882024765, 0.1671450138092041], [0.16673403978347778, 0.1663740575313568, 0.16669946908950806, 0.1666821837425232, 0.16632230579853058, 0.1671878546476364], [0.1668483465909958, 0.16587330400943756, 0.16675454378128052, 0.16670766472816467, 0.1657334268093109, 0.16808268427848816], [0.16657163202762604, 0.16707605123519897, 0.16661997139453888, 0.1666441410779953, 0.16714878380298615, 0.16593945026397705]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": 0.9}, "agent_episode_returns_mean": {"default_agent": 0.9}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011391971413895967, "timers": {"connectors": {"listify_data_for_vector_env": 1.0510974728322463e-05, "normalize_and_clip_actions": 7.91592240581474e-06, "un_batch_to_individual_items": 6.531538686595744e-06, "get_actions": 3.609507705965677e-05, "remove_single_ts_time_rank_from_batch": 1.1932224456297279e-05, "tensor_to_numpy": 1.524092048900647e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6729852041033738e-06, "add_time_dim_to_batch_and_zero_pad": 6.803573773858519e-06, "numpy_to_tensor": 1.2084724313591684e-05, "add_observations_from_episodes_to_batch": 2.7732229581462716e-06, "batch_individual_items": 1.238864039613519e-05}}, "connector_pipeline_timer": 5.8532946817803476e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 45400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_step_timer": 1.403389962152702e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1329755536784406, "num_episodes_lifetime": 180, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_duration_sec_mean": 0.00520396251580678, "rlmodule_inference_timer": 3.129273790238216e-05, "env_reset_timer": 0.000499523994631886, "num_episodes": 20, "episode_return_mean": 0.9, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 11.01376438130064}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b7d88_00000", "date": "2025-08-11_18-42-27", "timestamp": 1754930547, "time_this_iter_s": 9.706058740615845, "time_total_s": 88.4913911819458, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 88.4913911819458, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.153846153846146, "ram_util_percent": 79.06923076923077}}
{"timers": {"training_iteration": 9.61825266968148, "restore_env_runners": 1.124008591282993e-05, "training_step": 9.618081010119516, "env_runner_sampling_timer": 1.6937013602320752, "learner_update_timer": 7.735848722792687, "synch_weights": 0.0010939511550532564, "restore_eval_env_runners": 1.3761693953008099e-05, "evaluation_iteration": 0.14342675672375574, "synch_eval_env_connectors": 0.0001858710318193194, "synch_env_connectors": 5.435118142063571e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8892781509826228e-06, "batch_individual_items": 1.3214964716625577e-05, "numpy_to_tensor": 1.3792621597702014e-05, "add_observations_from_episodes_to_batch": 2.9838978777720203e-06, "add_time_dim_to_batch_and_zero_pad": 7.647192843236934e-06}}, "connector_pipeline_timer": 6.38550919609753e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.8199999999999996}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.370283760405327e-05, "remove_single_ts_time_rank_from_batch": 1.2571583286629231e-05, "listify_data_for_vector_env": 1.134467072687788e-05, "tensor_to_numpy": 1.67397353372722e-05, "normalize_and_clip_actions": 8.535894651026106e-06, "un_batch_to_individual_items": 7.178838422714915e-06}}, "connector_pipeline_timer": 0.00012850348432820607}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005949562249543389, "episode_duration_sec_mean": 0.005703336977399886, "agent_episode_returns_mean": {"default_agent": -1.8199999999999996}, "episode_len_min": 20, "weights_seq_no": 9.0, "rlmodule_inference_timer": 3.468072937784528e-05, "time_between_sampling": 0.033423387190661576, "env_step_timer": 1.517595043008858e-05, "num_episodes_lifetime": -246500.0, "env_reset_timer": 4.4544095832507056e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.8199999999999996, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -4930000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_env_steps_sampled_lifetime_throughput": 3049.571892970533}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15157886582127705, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008624687186981533, "add_observations_from_episodes_to_batch": 0.0008110743567243322, "add_columns_from_episodes_to_train_batch": 0.0410140430154348, "add_time_dim_to_batch_and_zero_pad": 0.08979468963240343, "add_states_from_episodes_to_batch": 0.0037377484879287993, "batch_individual_items": 0.007426471256383856, "numpy_to_tensor": 5.73847366706365e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 59850, "entropy": 0.6840436458587646, "policy_loss": -0.0007301463629119098, "total_loss": 0.24790841341018677, "vf_loss_unclipped": 40.67585372924805, "curr_kl_coeff": 0.00015779680688865483, "mean_kl_loss": 3.775649383896962e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.3173215714437, "use_intrinsic_rewards": 0.0, "vf_loss": 0.320510596036911, "weights_seq_no": 10.0, "vf_explained_var": -0.0004112720489501953, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 749.4735702881236}, "intrinsic_reward_module": {"weights_seq_no": 10.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.3173215714437, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 59850, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 749.4838032145085}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 119700, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 360000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4512.537133872629, "num_module_steps_trained_throughput": 25879940.246374443, "num_module_steps_trained_lifetime_throughput": 13439632.796324942}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 60.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 359100, "module_train_batch_size_mean": 997.532914147147}, "default_policy": {"module_train_batch_size_mean": 997.532914147147, "use_intrinsic_rewards": 1.0, "weights_seq_no": 60.0, "mean_kl_loss": 3.3212814742000774e-05, "vf_loss": 0.32058921456336975, "num_module_steps_trained": 35910, "vf_explained_var": 0.0016279220581054688, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "entropy": 0.6841159462928772, "policy_loss": -0.0006854524253867567, "total_loss": 0.24801959097385406, "vf_loss_unclipped": 40.60083770751953}, "__all_modules__": {"num_env_steps_trained_lifetime": 2160000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime_throughput": 54913.54720010112}}}, "IntrinsicAttentionMask": [[[0.16501940786838531, 0.1677994430065155, 0.16490928828716278, 0.16768747568130493, 0.16874541342258453, 0.16583897173404694], [0.16712379455566406, 0.16635173559188843, 0.1671547144651413, 0.16638252139091492, 0.16609275341033936, 0.16689448058605194], [0.16493543982505798, 0.1678571105003357, 0.16481977701187134, 0.1677393913269043, 0.168851837515831, 0.16579650342464447], [0.16703960299491882, 0.16640974581241608, 0.1670648157596588, 0.1664348691701889, 0.16619832813739777, 0.16685257852077484], [0.16783307492733002, 0.16586260497570038, 0.1679122895002365, 0.16594088077545166, 0.16520476341247559, 0.16724631190299988], [0.1656428873538971, 0.16737107932567596, 0.16557420790195465, 0.16730168461799622, 0.1679566502571106, 0.16615350544452667]], [[0.16614605486392975, 0.1661049872636795, 0.16688032448291779, 0.1660229116678238, 0.16679786145687103, 0.16804789006710052], [0.16612808406352997, 0.1660856157541275, 0.16688764095306396, 0.16600072383880615, 0.1668023318052292, 0.1680956333875656], [0.16646631062030792, 0.16645047068595886, 0.1667492687702179, 0.16641879081726074, 0.166717529296875, 0.16719762980937958], [0.1660921722650528, 0.1660468876361847, 0.16690225899219513, 0.16595634818077087, 0.1668112725019455, 0.16819116473197937], [0.16643042862415314, 0.16641175746917725, 0.16676399111747742, 0.16637441515922546, 0.16672657430171967, 0.1672927588224411], [0.16697163879871368, 0.16699586808681488, 0.1665399968624115, 0.16704432666301727, 0.16658832132816315, 0.16585980355739594]], [[0.16570989787578583, 0.1676938384771347, 0.16626161336898804, 0.16709135472774506, 0.16706381738185883, 0.16617944836616516], [0.16929559409618378, 0.1638779491186142, 0.16776473820209503, 0.16549783945083618, 0.1655723750591278, 0.1679915338754654], [0.16670742630958557, 0.166623055934906, 0.1666838526725769, 0.16664856672286987, 0.166649729013443, 0.16668736934661865], [0.1682070940732956, 0.16502666473388672, 0.16731272637844086, 0.16598211228847504, 0.16602598130702972, 0.16744543612003326], [0.16815735399723053, 0.16507937014102936, 0.16729198396205902, 0.1660042405128479, 0.16604670882225037, 0.1674204021692276], [0.1665589064359665, 0.16678206622600555, 0.16662119328975677, 0.16671454906463623, 0.1667114496231079, 0.1666119247674942]], [[0.16654396057128906, 0.16561982035636902, 0.16645506024360657, 0.1664106398820877, 0.16636621952056885, 0.1686042845249176], [0.16645964980125427, 0.16492465138435364, 0.16631174087524414, 0.16623783111572266, 0.16616396605968475, 0.16990217566490173], [0.16653597354888916, 0.16555307805538177, 0.1664413958787918, 0.16639414429664612, 0.16634689271450043, 0.16872848570346832], [0.16653196513652802, 0.16551971435546875, 0.16643455624580383, 0.16638588905334473, 0.16633722186088562, 0.16879060864448547], [0.16652795672416687, 0.16548635065555573, 0.16642773151397705, 0.16637764871120453, 0.166327565908432, 0.168852761387825], [0.16672252118587494, 0.167158305644989, 0.1667642891407013, 0.16678518056869507, 0.16680607199668884, 0.16576367616653442]], [[0.16520342230796814, 0.16798657178878784, 0.16509319841861725, 0.16787448525428772, 0.16781845688819885, 0.16602391004562378], [0.16707280278205872, 0.16630099713802338, 0.16710372269153595, 0.16633176803588867, 0.16634714603424072, 0.16684356331825256], [0.16512882709503174, 0.16805392503738403, 0.16501303017139435, 0.1679360717535019, 0.1678771674633026, 0.1659908890724182], [0.1669980138540268, 0.16636832058429718, 0.16702322661876678, 0.1663934290409088, 0.16640599071979523, 0.1668110340833664], [0.16696061193943024, 0.1664019674062729, 0.1669829785823822, 0.16642425954341888, 0.16643540561199188, 0.1667947620153427], [0.1657571941614151, 0.16748657822608948, 0.16568847000598907, 0.16741713881492615, 0.16738241910934448, 0.16626816987991333]], [[0.16671748459339142, 0.166704460978508, 0.16643314063549042, 0.1664201319217682, 0.16666537523269653, 0.16705934703350067], [0.16672302782535553, 0.1667085886001587, 0.1664077192544937, 0.16639329493045807, 0.16666525602340698, 0.16710220277309418], [0.16683745384216309, 0.16679339110851288, 0.16587752103805542, 0.1658337116241455, 0.16666126251220703, 0.16799668967723846], [0.16684290766716003, 0.16679741442203522, 0.16585209965705872, 0.1658068746328354, 0.16666102409362793, 0.16803967952728271], [0.1667395681142807, 0.16672086715698242, 0.16633138060569763, 0.16631272435188293, 0.1666647493839264, 0.1672307252883911], [0.16657163202762604, 0.16659580171108246, 0.16710029542446136, 0.16712453961372375, 0.16666831076145172, 0.16593945026397705]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": -0.5}, "agent_episode_returns_mean": {"default_agent": -0.5}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011224282960788379, "timers": {"connectors": {"listify_data_for_vector_env": 1.0389847083121222e-05, "normalize_and_clip_actions": 7.867122365546292e-06, "un_batch_to_individual_items": 6.412994922253379e-06, "get_actions": 3.508793850290534e-05, "remove_single_ts_time_rank_from_batch": 1.180420994331055e-05, "tensor_to_numpy": 1.513345700080597e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6419989422984394e-06, "add_time_dim_to_batch_and_zero_pad": 6.7049716567812e-06, "numpy_to_tensor": 1.1937495680391993e-05, "add_observations_from_episodes_to_batch": 2.735631240371943e-06, "batch_individual_items": 1.2321500589963105e-05}}, "connector_pipeline_timer": 5.8036894911458467e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 50400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_step_timer": 1.369395912792374e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13276821022136856, "num_episodes_lifetime": 200, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_duration_sec_mean": 0.005205929987132549, "rlmodule_inference_timer": 3.063220696380801e-05, "env_reset_timer": 0.0004960808340241475, "num_episodes": 20, "episode_return_mean": -0.5, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 11.001750299157704}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b7d88_00000", "date": "2025-08-11_18-42-37", "timestamp": 1754930557, "time_this_iter_s": 9.91127896308899, "time_total_s": 98.40267014503479, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.40267014503479, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.54666666666667, "ram_util_percent": 78.67333333333335}}
{"timers": {"training_iteration": 9.624533159655329, "restore_env_runners": 1.1194775203670493e-05, "training_step": 9.624360647518081, "env_runner_sampling_timer": 1.6935447183003656, "learner_update_timer": 7.7421208251444575, "synch_weights": 0.0011009520525185879, "restore_eval_env_runners": 1.379157770682905e-05, "evaluation_iteration": 0.1431748258263991, "synch_eval_env_connectors": 0.0001851731522261106, "synch_env_connectors": 5.4195169646662495e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8135269832709616e-06, "batch_individual_items": 1.2722191055385562e-05, "numpy_to_tensor": 2.8050094784098075e-05, "add_observations_from_episodes_to_batch": 2.8633479405721615e-06, "add_time_dim_to_batch_and_zero_pad": 7.31354765089578e-06}}, "connector_pipeline_timer": 7.637878717120972e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.6599999999999997}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1045526195372327e-05, "remove_single_ts_time_rank_from_batch": 1.213808704170151e-05, "listify_data_for_vector_env": 1.0774170406678882e-05, "tensor_to_numpy": 1.5769888587037207e-05, "normalize_and_clip_actions": 8.234186833130274e-06, "un_batch_to_individual_items": 6.853332128401717e-06}}, "connector_pipeline_timer": 0.00012211663632443587}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006189711040550213, "episode_duration_sec_mean": 0.00579421631246805, "agent_episode_returns_mean": {"default_agent": -1.6599999999999997}, "episode_len_min": 20, "weights_seq_no": 10.0, "rlmodule_inference_timer": 3.29930638682309e-05, "time_between_sampling": 0.03308926004495486, "env_step_timer": 1.4320773646172724e-05, "num_episodes_lifetime": -277375.0, "env_reset_timer": 4.665015739018362e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.6599999999999997, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -5547500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_env_steps_sampled_lifetime_throughput": 3133.39076498103}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1516042621637428, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008629394484975553, "add_observations_from_episodes_to_batch": 0.0008112456936826213, "add_columns_from_episodes_to_train_batch": 0.041021829665114494, "add_time_dim_to_batch_and_zero_pad": 0.08980113690541744, "add_states_from_episodes_to_batch": 0.003738546833899889, "batch_individual_items": 0.007431772793443912, "numpy_to_tensor": 5.758796856204423e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 65835, "entropy": 0.6825713515281677, "policy_loss": -0.0008471490000374615, "total_loss": 0.24779298901557922, "vf_loss_unclipped": 45.2150993347168, "curr_kl_coeff": 7.889840344432741e-05, "mean_kl_loss": 7.946267578518018e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.2690509307901, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205097019672394, "weights_seq_no": 11.0, "vf_explained_var": -0.00034868717193603516, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 746.6477709958056}, "intrinsic_reward_module": {"weights_seq_no": 11.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.2690509307901, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 65835, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 746.6574589323054}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 131670, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4495.364189233424, "num_module_steps_trained_throughput": 25171472.022565905, "num_module_steps_trained_lifetime_throughput": 13370601.85593935}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 66.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 395010, "module_train_batch_size_mean": 997.5206335045569}, "default_policy": {"module_train_batch_size_mean": 997.5206335045569, "use_intrinsic_rewards": 1.0, "weights_seq_no": 66.0, "mean_kl_loss": 7.430100231431425e-05, "vf_loss": 0.32058587670326233, "num_module_steps_trained": 35910, "vf_explained_var": 0.0016301274299621582, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "entropy": 0.6826313138008118, "policy_loss": -0.0008201734744943678, "total_loss": 0.24789120256900787, "vf_loss_unclipped": 45.09134292602539}, "__all_modules__": {"num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime_throughput": 53967.28389762925}}}, "IntrinsicAttentionMask": [[[0.16501902043819427, 0.1689140796661377, 0.1660047173500061, 0.1676870882511139, 0.167631134390831, 0.16474387049674988], [0.16795924305915833, 0.1649172157049179, 0.16717739403247833, 0.16586188971996307, 0.16590526700019836, 0.168178990483284], [0.1657688468694687, 0.16788889467716217, 0.1663074940443039, 0.1672234833240509, 0.16719308495521545, 0.16561824083328247], [0.16703958809375763, 0.1661606878042221, 0.16681478917598724, 0.1664348542690277, 0.16644741594791412, 0.1671026349067688], [0.1669975072145462, 0.16621774435043335, 0.16679811477661133, 0.1664610356092453, 0.1664721816778183, 0.1670534312725067], [0.16480903327465057, 0.16920195519924164, 0.1659194827079773, 0.16781672835350037, 0.16775359213352203, 0.1644992083311081]], [[0.1657472848892212, 0.16567504405975342, 0.1670416295528412, 0.16696882247924805, 0.16545851528644562, 0.16910874843597412], [0.16572926938533783, 0.16565562784671783, 0.1670488566160202, 0.16697463393211365, 0.16543488204479218, 0.16915670037269592], [0.16606822609901428, 0.16602106392383575, 0.16691190004348755, 0.1668645143508911, 0.16587968170642853, 0.16825458407402039], [0.1660502701997757, 0.16600169241428375, 0.16691921651363373, 0.16687040030956268, 0.16585609316825867, 0.16830238699913025], [0.16567525267601013, 0.16559740900993347, 0.16707056760787964, 0.16699205338954926, 0.1653640866279602, 0.16930066049098969], [0.1665745973587036, 0.16656732559204102, 0.1667046844959259, 0.16669738292694092, 0.16654545068740845, 0.1669105589389801]], [[0.165019229054451, 0.16779926419258118, 0.16600492596626282, 0.1676872968673706, 0.1687452346086502, 0.1647440791130066], [0.16712377965450287, 0.16635173559188843, 0.16684815287590027, 0.16638250648975372, 0.16609273850917816, 0.16720110177993774], [0.16576890647411346, 0.16728433966636658, 0.16630753874778748, 0.16722352802753448, 0.16779740154743195, 0.16561828553676605], [0.16703960299491882, 0.16640974581241608, 0.16681480407714844, 0.1664348691701889, 0.16619832813739777, 0.16710264980793], [0.16783298552036285, 0.16586251556873322, 0.16712789237499237, 0.1659407913684845, 0.16520467400550842, 0.16803109645843506], [0.16480925679206848, 0.1679433137178421, 0.1659197062253952, 0.16781695187091827, 0.16901126503944397, 0.164499431848526]], [[0.1667174994945526, 0.16644616425037384, 0.16669143736362457, 0.16667841374874115, 0.16640713810920715, 0.16705936193466187], [0.16683198511600494, 0.165945366024971, 0.16674670577049255, 0.16670408844947815, 0.16581813991069794, 0.16795368492603302], [0.16672854125499725, 0.16639810800552368, 0.16669681668281555, 0.1666809469461441, 0.1663505882024765, 0.1671450287103653], [0.16673405468463898, 0.1663740575313568, 0.16669946908950806, 0.1666821986436844, 0.16632232069969177, 0.1671878695487976], [0.16684836149215698, 0.16587330400943756, 0.1667545586824417, 0.16670767962932587, 0.1657334417104721, 0.16808269917964935], [0.16657163202762604, 0.16707605123519897, 0.16661997139453888, 0.1666441410779953, 0.16714878380298615, 0.16593945026397705]], [[0.1653846800327301, 0.16817086935043335, 0.16527430713176727, 0.16805864870548248, 0.16800257563591003, 0.16510891914367676], [0.16702161729335785, 0.16625003516674042, 0.1670525223016739, 0.16628079116344452, 0.16629616916179657, 0.16709887981414795], [0.16531920433044434, 0.16824766993522644, 0.165203258395195, 0.16812968254089355, 0.1680707037448883, 0.16502951085567474], [0.16695627570152283, 0.16632673144340515, 0.16698148846626282, 0.16635183990001678, 0.1663644015789032, 0.1670192927122116], [0.16692359745502472, 0.16636507213115692, 0.1669459491968155, 0.16638736426830292, 0.16639849543571472, 0.16697949171066284], [0.1652209758758545, 0.16836285591125488, 0.16509665548801422, 0.16823618113994598, 0.16817288100719452, 0.16491037607192993]], [[0.16669057309627533, 0.16576559841632843, 0.1657213568687439, 0.16655711829662323, 0.16651266813278198, 0.16875270009040833], [0.16670307517051697, 0.16516585648059845, 0.16509245336055756, 0.16648095846176147, 0.16640697419643402, 0.17015065252780914], [0.16670362651348114, 0.16513706743717194, 0.16506227850914001, 0.166477233171463, 0.16640184819698334, 0.17021794617176056], [0.16669254004955292, 0.16567930579185486, 0.16563084721565247, 0.1665463149547577, 0.166497603058815, 0.16895335912704468], [0.16669316589832306, 0.16565053164958954, 0.16560067236423492, 0.16654270887374878, 0.16649258136749268, 0.16902028024196625], [0.1666533499956131, 0.16708895564079285, 0.167109876871109, 0.16671597957611084, 0.16673687100410461, 0.16569489240646362]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": -1.1}, "agent_episode_returns_mean": {"default_agent": -1.1}, "module_to_env_connector": {"connector_pipeline_timer": 0.00012379181764344166, "timers": {"connectors": {"listify_data_for_vector_env": 1.2010421464012585e-05, "normalize_and_clip_actions": 8.407853880603483e-06, "un_batch_to_individual_items": 6.852454010163523e-06, "get_actions": 4.0172389390184736e-05, "remove_single_ts_time_rank_from_batch": 1.2768856560322661e-05, "tensor_to_numpy": 1.6251457315545568e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8769083301677907e-06, "add_time_dim_to_batch_and_zero_pad": 7.120569414212762e-06, "numpy_to_tensor": 1.3332214387571654e-05, "add_observations_from_episodes_to_batch": 2.9702876908047086e-06, "batch_individual_items": 1.3065347779098567e-05}}, "connector_pipeline_timer": 6.255717794651007e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 55400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_step_timer": 1.5798437038955837e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13270416604022928, "num_episodes_lifetime": 220, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_duration_sec_mean": 0.005322762894211337, "rlmodule_inference_timer": 3.4889917165324574e-05, "env_reset_timer": 0.0004955487753551119, "num_episodes": 20, "episode_return_mean": -1.1, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.99447714991615}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b7d88_00000", "date": "2025-08-11_18-42-47", "timestamp": 1754930567, "time_this_iter_s": 10.385231733322144, "time_total_s": 108.78790187835693, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 108.78790187835693, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.614285714285714, "ram_util_percent": 80.89285714285715}}
{"timers": {"training_iteration": 9.625525247229337, "restore_env_runners": 1.1164907238441087e-05, "training_step": 9.625351848542818, "env_runner_sampling_timer": 1.6942068931971366, "learner_update_timer": 7.742328159813588, "synch_weights": 0.0011010254522392283, "restore_eval_env_runners": 1.4042822052483146e-05, "evaluation_iteration": 0.14310095465847558, "synch_eval_env_connectors": 0.00018507351087855429, "synch_env_connectors": 5.4099007142067755e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.825409162913445e-06, "batch_individual_items": 1.2865099545408791e-05, "numpy_to_tensor": 1.3155284493212825e-05, "add_observations_from_episodes_to_batch": 2.901019458308742e-06, "add_time_dim_to_batch_and_zero_pad": 7.424782420044265e-06}}, "connector_pipeline_timer": 6.197433161679246e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1836612816580125e-05, "remove_single_ts_time_rank_from_batch": 1.2279879162298228e-05, "listify_data_for_vector_env": 1.0964373714671294e-05, "tensor_to_numpy": 1.6047895327327208e-05, "normalize_and_clip_actions": 8.411597596984938e-06, "un_batch_to_individual_items": 6.912004478239493e-06}}, "connector_pipeline_timer": 0.00012395157560139786}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006007846765897522, "episode_duration_sec_mean": 0.00551481516752392, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "episode_len_min": 20, "weights_seq_no": 11.0, "rlmodule_inference_timer": 3.3527710119738293e-05, "time_between_sampling": 0.035718130572369375, "env_step_timer": 1.4577342264681987e-05, "num_episodes_lifetime": -308250.0, "env_reset_timer": 4.9324948106828545e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.0199999999999996, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -6165000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_env_steps_sampled_lifetime_throughput": 3089.834903130969}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1516068799614931, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008629931370094475, "add_observations_from_episodes_to_batch": 0.000811268236989578, "add_columns_from_episodes_to_train_batch": 0.041023713448180794, "add_time_dim_to_batch_and_zero_pad": 0.08980066094567596, "add_states_from_episodes_to_batch": 0.0037393738649093367, "batch_individual_items": 0.007431705485366453, "numpy_to_tensor": 5.761041939279194e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 71820, "entropy": 0.6813482642173767, "policy_loss": -0.00018450881179887801, "total_loss": 0.24845752120018005, "vf_loss_unclipped": 43.5893440246582, "curr_kl_coeff": 3.944920172216371e-05, "mean_kl_loss": 2.778952148219105e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.2236050808158, "use_intrinsic_rewards": 0.0, "vf_loss": 0.32050976157188416, "weights_seq_no": 12.0, "vf_explained_var": -0.00016796588897705078, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 744.1682091442392}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.2236050808158, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 71820, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 744.1773716353027}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 143640, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 432000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4480.279282306435, "num_module_steps_trained_throughput": 24504654.337882, "num_module_steps_trained_lifetime_throughput": 13307438.080888376}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 72.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 430920, "module_train_batch_size_mean": 997.512081102731}, "default_policy": {"module_train_batch_size_mean": 997.512081102731, "use_intrinsic_rewards": 1.0, "weights_seq_no": 72.0, "mean_kl_loss": 2.6729221644927748e-05, "vf_loss": 0.3205679655075073, "num_module_steps_trained": 35910, "vf_explained_var": 0.0016509294509887695, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "entropy": 0.6813701391220093, "policy_loss": -0.00018114480189979076, "total_loss": 0.24851053953170776, "vf_loss_unclipped": 43.48675537109375}, "__all_modules__": {"num_env_steps_trained_lifetime": 2592000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime_throughput": 53045.81649735159}}}, "IntrinsicAttentionMask": [[[0.16520026326179504, 0.16798335313796997, 0.16509002447128296, 0.16787125170230865, 0.16893035173416138, 0.16492481529712677], [0.16707256436347961, 0.16630074381828308, 0.16710348427295685, 0.16633152961730957, 0.16604183614253998, 0.1671498566865921], [0.16512535512447357, 0.1680503785610199, 0.165009543299675, 0.16793252527713776, 0.16904625296592712, 0.16483598947525024], [0.16699784994125366, 0.16636815667152405, 0.16702306270599365, 0.16639326512813568, 0.16615678369998932, 0.16706088185310364], [0.16770146787166595, 0.16573253273963928, 0.16778060793876648, 0.16581076383590698, 0.16507521271705627, 0.16789941489696503], [0.16501297056674957, 0.1681509017944336, 0.16488881409168243, 0.16802437603473663, 0.16922016441822052, 0.16470275819301605]], [[0.16574223339557648, 0.1656699925661087, 0.16559778153896332, 0.16696374118328094, 0.1654534637928009, 0.17057280242443085], [0.1657240241765976, 0.1656503826379776, 0.16557677090168, 0.16696934401988983, 0.16542966663837433, 0.17064981162548065], [0.1657058298587799, 0.1656307876110077, 0.16555577516555786, 0.1669749617576599, 0.16540586948394775, 0.17072685062885284], [0.16604799032211304, 0.1659994274377823, 0.16595086455345154, 0.16686810553073883, 0.165853813290596, 0.1692797988653183], [0.16566938161849976, 0.1655915379524231, 0.16551373898983002, 0.1669861376285553, 0.16535821557044983, 0.170880988240242], [0.16692955791950226, 0.16695046424865723, 0.1669713705778122, 0.1665778011083603, 0.16701319813728333, 0.16555757820606232]], [[0.16598089039325714, 0.16741976141929626, 0.16598987579345703, 0.16736459732055664, 0.16733703017234802, 0.1659078449010849], [0.16783703863620758, 0.16538181900978088, 0.1678215116262436, 0.16547489166259766, 0.16552144289016724, 0.1679632067680359], [0.16599255800247192, 0.16740697622299194, 0.16600139439105988, 0.16735275089740753, 0.16732566058635712, 0.16592074930667877], [0.16776619851589203, 0.16545957326889038, 0.16775162518024445, 0.16554705798625946, 0.1655908077955246, 0.1678846776485443], [0.16773079335689545, 0.16549846529960632, 0.16771669685840607, 0.16558313369750977, 0.16562549769878387, 0.16784542798995972], [0.16588620841503143, 0.16752377152442932, 0.1658964306116104, 0.16746094822883606, 0.16742955148220062, 0.16580314934253693]], [[0.16574737429618835, 0.16567513346672058, 0.16704173386096954, 0.1655307412147522, 0.16689614951610565, 0.16910883784294128], [0.1657293736934662, 0.1656557321548462, 0.16704897582530975, 0.16550853848457336, 0.16690054535865784, 0.16915680468082428], [0.16606827080249786, 0.16602110862731934, 0.16691195964813232, 0.16592684388160706, 0.16681717336177826, 0.16825462877750397], [0.16569338738918304, 0.1656169295310974, 0.16706344485282898, 0.1654641330242157, 0.166909322142601, 0.16925276815891266], [0.1660323292016983, 0.16598235070705414, 0.1669265478849411, 0.16588245332241058, 0.166826069355011, 0.1683502048254013], [0.1665745973587036, 0.16656731069087982, 0.1667046844959259, 0.16655273735523224, 0.16669009625911713, 0.1669105589389801]], [[0.16465218365192413, 0.16853855550289154, 0.16563567519187927, 0.16842609643936157, 0.16836988925933838, 0.16437764465808868], [0.16824811697006226, 0.165200874209404, 0.16746492683887482, 0.16528728604316711, 0.16533051431179047, 0.16846823692321777], [0.1655687391757965, 0.16768620908260345, 0.166106715798378, 0.16762524843215942, 0.167594775557518, 0.16541829705238342], [0.1681450456380844, 0.16529633104801178, 0.16741320490837097, 0.1653771549463272, 0.1654175966978073, 0.1683506965637207], [0.1680935174226761, 0.16534404456615448, 0.16738732159137726, 0.16542209684848785, 0.16546112298965454, 0.16829192638397217], [0.1643955260515213, 0.16877742111682892, 0.16550318896770477, 0.16865043342113495, 0.16858696937561035, 0.1640864759683609]], [[0.16698631644248962, 0.1660597175359726, 0.16689719259738922, 0.1659710705280304, 0.1659267693758011, 0.16815891861915588], [0.1671970933675766, 0.16565531492233276, 0.16704854369163513, 0.16550813615322113, 0.1654345840215683, 0.16915637254714966], [0.16700662672519684, 0.1660209596157074, 0.1669117957353592, 0.16592667996883392, 0.16587956249713898, 0.16825446486473083], [0.16721723973751068, 0.1656164675951004, 0.16706298291683197, 0.16546368598937988, 0.1653873324394226, 0.16925229132175446], [0.16722732782363892, 0.16559705138206482, 0.1670701950788498, 0.16544145345687866, 0.16536371409893036, 0.16930027306079865], [0.16671927273273468, 0.16656731069087982, 0.1667046844959259, 0.16655273735523224, 0.16654545068740845, 0.1669105589389801]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": -0.1}, "agent_episode_returns_mean": {"default_agent": -0.1}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001136715327206396, "timers": {"connectors": {"listify_data_for_vector_env": 1.0516585280141923e-05, "normalize_and_clip_actions": 7.913914525283154e-06, "un_batch_to_individual_items": 6.501798316382308e-06, "get_actions": 3.557723955478092e-05, "remove_single_ts_time_rank_from_batch": 1.2046655544245004e-05, "tensor_to_numpy": 1.5194247807232322e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.660914340154192e-06, "add_time_dim_to_batch_and_zero_pad": 6.814249822515066e-06, "numpy_to_tensor": 1.2052031726334863e-05, "add_observations_from_episodes_to_batch": 2.8027698249685295e-06, "batch_individual_items": 1.2444753881925607e-05}}, "connector_pipeline_timer": 5.871841848793155e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 60400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_step_timer": 1.3810024718587335e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13250878646012423, "num_episodes_lifetime": 240, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_duration_sec_mean": 0.0053045583073981105, "rlmodule_inference_timer": 3.0959975814958e-05, "env_reset_timer": 0.0004918791169500504, "num_episodes": 20, "episode_return_mean": -0.1, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.982066987997168}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b7d88_00000", "date": "2025-08-11_18-42-57", "timestamp": 1754930577, "time_this_iter_s": 9.846199035644531, "time_total_s": 118.63410091400146, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 118.63410091400146, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 37.542857142857144, "ram_util_percent": 79.40714285714286}}
{"timers": {"training_iteration": 9.629327525587426, "restore_env_runners": 1.111409797739665e-05, "training_step": 9.629153647556599, "env_runner_sampling_timer": 1.6935108005150854, "learner_update_timer": 7.746683381964971, "synch_weights": 0.0011055622776823084, "restore_eval_env_runners": 1.4090734032069586e-05, "evaluation_iteration": 0.14286372344165252, "synch_eval_env_connectors": 0.00018434735592768946, "synch_env_connectors": 5.394132615929444e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7624678072190296e-06, "batch_individual_items": 1.2381630954814041e-05, "numpy_to_tensor": 1.2407588694195239e-05, "add_observations_from_episodes_to_batch": 2.7973882385757385e-06, "add_time_dim_to_batch_and_zero_pad": 7.0990018429076354e-06}}, "connector_pipeline_timer": 5.963690222806861e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.9}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.917085102662113e-05, "remove_single_ts_time_rank_from_batch": 1.190516139036368e-05, "listify_data_for_vector_env": 1.0536430239154037e-05, "tensor_to_numpy": 1.528519034397411e-05, "normalize_and_clip_actions": 8.046348758460685e-06, "un_batch_to_individual_items": 6.71524392992341e-06}}, "connector_pipeline_timer": 0.00011837872316915726}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005707091347203297, "episode_duration_sec_mean": 0.005277688814792781, "agent_episode_returns_mean": {"default_agent": -1.9}, "episode_len_min": 20, "weights_seq_no": 12.0, "rlmodule_inference_timer": 3.192284839322167e-05, "time_between_sampling": 0.03343275118066432, "env_step_timer": 1.3785748748089396e-05, "num_episodes_lifetime": -339125.0, "env_reset_timer": 4.166275051251557e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.9, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -6782500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_env_steps_sampled_lifetime_throughput": 3234.838221320932}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.151622991571291, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008636429145994466, "add_observations_from_episodes_to_batch": 0.000811665135131282, "add_columns_from_episodes_to_train_batch": 0.04103847715403135, "add_time_dim_to_batch_and_zero_pad": 0.08979243892632752, "add_states_from_episodes_to_batch": 0.003739899707196675, "batch_individual_items": 0.007433238430652114, "numpy_to_tensor": 5.797473563088027e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 77805, "entropy": 0.6805184483528137, "policy_loss": 4.1356066503794864e-05, "total_loss": 0.24868550896644592, "vf_loss_unclipped": 41.96174621582031, "curr_kl_coeff": 1.9724600861081854e-05, "mean_kl_loss": 1.0296041182300542e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.1808187151925, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205108046531677, "weights_seq_no": 13.0, "vf_explained_var": -2.6226043701171875e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 741.6364850523723}, "intrinsic_reward_module": {"weights_seq_no": 13.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.1808187151925, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 77805, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 741.6451243181302}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 155610, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 468000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4464.888717237122, "num_module_steps_trained_throughput": 23871665.30240056, "num_module_steps_trained_lifetime_throughput": 13249858.099635137}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 78.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 466830, "module_train_batch_size_mean": 997.5061250970534}, "default_policy": {"module_train_batch_size_mean": 997.5061250970534, "use_intrinsic_rewards": 1.0, "weights_seq_no": 78.0, "mean_kl_loss": 1.0789722182380501e-05, "vf_loss": 0.32055357098579407, "num_module_steps_trained": 35910, "vf_explained_var": 0.0016672015190124512, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "entropy": 0.6805010437965393, "policy_loss": 4.4804586650570855e-05, "total_loss": 0.2487240582704544, "vf_loss_unclipped": 41.881675720214844}, "__all_modules__": {"num_env_steps_trained_lifetime": 2808000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime_throughput": 52153.49258924386}}}, "IntrinsicAttentionMask": [[[0.16483554244041443, 0.1676124781370163, 0.1658201366662979, 0.16861365735530853, 0.16855739057064056, 0.1645607054233551], [0.1671747863292694, 0.16640248894691467, 0.16689907014369965, 0.16612805426120758, 0.16614343225955963, 0.16725212335586548], [0.1656687706708908, 0.1671832948923111, 0.16620709002017975, 0.167726531624794, 0.1676960438489914, 0.16551823914051056], [0.16800999641418457, 0.1659666895866394, 0.16727875173091888, 0.16524432599544525, 0.16528473794460297, 0.16821548342704773], [0.1679631769657135, 0.1659911870956421, 0.16725753247737885, 0.1652938276529312, 0.1653328239917755, 0.16816143691539764], [0.16460222005844116, 0.1677323281764984, 0.16571128368377686, 0.1688624769449234, 0.16879893839359283, 0.16429279744625092]], [[0.16574707627296448, 0.1671142578125, 0.16704142093658447, 0.16553044319152832, 0.1654583066701889, 0.1691085249185562], [0.1660861074924469, 0.1669505089521408, 0.1669045239686966, 0.16594891250133514, 0.16590319573879242, 0.16820672154426575], [0.1660681515932083, 0.1669592261314392, 0.16691182553768158, 0.1659267097711563, 0.16587959229946136, 0.16825449466705322], [0.1656930148601532, 0.1671401858329773, 0.16706307232379913, 0.16546377539634705, 0.16538743674755096, 0.1692523956298828], [0.16567502915859222, 0.16714885830879211, 0.16707032918930054, 0.1654415875673294, 0.1653638482093811, 0.1693004071712494], [0.1665745973587036, 0.1667119711637497, 0.1667046844959259, 0.16655273735523224, 0.16654545068740845, 0.1669105589389801]], [[0.16561928391456604, 0.16760213673114777, 0.16617070138454437, 0.16699998080730438, 0.16751931607723236, 0.16608858108520508], [0.16954530775547028, 0.1641196757555008, 0.16801218688488007, 0.1657419502735138, 0.164341539144516, 0.16823932528495789], [0.16671128571033478, 0.1666269153356552, 0.1666877120733261, 0.16665242612361908, 0.16663041710853577, 0.16669122874736786], [0.16835328936576843, 0.1651701033115387, 0.16745814681053162, 0.16612637042999268, 0.1653010994195938, 0.16759096086025238], [0.16938136518001556, 0.1642637997865677, 0.16793625056743622, 0.1657949686050415, 0.1644732505083084, 0.168150395154953], [0.1665486842393875, 0.16677182912826538, 0.1666109710931778, 0.16670431196689606, 0.1667625606060028, 0.16660170257091522]], [[0.16667430102825165, 0.16640302538871765, 0.1666482537984848, 0.1663770079612732, 0.16662220656871796, 0.16727526485919952], [0.1666896492242813, 0.16580379009246826, 0.1666044294834137, 0.16571903228759766, 0.16651926934719086, 0.1686638444662094], [0.1666758805513382, 0.16634555160999298, 0.1666441708803177, 0.16631388664245605, 0.166612446308136, 0.16740812361240387], [0.16669097542762756, 0.16574625670909882, 0.1666000932455063, 0.16565588116645813, 0.1665092557668686, 0.1687975376844406], [0.16667744517326355, 0.16628806293010712, 0.166640043258667, 0.16625075042247772, 0.16660265624523163, 0.16754105687141418], [0.16663075983524323, 0.1677250862121582, 0.16673544049263, 0.1678304672241211, 0.16684021055698395, 0.16423800587654114]], [[0.16483858227729797, 0.16872936487197876, 0.16582319140434265, 0.1675037145614624, 0.16744783520698547, 0.16565725207328796], [0.1681055724620819, 0.1650608777999878, 0.167323037981987, 0.16600638628005981, 0.1660497933626175, 0.16745434701442719], [0.16566969454288483, 0.16778846085071564, 0.16620801389217377, 0.1671234518289566, 0.16709306836128235, 0.16611738502979279], [0.16708138585090637, 0.16620227694511414, 0.1668565273284912, 0.16647650301456451, 0.16648906469345093, 0.1668943166732788], [0.1670345664024353, 0.16625462472438812, 0.16683511435985565, 0.16649796068668365, 0.16650912165641785, 0.1668686419725418], [0.16552981734275818, 0.16794642806053162, 0.16614338755607605, 0.16718746721744537, 0.16715280711650848, 0.1660400629043579]], [[0.16683928668498993, 0.16591350734233856, 0.1667502224445343, 0.16582493484020233, 0.16666121780872345, 0.1680108606815338], [0.16695241630077362, 0.16541288793087006, 0.16680407524108887, 0.16526590287685394, 0.16665585339069366, 0.16890881955623627], [0.16685019433498383, 0.1658654510974884, 0.16675545275211334, 0.1657712608575821, 0.16666077077388763, 0.1680968701839447], [0.16696320474147797, 0.16536486148834229, 0.16680918633937836, 0.16521230340003967, 0.1666552871465683, 0.16899517178535461], [0.16686108708381653, 0.16581739485263824, 0.16676065325737, 0.16571760177612305, 0.16666029393672943, 0.16818290948867798], [0.16669514775276184, 0.16654321551322937, 0.16668055951595306, 0.1665286421775818, 0.1666659712791443, 0.16688640415668488]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": -0.7}, "agent_episode_returns_mean": {"default_agent": -0.7}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001126769389885458, "timers": {"connectors": {"listify_data_for_vector_env": 1.0404479542795019e-05, "normalize_and_clip_actions": 7.824501587846107e-06, "un_batch_to_individual_items": 6.426153056833101e-06, "get_actions": 3.568602801077431e-05, "remove_single_ts_time_rank_from_batch": 1.1810818773804314e-05, "tensor_to_numpy": 1.5034621311628999e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6478900195225075e-06, "add_time_dim_to_batch_and_zero_pad": 6.662921903841467e-06, "numpy_to_tensor": 1.1897517516558007e-05, "add_observations_from_episodes_to_batch": 2.7317009505625297e-06, "batch_individual_items": 1.2212651595058057e-05}}, "connector_pipeline_timer": 5.770260229739633e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 65400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_step_timer": 1.3669613271837546e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13232144943580318, "num_episodes_lifetime": 260, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_duration_sec_mean": 0.005313584515824914, "rlmodule_inference_timer": 3.061421111816748e-05, "env_reset_timer": 0.0004902036554824951, "num_episodes": 20, "episode_return_mean": -0.7, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.97256415144768}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b7d88_00000", "date": "2025-08-11_18-43-07", "timestamp": 1754930587, "time_this_iter_s": 10.130836963653564, "time_total_s": 128.76493787765503, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 128.76493787765503, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 35.34666666666667, "ram_util_percent": 79.01333333333332}}
{"timers": {"training_iteration": 9.631399890751785, "restore_env_runners": 1.1060037758220867e-05, "training_step": 9.631225435660584, "env_runner_sampling_timer": 1.6948573158492148, "learner_update_timer": 7.746865078566168, "synch_weights": 0.0011039612356278621, "restore_eval_env_runners": 1.4302326465474757e-05, "evaluation_iteration": 0.14265562704694906, "synch_eval_env_connectors": 0.00018402013256339425, "synch_env_connectors": 5.38061185366168e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9216639614727693e-06, "batch_individual_items": 1.3270533803241936e-05, "numpy_to_tensor": 1.3769403492665074e-05, "add_observations_from_episodes_to_batch": 3.0249052350060153e-06, "add_time_dim_to_batch_and_zero_pad": 7.80698957660679e-06}}, "connector_pipeline_timer": 6.418103601867673e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.406076106556613e-05, "remove_single_ts_time_rank_from_batch": 1.2490069538770666e-05, "listify_data_for_vector_env": 1.1274052227371622e-05, "tensor_to_numpy": 1.649800466374793e-05, "normalize_and_clip_actions": 8.665164734583648e-06, "un_batch_to_individual_items": 7.161926769621676e-06}}, "connector_pipeline_timer": 0.00012852400729989954}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005896668989152084, "episode_duration_sec_mean": 0.0057493179575540156, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_len_min": 20, "weights_seq_no": 13.0, "rlmodule_inference_timer": 3.530144471236933e-05, "time_between_sampling": 0.03489731365917494, "env_step_timer": 1.530578622200482e-05, "num_episodes_lifetime": -370000.0, "env_reset_timer": 4.4543100021921515e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -2.1399999999999997, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -7400000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_env_steps_sampled_lifetime_throughput": 3034.53646743797}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15203305123587482, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008639466524800464, "add_observations_from_episodes_to_batch": 0.0008120247334207766, "add_columns_from_episodes_to_train_batch": 0.04106734613228257, "add_time_dim_to_batch_and_zero_pad": 0.09015073578699666, "add_states_from_episodes_to_batch": 0.003755384881143085, "batch_individual_items": 0.007436283545892448, "numpy_to_tensor": 5.858332794010358e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 83790, "entropy": 0.6787505149841309, "policy_loss": -0.0003059091395698488, "total_loss": 0.2483406811952591, "vf_loss_unclipped": 41.14966583251953, "curr_kl_coeff": 9.862300430540927e-06, "mean_kl_loss": 5.424591654445976e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.1405362012929, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205104470252991, "weights_seq_no": 14.0, "vf_explained_var": 2.086162567138672e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 739.4761286166307}, "intrinsic_reward_module": {"weights_seq_no": 14.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.1405362012929, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 83790, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 739.4842743972833}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 167580, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4451.740494855703, "num_module_steps_trained_throughput": 23279775.271133546, "num_module_steps_trained_lifetime_throughput": 13205007.789401649}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 84.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 502740, "module_train_batch_size_mean": 997.501977255973}, "default_policy": {"module_train_batch_size_mean": 997.501977255973, "use_intrinsic_rewards": 1.0, "weights_seq_no": 84.0, "mean_kl_loss": 5.249400783213787e-05, "vf_loss": 0.3205444812774658, "num_module_steps_trained": 35910, "vf_explained_var": 0.0016878247261047363, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "entropy": 0.6787789463996887, "policy_loss": -0.0002992746594827622, "total_loss": 0.24838227033615112, "vf_loss_unclipped": 41.07746505737305}, "__all_modules__": {"num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime_throughput": 51294.22912116073}}}, "IntrinsicAttentionMask": [[[0.16501936316490173, 0.16779939830303192, 0.1649092435836792, 0.1688016951084137, 0.16763146221637726, 0.16583892703056335], [0.16712379455566406, 0.16635173559188843, 0.1671547144651413, 0.1660773754119873, 0.16639789938926697, 0.16689446568489075], [0.16493536531925201, 0.16785703599452972, 0.16481968760490417, 0.16891099512577057, 0.16768047213554382, 0.1657964140176773], [0.16787518560886383, 0.16583351790905, 0.16795729100704193, 0.1651117354631424, 0.16595518589019775, 0.16726714372634888], [0.1669975370168686, 0.1664387583732605, 0.16701990365982056, 0.16624002158641815, 0.1664721965789795, 0.16683164238929749], [0.1656428575515747, 0.16737104952335358, 0.16557417809963226, 0.16799144446849823, 0.16726696491241455, 0.1661534607410431]], [[0.16676056385040283, 0.1664891541004181, 0.166734516620636, 0.16646313667297363, 0.1664501279592514, 0.16710251569747925], [0.16697284579277039, 0.16608548164367676, 0.16688749194145203, 0.1660005897283554, 0.16595815122127533, 0.16809549927711487], [0.1667809933423996, 0.16645045578479767, 0.1667492538690567, 0.16641877591609955, 0.1664029359817505, 0.16719761490821838], [0.1669931262731552, 0.16604670882225037, 0.1669020801782608, 0.16595616936683655, 0.16591092944145203, 0.16819098591804504], [0.16700327396392822, 0.16602730751037598, 0.1669093817472458, 0.16593396663665771, 0.16588731110095978, 0.16823874413967133], [0.16649164259433746, 0.1669958382844925, 0.1665399670600891, 0.1670442819595337, 0.16706852614879608, 0.16585977375507355]], [[0.16520343720912933, 0.16798657178878784, 0.16509319841861725, 0.16787448525428772, 0.16781845688819885, 0.16602391004562378], [0.1670728176832199, 0.16630099713802338, 0.16710373759269714, 0.16633176803588867, 0.16634716093540192, 0.16684356331825256], [0.16512884199619293, 0.16805392503738403, 0.16501303017139435, 0.1679360717535019, 0.1678771674633026, 0.1659908890724182], [0.1669980138540268, 0.166368305683136, 0.16702322661876678, 0.16639341413974762, 0.16640599071979523, 0.1668110340833664], [0.16696061193943024, 0.1664019674062729, 0.1669829785823822, 0.1664242446422577, 0.1664353907108307, 0.1667947620153427], [0.1657572090625763, 0.16748657822608948, 0.16568847000598907, 0.16741713881492615, 0.16738241910934448, 0.16626816987991333]], [[0.16574706137180328, 0.1671142429113388, 0.16704140603542328, 0.16553044319152832, 0.1654582917690277, 0.1691085249185562], [0.1660861074924469, 0.1669505089521408, 0.1669045239686966, 0.16594891250133514, 0.16590319573879242, 0.16820672154426575], [0.16606813669204712, 0.1669592261314392, 0.16691181063652039, 0.1659267097711563, 0.16587959229946136, 0.16825449466705322], [0.1656930297613144, 0.16714021563529968, 0.16706310212612152, 0.16546380519866943, 0.16538745164871216, 0.1692524254322052], [0.16567501425743103, 0.16714885830879211, 0.16707031428813934, 0.1654415726661682, 0.1653638482093811, 0.1693004071712494], [0.1665746122598648, 0.1667119860649109, 0.1667046844959259, 0.16655275225639343, 0.16654546558856964, 0.1669105589389801]], [[0.1658899486064911, 0.16787603497505188, 0.16589893400669098, 0.1672728955745697, 0.16724532842636108, 0.16581694781780243], [0.1687869280576706, 0.1633855402469635, 0.1687619388103485, 0.1650005578994751, 0.16507488489151, 0.16899007558822632], [0.16590313613414764, 0.16785544157028198, 0.1659119725227356, 0.16726261377334595, 0.16723550856113434, 0.16583137214183807], [0.16791152954101562, 0.16473667323589325, 0.16789694130420685, 0.16569043695926666, 0.16573423147201538, 0.16803011298179626], [0.16787144541740417, 0.16479867696762085, 0.1678573340177536, 0.16572198271751404, 0.16576437652111053, 0.1679861843585968], [0.16578266024589539, 0.1680433452129364, 0.16579288244247437, 0.1673564314842224, 0.16732504963874817, 0.16569964587688446]], [[0.1669844090938568, 0.16605781018733978, 0.16601347923278809, 0.16596916317939758, 0.16592486202716827, 0.1690501719713211], [0.1671917885541916, 0.16565005481243134, 0.16557644307613373, 0.1655028760433197, 0.16542932391166687, 0.1706494688987732], [0.1672016680240631, 0.16563042998313904, 0.1655554175376892, 0.16548044979572296, 0.1654055118560791, 0.1707264930009842], [0.16721153259277344, 0.16561082005500793, 0.16553440690040588, 0.16545802354812622, 0.16538168489933014, 0.17080354690551758], [0.16722139716148376, 0.16559118032455444, 0.16551336646080017, 0.1654355823993683, 0.16535785794258118, 0.17088061571121216], [0.16651518642902374, 0.16695043444633484, 0.1669713407754898, 0.16699224710464478, 0.16701316833496094, 0.16555751860141754]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": 0.3}, "agent_episode_returns_mean": {"default_agent": 0.3}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011260621190054026, "timers": {"connectors": {"listify_data_for_vector_env": 1.042535175279468e-05, "normalize_and_clip_actions": 7.883698165816388e-06, "un_batch_to_individual_items": 6.427857692165788e-06, "get_actions": 3.5277170447365445e-05, "remove_single_ts_time_rank_from_batch": 1.1934370873136865e-05, "tensor_to_numpy": 1.5002419602922427e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6468482760493113e-06, "add_time_dim_to_batch_and_zero_pad": 6.721682338229625e-06, "numpy_to_tensor": 1.186478969130375e-05, "add_observations_from_episodes_to_batch": 2.749088599827721e-06, "batch_individual_items": 1.2281748119425085e-05}}, "connector_pipeline_timer": 5.789850006465389e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 70400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_step_timer": 1.3678711983206685e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1321200486918053, "num_episodes_lifetime": 280, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_duration_sec_mean": 0.005272362867835909, "rlmodule_inference_timer": 3.0342510238232492e-05, "env_reset_timer": 0.00048663120879563455, "num_episodes": 20, "episode_return_mean": 0.3, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.961445402852837}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b7d88_00000", "date": "2025-08-11_18-43-17", "timestamp": 1754930597, "time_this_iter_s": 9.958089828491211, "time_total_s": 138.72302770614624, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 138.72302770614624, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.77857142857143, "ram_util_percent": 79.25}}
{"timers": {"training_iteration": 9.632719260593205, "restore_env_runners": 1.1007357495707213e-05, "training_step": 9.632544477554015, "env_runner_sampling_timer": 1.69426758019117, "learner_update_timer": 7.747647393190186, "synch_weights": 0.0011022674534569225, "restore_eval_env_runners": 1.4366382775285761e-05, "evaluation_iteration": 0.14241374286577316, "synch_eval_env_connectors": 0.00018329743217996073, "synch_env_connectors": 5.3693054766644215e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9031574971983466e-06, "batch_individual_items": 1.3084496309619188e-05, "numpy_to_tensor": 1.3473176204175235e-05, "add_observations_from_episodes_to_batch": 2.9372469793980325e-06, "add_time_dim_to_batch_and_zero_pad": 7.537896011816428e-06}}, "connector_pipeline_timer": 6.299862115155286e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -2.6999999999999993}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.293563123072281e-05, "remove_single_ts_time_rank_from_batch": 1.2324990144092042e-05, "listify_data_for_vector_env": 1.1015259825630606e-05, "tensor_to_numpy": 1.622557915527775e-05, "normalize_and_clip_actions": 8.51873132370956e-06, "un_batch_to_individual_items": 6.9744181485434215e-06}}, "connector_pipeline_timer": 0.00012593391348008064}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006108796250031455, "episode_duration_sec_mean": 0.00560134867532179, "agent_episode_returns_mean": {"default_agent": -2.6999999999999993}, "episode_len_min": 20, "weights_seq_no": 14.0, "rlmodule_inference_timer": 3.4274246085926346e-05, "time_between_sampling": 0.033538480397685505, "env_step_timer": 1.4898639576236917e-05, "num_episodes_lifetime": -400875.0, "env_reset_timer": 4.982740957345719e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -2.6999999999999993, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -8017500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_env_steps_sampled_lifetime_throughput": 3053.0319514910343}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15303921822330052, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008641448530162618, "add_observations_from_episodes_to_batch": 0.000813117815845064, "add_columns_from_episodes_to_train_batch": 0.04193766017117283, "add_time_dim_to_batch_and_zero_pad": 0.09023807509949724, "add_states_from_episodes_to_batch": 0.003773812691429251, "batch_individual_items": 0.007460845710490147, "numpy_to_tensor": 6.069457456880529e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 89775, "entropy": 0.6782689094543457, "policy_loss": 1.1291182090644725e-05, "total_loss": 0.2486581802368164, "vf_loss_unclipped": 43.095890045166016, "curr_kl_coeff": 4.931150215270463e-06, "mean_kl_loss": 7.734012797300238e-06, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.1026110140886, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205099105834961, "weights_seq_no": 15.0, "vf_explained_var": 9.620189666748047e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 737.4387794041727}, "intrinsic_reward_module": {"weights_seq_no": 15.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.1026110140886, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 89775, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 737.4464625700091}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 179550, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 540000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4439.338655412278, "num_module_steps_trained_throughput": 22724896.24812825, "num_module_steps_trained_lifetime_throughput": 13169375.277545223}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 90.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 538650, "module_train_batch_size_mean": 997.499088644618}, "default_policy": {"module_train_batch_size_mean": 997.499088644618, "use_intrinsic_rewards": 1.0, "weights_seq_no": 90.0, "mean_kl_loss": 7.948344318720046e-06, "vf_loss": 0.32054126262664795, "num_module_steps_trained": 35910, "vf_explained_var": 0.0016432404518127441, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "entropy": 0.6782589554786682, "policy_loss": 1.204365889861947e-05, "total_loss": 0.24868467450141907, "vf_loss_unclipped": 43.00872039794922}, "__all_modules__": {"num_env_steps_trained_lifetime": 3240000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime_throughput": 50473.23498881509}}}, "IntrinsicAttentionMask": [[[0.16465216875076294, 0.16853855550289154, 0.16563566029071808, 0.16842609643936157, 0.16836988925933838, 0.1643776297569275], [0.16824814677238464, 0.1652008593082428, 0.1674649566411972, 0.16528728604316711, 0.16533051431179047, 0.16846826672554016], [0.1655687391757965, 0.16768620908260345, 0.166106715798378, 0.16762524843215942, 0.167594775557518, 0.16541829705238342], [0.1681450605392456, 0.16529631614685059, 0.16741320490837097, 0.16537714004516602, 0.16541758179664612, 0.1683507114648819], [0.1680935174226761, 0.1653440147638321, 0.16738730669021606, 0.16542206704616547, 0.16546109318733215, 0.16829192638397217], [0.1643955260515213, 0.16877742111682892, 0.16550317406654358, 0.16865043342113495, 0.16858696937561035, 0.1640864759683609]], [[0.16526688635349274, 0.16519485414028168, 0.16655747592449188, 0.16648489236831665, 0.1664123237133026, 0.17008361220359802], [0.16523948311805725, 0.16516606509685516, 0.16655518114566803, 0.1664811670780182, 0.16640718281269073, 0.17015087604522705], [0.1657552272081375, 0.16570815443992615, 0.16659732162952423, 0.16655001044273376, 0.16650272905826569, 0.16888654232025146], [0.1657278686761856, 0.16567939519882202, 0.16659513115882874, 0.16654640436172485, 0.16649769246578217, 0.16895344853401184], [0.1657005250453949, 0.1656506508588791, 0.16659295558929443, 0.16654281318187714, 0.16649268567562103, 0.1690203994512558], [0.16706806421279907, 0.16708898544311523, 0.16669513285160065, 0.16671600937843323, 0.166736900806427, 0.165694922208786]], [[0.16483542323112488, 0.1687261313199997, 0.16582001745700836, 0.16750051081180573, 0.168557271361351, 0.16456058621406555], [0.16810360550880432, 0.1650589257478714, 0.1673210710287094, 0.16600441932678223, 0.16518846154212952, 0.16832353174686432], [0.16566874086856842, 0.16778749227523804, 0.16620704531669617, 0.167122483253479, 0.1676959991455078, 0.16551820933818817], [0.16708122193813324, 0.1662020981311798, 0.16685634851455688, 0.1664763242006302, 0.16623972356319427, 0.1671442836523056], [0.16796311736106873, 0.16521577537059784, 0.16725747287273407, 0.16606946289539337, 0.16533274948596954, 0.16816139221191406], [0.16460204124450684, 0.16898944973945618, 0.16571108996868134, 0.16760596632957458, 0.1687987595796585, 0.1642926037311554]], [[0.16574200987815857, 0.1671091616153717, 0.1655975729227066, 0.1655253916978836, 0.1654532551765442, 0.17057259380817413], [0.16608409583568573, 0.16694848239421844, 0.1659926176071167, 0.16594688594341278, 0.16590118408203125, 0.1691266894340515], [0.1657055765390396, 0.16712605953216553, 0.16555553674697876, 0.16548055410385132, 0.16540561616420746, 0.17072661221027374], [0.16568736732006073, 0.16713449358940125, 0.16553451120853424, 0.16545812785625458, 0.1653817892074585, 0.17080366611480713], [0.16566912829875946, 0.16714291274547577, 0.16551347076892853, 0.16543570160865784, 0.16535796225070953, 0.1708807349205017], [0.16692955791950226, 0.16653607785701752, 0.1669713705778122, 0.16699227690696716, 0.16701319813728333, 0.16555754840373993]], [[0.1650192141532898, 0.16891427338123322, 0.16490910947322845, 0.1676872819662094, 0.1676313281059265, 0.16583877801895142], [0.16795939207077026, 0.16491732001304626, 0.1680472493171692, 0.16586200892925262, 0.16590538620948792, 0.1673087328672409], [0.16493523120880127, 0.16902941465377808, 0.16481956839561462, 0.16773918271064758, 0.16768035292625427, 0.16579627990722656], [0.16703961789608002, 0.1661607027053833, 0.16706483066082, 0.1664348542690277, 0.16644743084907532, 0.16685257852077484], [0.1669975221157074, 0.16621774435043335, 0.16701988875865936, 0.1664610356092453, 0.1664721816778183, 0.1668316274881363], [0.16564281284809113, 0.16806109249591827, 0.16557413339614868, 0.16730161011219025, 0.16726692020893097, 0.1661534309387207]], [[0.1664176881313324, 0.16637656092643738, 0.16633544862270355, 0.16629436612129211, 0.16625326871871948, 0.16832265257835388], [0.16640906035900116, 0.16636651754379272, 0.16632398962974548, 0.16628147661685944, 0.16623897850513458, 0.16837994754314423], [0.16640041768550873, 0.16635647416114807, 0.16631253063678741, 0.16626860201358795, 0.16622468829154968, 0.16843725740909576], [0.1663917899131775, 0.16634641587734222, 0.16630107164382935, 0.16625572741031647, 0.16621039807796478, 0.1684945821762085], [0.16638313233852386, 0.16633635759353638, 0.16628959774971008, 0.1662428379058838, 0.16619610786437988, 0.16855192184448242], [0.16681146621704102, 0.16683565080165863, 0.16685986518859863, 0.16688406467437744, 0.16690827906131744, 0.16570067405700684]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": 1.9}, "agent_episode_returns_mean": {"default_agent": 1.9}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011255208564980657, "timers": {"connectors": {"listify_data_for_vector_env": 1.0373301519829846e-05, "normalize_and_clip_actions": 7.809533643342178e-06, "un_batch_to_individual_items": 6.489255315792834e-06, "get_actions": 3.5356827674786304e-05, "remove_single_ts_time_rank_from_batch": 1.1837495625038779e-05, "tensor_to_numpy": 1.501936872163438e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6417012020686465e-06, "add_time_dim_to_batch_and_zero_pad": 6.631481443768159e-06, "numpy_to_tensor": 1.1871031006708183e-05, "add_observations_from_episodes_to_batch": 2.7167912788567928e-06, "batch_individual_items": 1.2208532284541536e-05}}, "connector_pipeline_timer": 5.7612280002067095e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 75400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_step_timer": 1.3607343216882005e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13191532653511012, "num_episodes_lifetime": 300, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_duration_sec_mean": 0.0052687737508676944, "rlmodule_inference_timer": 3.059367118545555e-05, "env_reset_timer": 0.00048258905665024554, "num_episodes": 20, "episode_return_mean": 1.9, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.949731487573835}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b7d88_00000", "date": "2025-08-11_18-43-27", "timestamp": 1754930607, "time_this_iter_s": 9.883381128311157, "time_total_s": 148.6064088344574, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 148.6064088344574, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.63571428571429, "ram_util_percent": 79.60714285714286}}
{"timers": {"training_iteration": 9.631483359236539, "restore_env_runners": 1.0960613855823992e-05, "training_step": 9.631308095688302, "env_runner_sampling_timer": 1.6928125589685958, "learner_update_timer": 7.747733426757526, "synch_weights": 0.0011012264486407529, "restore_eval_env_runners": 1.4278548243421447e-05, "evaluation_iteration": 0.14215944751709572, "synch_eval_env_connectors": 0.00018248903841878574, "synch_env_connectors": 5.354362425921091e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.747399558350047e-06, "batch_individual_items": 1.2493898515044765e-05, "numpy_to_tensor": 1.2653423608323402e-05, "add_observations_from_episodes_to_batch": 2.7999796060324695e-06, "add_time_dim_to_batch_and_zero_pad": 7.193268758968294e-06}}, "connector_pipeline_timer": 6.0124800947875104e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -0.86}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9777104687401504e-05, "remove_single_ts_time_rank_from_batch": 1.191526439473764e-05, "listify_data_for_vector_env": 1.0661103568348935e-05, "tensor_to_numpy": 1.5459092510976346e-05, "normalize_and_clip_actions": 8.089363272973672e-06, "un_batch_to_individual_items": 6.728468515711593e-06}}, "connector_pipeline_timer": 0.00011945771917069178}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005831232231176665, "episode_duration_sec_mean": 0.0053221958307549345, "agent_episode_returns_mean": {"default_agent": -0.86}, "episode_len_min": 20, "weights_seq_no": 15.0, "rlmodule_inference_timer": 3.229902146390802e-05, "time_between_sampling": 0.033552409469930385, "env_step_timer": 1.3940520973496402e-05, "num_episodes_lifetime": -431750.0, "env_reset_timer": 4.4489924153425864e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -0.86, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -8635000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_env_steps_sampled_lifetime_throughput": 3211.3444172148616}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15304965312167493, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008644012794560882, "add_observations_from_episodes_to_batch": 0.0008132178877901764, "add_columns_from_episodes_to_train_batch": 0.041936821488637845, "add_time_dim_to_batch_and_zero_pad": 0.09022726559831512, "add_states_from_episodes_to_batch": 0.003790155394237765, "batch_individual_items": 0.00746347767389065, "numpy_to_tensor": 6.0751378929586034e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 95760, "entropy": 0.6771852970123291, "policy_loss": -0.00018590412219054997, "total_loss": 0.24846269190311432, "vf_loss_unclipped": 41.15011978149414, "curr_kl_coeff": 2.4655751076352317e-06, "mean_kl_loss": 1.3025039152125828e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.0669052031734, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205099105834961, "weights_seq_no": 16.0, "vf_explained_var": -2.0742416381835938e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 735.5945012399496}, "intrinsic_reward_module": {"weights_seq_no": 16.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.0669052031734, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 95760, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 735.6017509963254}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 191520, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 576000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4428.104013780596, "num_module_steps_trained_throughput": 22187840.580424685, "num_module_steps_trained_lifetime_throughput": 13125251.608510436}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 96.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 574560, "module_train_batch_size_mean": 997.4970769774884}, "default_policy": {"module_train_batch_size_mean": 997.4970769774884, "use_intrinsic_rewards": 1.0, "weights_seq_no": 96.0, "mean_kl_loss": 1.1862783139804378e-05, "vf_loss": 0.32053399085998535, "num_module_steps_trained": 35910, "vf_explained_var": 0.00168609619140625, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "entropy": 0.6772261261940002, "policy_loss": -0.00017808761913329363, "total_loss": 0.2484910935163498, "vf_loss_unclipped": 41.07569885253906}, "__all_modules__": {"num_env_steps_trained_lifetime": 3456000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime_throughput": 49700.07917164911}}}, "IntrinsicAttentionMask": [[[0.16570916771888733, 0.16714568436145782, 0.16626086831092834, 0.16763783991336823, 0.16761022806167603, 0.16563624143600464], [0.1683044135570526, 0.16584233939647675, 0.16735200583934784, 0.165011927485466, 0.16505835950374603, 0.16843093931674957], [0.16670742630958557, 0.16664622724056244, 0.1666838526725769, 0.16662538051605225, 0.16662655770778656, 0.16671054065227509], [0.16919051110744476, 0.16539369523525238, 0.16771821677684784, 0.16411994397640228, 0.16419106721878052, 0.16938644647598267], [0.16914083063602448, 0.16541892290115356, 0.16769778728485107, 0.16416992247104645, 0.16423965990543365, 0.1693328619003296], [0.16557708382606506, 0.1672115921974182, 0.16620460152626038, 0.16777202486991882, 0.1677405685186386, 0.1654941439628601]], [[0.16683734953403473, 0.16591157019138336, 0.16586728394031525, 0.16670379042625427, 0.1657787561416626, 0.16890130937099457], [0.16694702208042145, 0.16540753841400146, 0.1653340458869934, 0.1667245775461197, 0.16518713533878326, 0.17039965093135834], [0.1669522076845169, 0.16538330912590027, 0.16530841588974, 0.16672548651695251, 0.1651587337255478, 0.17047178745269775], [0.16685330867767334, 0.16583910584449768, 0.1657905876636505, 0.16670694947242737, 0.16569364070892334, 0.1691163182258606], [0.16696256399154663, 0.16533486545085907, 0.16525717079639435, 0.16672730445861816, 0.16510191559791565, 0.17061613500118256], [0.16658423840999603, 0.16701966524124146, 0.16704058647155762, 0.16664685308933258, 0.16708242893218994, 0.1656261682510376]], [[0.16598089039325714, 0.16741976141929626, 0.16598987579345703, 0.16736459732055664, 0.16733703017234802, 0.1659078449010849], [0.16783706843852997, 0.16538181900978088, 0.16782154142856598, 0.16547489166259766, 0.16552144289016724, 0.16796323657035828], [0.16599254310131073, 0.16740697622299194, 0.16600137948989868, 0.16735275089740753, 0.16732566058635712, 0.16592073440551758], [0.16776622831821442, 0.16545957326889038, 0.16775165498256683, 0.16554704308509827, 0.1655908077955246, 0.1678847074508667], [0.16773079335689545, 0.16549843549728394, 0.16771669685840607, 0.16558310389518738, 0.1656254678964615, 0.16784542798995972], [0.16588620841503143, 0.16752377152442932, 0.1658964306116104, 0.16746094822883606, 0.16742955148220062, 0.16580313444137573]], [[0.16683734953403473, 0.16591157019138336, 0.16586728394031525, 0.16670379042625427, 0.1657787561416626, 0.16890130937099457], [0.16694703698158264, 0.16540755331516266, 0.1653340607881546, 0.16672459244728088, 0.16518715023994446, 0.17039966583251953], [0.1669522076845169, 0.16538330912590027, 0.16530841588974, 0.16672548651695251, 0.1651587337255478, 0.17047178745269775], [0.16685330867767334, 0.16583910584449768, 0.1657905876636505, 0.16670694947242737, 0.16569364070892334, 0.1691163182258606], [0.16696256399154663, 0.16533488035202026, 0.16525718569755554, 0.16672731935977936, 0.16510193049907684, 0.17061614990234375], [0.16658425331115723, 0.16701968014240265, 0.1670406013727188, 0.16664686799049377, 0.16708244383335114, 0.1656261682510376]], [[0.16588996350765228, 0.16732804477214813, 0.16589893400669098, 0.1678207367658615, 0.16724534332752228, 0.16581694781780243], [0.16799181699752808, 0.16553430259227753, 0.1679762750864029, 0.16470544040203094, 0.16567406058311462, 0.16811810433864594], [0.16590315103530884, 0.16731680929660797, 0.1659119874238968, 0.16780109703540802, 0.16723552346229553, 0.16583137214183807], [0.168707013130188, 0.16492106020450592, 0.1686829924583435, 0.16365094482898712, 0.16513556241989136, 0.16890239715576172], [0.16787151992321014, 0.1656372994184494, 0.16785740852355957, 0.1648830622434616, 0.1657644361257553, 0.16798625886440277], [0.16578269004821777, 0.16741923987865448, 0.16579291224479675, 0.1679803729057312, 0.16732507944107056, 0.16569966077804565]], [[0.16669057309627533, 0.16576561331748962, 0.1657213568687439, 0.16655713319778442, 0.16651266813278198, 0.16875271499156952], [0.16670310497283936, 0.16516585648059845, 0.16509246826171875, 0.16648095846176147, 0.16640698909759521, 0.17015068233013153], [0.16670361161231995, 0.16513706743717194, 0.16506227850914001, 0.166477233171463, 0.16640183329582214, 0.17021796107292175], [0.16669254004955292, 0.16567932069301605, 0.16563086211681366, 0.16654632985591888, 0.1664976179599762, 0.16895337402820587], [0.16669316589832306, 0.16565054655075073, 0.16560068726539612, 0.16654269397258759, 0.16649258136749268, 0.16902029514312744], [0.1666533648967743, 0.16708897054195404, 0.1671098917722702, 0.16671599447727203, 0.16673687100410461, 0.16569487750530243]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": 1.9}, "agent_episode_returns_mean": {"default_agent": 1.9}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011312884852541254, "timers": {"connectors": {"listify_data_for_vector_env": 1.0501138412477817e-05, "normalize_and_clip_actions": 7.891448315100788e-06, "un_batch_to_individual_items": 6.492645605770499e-06, "get_actions": 3.5622790442895354e-05, "remove_single_ts_time_rank_from_batch": 1.1915413657106405e-05, "tensor_to_numpy": 1.5134408023544437e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6567381297294216e-06, "add_time_dim_to_batch_and_zero_pad": 6.854216412775537e-06, "numpy_to_tensor": 1.2140796448830138e-05, "add_observations_from_episodes_to_batch": 2.7361597889438607e-06, "batch_individual_items": 1.2420727636273979e-05}}, "connector_pipeline_timer": 5.841672765634278e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 80400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_step_timer": 1.378669085586194e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1317271974301814, "num_episodes_lifetime": 320, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_duration_sec_mean": 0.005163530033314601, "rlmodule_inference_timer": 3.113942626904503e-05, "env_reset_timer": 0.0004790306658398111, "num_episodes": 20, "episode_return_mean": 1.9, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.935556663948796}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b7d88_00000", "date": "2025-08-11_18-43-37", "timestamp": 1754930617, "time_this_iter_s": 9.631846189498901, "time_total_s": 158.2382550239563, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 158.2382550239563, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.58571428571429, "ram_util_percent": 80.34285714285714}}
{"timers": {"training_iteration": 9.630854052314595, "restore_env_runners": 1.0916847566678193e-05, "training_step": 9.630678483070687, "env_runner_sampling_timer": 1.6913234283781862, "learner_update_timer": 7.74848623165956, "synch_weights": 0.0011000066847955423, "restore_eval_env_runners": 1.4340763157805156e-05, "evaluation_iteration": 0.14193334887254075, "synch_eval_env_connectors": 0.00018190914703726315, "synch_env_connectors": 5.341228888174446e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.746658292612257e-06, "batch_individual_items": 1.2411654199151023e-05, "numpy_to_tensor": 1.2471981751772603e-05, "add_observations_from_episodes_to_batch": 2.8031691004183143e-06, "add_time_dim_to_batch_and_zero_pad": 7.1284651868487145e-06}}, "connector_pipeline_timer": 5.978332657034201e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.943185094371198e-05, "remove_single_ts_time_rank_from_batch": 1.1929781879423621e-05, "listify_data_for_vector_env": 1.0557598645176483e-05, "tensor_to_numpy": 1.5374657995068648e-05, "normalize_and_clip_actions": 8.043028203527129e-06, "un_batch_to_individual_items": 6.728511115183107e-06}}, "connector_pipeline_timer": 0.00011887796466577031}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005669428117266825, "episode_duration_sec_mean": 0.005304895836394278, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_len_min": 20, "weights_seq_no": 16.0, "rlmodule_inference_timer": 3.20896945217118e-05, "time_between_sampling": 0.03294887940475615, "env_step_timer": 1.3873628578538052e-05, "num_episodes_lifetime": -462625.0, "env_reset_timer": 4.133482769345673e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -2.1399999999999997, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -9252500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_env_steps_sampled_lifetime_throughput": 3240.5484004916875}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15304491159122455, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008647156416265319, "add_observations_from_episodes_to_batch": 0.000813416548831201, "add_columns_from_episodes_to_train_batch": 0.04193764702392991, "add_time_dim_to_batch_and_zero_pad": 0.09021915002207892, "add_states_from_episodes_to_batch": 0.0037899780099650603, "batch_individual_items": 0.0074628345571804405, "numpy_to_tensor": 6.0785945698754104e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 101745, "entropy": 0.6758009791374207, "policy_loss": -0.0002421407261863351, "total_loss": 0.24840891361236572, "vf_loss_unclipped": 39.52684020996094, "curr_kl_coeff": 1.2327875538176158e-06, "mean_kl_loss": 2.2241603801376186e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.0332888909784, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205103278160095, "weights_seq_no": 17.0, "vf_explained_var": -5.340576171875e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 733.765702624291}, "intrinsic_reward_module": {"weights_seq_no": 17.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.0332888909784, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 101745, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 733.7725402131713}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 203490, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 612000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4416.968491654573, "num_module_steps_trained_throughput": 21684164.67003797, "num_module_steps_trained_lifetime_throughput": 13090689.793215651}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 102.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 610470, "module_train_batch_size_mean": 997.4956760259092}, "default_policy": {"module_train_batch_size_mean": 997.4956760259092, "use_intrinsic_rewards": 1.0, "weights_seq_no": 102.0, "mean_kl_loss": 2.0717998268082738e-05, "vf_loss": 0.3205282390117645, "num_module_steps_trained": 35910, "vf_explained_var": 0.0017020106315612793, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "entropy": 0.6758438348770142, "policy_loss": -0.00023404053354170173, "total_loss": 0.24843426048755646, "vf_loss_unclipped": 39.46611022949219}, "__all_modules__": {"num_env_steps_trained_lifetime": 3672000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime_throughput": 48972.40230745083}}}, "IntrinsicAttentionMask": [[[0.16579990088939667, 0.16723722219467163, 0.16580888628959656, 0.16772964596748352, 0.16715456545352936, 0.1662697196006775], [0.1681491881608963, 0.1656893789768219, 0.16813364624977112, 0.16485972702503204, 0.16582927107810974, 0.16733883321285248], [0.16581463813781738, 0.16722755134105682, 0.16582345962524414, 0.16771157085895538, 0.16714631021022797, 0.1662764847278595], [0.16895133256912231, 0.16515988111495972, 0.16892728209495544, 0.16388793289661407, 0.16537469625473022, 0.1676989495754242], [0.16801440715789795, 0.1657782793045044, 0.16800028085708618, 0.16502340137958527, 0.16590552031993866, 0.16727808117866516], [0.16656909883022308, 0.16673092544078827, 0.16657011210918427, 0.1667860895395279, 0.1667216569185257, 0.166622132062912]], [[0.16550935804843903, 0.1654372215270996, 0.16680185496807098, 0.1667291522026062, 0.1666564792394638, 0.16886600852012634], [0.16548675298690796, 0.16541321575641632, 0.16680440306663513, 0.16673028469085693, 0.16665619611740112, 0.16890917718410492], [0.1659126877784729, 0.16586557030677795, 0.1667555719614029, 0.16670821607112885, 0.16666088998317719, 0.16809700429439545], [0.16589009761810303, 0.16584157943725586, 0.1667582094669342, 0.16670943796634674, 0.16666068136692047, 0.16814005374908447], [0.16586747765541077, 0.16581755876541138, 0.16676080226898193, 0.16671061515808105, 0.16666044294834137, 0.1681830734014511], [0.16655050218105316, 0.16654323041439056, 0.16668055951595306, 0.16667327284812927, 0.16666598618030548, 0.16688640415668488]], [[0.16501618921756744, 0.16779617965221405, 0.1649060696363449, 0.16879846155643463, 0.1687421351671219, 0.16474103927612305], [0.16712354123592377, 0.16635148227214813, 0.1671544760465622, 0.16607710719108582, 0.16609247028827667, 0.16720086336135864], [0.16493187844753265, 0.1678534895181656, 0.16481620073318481, 0.16890743374824524, 0.1688482016324997, 0.1646428406238556], [0.16787348687648773, 0.1658318042755127, 0.16795557737350464, 0.1651100218296051, 0.16515038907527924, 0.16807879507541656], [0.16783146560192108, 0.16586098074913025, 0.16791068017482758, 0.16516417264938354, 0.16520313918590546, 0.1680295765399933], [0.16480539739131927, 0.16793937981128693, 0.16468138992786407, 0.16907092928886414, 0.1690073162317276, 0.1644955724477768]], [[0.1659860908985138, 0.16591374576091766, 0.16584143042564392, 0.16720940172672272, 0.1656969040632248, 0.1693524271249771], [0.1659727245569229, 0.16589896380901337, 0.1658252477645874, 0.16721990704536438, 0.16567791998386383, 0.16940520703792572], [0.16595935821533203, 0.16588419675827026, 0.16580908000469208, 0.16723044216632843, 0.16565893590450287, 0.16945801675319672], [0.1662108302116394, 0.16616220772266388, 0.16611362993717194, 0.16703176498413086, 0.16601647436618805, 0.16846513748168945], [0.16593261063098907, 0.16585463285446167, 0.16577669978141785, 0.16725145280361176, 0.16562093794345856, 0.1695636510848999], [0.16659870743751526, 0.16659142076969147, 0.16658413410186768, 0.16672150790691376, 0.1665695607662201, 0.16693469882011414]], [[0.1650160551071167, 0.16891103982925415, 0.16490593552589417, 0.16768407821655273, 0.16874200105667114, 0.1647409051656723], [0.16795741021633148, 0.16491536796092987, 0.1680452674627304, 0.16586002707481384, 0.16504478454589844, 0.16817714273929596], [0.16493172943592072, 0.16902583837509155, 0.16481606662273407, 0.16773563623428345, 0.16884805262088776, 0.16464270651340485], [0.16703945398330688, 0.16616052389144897, 0.16706466674804688, 0.16643469035625458, 0.16619814932346344, 0.16710250079631805], [0.1678314059972763, 0.16508619487285614, 0.1679106205701828, 0.16593921184539795, 0.16520307958126068, 0.1680295169353485], [0.16480523347854614, 0.16919808089733124, 0.16468124091625214, 0.16781288385391235, 0.16900716722011566, 0.16449542343616486]], [[0.16683930158615112, 0.16591350734233856, 0.16586922109127045, 0.16670574247837067, 0.16666124761104584, 0.1680108904838562], [0.16695252060890198, 0.1654129922389984, 0.16533948481082916, 0.16673006117343903, 0.16665597259998322, 0.168908953666687], [0.16695791482925415, 0.16538897156715393, 0.16531407833099365, 0.16673119366168976, 0.16665568947792053, 0.1689521223306656], [0.16685569286346436, 0.1658414751291275, 0.16579297184944153, 0.16670933365821838, 0.16666057705879211, 0.16813994944095612], [0.1668611466884613, 0.1658174693584442, 0.16576755046844482, 0.1667105257511139, 0.1666603535413742, 0.16818298399448395], [0.16669514775276184, 0.16654323041439056, 0.16653594374656677, 0.16667327284812927, 0.16666598618030548, 0.16688640415668488]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": 0.5}, "agent_episode_returns_mean": {"default_agent": 0.5}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001152406834436597, "timers": {"connectors": {"listify_data_for_vector_env": 1.0631917995653039e-05, "normalize_and_clip_actions": 7.999944892680029e-06, "un_batch_to_individual_items": 6.59559111098407e-06, "get_actions": 3.650410694532244e-05, "remove_single_ts_time_rank_from_batch": 1.2058198166789986e-05, "tensor_to_numpy": 1.5502269820567065e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.660966844904814e-06, "add_time_dim_to_batch_and_zero_pad": 6.715794437287373e-06, "numpy_to_tensor": 1.2141274702056244e-05, "add_observations_from_episodes_to_batch": 2.735712540072665e-06, "batch_individual_items": 1.2292973605207257e-05}}, "connector_pipeline_timer": 5.828493108911128e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 85400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_step_timer": 1.3989573633491583e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13154872337630968, "num_episodes_lifetime": 340, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_duration_sec_mean": 0.005171476701507345, "rlmodule_inference_timer": 3.153636804380053e-05, "env_reset_timer": 0.0004751028593460708, "num_episodes": 20, "episode_return_mean": 0.5, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.92215077897948}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b7d88_00000", "date": "2025-08-11_18-43-46", "timestamp": 1754930626, "time_this_iter_s": 9.690744161605835, "time_total_s": 167.92899918556213, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 167.92899918556213, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 37.857142857142854, "ram_util_percent": 80.18571428571428}}
{"timers": {"training_iteration": 9.629265475541551, "restore_env_runners": 1.0864769164835339e-05, "training_step": 9.629089743239733, "env_runner_sampling_timer": 1.6898989082650464, "learner_update_timer": 7.748192624753399, "synch_weights": 0.0010999724488268726, "restore_eval_env_runners": 1.426277511632775e-05, "evaluation_iteration": 0.14170554746364425, "synch_eval_env_connectors": 0.0001809917155175045, "synch_env_connectors": 5.3311463820766865e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7285356693289693e-06, "batch_individual_items": 1.248492479795993e-05, "numpy_to_tensor": 1.2718297470894326e-05, "add_observations_from_episodes_to_batch": 2.7995430514180663e-06, "add_time_dim_to_batch_and_zero_pad": 7.203530552565987e-06}}, "connector_pipeline_timer": 6.020498158359005e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9604355844502074e-05, "remove_single_ts_time_rank_from_batch": 1.194123015122832e-05, "listify_data_for_vector_env": 1.0641633213481271e-05, "tensor_to_numpy": 1.5394849320151543e-05, "normalize_and_clip_actions": 8.088542346532585e-06, "un_batch_to_individual_items": 6.715238736549295e-06}}, "connector_pipeline_timer": 0.00011920270284215836}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005700900431166593, "episode_duration_sec_mean": 0.005319199506193402, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "episode_len_min": 20, "weights_seq_no": 17.0, "rlmodule_inference_timer": 3.2158270785720716e-05, "time_between_sampling": 0.0331278641020959, "env_step_timer": 1.3929583177542497e-05, "num_episodes_lifetime": -493500.0, "env_reset_timer": 4.176095249333452e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.1800000000000002, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -9870000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_env_steps_sampled_lifetime_throughput": 3216.1786969996165}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15303103872632737, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008648179852437122, "add_observations_from_episodes_to_batch": 0.0008145640535519095, "add_columns_from_episodes_to_train_batch": 0.04193528472436149, "add_time_dim_to_batch_and_zero_pad": 0.09020491394204301, "add_states_from_episodes_to_batch": 0.003789685310168542, "batch_individual_items": 0.007463682880616548, "numpy_to_tensor": 6.091100684000527e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 107730, "entropy": 0.6748462319374084, "policy_loss": -0.00022652379993814975, "total_loss": 0.24842597544193268, "vf_loss_unclipped": 42.28386306762695, "curr_kl_coeff": 6.163937769088079e-07, "mean_kl_loss": 2.3334245270234533e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.0016398003509, "use_intrinsic_rewards": 0.0, "vf_loss": 0.32051029801368713, "weights_seq_no": 18.0, "vf_explained_var": 9.149312973022461e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 732.1753306304553}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.0016398003509, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 107730, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 732.1817718621055}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 215460, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 648000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4407.272969862316, "num_module_steps_trained_throughput": 21212352.31622984, "num_module_steps_trained_lifetime_throughput": 13062718.251080206}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 108.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 646380, "module_train_batch_size_mean": 997.4947003847115}, "default_policy": {"module_train_batch_size_mean": 997.4947003847115, "use_intrinsic_rewards": 1.0, "weights_seq_no": 108.0, "mean_kl_loss": 2.2022992197889835e-05, "vf_loss": 0.32052916288375854, "num_module_steps_trained": 35910, "vf_explained_var": 0.001647651195526123, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "entropy": 0.6748833656311035, "policy_loss": -0.00022055328008718789, "total_loss": 0.2484501600265503, "vf_loss_unclipped": 42.20082473754883}, "__all_modules__": {"num_env_steps_trained_lifetime": 3888000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime_throughput": 48283.89672663796}}}, "IntrinsicAttentionMask": [[[0.1658899486064911, 0.16732804477214813, 0.16589893400669098, 0.1678207367658615, 0.16724534332752228, 0.16581694781780243], [0.16799181699752808, 0.16553430259227753, 0.1679762750864029, 0.16470542550086975, 0.16567406058311462, 0.16811810433864594], [0.16590315103530884, 0.16731682419776917, 0.1659119874238968, 0.1678011119365692, 0.16723553836345673, 0.16583138704299927], [0.168707013130188, 0.16492104530334473, 0.1686829924583435, 0.16365092992782593, 0.16513554751873016, 0.16890239715576172], [0.16787153482437134, 0.1656372994184494, 0.16785742342472076, 0.1648830622434616, 0.1657644361257553, 0.16798627376556396], [0.16578269004821777, 0.16741923987865448, 0.16579289734363556, 0.1679803729057312, 0.16732507944107056, 0.16569966077804565]], [[0.16622550785541534, 0.16615305840969086, 0.16608063876628876, 0.16600826382637024, 0.16593590378761292, 0.16959670186042786], [0.16621679067611694, 0.16614292562007904, 0.16606910526752472, 0.16599531471729279, 0.16592153906822205, 0.16965432465076447], [0.16620807349681854, 0.16613280773162842, 0.16605757176876068, 0.16598236560821533, 0.16590720415115356, 0.16971197724342346], [0.16619937121868134, 0.1661226898431778, 0.16604603826999664, 0.16596943140029907, 0.1658928543329239, 0.16976965963840485], [0.16619063913822174, 0.16611255705356598, 0.1660345047712326, 0.16595648229122162, 0.16587848961353302, 0.16982734203338623], [0.1666228026151657, 0.16661551594734192, 0.16660822927951813, 0.16660092771053314, 0.16659364104270935, 0.16695883870124817]], [[0.16501903533935547, 0.1689140945672989, 0.1660047322511673, 0.16768710315227509, 0.1676311492919922, 0.16474388539791107], [0.16795925796031952, 0.16491718590259552, 0.16717740893363953, 0.16586187481880188, 0.16590525209903717, 0.1681790053844452], [0.16576886177062988, 0.16788890957832336, 0.1663074940443039, 0.1672234982252121, 0.16719309985637665, 0.16561824083328247], [0.16703960299491882, 0.1661606729030609, 0.16681478917598724, 0.16643483936786652, 0.16644740104675293, 0.16710264980793], [0.1669975221157074, 0.16621772944927216, 0.16679811477661133, 0.1664610207080841, 0.1664721816778183, 0.1670534461736679], [0.16480903327465057, 0.16920197010040283, 0.1659194827079773, 0.16781674325466156, 0.16775360703468323, 0.1644991934299469]], [[0.16574200987815857, 0.1671091616153717, 0.1655975729227066, 0.1655253916978836, 0.1654532551765442, 0.17057260870933533], [0.16608409583568573, 0.16694848239421844, 0.1659926176071167, 0.16594690084457397, 0.16590118408203125, 0.1691267043352127], [0.1657055914402008, 0.16712605953216553, 0.16555553674697876, 0.16548055410385132, 0.16540561616420746, 0.17072662711143494], [0.16568736732006073, 0.16713449358940125, 0.16553451120853424, 0.16545812785625458, 0.1653817892074585, 0.17080368101596832], [0.16566914319992065, 0.16714294254779816, 0.16551348567008972, 0.16543571650981903, 0.16535797715187073, 0.1708807647228241], [0.16692955791950226, 0.16653607785701752, 0.1669713705778122, 0.16699227690696716, 0.16701319813728333, 0.16555753350257874]], [[0.16520023345947266, 0.16798335313796997, 0.16509000957012177, 0.16787125170230865, 0.16893035173416138, 0.16492478549480438], [0.167072594165802, 0.16630074381828308, 0.16710351407527924, 0.16633152961730957, 0.16604183614253998, 0.1671498864889145], [0.16512532532215118, 0.1680503785610199, 0.1650095283985138, 0.16793252527713776, 0.16904625296592712, 0.16483597457408905], [0.16699787974357605, 0.16636815667152405, 0.16702309250831604, 0.16639328002929688, 0.16615678369998932, 0.16706091165542603], [0.16770148277282715, 0.16573253273963928, 0.16778063774108887, 0.1658107489347458, 0.16507519781589508, 0.16789944469928741], [0.16501294076442719, 0.1681509017944336, 0.16488878428936005, 0.16802437603473663, 0.16922016441822052, 0.16470274329185486]], [[0.16680365800857544, 0.16653217375278473, 0.1665191501379013, 0.16650614142417908, 0.16649313271045685, 0.16714569926261902], [0.16711395978927612, 0.1662258356809616, 0.16618333756923676, 0.1661408692598343, 0.16609840095043182, 0.168237566947937], [0.1671288162469864, 0.1662111133337021, 0.166167214512825, 0.16612333059310913, 0.16607944667339325, 0.16829009354114532], [0.16714365780353546, 0.16619637608528137, 0.16615106165409088, 0.16610576212406158, 0.16606047749519348, 0.16834260523319244], [0.16715852916240692, 0.16618165373802185, 0.16613492369651794, 0.16608822345733643, 0.1660415232181549, 0.16839516162872314], [0.16641174256801605, 0.16691569983959198, 0.16693991422653198, 0.16696412861347198, 0.16698835790157318, 0.16578015685081482]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": 1.1}, "agent_episode_returns_mean": {"default_agent": 1.1}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011516506266492669, "timers": {"connectors": {"listify_data_for_vector_env": 1.0606385485465791e-05, "normalize_and_clip_actions": 8.030733026290732e-06, "un_batch_to_individual_items": 6.565498693798298e-06, "get_actions": 3.6674445490299355e-05, "remove_single_ts_time_rank_from_batch": 1.1995540673740081e-05, "tensor_to_numpy": 1.545522273200498e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.690077619302464e-06, "add_time_dim_to_batch_and_zero_pad": 6.892239739219769e-06, "numpy_to_tensor": 1.2280114010948996e-05, "add_observations_from_episodes_to_batch": 2.8208202161327654e-06, "batch_individual_items": 1.2452146920516694e-05}}, "connector_pipeline_timer": 5.8902513543787586e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 90400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_step_timer": 1.4102002514662752e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13139748114265568, "num_episodes_lifetime": 360, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_duration_sec_mean": 0.0051999067317228765, "rlmodule_inference_timer": 3.1974706728738894e-05, "env_reset_timer": 0.0004714318308271904, "num_episodes": 20, "episode_return_mean": 1.1, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.907882679529909}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b7d88_00000", "date": "2025-08-11_18-43-56", "timestamp": 1754930636, "time_this_iter_s": 9.598330974578857, "time_total_s": 177.527330160141, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177.527330160141, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 37.43076923076923, "ram_util_percent": 80.5076923076923}}
{"timers": {"training_iteration": 9.627514959955196, "restore_env_runners": 1.081404158825554e-05, "training_step": 9.627338742477367, "env_runner_sampling_timer": 1.6883994521023784, "learner_update_timer": 7.747829818915344, "synch_weights": 0.0010984743938945065, "restore_eval_env_runners": 1.4202647411283565e-05, "evaluation_iteration": 0.14151797282927356, "synch_eval_env_connectors": 0.00018047220865373298, "synch_env_connectors": 5.317835222835654e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.743789836073964e-06, "batch_individual_items": 1.2376076470501789e-05, "numpy_to_tensor": 1.2500325304020257e-05, "add_observations_from_episodes_to_batch": 2.788350573799326e-06, "add_time_dim_to_batch_and_zero_pad": 7.1207612135860455e-06}}, "connector_pipeline_timer": 5.97363701777347e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.8199999999999996}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.925164027512335e-05, "remove_single_ts_time_rank_from_batch": 1.1885973429114391e-05, "listify_data_for_vector_env": 1.0507865974919541e-05, "tensor_to_numpy": 1.5348660331988863e-05, "normalize_and_clip_actions": 8.04565307857041e-06, "un_batch_to_individual_items": 6.724078276666353e-06}}, "connector_pipeline_timer": 0.00011862663375464078}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005669257395784399, "episode_duration_sec_mean": 0.005291318980045617, "agent_episode_returns_mean": {"default_agent": -1.8199999999999996}, "episode_len_min": 20, "weights_seq_no": 18.0, "rlmodule_inference_timer": 3.2054618587929e-05, "time_between_sampling": 0.032786760465377304, "env_step_timer": 1.3845599420994757e-05, "num_episodes_lifetime": -524375.0, "env_reset_timer": 4.079466214157809e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.8199999999999996, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -10487500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_env_steps_sampled_lifetime_throughput": 3235.9985857942343}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15302855749881375, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008649998473651267, "add_observations_from_episodes_to_batch": 0.0008148363234469707, "add_columns_from_episodes_to_train_batch": 0.041931275626454774, "add_time_dim_to_batch_and_zero_pad": 0.09020468522244446, "add_states_from_episodes_to_batch": 0.0037896267870935725, "batch_individual_items": 0.0074633189724207655, "numpy_to_tensor": 6.092023675348898e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 113715, "entropy": 0.6743968725204468, "policy_loss": -8.67159542394802e-05, "total_loss": 0.2485661506652832, "vf_loss_unclipped": 44.394752502441406, "curr_kl_coeff": 3.0819688845440396e-07, "mean_kl_loss": 7.185692084021866e-06, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.9718428097785, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205098807811737, "weights_seq_no": 19.0, "vf_explained_var": 3.916025161743164e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 730.7191160152249}, "intrinsic_reward_module": {"weights_seq_no": 19.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 997.9718428097785, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 113715, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 730.7251945021374}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 227430, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 684000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4398.391808960943, "num_module_steps_trained_throughput": 20764043.624613415, "num_module_steps_trained_lifetime_throughput": 13035182.12640649}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 114.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 682290, "module_train_batch_size_mean": 997.4940209352853}, "default_policy": {"module_train_batch_size_mean": 997.4940209352853, "use_intrinsic_rewards": 1.0, "weights_seq_no": 114.0, "mean_kl_loss": 6.839209618192399e-06, "vf_loss": 0.3205297887325287, "num_module_steps_trained": 35910, "vf_explained_var": 0.001647353172302246, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "entropy": 0.6744138598442078, "policy_loss": -8.292339043691754e-05, "total_loss": 0.2485865354537964, "vf_loss_unclipped": 44.285152435302734}, "__all_modules__": {"num_env_steps_trained_lifetime": 4104000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime_throughput": 47635.51688677468}}}, "IntrinsicAttentionMask": [[[0.1650192141532898, 0.16779926419258118, 0.16600489616394043, 0.1676872968673706, 0.1687452346086502, 0.1647440642118454], [0.16712377965450287, 0.16635170578956604, 0.16684815287590027, 0.16638249158859253, 0.16609270870685577, 0.16720110177993774], [0.16576889157295227, 0.16728433966636658, 0.16630753874778748, 0.16722352802753448, 0.16779740154743195, 0.16561827063560486], [0.16703961789608002, 0.16640973091125488, 0.16681480407714844, 0.1664348542690277, 0.16619831323623657, 0.1671026647090912], [0.16783301532268524, 0.16586251556873322, 0.16712790727615356, 0.1659407913684845, 0.16520465910434723, 0.16803112626075745], [0.16480925679206848, 0.1679433286190033, 0.1659197062253952, 0.16781696677207947, 0.16901127994060516, 0.164499431848526]], [[0.16574716567993164, 0.16711436212062836, 0.16560272872447968, 0.1669687181711197, 0.16545839607715607, 0.16910865902900696], [0.16608616709709167, 0.1669505536556244, 0.16599467396736145, 0.16685859858989716, 0.1659032553434372, 0.16820678114891052], [0.1657111495733261, 0.16713166236877441, 0.16556109488010406, 0.1669803261756897, 0.16541117429733276, 0.16920457780361176], [0.16605019569396973, 0.1669679880142212, 0.16595308482646942, 0.1668703407049179, 0.1658560335636139, 0.16830232739448547], [0.16567514836788177, 0.16714899241924286, 0.16551947593688965, 0.1669919490814209, 0.16536395251750946, 0.16930055618286133], [0.1665746122598648, 0.1667119711637497, 0.16656003892421722, 0.16669738292694092, 0.16654546558856964, 0.1669105440378189]], [[0.1658899486064911, 0.16732804477214813, 0.16589893400669098, 0.1678207367658615, 0.16724534332752228, 0.16581694781780243], [0.16799181699752808, 0.16553430259227753, 0.1679762750864029, 0.16470542550086975, 0.16567406058311462, 0.16811810433864594], [0.16590315103530884, 0.16731680929660797, 0.1659119874238968, 0.16780109703540802, 0.16723552346229553, 0.16583137214183807], [0.168707013130188, 0.16492104530334473, 0.1686829924583435, 0.16365092992782593, 0.16513554751873016, 0.16890239715576172], [0.16787153482437134, 0.1656372994184494, 0.16785742342472076, 0.1648830622434616, 0.1657644361257553, 0.16798627376556396], [0.16578269004821777, 0.16741923987865448, 0.16579291224479675, 0.1679803729057312, 0.16732507944107056, 0.16569966077804565]], [[0.1661459505558014, 0.166921466588974, 0.16688022017478943, 0.16602280735969543, 0.16598178446292877, 0.16804780066013336], [0.16648423671722412, 0.16675633192062378, 0.16674187779426575, 0.166440948843956, 0.16642652451992035, 0.16715006530284882], [0.16646628081798553, 0.16676512360572815, 0.1667492538690567, 0.16641877591609955, 0.1664029210805893, 0.16719761490821838], [0.16609202325344086, 0.1669476479291916, 0.16690213978290558, 0.16595621407032013, 0.1659109741449356, 0.16819104552268982], [0.16607405245304108, 0.16695636510849, 0.16690942645072937, 0.1659340113401413, 0.16588735580444336, 0.1682388037443161], [0.1669716238975525, 0.16651581227779388, 0.1665399670600891, 0.16704429686069489, 0.16706854104995728, 0.16585975885391235]], [[0.1658899486064911, 0.16732804477214813, 0.16589893400669098, 0.1678207367658615, 0.16724534332752228, 0.16581694781780243], [0.16799181699752808, 0.16553430259227753, 0.1679762750864029, 0.16470542550086975, 0.16567406058311462, 0.16811810433864594], [0.16590315103530884, 0.16731680929660797, 0.1659119874238968, 0.16780109703540802, 0.16723552346229553, 0.16583137214183807], [0.168707013130188, 0.16492104530334473, 0.1686829924583435, 0.16365092992782593, 0.16513554751873016, 0.16890239715576172], [0.16787153482437134, 0.1656372994184494, 0.16785742342472076, 0.1648830622434616, 0.1657644361257553, 0.16798627376556396], [0.16578269004821777, 0.16741923987865448, 0.16579291224479675, 0.1679803729057312, 0.16732507944107056, 0.16569966077804565]], [[0.16713370382785797, 0.16620628535747528, 0.16616190969944, 0.16611754894256592, 0.16607321798801422, 0.1683073490858078], [0.1674427092075348, 0.1658986508846283, 0.16582493484020233, 0.16575124859809875, 0.16567759215831757, 0.16940487921237946], [0.16745750606060028, 0.165883868932724, 0.1658087521791458, 0.16573365032672882, 0.1656585931777954, 0.16945767402648926], [0.16747230291366577, 0.1658690720796585, 0.1657925397157669, 0.1657160520553589, 0.16563959419727325, 0.16951046884059906], [0.16748706996440887, 0.16585427522659302, 0.1657763421535492, 0.16569843888282776, 0.1656205803155899, 0.16956327855587006], [0.16674336791038513, 0.16659140586853027, 0.16658411920070648, 0.1665768325328827, 0.1665695458650589, 0.16693468391895294]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": -0.3}, "agent_episode_returns_mean": {"default_agent": -0.3}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011251882776960866, "timers": {"connectors": {"listify_data_for_vector_env": 1.0366665338099973e-05, "normalize_and_clip_actions": 7.8294767304435e-06, "un_batch_to_individual_items": 6.453904250813264e-06, "get_actions": 3.537112386380112e-05, "remove_single_ts_time_rank_from_batch": 1.1879871401573206e-05, "tensor_to_numpy": 1.5032398163102938e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6593283691616384e-06, "add_time_dim_to_batch_and_zero_pad": 6.690840503076333e-06, "numpy_to_tensor": 1.1959937740052803e-05, "add_observations_from_episodes_to_batch": 2.746281421590896e-06, "batch_individual_items": 1.2242002453208585e-05}}, "connector_pipeline_timer": 5.791134856556322e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 95400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_step_timer": 1.3728425823606227e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1312191384114879, "num_episodes_lifetime": 380, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_duration_sec_mean": 0.005208369619213045, "rlmodule_inference_timer": 3.0487100607952936e-05, "env_reset_timer": 0.0004698800127346128, "num_episodes": 20, "episode_return_mean": -0.3, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.893606996064529}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b7d88_00000", "date": "2025-08-11_18-44-06", "timestamp": 1754930646, "time_this_iter_s": 9.579416036605835, "time_total_s": 187.10674619674683, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.10674619674683, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 37.15714285714286, "ram_util_percent": 80.35000000000001}}
{"timers": {"training_iteration": 9.629658794945742, "restore_env_runners": 1.0769231107446836e-05, "training_step": 9.629481875472589, "env_runner_sampling_timer": 1.687056712581635, "learner_update_timer": 7.75119948572662, "synch_weights": 0.001097219649538776, "restore_eval_env_runners": 1.4152700800122962e-05, "evaluation_iteration": 0.14132284018140448, "synch_eval_env_connectors": 0.0001800470768158847, "synch_env_connectors": 5.318816770780843e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.746775771481538e-06, "batch_individual_items": 1.2486716579527238e-05, "numpy_to_tensor": 1.2562234685567169e-05, "add_observations_from_episodes_to_batch": 2.794856660279016e-06, "add_time_dim_to_batch_and_zero_pad": 7.169019040093926e-06}}, "connector_pipeline_timer": 5.995030985236539e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9746559196406765e-05, "remove_single_ts_time_rank_from_batch": 1.1948459429363932e-05, "listify_data_for_vector_env": 1.065820570769596e-05, "tensor_to_numpy": 1.5442323454013318e-05, "normalize_and_clip_actions": 8.116552426619252e-06, "un_batch_to_individual_items": 6.7518642171795005e-06}}, "connector_pipeline_timer": 0.00011954476909921593}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005692267969011849, "episode_duration_sec_mean": 0.005335751836188139, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "episode_len_min": 20, "weights_seq_no": 19.0, "rlmodule_inference_timer": 3.2584392630426054e-05, "time_between_sampling": 0.03271779878292305, "env_step_timer": 1.3966501742077967e-05, "num_episodes_lifetime": -555250.0, "env_reset_timer": 4.1665339733791584e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.2600000000000002, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -11105000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_env_steps_sampled_lifetime_throughput": 3215.6345766125123}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15303897651455972, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00864978181878903, "add_observations_from_episodes_to_batch": 0.000816157539884942, "add_columns_from_episodes_to_train_batch": 0.04192789995000542, "add_time_dim_to_batch_and_zero_pad": 0.09021096295016112, "add_states_from_episodes_to_batch": 0.003793201768646558, "batch_individual_items": 0.007464820782677708, "numpy_to_tensor": 6.220311398515576e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 119700, "entropy": 0.6722093820571899, "policy_loss": -0.0003498495789244771, "total_loss": 0.24830639362335205, "vf_loss_unclipped": 42.77307891845703, "curr_kl_coeff": 1.5409844422720198e-07, "mean_kl_loss": 5.000275996280834e-05, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.9437895346426, "use_intrinsic_rewards": 0.0, "vf_loss": 0.3205098807811737, "weights_seq_no": 20.0, "vf_explained_var": -2.0503997802734375e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 728.9543909848232}, "intrinsic_reward_module": {"weights_seq_no": 20.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 997.9437895346426, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 119700, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 728.9601232753872}, "__all_modules__": {"num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 239400, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime": 720000, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime_throughput": 4387.661759992469, "num_module_steps_trained_throughput": 20339214.14549258, "num_module_steps_trained_lifetime_throughput": 13012149.190408876}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"weights_seq_no": 120.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 718200, "module_train_batch_size_mean": 997.4935477577241}, "default_policy": {"module_train_batch_size_mean": 997.4935477577241, "use_intrinsic_rewards": 1.0, "weights_seq_no": 120.0, "mean_kl_loss": 4.782161340699531e-05, "vf_loss": 0.3205265700817108, "num_module_steps_trained": 35910, "vf_explained_var": 0.0016578435897827148, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "entropy": 0.6722538471221924, "policy_loss": -0.0003427986230235547, "total_loss": 0.2483341544866562, "vf_loss_unclipped": 42.67520523071289}, "__all_modules__": {"num_env_steps_trained_lifetime": 4320000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime_throughput": 47012.621634635005}}}, "IntrinsicAttentionMask": [[[0.16483871638774872, 0.16761572659015656, 0.1658233255147934, 0.16861692070960999, 0.16744796931743622, 0.16565737128257751], [0.1671750545501709, 0.16640274226665497, 0.16689932346343994, 0.16612829267978668, 0.1664489209651947, 0.1669456511735916], [0.16566972434520721, 0.1671842634677887, 0.16620802879333496, 0.1677275002002716, 0.16709311306476593, 0.16611741483211517], [0.16801175475120544, 0.1659683883190155, 0.16728048026561737, 0.16524600982666016, 0.16609016060829163, 0.1674032062292099], [0.1670345813035965, 0.16647566854953766, 0.16683512926101685, 0.16627687215805054, 0.16650910675525665, 0.1668686419725418], [0.16552986204624176, 0.16725687682628632, 0.16614344716072083, 0.16787685453891754, 0.16715286672115326, 0.16604012250900269]], [[0.165986105799675, 0.16591376066207886, 0.16584144532680511, 0.1672094166278839, 0.165696918964386, 0.1693524271249771], [0.16597270965576172, 0.16589896380901337, 0.1658252477645874, 0.16721990704536438, 0.16567790508270264, 0.16940519213676453], [0.16595937311649323, 0.16588421165943146, 0.16580908000469208, 0.16723044216632843, 0.16565893590450287, 0.16945801675319672], [0.1662108302116394, 0.16616222262382507, 0.16611362993717194, 0.16703176498413086, 0.16601647436618805, 0.16846513748168945], [0.16593261063098907, 0.16585464775562286, 0.16577671468257904, 0.16725145280361176, 0.16562093794345856, 0.1695636510848999], [0.16659870743751526, 0.16659142076969147, 0.16658413410186768, 0.16672150790691376, 0.1665695607662201, 0.16693469882011414]], [[0.16570916771888733, 0.16714568436145782, 0.16626086831092834, 0.16763783991336823, 0.16761022806167603, 0.16563624143600464], [0.1683044284582138, 0.16584233939647675, 0.16735202074050903, 0.165011927485466, 0.16505835950374603, 0.16843095421791077], [0.16670742630958557, 0.16664622724056244, 0.1666838526725769, 0.16662538051605225, 0.16662654280662537, 0.16671054065227509], [0.16919054090976715, 0.16539371013641357, 0.16771824657917023, 0.16411995887756348, 0.1641910821199417, 0.16938647627830505], [0.16914084553718567, 0.16541890799999237, 0.16769778728485107, 0.16416990756988525, 0.16423965990543365, 0.16933287680149078], [0.16557708382606506, 0.1672115921974182, 0.16620460152626038, 0.16777202486991882, 0.1677405685186386, 0.1654941588640213]], [[0.16669048368930817, 0.16664598882198334, 0.16572126746177673, 0.1656770408153534, 0.16651257872581482, 0.16875262558460236], [0.1666911393404007, 0.16664522886276245, 0.16569110751152039, 0.16564546525478363, 0.1665075570344925, 0.16881948709487915], [0.16670338809490204, 0.166627898812294, 0.1650620549917221, 0.16498729586601257, 0.16640160977840424, 0.17021772265434265], [0.16670389473438263, 0.16662698984146118, 0.16503185033798218, 0.1649557203054428, 0.16639645397663116, 0.17028501629829407], [0.1666930764913559, 0.1666429191827774, 0.16560059785842896, 0.16555075347423553, 0.1664924919605255, 0.16902020573616028], [0.1666533499956131, 0.16667422652244568, 0.167109876871109, 0.16713081300258636, 0.16673685610294342, 0.16569487750530243]], [[0.16561850905418396, 0.1676013469696045, 0.1661699116230011, 0.1675461232662201, 0.1675185263156891, 0.16554562747478485], [0.16953930258750916, 0.16411380469799042, 0.16800624132156372, 0.16426168382167816, 0.16433565318584442, 0.1697433590888977], [0.16671130061149597, 0.1666269153356552, 0.1666877269744873, 0.16662925481796265, 0.16663041710853577, 0.16671441495418549], [0.1694304347038269, 0.16421031951904297, 0.16795605421066284, 0.1643526703119278, 0.1644238978624344, 0.1696266531944275], [0.16937601566314697, 0.16425856947898865, 0.1679309457540512, 0.1643981635570526, 0.16446802020072937, 0.16956831514835358], [0.16547392308712006, 0.1677304059267044, 0.16610106825828552, 0.16766750812530518, 0.16763606667518616, 0.16539105772972107]], [[0.16622550785541534, 0.16615305840969086, 0.16608063876628876, 0.16600826382637024, 0.16593590378761292, 0.16959668695926666], [0.16621680557727814, 0.16614294052124023, 0.16606910526752472, 0.16599531471729279, 0.16592155396938324, 0.16965432465076447], [0.16620807349681854, 0.16613280773162842, 0.1660575568675995, 0.16598236560821533, 0.16590718924999237, 0.16971196234226227], [0.16619935631752014, 0.1661226749420166, 0.16604602336883545, 0.16596941649913788, 0.1658928394317627, 0.16976962983608246], [0.16619065403938293, 0.16611255705356598, 0.1660345047712326, 0.16595646739006042, 0.16587848961353302, 0.16982732713222504], [0.1666228026151657, 0.16661551594734192, 0.16660822927951813, 0.16660094261169434, 0.16659364104270935, 0.16695883870124817]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "weights_seq_no": 20.0, "module_episode_returns_mean": {"default_policy": -1.3}, "agent_episode_returns_mean": {"default_agent": -1.3}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011502416686692206, "timers": {"connectors": {"listify_data_for_vector_env": 1.050282857189982e-05, "normalize_and_clip_actions": 8.013812237325632e-06, "un_batch_to_individual_items": 6.470223276382412e-06, "get_actions": 3.638117776079827e-05, "remove_single_ts_time_rank_from_batch": 1.251886654000309e-05, "tensor_to_numpy": 1.5361068193060144e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6472256407468112e-06, "add_time_dim_to_batch_and_zero_pad": 6.827810835589127e-06, "numpy_to_tensor": 1.2252831650901061e-05, "add_observations_from_episodes_to_batch": 2.756632266185888e-06, "batch_individual_items": 1.2297121477809661e-05}}, "connector_pipeline_timer": 5.831059128688174e-05}, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 100400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_step_timer": 1.4004795468371572e-05, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.13103031577676805, "num_episodes_lifetime": 400, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_duration_sec_mean": 0.005214924620231614, "rlmodule_inference_timer": 3.136277936903381e-05, "env_reset_timer": 0.0004660341329550913, "num_episodes": 20, "episode_return_mean": -1.3, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_return_min": -15.5, "time_between_sampling": 10.883314012774083}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b7d88_00000", "date": "2025-08-11_18-44-16", "timestamp": 1754930656, "time_this_iter_s": 9.9632089138031, "time_total_s": 197.06995511054993, "pid": 11658, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 197.06995511054993, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 40.04285714285714, "ram_util_percent": 80.20000000000002}}
