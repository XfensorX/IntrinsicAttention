{"timers": {"training_iteration": 6.176152165979147, "restore_env_runners": 1.733400858938694e-05, "training_step": 6.175957124913111, "env_runner_sampling_timer": 5.648690209025517, "learner_update_timer": 0.5195229590171948, "synch_weights": 0.0015325420536100864}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.1826962272514163e-05, "numpy_to_tensor": 3.515576984250529e-05, "add_states_from_episodes_to_batch": 4.224131336819391e-06, "batch_individual_items": 2.0552271385037136e-05, "add_time_dim_to_batch_and_zero_pad": 6.322150455533318e-06}}, "connector_pipeline_timer": 0.0001472930402060108}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "rlmodule_inference_timer": 0.0001924199141490002, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.562357705308676e-06, "listify_data_for_vector_env": 3.353604174612197e-05, "un_batch_to_individual_items": 1.617812220893209e-05, "normalize_and_clip_actions": 4.044314499720698e-05, "get_actions": 0.00020096069864631493, "tensor_to_numpy": 4.32864962022062e-05}}, "connector_pipeline_timer": 0.0004423058623980491}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "weights_seq_no": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 5.6042335922215164e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.019071925988886507, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_episodes_lifetime": 31375.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": -0.14000000000000007, "time_between_sampling": 0.0023142551256461626, "sample": 0.023053865038287477, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "env_reset_timer": 0.0002416852973444435, "num_env_steps_sampled_lifetime": 627500.0, "num_env_steps_sampled_lifetime_throughput": 1676.1301004399852}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime": 31500, "learner_connector": {"connector_pipeline_timer": 0.2626427090726793, "timers": {"connectors": {"batch_individual_items": 0.044371207943186164, "numpy_to_tensor": 0.00015350000467151403, "add_states_from_episodes_to_batch": 4.00003045797348e-06, "add_time_dim_to_batch_and_zero_pad": 1.4666002243757248e-05, "add_columns_from_episodes_to_train_batch": 0.1158559579635039, "add_one_ts_to_episodes_and_truncate": 0.013392792083323002, "add_observations_from_episodes_to_batch": 0.0009026669431477785, "general_advantage_estimation": 0.08774720795918256}}}, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 662002.2618263179, "num_module_steps_trained_throughput": 126301.32987230027, "num_module_steps_trained_lifetime_throughput": 126257.1968748098}, "default_policy": {"entropy": 0.6931197643280029, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.00010375812416896224, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.025468185544013977, "vf_loss_unclipped": 28.37276268005371, "num_module_steps_trained_lifetime": 6000, "policy_loss": 0.06390514224767685, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.3732481598854065, "weights_seq_no": 1.0, "total_loss": 0.12644556164741516, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.011374115943908691, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 126564.58616576345}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.65}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 0.00010181305141864122, "listify_data_for_vector_env": 4.280818751426843e-05, "normalize_and_clip_actions": 3.109426765300434e-05, "remove_single_ts_time_rank_from_batch": 1.286315985936979e-06, "get_actions": 0.0002092823440620574, "tensor_to_numpy": 3.505641102522118e-05}}, "connector_pipeline_timer": 0.0005486211037358158}, "env_to_module_connector": {"connector_pipeline_timer": 0.0001585488511416307, "timers": {"connectors": {"batch_individual_items": 1.7770877873100234e-05, "numpy_to_tensor": 3.430280880662505e-05, "add_states_from_episodes_to_batch": 3.525122078572931e-06, "add_time_dim_to_batch_and_zero_pad": 3.998788951749749e-05, "add_observations_from_episodes_to_batch": 1.2171306177684349e-05}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 20, "env_reset_timer": 0.0002452089684084058, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6137105830712244, "num_env_steps_sampled_lifetime": 5400, "agent_episode_returns_mean": {"default_agent": 2.65}, "weights_seq_no": 1.0, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_step_timer": 5.138968054397314e-05, "num_episodes": 20, "episode_return_mean": 2.65, "rlmodule_inference_timer": 0.00014719670779636475, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_duration_sec_mean": 0.029527097748359665, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_max": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "49ad9_00000", "date": "2025-08-11_19-25-20", "timestamp": 1754933120, "time_this_iter_s": 6.809808969497681, "time_total_s": 6.809808969497681, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.809808969497681, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 82.4, "ram_util_percent": 79.75}}
{"timers": {"training_iteration": 6.179368552239612, "restore_env_runners": 1.725400914438069e-05, "training_step": 6.179172398253577, "env_runner_sampling_timer": 5.650462541095912, "learner_update_timer": 0.520994171926286, "synch_weights": 0.001530893302988261, "restore_eval_env_runners": 2.279097680002451e-05, "evaluation_iteration": 0.6318182500544935, "synch_eval_env_connectors": 0.00017208303324878216, "synch_env_connectors": 1.0457937605679035e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.0846949674559663e-05, "numpy_to_tensor": 3.6830176128598066e-05, "add_states_from_episodes_to_batch": 3.4937374074001883e-06, "batch_individual_items": 3.126139944081573e-05, "add_time_dim_to_batch_and_zero_pad": 8.034821082118605e-06}}, "connector_pipeline_timer": 0.00015886302559949792}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "rlmodule_inference_timer": 0.0001611030871820528, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.2930560059740905e-06, "listify_data_for_vector_env": 4.036714143791624e-05, "un_batch_to_individual_items": 1.8928191046789983e-05, "normalize_and_clip_actions": 4.065206715342022e-05, "get_actions": 0.00023922249755671646, "tensor_to_numpy": 5.525355814053365e-05}}, "connector_pipeline_timer": 0.000498360883610053}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 5.511199942410561e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.020483313855715096, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": 500.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 1.6200000000000008, "time_between_sampling": 0.006140993346742787, "sample": 0.022206520314305533, "module_episode_returns_mean": {"default_policy": 1.6200000000000008}, "agent_episode_returns_mean": {"default_agent": 1.6200000000000008}, "env_reset_timer": 0.00016058780496604696, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled_lifetime_throughput": 1776.112632186925}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 63000, "learner_connector": {"connector_pipeline_timer": 0.2655110707320273, "timers": {"connectors": {"batch_individual_items": 0.047891043784329665, "numpy_to_tensor": 0.0001532483345363289, "add_states_from_episodes_to_batch": 4.002529894933105e-06, "add_time_dim_to_batch_and_zero_pad": 1.4675172278657556e-05, "add_columns_from_episodes_to_train_batch": 0.11586849671439267, "add_one_ts_to_episodes_and_truncate": 0.01353343291208148, "add_observations_from_episodes_to_batch": 0.0009027477726340294, "general_advantage_estimation": 0.08694338795961812}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 660627.3080375422, "num_module_steps_trained_throughput": 125986.43268673099, "num_module_steps_trained_lifetime_throughput": 125986.21162418269}, "default_policy": {"entropy": 0.6929256319999695, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.00020176632096990943, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.01637868583202362, "vf_loss_unclipped": 28.881858825683594, "num_module_steps_trained_lifetime": 12000, "policy_loss": -0.027911582961678505, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.18662407994270325, "weights_seq_no": 2.0, "total_loss": 0.03462845832109451, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0108109712600708, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 126235.50782566966}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.65}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.524196383714622e-05, "listify_data_for_vector_env": 3.9886385475024456e-05, "normalize_and_clip_actions": 2.5638699888542396e-05, "remove_single_ts_time_rank_from_batch": 2.0256263751079008e-06, "get_actions": 0.0002907320927716238, "tensor_to_numpy": 6.263643804544853e-05}}, "connector_pipeline_timer": 0.0005127301114621703}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012901658937856543, "timers": {"connectors": {"batch_individual_items": 1.8365975391107358e-05, "numpy_to_tensor": 3.323607285650812e-05, "add_states_from_episodes_to_batch": 3.5508874613920144e-06, "add_time_dim_to_batch_and_zero_pad": 1.2749454999050167e-05, "add_observations_from_episodes_to_batch": 9.845575426667939e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 40, "env_reset_timer": 0.0002448664593975991, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6115632389008533, "num_env_steps_sampled_lifetime": 10400, "agent_episode_returns_mean": {"default_agent": 2.65}, "weights_seq_no": 2.0, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_step_timer": 5.1906122135831695e-05, "num_episodes": 20, "episode_return_mean": 2.65, "rlmodule_inference_timer": 0.00016839409017851268, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_duration_sec_mean": 0.023814152044360527, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_max": 20, "time_between_sampling": 6.5479405840160325}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "49ad9_00000", "date": "2025-08-11_19-25-27", "timestamp": 1754933127, "time_this_iter_s": 6.911343812942505, "time_total_s": 13.721152782440186, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.721152782440186, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 73.83, "ram_util_percent": 80.25}}
{"timers": {"training_iteration": 6.173250719217351, "restore_env_runners": 1.7170638532843438e-05, "training_step": 6.173054146770516, "env_runner_sampling_timer": 5.647486364015425, "learner_update_timer": 0.5178849993766519, "synch_weights": 0.0015255014594411477, "restore_eval_env_runners": 2.303806715644896e-05, "evaluation_iteration": 0.6295991913042962, "synch_eval_env_connectors": 0.0001717647025361657, "synch_env_connectors": 1.0415448341518641e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2261078931737818e-05, "numpy_to_tensor": 4.350875574151522e-05, "add_states_from_episodes_to_batch": 4.28707261047103e-06, "batch_individual_items": 2.2334093363852802e-05, "add_time_dim_to_batch_and_zero_pad": 7.3534835408230695e-06}}, "connector_pipeline_timer": 0.0001489313718039429}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "rlmodule_inference_timer": 0.00011813510896513385, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.1846541833113777e-06, "listify_data_for_vector_env": 4.831459168301848e-05, "un_batch_to_individual_items": 1.736914941879614e-05, "normalize_and_clip_actions": 3.3015758762181254e-05, "get_actions": 0.00017618989843616532, "tensor_to_numpy": 6.246861918054211e-05}}, "connector_pipeline_timer": 0.0004216677151620075}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 7.32705193733911e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.018308506483677774, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -30375.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 0.3400000000000001, "time_between_sampling": 0.0066915597671425445, "sample": 0.02021414744812065, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "env_reset_timer": 0.00019137286608035344, "num_env_steps_sampled_lifetime": -607500.0, "num_env_steps_sampled_lifetime_throughput": 1774.1264547481317}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 94500, "learner_connector": {"connector_pipeline_timer": 0.2646241879346315, "timers": {"connectors": {"batch_individual_items": 0.048485522927192506, "numpy_to_tensor": 0.0001524566915235482, "add_states_from_episodes_to_batch": 4.001673695165664e-06, "add_time_dim_to_batch_and_zero_pad": 1.4739670127164572e-05, "add_columns_from_episodes_to_train_batch": 0.11515673549723578, "add_one_ts_to_episodes_and_truncate": 0.013507734833378344, "add_observations_from_episodes_to_batch": 0.0009084723746404053, "general_advantage_estimation": 0.08619493032947649}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 666332.9829354682, "num_module_steps_trained_throughput": 127023.1948665221, "num_module_steps_trained_lifetime_throughput": 127056.58219704522}, "default_policy": {"entropy": 0.6904634833335876, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0011100023984909058, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.05247271806001663, "vf_loss_unclipped": 28.72089958190918, "num_module_steps_trained_lifetime": 18000, "policy_loss": -0.06263282895088196, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.09331203997135162, "weights_seq_no": 3.0, "total_loss": 6.134508294053376e-05, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.011661171913146973, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 127251.80342352213}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.9833333333333334}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4739894848832916e-05, "listify_data_for_vector_env": 1.8324106079007394e-05, "normalize_and_clip_actions": 1.6951742998198564e-05, "remove_single_ts_time_rank_from_batch": 9.34555810543738e-07, "get_actions": 0.00012828170515114296, "tensor_to_numpy": 3.2078408546691256e-05}}, "connector_pipeline_timer": 0.00025550297063853424}, "env_to_module_connector": {"connector_pipeline_timer": 8.421240678339496e-05, "timers": {"connectors": {"batch_individual_items": 1.676324489728228e-05, "numpy_to_tensor": 2.0024683337335915e-05, "add_states_from_episodes_to_batch": 2.590252170116299e-06, "add_time_dim_to_batch_and_zero_pad": 4.4024056091360995e-06, "add_observations_from_episodes_to_batch": 4.759049779925494e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 60, "env_reset_timer": 0.0002441236343351193, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.608536425671738, "num_env_steps_sampled_lifetime": 15400, "agent_episode_returns_mean": {"default_agent": 2.9833333333333334}, "weights_seq_no": 3.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_step_timer": 4.364378950878042e-05, "num_episodes": 20, "episode_return_mean": 2.9833333333333334, "rlmodule_inference_timer": 6.281114935040508e-05, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_duration_sec_mean": 0.020338824928815787, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_max": 20, "time_between_sampling": 6.5392581344256175}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "49ad9_00000", "date": "2025-08-11_19-25-33", "timestamp": 1754933133, "time_this_iter_s": 5.904274225234985, "time_total_s": 19.62542700767517, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.62542700767517, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 79.91250000000001, "ram_util_percent": 79.975}}
{"timers": {"training_iteration": 6.1765515811849685, "restore_env_runners": 1.7180182654527013e-05, "training_step": 6.176352574462859, "env_runner_sampling_timer": 5.653822420374881, "learner_update_timer": 0.5148850085522475, "synch_weights": 0.0015186643552773168, "restore_eval_env_runners": 2.2993935865815726e-05, "evaluation_iteration": 0.6266463818907737, "synch_eval_env_connectors": 0.00017112455614842471, "synch_env_connectors": 1.036337458062917e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.5372560667991968e-05, "numpy_to_tensor": 5.350853765182367e-05, "add_states_from_episodes_to_batch": 1.1266801330263853e-05, "batch_individual_items": 2.2623571703478778e-05, "add_time_dim_to_batch_and_zero_pad": 9.991472097342638e-06}}, "connector_pipeline_timer": 0.00016957571894629599}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "rlmodule_inference_timer": 0.00012216479874147904, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6807174229230467e-06, "listify_data_for_vector_env": 5.890509697232516e-05, "un_batch_to_individual_items": 2.9909308675949406e-05, "normalize_and_clip_actions": 3.301132683780984e-05, "get_actions": 0.00022011967222037326, "tensor_to_numpy": 5.734269701117589e-05}}, "connector_pipeline_timer": 0.0004892462142324791}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 5.3985428025057826e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.01974406383093447, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -61250.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 1.94, "time_between_sampling": 0.006029383306540049, "sample": 0.02004868672964597, "module_episode_returns_mean": {"default_policy": 1.94}, "agent_episode_returns_mean": {"default_agent": 1.94}, "env_reset_timer": 0.00017681777472750875, "num_env_steps_sampled_lifetime": -1225000.0, "num_env_steps_sampled_lifetime_throughput": 1725.4902949983978}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 126000, "learner_connector": {"connector_pipeline_timer": 0.26394184605584065, "timers": {"connectors": {"batch_individual_items": 0.04864821144815825, "numpy_to_tensor": 0.00015349337461136744, "add_states_from_episodes_to_batch": 4.049157042405568e-06, "add_time_dim_to_batch_and_zero_pad": 1.4852273077354767e-05, "add_columns_from_episodes_to_train_batch": 0.11499136314285044, "add_one_ts_to_episodes_and_truncate": 0.01358509956483636, "add_observations_from_episodes_to_batch": 0.0009263326511755587, "general_advantage_estimation": 0.08541777519687056}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 681759.3210669023, "num_module_steps_trained_throughput": 129928.49559488463, "num_module_steps_trained_lifetime_throughput": 129982.64007582905}, "default_policy": {"entropy": 0.6837658882141113, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0017774610314518213, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.08418809622526169, "vf_loss_unclipped": 28.880634307861328, "num_module_steps_trained_lifetime": 24000, "policy_loss": -0.004411409143358469, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.04665601998567581, "weights_seq_no": 4.0, "total_loss": 0.0583021305501461, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.011780023574829102, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 130126.07231461987}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.65}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.278379722695832e-06, "listify_data_for_vector_env": 2.1135257213100743e-05, "normalize_and_clip_actions": 1.9648915800163126e-05, "remove_single_ts_time_rank_from_batch": 9.034526460130307e-07, "get_actions": 9.112469197348358e-05, "tensor_to_numpy": 2.6717491195259663e-05}}, "connector_pipeline_timer": 0.00021196982102109223}, "env_to_module_connector": {"connector_pipeline_timer": 8.505455476425384e-05, "timers": {"connectors": {"batch_individual_items": 1.7844135737203172e-05, "numpy_to_tensor": 1.7128537923756875e-05, "add_states_from_episodes_to_batch": 2.8429853455802364e-06, "add_time_dim_to_batch_and_zero_pad": 4.295500305100198e-06, "add_observations_from_episodes_to_batch": 6.105067421909721e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 80, "env_reset_timer": 0.00024270739764755127, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6056405393239114, "num_env_steps_sampled_lifetime": 20400, "agent_episode_returns_mean": {"default_agent": 1.65}, "weights_seq_no": 4.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_step_timer": 4.600907247373602e-05, "num_episodes": 20, "episode_return_mean": 1.65, "rlmodule_inference_timer": 6.0799354290583624e-05, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_duration_sec_mean": 0.018539774922828656, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_max": 20, "time_between_sampling": 6.539831592250941}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "49ad9_00000", "date": "2025-08-11_19-25-40", "timestamp": 1754933140, "time_this_iter_s": 6.834458112716675, "time_total_s": 26.459885120391846, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.459885120391846, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 91.93, "ram_util_percent": 79.86}}
{"timers": {"training_iteration": 6.184080529123094, "restore_env_runners": 1.7160040888491782e-05, "training_step": 6.183878828717757, "env_runner_sampling_timer": 5.662843377841091, "learner_update_timer": 0.5134072142963432, "synch_weights": 0.0015175247919098078, "restore_eval_env_runners": 2.2896076674689536e-05, "evaluation_iteration": 0.6236588580717388, "synch_eval_env_connectors": 0.00017100164980581026, "synch_env_connectors": 1.0302240576362238e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 9.647628854991957e-06, "numpy_to_tensor": 4.6612701884060496e-05, "add_states_from_episodes_to_batch": 4.13295293674308e-06, "batch_individual_items": 2.0268242045826493e-05, "add_time_dim_to_batch_and_zero_pad": 6.256427108643085e-06}}, "connector_pipeline_timer": 0.00014663694083314176}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "rlmodule_inference_timer": 0.00020855132303699856, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5066002306519302e-06, "listify_data_for_vector_env": 4.1380381495661674e-05, "un_batch_to_individual_items": 2.0013184990707353e-05, "normalize_and_clip_actions": 2.9762508967348513e-05, "get_actions": 0.000201630423780405, "tensor_to_numpy": 5.4501562424228865e-05}}, "connector_pipeline_timer": 0.0004373041149236565}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 4.8698879806465054e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.02125228619761765, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -92125.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 3.7, "time_between_sampling": 0.005017580011242674, "sample": 0.019924908699976214, "module_episode_returns_mean": {"default_policy": 3.7}, "agent_episode_returns_mean": {"default_agent": 3.7}, "env_reset_timer": 0.00016686101729754827, "num_env_steps_sampled_lifetime": -1842500.0, "num_env_steps_sampled_lifetime_throughput": 1777.9024844373441}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 157500, "learner_connector": {"connector_pipeline_timer": 0.26412096259466955, "timers": {"connectors": {"batch_individual_items": 0.04897694267377843, "numpy_to_tensor": 0.00015743385159117514, "add_states_from_episodes_to_batch": 4.098664993132697e-06, "add_time_dim_to_batch_and_zero_pad": 1.4835420732180355e-05, "add_columns_from_episodes_to_train_batch": 0.11533014951175832, "add_one_ts_to_episodes_and_truncate": 0.013836338989305598, "add_observations_from_episodes_to_batch": 0.0009449039056421818, "general_advantage_estimation": 0.0846537949454418}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 691249.5078738106, "num_module_steps_trained_throughput": 131708.29384424628, "num_module_steps_trained_lifetime_throughput": 131778.7101093797}, "default_policy": {"entropy": 0.6739362478256226, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0009778609964996576, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.03668160364031792, "vf_loss_unclipped": 28.88611602783203, "num_module_steps_trained_lifetime": 30000, "policy_loss": 0.17475159466266632, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.023328009992837906, "weights_seq_no": 5.0, "total_loss": 0.23743394017219543, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012585759162902832, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 131879.32602927566}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.11193448713484e-05, "listify_data_for_vector_env": 2.776125193852775e-05, "normalize_and_clip_actions": 1.98757646361596e-05, "remove_single_ts_time_rank_from_batch": 1.6667172963988355e-06, "get_actions": 0.0002368839859689501, "tensor_to_numpy": 3.069169879527984e-05}}, "connector_pipeline_timer": 0.00039142328135077667}, "env_to_module_connector": {"connector_pipeline_timer": 9.796206308882147e-05, "timers": {"connectors": {"batch_individual_items": 1.4478260247807866e-05, "numpy_to_tensor": 2.7607235560555974e-05, "add_states_from_episodes_to_batch": 3.040363803115201e-06, "add_time_dim_to_batch_and_zero_pad": 6.457990279763267e-06, "add_observations_from_episodes_to_batch": 5.864515990193336e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 100, "env_reset_timer": 0.0002569044933280826, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6038342251809596, "num_env_steps_sampled_lifetime": 25400, "agent_episode_returns_mean": {"default_agent": 1.05}, "weights_seq_no": 5.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_step_timer": 3.369918402649425e-05, "num_episodes": 20, "episode_return_mean": 1.05, "rlmodule_inference_timer": 8.371512613274419e-05, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_duration_sec_mean": 0.01881795908906497, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_max": 20, "time_between_sampling": 6.544081816738412}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "49ad9_00000", "date": "2025-08-11_19-25-47", "timestamp": 1754933147, "time_this_iter_s": 7.39914083480835, "time_total_s": 33.859025955200195, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.859025955200195, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 93.25999999999999, "ram_util_percent": 80.45}}
{"timers": {"training_iteration": 6.208951660082657, "restore_env_runners": 1.7123860602722046e-05, "training_step": 6.2087470933508255, "env_runner_sampling_timer": 5.681960621152697, "learner_update_timer": 0.5191806150725867, "synch_weights": 0.0015198849638925426, "restore_eval_env_runners": 2.2959616388952122e-05, "evaluation_iteration": 0.6220746015713168, "synch_eval_env_connectors": 0.00017137121375259472, "synch_env_connectors": 1.0240468775734771e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.0904964047949667e-05, "numpy_to_tensor": 8.656291558760899e-05, "add_states_from_episodes_to_batch": 7.571115215967849e-06, "batch_individual_items": 4.319105055813349e-05, "add_time_dim_to_batch_and_zero_pad": 1.7708279640723233e-05}}, "connector_pipeline_timer": 0.000263105960524042}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "rlmodule_inference_timer": 0.00017907601717587343, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5520322197825191e-06, "listify_data_for_vector_env": 4.509948632691061e-05, "un_batch_to_individual_items": 2.4118881563867866e-05, "normalize_and_clip_actions": 5.348456081165258e-05, "get_actions": 0.00026730768561104536, "tensor_to_numpy": 6.516896324790574e-05}}, "connector_pipeline_timer": 0.0005880726623380411}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 6.420455226058267e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.02573930499888956, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -123000.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 3.06, "time_between_sampling": 0.007263326972950609, "sample": 0.026546386647096607, "module_episode_returns_mean": {"default_policy": 3.06}, "agent_episode_returns_mean": {"default_agent": 3.06}, "env_reset_timer": 0.00032806604313514483, "num_env_steps_sampled_lifetime": -2460000.0, "num_env_steps_sampled_lifetime_throughput": 1468.4593654675318}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 189000, "learner_connector": {"connector_pipeline_timer": 0.2721728117186165, "timers": {"connectors": {"batch_individual_items": 0.05726842282608284, "numpy_to_tensor": 0.00015675076200364637, "add_states_from_episodes_to_batch": 4.09517921082148e-06, "add_time_dim_to_batch_and_zero_pad": 1.507081682757564e-05, "add_columns_from_episodes_to_train_batch": 0.11580779551571106, "add_one_ts_to_episodes_and_truncate": 0.013830004770048629, "add_observations_from_episodes_to_batch": 0.0009522444461169378, "general_advantage_estimation": 0.08393628116586083}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 709955.146369055, "num_module_steps_trained_throughput": 135254.23803853168, "num_module_steps_trained_lifetime_throughput": 135332.49043768898}, "default_policy": {"entropy": 0.6738317012786865, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 9.713070176076144e-05, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.07187046110630035, "vf_loss_unclipped": 29.362754821777344, "num_module_steps_trained_lifetime": 36000, "policy_loss": -0.1344889998435974, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.011664004996418953, "weights_seq_no": 6.0, "total_loss": -0.0718490481376648, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.011776924133300781, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 135397.8845647565}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.65}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.8935591863029334e-05, "listify_data_for_vector_env": 9.014813590617465e-05, "normalize_and_clip_actions": 4.410487488878611e-05, "remove_single_ts_time_rank_from_batch": 2.64247537654338e-06, "get_actions": 0.0007225670863099043, "tensor_to_numpy": 7.864254585649788e-05}}, "connector_pipeline_timer": 0.0016145287225023213}, "env_to_module_connector": {"connector_pipeline_timer": 0.0002705177290017711, "timers": {"connectors": {"batch_individual_items": 3.492169456184577e-05, "numpy_to_tensor": 8.304899110454095e-05, "add_states_from_episodes_to_batch": 3.171963985730182e-05, "add_time_dim_to_batch_and_zero_pad": 1.4108554156032374e-05, "add_observations_from_episodes_to_batch": 1.2739060108105599e-05}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 120, "env_reset_timer": 0.00028025919759393887, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6137992541792673, "num_env_steps_sampled_lifetime": 30400, "agent_episode_returns_mean": {"default_agent": 0.65}, "weights_seq_no": 6.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_step_timer": 0.00010444963042414006, "num_episodes": 20, "episode_return_mean": 0.65, "rlmodule_inference_timer": 0.0005723177178132609, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_duration_sec_mean": 0.02782361246761866, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_max": 20, "time_between_sampling": 6.56648988607045}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "49ad9_00000", "date": "2025-08-11_19-25-58", "timestamp": 1754933158, "time_this_iter_s": 10.304187774658203, "time_total_s": 44.1632137298584, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.1632137298584, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 95.88000000000001, "ram_util_percent": 82.20000000000002}}
{"timers": {"training_iteration": 6.236522800561488, "restore_env_runners": 1.7070122309321187e-05, "training_step": 6.236313794087872, "env_runner_sampling_timer": 5.7100994516118835, "learner_update_timer": 0.5186032810014173, "synch_weights": 0.001529764035126335, "restore_eval_env_runners": 2.2850439069807164e-05, "evaluation_iteration": 0.6321569055555912, "synch_eval_env_connectors": 0.00020507708214171874, "synch_env_connectors": 1.0289734625866426e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.871192962831851e-05, "numpy_to_tensor": 9.060571620020879e-05, "add_states_from_episodes_to_batch": 5.587306964531063e-06, "batch_individual_items": 3.72248838073054e-05, "add_time_dim_to_batch_and_zero_pad": 1.032474446453423e-05}}, "connector_pipeline_timer": 0.00025299217492471377}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "rlmodule_inference_timer": 0.0002267485649729831, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7742389900135355e-06, "listify_data_for_vector_env": 6.893061466352036e-05, "un_batch_to_individual_items": 2.767133731934073e-05, "normalize_and_clip_actions": 5.370629577656556e-05, "get_actions": 0.00026797157172659016, "tensor_to_numpy": 8.46329463347552e-05}}, "connector_pipeline_timer": 0.0006466059857311344}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 8.95275830834926e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.030023166456725453, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -153875.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 4.5, "time_between_sampling": 0.013637236350659753, "sample": 0.030990130922698853, "module_episode_returns_mean": {"default_policy": 4.5}, "agent_episode_returns_mean": {"default_agent": 4.5}, "env_reset_timer": 0.00032548291417636675, "num_env_steps_sampled_lifetime": -3077500.0, "num_env_steps_sampled_lifetime_throughput": 1241.8281521035333}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 220500, "learner_connector": {"connector_pipeline_timer": 0.2727467956812831, "timers": {"connectors": {"batch_individual_items": 0.05813067568820213, "numpy_to_tensor": 0.0001574474241268945, "add_states_from_episodes_to_batch": 4.092567640803747e-06, "add_time_dim_to_batch_and_zero_pad": 1.5254688622536931e-05, "add_columns_from_episodes_to_train_batch": 0.11540085256058166, "add_one_ts_to_episodes_and_truncate": 0.014280733881512199, "add_observations_from_episodes_to_batch": 0.0009857153313539884, "general_advantage_estimation": 0.08356875085380874}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 718328.4229573205, "num_module_steps_trained_throughput": 136830.86418708644, "num_module_steps_trained_lifetime_throughput": 136919.66521483997}, "default_policy": {"entropy": 0.6708225607872009, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0001997690269490704, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.118752621114254, "vf_loss_unclipped": 29.43939208984375, "num_module_steps_trained_lifetime": 42000, "policy_loss": -0.04945483058691025, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0058320024982094765, "weights_seq_no": 7.0, "total_loss": 0.013212400488555431, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012065649032592773, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 136950.64878743366}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.35}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.3769055504700647e-05, "listify_data_for_vector_env": 2.8212839758508445e-05, "normalize_and_clip_actions": 2.7153795086042373e-05, "remove_single_ts_time_rank_from_batch": 1.549516171841404e-06, "get_actions": 0.00027337937288291733, "tensor_to_numpy": 5.0779064296090265e-05}}, "connector_pipeline_timer": 0.0005873380723365658}, "env_to_module_connector": {"connector_pipeline_timer": 0.00013942827512963105, "timers": {"connectors": {"batch_individual_items": 1.5948669750428884e-05, "numpy_to_tensor": 2.3700950280733213e-05, "add_states_from_episodes_to_batch": 4.21089234175026e-06, "add_time_dim_to_batch_and_zero_pad": 1.1473224062149741e-05, "add_observations_from_episodes_to_batch": 1.2253711784821946e-05}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 140, "env_reset_timer": 0.0002828986959505076, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6140026712275699, "num_env_steps_sampled_lifetime": 35400, "agent_episode_returns_mean": {"default_agent": -0.35}, "weights_seq_no": 7.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_step_timer": 6.243333273864648e-05, "num_episodes": 20, "episode_return_mean": -0.35, "rlmodule_inference_timer": 0.0005467998520955398, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_duration_sec_mean": 0.029889299530768767, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_max": 20, "time_between_sampling": 6.591904149709845}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "49ad9_00000", "date": "2025-08-11_19-26-07", "timestamp": 1754933167, "time_this_iter_s": 9.635724067687988, "time_total_s": 53.79893779754639, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.79893779754639, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 95.99999999999999, "ram_util_percent": 83.6}}
{"timers": {"training_iteration": 6.270064049225352, "restore_env_runners": 1.7063591137221535e-05, "training_step": 6.269851861567953, "env_runner_sampling_timer": 5.742948268764832, "learner_update_timer": 0.5192925194416641, "synch_weights": 0.001533062234858507, "restore_eval_env_runners": 2.329443572531962e-05, "evaluation_iteration": 0.6324783523308128, "synch_eval_env_connectors": 0.00020943964187712636, "synch_env_connectors": 1.0531837578301537e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.6090069640805136e-05, "numpy_to_tensor": 0.00010993171260295764, "add_states_from_episodes_to_batch": 5.568947501445259e-06, "batch_individual_items": 3.674321007926305e-05, "add_time_dim_to_batch_and_zero_pad": 9.993495807126543e-06}}, "connector_pipeline_timer": 0.0002649230729206693}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "rlmodule_inference_timer": 0.00030216637247943074, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.9255367424601186e-06, "listify_data_for_vector_env": 5.2292784817050046e-05, "un_batch_to_individual_items": 3.0619857200159846e-05, "normalize_and_clip_actions": 3.7276776103508324e-05, "get_actions": 0.00034562409427556917, "tensor_to_numpy": 0.00010933484958097364}}, "connector_pipeline_timer": 0.0007141860091567986}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 7.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 7.941382468784447e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.031432217631023385, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -184750.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 3.4599999999999995, "time_between_sampling": 0.008201209904346175, "sample": 0.03232921190433207, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "env_reset_timer": 0.0003289523828901405, "num_env_steps_sampled_lifetime": -3695000.0, "num_env_steps_sampled_lifetime_throughput": 1249.0141018816935}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 252000, "learner_connector": {"connector_pipeline_timer": 0.2754661985543803, "timers": {"connectors": {"batch_individual_items": 0.05908889601134191, "numpy_to_tensor": 0.00015802420025919767, "add_states_from_episodes_to_batch": 4.089552613948651e-06, "add_time_dim_to_batch_and_zero_pad": 1.5268812388417964e-05, "add_columns_from_episodes_to_train_batch": 0.11658451028550834, "add_one_ts_to_episodes_and_truncate": 0.015541388202489887, "add_observations_from_episodes_to_batch": 0.0009897506784689314, "general_advantage_estimation": 0.08288024667553459}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 725644.1328675398, "num_module_steps_trained_throughput": 138209.98496717698, "num_module_steps_trained_lifetime_throughput": 138305.21166890927}, "default_policy": {"entropy": 0.6574549674987793, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0009722818504087627, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.023772811517119408, "vf_loss_unclipped": 29.270179748535156, "num_module_steps_trained_lifetime": 48000, "policy_loss": -0.044244833290576935, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0029160012491047382, "weights_seq_no": 8.0, "total_loss": 0.018546825274825096, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.013218998908996582, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 138308.22166445013}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.55}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.950721219168149e-05, "listify_data_for_vector_env": 3.507682076315973e-05, "normalize_and_clip_actions": 2.8684832974374835e-05, "remove_single_ts_time_rank_from_batch": 2.164908096847155e-06, "get_actions": 0.0004246118545801836, "tensor_to_numpy": 0.00016528338075809233}}, "connector_pipeline_timer": 0.000777154686931925}, "env_to_module_connector": {"connector_pipeline_timer": 0.00013907031965075753, "timers": {"connectors": {"batch_individual_items": 2.5983161433334228e-05, "numpy_to_tensor": 3.435879271274961e-05, "add_states_from_episodes_to_batch": 4.591214290096513e-06, "add_time_dim_to_batch_and_zero_pad": 6.792417103712721e-06, "add_observations_from_episodes_to_batch": 9.087005568453169e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 160, "env_reset_timer": 0.0002843526286810154, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6150565715956646, "num_env_steps_sampled_lifetime": 40400, "agent_episode_returns_mean": {"default_agent": -0.55}, "weights_seq_no": 8.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_step_timer": 6.0265127510637194e-05, "num_episodes": 20, "episode_return_mean": -0.55, "rlmodule_inference_timer": 0.00014161776704863836, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_duration_sec_mean": 0.03396127164480276, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_max": 20, "time_between_sampling": 6.623336650713293}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "49ad9_00000", "date": "2025-08-11_19-26-18", "timestamp": 1754933178, "time_this_iter_s": 10.327479124069214, "time_total_s": 64.1264169216156, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.1264169216156, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 89.20714285714287, "ram_util_percent": 83.91428571428571}}
{"timers": {"training_iteration": 6.2828727845721275, "restore_env_runners": 1.7000045680397917e-05, "training_step": 6.282657528372269, "env_runner_sampling_timer": 5.753840026496938, "learner_update_timer": 0.5212093846671744, "synch_weights": 0.001535699942576573, "restore_eval_env_runners": 2.3253150569002977e-05, "evaluation_iteration": 0.6334910400577165, "synch_eval_env_connectors": 0.00020903483573923065, "synch_env_connectors": 1.051151868559724e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.0235973261792464e-05, "numpy_to_tensor": 6.0290061133246476e-05, "add_states_from_episodes_to_batch": 4.6272526088768195e-06, "batch_individual_items": 2.5889857960945783e-05, "add_time_dim_to_batch_and_zero_pad": 2.5051977074243506e-05}}, "connector_pipeline_timer": 0.00021512330086563008}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "rlmodule_inference_timer": 0.00017099719253725674, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.5535291612801337e-06, "listify_data_for_vector_env": 4.13022976975793e-05, "un_batch_to_individual_items": 1.687473053552725e-05, "normalize_and_clip_actions": 4.502163515408114e-05, "get_actions": 0.00021915090595214337, "tensor_to_numpy": 9.369669615696941e-05}}, "connector_pipeline_timer": 0.0005507502534765532}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 8.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 7.426442011307506e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.023668487492483105, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -215625.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 5.460000000000001, "time_between_sampling": 0.008466946510311085, "sample": 0.028919073039081495, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "env_reset_timer": 0.0003472216119892474, "num_env_steps_sampled_lifetime": -4312500.0, "num_env_steps_sampled_lifetime_throughput": 1494.01853590379}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 283500, "learner_connector": {"connector_pipeline_timer": 0.2787008453183949, "timers": {"connectors": {"batch_individual_items": 0.0589538303916817, "numpy_to_tensor": 0.00015763437826393884, "add_states_from_episodes_to_batch": 4.095326826176364e-06, "add_time_dim_to_batch_and_zero_pad": 1.5314034968252448e-05, "add_columns_from_episodes_to_train_batch": 0.11686670393274855, "add_one_ts_to_episodes_and_truncate": 0.01939490849000703, "add_observations_from_episodes_to_batch": 0.0009886373317022092, "general_advantage_estimation": 0.08211614253844028}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 726898.2126924037, "num_module_steps_trained_throughput": 138448.82801725873, "num_module_steps_trained_lifetime_throughput": 138545.1958007297}, "default_policy": {"entropy": 0.6512721180915833, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0005018218071199954, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.04388493672013283, "vf_loss_unclipped": 29.713878631591797, "num_module_steps_trained_lifetime": 54000, "policy_loss": -0.10784247517585754, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0014580006245523691, "weights_seq_no": 9.0, "total_loss": -0.044999025762081146, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012197732925415039, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 138536.65786501276}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.35}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.4386014358890524e-05, "listify_data_for_vector_env": 7.508470717153471e-05, "normalize_and_clip_actions": 9.05876928655672e-05, "remove_single_ts_time_rank_from_batch": 2.3831183981099717e-06, "get_actions": 0.0006204798108640973, "tensor_to_numpy": 0.00028414489944350395}}, "connector_pipeline_timer": 0.0013045829808226625}, "env_to_module_connector": {"connector_pipeline_timer": 0.00030855433529361357, "timers": {"connectors": {"batch_individual_items": 0.00013661232074478212, "numpy_to_tensor": 5.254405421724465e-05, "add_states_from_episodes_to_batch": 5.780761681789065e-06, "add_time_dim_to_batch_and_zero_pad": 1.3280775268678978e-05, "add_observations_from_episodes_to_batch": 1.7325556443163794e-05}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 180, "env_reset_timer": 0.000307045771812421, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6197061917095746, "num_env_steps_sampled_lifetime": 45400, "agent_episode_returns_mean": {"default_agent": -0.35}, "weights_seq_no": 9.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_step_timer": 0.0001876020024962609, "num_episodes": 20, "episode_return_mean": -0.35, "rlmodule_inference_timer": 0.0007185984317701153, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_duration_sec_mean": 0.04063415039563552, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.633924252955395}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "49ad9_00000", "date": "2025-08-11_19-26-27", "timestamp": 1754933187, "time_this_iter_s": 8.650240898132324, "time_total_s": 72.77665781974792, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 72.77665781974792, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 78.30833333333334, "ram_util_percent": 82.99166666666666}}
{"timers": {"training_iteration": 6.296317008816191, "restore_env_runners": 1.6940885415658577e-05, "training_step": 6.296100269758332, "env_runner_sampling_timer": 5.763341744142333, "learner_update_timer": 0.5250808966505945, "synch_weights": 0.0015607941929570177, "restore_eval_env_runners": 2.3163538661460222e-05, "evaluation_iteration": 0.6381175775775567, "synch_eval_env_connectors": 0.0002089569869899378, "synch_env_connectors": 1.0526823507639048e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.036994349334488e-05, "numpy_to_tensor": 5.099881148806827e-05, "add_states_from_episodes_to_batch": 4.909096062408254e-06, "batch_individual_items": 2.4833048647070138e-05, "add_time_dim_to_batch_and_zero_pad": 1.5963904799384802e-05}}, "connector_pipeline_timer": 0.00018840761839340907}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "rlmodule_inference_timer": 0.00017582051889964445, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.8235419075171349e-06, "listify_data_for_vector_env": 6.227611523029824e-05, "un_batch_to_individual_items": 1.7139537972958166e-05, "normalize_and_clip_actions": 4.1246069774690973e-05, "get_actions": 0.0002738819865747584, "tensor_to_numpy": 7.04469797584548e-05}}, "connector_pipeline_timer": 0.0005742144288495473}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 9.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 6.532485847395997e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.02342621568683534, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -246500.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 6.659999999999997, "time_between_sampling": 0.00954691727891455, "sample": 0.024715770634746018, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "env_reset_timer": 0.000155378662257929, "num_env_steps_sampled_lifetime": -4930000.0, "num_env_steps_sampled_lifetime_throughput": 1570.2689986580929}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 315000, "learner_connector": {"connector_pipeline_timer": 0.2843009539449029, "timers": {"connectors": {"batch_individual_items": 0.06587199749800883, "numpy_to_tensor": 0.00015811178469453508, "add_states_from_episodes_to_batch": 4.096044422362551e-06, "add_time_dim_to_batch_and_zero_pad": 1.553006390222819e-05, "add_columns_from_episodes_to_train_batch": 0.1161409152237803, "add_one_ts_to_episodes_and_truncate": 0.019353421075911727, "add_observations_from_episodes_to_batch": 0.0009969197079057422, "general_advantage_estimation": 0.08155616277351804}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 723802.3928041839, "num_module_steps_trained_throughput": 137862.80491575162, "num_module_steps_trained_lifetime_throughput": 137956.19561395873}, "default_policy": {"entropy": 0.6437965035438538, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.00037937649176456034, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.04102873429656029, "vf_loss_unclipped": 29.858129501342773, "num_module_steps_trained_lifetime": 60000, "policy_loss": -0.08268185704946518, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0007290003122761846, "weights_seq_no": 10.0, "total_loss": -0.019771618768572807, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.01230764389038086, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 137940.51389841654}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.45}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.2772851871896382e-05, "listify_data_for_vector_env": 3.677973079761083e-05, "normalize_and_clip_actions": 2.6367980091928524e-05, "remove_single_ts_time_rank_from_batch": 1.1944936327954524e-06, "get_actions": 0.00019077618033674267, "tensor_to_numpy": 6.734274550237887e-05}}, "connector_pipeline_timer": 0.0005099282332434935}, "env_to_module_connector": {"connector_pipeline_timer": 0.0001678958442708495, "timers": {"connectors": {"batch_individual_items": 2.3324862598178374e-05, "numpy_to_tensor": 6.340062086677906e-05, "add_states_from_episodes_to_batch": 3.464237861090418e-06, "add_time_dim_to_batch_and_zero_pad": 9.678316236976748e-06, "add_observations_from_episodes_to_batch": 6.472186653394679e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 200, "env_reset_timer": 0.0003116419836474425, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6179069718721127, "num_env_steps_sampled_lifetime": 50400, "agent_episode_returns_mean": {"default_agent": 0.45}, "weights_seq_no": 10.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_step_timer": 4.6424682650210395e-05, "num_episodes": 20, "episode_return_mean": 0.45, "rlmodule_inference_timer": 0.00010380477177199695, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_duration_sec_mean": 0.04077171752694994, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.644787711675466}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "49ad9_00000", "date": "2025-08-11_19-26-35", "timestamp": 1754933195, "time_this_iter_s": 8.12965703010559, "time_total_s": 80.90631484985352, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.90631484985352, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 93.27272727272727, "ram_util_percent": 82.25454545454544}}
{"timers": {"training_iteration": 6.2951614920673755, "restore_env_runners": 1.6831475854218377e-05, "training_step": 6.294944092890789, "env_runner_sampling_timer": 5.7650705087802585, "learner_update_timer": 0.5221844635147073, "synch_weights": 0.0015717233320213233, "restore_eval_env_runners": 2.3141483450424215e-05, "evaluation_iteration": 0.6363737693013077, "synch_eval_env_connectors": 0.00021089908693417802, "synch_env_connectors": 1.0506554755641375e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.570540014383688e-06, "numpy_to_tensor": 3.88355190456703e-05, "add_states_from_episodes_to_batch": 5.532698192446947e-06, "batch_individual_items": 3.3445910077122856e-05, "add_time_dim_to_batch_and_zero_pad": 9.826830608650133e-06}}, "connector_pipeline_timer": 0.0001675654628196108}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "rlmodule_inference_timer": 0.00012383874622062715, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5751576725403098e-06, "listify_data_for_vector_env": 3.7235324743211134e-05, "un_batch_to_individual_items": 2.537015328428756e-05, "normalize_and_clip_actions": 4.024435150873122e-05, "get_actions": 0.00019950071574945805, "tensor_to_numpy": 5.653591207916861e-05}}, "connector_pipeline_timer": 0.0004741624946896783}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 10.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 7.304142185516965e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.020334062466863544, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -277375.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 5.940000000000001, "time_between_sampling": 0.007934956449738077, "sample": 0.02186528400223576, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "env_reset_timer": 0.0002822775720295753, "num_env_steps_sampled_lifetime": -5547500.0, "num_env_steps_sampled_lifetime_throughput": 1696.9848734124996}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 346500, "learner_connector": {"connector_pipeline_timer": 0.2834076973250626, "timers": {"connectors": {"batch_individual_items": 0.06641747461314787, "numpy_to_tensor": 0.00015731025718419562, "add_states_from_episodes_to_batch": 4.092583681605818e-06, "add_time_dim_to_batch_and_zero_pad": 1.586726293880763e-05, "add_columns_from_episodes_to_train_batch": 0.11546293024148523, "add_one_ts_to_episodes_and_truncate": 0.01931236020542924, "add_observations_from_episodes_to_batch": 0.0010174255112118799, "general_advantage_estimation": 0.0808164861461887}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 722660.142639394, "num_module_steps_trained_throughput": 137653.1701366743, "num_module_steps_trained_lifetime_throughput": 137742.76139117568}, "default_policy": {"entropy": 0.6329572796821594, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.00017876990023069084, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.044992342591285706, "vf_loss_unclipped": 29.646411895751953, "num_module_steps_trained_lifetime": 66000, "policy_loss": -0.03828921541571617, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0003645001561380923, "weights_seq_no": 11.0, "total_loss": 0.024718768894672394, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.014516830444335938, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 137723.11412140998}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.25}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.099745308291053e-05, "listify_data_for_vector_env": 3.244628560405063e-05, "normalize_and_clip_actions": 2.309995895019914e-05, "remove_single_ts_time_rank_from_batch": 1.2242698439646099e-06, "get_actions": 0.00031583638724360264, "tensor_to_numpy": 4.484170951122076e-05}}, "connector_pipeline_timer": 0.0005003413291520978}, "env_to_module_connector": {"connector_pipeline_timer": 0.0001805029249140364, "timers": {"connectors": {"batch_individual_items": 3.575063423349324e-05, "numpy_to_tensor": 2.61962977567822e-05, "add_states_from_episodes_to_batch": 3.7529890438489062e-06, "add_time_dim_to_batch_and_zero_pad": 3.839185583141712e-05, "add_observations_from_episodes_to_batch": 8.580137782162638e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 220, "env_reset_timer": 0.0003097905641300764, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6150093209032214, "num_env_steps_sampled_lifetime": 55400, "agent_episode_returns_mean": {"default_agent": 0.25}, "weights_seq_no": 11.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_step_timer": 4.3797484360246424e-05, "num_episodes": 20, "episode_return_mean": 0.25, "rlmodule_inference_timer": 0.00011880325309056479, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_duration_sec_mean": 0.028984047507401557, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.640568244559391}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "49ad9_00000", "date": "2025-08-11_19-26-41", "timestamp": 1754933201, "time_this_iter_s": 6.522878885269165, "time_total_s": 87.42919373512268, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.42919373512268, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 91.32, "ram_util_percent": 82.4}}
{"timers": {"training_iteration": 6.292119186726227, "restore_env_runners": 1.6748580838066707e-05, "training_step": 6.29190182613283, "env_runner_sampling_timer": 5.765211584942144, "learner_update_timer": 0.5190247788797653, "synch_weights": 0.0015687135982554907, "restore_eval_env_runners": 2.3050478299728655e-05, "evaluation_iteration": 0.6334026545285134, "synch_eval_env_connectors": 0.0002100596761627053, "synch_env_connectors": 1.0671899881777784e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.066963639598012e-05, "numpy_to_tensor": 3.634142613153694e-05, "add_states_from_episodes_to_batch": 4.199285972075638e-06, "batch_individual_items": 2.3422813725838363e-05, "add_time_dim_to_batch_and_zero_pad": 7.120733411443469e-06}}, "connector_pipeline_timer": 0.00015082543650761043}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "rlmodule_inference_timer": 0.00014644452496371258, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4896143850750182e-06, "listify_data_for_vector_env": 3.578432055689657e-05, "un_batch_to_individual_items": 1.7347495692849955e-05, "normalize_and_clip_actions": 3.299022779127093e-05, "get_actions": 0.0002105149652466345, "tensor_to_numpy": 5.550396703906569e-05}}, "connector_pipeline_timer": 0.00043582161881175756}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 11.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 6.684245279493223e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.018879939360078427, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -308250.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 6.659999999999997, "time_between_sampling": 0.005727006178510855, "sample": 0.02187351446854789, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "env_reset_timer": 0.00032805800254837725, "num_env_steps_sampled_lifetime": -6165000.0, "num_env_steps_sampled_lifetime_throughput": 1698.0815645387183}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 378000, "learner_connector": {"connector_pipeline_timer": 0.28241470619136294, "timers": {"connectors": {"batch_individual_items": 0.06634762903626928, "numpy_to_tensor": 0.00015692798440161964, "add_states_from_episodes_to_batch": 4.091656985216277e-06, "add_time_dim_to_batch_and_zero_pad": 1.5850670553096453e-05, "add_columns_from_episodes_to_train_batch": 0.1153696080296378, "add_one_ts_to_episodes_and_truncate": 0.0191983241031369, "add_observations_from_episodes_to_batch": 0.0010156562560711508, "general_advantage_estimation": 0.0801028341941448}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 732093.1345689439, "num_module_steps_trained_throughput": 139508.3418539397, "num_module_steps_trained_lifetime_throughput": 139592.2330406189}, "default_policy": {"entropy": 0.6306999921798706, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 3.76364951080177e-05, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.04603158310055733, "vf_loss_unclipped": 29.652629852294922, "num_module_steps_trained_lifetime": 72000, "policy_loss": 0.05211615562438965, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.00018225007806904614, "weights_seq_no": 12.0, "total_loss": 0.11514448374509811, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.015211820602416992, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 139566.36772715452}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.25}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5802862408703257e-05, "listify_data_for_vector_env": 2.9394835508092518e-05, "normalize_and_clip_actions": 3.1121645947205435e-05, "remove_single_ts_time_rank_from_batch": 1.2901948412206442e-06, "get_actions": 0.0001271767087211744, "tensor_to_numpy": 4.9662972240027737e-05}}, "connector_pipeline_timer": 0.00032536090813381166}, "env_to_module_connector": {"connector_pipeline_timer": 0.0001362586106269086, "timers": {"connectors": {"batch_individual_items": 2.798154646146797e-05, "numpy_to_tensor": 3.267193811747209e-05, "add_states_from_episodes_to_batch": 3.741552038733852e-06, "add_time_dim_to_batch_and_zero_pad": 1.3928989887534044e-05, "add_observations_from_episodes_to_batch": 7.15602829074335e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "num_episodes_lifetime": 240, "env_reset_timer": 0.0003202997388161226, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.612015147274211, "num_env_steps_sampled_lifetime": 60400, "agent_episode_returns_mean": {"default_agent": 1.25}, "weights_seq_no": 12.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_step_timer": 4.4724092615782354e-05, "num_episodes": 20, "episode_return_mean": 1.25, "rlmodule_inference_timer": 0.00014070598683769736, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_duration_sec_mean": 0.026259414157830178, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.634653445033201}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "49ad9_00000", "date": "2025-08-11_19-26-48", "timestamp": 1754933208, "time_this_iter_s": 6.340274095535278, "time_total_s": 93.76946783065796, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 93.76946783065796, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 78.6875, "ram_util_percent": 82.2375}}
{"timers": {"training_iteration": 6.293830174438894, "restore_env_runners": 2.014068441567237e-05, "training_step": 6.293598748291691, "env_runner_sampling_timer": 5.769308477842334, "learner_update_timer": 0.5166592831807679, "synch_weights": 0.001565989382864171, "restore_eval_env_runners": 2.2893723787261952e-05, "evaluation_iteration": 0.6305361788127468, "synch_eval_env_connectors": 0.00021249824900503695, "synch_env_connectors": 1.178434034079258e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.91487559071934e-05, "numpy_to_tensor": 3.743522456051042e-05, "add_states_from_episodes_to_batch": 4.729551927608039e-06, "batch_individual_items": 2.038953838244546e-05, "add_time_dim_to_batch_and_zero_pad": 8.755869552731443e-06}}, "connector_pipeline_timer": 0.00015336438868777667}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "rlmodule_inference_timer": 0.00011579594219449229, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 3.2030811115010243e-06, "listify_data_for_vector_env": 4.947197145020878e-05, "un_batch_to_individual_items": 1.6195687838791018e-05, "normalize_and_clip_actions": 3.0422277888532184e-05, "get_actions": 0.00021523911023082514, "tensor_to_numpy": 6.561930197563903e-05}}, "connector_pipeline_timer": 0.000497661399172787}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 12.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 6.074149915868689e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.02030273334868252, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -339125.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 7.46, "time_between_sampling": 0.004821206415526712, "sample": 0.019380822175926852, "module_episode_returns_mean": {"default_policy": 7.46}, "agent_episode_returns_mean": {"default_agent": 7.46}, "env_reset_timer": 0.0001647028657169922, "num_env_steps_sampled_lifetime": -6782500.0, "num_env_steps_sampled_lifetime_throughput": 1707.4849720367606}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 409500, "learner_connector": {"connector_pipeline_timer": 0.2812302791295431, "timers": {"connectors": {"batch_individual_items": 0.06610074858626756, "numpy_to_tensor": 0.00015611454384025023, "add_states_from_episodes_to_batch": 4.277399882807937e-06, "add_time_dim_to_batch_and_zero_pad": 1.5803413821562962e-05, "add_columns_from_episodes_to_train_batch": 0.11483762902911683, "add_one_ts_to_episodes_and_truncate": 0.01950947878285584, "add_observations_from_episodes_to_batch": 0.0010273742838216389, "general_advantage_estimation": 0.07937495126248216}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 734311.3113054238, "num_module_steps_trained_throughput": 139980.8664036199, "num_module_steps_trained_lifetime_throughput": 140058.0380271535}, "default_policy": {"entropy": 0.6363987922668457, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0001085606127162464, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.12169253826141357, "vf_loss_unclipped": 30.071489334106445, "num_module_steps_trained_lifetime": 78000, "policy_loss": -0.14317864179611206, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 9.112503903452307e-05, "weights_seq_no": 13.0, "total_loss": -0.08020195364952087, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012235283851623535, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 140031.37547088173}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.09216472964376e-06, "listify_data_for_vector_env": 2.1107541584759047e-05, "normalize_and_clip_actions": 1.755259153411688e-05, "remove_single_ts_time_rank_from_batch": 9.862888149764793e-07, "get_actions": 8.574822377927828e-05, "tensor_to_numpy": 2.4249468758456535e-05}}, "connector_pipeline_timer": 0.00020560275716270093}, "env_to_module_connector": {"connector_pipeline_timer": 0.00010169282140495859, "timers": {"connectors": {"batch_individual_items": 1.7913855296326015e-05, "numpy_to_tensor": 2.280379899145572e-05, "add_states_from_episodes_to_batch": 1.433886920785913e-05, "add_time_dim_to_batch_and_zero_pad": 4.563286957173956e-06, "add_observations_from_episodes_to_batch": 5.589146341053499e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_len_min": 20, "num_episodes_lifetime": 260, "env_reset_timer": 0.0003213263312590454, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6083024937210991, "num_env_steps_sampled_lifetime": 65400, "agent_episode_returns_mean": {"default_agent": 1.05}, "weights_seq_no": 13.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_step_timer": 3.415959248920547e-05, "num_episodes": 20, "episode_return_mean": 1.05, "rlmodule_inference_timer": 6.831491509290888e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_duration_sec_mean": 0.02169415167532861, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.63343656142224}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "49ad9_00000", "date": "2025-08-11_19-26-54", "timestamp": 1754933214, "time_this_iter_s": 6.720771074295044, "time_total_s": 100.490238904953, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 100.490238904953, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 81.85, "ram_util_percent": 82.32000000000001}}
{"timers": {"training_iteration": 6.286715298944641, "restore_env_runners": 2.0073448558227626e-05, "training_step": 6.286482646228689, "env_runner_sampling_timer": 5.76300215931369, "learner_update_timer": 0.5158908899388833, "synch_weights": 0.0015565923993550216, "restore_eval_env_runners": 2.2784376517042486e-05, "evaluation_iteration": 0.62677891369469, "synch_eval_env_connectors": 0.00021503659655213337, "synch_env_connectors": 1.1706076982652596e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.83077833973485e-05, "numpy_to_tensor": 3.523449795776983e-05, "add_states_from_episodes_to_batch": 4.361322299464402e-06, "batch_individual_items": 2.4128921944328335e-05, "add_time_dim_to_batch_and_zero_pad": 1.0972459443491799e-05}}, "connector_pipeline_timer": 0.00015079860741343132}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "rlmodule_inference_timer": 0.00012243827089531605, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.0867485693177616e-06, "listify_data_for_vector_env": 4.165705548546382e-05, "un_batch_to_individual_items": 2.1375241621477306e-05, "normalize_and_clip_actions": 2.9691548971520495e-05, "get_actions": 0.00018626256982056012, "tensor_to_numpy": 4.9570096026913846e-05}}, "connector_pipeline_timer": 0.00041065310163910065}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 13.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 5.815956692764799e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.017704171502497045, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -370000.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 7.54, "time_between_sampling": 0.005066602296273464, "sample": 0.020296125658700623, "module_episode_returns_mean": {"default_policy": 7.54}, "agent_episode_returns_mean": {"default_agent": 7.54}, "env_reset_timer": 0.0001362557983691929, "num_env_steps_sampled_lifetime": -7400000.0, "num_env_steps_sampled_lifetime_throughput": 1621.7537301665627}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 441000, "learner_connector": {"connector_pipeline_timer": 0.2826382488387813, "timers": {"connectors": {"batch_individual_items": 0.06859677318016674, "numpy_to_tensor": 0.0001552538181705388, "add_states_from_episodes_to_batch": 4.3575464939904816e-06, "add_time_dim_to_batch_and_zero_pad": 1.5927039569588293e-05, "add_columns_from_episodes_to_train_batch": 0.1145499023189616, "add_one_ts_to_episodes_and_truncate": 0.019406096494297496, "add_observations_from_episodes_to_batch": 0.00102558512130466, "general_advantage_estimation": 0.07868050965969806}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 750123.7727326199, "num_module_steps_trained_throughput": 143028.0837188385, "num_module_steps_trained_lifetime_throughput": 143098.09319964968}, "default_policy": {"entropy": 0.6132097840309143, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0007894618902355433, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.08184441179037094, "vf_loss_unclipped": 29.760150909423828, "num_module_steps_trained_lifetime": 84000, "policy_loss": 0.05362187325954437, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 4.5562519517261535e-05, "weights_seq_no": 14.0, "total_loss": 0.11680866777896881, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.015738248825073242, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 143065.10488260956}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.45}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.2818628936295738e-05, "listify_data_for_vector_env": 0.00012426633115013189, "normalize_and_clip_actions": 3.2677552539275834e-05, "remove_single_ts_time_rank_from_batch": 1.2691663560719086e-06, "get_actions": 0.0001438129630719081, "tensor_to_numpy": 6.288059170934518e-05}}, "connector_pipeline_timer": 0.00046335061809539465}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012544512449955367, "timers": {"connectors": {"batch_individual_items": 1.940946737991035e-05, "numpy_to_tensor": 3.0181761546508825e-05, "add_states_from_episodes_to_batch": 1.000734777681531e-05, "add_time_dim_to_batch_and_zero_pad": 7.432454355587459e-06, "add_observations_from_episodes_to_batch": 8.484729061456816e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_len_min": 20, "num_episodes_lifetime": 280, "env_reset_timer": 0.000318918068255356, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6055352542040153, "num_env_steps_sampled_lifetime": 70400, "agent_episode_returns_mean": {"default_agent": 1.45}, "weights_seq_no": 14.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_step_timer": 4.435097485706723e-05, "num_episodes": 20, "episode_return_mean": 1.45, "rlmodule_inference_timer": 0.00014891397503369715, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_duration_sec_mean": 0.015484220843063667, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.623926623727945}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "49ad9_00000", "date": "2025-08-11_19-27-00", "timestamp": 1754933220, "time_this_iter_s": 5.930070161819458, "time_total_s": 106.42030906677246, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.42030906677246, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 77.82499999999999, "ram_util_percent": 82.4125}}
{"timers": {"training_iteration": 6.286771620535942, "restore_env_runners": 1.993771456758742e-05, "training_step": 6.286539065606081, "env_runner_sampling_timer": 5.762347742309651, "learner_update_timer": 0.516580435619904, "synch_weights": 0.0015698098051239897, "restore_eval_env_runners": 2.2636532196878314e-05, "evaluation_iteration": 0.6239616308069529, "synch_eval_env_connectors": 0.000214077060375878, "synch_env_connectors": 1.1634016555478272e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.256632039555725e-05, "numpy_to_tensor": 3.759039648763587e-05, "add_states_from_episodes_to_batch": 4.678131833580261e-06, "batch_individual_items": 2.799760536166866e-05, "add_time_dim_to_batch_and_zero_pad": 9.871292539420432e-06}}, "connector_pipeline_timer": 0.00015132406473119747}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "rlmodule_inference_timer": 0.0001331089927685778, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.5776609259393044e-06, "listify_data_for_vector_env": 4.451028171806846e-05, "un_batch_to_individual_items": 1.646451657666184e-05, "normalize_and_clip_actions": 3.187843569091993e-05, "get_actions": 0.00018372084469700295, "tensor_to_numpy": 5.5098800887170506e-05}}, "connector_pipeline_timer": 0.0004146292644403938}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 14.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 7.363928555191332e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.0188533253413625, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -400875.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 7.46, "time_between_sampling": 0.00537933225834055, "sample": 0.019971416716849356, "module_episode_returns_mean": {"default_policy": 7.46}, "agent_episode_returns_mean": {"default_agent": 7.46}, "env_reset_timer": 0.0003796550545122876, "num_env_steps_sampled_lifetime": -8017500.0, "num_env_steps_sampled_lifetime_throughput": 1686.700425677873}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 472500, "learner_connector": {"connector_pipeline_timer": 0.28444483718081914, "timers": {"connectors": {"batch_individual_items": 0.07066022919857562, "numpy_to_tensor": 0.00015492668978529488, "add_states_from_episodes_to_batch": 4.378140318594801e-06, "add_time_dim_to_batch_and_zero_pad": 1.5965689190836816e-05, "add_columns_from_episodes_to_train_batch": 0.114767723715104, "add_one_ts_to_episodes_and_truncate": 0.019328933029474624, "add_observations_from_episodes_to_batch": 0.0010349746804486563, "general_advantage_estimation": 0.07827396914311803}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 756990.5593409737, "num_module_steps_trained_throughput": 144354.2691719072, "num_module_steps_trained_lifetime_throughput": 144419.13621572926}, "default_policy": {"entropy": 0.5918295383453369, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0018565247301012278, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.04784759134054184, "vf_loss_unclipped": 29.84295654296875, "num_module_steps_trained_lifetime": 90000, "policy_loss": -0.051738157868385315, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 2.2781259758630767e-05, "weights_seq_no": 15.0, "total_loss": 0.01164228841662407, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.01546335220336914, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 144381.66342679746}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.65}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.6217133905180998e-05, "listify_data_for_vector_env": 0.000141288173515667, "normalize_and_clip_actions": 4.393872154527104e-05, "remove_single_ts_time_rank_from_batch": 1.3384454862879182e-06, "get_actions": 0.00017610041705009145, "tensor_to_numpy": 7.004184307828618e-05}}, "connector_pipeline_timer": 0.0005431455447138336}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012717738785682464, "timers": {"connectors": {"batch_individual_items": 2.2961416859594856e-05, "numpy_to_tensor": 2.622337546379849e-05, "add_states_from_episodes_to_batch": 4.824903844111611e-06, "add_time_dim_to_batch_and_zero_pad": 7.071227956953454e-06, "add_observations_from_episodes_to_batch": 7.464294460217557e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_len_min": 20, "num_episodes_lifetime": 300, "env_reset_timer": 0.000320904307655908, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.6030579737521428, "num_env_steps_sampled_lifetime": 75400, "agent_episode_returns_mean": {"default_agent": 0.65}, "weights_seq_no": 15.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_step_timer": 4.9294834832358034e-05, "num_episodes": 20, "episode_return_mean": 0.65, "rlmodule_inference_timer": 0.00010961266550908176, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_duration_sec_mean": 0.01468814543215558, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.621098440830845}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "49ad9_00000", "date": "2025-08-11_19-27-07", "timestamp": 1754933227, "time_this_iter_s": 6.676372766494751, "time_total_s": 113.09668183326721, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 113.09668183326721, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 80.73333333333333, "ram_util_percent": 82.44444444444444}}
{"timers": {"training_iteration": 6.272048760580728, "restore_env_runners": 1.9842087920876926e-05, "training_step": 6.271808357450988, "env_runner_sampling_timer": 5.750644367386213, "learner_update_timer": 0.5135733212643563, "synch_weights": 0.00156348045710665, "restore_eval_env_runners": 2.253141692505194e-05, "evaluation_iteration": 0.6215232190785328, "synch_eval_env_connectors": 0.00021765129021527975, "synch_env_connectors": 1.1596836480459367e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 9.795281043895154e-06, "numpy_to_tensor": 3.154295667530767e-05, "add_states_from_episodes_to_batch": 4.305432831478455e-06, "batch_individual_items": 2.0745218143429134e-05, "add_time_dim_to_batch_and_zero_pad": 9.268693055990957e-06}}, "connector_pipeline_timer": 0.00012903438578849993}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "rlmodule_inference_timer": 0.00011404447364661568, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.8275303202116534e-06, "listify_data_for_vector_env": 3.887816486711505e-05, "un_batch_to_individual_items": 1.4159063132274539e-05, "normalize_and_clip_actions": 2.792843742384943e-05, "get_actions": 0.00015742744634624146, "tensor_to_numpy": 4.8671718874953165e-05}}, "connector_pipeline_timer": 0.00035494068250943654}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 15.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 4.989268822875666e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.01540392184117809, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -431750.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 8.1, "time_between_sampling": 0.0060684503318747555, "sample": 0.01784434977860617, "module_episode_returns_mean": {"default_policy": 8.1}, "agent_episode_returns_mean": {"default_agent": 8.1}, "env_reset_timer": 0.00024303435740329662, "num_env_steps_sampled_lifetime": -8635000.0, "num_env_steps_sampled_lifetime_throughput": 1857.9967998299376}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 504000, "learner_connector": {"connector_pipeline_timer": 0.28352223338922167, "timers": {"connectors": {"batch_individual_items": 0.07034260023743592, "numpy_to_tensor": 0.000154290342527983, "add_states_from_episodes_to_batch": 4.372268400808576e-06, "add_time_dim_to_batch_and_zero_pad": 1.664061141279931e-05, "add_columns_from_episodes_to_train_batch": 0.11487765980833396, "add_one_ts_to_episodes_and_truncate": 0.019288921609028717, "add_observations_from_episodes_to_batch": 0.0010381849332870635, "general_advantage_estimation": 0.07759583653109778}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 774377.0210970233, "num_module_steps_trained_throughput": 147662.57435081396, "num_module_steps_trained_lifetime_throughput": 147722.66650454153}, "default_policy": {"entropy": 0.5738593339920044, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.000879815430380404, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.027136243879795074, "vf_loss_unclipped": 29.875362396240234, "num_module_steps_trained_lifetime": 96000, "policy_loss": -0.028655797243118286, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 1.1390629879315384e-05, "weights_seq_no": 16.0, "total_loss": 0.03488733619451523, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.015216827392578125, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 147672.86948745788}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.25}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4903003213935321e-05, "listify_data_for_vector_env": 3.211618949824222e-05, "normalize_and_clip_actions": 2.8964702565676577e-05, "remove_single_ts_time_rank_from_batch": 3.208380051733914e-06, "get_actions": 0.0001371724777848322, "tensor_to_numpy": 3.586372513742858e-05}}, "connector_pipeline_timer": 0.0003174031634870462}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011265167591544525, "timers": {"connectors": {"batch_individual_items": 1.5583333535659273e-05, "numpy_to_tensor": 2.3905076160819373e-05, "add_states_from_episodes_to_batch": 3.1484476568698214e-06, "add_time_dim_to_batch_and_zero_pad": 1.1545123208657192e-05, "add_observations_from_episodes_to_batch": 1.1960673390428793e-05}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_len_min": 20, "num_episodes_lifetime": 320, "env_reset_timer": 0.0003185752642951838, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.60051479276477, "num_env_steps_sampled_lifetime": 80400, "agent_episode_returns_mean": {"default_agent": 1.25}, "weights_seq_no": 16.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_step_timer": 4.1487788685623026e-05, "num_episodes": 20, "episode_return_mean": 1.25, "rlmodule_inference_timer": 7.413765802308464e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_duration_sec_mean": 0.014816360012628139, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.603529329343098}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "49ad9_00000", "date": "2025-08-11_19-27-12", "timestamp": 1754933232, "time_this_iter_s": 5.175806045532227, "time_total_s": 118.27248787879944, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 118.27248787879944, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 88.0625, "ram_util_percent": 82.075}}
{"timers": {"training_iteration": 6.265339547974395, "restore_env_runners": 1.9714506929153065e-05, "training_step": 6.265098750957091, "env_runner_sampling_timer": 5.746997038712001, "learner_update_timer": 0.5104934218011857, "synch_weights": 0.001568548982473116, "restore_eval_env_runners": 2.239235370358978e-05, "evaluation_iteration": 0.6188847110572905, "synch_eval_env_connectors": 0.00021805518694984798, "synch_env_connectors": 1.1523788116505926e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.0439853449609967e-05, "numpy_to_tensor": 3.646911927661276e-05, "add_states_from_episodes_to_batch": 5.9852990717928785e-06, "batch_individual_items": 2.069107699175793e-05, "add_time_dim_to_batch_and_zero_pad": 6.961961356019594e-06}}, "connector_pipeline_timer": 0.00014338224775598929}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "rlmodule_inference_timer": 0.00017780393969580194, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3935101215081307e-06, "listify_data_for_vector_env": 3.844653573596268e-05, "un_batch_to_individual_items": 1.9737670029481595e-05, "normalize_and_clip_actions": 3.080490426027993e-05, "get_actions": 0.00018397014814016383, "tensor_to_numpy": 4.559615313966194e-05}}, "connector_pipeline_timer": 0.0004014354185545317}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 16.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 5.589091339741778e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.018439215509220955, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -462625.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 7.940000000000001, "time_between_sampling": 0.004878729861904364, "sample": 0.01874218710362329, "module_episode_returns_mean": {"default_policy": 7.940000000000001}, "agent_episode_returns_mean": {"default_agent": 7.940000000000001}, "env_reset_timer": 0.00013141591273959757, "num_env_steps_sampled_lifetime": -9252500.0, "num_env_steps_sampled_lifetime_throughput": 1713.3190621542446}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 535500, "learner_connector": {"connector_pipeline_timer": 0.28212444563620503, "timers": {"connectors": {"batch_individual_items": 0.0701173467352137, "numpy_to_tensor": 0.00015436326863566918, "add_states_from_episodes_to_batch": 4.3652153790227565e-06, "add_time_dim_to_batch_and_zero_pad": 1.661670580166001e-05, "add_columns_from_episodes_to_train_batch": 0.11434659404066157, "add_one_ts_to_episodes_and_truncate": 0.019298085302819307, "add_observations_from_episodes_to_batch": 0.0010408860031308608, "general_advantage_estimation": 0.0769409706652534}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 786457.2297299732, "num_module_steps_trained_throughput": 149958.8526666581, "num_module_steps_trained_lifetime_throughput": 150014.58795787135}, "default_policy": {"entropy": 0.5342195630073547, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0022154797334223986, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.2044783979654312, "vf_loss_unclipped": 29.69392204284668, "num_module_steps_trained_lifetime": 102000, "policy_loss": 0.0521533340215683, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 5.695314939657692e-06, "weights_seq_no": 17.0, "total_loss": 0.11605548858642578, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.017306208610534668, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 149956.36255731905}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.45}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.0998209274880872e-05, "listify_data_for_vector_env": 2.4031309853287672e-05, "normalize_and_clip_actions": 1.9257771673077304e-05, "remove_single_ts_time_rank_from_batch": 1.5302464928066643e-06, "get_actions": 0.00010964224760998783, "tensor_to_numpy": 6.852387830658422e-05}}, "connector_pipeline_timer": 0.000287842969791982}, "env_to_module_connector": {"connector_pipeline_timer": 9.198365536872275e-05, "timers": {"connectors": {"batch_individual_items": 1.6750913028889175e-05, "numpy_to_tensor": 2.1867127314731273e-05, "add_states_from_episodes_to_batch": 2.656597202091749e-06, "add_time_dim_to_batch_and_zero_pad": 5.114662835612606e-06, "add_observations_from_episodes_to_batch": 6.39977849543266e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_len_min": 20, "num_episodes_lifetime": 340, "env_reset_timer": 0.00031927951216878075, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.5974028285876885, "num_env_steps_sampled_lifetime": 85400, "agent_episode_returns_mean": {"default_agent": 1.45}, "weights_seq_no": 17.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_step_timer": 3.1201163698216266e-05, "num_episodes": 20, "episode_return_mean": 1.45, "rlmodule_inference_timer": 7.049392713716698e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_duration_sec_mean": 0.01450911005726084, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.59382264938051}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "49ad9_00000", "date": "2025-08-11_19-27-18", "timestamp": 1754933238, "time_this_iter_s": 5.905057191848755, "time_total_s": 124.1775450706482, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 124.1775450706482, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 88.6625, "ram_util_percent": 82.6625}}
{"timers": {"training_iteration": 6.247536752084641, "restore_env_runners": 1.9608611681569138e-05, "training_step": 6.247295668027467, "env_runner_sampling_timer": 5.730095137494412, "learner_update_timer": 0.5096020167541303, "synch_weights": 0.001559810992581106, "restore_eval_env_runners": 2.231968044513109e-05, "evaluation_iteration": 0.6156990714465774, "synch_eval_env_connectors": 0.00021726546522836092, "synch_env_connectors": 1.1529380026171479e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.950072778533602e-06, "numpy_to_tensor": 2.858613909406959e-05, "add_states_from_episodes_to_batch": 3.5763114416878952e-06, "batch_individual_items": 2.038959959925189e-05, "add_time_dim_to_batch_and_zero_pad": 6.123869951037994e-06}}, "connector_pipeline_timer": 0.00011527446562908429}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "rlmodule_inference_timer": 8.624475095016918e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3229424326762843e-06, "listify_data_for_vector_env": 3.389923607128181e-05, "un_batch_to_individual_items": 1.2365662549978735e-05, "normalize_and_clip_actions": 2.6068655344364792e-05, "get_actions": 0.00013637799430247184, "tensor_to_numpy": 4.204363223767383e-05}}, "connector_pipeline_timer": 0.0003191876559392235}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 17.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 4.8360432309211125e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.013712519679684192, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -493500.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 8.5, "time_between_sampling": 0.004114083550540949, "sample": 0.01597863245807025, "module_episode_returns_mean": {"default_policy": 8.5}, "agent_episode_returns_mean": {"default_agent": 8.5}, "env_reset_timer": 0.00010735307161365296, "num_env_steps_sampled_lifetime": -9870000.0, "num_env_steps_sampled_lifetime_throughput": 1881.0960991165155}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 567000, "learner_connector": {"connector_pipeline_timer": 0.2830597545103017, "timers": {"connectors": {"batch_individual_items": 0.07234275076746355, "numpy_to_tensor": 0.00015612546554508692, "add_states_from_episodes_to_batch": 4.3711433466454025e-06, "add_time_dim_to_batch_and_zero_pad": 1.677012907004202e-05, "add_columns_from_episodes_to_train_batch": 0.11366159809997622, "add_one_ts_to_episodes_and_truncate": 0.01926149861968982, "add_observations_from_episodes_to_batch": 0.0010539892336558756, "general_advantage_estimation": 0.07635724012913674}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 795454.2275684981, "num_module_steps_trained_throughput": 151665.83164967713, "num_module_steps_trained_lifetime_throughput": 151718.1901764291}, "default_policy": {"entropy": 0.5333104133605957, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.00045499237603507936, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.031843796372413635, "vf_loss_unclipped": 29.967670440673828, "num_module_steps_trained_lifetime": 108000, "policy_loss": -0.13860587775707245, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 2.847657469828846e-06, "weights_seq_no": 18.0, "total_loss": -0.07469553500413895, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.013191699981689453, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 151651.47407354906}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.65}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.0598516025724002e-05, "listify_data_for_vector_env": 2.2957703060356553e-05, "normalize_and_clip_actions": 1.8265062201402722e-05, "remove_single_ts_time_rank_from_batch": 1.4515875159301761e-06, "get_actions": 9.253626307795879e-05, "tensor_to_numpy": 2.863376574928721e-05}}, "connector_pipeline_timer": 0.00022012206157521073}, "env_to_module_connector": {"connector_pipeline_timer": 8.378503330243896e-05, "timers": {"connectors": {"batch_individual_items": 1.2763290987417077e-05, "numpy_to_tensor": 1.9924921238350372e-05, "add_states_from_episodes_to_batch": 3.628718384101923e-06, "add_time_dim_to_batch_and_zero_pad": 4.590535555753975e-06, "add_observations_from_episodes_to_batch": 5.015816243072642e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_len_min": 20, "num_episodes_lifetime": 360, "env_reset_timer": 0.00031791546671122077, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.593626476131332, "num_env_steps_sampled_lifetime": 90400, "agent_episode_returns_mean": {"default_agent": 0.65}, "weights_seq_no": 18.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_step_timer": 3.1203087997670714e-05, "num_episodes": 20, "episode_return_mean": 0.65, "rlmodule_inference_timer": 6.30464253399187e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_duration_sec_mean": 0.014307451708009466, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.57362389246729}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "49ad9_00000", "date": "2025-08-11_19-27-23", "timestamp": 1754933243, "time_this_iter_s": 4.717403173446655, "time_total_s": 128.89494824409485, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 128.89494824409485, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 62.04285714285714, "ram_util_percent": 81.68571428571428}}
{"timers": {"training_iteration": 6.23069497289345, "restore_env_runners": 1.947085662590805e-05, "training_step": 6.230453158017304, "env_runner_sampling_timer": 5.714398316540069, "learner_update_timer": 0.5084217736661172, "synch_weights": 0.001604692883339333, "restore_eval_env_runners": 2.2179403946110667e-05, "evaluation_iteration": 0.6118230044818975, "synch_eval_env_connectors": 0.00022072989075187942, "synch_env_connectors": 1.1450757052285248e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 8.277587833434251e-06, "numpy_to_tensor": 2.631703422850123e-05, "add_states_from_episodes_to_batch": 3.904471548721844e-06, "batch_individual_items": 1.7053886955011343e-05, "add_time_dim_to_batch_and_zero_pad": 6.005925842586168e-06}}, "connector_pipeline_timer": 0.00010728882946610991}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "rlmodule_inference_timer": 0.0001222664033840106, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4684956211242459e-06, "listify_data_for_vector_env": 3.047119199712562e-05, "un_batch_to_individual_items": 1.316266044236664e-05, "normalize_and_clip_actions": 2.4344473519208e-05, "get_actions": 0.000145338219889813, "tensor_to_numpy": 4.237044840864307e-05}}, "connector_pipeline_timer": 0.0003219760012925388}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 18.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 4.488269495869551e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.014148961331229656, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -524375.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 8.980000000000004, "time_between_sampling": 0.004410290523973753, "sample": 0.014986340011154429, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "env_reset_timer": 0.00012610772379352363, "num_env_steps_sampled_lifetime": -10487500.0, "num_env_steps_sampled_lifetime_throughput": 1821.5570163189009}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 598500, "learner_connector": {"connector_pipeline_timer": 0.28360870654489356, "timers": {"connectors": {"batch_individual_items": 0.07411187076066748, "numpy_to_tensor": 0.00015533713062830127, "add_states_from_episodes_to_batch": 4.372432255831151e-06, "add_time_dim_to_batch_and_zero_pad": 1.677034756785121e-05, "add_columns_from_episodes_to_train_batch": 0.11308355627907177, "add_one_ts_to_episodes_and_truncate": 0.019259770293040605, "add_observations_from_episodes_to_batch": 0.001059819341404179, "general_advantage_estimation": 0.0757114089782784}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 799706.242873205, "num_module_steps_trained_throughput": 152470.7986376438, "num_module_steps_trained_lifetime_throughput": 152520.35026607697}, "default_policy": {"entropy": 0.5042437314987183, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 0.0012530607637017965, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.018438857048749924, "vf_loss_unclipped": 29.897029876708984, "num_module_steps_trained_lifetime": 114000, "policy_loss": -0.08715296536684036, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 1.423828734914423e-06, "weights_seq_no": 19.0, "total_loss": -0.02297934889793396, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.013711333274841309, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 152448.94246332496}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.25}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.2047889529428593e-05, "listify_data_for_vector_env": 3.327677801656779e-05, "normalize_and_clip_actions": 3.565870693200522e-05, "remove_single_ts_time_rank_from_batch": 2.1758169221440402e-06, "get_actions": 0.00018837319555637546, "tensor_to_numpy": 4.765869829825965e-05}}, "connector_pipeline_timer": 0.0004119249932390416}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012544195896889708, "timers": {"connectors": {"batch_individual_items": 3.612677709791838e-05, "numpy_to_tensor": 2.932510519524515e-05, "add_states_from_episodes_to_batch": 2.8756534887668165e-06, "add_time_dim_to_batch_and_zero_pad": 5.733369675370059e-06, "add_observations_from_episodes_to_batch": 5.8592415732544534e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_len_min": 20, "num_episodes_lifetime": 380, "env_reset_timer": 0.00031644089196182257, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.5899812292897975, "num_env_steps_sampled_lifetime": 95400, "agent_episode_returns_mean": {"default_agent": 0.25}, "weights_seq_no": 19.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_step_timer": 4.544351409186644e-05, "num_episodes": 20, "episode_return_mean": 0.25, "rlmodule_inference_timer": 0.00010320405585151075, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_duration_sec_mean": 0.01335611253976822, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.553743858541762}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "49ad9_00000", "date": "2025-08-11_19-27-28", "timestamp": 1754933248, "time_this_iter_s": 4.807880878448486, "time_total_s": 133.70282912254333, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 133.70282912254333, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 85.19999999999997, "ram_util_percent": 81.68571428571428}}
{"timers": {"training_iteration": 6.2110220473247315, "restore_env_runners": 1.9409897622895934e-05, "training_step": 6.210777943526581, "env_runner_sampling_timer": 5.698433737124661, "learner_update_timer": 0.5047187084298546, "synch_weights": 0.0016022292837793274, "restore_eval_env_runners": 2.2029690781465146e-05, "evaluation_iteration": 0.6081015936071773, "synch_eval_env_connectors": 0.00022147967256807842, "synch_env_connectors": 1.1381248660261378e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.584666526881138e-06, "numpy_to_tensor": 2.9315912485587185e-05, "add_states_from_episodes_to_batch": 3.515721648743463e-06, "batch_individual_items": 1.8294618340793073e-05, "add_time_dim_to_batch_and_zero_pad": 6.508418040599245e-06}}, "connector_pipeline_timer": 0.00011247012611735991}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "rlmodule_inference_timer": 9.739074503143725e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3133666333972108e-06, "listify_data_for_vector_env": 3.0698615585589844e-05, "un_batch_to_individual_items": 1.6227826652836568e-05, "normalize_and_clip_actions": 2.65138490159496e-05, "get_actions": 0.00014614625550021026, "tensor_to_numpy": 4.4931714451447006e-05}}, "connector_pipeline_timer": 0.0003293901137477859}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 19.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_step_timer": 4.229704030819277e-05, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_duration_sec_mean": 0.013874369671568269, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -555250.0, "episode_return_min": -9.5, "episode_len_max": 20, "episode_return_mean": 8.580000000000002, "time_between_sampling": 0.0043720029155363, "sample": 0.01442730868875216, "module_episode_returns_mean": {"default_policy": 8.580000000000002}, "agent_episode_returns_mean": {"default_agent": 8.580000000000002}, "env_reset_timer": 0.00011726877570596499, "num_env_steps_sampled_lifetime": -11105000.0, "num_env_steps_sampled_lifetime_throughput": 1905.950533919641}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 630000, "learner_connector": {"connector_pipeline_timer": 0.28194582114961636, "timers": {"connectors": {"batch_individual_items": 0.07375670455298876, "numpy_to_tensor": 0.00015459500880539502, "add_states_from_episodes_to_batch": 4.667046947251678e-06, "add_time_dim_to_batch_and_zero_pad": 1.7007223424271063e-05, "add_columns_from_episodes_to_train_batch": 0.11246432571547312, "add_one_ts_to_episodes_and_truncate": 0.01925695801077199, "add_observations_from_episodes_to_batch": 0.0010636069886128454, "general_advantage_estimation": 0.07502179238848124}}}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 814095.2459635476, "num_module_steps_trained_throughput": 155241.86108088697, "num_module_steps_trained_lifetime_throughput": 155266.08279381288}, "default_policy": {"entropy": 0.4921499788761139, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "mean_kl_loss": 4.868659016210586e-05, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.11064177006483078, "vf_loss_unclipped": 29.854867935180664, "num_module_steps_trained_lifetime": 120000, "policy_loss": -0.07692054659128189, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 7.119143674572115e-07, "weights_seq_no": 20.0, "total_loss": -0.012637391686439514, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.015539288520812988, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 155207.14056417826}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.65}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.1166847896058599e-05, "listify_data_for_vector_env": 2.426961619047837e-05, "normalize_and_clip_actions": 2.68459291023417e-05, "remove_single_ts_time_rank_from_batch": 1.2253710115583395e-06, "get_actions": 0.0001346844442988364, "tensor_to_numpy": 3.597751506571601e-05}}, "connector_pipeline_timer": 0.00029799320011716506}, "env_to_module_connector": {"connector_pipeline_timer": 0.00010176876617204694, "timers": {"connectors": {"batch_individual_items": 1.5483310390881607e-05, "numpy_to_tensor": 2.418125622396843e-05, "add_states_from_episodes_to_batch": 3.948550296400886e-06, "add_time_dim_to_batch_and_zero_pad": 5.130002367692632e-06, "add_observations_from_episodes_to_batch": 5.865691310743641e-06}}}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_len_min": 20, "num_episodes_lifetime": 400, "env_reset_timer": 0.00031409982225675284, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.5872564224160793, "num_env_steps_sampled_lifetime": 100400, "agent_episode_returns_mean": {"default_agent": 0.65}, "weights_seq_no": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_step_timer": 3.986706695559081e-05, "num_episodes": 20, "episode_return_mean": 0.65, "rlmodule_inference_timer": 0.0001084991752198979, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_duration_sec_mean": 0.012992927519371733, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "time_between_sampling": 6.531164651205703}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "49ad9_00000", "date": "2025-08-11_19-27-33", "timestamp": 1754933253, "time_this_iter_s": 4.596004962921143, "time_total_s": 138.29883408546448, "pid": 14795, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386bf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 138.29883408546448, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 87.51666666666667, "ram_util_percent": 81.88333333333334}}
