{"timers": {"training_iteration": 1.6231187499361113, "restore_env_runners": 1.295795664191246e-05, "training_step": 1.6228395419893786, "env_runner_sampling_timer": 1.512880416936241, "learner_update_timer": 0.10665641690138727, "synch_weights": 0.0006580419139936566}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.516396274113807e-07, "normalize_and_clip_actions": 1.550376871929258e-05, "get_actions": 4.628627962642686e-05, "un_batch_to_individual_items": 6.5029452172853926e-06, "listify_data_for_vector_env": 1.2061880686492659e-05, "tensor_to_numpy": 1.4476885743674093e-05}}, "connector_pipeline_timer": 0.0001234718454892215}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.439464911036703e-06, "add_states_from_episodes_to_batch": 1.8357797171364713e-06, "add_observations_from_episodes_to_batch": 3.274801993428965e-06, "batch_individual_items": 6.7992193155189414e-06, "add_time_dim_to_batch_and_zero_pad": 2.616685442619794e-06}}, "connector_pipeline_timer": 4.807694897272903e-05}, "module_episode_returns_mean": {"default_policy": -1.5}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0005353747530204844, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 5.200557426287238e-05, "episode_return_mean": -1.5, "episode_duration_sec_mean": 0.005080762682016939, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled_lifetime": 627500.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "weights_seq_no": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes_lifetime": 31375.0, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.5437281347700245e-05, "env_reset_timer": 0.0001077343692993532, "env_to_module_sum_episodes_length_out": 10.191744832559449, "sample": 0.006088950513116712, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3398.3789717775394}, "learners": {"default_policy": {"vf_loss_unclipped": 28.887786865234375, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6905115842819214, "weights_seq_no": 1.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 6000, "total_loss": 0.02105357125401497, "gradients_default_optimizer_global_norm": 0.040778517723083496, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.3732481598854065, "num_module_steps_trained": 6000, "policy_loss": -0.04181544482707977, "mean_kl_loss": 0.0005123130395077169, "vf_explained_var": 0.0005095601081848145, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 459705.08241659775}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03390633291564882, "add_one_ts_to_episodes_and_truncate": 0.007505457964725792, "general_advantage_estimation": 0.006545791053213179, "add_time_dim_to_batch_and_zero_pad": 1.091696321964264e-05, "numpy_to_tensor": 7.320800796151161e-05, "add_states_from_episodes_to_batch": 3.4169061109423637e-06, "batch_individual_items": 0.030551499919965863, "add_observations_from_episodes_to_batch": 0.0008037920342758298}}, "connector_pipeline_timer": 0.07952600007411093}, "learner_connector_sum_episodes_length_out": 5250, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained_lifetime_throughput": 2388902.087488568, "num_module_steps_trained_throughput": 458167.33764888754, "num_module_steps_trained_lifetime_throughput": 457064.37040305824}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.1212340780361577e-05, "un_batch_to_individual_items": 5.4846408824562355e-06, "remove_single_ts_time_rank_from_batch": 5.68532355010119e-07, "tensor_to_numpy": 1.5546002090712572e-05, "get_actions": 4.423969567305893e-05, "listify_data_for_vector_env": 1.1040841116624248e-05}}, "connector_pipeline_timer": 0.00011413230221486287}, "rlmodule_inference_timer": 3.1564988692204067e-05, "weights_seq_no": 1.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.288403922985326e-06, "numpy_to_tensor": 8.77988433595222e-06, "add_states_from_episodes_to_batch": 1.5575050614911745e-06, "add_observations_from_episodes_to_batch": 2.8437586342535905e-06, "batch_individual_items": 6.2082658239889064e-06}}, "connector_pipeline_timer": 4.562619824857221e-05}, "sample": 0.10226995893754065, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.75, "episode_len_max": 20, "env_reset_timer": 0.00046741694677621126, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.75}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_env_steps_sampled_lifetime": 5400, "episode_duration_sec_mean": 0.004627229052130133, "num_episodes_lifetime": 20, "num_episodes": 20, "env_step_timer": 1.530795903624888e-05, "module_episode_returns_mean": {"default_policy": 2.75}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_module_steps_sampled_lifetime": {"default_policy": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-25", "timestamp": 1754932765, "time_this_iter_s": 1.7392070293426514, "time_total_s": 1.7392070293426514, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.7392070293426514, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.1, "ram_util_percent": 83.7}}
{"timers": {"training_iteration": 1.6230861211859156, "restore_env_runners": 1.2891707010567188e-05, "training_step": 1.6228076482296454, "env_runner_sampling_timer": 1.5118967506859917, "learner_update_timer": 0.10760845398297533, "synch_weights": 0.0006578889954835176, "restore_eval_env_runners": 8.958042599260807e-06, "evaluation_iteration": 0.11439674999564886, "synch_eval_env_connectors": 0.000120542012155056, "synch_env_connectors": 4.458008334040642e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.184595503674567e-07, "normalize_and_clip_actions": 9.678299773458807e-06, "get_actions": 3.9148135233038355e-05, "un_batch_to_individual_items": 5.485734075804011e-06, "listify_data_for_vector_env": 1.144778407290983e-05, "tensor_to_numpy": 1.3231458655507309e-05}}, "connector_pipeline_timer": 0.00010562503519141641}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.994532159146995e-06, "add_states_from_episodes_to_batch": 1.8007614773929078e-06, "add_observations_from_episodes_to_batch": 3.0182726039945956e-06, "batch_individual_items": 6.514973122040123e-06, "add_time_dim_to_batch_and_zero_pad": 2.438602235437703e-06}}, "connector_pipeline_timer": 4.4857038121564344e-05}, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0015251479235719053, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.8449846687122518e-05, "episode_return_mean": 0.17999999999999997, "episode_duration_sec_mean": 0.004633327668067067, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes_lifetime": 500.0, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.4205142816723464e-05, "env_reset_timer": 4.310809515329794e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005323882086658129, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3653.520701734901}, "learners": {"default_policy": {"vf_loss_unclipped": 28.989748001098633, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6900495290756226, "weights_seq_no": 2.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 12000, "total_loss": 0.22059014439582825, "gradients_default_optimizer_global_norm": 0.12324754893779755, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.18662407994270325, "num_module_steps_trained": 6000, "policy_loss": 0.1580778807401657, "mean_kl_loss": 5.7608696806710213e-05, "vf_explained_var": 0.0014600753784179688, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 458805.2553400298}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033909426255850125, "add_one_ts_to_episodes_and_truncate": 0.007506859635468572, "general_advantage_estimation": 0.006537831892492249, "add_time_dim_to_batch_and_zero_pad": 1.0948203271254898e-05, "numpy_to_tensor": 7.323550758883357e-05, "add_states_from_episodes_to_batch": 3.4173170570284127e-06, "batch_individual_items": 0.031630479501327496, "add_observations_from_episodes_to_batch": 0.0008039461937732994}}, "connector_pipeline_timer": 0.08060148715390823}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained_lifetime_throughput": 2384531.2111908896, "num_module_steps_trained_throughput": 457296.07651477307, "num_module_steps_trained_lifetime_throughput": 456205.54508731037}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.330177683451603e-06, "un_batch_to_individual_items": 5.262805189922387e-06, "remove_single_ts_time_rank_from_batch": 5.672810500463392e-07, "tensor_to_numpy": 1.2937018888257254e-05, "get_actions": 3.6525711718152105e-05, "listify_data_for_vector_env": 1.0925787610799305e-05}}, "connector_pipeline_timer": 0.00010116350924756806}, "rlmodule_inference_timer": 2.825774497806202e-05, "weights_seq_no": 2.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.150049577604543e-06, "numpy_to_tensor": 8.324308935658014e-06, "add_states_from_episodes_to_batch": 1.5274521349041323e-06, "add_observations_from_episodes_to_batch": 2.777920155537148e-06, "batch_individual_items": 6.081143781664069e-06}}, "connector_pipeline_timer": 4.225382119122202e-05}, "sample": 0.10225606851861811, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.25, "episode_len_max": 20, "env_reset_timer": 0.00046389777678996325, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": -0.25}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_env_steps_sampled_lifetime": 10400, "episode_duration_sec_mean": 0.004616565548349172, "num_episodes_lifetime": 40, "num_episodes": 20, "env_step_timer": 1.3969358642873174e-05, "module_episode_returns_mean": {"default_policy": -0.25}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "time_between_sampling": 1.647660666028969}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-27", "timestamp": 1754932767, "time_this_iter_s": 1.7284588813781738, "time_total_s": 3.467665910720825, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.467665910720825, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.150000000000006, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 1.6221179524748937, "restore_env_runners": 1.2824869574978946e-05, "training_step": 1.6218399621573159, "env_runner_sampling_timer": 1.5110296515186201, "learner_update_timer": 0.10750648319341707, "synch_weights": 0.0006586196850519626, "restore_eval_env_runners": 8.947212481871247e-06, "evaluation_iteration": 0.11431845124578104, "synch_eval_env_connectors": 0.00012125409208238125, "synch_env_connectors": 4.463427467271685e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.202055210930311e-07, "normalize_and_clip_actions": 9.65953687404598e-06, "get_actions": 3.988728523126864e-05, "un_batch_to_individual_items": 5.542484760414041e-06, "listify_data_for_vector_env": 1.1512090975014786e-05, "tensor_to_numpy": 1.3235314917904768e-05}}, "connector_pipeline_timer": 0.00010647001336335193}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.987918703481642e-06, "add_states_from_episodes_to_batch": 1.8100788185815416e-06, "add_observations_from_episodes_to_batch": 3.063734582775698e-06, "batch_individual_items": 6.4382958615884575e-06, "add_time_dim_to_batch_and_zero_pad": 2.441784508864066e-06}}, "connector_pipeline_timer": 4.476438024752269e-05}, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0019393135127470237, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.8547831171188126e-05, "episode_return_mean": 0.3400000000000001, "episode_duration_sec_mean": 0.004672601449303328, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled_lifetime": -607500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes_lifetime": -30375.0, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.4177373074287658e-05, "env_reset_timer": 3.9717562913264564e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005065037645900479, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3665.457169416362}, "learners": {"default_policy": {"vf_loss_unclipped": 28.398405075073242, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6902889013290405, "weights_seq_no": 3.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 18000, "total_loss": 0.06561407446861267, "gradients_default_optimizer_global_norm": 0.11024872958660126, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.09331203997135162, "num_module_steps_trained": 6000, "policy_loss": 0.0031105533707886934, "mean_kl_loss": 7.996203930815682e-05, "vf_explained_var": 0.001783132553100586, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 457951.07721902546}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0339071615825058, "add_one_ts_to_episodes_and_truncate": 0.007526951458700933, "general_advantage_estimation": 0.006548530243651475, "add_time_dim_to_batch_and_zero_pad": 1.1067890620324762e-05, "numpy_to_tensor": 7.316107137594372e-05, "add_states_from_episodes_to_batch": 3.4318939666263754e-06, "batch_individual_items": 0.031614480116369664, "add_observations_from_episodes_to_batch": 0.0008042871413985267}}, "connector_pipeline_timer": 0.08061424978232243}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained_lifetime_throughput": 2380670.11677115, "num_module_steps_trained_throughput": 456495.6755382699, "num_module_steps_trained_lifetime_throughput": 455425.5957382582}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.615914886566323e-06, "un_batch_to_individual_items": 5.295814895248878e-06, "remove_single_ts_time_rank_from_batch": 5.732244447313407e-07, "tensor_to_numpy": 1.2619847950022575e-05, "get_actions": 3.5438008839812036e-05, "listify_data_for_vector_env": 1.079443354082758e-05}}, "connector_pipeline_timer": 9.986130962765132e-05}, "rlmodule_inference_timer": 2.7077742537762412e-05, "weights_seq_no": 3.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1872310579705044e-06, "numpy_to_tensor": 8.227943837075984e-06, "add_states_from_episodes_to_batch": 1.5669960926747191e-06, "add_observations_from_episodes_to_batch": 2.7890665655986328e-06, "batch_individual_items": 6.130894954940627e-06}}, "connector_pipeline_timer": 4.249035268231687e-05}, "sample": 0.10221497866300633, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.5833333333333334, "episode_len_max": 20, "env_reset_timer": 0.0004605783795006573, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": -0.5833333333333334}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_env_steps_sampled_lifetime": 15400, "episode_duration_sec_mean": 0.004569612431805581, "num_episodes_lifetime": 60, "num_episodes": 20, "env_step_timer": 1.385361432416837e-05, "module_episode_returns_mean": {"default_policy": -0.5833333333333334}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "time_between_sampling": 1.646627757708775}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-28", "timestamp": 1754932768, "time_this_iter_s": 1.6322269439697266, "time_total_s": 5.099892854690552, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.099892854690552, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 52.96666666666667, "ram_util_percent": 83.6}}
{"timers": {"training_iteration": 1.6221452125401257, "restore_env_runners": 1.281412119185552e-05, "training_step": 1.621867945865596, "env_runner_sampling_timer": 1.5111902350031685, "learner_update_timer": 0.10737375253216898, "synch_weights": 0.000657926408509258, "restore_eval_env_runners": 9.297740214969964e-06, "evaluation_iteration": 0.11421301631273235, "synch_eval_env_connectors": 0.00012131614061072469, "synch_env_connectors": 4.462543234694748e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.139334829992316e-07, "normalize_and_clip_actions": 9.562903683178275e-06, "get_actions": 3.861482712581021e-05, "un_batch_to_individual_items": 5.420398902227312e-06, "listify_data_for_vector_env": 1.122570790760662e-05, "tensor_to_numpy": 1.307001556283776e-05}}, "connector_pipeline_timer": 0.00010419454106394657}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.6974625702842e-06, "add_states_from_episodes_to_batch": 1.7706664181069021e-06, "add_observations_from_episodes_to_batch": 3.1011351176646147e-06, "batch_individual_items": 6.351382428252192e-06, "add_time_dim_to_batch_and_zero_pad": 2.385191027663671e-06}}, "connector_pipeline_timer": 4.414127316950859e-05}, "module_episode_returns_mean": {"default_policy": -0.3}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.001995623518411432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7480824513530186e-05, "episode_return_mean": -0.3, "episode_duration_sec_mean": 0.004566859973128884, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled_lifetime": -1225000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes_lifetime": -61250.0, "agent_episode_returns_mean": {"default_agent": -0.3}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.3848083068103084e-05, "env_reset_timer": 3.947172841402379e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.004925651718102877, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3679.666770916571}, "learners": {"default_policy": {"vf_loss_unclipped": 28.49736213684082, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6886228322982788, "weights_seq_no": 4.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 24000, "total_loss": 0.06732043623924255, "gradients_default_optimizer_global_norm": 0.035478390753269196, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.04665601998567581, "num_module_steps_trained": 6000, "policy_loss": 0.004799160175025463, "mean_kl_loss": 0.00018847151659429073, "vf_explained_var": 0.002683281898498535, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 455993.82770391525}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03390527705687087, "add_one_ts_to_episodes_and_truncate": 0.007529504444720922, "general_advantage_estimation": 0.006539516190769267, "add_time_dim_to_batch_and_zero_pad": 1.1046371880802329e-05, "numpy_to_tensor": 7.295946120540612e-05, "add_states_from_episodes_to_batch": 3.436734812916256e-06, "batch_individual_items": 0.0316008140654423, "add_observations_from_episodes_to_batch": 0.0008043688498928677}}, "connector_pipeline_timer": 0.08059169978545594}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained_lifetime_throughput": 2371160.80842242, "num_module_steps_trained_throughput": 454601.98116456013, "num_module_steps_trained_lifetime_throughput": 453558.38482137595}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3519135071189263e-05, "un_batch_to_individual_items": 8.22620452877706e-06, "remove_single_ts_time_rank_from_batch": 1.2528494059301695e-06, "tensor_to_numpy": 1.9442829490484907e-05, "get_actions": 6.844096146128578e-05, "listify_data_for_vector_env": 1.5083654803749208e-05}}, "connector_pipeline_timer": 0.00016444013110646893}, "rlmodule_inference_timer": 4.4046230417024604e-05, "weights_seq_no": 4.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.8899696673017373e-06, "numpy_to_tensor": 1.7053350105742907e-05, "add_states_from_episodes_to_batch": 1.8423900994513952e-06, "add_observations_from_episodes_to_batch": 4.245060404431483e-06, "batch_individual_items": 9.274036571417545e-06}}, "connector_pipeline_timer": 6.448305050473299e-05}, "sample": 0.10243657470651914, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.5, "episode_len_max": 20, "env_reset_timer": 0.00045690175528358666, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": -0.5}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_env_steps_sampled_lifetime": 20400, "episode_duration_sec_mean": 0.004835324973100796, "num_episodes_lifetime": 80, "num_episodes": 20, "env_step_timer": 2.3061780263894015e-05, "module_episode_returns_mean": {"default_policy": -0.5}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "time_between_sampling": 1.646624357631558}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-30", "timestamp": 1754932770, "time_this_iter_s": 1.7594318389892578, "time_total_s": 6.85932469367981, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.85932469367981, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.55, "ram_util_percent": 83.55}}
{"timers": {"training_iteration": 1.6218296425045888, "restore_env_runners": 1.2766399684255012e-05, "training_step": 1.6215528343266803, "env_runner_sampling_timer": 1.5110097126521709, "learner_update_timer": 0.10723962375747932, "synch_weights": 0.000657441314227129, "restore_eval_env_runners": 9.309763612342068e-06, "evaluation_iteration": 0.11439520614857156, "synch_eval_env_connectors": 0.00012123089815396815, "synch_env_connectors": 4.53291751386132e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.092674773120504e-07, "normalize_and_clip_actions": 9.616399381019717e-06, "get_actions": 3.89713092840643e-05, "un_batch_to_individual_items": 5.445133782440804e-06, "listify_data_for_vector_env": 1.1255051762345171e-05, "tensor_to_numpy": 1.3022329683597318e-05}}, "connector_pipeline_timer": 0.00010477756044977976}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.76647212851391e-06, "add_states_from_episodes_to_batch": 1.7716055599912507e-06, "add_observations_from_episodes_to_batch": 3.0052437150407485e-06, "batch_individual_items": 6.3847387877487215e-06, "add_time_dim_to_batch_and_zero_pad": 2.3902478840134217e-06}}, "connector_pipeline_timer": 4.425854519213735e-05}, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0017906043218603495, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 4.655232731729207e-05, "episode_return_mean": -0.14000000000000007, "episode_duration_sec_mean": 0.004960444326046853, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled_lifetime": -1842500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes_lifetime": -92125.0, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.3959862986385182e-05, "env_reset_timer": 3.912670634990499e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.004992580956106389, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3687.611790526965}, "learners": {"default_policy": {"vf_loss_unclipped": 28.689939498901367, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6842040419578552, "weights_seq_no": 5.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 30000, "total_loss": 0.10100902616977692, "gradients_default_optimizer_global_norm": 0.09610242396593094, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.023328009992837906, "num_module_steps_trained": 6000, "policy_loss": 0.03844098374247551, "mean_kl_loss": 0.0005214021657593548, "vf_explained_var": 0.003237903118133545, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 454125.61678318074}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033910840955765145, "add_one_ts_to_episodes_and_truncate": 0.007530671480743068, "general_advantage_estimation": 0.006530522699306331, "add_time_dim_to_batch_and_zero_pad": 1.1054238515865293e-05, "numpy_to_tensor": 7.289944677913795e-05, "add_states_from_episodes_to_batch": 3.4365376900497354e-06, "batch_individual_items": 0.03159111675542569, "add_observations_from_episodes_to_batch": 0.0008044593211190985}}, "connector_pipeline_timer": 0.0805796482072928}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained_lifetime_throughput": 2362234.710191632, "num_module_steps_trained_throughput": 452807.5182363385, "num_module_steps_trained_lifetime_throughput": 451793.9117772873}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.445504570930756e-06, "un_batch_to_individual_items": 5.313977942225555e-06, "remove_single_ts_time_rank_from_batch": 5.800055111200871e-07, "tensor_to_numpy": 1.2895267049978406e-05, "get_actions": 3.582619931047968e-05, "listify_data_for_vector_env": 1.0934937962076158e-05}}, "connector_pipeline_timer": 0.00010071453287151251}, "rlmodule_inference_timer": 2.7455551022624156e-05, "weights_seq_no": 5.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1755374727403197e-06, "numpy_to_tensor": 8.444668525494575e-06, "add_states_from_episodes_to_batch": 1.5706911387913777e-06, "add_observations_from_episodes_to_batch": 2.859699470488545e-06, "batch_individual_items": 6.100596621298276e-06}}, "connector_pipeline_timer": 4.2829050837295995e-05}, "sample": 0.10240018437988425, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.15, "episode_len_max": 20, "env_reset_timer": 0.0004537264875750337, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.15}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_env_steps_sampled_lifetime": 25400, "episode_duration_sec_mean": 0.004771604570560157, "num_episodes_lifetime": 100, "num_episodes": 20, "env_step_timer": 1.416115734310262e-05, "module_episode_returns_mean": {"default_policy": 1.15}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "time_between_sampling": 1.646348859054573}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-32", "timestamp": 1754932772, "time_this_iter_s": 1.6980020999908447, "time_total_s": 8.557326793670654, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.557326793670654, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.4, "ram_util_percent": 83.63333333333334}}
{"timers": {"training_iteration": 1.6211894465000776, "restore_env_runners": 1.2707485919870576e-05, "training_step": 1.6209135747334236, "env_runner_sampling_timer": 1.5096063851056707, "learner_update_timer": 0.10800418752012335, "synch_weights": 0.0006566656507105405, "restore_eval_env_runners": 9.286246249921388e-06, "evaluation_iteration": 0.11430400658748578, "synch_eval_env_connectors": 0.00012326858947231433, "synch_env_connectors": 4.526758602057815e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.947588153341967e-07, "normalize_and_clip_actions": 9.396230721549299e-06, "get_actions": 3.792722923273767e-05, "un_batch_to_individual_items": 5.336990613270899e-06, "listify_data_for_vector_env": 1.1097596260652103e-05, "tensor_to_numpy": 1.2842336466503281e-05}}, "connector_pipeline_timer": 0.0001026699701653101}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.528072950777184e-06, "add_states_from_episodes_to_batch": 1.7579888669797672e-06, "add_observations_from_episodes_to_batch": 2.931982673654657e-06, "batch_individual_items": 6.242710707008649e-06, "add_time_dim_to_batch_and_zero_pad": 2.3574955201406805e-06}}, "connector_pipeline_timer": 4.3383271413568284e-05}, "module_episode_returns_mean": {"default_policy": 0.58}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0015400933380370191, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7412112944940758e-05, "episode_return_mean": 0.58, "episode_duration_sec_mean": 0.004499950158409773, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled_lifetime": -2460000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes_lifetime": -123000.0, "agent_episode_returns_mean": {"default_agent": 0.58}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.3643285501516898e-05, "env_reset_timer": 3.7002727896314535e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005108517902159847, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3745.527885227057}, "learners": {"default_policy": {"vf_loss_unclipped": 27.926227569580078, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.676906406879425, "weights_seq_no": 6.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 36000, "total_loss": -0.02719425968825817, "gradients_default_optimizer_global_norm": 0.08454997837543488, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.011664004996418953, "num_module_steps_trained": 6000, "policy_loss": -0.08983005583286285, "mean_kl_loss": 0.001113722799345851, "vf_explained_var": 0.003413856029510498, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 452199.23316696717}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03390672796546016, "add_one_ts_to_episodes_and_truncate": 0.007531932265135519, "general_advantage_estimation": 0.00652156455212116, "add_time_dim_to_batch_and_zero_pad": 1.1082025472714278e-05, "numpy_to_tensor": 7.283753306017283e-05, "add_states_from_episodes_to_batch": 3.4450923140003923e-06, "batch_individual_items": 0.03248947433791688, "add_observations_from_episodes_to_batch": 0.0008045909787568267}}, "connector_pipeline_timer": 0.08146602797572791}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime_throughput": 2353070.7178267473, "num_module_steps_trained_throughput": 450960.8669357023, "num_module_steps_trained_lifetime_throughput": 449979.70692543924}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.758473356054927e-06, "un_batch_to_individual_items": 5.44058324038626e-06, "remove_single_ts_time_rank_from_batch": 5.736799035565846e-07, "tensor_to_numpy": 1.3409631433555802e-05, "get_actions": 4.07318691778057e-05, "listify_data_for_vector_env": 1.1274021337155676e-05}}, "connector_pipeline_timer": 0.00010782644637369392}, "rlmodule_inference_timer": 2.949242570216202e-05, "weights_seq_no": 6.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2505598527472615e-06, "numpy_to_tensor": 8.780908325545217e-06, "add_states_from_episodes_to_batch": 1.5744698765498554e-06, "add_observations_from_episodes_to_batch": 3.178583909652663e-06, "batch_individual_items": 6.2177589068331465e-06}}, "connector_pipeline_timer": 4.364758294310657e-05}, "sample": 0.10240231545660951, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.55, "episode_len_max": 20, "env_reset_timer": 0.0004500538032057422, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 0.55}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_env_steps_sampled_lifetime": 30400, "episode_duration_sec_mean": 0.004783854580018669, "num_episodes_lifetime": 120, "num_episodes": 20, "env_step_timer": 1.4639393115041447e-05, "module_episode_returns_mean": {"default_policy": 0.55}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "time_between_sampling": 1.6456375575430788}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-34", "timestamp": 1754932774, "time_this_iter_s": 1.6683988571166992, "time_total_s": 10.225725650787354, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.225725650787354, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.55, "ram_util_percent": 83.1}}
{"timers": {"training_iteration": 1.619726676205125, "restore_env_runners": 1.264625091008431e-05, "training_step": 1.6194515027353265, "env_runner_sampling_timer": 1.5082384912548636, "learner_update_timer": 0.1079086664756018, "synch_weights": 0.0006568752448694424, "restore_eval_env_runners": 9.260053678079242e-06, "evaluation_iteration": 0.11424181986229257, "synch_eval_env_connectors": 0.0001230725738693875, "synch_env_connectors": 4.532331915385496e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.997236829723781e-07, "normalize_and_clip_actions": 9.469856235993711e-06, "get_actions": 3.772476204219312e-05, "un_batch_to_individual_items": 5.369030471095148e-06, "listify_data_for_vector_env": 1.1163832608861891e-05, "tensor_to_numpy": 1.2890978066019475e-05}}, "connector_pipeline_timer": 0.00010270403836358633}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.596471762540092e-06, "add_states_from_episodes_to_batch": 1.7875232753214883e-06, "add_observations_from_episodes_to_batch": 2.9855734108542384e-06, "batch_individual_items": 6.356505277941214e-06, "add_time_dim_to_batch_and_zero_pad": 2.3660309952001435e-06}}, "connector_pipeline_timer": 4.3713841075959055e-05}, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0018643084193661025, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7180942069033088e-05, "episode_return_mean": 2.259999999999999, "episode_duration_sec_mean": 0.0045155054749920955, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled_lifetime": -3077500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes_lifetime": -153875.0, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.371312331503305e-05, "env_reset_timer": 3.627857231498847e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.004860057933372835, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3742.375478565443}, "learners": {"default_policy": {"vf_loss_unclipped": 27.751880645751953, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.66071617603302, "weights_seq_no": 7.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 42000, "total_loss": 0.09848138689994812, "gradients_default_optimizer_global_norm": 0.049868904054164886, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0058320024982094765, "num_module_steps_trained": 6000, "policy_loss": 0.03569741174578667, "mean_kl_loss": 0.0023606023751199245, "vf_explained_var": 0.003434121608734131, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 449172.48185530445}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03390641360514793, "add_one_ts_to_episodes_and_truncate": 0.007536817102669695, "general_advantage_estimation": 0.006520796406644429, "add_time_dim_to_batch_and_zero_pad": 1.1053286168947653e-05, "numpy_to_tensor": 7.276499741492176e-05, "add_states_from_episodes_to_batch": 3.4406416192951897e-06, "batch_individual_items": 0.03247398626364963, "add_observations_from_episodes_to_batch": 0.0008050275689486948}}, "connector_pipeline_timer": 0.08145441019601764}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained_lifetime_throughput": 2338076.367094578, "num_module_steps_trained_throughput": 448011.54870284256, "num_module_steps_trained_lifetime_throughput": 447052.6802879113}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0927720177208051e-05, "un_batch_to_individual_items": 6.3452117309311414e-06, "remove_single_ts_time_rank_from_batch": 7.01079643747335e-07, "tensor_to_numpy": 1.4545132374386672e-05, "get_actions": 4.508735188337211e-05, "listify_data_for_vector_env": 1.3527978630930886e-05}}, "connector_pipeline_timer": 0.00011997347917514829}, "rlmodule_inference_timer": 3.360278223052106e-05, "weights_seq_no": 7.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.513676075513715e-06, "numpy_to_tensor": 1.0422103263442716e-05, "add_states_from_episodes_to_batch": 1.7371997223564485e-06, "add_observations_from_episodes_to_batch": 3.078898054021764e-06, "batch_individual_items": 7.3226434782874994e-06}}, "connector_pipeline_timer": 4.879692693381729e-05}, "sample": 0.1026630043824215, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.75, "episode_len_max": 20, "env_reset_timer": 0.00044640535548026483, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.75}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_env_steps_sampled_lifetime": 35400, "episode_duration_sec_mean": 0.0050305387680418786, "num_episodes_lifetime": 140, "num_episodes": 20, "env_step_timer": 1.7647087196941222e-05, "module_episode_returns_mean": {"default_policy": 1.75}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "time_between_sampling": 1.6441489123773465}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-35", "timestamp": 1754932775, "time_this_iter_s": 1.6128487586975098, "time_total_s": 11.838574409484863, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.838574409484863, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 48.150000000000006, "ram_util_percent": 83.2}}
{"timers": {"training_iteration": 1.6204333194431837, "restore_env_runners": 1.258603803232874e-05, "training_step": 1.620158711038348, "env_runner_sampling_timer": 1.5089736034215757, "learner_update_timer": 0.10787186689046316, "synch_weights": 0.0006600714922704698, "restore_eval_env_runners": 9.256203526046432e-06, "evaluation_iteration": 0.11445293582338585, "synch_eval_env_connectors": 0.00012303559761623104, "synch_env_connectors": 4.5232591632953305e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.254577075494319e-07, "normalize_and_clip_actions": 9.716376933275176e-06, "get_actions": 4.0051384843142346e-05, "un_batch_to_individual_items": 5.528843667417828e-06, "listify_data_for_vector_env": 1.1475714816994925e-05, "tensor_to_numpy": 1.3405814677803474e-05}}, "connector_pipeline_timer": 0.00010692757456799704}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.035517252302338e-06, "add_states_from_episodes_to_batch": 1.8082731390701716e-06, "add_observations_from_episodes_to_batch": 3.1508700918591534e-06, "batch_individual_items": 6.572472807993993e-06, "add_time_dim_to_batch_and_zero_pad": 2.5627303389210253e-06}}, "connector_pipeline_timer": 4.5260535939968474e-05}, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.001690766803099566, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 5.248797132807742e-05, "episode_return_mean": 1.8600000000000003, "episode_duration_sec_mean": 0.0052427441528998305, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled_lifetime": -3695000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 7.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes_lifetime": -184750.0, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.445585979020811e-05, "env_reset_timer": 3.823434116853103e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005383305358446913, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3636.630471229761}, "learners": {"default_policy": {"vf_loss_unclipped": 27.20172691345215, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6383119821548462, "weights_seq_no": 8.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 48000, "total_loss": -0.0927489772439003, "gradients_default_optimizer_global_norm": 0.022608157247304916, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0029160012491047382, "num_module_steps_trained": 6000, "policy_loss": -0.15572355687618256, "mean_kl_loss": 0.002607794012874365, "vf_explained_var": 0.002962470054626465, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 444938.1540681524}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03392075404947908, "add_one_ts_to_episodes_and_truncate": 0.0075603435112118755, "general_advantage_estimation": 0.006516455523042944, "add_time_dim_to_batch_and_zero_pad": 1.1074003433545517e-05, "numpy_to_tensor": 7.274401638393927e-05, "add_states_from_episodes_to_batch": 3.443325124636299e-06, "batch_individual_items": 0.0324661947410547, "add_observations_from_episodes_to_batch": 0.0008083235426347002}}, "connector_pipeline_timer": 0.08148336900463236}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained_lifetime_throughput": 2316730.6198195354, "num_module_steps_trained_throughput": 443846.6523834811, "num_module_steps_trained_lifetime_throughput": 442915.0831595107}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0231430544189084e-05, "un_batch_to_individual_items": 6.194653704596828e-06, "remove_single_ts_time_rank_from_batch": 6.457099347235778e-07, "tensor_to_numpy": 1.3581012178439212e-05, "get_actions": 4.098728246107063e-05, "listify_data_for_vector_env": 1.2233481896568292e-05}}, "connector_pipeline_timer": 0.00011207994403866126}, "rlmodule_inference_timer": 3.004345870383697e-05, "weights_seq_no": 8.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.5413352119838883e-06, "numpy_to_tensor": 1.1043270611746308e-05, "add_states_from_episodes_to_batch": 1.6853531622005542e-06, "add_observations_from_episodes_to_batch": 3.99647600537362e-06, "batch_individual_items": 6.677164285943973e-06}}, "connector_pipeline_timer": 5.336590562055454e-05}, "sample": 0.1027471993382296, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.75, "episode_len_max": 20, "env_reset_timer": 0.00045008255250787407, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 2.75}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_env_steps_sampled_lifetime": 40400, "episode_duration_sec_mean": 0.0051378371368628, "num_episodes_lifetime": 160, "num_episodes": 20, "env_step_timer": 1.5911986566636434e-05, "module_episode_returns_mean": {"default_policy": 2.75}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "time_between_sampling": 1.644852233253309}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-37", "timestamp": 1754932777, "time_this_iter_s": 1.8136560916900635, "time_total_s": 13.652230501174927, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.652230501174927, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.199999999999996, "ram_util_percent": 83.23333333333333}}
{"timers": {"training_iteration": 1.620848377089394, "restore_env_runners": 1.251642837135901e-05, "training_step": 1.6205746060078559, "env_runner_sampling_timer": 1.5081698936376982, "learner_update_timer": 0.10908924405078274, "synch_weights": 0.000659686617460183, "restore_eval_env_runners": 9.239061157031548e-06, "evaluation_iteration": 0.11451727313564689, "synch_eval_env_connectors": 0.00012308899181091054, "synch_env_connectors": 4.6021858406972395e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.21929984930137e-07, "normalize_and_clip_actions": 9.713904483968119e-06, "get_actions": 3.981835945110274e-05, "un_batch_to_individual_items": 5.496861355966706e-06, "listify_data_for_vector_env": 1.1564744946598551e-05, "tensor_to_numpy": 1.3221933369558998e-05}}, "connector_pipeline_timer": 0.00010654646915415904}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.99584091877663e-06, "add_states_from_episodes_to_batch": 1.8094433888031031e-06, "add_observations_from_episodes_to_batch": 3.072932645392995e-06, "batch_individual_items": 6.551796576621183e-06, "add_time_dim_to_batch_and_zero_pad": 2.458116466489008e-06}}, "connector_pipeline_timer": 4.501140740903038e-05}, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0017439335725406553, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.8752740628615957e-05, "episode_return_mean": 3.4599999999999995, "episode_duration_sec_mean": 0.00468242833763361, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled_lifetime": -4312500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 8.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes_lifetime": -215625.0, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.430650397784054e-05, "env_reset_timer": 4.160255405637341e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005151136153453725, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3593.3643930400726}, "learners": {"default_policy": {"vf_loss_unclipped": 26.992969512939453, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6128119826316833, "weights_seq_no": 9.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 54000, "total_loss": -0.050800688564777374, "gradients_default_optimizer_global_norm": 0.027868833392858505, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0014580006245523691, "num_module_steps_trained": 6000, "policy_loss": -0.11399688571691513, "mean_kl_loss": 0.002018766012042761, "vf_explained_var": 0.002911388874053955, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 440519.7915568016}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0339247610897735, "add_one_ts_to_episodes_and_truncate": 0.00887759215685283, "general_advantage_estimation": 0.0065189555587095525, "add_time_dim_to_batch_and_zero_pad": 1.1087842927556721e-05, "numpy_to_tensor": 7.269782704189891e-05, "add_states_from_episodes_to_batch": 3.4397326204483274e-06, "batch_individual_items": 0.03244826946454429, "add_observations_from_episodes_to_batch": 0.0008084940569011657}}, "connector_pipeline_timer": 0.08278918364373225}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained_lifetime_throughput": 2294433.464141448, "num_module_steps_trained_throughput": 439497.2264906853, "num_module_steps_trained_lifetime_throughput": 438595.89333070064}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.547003392603806e-06, "un_batch_to_individual_items": 5.278475358414889e-06, "remove_single_ts_time_rank_from_batch": 5.696947504542057e-07, "tensor_to_numpy": 1.2960359703854882e-05, "get_actions": 3.7262504256645564e-05, "listify_data_for_vector_env": 1.1120862518201577e-05}}, "connector_pipeline_timer": 0.00010235541850884195}, "rlmodule_inference_timer": 2.7318407785097307e-05, "weights_seq_no": 9.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1716125494205427e-06, "numpy_to_tensor": 8.430935203739921e-06, "add_states_from_episodes_to_batch": 1.6237176332970243e-06, "add_observations_from_episodes_to_batch": 2.8302125383925134e-06, "batch_individual_items": 5.987582475451097e-06}}, "connector_pipeline_timer": 4.243358927471033e-05}, "sample": 0.10273183317486105, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 3.35, "episode_len_max": 20, "env_reset_timer": 0.000446861316470035, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 3.35}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 45400, "episode_duration_sec_mean": 0.004932873358484358, "num_episodes_lifetime": 180, "num_episodes": 20, "env_step_timer": 1.4264341246528784e-05, "module_episode_returns_mean": {"default_policy": 3.35}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "time_between_sampling": 1.6453323175804158}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-39", "timestamp": 1754932779, "time_this_iter_s": 1.7744708061218262, "time_total_s": 15.426701307296753, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.426701307296753, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.76666666666667, "ram_util_percent": 83.60000000000001}}
{"timers": {"training_iteration": 1.6209985612379123, "restore_env_runners": 1.2445014205886134e-05, "training_step": 1.620725874947735, "env_runner_sampling_timer": 1.507491693450337, "learner_update_timer": 0.10992062410992562, "synch_weights": 0.0006585185015863611, "restore_eval_env_runners": 9.234170629652792e-06, "evaluation_iteration": 0.11447540999396139, "synch_eval_env_connectors": 0.0001281956018372946, "synch_env_connectors": 4.595744027558206e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.201958622724696e-07, "normalize_and_clip_actions": 9.76179247189828e-06, "get_actions": 4.038225578717464e-05, "un_batch_to_individual_items": 5.5362863907464594e-06, "listify_data_for_vector_env": 1.1466707584635654e-05, "tensor_to_numpy": 1.346972071690313e-05}}, "connector_pipeline_timer": 0.00010738216350128086}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.944918976580806e-06, "add_states_from_episodes_to_batch": 1.8096353013424692e-06, "add_observations_from_episodes_to_batch": 3.125646923456734e-06, "batch_individual_items": 6.514930638669395e-06, "add_time_dim_to_batch_and_zero_pad": 2.425192101105063e-06}}, "connector_pipeline_timer": 4.485434292182365e-05}, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0020688207029208386, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.8315878104277793e-05, "episode_return_mean": 3.4599999999999995, "episode_duration_sec_mean": 0.004710369715001433, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled_lifetime": -4930000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 9.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes_lifetime": -246500.0, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.4253919410989232e-05, "env_reset_timer": 3.950845571589255e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005016527137422611, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3636.4792402989438}, "learners": {"default_policy": {"vf_loss_unclipped": 26.41408920288086, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.581646203994751, "weights_seq_no": 10.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 60000, "total_loss": -0.19621355831623077, "gradients_default_optimizer_global_norm": 0.09449653327465057, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0007290003122761846, "num_module_steps_trained": 6000, "policy_loss": -0.2596895098686218, "mean_kl_loss": 0.0023036045022308826, "vf_explained_var": 0.002871870994567871, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 437339.269713269}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033958038479587664, "add_one_ts_to_episodes_and_truncate": 0.008871136654890121, "general_advantage_estimation": 0.006508365583011784, "add_time_dim_to_batch_and_zero_pad": 1.1105294928297077e-05, "numpy_to_tensor": 7.263667921974977e-05, "add_states_from_episodes_to_batch": 3.440755820062907e-06, "batch_individual_items": 0.03339014926934452, "add_observations_from_episodes_to_batch": 0.0008097491164381758}}, "connector_pipeline_timer": 0.08374837889690988}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained_lifetime_throughput": 2278653.3837601715, "num_module_steps_trained_throughput": 436390.4836767486, "num_module_steps_trained_lifetime_throughput": 435519.6514472114}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0611295968871177e-05, "un_batch_to_individual_items": 5.659874538437398e-06, "remove_single_ts_time_rank_from_batch": 6.172091825986101e-07, "tensor_to_numpy": 1.4380645039676208e-05, "get_actions": 4.033922709002739e-05, "listify_data_for_vector_env": 1.1680845121020007e-05}}, "connector_pipeline_timer": 0.00011021042901946507}, "rlmodule_inference_timer": 3.042342556305658e-05, "weights_seq_no": 10.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2593262147769237e-06, "numpy_to_tensor": 9.406312809265652e-06, "add_states_from_episodes_to_batch": 1.6210328903830822e-06, "add_observations_from_episodes_to_batch": 2.8815955912562964e-06, "batch_individual_items": 6.589427716590914e-06}}, "connector_pipeline_timer": 4.485768466881283e-05}, "sample": 0.10275300484306982, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.95, "episode_len_max": 20, "env_reset_timer": 0.0004432477028308072, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 1.95}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 50400, "episode_duration_sec_mean": 0.004988812966039404, "num_episodes_lifetime": 200, "num_episodes": 20, "env_step_timer": 1.545934813204502e-05, "module_episode_returns_mean": {"default_policy": 1.95}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "time_between_sampling": 1.6454257589937593}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-41", "timestamp": 1754932781, "time_this_iter_s": 1.7483818531036377, "time_total_s": 17.17508316040039, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.17508316040039, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 51.150000000000006, "ram_util_percent": 83.65}}
{"timers": {"training_iteration": 1.6193460939664133, "restore_env_runners": 1.2375984741936202e-05, "training_step": 1.6190743232785474, "env_runner_sampling_timer": 1.5060109531756598, "learner_update_timer": 0.10975042828846705, "synch_weights": 0.0006582195669978628, "restore_eval_env_runners": 9.204328817185489e-06, "evaluation_iteration": 0.11443376964401761, "synch_eval_env_connectors": 0.00012788823647620054, "synch_env_connectors": 4.5918672336634064e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.963000750399979e-07, "normalize_and_clip_actions": 9.401076238511376e-06, "get_actions": 3.771389206835614e-05, "un_batch_to_individual_items": 5.3789703519353465e-06, "listify_data_for_vector_env": 1.1077355306456812e-05, "tensor_to_numpy": 1.2854169719171047e-05}}, "connector_pipeline_timer": 0.00010245293125970043}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.503209010083797e-06, "add_states_from_episodes_to_batch": 1.7738188199602137e-06, "add_observations_from_episodes_to_batch": 2.948680142410077e-06, "batch_individual_items": 6.2645593645156e-06, "add_time_dim_to_batch_and_zero_pad": 2.3575316006937947e-06}}, "connector_pipeline_timer": 4.345058486202171e-05}, "module_episode_returns_mean": {"default_policy": 4.82}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0019519120968554669, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.744030490674918e-05, "episode_return_mean": 4.82, "episode_duration_sec_mean": 0.004485530383884905, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled_lifetime": -5547500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 10.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes_lifetime": -277375.0, "agent_episode_returns_mean": {"default_agent": 4.82}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.3590859542194456e-05, "env_reset_timer": 3.639218096268267e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.004909603577131959, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3741.962986257363}, "learners": {"default_policy": {"vf_loss_unclipped": 26.720659255981445, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.5473174452781677, "weights_seq_no": 11.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 66000, "total_loss": 0.00922297965735197, "gradients_default_optimizer_global_norm": 0.13445432484149933, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0003645001561380923, "num_module_steps_trained": 6000, "policy_loss": -0.054561760276556015, "mean_kl_loss": 0.001672356273047626, "vf_explained_var": 0.0033788084983825684, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 435024.8343866887}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033961015594908314, "add_one_ts_to_episodes_and_truncate": 0.008858716118379708, "general_advantage_estimation": 0.006499876097345983, "add_time_dim_to_batch_and_zero_pad": 1.1079661721404619e-05, "numpy_to_tensor": 7.256115207483047e-05, "add_states_from_episodes_to_batch": 3.4367687496088743e-06, "batch_individual_items": 0.03336039694705724, "add_observations_from_episodes_to_batch": 0.0008099341248944851}}, "connector_pipeline_timer": 0.08370048135884386}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime_throughput": 2267408.922809412, "num_module_steps_trained_throughput": 434149.8504685505, "num_module_steps_trained_lifetime_throughput": 433309.6866568813}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.288779167661724e-06, "un_batch_to_individual_items": 5.210138271708282e-06, "remove_single_ts_time_rank_from_batch": 5.55651020631235e-07, "tensor_to_numpy": 1.2481252790926742e-05, "get_actions": 3.4291124889422765e-05, "listify_data_for_vector_env": 1.0693564846708254e-05}}, "connector_pipeline_timer": 9.794002703239224e-05}, "rlmodule_inference_timer": 2.6085839595024162e-05, "weights_seq_no": 11.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1205095836087147e-06, "numpy_to_tensor": 8.130307161725454e-06, "add_states_from_episodes_to_batch": 1.5218854388913382e-06, "add_observations_from_episodes_to_batch": 2.786132772348629e-06, "batch_individual_items": 5.876587425853558e-06}}, "connector_pipeline_timer": 4.163221026063575e-05}, "sample": 0.10267819604441694, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.35, "episode_len_max": 20, "env_reset_timer": 0.0004396127254722149, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.35}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 55400, "episode_duration_sec_mean": 0.004927102149231359, "num_episodes_lifetime": 220, "num_episodes": 20, "env_step_timer": 1.358563475152868e-05, "module_episode_returns_mean": {"default_policy": 2.35}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "time_between_sampling": 1.6437062130648252}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-42", "timestamp": 1754932782, "time_this_iter_s": 1.5581459999084473, "time_total_s": 18.733229160308838, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.733229160308838, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 45.400000000000006, "ram_util_percent": 83.7}}
{"timers": {"training_iteration": 1.6184521280266757, "restore_env_runners": 1.2335975241192356e-05, "training_step": 1.6181812512960625, "env_runner_sampling_timer": 1.5053034065533835, "learner_update_timer": 0.10956709900608977, "synch_weights": 0.0006572032018342685, "restore_eval_env_runners": 9.176875077869655e-06, "evaluation_iteration": 0.1142908844473452, "synch_eval_env_connectors": 0.0001283564337706919, "synch_env_connectors": 4.59011769858113e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.957677702255999e-07, "normalize_and_clip_actions": 9.346471039429231e-06, "get_actions": 3.708528235558312e-05, "un_batch_to_individual_items": 5.312965332022541e-06, "listify_data_for_vector_env": 1.1031951835349666e-05, "tensor_to_numpy": 1.268750027681569e-05}}, "connector_pipeline_timer": 0.00010136509463285574}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.449899586543717e-06, "add_states_from_episodes_to_batch": 1.7622384814197844e-06, "add_observations_from_episodes_to_batch": 2.9975453593415034e-06, "batch_individual_items": 6.2442247438967825e-06, "add_time_dim_to_batch_and_zero_pad": 2.335418417570252e-06}}, "connector_pipeline_timer": 4.327888831534724e-05}, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.001792529392940093, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.671029270349923e-05, "episode_return_mean": 5.299999999999998, "episode_duration_sec_mean": 0.004458691825624555, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled_lifetime": -6165000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 11.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes_lifetime": -308250.0, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.347699114756128e-05, "env_reset_timer": 3.351231037507578e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.0047832535461359155, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3781.6172523344635}, "learners": {"default_policy": {"vf_loss_unclipped": 26.306880950927734, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.5396393537521362, "weights_seq_no": 12.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 72000, "total_loss": -0.0799412950873375, "gradients_default_optimizer_global_norm": 0.016193924471735954, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.00018225007806904614, "num_module_steps_trained": 6000, "policy_loss": -0.14379438757896423, "mean_kl_loss": 0.00010483573714736849, "vf_explained_var": 0.0036283135414123535, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 433801.2904153132}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03395994627868906, "add_one_ts_to_episodes_and_truncate": 0.008845517287929315, "general_advantage_estimation": 0.006487165666998266, "add_time_dim_to_batch_and_zero_pad": 1.1050525795839294e-05, "numpy_to_tensor": 7.237886948749996e-05, "add_states_from_episodes_to_batch": 3.429481594276167e-06, "batch_individual_items": 0.03332919130811868, "add_observations_from_episodes_to_batch": 0.0008097451942863015}}, "connector_pipeline_timer": 0.08364147946581597}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained_lifetime_throughput": 2261861.5731532043, "num_module_steps_trained_throughput": 432996.10414793505, "num_module_steps_trained_lifetime_throughput": 432187.18582854385}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.271240087663808e-06, "un_batch_to_individual_items": 5.124361917957844e-06, "remove_single_ts_time_rank_from_batch": 5.539020068649192e-07, "tensor_to_numpy": 1.2475834499892121e-05, "get_actions": 3.468454317222447e-05, "listify_data_for_vector_env": 1.0750849414071324e-05}}, "connector_pipeline_timer": 9.812962596014778e-05}, "rlmodule_inference_timer": 2.6212294412921823e-05, "weights_seq_no": 12.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0948367655732064e-06, "numpy_to_tensor": 8.191155159224668e-06, "add_states_from_episodes_to_batch": 1.5281570551993136e-06, "add_observations_from_episodes_to_batch": 2.7158841628425175e-06, "batch_individual_items": 6.008589866878454e-06}}, "connector_pipeline_timer": 4.167832453534027e-05}, "sample": 0.10261480200402831, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.15, "episode_len_max": 20, "env_reset_timer": 0.0004359253475024605, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 2.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 60400, "episode_duration_sec_mean": 0.004643669229699299, "num_episodes_lifetime": 240, "num_episodes": 20, "env_step_timer": 1.3712207651583064e-05, "module_episode_returns_mean": {"default_policy": 2.15}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "time_between_sampling": 1.6427355471840077}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-44", "timestamp": 1754932784, "time_this_iter_s": 1.6333789825439453, "time_total_s": 20.366608142852783, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.366608142852783, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.699999999999996, "ram_util_percent": 83.03333333333333}}
{"timers": {"training_iteration": 1.619399654666431, "restore_env_runners": 1.2266365607021146e-05, "training_step": 1.6191294650334809, "env_runner_sampling_timer": 1.5064023799884905, "learner_update_timer": 0.10940921260608875, "synch_weights": 0.0006589057497022728, "restore_eval_env_runners": 9.162196553204754e-06, "evaluation_iteration": 0.11415964768336621, "synch_eval_env_connectors": 0.00012819411894854824, "synch_env_connectors": 4.583385620777209e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.418987403481306e-07, "normalize_and_clip_actions": 1.0304594644774786e-05, "get_actions": 4.333597074737579e-05, "un_batch_to_individual_items": 5.765061187320508e-06, "listify_data_for_vector_env": 1.2243344591853886e-05, "tensor_to_numpy": 1.4204319021989549e-05}}, "connector_pipeline_timer": 0.00011382472833957236}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.572651246277215e-06, "add_states_from_episodes_to_batch": 1.8854779817319197e-06, "add_observations_from_episodes_to_batch": 3.2424531502055257e-06, "batch_individual_items": 6.885226914954557e-06, "add_time_dim_to_batch_and_zero_pad": 2.556849927359592e-06}}, "connector_pipeline_timer": 4.711013568717834e-05}, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0017137700327409515, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 3.0167899158746534e-05, "episode_return_mean": 5.700000000000004, "episode_duration_sec_mean": 0.004997151683084666, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled_lifetime": -6782500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 12.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes_lifetime": -339125.0, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.522786226111861e-05, "env_reset_timer": 3.943058398512941e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005052755869578961, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3521.2953018031462}, "learners": {"default_policy": {"vf_loss_unclipped": 26.30040740966797, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.5378057956695557, "weights_seq_no": 13.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 78000, "total_loss": -0.04169650375843048, "gradients_default_optimizer_global_norm": 0.05791241675615311, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 9.112503903452307e-05, "num_module_steps_trained": 6000, "policy_loss": -0.10556618124246597, "mean_kl_loss": 4.6311222831718624e-05, "vf_explained_var": 0.004175662994384766, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 432365.2674006334}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033959694316023394, "add_one_ts_to_episodes_and_truncate": 0.008834795035231028, "general_advantage_estimation": 0.006476526090329668, "add_time_dim_to_batch_and_zero_pad": 1.1055430031327252e-05, "numpy_to_tensor": 7.225591074595273e-05, "add_states_from_episodes_to_batch": 3.43060613999925e-06, "batch_individual_items": 0.03329628898501215, "add_observations_from_episodes_to_batch": 0.0008095364927494206}}, "connector_pipeline_timer": 0.08358635008120625}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained_lifetime_throughput": 2255177.0416069697, "num_module_steps_trained_throughput": 431628.93145200977, "num_module_steps_trained_lifetime_throughput": 430850.50541901065}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.500205230333616e-06, "un_batch_to_individual_items": 5.571329250457578e-06, "remove_single_ts_time_rank_from_batch": 5.886419763455211e-07, "tensor_to_numpy": 1.3295643455471696e-05, "get_actions": 3.720941050767034e-05, "listify_data_for_vector_env": 1.1047965985702655e-05}}, "connector_pipeline_timer": 0.00010361804378015891}, "rlmodule_inference_timer": 2.7628618121739452e-05, "weights_seq_no": 13.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.180120799418267e-06, "numpy_to_tensor": 8.431016045538031e-06, "add_states_from_episodes_to_batch": 1.5594952937671605e-06, "add_observations_from_episodes_to_batch": 2.7956154543812266e-06, "batch_individual_items": 6.040964775391503e-06}}, "connector_pipeline_timer": 4.243987373406562e-05}, "sample": 0.10260439731317775, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.75, "episode_len_max": 20, "env_reset_timer": 0.00043695067402680824, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 65400, "episode_duration_sec_mean": 0.004558486271416768, "num_episodes_lifetime": 260, "num_episodes": 20, "env_step_timer": 1.4285256973043227e-05, "module_episode_returns_mean": {"default_policy": 1.75}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "time_between_sampling": 1.6436436946330726}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-46", "timestamp": 1754932786, "time_this_iter_s": 1.826612949371338, "time_total_s": 22.19322109222412, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.19322109222412, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 50.6, "ram_util_percent": 82.85}}
{"timers": {"training_iteration": 1.61939214144986, "restore_env_runners": 1.2207861927269414e-05, "training_step": 1.6191226520425845, "env_runner_sampling_timer": 1.5054319782777363, "learner_update_timer": 0.11037280630995974, "synch_weights": 0.000658505022212967, "restore_eval_env_runners": 9.175985169127342e-06, "evaluation_iteration": 0.11412823745624875, "synch_eval_env_connectors": 0.00012916967690440665, "synch_env_connectors": 4.578391423619544e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.05325796301805e-07, "normalize_and_clip_actions": 9.676257765159301e-06, "get_actions": 3.9766815035082344e-05, "un_batch_to_individual_items": 5.481152882556359e-06, "listify_data_for_vector_env": 1.1497915949199286e-05, "tensor_to_numpy": 1.3342329461924053e-05}}, "connector_pipeline_timer": 0.00010622154664227548}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.964964678762254e-06, "add_states_from_episodes_to_batch": 1.7997618915277304e-06, "add_observations_from_episodes_to_batch": 3.0117863033188004e-06, "batch_individual_items": 6.563122121470186e-06, "add_time_dim_to_batch_and_zero_pad": 2.410401792681538e-06}}, "connector_pipeline_timer": 4.470464943336953e-05}, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.001810810914191698, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.8445735426948167e-05, "episode_return_mean": 5.380000000000001, "episode_duration_sec_mean": 0.004640134000219405, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled_lifetime": -7400000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 13.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes_lifetime": -370000.0, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.414399216801447e-05, "env_reset_timer": 4.157139738478753e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005180752188237087, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3606.9985290263467}, "learners": {"default_policy": {"vf_loss_unclipped": 27.039745330810547, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.5194522738456726, "weights_seq_no": 14.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 84000, "total_loss": 0.1356709897518158, "gradients_default_optimizer_global_norm": 0.035145506262779236, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 4.5562519517261535e-05, "num_module_steps_trained": 6000, "policy_loss": 0.07163506746292114, "mean_kl_loss": 0.00028114247834309936, "vf_explained_var": 0.005130410194396973, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 431533.18472750724}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03397293404321717, "add_one_ts_to_episodes_and_truncate": 0.008827882495417405, "general_advantage_estimation": 0.006478584579229378, "add_time_dim_to_batch_and_zero_pad": 1.1066544876314965e-05, "numpy_to_tensor": 7.221335215973582e-05, "add_states_from_episodes_to_batch": 3.4346403006897404e-06, "batch_individual_items": 0.03437116567536823, "add_observations_from_episodes_to_batch": 0.0008099261272383224}}, "connector_pipeline_timer": 0.08466988408027215}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained_lifetime_throughput": 2251646.239253696, "num_module_steps_trained_throughput": 430866.0017645756, "num_module_steps_trained_lifetime_throughput": 430117.0609120465}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.377681475607307e-06, "un_batch_to_individual_items": 5.2658323486081685e-06, "remove_single_ts_time_rank_from_batch": 5.641237642863861e-07, "tensor_to_numpy": 1.2835283740576804e-05, "get_actions": 3.556385547278162e-05, "listify_data_for_vector_env": 1.0955655499584004e-05}}, "connector_pipeline_timer": 0.0001001531676331678}, "rlmodule_inference_timer": 2.703704016636541e-05, "weights_seq_no": 14.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.146496449602556e-06, "numpy_to_tensor": 8.507030340085441e-06, "add_states_from_episodes_to_batch": 1.545059774081753e-06, "add_observations_from_episodes_to_batch": 2.8042456636131993e-06, "batch_individual_items": 6.1153958806581855e-06}}, "connector_pipeline_timer": 4.266280935816226e-05}, "sample": 0.10254591417080486, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.75, "episode_len_max": 20, "env_reset_timer": 0.0004333420066072594, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 70400, "episode_duration_sec_mean": 0.0045239258522633465, "num_episodes_lifetime": 280, "num_episodes": 20, "env_step_timer": 1.4436760618241084e-05, "module_episode_returns_mean": {"default_policy": 1.75}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "time_between_sampling": 1.6436713710167448}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-47", "timestamp": 1754932787, "time_this_iter_s": 1.7229108810424805, "time_total_s": 23.9161319732666, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.9161319732666, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 51.133333333333326, "ram_util_percent": 83.53333333333333}}
{"timers": {"training_iteration": 1.6216310500347264, "restore_env_runners": 1.2219532871243685e-05, "training_step": 1.6213620151121475, "env_runner_sampling_timer": 1.5057278559950427, "learner_update_timer": 0.11230600449706646, "synch_weights": 0.0006606349719944137, "restore_eval_env_runners": 9.140066254856794e-06, "evaluation_iteration": 0.11400651716172312, "synch_eval_env_connectors": 0.00012886132056823, "synch_env_connectors": 4.574686991610912e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.279349560732031e-07, "normalize_and_clip_actions": 1.0064359065373814e-05, "get_actions": 4.31382940104475e-05, "un_batch_to_individual_items": 5.680122354278855e-06, "listify_data_for_vector_env": 1.205503468713549e-05, "tensor_to_numpy": 1.4081213527835883e-05}}, "connector_pipeline_timer": 0.00011260658892449665}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.37088876230399e-06, "add_states_from_episodes_to_batch": 1.8370704104719032e-06, "add_observations_from_episodes_to_batch": 3.1977917807674567e-06, "batch_individual_items": 6.784872817820257e-06, "add_time_dim_to_batch_and_zero_pad": 2.530327238760569e-06}}, "connector_pipeline_timer": 4.659937662493507e-05}, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0019924325745673123, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 3.0136623552259754e-05, "episode_return_mean": 5.460000000000001, "episode_duration_sec_mean": 0.004923796995077281, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled_lifetime": -8017500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 14.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes_lifetime": -400875.0, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.4918805001231993e-05, "env_reset_timer": 4.350003010888711e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005087567809556706, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3556.512415812886}, "learners": {"default_policy": {"vf_loss_unclipped": 26.506343841552734, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.512681782245636, "weights_seq_no": 15.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 90000, "total_loss": -0.03857382386922836, "gradients_default_optimizer_global_norm": 0.0580829381942749, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 2.2781259758630767e-05, "num_module_steps_trained": 6000, "policy_loss": -0.10267102718353271, "mean_kl_loss": 0.0002160034200642258, "vf_explained_var": 0.005217373371124268, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 427864.92822638684}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03401624304199008, "add_one_ts_to_episodes_and_truncate": 0.008860749920048086, "general_advantage_estimation": 0.006475648323129512, "add_time_dim_to_batch_and_zero_pad": 1.1251299604832718e-05, "numpy_to_tensor": 7.258246792526691e-05, "add_states_from_episodes_to_batch": 3.4961234981511206e-06, "batch_individual_items": 0.036201726098333775, "add_observations_from_episodes_to_batch": 0.0008131026957132584}}, "connector_pipeline_timer": 0.08657778939932377}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained_lifetime_throughput": 2233139.583413483, "num_module_steps_trained_throughput": 427253.8679457753, "num_module_steps_trained_lifetime_throughput": 426533.8191916403}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4189808690118418e-05, "un_batch_to_individual_items": 7.814201116707754e-06, "remove_single_ts_time_rank_from_batch": 7.985611394414099e-07, "tensor_to_numpy": 2.0037635541986e-05, "get_actions": 5.902980565453968e-05, "listify_data_for_vector_env": 1.6240189085894356e-05}}, "connector_pipeline_timer": 0.00015482188975609384}, "rlmodule_inference_timer": 4.4077565488058125e-05, "weights_seq_no": 15.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.3327436132482433e-06, "numpy_to_tensor": 1.3721344960386561e-05, "add_states_from_episodes_to_batch": 2.0726704474758713e-06, "add_observations_from_episodes_to_batch": 3.954625863048904e-06, "batch_individual_items": 9.307946423795575e-06}}, "connector_pipeline_timer": 6.254649683932399e-05}, "sample": 0.10345802543917892, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.55, "episode_len_max": 20, "env_reset_timer": 0.0004393256767414471, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 75400, "episode_duration_sec_mean": 0.005308931230101735, "num_episodes_lifetime": 300, "num_episodes": 20, "env_step_timer": 2.158489258709091e-05, "module_episode_returns_mean": {"default_policy": 1.55}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "time_between_sampling": 1.6459143243868641}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-49", "timestamp": 1754932789, "time_this_iter_s": 2.0496301651000977, "time_total_s": 25.9657621383667, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.9657621383667, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 57.36666666666667, "ram_util_percent": 83.66666666666667}}
{"timers": {"training_iteration": 1.6241722174551145, "restore_env_runners": 1.2161917778161523e-05, "training_step": 1.6239037795410254, "env_runner_sampling_timer": 1.508434694514879, "learner_update_timer": 0.11214158154203, "synch_weights": 0.0006602036215636841, "restore_eval_env_runners": 9.137836236368003e-06, "evaluation_iteration": 0.11490298740986243, "synch_eval_env_connectors": 0.00012877770722478647, "synch_env_connectors": 4.583110499247312e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.337198162514803e-07, "normalize_and_clip_actions": 1.2017837272294108e-05, "get_actions": 5.362710794066584e-05, "un_batch_to_individual_items": 6.409065103612802e-06, "listify_data_for_vector_env": 1.394399595750567e-05, "tensor_to_numpy": 1.633102350643729e-05}}, "connector_pipeline_timer": 0.0001355846001008307}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.201601968577162e-05, "add_states_from_episodes_to_batch": 2.1050638567853873e-06, "add_observations_from_episodes_to_batch": 3.721469293633605e-06, "batch_individual_items": 7.959050136068079e-06, "add_time_dim_to_batch_and_zero_pad": 2.9108280335157813e-06}}, "connector_pipeline_timer": 5.426871080598378e-05}, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0029754786318446197, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 3.691606471462376e-05, "episode_return_mean": 5.619999999999999, "episode_duration_sec_mean": 0.0058693856559693825, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled_lifetime": -8635000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 15.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes_lifetime": -431750.0, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.823298669701328e-05, "env_reset_timer": 5.938445808657868e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.006327286784400109, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3170.6186752687845}, "learners": {"default_policy": {"vf_loss_unclipped": 26.065872192382812, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.49951738119125366, "weights_seq_no": 16.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 96000, "total_loss": -0.1426362693309784, "gradients_default_optimizer_global_norm": 0.03795118257403374, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 1.1390629879315384e-05, "num_module_steps_trained": 6000, "policy_loss": -0.2068527191877365, "mean_kl_loss": 0.00046676889178343117, "vf_explained_var": 0.004887521266937256, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 425312.7273059871}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.034019138112001496, "add_one_ts_to_episodes_and_truncate": 0.008853686591236557, "general_advantage_estimation": 0.006469146839938152, "add_time_dim_to_batch_and_zero_pad": 1.1346697388647987e-05, "numpy_to_tensor": 7.259080250327719e-05, "add_states_from_episodes_to_batch": 3.5128332037624943e-06, "batch_individual_items": 0.036150379667427, "add_observations_from_episodes_to_batch": 0.0008149479193412944}}, "connector_pipeline_timer": 0.08651763650583344}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained_lifetime_throughput": 2220483.975178942, "num_module_steps_trained_throughput": 424759.1330960921, "num_module_steps_trained_lifetime_throughput": 424067.2270939756}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.310590495758456e-06, "un_batch_to_individual_items": 5.203257343261796e-06, "remove_single_ts_time_rank_from_batch": 5.634535383977688e-07, "tensor_to_numpy": 1.2718347119735656e-05, "get_actions": 3.5048207737101305e-05, "listify_data_for_vector_env": 1.077173699715313e-05}}, "connector_pipeline_timer": 9.942741405900806e-05}, "rlmodule_inference_timer": 2.6640195218766312e-05, "weights_seq_no": 16.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1345751644237295e-06, "numpy_to_tensor": 8.269879545763456e-06, "add_states_from_episodes_to_batch": 1.5621964809239929e-06, "add_observations_from_episodes_to_batch": 2.7659018492521718e-06, "batch_individual_items": 6.0207407334147735e-06}}, "connector_pipeline_timer": 4.231091803111495e-05}, "sample": 0.10338886893408127, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.55, "episode_len_max": 20, "env_reset_timer": 0.000435957420793969, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 80400, "episode_duration_sec_mean": 0.005318742479430511, "num_episodes_lifetime": 320, "num_episodes": 20, "env_step_timer": 1.3770262068321143e-05, "module_episode_returns_mean": {"default_policy": 1.55}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "time_between_sampling": 1.6484897915627625}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-51", "timestamp": 1754932791, "time_this_iter_s": 1.9802942276000977, "time_total_s": 27.946056365966797, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.946056365966797, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 60.95, "ram_util_percent": 84.44999999999999}}
{"timers": {"training_iteration": 1.6242546156912814, "restore_env_runners": 1.2102378234897338e-05, "training_step": 1.6239870925852338, "env_runner_sampling_timer": 1.5087232600704825, "learner_update_timer": 0.11193776280672492, "synch_weights": 0.0006590199257907496, "restore_eval_env_runners": 9.179377396006662e-06, "evaluation_iteration": 0.11477489003601445, "synch_eval_env_connectors": 0.0001286665898688318, "synch_env_connectors": 4.5931098542966e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.76793993310469e-07, "normalize_and_clip_actions": 9.813907543887018e-06, "get_actions": 4.0180438327740164e-05, "un_batch_to_individual_items": 5.487718663914926e-06, "listify_data_for_vector_env": 1.1474528126018695e-05, "tensor_to_numpy": 1.3341859510721509e-05}}, "connector_pipeline_timer": 0.0001070442197219447}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.798685508626937e-06, "add_states_from_episodes_to_batch": 1.7948547013815365e-06, "add_observations_from_episodes_to_batch": 3.1625565486732522e-06, "batch_individual_items": 6.7165431556083195e-06, "add_time_dim_to_batch_and_zero_pad": 2.4841882365112432e-06}}, "connector_pipeline_timer": 4.504436484548265e-05}, "module_episode_returns_mean": {"default_policy": 7.139999999999999}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0016362984561210964, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 4.871969854941785e-05, "episode_return_mean": 7.139999999999999, "episode_duration_sec_mean": 0.00517710234830156, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled_lifetime": -9252500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 16.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes_lifetime": -462625.0, "agent_episode_returns_mean": {"default_agent": 7.139999999999999}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.6207248112696176e-05, "env_reset_timer": 3.709964282884889e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005458137941131015, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3703.881848962068}, "learners": {"default_policy": {"vf_loss_unclipped": 25.952669143676758, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.4784937798976898, "weights_seq_no": 17.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 102000, "total_loss": -0.044959671795368195, "gradients_default_optimizer_global_norm": 0.10882989317178726, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 5.695314939657692e-06, "num_module_steps_trained": 6000, "policy_loss": -0.1093665286898613, "mean_kl_loss": 0.0006145501974970102, "vf_explained_var": 0.004864335060119629, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 423577.7239276796}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.034015694230995625, "add_one_ts_to_episodes_and_truncate": 0.008842705135422476, "general_advantage_estimation": 0.006458699121012015, "add_time_dim_to_batch_and_zero_pad": 1.1331150834409797e-05, "numpy_to_tensor": 7.237906370185101e-05, "add_states_from_episodes_to_batch": 3.508125359471466e-06, "batch_individual_items": 0.036090541289999736, "add_observations_from_episodes_to_batch": 0.0008171780209287452}}, "connector_pipeline_timer": 0.0864345568107843}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained_lifetime_throughput": 2212082.806752717, "num_module_steps_trained_throughput": 423081.5338332482, "num_module_steps_trained_lifetime_throughput": 422414.73728108505}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.11001463426731e-06, "un_batch_to_individual_items": 5.165370983450834e-06, "remove_single_ts_time_rank_from_batch": 5.46553027573695e-07, "tensor_to_numpy": 1.2412255194888556e-05, "get_actions": 3.414932591355138e-05, "listify_data_for_vector_env": 1.0706134398530827e-05}}, "connector_pipeline_timer": 9.744513010016022e-05}, "rlmodule_inference_timer": 2.604986113520942e-05, "weights_seq_no": 17.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0950189342538915e-06, "numpy_to_tensor": 8.149388449815416e-06, "add_states_from_episodes_to_batch": 1.531828820006227e-06, "add_observations_from_episodes_to_batch": 2.7155224547076257e-06, "batch_individual_items": 5.913961415565914e-06}}, "connector_pipeline_timer": 4.172157336955945e-05}, "sample": 0.1033061348248474, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.95, "episode_len_max": 20, "env_reset_timer": 0.0004327245163989768, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 0.95}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 85400, "episode_duration_sec_mean": 0.00530783579335548, "num_episodes_lifetime": 340, "num_episodes": 20, "env_step_timer": 1.3514962749445129e-05, "module_episode_returns_mean": {"default_policy": 0.95}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "time_between_sampling": 1.6485063053170226}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-53", "timestamp": 1754932793, "time_this_iter_s": 1.7351219654083252, "time_total_s": 29.681178331375122, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.681178331375122, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 43.93333333333334, "ram_util_percent": 80.93333333333334}}
{"timers": {"training_iteration": 1.6254984124443472, "restore_env_runners": 1.2033014915762285e-05, "training_step": 1.6252316829089322, "env_runner_sampling_timer": 1.508940974560113, "learner_update_timer": 0.11295540892818612, "synch_weights": 0.0006602743171147956, "restore_eval_env_runners": 9.15216385767687e-06, "evaluation_iteration": 0.11463035905515111, "synch_eval_env_connectors": 0.00012832117444340436, "synch_env_connectors": 4.58842936088979e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.866203495377601e-07, "normalize_and_clip_actions": 1.043198816874655e-05, "get_actions": 4.3359318221904566e-05, "un_batch_to_individual_items": 5.888328637580235e-06, "listify_data_for_vector_env": 1.237091380504957e-05, "tensor_to_numpy": 1.4159604639861763e-05}}, "connector_pipeline_timer": 0.00011448550795842336}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.861118196495012e-06, "add_states_from_episodes_to_batch": 1.889868019451162e-06, "add_observations_from_episodes_to_batch": 3.2045252461793684e-06, "batch_individual_items": 7.083269053962576e-06, "add_time_dim_to_batch_and_zero_pad": 2.566743939492469e-06}}, "connector_pipeline_timer": 4.748485852230122e-05}, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0015113267956494791, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 3.0449421966388408e-05, "episode_return_mean": 7.2200000000000015, "episode_duration_sec_mean": 0.005021140528842807, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled_lifetime": -9870000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 17.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes_lifetime": -493500.0, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.5242344110191506e-05, "env_reset_timer": 3.864985133859013e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005318036576088428, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3482.252053419639}, "learners": {"default_policy": {"vf_loss_unclipped": 26.084064483642578, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.46768543124198914, "weights_seq_no": 18.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 108000, "total_loss": 0.0203655194491148, "gradients_default_optimizer_global_norm": 0.0484977550804615, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 2.847657469828846e-06, "num_module_steps_trained": 6000, "policy_loss": -0.044139228761196136, "mean_kl_loss": 3.0231125492719002e-05, "vf_explained_var": 0.005313515663146973, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 420802.54390062334}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03407486895800882, "add_one_ts_to_episodes_and_truncate": 0.008852327254405868, "general_advantage_estimation": 0.006456332129765312, "add_time_dim_to_batch_and_zero_pad": 1.1322838961434284e-05, "numpy_to_tensor": 7.23427730611072e-05, "add_states_from_episodes_to_batch": 3.5109535912764743e-06, "batch_individual_items": 0.0371108479565316, "add_observations_from_episodes_to_batch": 0.0008189520708168798}}, "connector_pipeline_timer": 0.08752307791242071}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained_lifetime_throughput": 2198183.116249293, "num_module_steps_trained_throughput": 420359.83314678667, "num_module_steps_trained_lifetime_throughput": 419717.1189723462}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2648055316192209e-05, "un_batch_to_individual_items": 6.986707795844734e-06, "remove_single_ts_time_rank_from_batch": 6.560163194550172e-07, "tensor_to_numpy": 1.701724515571924e-05, "get_actions": 5.1782748091831435e-05, "listify_data_for_vector_env": 1.392612136615891e-05}}, "connector_pipeline_timer": 0.00013524826952897816}, "rlmodule_inference_timer": 3.565515952588553e-05, "weights_seq_no": 18.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.8572384039692746e-06, "numpy_to_tensor": 1.1114413389861704e-05, "add_states_from_episodes_to_batch": 1.770141440652515e-06, "add_observations_from_episodes_to_batch": 3.240892458699487e-06, "batch_individual_items": 7.600603031310315e-06}}, "connector_pipeline_timer": 5.0919583971752124e-05}, "sample": 0.1035789547263173, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.55, "episode_len_max": 20, "env_reset_timer": 0.0004293372714076915, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_len_min": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 0.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 90400, "episode_duration_sec_mean": 0.005584935385268181, "num_episodes_lifetime": 360, "num_episodes": 20, "env_step_timer": 1.906157398846487e-05, "module_episode_returns_mean": {"default_policy": 0.55}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "time_between_sampling": 1.6496860630939572}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-55", "timestamp": 1754932795, "time_this_iter_s": 1.8881893157958984, "time_total_s": 31.56936764717102, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.56936764717102, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 45.23333333333334, "ram_util_percent": 80.2}}
{"timers": {"training_iteration": 1.626152551229323, "restore_env_runners": 1.197643496099031e-05, "training_step": 1.6258863069097829, "env_runner_sampling_timer": 1.508948093984917, "learner_update_timer": 0.1136051681685115, "synch_weights": 0.0006589803233306883, "restore_eval_env_runners": 9.137721967834934e-06, "evaluation_iteration": 0.1148505046353455, "synch_eval_env_connectors": 0.00012819630330022087, "synch_env_connectors": 4.584624549508456e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.476712063628548e-07, "normalize_and_clip_actions": 1.0228866674883042e-05, "get_actions": 4.337932358111339e-05, "un_batch_to_individual_items": 5.7587575108498324e-06, "listify_data_for_vector_env": 1.2222217749123424e-05, "tensor_to_numpy": 1.4274004586347633e-05}}, "connector_pipeline_timer": 0.00011399232190970427}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.70803564199463e-06, "add_states_from_episodes_to_batch": 1.9209021078266697e-06, "add_observations_from_episodes_to_batch": 3.2279858818796596e-06, "batch_individual_items": 6.904467299821355e-06, "add_time_dim_to_batch_and_zero_pad": 2.5372162286324465e-06}}, "connector_pipeline_timer": 4.7315802490352974e-05}, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.002188784565558858, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 3.0807703068132716e-05, "episode_return_mean": 7.2200000000000015, "episode_duration_sec_mean": 0.004974707792513072, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled_lifetime": -10487500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 18.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes_lifetime": -524375.0, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.526577608423827e-05, "env_reset_timer": 4.825341260344114e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005574556868778621, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3399.8000140493295}, "learners": {"default_policy": {"vf_loss_unclipped": 26.0632381439209, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.4804908037185669, "weights_seq_no": 19.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 114000, "total_loss": 0.02004677802324295, "gradients_default_optimizer_global_norm": 0.03202617168426514, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 1.423828734914423e-06, "num_module_steps_trained": 6000, "policy_loss": -0.044341981410980225, "mean_kl_loss": 0.00025957918842323124, "vf_explained_var": 0.005652189254760742, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 419310.7416445072}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03407274151854965, "add_one_ts_to_episodes_and_truncate": 0.008841668982210348, "general_advantage_estimation": 0.006443515898650856, "add_time_dim_to_batch_and_zero_pad": 1.1297530915323297e-05, "numpy_to_tensor": 7.217642524172812e-05, "add_states_from_episodes_to_batch": 3.5054240244867156e-06, "batch_individual_items": 0.03791382239715437, "add_observations_from_episodes_to_batch": 0.0008188375510597777}}, "connector_pipeline_timer": 0.08829971754255607}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained_lifetime_throughput": 2190979.528025606, "num_module_steps_trained_throughput": 418917.7570684717, "num_module_steps_trained_lifetime_throughput": 418297.8390143281}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.189765377236419e-06, "un_batch_to_individual_items": 5.257872062570733e-06, "remove_single_ts_time_rank_from_batch": 5.517154170278253e-07, "tensor_to_numpy": 1.270860384395158e-05, "get_actions": 3.497120121202723e-05, "listify_data_for_vector_env": 1.0762929993484713e-05}}, "connector_pipeline_timer": 9.901255299201521e-05}, "rlmodule_inference_timer": 2.6531135581386562e-05, "weights_seq_no": 19.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1230957983217453e-06, "numpy_to_tensor": 8.316186811022653e-06, "add_states_from_episodes_to_batch": 1.5459855045149467e-06, "add_observations_from_episodes_to_batch": 2.7375221936409443e-06, "batch_individual_items": 5.955556615273368e-06}}, "connector_pipeline_timer": 4.2053506897002426e-05}, "sample": 0.10349769850898614, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.05, "episode_len_max": 20, "env_reset_timer": 0.0004257188991767847, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -0.05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 95400, "episode_duration_sec_mean": 0.005575659150490537, "num_episodes_lifetime": 380, "num_episodes": 20, "env_step_timer": 1.365291918437425e-05, "module_episode_returns_mean": {"default_policy": -0.05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "time_between_sampling": 1.6503125116331463}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-57", "timestamp": 1754932797, "time_this_iter_s": 1.7934579849243164, "time_total_s": 33.36282563209534, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.36282563209534, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 56.45, "ram_util_percent": 80.05}}
{"timers": {"training_iteration": 1.6266055569677933, "restore_env_runners": 1.1909590688376495e-05, "training_step": 1.626340191340963, "env_runner_sampling_timer": 1.50958557221491, "learner_update_timer": 0.11342323898708769, "synch_weights": 0.0006577305200134133, "restore_eval_env_runners": 9.110094942542232e-06, "evaluation_iteration": 0.1147035833388861, "synch_eval_env_connectors": 0.00012784934040185067, "synch_env_connectors": 4.5800289091495275e-06}, "env_runners": {"episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.918710655458505e-07, "normalize_and_clip_actions": 1.0655040895573956e-05, "get_actions": 4.4815959964844104e-05, "un_batch_to_individual_items": 6.046822776465044e-06, "listify_data_for_vector_env": 1.2654598946131435e-05, "tensor_to_numpy": 1.4777764652505654e-05}}, "connector_pipeline_timer": 0.00011794728888443253}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0158217064286296e-05, "add_states_from_episodes_to_batch": 1.920941615838049e-06, "add_observations_from_episodes_to_batch": 3.3355122589071052e-06, "batch_individual_items": 7.099190626678938e-06, "add_time_dim_to_batch_and_zero_pad": 2.6425486592511776e-06}}, "connector_pipeline_timer": 4.897008404002468e-05}, "module_episode_returns_mean": {"default_policy": 6.580000000000001}, "episode_return_min": -11.5, "episode_len_mean": 20.0, "time_between_sampling": 0.0018896770684030796, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 3.142826431354987e-05, "episode_return_mean": 6.580000000000001, "episode_duration_sec_mean": 0.005167809651698918, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_env_steps_sampled_lifetime": -11105000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 19.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes_lifetime": -555250.0, "agent_episode_returns_mean": {"default_agent": 6.580000000000001}, "episode_len_max": 20, "num_episodes": 250.0, "env_step_timer": 1.5841509391195128e-05, "env_reset_timer": 4.253150738002329e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005283297192093505, "num_env_steps_sampled": 5000.0, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime_throughput": 3385.345027292954}, "learners": {"default_policy": {"vf_loss_unclipped": 26.30100440979004, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.4970702528953552, "weights_seq_no": 20.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 120000, "total_loss": 0.050652336329221725, "gradients_default_optimizer_global_norm": 0.044757142663002014, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 7.119143674572115e-07, "num_module_steps_trained": 6000, "policy_loss": -0.013586264103651047, "mean_kl_loss": 0.0006841972935944796, "vf_explained_var": 0.006448864936828613, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 418081.094365124}, "__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03407580160236913, "add_one_ts_to_episodes_and_truncate": 0.00883186438224384, "general_advantage_estimation": 0.006435315740621151, "add_time_dim_to_batch_and_zero_pad": 1.129080554209507e-05, "numpy_to_tensor": 7.211924113702425e-05, "add_states_from_episodes_to_batch": 3.4995294940530587e-06, "batch_individual_items": 0.03784889542253433, "add_observations_from_episodes_to_batch": 0.0008191279257911003}}, "connector_pipeline_timer": 0.08821986869685414}, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained_lifetime_throughput": 2185151.8514160165, "num_module_steps_trained_throughput": 417738.8249868292, "num_module_steps_trained_lifetime_throughput": 417141.9919324268}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.64199002790608e-06, "un_batch_to_individual_items": 5.394941886581377e-06, "remove_single_ts_time_rank_from_batch": 5.736174474772234e-07, "tensor_to_numpy": 1.3212147253166208e-05, "get_actions": 3.790280837186827e-05, "listify_data_for_vector_env": 1.126769561389963e-05}}, "connector_pipeline_timer": 0.00010437749129382078}, "rlmodule_inference_timer": 2.8368907394887842e-05, "weights_seq_no": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2190195829065204e-06, "numpy_to_tensor": 8.687117793778656e-06, "add_states_from_episodes_to_batch": 1.5869278404925499e-06, "add_observations_from_episodes_to_batch": 2.854710128483546e-06, "batch_individual_items": 6.209937840881192e-06}}, "connector_pipeline_timer": 4.320699276670707e-05}, "sample": 0.10344525944308607, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.15, "episode_len_max": 20, "env_reset_timer": 0.0004222054609006451, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 14.5, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 0.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 100400, "episode_duration_sec_mean": 0.004731801240704953, "num_episodes_lifetime": 400, "num_episodes": 20, "env_step_timer": 1.5052196734011437e-05, "module_episode_returns_mean": {"default_policy": 0.15}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "time_between_sampling": 1.6506995515170375}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "5019d_00000", "date": "2025-08-11_19-19-59", "timestamp": 1754932799, "time_this_iter_s": 1.7774348258972168, "time_total_s": 35.140260457992554, "pid": 14119, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.140260457992554, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 46.1, "ram_util_percent": 80.23333333333333}}
