{"timers": {"training_iteration": 4.375007083057426, "restore_env_runners": 1.1625001206994057e-05, "training_step": 4.374756791978143, "env_runner_sampling_timer": 4.183840374927968, "learner_update_timer": 0.18646541598718613, "synch_weights": 0.0008093750802800059}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.106646566256637e-05, "un_batch_to_individual_items": 1.353412205692486e-05, "listify_data_for_vector_env": 2.8938878428621848e-05, "get_actions": 0.0001423961791251454, "normalize_and_clip_actions": 2.6333431274590706e-05, "remove_single_ts_time_rank_from_batch": 1.6257256480733971e-06}}, "connector_pipeline_timer": 0.0003162840351137497}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011978364019976595, "timers": {"connectors": {"add_states_from_episodes_to_batch": 9.307508437653562e-06, "numpy_to_tensor": 2.7243129374457514e-05, "add_observations_from_episodes_to_batch": 7.437963419349837e-06, "add_time_dim_to_batch_and_zero_pad": 5.918411162446052e-06, "batch_individual_items": 1.8377546637861682e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": -1.5, "agent_episode_returns_mean": {"default_agent": -1.5}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.014366561810486013, "env_to_module_sum_episodes_length_out": 10.191744832559449, "module_episode_returns_mean": {"default_policy": -1.5}, "num_episodes_lifetime": 31375.0, "env_step_timer": 4.2924451802638485e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "sample": 0.013368637972818996, "env_reset_timer": 0.00021174231170916969, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_env_steps_sampled_lifetime": 627500.0, "num_episodes": 250.0, "time_between_sampling": 0.001007925494349548, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 0.0001479325828465654, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime_throughput": 1620.4097716042893}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001562080578878522, "batch_individual_items": 0.041905707912519574, "add_observations_from_episodes_to_batch": 0.0016927500255405903, "add_one_ts_to_episodes_and_truncate": 0.019617583020590246, "add_columns_from_episodes_to_train_batch": 0.06400029198266566, "add_time_dim_to_batch_and_zero_pad": 4.962494131177664e-05, "add_states_from_episodes_to_batch": 4.749977961182594e-06, "general_advantage_estimation": 0.013047458953224123}}, "connector_pipeline_timer": 0.14068270788993686}, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime_throughput": 1249595.3254061402, "num_module_steps_trained_throughput": 236452.91328253417, "num_module_steps_trained_lifetime_throughput": 236767.54825917806}, "default_policy": {"policy_loss": -0.04181544482707977, "weights_seq_no": 1.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0005123130395077169, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 28.887786865234375, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 6000, "entropy": 0.6905115842819214, "curr_kl_coeff": 0.3732481598854065, "vf_explained_var": 0.0005095601081848145, "module_train_batch_size_mean": 1000.0, "total_loss": 0.02105357125401497, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.040778517723083496, "num_module_steps_trained_lifetime_throughput": 235577.1619824845}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.3532601578833048e-06, "tensor_to_numpy": 4.050246007909558e-05, "normalize_and_clip_actions": 2.6866086623981415e-05, "get_actions": 0.000130823806567479, "listify_data_for_vector_env": 2.6493317849912438e-05, "un_batch_to_individual_items": 1.423009224487128e-05}}, "connector_pipeline_timer": 0.0003016546513638605}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.390824435806187e-06, "add_states_from_episodes_to_batch": 2.933159259482204e-06, "add_time_dim_to_batch_and_zero_pad": 6.409318727243604e-06, "numpy_to_tensor": 2.4963488843947128e-05, "batch_individual_items": 1.775533682661385e-05}}, "connector_pipeline_timer": 0.00010314977165710816}, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_duration_sec_mean": 0.014580725092673674, "num_episodes_lifetime": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 0.75, "env_step_timer": 4.034028460435758e-05, "env_reset_timer": 0.0014184589963406324, "agent_episode_returns_mean": {"default_agent": 0.75}, "module_episode_returns_mean": {"default_policy": 0.75}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "sample": 0.3197282920591533, "weights_seq_no": 1.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 5400, "rlmodule_inference_timer": 9.196237959781432e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "5020f_00000", "date": "2025-08-11_19-31-45", "timestamp": 1754933505, "time_this_iter_s": 4.741618871688843, "time_total_s": 4.741618871688843, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.741618871688843, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 73.25714285714287, "ram_util_percent": 79.64285714285714}}
{"timers": {"training_iteration": 4.365690333056263, "restore_env_runners": 1.194083015434444e-05, "training_step": 4.365437299057376, "env_runner_sampling_timer": 4.173220309929457, "learner_update_timer": 0.18777450807741844, "synch_weights": 0.0008097184193320572, "restore_eval_env_runners": 1.2042000889778137e-05, "evaluation_iteration": 0.36298533400986344, "synch_eval_env_connectors": 0.0004914170131087303, "synch_env_connectors": 0.0004503750242292881}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.0890285846114354e-05, "un_batch_to_individual_items": 1.12232351090473e-05, "listify_data_for_vector_env": 2.3557740836356635e-05, "get_actions": 0.00010872541101308704, "normalize_and_clip_actions": 1.962193822805313e-05, "remove_single_ts_time_rank_from_batch": 1.125151530602264e-06}}, "connector_pipeline_timer": 0.00024706806326525363}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_connector": {"connector_pipeline_timer": 9.041599677416865e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1372788800883274e-06, "numpy_to_tensor": 2.140876007175698e-05, "add_observations_from_episodes_to_batch": 6.326434135011289e-06, "add_time_dim_to_batch_and_zero_pad": 4.713803323947369e-06, "batch_individual_items": 1.5352051922295898e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 0.17999999999999997, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.010582480002194646, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "num_episodes_lifetime": 500.0, "env_step_timer": 3.968052255967138e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "sample": 0.013363928049755894, "env_reset_timer": 0.0001142038659807376, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": 10000.0, "num_episodes": 250.0, "time_between_sampling": 0.0038923915883313544, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 7.495759521643886e-05, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime_throughput": 2066.6983642281048}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015541139640845358, "batch_individual_items": 0.043423274992965166, "add_observations_from_episodes_to_batch": 0.001690996275283396, "add_one_ts_to_episodes_and_truncate": 0.01954250802984461, "add_columns_from_episodes_to_train_batch": 0.06416288281325251, "add_time_dim_to_batch_and_zero_pad": 4.950827220454812e-05, "add_states_from_episodes_to_batch": 4.7787290532141925e-06, "general_advantage_estimation": 0.012979966453276575}}, "connector_pipeline_timer": 0.14221743997186423}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1250103.9939892683, "num_module_steps_trained_throughput": 236565.9072551601, "num_module_steps_trained_lifetime_throughput": 236876.88189736166}, "default_policy": {"policy_loss": 0.1580778807401657, "weights_seq_no": 2.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 5.7608696806710213e-05, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 28.989748001098633, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 12000, "entropy": 0.6900495290756226, "curr_kl_coeff": 0.18662407994270325, "vf_explained_var": 0.0014600753784179688, "module_train_batch_size_mean": 1000.0, "total_loss": 0.22059014439582825, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.12324754893779755, "num_module_steps_trained_lifetime_throughput": 235686.3979757929}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0940908894555474e-06, "tensor_to_numpy": 2.881732904961143e-05, "normalize_and_clip_actions": 1.9954834344808516e-05, "get_actions": 8.607124808650877e-05, "listify_data_for_vector_env": 1.9512844149607073e-05, "un_batch_to_individual_items": 9.635067874057977e-06}}, "connector_pipeline_timer": 0.0002129276505498425}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.548550302082619e-06, "add_states_from_episodes_to_batch": 2.37369921403299e-06, "add_time_dim_to_batch_and_zero_pad": 4.213484317187842e-06, "numpy_to_tensor": 1.6116299330894282e-05, "batch_individual_items": 1.092128316427005e-05}}, "connector_pipeline_timer": 7.05696585124477e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_duration_sec_mean": 0.011652359343133866, "num_episodes_lifetime": 40, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 3.75, "env_step_timer": 2.660390254268982e-05, "env_reset_timer": 0.0014051119063515217, "agent_episode_returns_mean": {"default_agent": 3.75}, "module_episode_returns_mean": {"default_policy": 3.75}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "sample": 0.3184407341387123, "weights_seq_no": 2.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 10400, "rlmodule_inference_timer": 5.744825628068149e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5965401659486815}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "5020f_00000", "date": "2025-08-11_19-31-49", "timestamp": 1754933509, "time_this_iter_s": 3.6423332691192627, "time_total_s": 8.383952140808105, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.383952140808105, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 82.48333333333333, "ram_util_percent": 80.41666666666667}}
{"timers": {"training_iteration": 4.349050133476406, "restore_env_runners": 1.1891421221662312e-05, "training_step": 4.3487962369069235, "env_runner_sampling_timer": 4.157008183910163, "learner_update_timer": 0.18734270008580062, "synch_weights": 0.0008103937349980696, "restore_eval_env_runners": 1.2007410405203701e-05, "evaluation_iteration": 0.36132437317050065, "synch_eval_env_connectors": 0.0004875778430141509, "synch_env_connectors": 0.00044592086458578706}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.5749100865355812e-05, "un_batch_to_individual_items": 9.3176211480606e-06, "listify_data_for_vector_env": 1.9823316361801034e-05, "get_actions": 8.240792261137064e-05, "normalize_and_clip_actions": 1.6170095630688257e-05, "remove_single_ts_time_rank_from_batch": 1.0117408287268833e-06}}, "connector_pipeline_timer": 0.00019735827271016008}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.578386846661765e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6721881703216884e-06, "numpy_to_tensor": 1.724161893064711e-05, "add_observations_from_episodes_to_batch": 5.126916922246446e-06, "add_time_dim_to_batch_and_zero_pad": 4.23317544932478e-06, "batch_individual_items": 1.187952821251903e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 0.3400000000000001, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008543381322640925, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "num_episodes_lifetime": -30375.0, "env_step_timer": 2.8570858073736667e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "sample": 0.008973069919688487, "env_reset_timer": 8.111374648341923e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -607500.0, "num_episodes": 250.0, "time_between_sampling": 0.0031975443698660415, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.5463364956592976e-05, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime_throughput": 2344.4817408060717}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015467811290873214, "batch_individual_items": 0.04343622349323705, "add_observations_from_episodes_to_batch": 0.001683347142068669, "add_one_ts_to_episodes_and_truncate": 0.01943471877982374, "add_columns_from_episodes_to_train_batch": 0.0639394156546332, "add_time_dim_to_batch_and_zero_pad": 4.914985990617424e-05, "add_states_from_episodes_to_batch": 4.765111987944692e-06, "general_advantage_estimation": 0.012972212198842318}}, "connector_pipeline_timer": 0.14188198516238482}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1244614.4217191872, "num_module_steps_trained_throughput": 235553.83462923538, "num_module_steps_trained_lifetime_throughput": 235856.02380573226}, "default_policy": {"policy_loss": 0.0031105533707886934, "weights_seq_no": 3.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 7.996203930815682e-05, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 28.398405075073242, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 18000, "entropy": 0.6902889013290405, "curr_kl_coeff": 0.09331203997135162, "vf_explained_var": 0.001783132553100586, "module_train_batch_size_mean": 1000.0, "total_loss": 0.06561407446861267, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11024872958660126, "num_module_steps_trained_lifetime_throughput": 234675.11606142388}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.0294518240269e-07, "tensor_to_numpy": 1.9394886582702124e-05, "normalize_and_clip_actions": 1.2766164057427983e-05, "get_actions": 6.327052857751028e-05, "listify_data_for_vector_env": 1.5054380475520036e-05, "un_batch_to_individual_items": 7.117217055802816e-06}}, "connector_pipeline_timer": 0.00015055186447547435}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4609038118328423e-06, "add_states_from_episodes_to_batch": 1.963621869753631e-06, "add_time_dim_to_batch_and_zero_pad": 3.66020904097379e-06, "numpy_to_tensor": 1.2733259955863462e-05, "batch_individual_items": 9.578974782548969e-06}}, "connector_pipeline_timer": 5.884318659865236e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_duration_sec_mean": 0.010582899950289477, "num_episodes_lifetime": 60, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 2.4166666666666665, "env_step_timer": 1.971663488840596e-05, "env_reset_timer": 0.0013934241172741167, "agent_episode_returns_mean": {"default_agent": 2.4166666666666665}, "module_episode_returns_mean": {"default_policy": 2.4166666666666665}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "sample": 0.3170885263771285, "weights_seq_no": 3.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 15400, "rlmodule_inference_timer": 4.163215650686137e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5879034071997737}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "5020f_00000", "date": "2025-08-11_19-31-52", "timestamp": 1754933512, "time_this_iter_s": 2.901237964630127, "time_total_s": 11.285190105438232, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.285190105438232, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 76.9, "ram_util_percent": 80.475}}
{"timers": {"training_iteration": 4.337749017562285, "restore_env_runners": 1.1837087245075963e-05, "training_step": 4.337493958287703, "env_runner_sampling_timer": 4.145439586651632, "learner_update_timer": 0.18757867225509173, "synch_weights": 0.0008283972979553509, "restore_eval_env_runners": 1.2165256927255543e-05, "evaluation_iteration": 0.35963399360884213, "synch_eval_env_connectors": 0.0004845983153441921, "synch_env_connectors": 0.0004415104060200974}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.6668518487867423e-05, "un_batch_to_individual_items": 9.34792939094482e-06, "listify_data_for_vector_env": 2.2226092764001657e-05, "get_actions": 9.30203378904809e-05, "normalize_and_clip_actions": 1.7110331349251748e-05, "remove_single_ts_time_rank_from_batch": 9.646840769518756e-07}}, "connector_pipeline_timer": 0.00021441348039907894}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_to_module_connector": {"connector_pipeline_timer": 9.003400466945005e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6176383668891756e-06, "numpy_to_tensor": 2.0898691865689982e-05, "add_observations_from_episodes_to_batch": 5.8209859423583185e-06, "add_time_dim_to_batch_and_zero_pad": 4.620293709254141e-06, "batch_individual_items": 1.351048285395324e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": -0.3, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.009628464011475445, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -0.3}, "num_episodes_lifetime": -61250.0, "env_step_timer": 3.313974928366026e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "sample": 0.009299989092813998, "env_reset_timer": 8.567166919653793e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -1225000.0, "num_episodes": 250.0, "time_between_sampling": 0.0029565443660133956, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.826305768336397e-05, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime_throughput": 2332.642798799384}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001540584110157797, "batch_individual_items": 0.04359586542857532, "add_observations_from_episodes_to_batch": 0.0016774624199070965, "add_one_ts_to_episodes_and_truncate": 0.01947069201167603, "add_columns_from_episodes_to_train_batch": 0.06385086482748854, "add_time_dim_to_batch_and_zero_pad": 4.897919145668856e-05, "add_states_from_episodes_to_batch": 4.762461210717447e-06, "general_advantage_estimation": 0.012956894245998003}}, "connector_pipeline_timer": 0.141968171980083}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1233805.3022063258, "num_module_steps_trained_throughput": 233536.2335222978, "num_module_steps_trained_lifetime_throughput": 233829.80908589734}, "default_policy": {"policy_loss": 0.004799160175025463, "weights_seq_no": 4.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.00018847151659429073, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 28.49736213684082, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 24000, "entropy": 0.6886228322982788, "curr_kl_coeff": 0.04665601998567581, "vf_explained_var": 0.002683281898498535, "module_train_batch_size_mean": 1000.0, "total_loss": 0.06732043623924255, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.035478390753269196, "num_module_steps_trained_lifetime_throughput": 232673.7705944089}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5407348826117958e-06, "tensor_to_numpy": 3.5205328399325155e-05, "normalize_and_clip_actions": 1.975699282672661e-05, "get_actions": 0.00013717662649008846, "listify_data_for_vector_env": 3.5881481806701805e-05, "un_batch_to_individual_items": 1.275578488976634e-05}}, "connector_pipeline_timer": 0.00030270120918996136}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.946671471587084e-06, "add_states_from_episodes_to_batch": 3.315985091126284e-06, "add_time_dim_to_batch_and_zero_pad": 1.566202468251595e-05, "numpy_to_tensor": 2.4429528175661782e-05, "batch_individual_items": 2.3168398825230907e-05}}, "connector_pipeline_timer": 0.00012445025041460674}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_duration_sec_mean": 0.010931027046171948, "num_episodes_lifetime": 80, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 2.75, "env_step_timer": 3.930543473655946e-05, "env_reset_timer": 0.0013934473758606472, "agent_episode_returns_mean": {"default_agent": 2.75}, "module_episode_returns_mean": {"default_policy": 2.75}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "sample": 0.3165736711128461, "weights_seq_no": 4.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 20400, "rlmodule_inference_timer": 9.773448070401075e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.584597269377834}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "5020f_00000", "date": "2025-08-11_19-31-56", "timestamp": 1754933516, "time_this_iter_s": 3.5119481086730957, "time_total_s": 14.797138214111328, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.797138214111328, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 81.76, "ram_util_percent": 80.96000000000001}}
{"timers": {"training_iteration": 4.324148927796464, "restore_env_runners": 1.1845376242772908e-05, "training_step": 4.323894284545406, "env_runner_sampling_timer": 4.13227747370498, "learner_update_timer": 0.18715120136157942, "synch_weights": 0.0008265658246318041, "restore_eval_env_runners": 1.2565274220774883e-05, "evaluation_iteration": 0.3589323886726171, "synch_eval_env_connectors": 0.0004821902413244825, "synch_env_connectors": 0.0004371469717363361}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.6197562713694e-05, "un_batch_to_individual_items": 9.79603459236254e-06, "listify_data_for_vector_env": 2.0182180315823393e-05, "get_actions": 8.865615138778416e-05, "normalize_and_clip_actions": 1.684113442382683e-05, "remove_single_ts_time_rank_from_batch": 1.0539634094996697e-06}}, "connector_pipeline_timer": 0.0002074976248946515}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.989352044507721e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.616289699197042e-06, "numpy_to_tensor": 1.9398040424706632e-05, "add_observations_from_episodes_to_batch": 5.561395859770649e-06, "add_time_dim_to_batch_and_zero_pad": 4.393616070459355e-06, "batch_individual_items": 1.2334053582970349e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": -0.14000000000000007, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00945467765862122, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "num_episodes_lifetime": -92125.0, "env_step_timer": 2.9083420321923103e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "sample": 0.010815817472735727, "env_reset_timer": 8.744778822349482e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -1842500.0, "num_episodes": 250.0, "time_between_sampling": 0.003561448276211596, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 9.402803065102175e-05, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime_throughput": 2209.7409709293092}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015325907702013733, "batch_individual_items": 0.04360114052402381, "add_observations_from_episodes_to_batch": 0.0016715077954419654, "add_one_ts_to_episodes_and_truncate": 0.019407364671684482, "add_columns_from_episodes_to_train_batch": 0.06369887700952268, "add_time_dim_to_batch_and_zero_pad": 4.862439940592507e-05, "add_states_from_episodes_to_batch": 4.749835700964323e-06, "general_advantage_estimation": 0.012905298633000134}}, "connector_pipeline_timer": 0.14169951776044593}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1223930.8704667122, "num_module_steps_trained_throughput": 231704.8538666548, "num_module_steps_trained_lifetime_throughput": 231987.61333620636}, "default_policy": {"policy_loss": 0.03844098374247551, "weights_seq_no": 5.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0005214021657593548, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 28.689939498901367, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 30000, "entropy": 0.6842040419578552, "curr_kl_coeff": 0.023328009992837906, "vf_explained_var": 0.003237903118133545, "module_train_batch_size_mean": 1000.0, "total_loss": 0.10100902616977692, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.09610242396593094, "num_module_steps_trained_lifetime_throughput": 230861.6304922618}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.411595041406225e-07, "tensor_to_numpy": 2.390944121644946e-05, "normalize_and_clip_actions": 1.6076914751250262e-05, "get_actions": 8.167247525921752e-05, "listify_data_for_vector_env": 1.8447306605086773e-05, "un_batch_to_individual_items": 9.172220723588645e-06}}, "connector_pipeline_timer": 0.00019131856766879313}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.9550875600916015e-06, "add_states_from_episodes_to_batch": 2.23577232133572e-06, "add_time_dim_to_batch_and_zero_pad": 3.998005730976611e-06, "numpy_to_tensor": 1.4157937218727138e-05, "batch_individual_items": 1.0952975893296511e-05}}, "connector_pipeline_timer": 6.935615543484092e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_duration_sec_mean": 0.0114896024891641, "num_episodes_lifetime": 100, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 2.15, "env_step_timer": 2.6495074029762287e-05, "env_reset_timer": 0.0013828712326796526, "agent_episode_returns_mean": {"default_agent": 2.15}, "module_episode_returns_mean": {"default_policy": 2.15}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "sample": 0.31643549398223186, "weights_seq_no": 5.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 25400, "rlmodule_inference_timer": 4.9724794219832296e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.579010115434791}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "5020f_00000", "date": "2025-08-11_19-31-59", "timestamp": 1754933519, "time_this_iter_s": 3.2983617782592773, "time_total_s": 18.095499992370605, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.095499992370605, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 48.55, "ram_util_percent": 81.6}}
{"timers": {"training_iteration": 4.316821718937737, "restore_env_runners": 1.1798172149762918e-05, "training_step": 4.316566586700268, "env_runner_sampling_timer": 4.123514735217855, "learner_update_timer": 0.1885858760069924, "synch_weights": 0.0008279093268646441, "restore_eval_env_runners": 1.2512532394627343e-05, "evaluation_iteration": 0.35852401978587983, "synch_eval_env_connectors": 0.0004791791687648767, "synch_env_connectors": 0.0004328617518026079}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.0334388114773577e-05, "un_batch_to_individual_items": 1.0697728173539798e-05, "listify_data_for_vector_env": 2.4311858570612858e-05, "get_actions": 0.00011088507489153459, "normalize_and_clip_actions": 1.9722494752803307e-05, "remove_single_ts_time_rank_from_batch": 1.27647189050994e-06}}, "connector_pipeline_timer": 0.00025083937226481906}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_to_module_connector": {"connector_pipeline_timer": 9.776553857847011e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9987409344731185e-06, "numpy_to_tensor": 2.3577295757331187e-05, "add_observations_from_episodes_to_batch": 5.9863103854707145e-06, "add_time_dim_to_batch_and_zero_pad": 9.094614076182713e-06, "batch_individual_items": 1.543352366806826e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 0.58, "agent_episode_returns_mean": {"default_agent": 0.58}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.010877535181120043, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 0.58}, "num_episodes_lifetime": -123000.0, "env_step_timer": 3.381799584572238e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "sample": 0.011652431086216416, "env_reset_timer": 9.755912065413597e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -2460000.0, "num_episodes": 250.0, "time_between_sampling": 0.0033300870047390037, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 7.41077577353892e-05, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime_throughput": 2023.3175225476634}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015245731719314788, "batch_individual_items": 0.045665634117972274, "add_observations_from_episodes_to_batch": 0.0016642897967873084, "add_one_ts_to_episodes_and_truncate": 0.019299801445046047, "add_columns_from_episodes_to_train_batch": 0.0634681749093225, "add_time_dim_to_batch_and_zero_pad": 4.845273522281299e-05, "add_states_from_episodes_to_batch": 4.737337610461947e-06, "general_advantage_estimation": 0.012850746897307828}}, "connector_pipeline_timer": 0.1433621213325964}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1221536.8162795545, "num_module_steps_trained_throughput": 231302.88521627197, "num_module_steps_trained_lifetime_throughput": 231573.95899964139}, "default_policy": {"policy_loss": -0.08983005583286285, "weights_seq_no": 6.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.001113722799345851, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 27.926227569580078, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 36000, "entropy": 0.676906406879425, "curr_kl_coeff": 0.011664004996418953, "vf_explained_var": 0.003413856029510498, "module_train_batch_size_mean": 1000.0, "total_loss": -0.02719425968825817, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.08454997837543488, "num_module_steps_trained_lifetime_throughput": 230481.54607689733}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.066844801539374e-07, "tensor_to_numpy": 3.067507473809429e-05, "normalize_and_clip_actions": 1.9006143456405528e-05, "get_actions": 9.613201193667155e-05, "listify_data_for_vector_env": 2.01209582512134e-05, "un_batch_to_individual_items": 1.0230673663292253e-05}}, "connector_pipeline_timer": 0.00022669389848476394}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.833952691557346e-06, "add_states_from_episodes_to_batch": 2.8333706051464277e-06, "add_time_dim_to_batch_and_zero_pad": 4.770366655090244e-06, "numpy_to_tensor": 2.0687960002567218e-05, "batch_individual_items": 1.3154074479149788e-05}}, "connector_pipeline_timer": 8.549536785866435e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_duration_sec_mean": 0.010137054149527102, "num_episodes_lifetime": 120, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 2.75, "env_step_timer": 3.04117989877159e-05, "env_reset_timer": 0.0013735291901391304, "agent_episode_returns_mean": {"default_agent": 2.75}, "module_episode_returns_mean": {"default_policy": 2.75}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "sample": 0.3150069632015232, "weights_seq_no": 6.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 30400, "rlmodule_inference_timer": 7.001210076068722e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5794690884398657}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-03", "timestamp": 1754933523, "time_this_iter_s": 3.783087968826294, "time_total_s": 21.8785879611969, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.8785879611969, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.38333333333333, "ram_util_percent": 81.76666666666667}}
{"timers": {"training_iteration": 4.301943695078391, "restore_env_runners": 1.1883520265214995e-05, "training_step": 4.301688749173228, "env_runner_sampling_timer": 4.109289951615835, "learner_update_timer": 0.18791265390770695, "synch_weights": 0.0008318035637744821, "restore_eval_env_runners": 1.2537827308013652e-05, "evaluation_iteration": 0.3568291258375865, "synch_eval_env_connectors": 0.0004764969577505053, "synch_env_connectors": 0.00042861021403331663}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.6575114639711304e-05, "un_batch_to_individual_items": 9.688467997977836e-06, "listify_data_for_vector_env": 2.0336958760245942e-05, "get_actions": 8.977846150883369e-05, "normalize_and_clip_actions": 1.763071210037667e-05, "remove_single_ts_time_rank_from_batch": 1.1576451664936714e-06}}, "connector_pipeline_timer": 0.0002097684091479698}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.654055309896318e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7687954119925164e-06, "numpy_to_tensor": 1.761993333907928e-05, "add_observations_from_episodes_to_batch": 5.153472379300882e-06, "add_time_dim_to_batch_and_zero_pad": 4.33792456954595e-06, "batch_individual_items": 1.2362009808055418e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 2.259999999999999, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.009055007978808134, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "num_episodes_lifetime": -153875.0, "env_step_timer": 2.898636790422527e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "sample": 0.009649631579713958, "env_reset_timer": 8.721372562678157e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -3077500.0, "num_episodes": 250.0, "time_between_sampling": 0.0033222331678438863, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.9932755581288896e-05, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime_throughput": 2259.279839305038}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015165191480579412, "batch_individual_items": 0.04554342152711814, "add_observations_from_episodes_to_batch": 0.0016577264784801043, "add_one_ts_to_episodes_and_truncate": 0.01922014176042486, "add_columns_from_episodes_to_train_batch": 0.06329136982015901, "add_time_dim_to_batch_and_zero_pad": 4.8087378743079436e-05, "add_states_from_episodes_to_batch": 4.721213599195332e-06, "general_advantage_estimation": 0.012785688178050212}}, "connector_pipeline_timer": 0.1429098571994339}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1221383.6220446273, "num_module_steps_trained_throughput": 231330.31356564598, "num_module_steps_trained_lifetime_throughput": 231588.35162210144}, "default_policy": {"policy_loss": 0.03569741174578667, "weights_seq_no": 7.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0023606023751199245, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 27.751880645751953, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 42000, "entropy": 0.66071617603302, "curr_kl_coeff": 0.0058320024982094765, "vf_explained_var": 0.003434121608734131, "module_train_batch_size_mean": 1000.0, "total_loss": 0.09848138689994812, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.049868904054164886, "num_module_steps_trained_lifetime_throughput": 230528.88028490948}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.101646818633857e-07, "tensor_to_numpy": 1.740961200619784e-05, "normalize_and_clip_actions": 1.1769590775905853e-05, "get_actions": 6.020550139173429e-05, "listify_data_for_vector_env": 1.459257319350082e-05, "un_batch_to_individual_items": 6.612326715533174e-06}}, "connector_pipeline_timer": 0.00014275012178765738}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.468423784789065e-06, "add_states_from_episodes_to_batch": 1.8980505779196729e-06, "add_time_dim_to_batch_and_zero_pad": 3.1563756575973014e-06, "numpy_to_tensor": 1.2775346790245389e-05, "batch_individual_items": 8.393564951073159e-06}}, "connector_pipeline_timer": 5.572999733294149e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_duration_sec_mean": 0.010113171709235758, "num_episodes_lifetime": 140, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 1.95, "env_step_timer": 1.9152634155818002e-05, "env_reset_timer": 0.0013607388984485161, "agent_episode_returns_mean": {"default_agent": 1.95}, "module_episode_returns_mean": {"default_policy": 1.95}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "sample": 0.31374094897955407, "weights_seq_no": 7.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 35400, "rlmodule_inference_timer": 4.065964695220335e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5724751838059707}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-06", "timestamp": 1754933526, "time_this_iter_s": 3.02903413772583, "time_total_s": 24.90762209892273, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.90762209892273, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 63.550000000000004, "ram_util_percent": 81.4}}
{"timers": {"training_iteration": 4.289956728546911, "restore_env_runners": 1.1817605139558933e-05, "training_step": 4.289702289180704, "env_runner_sampling_timer": 4.097307940849969, "learner_update_timer": 0.18789702694927954, "synch_weights": 0.0008337038690402578, "restore_eval_env_runners": 1.2520368366573522e-05, "evaluation_iteration": 0.35524365040948047, "synch_eval_env_connectors": 0.00047554489729928197, "synch_env_connectors": 0.0004244191114522071}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.554728422861485e-05, "un_batch_to_individual_items": 9.124948208835981e-06, "listify_data_for_vector_env": 2.1044521434626736e-05, "get_actions": 8.962912899957088e-05, "normalize_and_clip_actions": 1.6856772321121914e-05, "remove_single_ts_time_rank_from_batch": 1.1866265478975e-06}}, "connector_pipeline_timer": 0.00020867499909741453}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_to_module_connector": {"connector_pipeline_timer": 8.396262277620367e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8162468495215676e-06, "numpy_to_tensor": 1.917686457674892e-05, "add_observations_from_episodes_to_batch": 1.0304179667272906e-05, "add_time_dim_to_batch_and_zero_pad": 4.321103689236981e-06, "batch_individual_items": 1.2186051205048089e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 1.8600000000000003, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.009912963378243149, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "num_episodes_lifetime": -184750.0, "env_step_timer": 2.8594653353775295e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "sample": 0.010630908768192773, "env_reset_timer": 8.857196790233793e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -3695000.0, "num_episodes": 250.0, "time_between_sampling": 0.00258379867804458, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 0.0001006787387649133, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime_throughput": 2278.1876145987762}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001515299767074169, "batch_individual_items": 0.0455873552318303, "add_observations_from_episodes_to_batch": 0.001654350883485154, "add_one_ts_to_episodes_and_truncate": 0.01915889451342019, "add_columns_from_episodes_to_train_batch": 0.06348303821092893, "add_time_dim_to_batch_and_zero_pad": 4.7790665845706325e-05, "add_states_from_episodes_to_batch": 4.713590821697065e-06, "general_advantage_estimation": 0.012742262545685211}}, "connector_pipeline_timer": 0.14303654279748973}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1219669.3046299017, "num_module_steps_trained_throughput": 231068.97345195548, "num_module_steps_trained_lifetime_throughput": 231312.97447877505}, "default_policy": {"policy_loss": -0.15572355687618256, "weights_seq_no": 8.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.002607794012874365, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 27.20172691345215, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 48000, "entropy": 0.6383119821548462, "curr_kl_coeff": 0.0029160012491047382, "vf_explained_var": 0.002962470054626465, "module_train_batch_size_mean": 1000.0, "total_loss": -0.0927489772439003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.022608157247304916, "num_module_steps_trained_lifetime_throughput": 230290.75842392514}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.127589526728893e-07, "tensor_to_numpy": 1.8939900846927473e-05, "normalize_and_clip_actions": 1.2271355649545494e-05, "get_actions": 5.757518760437638e-05, "listify_data_for_vector_env": 1.4317572644540946e-05, "un_batch_to_individual_items": 7.470972039432792e-06}}, "connector_pipeline_timer": 0.00014355351307779768}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.536688592261879e-06, "add_states_from_episodes_to_batch": 1.911505968915327e-06, "add_time_dim_to_batch_and_zero_pad": 2.9600202880964833e-06, "numpy_to_tensor": 1.3859736999288072e-05, "batch_individual_items": 9.235448554923152e-06}}, "connector_pipeline_timer": 5.889387660500173e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_duration_sec_mean": 0.009708405460696668, "num_episodes_lifetime": 160, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 2.75, "env_step_timer": 2.1352978891230774e-05, "env_reset_timer": 0.001348637349800935, "agent_episode_returns_mean": {"default_agent": 2.75}, "module_episode_returns_mean": {"default_policy": 2.75}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "sample": 0.3120097119897505, "weights_seq_no": 8.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 40400, "rlmodule_inference_timer": 4.1283975556925747e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5679836907182003}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-09", "timestamp": 1754933529, "time_this_iter_s": 3.2488811016082764, "time_total_s": 28.156503200531006, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.156503200531006, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 67.58, "ram_util_percent": 81.56}}
{"timers": {"training_iteration": 4.278259173341908, "restore_env_runners": 1.1778589178699221e-05, "training_step": 4.278004770449219, "env_runner_sampling_timer": 4.083873451020523, "learner_update_timer": 0.18962828918014615, "synch_weights": 0.0008376993305412606, "restore_eval_env_runners": 1.255766533818635e-05, "evaluation_iteration": 0.3531592739045554, "synch_eval_env_connectors": 0.000471974448036238, "synch_env_connectors": 0.0004202157495193562}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.6272800409217775e-05, "un_batch_to_individual_items": 9.057883477903175e-06, "listify_data_for_vector_env": 2.119630745541447e-05, "get_actions": 8.817381195916673e-05, "normalize_and_clip_actions": 1.7175151664118412e-05, "remove_single_ts_time_rank_from_batch": 1.0608440234421914e-06}}, "connector_pipeline_timer": 0.0002070268069612387}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.836704934367574e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5775633570034377e-06, "numpy_to_tensor": 1.8488539025969157e-05, "add_observations_from_episodes_to_batch": 5.201314825524934e-06, "add_time_dim_to_batch_and_zero_pad": 4.195451916734559e-06, "batch_individual_items": 1.2364293700468279e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 3.4599999999999995, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.009149782639928163, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "num_episodes_lifetime": -215625.0, "env_step_timer": 2.9717018513278974e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "sample": 0.009828342315374708, "env_reset_timer": 8.812722043177397e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -4312500.0, "num_episodes": 250.0, "time_between_sampling": 0.0025435318295083803, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 6.123960454695498e-05, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime_throughput": 2223.5003671003415}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015125717650604838, "batch_individual_items": 0.0458114745988341, "add_observations_from_episodes_to_batch": 0.0016503723748658476, "add_one_ts_to_episodes_and_truncate": 0.020791078068787935, "add_columns_from_episodes_to_train_batch": 0.06352006490970764, "add_time_dim_to_batch_and_zero_pad": 4.773275889287683e-05, "add_states_from_episodes_to_batch": 5.3943649962673685e-06, "general_advantage_estimation": 0.012698408669479204}}, "connector_pipeline_timer": 0.1448830831990674}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1215495.9317598245, "num_module_steps_trained_throughput": 230291.66353306768, "num_module_steps_trained_lifetime_throughput": 230563.22592828883}, "default_policy": {"policy_loss": -0.11399688571691513, "weights_seq_no": 9.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.002018766012042761, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.992969512939453, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 54000, "entropy": 0.6128119826316833, "curr_kl_coeff": 0.0014580006245523691, "vf_explained_var": 0.002911388874053955, "module_train_batch_size_mean": 1000.0, "total_loss": -0.050800688564777374, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.027868833392858505, "num_module_steps_trained_lifetime_throughput": 229529.2251919494}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0140886049736916e-06, "tensor_to_numpy": 2.2449597795446995e-05, "normalize_and_clip_actions": 1.4792783534206995e-05, "get_actions": 7.521201453100858e-05, "listify_data_for_vector_env": 1.870777190124288e-05, "un_batch_to_individual_items": 1.0878058254759665e-05}}, "connector_pipeline_timer": 0.0001800031144521623}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.115073198165725e-06, "add_states_from_episodes_to_batch": 2.274247338261848e-06, "add_time_dim_to_batch_and_zero_pad": 3.849126410948381e-06, "numpy_to_tensor": 1.4677770008616119e-05, "batch_individual_items": 1.0820628387283141e-05}}, "connector_pipeline_timer": 6.822453073691523e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.009134215462254361, "num_episodes_lifetime": 180, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 2.35, "env_step_timer": 2.4034655329557757e-05, "env_reset_timer": 0.0013360668156397382, "agent_episode_returns_mean": {"default_agent": 2.35}, "module_episode_returns_mean": {"default_policy": 2.35}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "sample": 0.3108752886194396, "weights_seq_no": 9.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 45400, "rlmodule_inference_timer": 4.755932782682877e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5637340721413695}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-12", "timestamp": 1754933532, "time_this_iter_s": 3.3280892372131348, "time_total_s": 31.48459243774414, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.48459243774414, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 66.8, "ram_util_percent": 80.96}}
{"timers": {"training_iteration": 4.268226142437741, "restore_env_runners": 1.173371303881922e-05, "training_step": 4.267972282745006, "env_runner_sampling_timer": 4.0722075102593385, "learner_update_timer": 0.1912741700387343, "synch_weights": 0.0008353548371862272, "restore_eval_env_runners": 1.250583779118185e-05, "evaluation_iteration": 0.35170832824594805, "synch_eval_env_connectors": 0.0004713084526999529, "synch_env_connectors": 0.000416069841579363}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.8107021615440334e-05, "un_batch_to_individual_items": 1.0340322670521047e-05, "listify_data_for_vector_env": 2.1933590680413464e-05, "get_actions": 9.93642354670514e-05, "normalize_and_clip_actions": 1.7175209756863257e-05, "remove_single_ts_time_rank_from_batch": 1.0072741380710287e-06}}, "connector_pipeline_timer": 0.00022417264584821868}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_to_module_connector": {"connector_pipeline_timer": 8.084450789937378e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.700075996340538e-06, "numpy_to_tensor": 1.835267992332252e-05, "add_observations_from_episodes_to_batch": 5.345168332640335e-06, "add_time_dim_to_batch_and_zero_pad": 4.464159186127844e-06, "batch_individual_items": 1.3505076904703937e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 3.4599999999999995, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.009822949147783224, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "num_episodes_lifetime": -246500.0, "env_step_timer": 2.910732278966352e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "sample": 0.010201156184556812, "env_reset_timer": 9.627835243767432e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -4930000.0, "num_episodes": 250.0, "time_between_sampling": 0.0035341907345520147, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 7.218286379821816e-05, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime_throughput": 2190.3447467872084}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001507425250287609, "batch_individual_items": 0.04805092610225358, "add_observations_from_episodes_to_batch": 0.0016435249015940264, "add_one_ts_to_episodes_and_truncate": 0.02071622936764889, "add_columns_from_episodes_to_train_batch": 0.06328592467068733, "add_time_dim_to_batch_and_zero_pad": 4.7382511433407554e-05, "add_states_from_episodes_to_batch": 5.373751052943746e-06, "general_advantage_estimation": 0.012667395422977743}}, "connector_pipeline_timer": 0.1467743077775941}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1218122.0693533828, "num_module_steps_trained_throughput": 230821.13624270543, "num_module_steps_trained_lifetime_throughput": 231107.54369929642}, "default_policy": {"policy_loss": -0.2596895098686218, "weights_seq_no": 10.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0023036045022308826, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.41408920288086, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 60000, "entropy": 0.581646203994751, "curr_kl_coeff": 0.0007290003122761846, "vf_explained_var": 0.002871870994567871, "module_train_batch_size_mean": 1000.0, "total_loss": -0.19621355831623077, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.09449653327465057, "num_module_steps_trained_lifetime_throughput": 230073.2795197056}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.468550188175542e-07, "tensor_to_numpy": 3.0160786734419672e-05, "normalize_and_clip_actions": 1.4706837802206914e-05, "get_actions": 7.60732128104387e-05, "listify_data_for_vector_env": 2.350600756953046e-05, "un_batch_to_individual_items": 9.144481524161006e-06}}, "connector_pipeline_timer": 0.0001999561550738606}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.250391140018462e-06, "add_states_from_episodes_to_batch": 2.143101099231212e-06, "add_time_dim_to_batch_and_zero_pad": 5.2000772322146915e-06, "numpy_to_tensor": 1.699531226403208e-05, "batch_individual_items": 1.019361324364555e-05}}, "connector_pipeline_timer": 0.00010089911882153669}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.008280517510138452, "num_episodes_lifetime": 200, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 2.15, "env_step_timer": 2.8819117540918503e-05, "env_reset_timer": 0.0013255669876605042, "agent_episode_returns_mean": {"default_agent": 2.15}, "module_episode_returns_mean": {"default_policy": 2.15}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "sample": 0.3098197886528223, "weights_seq_no": 10.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 50400, "rlmodule_inference_timer": 5.396404768974961e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.561235311419751}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-16", "timestamp": 1754933536, "time_this_iter_s": 3.495055675506592, "time_total_s": 34.97964811325073, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.97964811325073, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 62.15, "ram_util_percent": 81.275}}
{"timers": {"training_iteration": 4.256823365183154, "restore_env_runners": 1.1693045875233028e-05, "training_step": 4.256569763668353, "env_runner_sampling_timer": 4.061186767656717, "learner_update_timer": 0.19088542125817567, "synch_weights": 0.0008390625389776071, "restore_eval_env_runners": 1.2454109424488818e-05, "evaluation_iteration": 0.35039324496446833, "synch_eval_env_connectors": 0.0004680337085779556, "synch_env_connectors": 0.0004119583135030494}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.8518425281504854e-05, "un_batch_to_individual_items": 1.1457046081322884e-05, "listify_data_for_vector_env": 2.2958577611369653e-05, "get_actions": 9.739139210748373e-05, "normalize_and_clip_actions": 1.8132673392240903e-05, "remove_single_ts_time_rank_from_batch": 1.131773109803314e-06}}, "connector_pipeline_timer": 0.00022892931252897563}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_to_module_connector": {"connector_pipeline_timer": 8.753241815706655e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1278082683699313e-06, "numpy_to_tensor": 2.0667632193435294e-05, "add_observations_from_episodes_to_batch": 6.209593863368607e-06, "add_time_dim_to_batch_and_zero_pad": 5.388140336678992e-06, "batch_individual_items": 1.406472454511235e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 4.82, "agent_episode_returns_mean": {"default_agent": 4.82}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.010007530338596552, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 4.82}, "num_episodes_lifetime": -277375.0, "env_step_timer": 3.1484471628717246e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "sample": 0.010392833137401825, "env_reset_timer": 9.304109608986346e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -5547500.0, "num_episodes": 250.0, "time_between_sampling": 0.0037355849431045295, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 7.170211011693007e-05, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime_throughput": 2088.226533949647}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001509092708499729, "batch_individual_items": 0.048197907251346615, "add_observations_from_episodes_to_batch": 0.001635925902631805, "add_one_ts_to_episodes_and_truncate": 0.020604774154299375, "add_columns_from_episodes_to_train_batch": 0.06307825833445983, "add_time_dim_to_batch_and_zero_pad": 4.745076611608807e-05, "add_states_from_episodes_to_batch": 5.379603053197862e-06, "general_advantage_estimation": 0.012638885218537784}}, "connector_pipeline_timer": 0.1465673926099732}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1219023.6970382843, "num_module_steps_trained_throughput": 231033.94254991578, "num_module_steps_trained_lifetime_throughput": 231323.32405397337}, "default_policy": {"policy_loss": -0.054561760276556015, "weights_seq_no": 11.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.001672356273047626, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.720659255981445, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 66000, "entropy": 0.5473174452781677, "curr_kl_coeff": 0.0003645001561380923, "vf_explained_var": 0.0033788084983825684, "module_train_batch_size_mean": 1000.0, "total_loss": 0.00922297965735197, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.13445432484149933, "num_module_steps_trained_lifetime_throughput": 230307.29432291305}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.608903908169055e-07, "tensor_to_numpy": 2.3178960194719888e-05, "normalize_and_clip_actions": 1.4399121290781872e-05, "get_actions": 7.058053167314608e-05, "listify_data_for_vector_env": 1.7304869549660096e-05, "un_batch_to_individual_items": 8.099101553119285e-06}}, "connector_pipeline_timer": 0.0001734176697277045}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.445247223709948e-06, "add_states_from_episodes_to_batch": 2.714066162504949e-06, "add_time_dim_to_batch_and_zero_pad": 4.479078796346092e-06, "numpy_to_tensor": 1.4923246679393798e-05, "batch_individual_items": 9.599216489873141e-06}}, "connector_pipeline_timer": 6.79149937339856e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.008530049142427743, "num_episodes_lifetime": 220, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 1.75, "env_step_timer": 2.778251932669251e-05, "env_reset_timer": 0.0013144192278973083, "agent_episode_returns_mean": {"default_agent": 1.75}, "module_episode_returns_mean": {"default_policy": 1.75}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "sample": 0.3086810428459031, "weights_seq_no": 11.0, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 55400, "rlmodule_inference_timer": 5.742039501006677e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5576635520553967}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-19", "timestamp": 1754933539, "time_this_iter_s": 3.336472988128662, "time_total_s": 38.316121101379395, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.316121101379395, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 80.88, "ram_util_percent": 81.02}}
{"timers": {"training_iteration": 4.248525165701799, "restore_env_runners": 1.1657785421355165e-05, "training_step": 4.248268493531981, "env_runner_sampling_timer": 4.053572555810263, "learner_update_timer": 0.19019476579529634, "synch_weights": 0.0008404864935589657, "restore_eval_env_runners": 1.2526648992717967e-05, "evaluation_iteration": 0.34893680626482027, "synch_eval_env_connectors": 0.00046631670139036954, "synch_env_connectors": 0.00040788248041011467}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.887333484918522e-05, "un_batch_to_individual_items": 1.0130620718836278e-05, "listify_data_for_vector_env": 2.254831628987585e-05, "get_actions": 0.0001079391623554277, "normalize_and_clip_actions": 1.8976147462109736e-05, "remove_single_ts_time_rank_from_batch": 1.1010139334158122e-06}}, "connector_pipeline_timer": 0.00023954682473119175}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_to_module_connector": {"connector_pipeline_timer": 8.806769696589383e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9655642548594e-06, "numpy_to_tensor": 2.127259541493722e-05, "add_observations_from_episodes_to_batch": 5.950094552808208e-06, "add_time_dim_to_batch_and_zero_pad": 4.935263479041533e-06, "batch_individual_items": 1.401529924904838e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.299999999999998, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.010251168821472671, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "num_episodes_lifetime": -308250.0, "env_step_timer": 3.2338445855084475e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "sample": 0.01134452066685403, "env_reset_timer": 0.00010521063087781485, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -6165000.0, "num_episodes": 250.0, "time_between_sampling": 0.0036855959052310605, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 6.928446496152749e-05, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime_throughput": 2015.5565525948823}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00015011350836935484, "batch_individual_items": 0.048079341928561496, "add_observations_from_episodes_to_batch": 0.001632580393454538, "add_one_ts_to_episodes_and_truncate": 0.020535374741964055, "add_columns_from_episodes_to_train_batch": 0.06288866783114917, "add_time_dim_to_batch_and_zero_pad": 4.7096678463824975e-05, "add_states_from_episodes_to_batch": 5.35955698861673e-06, "general_advantage_estimation": 0.012575687195594055}}, "connector_pipeline_timer": 0.1461214007741373}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1224000.7511367458, "num_module_steps_trained_throughput": 232026.65796580142, "num_module_steps_trained_lifetime_throughput": 232313.58493160782}, "default_policy": {"policy_loss": -0.14379438757896423, "weights_seq_no": 12.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.00010483573714736849, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.306880950927734, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 72000, "entropy": 0.5396393537521362, "curr_kl_coeff": 0.00018225007806904614, "vf_explained_var": 0.0036283135414123535, "module_train_batch_size_mean": 1000.0, "total_loss": -0.0799412950873375, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.016193924471735954, "num_module_steps_trained_lifetime_throughput": 231315.97254345412}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.875022785935944e-07, "tensor_to_numpy": 2.767152369393896e-05, "normalize_and_clip_actions": 1.679517367616435e-05, "get_actions": 8.624517908250173e-05, "listify_data_for_vector_env": 2.2032049709031506e-05, "un_batch_to_individual_items": 9.871794067987177e-06}}, "connector_pipeline_timer": 0.00020898702501162693}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.513887116878194e-06, "add_states_from_episodes_to_batch": 2.8645352839124875e-06, "add_time_dim_to_batch_and_zero_pad": 4.94524409032874e-06, "numpy_to_tensor": 1.8140755513267903e-05, "batch_individual_items": 1.2004744585089234e-05}}, "connector_pipeline_timer": 7.76736653646066e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.008902404133696109, "num_episodes_lifetime": 240, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 1.35, "env_step_timer": 3.1967468494094885e-05, "env_reset_timer": 0.0013021866956450941, "agent_episode_returns_mean": {"default_agent": 1.35}, "module_episode_returns_mean": {"default_policy": 1.35}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "sample": 0.307871820757665, "weights_seq_no": 12.0, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 60400, "rlmodule_inference_timer": 5.415287250846503e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.556660134034844}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-23", "timestamp": 1754933543, "time_this_iter_s": 3.6666061878204346, "time_total_s": 41.98272728919983, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.98272728919983, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 84.25999999999999, "ram_util_percent": 80.78}}
{"timers": {"training_iteration": 4.23780402279412, "restore_env_runners": 1.16091277583551e-05, "training_step": 4.237547821516305, "env_runner_sampling_timer": 4.04309307900293, "learner_update_timer": 0.1899520068863792, "synch_weights": 0.0008455053781019099, "restore_eval_env_runners": 1.2485542631399132e-05, "evaluation_iteration": 0.3478147040319885, "synch_eval_env_connectors": 0.0004662547847790952, "synch_env_connectors": 0.00040384240561003684}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.882543486335171e-05, "un_batch_to_individual_items": 9.961559250779373e-06, "listify_data_for_vector_env": 2.2240499939119444e-05, "get_actions": 9.297038704220029e-05, "normalize_and_clip_actions": 1.8438992257708475e-05, "remove_single_ts_time_rank_from_batch": 1.1430165759798316e-06}}, "connector_pipeline_timer": 0.00022202249334607007}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_to_module_connector": {"connector_pipeline_timer": 8.252188361749127e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.003133379365039e-06, "numpy_to_tensor": 1.9346310100441423e-05, "add_observations_from_episodes_to_batch": 5.302649366665197e-06, "add_time_dim_to_batch_and_zero_pad": 4.247263961339214e-06, "batch_individual_items": 1.3163770373063778e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.700000000000004, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00943655633740127, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "num_episodes_lifetime": -339125.0, "env_step_timer": 3.079501946503906e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "sample": 0.010320845357584821, "env_reset_timer": 9.017500547993768e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -6782500.0, "num_episodes": 250.0, "time_between_sampling": 0.003295831246438499, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.982444141879111e-05, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime_throughput": 2081.264175346664}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001493823733280551, "batch_individual_items": 0.04821457642000389, "add_observations_from_episodes_to_batch": 0.001625309588620037, "add_one_ts_to_episodes_and_truncate": 0.020422884334940848, "add_columns_from_episodes_to_train_batch": 0.06279588907318073, "add_time_dim_to_batch_and_zero_pad": 4.692238215702405e-05, "add_states_from_episodes_to_batch": 5.3805510437315165e-06, "general_advantage_estimation": 0.01254153032379793}}, "connector_pipeline_timer": 0.1460089013469225}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1223770.8185132123, "num_module_steps_trained_throughput": 232030.082516802, "num_module_steps_trained_lifetime_throughput": 232310.74704340388}, "default_policy": {"policy_loss": -0.10556618124246597, "weights_seq_no": 13.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 4.6311222831718624e-05, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.30040740966797, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 78000, "entropy": 0.5378057956695557, "curr_kl_coeff": 9.112503903452307e-05, "vf_explained_var": 0.004175662994384766, "module_train_batch_size_mean": 1000.0, "total_loss": -0.04169650375843048, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.05791241675615311, "num_module_steps_trained_lifetime_throughput": 231338.36568349952}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.966058721247163e-07, "tensor_to_numpy": 1.900623820392331e-05, "normalize_and_clip_actions": 1.2445327365406462e-05, "get_actions": 6.016500178042737e-05, "listify_data_for_vector_env": 1.547727729829065e-05, "un_batch_to_individual_items": 6.841647226001593e-06}}, "connector_pipeline_timer": 0.00014796759989259422}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.556549218562303e-06, "add_states_from_episodes_to_batch": 1.9000445037561078e-06, "add_time_dim_to_batch_and_zero_pad": 3.7724853270199837e-06, "numpy_to_tensor": 1.2549710537575183e-05, "batch_individual_items": 8.572853477939837e-06}}, "connector_pipeline_timer": 5.7197058075545933e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.008990716257831082, "num_episodes_lifetime": 260, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 1.15, "env_step_timer": 1.9303662252518054e-05, "env_reset_timer": 0.0012903864887475888, "agent_episode_returns_mean": {"default_agent": 1.15}, "module_episode_returns_mean": {"default_policy": 1.15}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "sample": 0.306298093800201, "weights_seq_no": 13.0, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 65400, "rlmodule_inference_timer": 3.863028465087587e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.553208707694422}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-26", "timestamp": 1754933546, "time_this_iter_s": 3.335224151611328, "time_total_s": 45.31795144081116, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.31795144081116, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 82.02000000000001, "ram_util_percent": 80.78}}
{"timers": {"training_iteration": 4.224029593817052, "restore_env_runners": 1.1557205770315774e-05, "training_step": 4.2237737012112255, "env_runner_sampling_timer": 4.028025704883391, "learner_update_timer": 0.19125474973761006, "synch_weights": 0.0008444065735825383, "restore_eval_env_runners": 1.2463607662805898e-05, "evaluation_iteration": 0.34590476907241546, "synch_eval_env_connectors": 0.00046328432664913944, "synch_env_connectors": 0.00039984981077368005}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.4969151195890854e-05, "un_batch_to_individual_items": 8.905611463997359e-06, "listify_data_for_vector_env": 2.030258758016972e-05, "get_actions": 8.28375901591808e-05, "normalize_and_clip_actions": 1.5434430918277808e-05, "remove_single_ts_time_rank_from_batch": 9.755792280714788e-07}}, "connector_pipeline_timer": 0.0001948786430965872}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.528540502967065e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.716659844397365e-06, "numpy_to_tensor": 1.7928579880443947e-05, "add_observations_from_episodes_to_batch": 4.8702930470807795e-06, "add_time_dim_to_batch_and_zero_pad": 4.0422447315290896e-06, "batch_individual_items": 1.2517600769284317e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.380000000000001, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008462221357040108, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "num_episodes_lifetime": -370000.0, "env_step_timer": 2.6142095821466865e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "sample": 0.009134511535927725, "env_reset_timer": 8.295175727339849e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -7400000.0, "num_episodes": 250.0, "time_between_sampling": 0.00294317314896655, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.6348234151320115e-05, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime_throughput": 2312.476290501069}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014865395938102872, "batch_individual_items": 0.04991969815577971, "add_observations_from_episodes_to_batch": 0.0016193589926018124, "add_one_ts_to_episodes_and_truncate": 0.02030358258180228, "add_columns_from_episodes_to_train_batch": 0.06280264477213598, "add_time_dim_to_batch_and_zero_pad": 4.668065948567444e-05, "add_states_from_episodes_to_batch": 5.3946657245076895e-06, "general_advantage_estimation": 0.012484096681391669}}, "connector_pipeline_timer": 0.14753671692284365}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1226510.780865045, "num_module_steps_trained_throughput": 232600.86906364927, "num_module_steps_trained_lifetime_throughput": 232872.36753104255}, "default_policy": {"policy_loss": 0.07163506746292114, "weights_seq_no": 14.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.00028114247834309936, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 27.039745330810547, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 84000, "entropy": 0.5194522738456726, "curr_kl_coeff": 4.5562519517261535e-05, "vf_explained_var": 0.005130410194396973, "module_train_batch_size_mean": 1000.0, "total_loss": 0.1356709897518158, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.035145506262779236, "num_module_steps_trained_lifetime_throughput": 231930.7957540757}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.019338522104365e-07, "tensor_to_numpy": 1.8519145759251962e-05, "normalize_and_clip_actions": 1.3343144178047057e-05, "get_actions": 6.328299525040777e-05, "listify_data_for_vector_env": 1.386186363551784e-05, "un_batch_to_individual_items": 6.805728855367888e-06}}, "connector_pipeline_timer": 0.000148741591553849}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0185666737148285e-06, "add_states_from_episodes_to_batch": 1.935583142355566e-06, "add_time_dim_to_batch_and_zero_pad": 3.0818498124865316e-06, "numpy_to_tensor": 1.2407364551947635e-05, "batch_individual_items": 9.163328053530166e-06}}, "connector_pipeline_timer": 5.8922464050637004e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.008445305022178218, "num_episodes_lifetime": 280, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 0.95, "env_step_timer": 2.3089801464360138e-05, "env_reset_timer": 0.0012781988737842658, "agent_episode_returns_mean": {"default_agent": 0.95}, "module_episode_returns_mean": {"default_policy": 0.95}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "sample": 0.3046273991121011, "weights_seq_no": 14.0, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 70400, "rlmodule_inference_timer": 4.271387481302442e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5465055526981284}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-29", "timestamp": 1754933549, "time_this_iter_s": 3.00860595703125, "time_total_s": 48.32655739784241, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.32655739784241, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 77.55000000000001, "ram_util_percent": 80.55}}
{"timers": {"training_iteration": 4.209373552048951, "restore_env_runners": 1.1762043602876889e-05, "training_step": 4.209115718790102, "env_runner_sampling_timer": 4.011962211994058, "learner_update_timer": 0.19266376849017636, "synch_weights": 0.0008457383378138243, "restore_eval_env_runners": 1.2411882502238048e-05, "evaluation_iteration": 0.3439103372207592, "synch_eval_env_connectors": 0.0004598619035422711, "synch_env_connectors": 0.0003959346427533069}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3461633649906367e-05, "un_batch_to_individual_items": 8.620364686138027e-06, "listify_data_for_vector_env": 1.8459366342602227e-05, "get_actions": 7.717148742919916e-05, "normalize_and_clip_actions": 1.5410945309297535e-05, "remove_single_ts_time_rank_from_batch": 9.368760579754759e-07}}, "connector_pipeline_timer": 0.0001839943363069951}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.216224467330748e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.582364249639527e-06, "numpy_to_tensor": 1.642263075837506e-05, "add_observations_from_episodes_to_batch": 5.1031716910763766e-06, "add_time_dim_to_batch_and_zero_pad": 3.900699086927955e-06, "batch_individual_items": 1.1443644556320586e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.460000000000001, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008022984495386482, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "num_episodes_lifetime": -400875.0, "env_step_timer": 2.5548698077499428e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "sample": 0.008910663813002838, "env_reset_timer": 8.094316470510563e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -8017500.0, "num_episodes": 250.0, "time_between_sampling": 0.003047329546914805, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.1516906048332904e-05, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime_throughput": 2373.3393163552137}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014940200956138, "batch_individual_items": 0.05149880950460506, "add_observations_from_episodes_to_batch": 0.001612421233339982, "add_one_ts_to_episodes_and_truncate": 0.020179662595892156, "add_columns_from_episodes_to_train_batch": 0.06293204540494902, "add_time_dim_to_batch_and_zero_pad": 4.6421352724595234e-05, "add_states_from_episodes_to_batch": 5.4040583155622115e-06, "general_advantage_estimation": 0.012458039054650013}}, "connector_pipeline_timer": 0.1490885480845801}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1224853.161107398, "num_module_steps_trained_throughput": 232335.12675713896, "num_module_steps_trained_lifetime_throughput": 232594.27348625692}, "default_policy": {"policy_loss": -0.10267102718353271, "weights_seq_no": 15.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0002160034200642258, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.506343841552734, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 90000, "entropy": 0.512681782245636, "curr_kl_coeff": 2.2781259758630767e-05, "vf_explained_var": 0.005217373371124268, "module_train_batch_size_mean": 1000.0, "total_loss": -0.03857382386922836, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0580829381942749, "num_module_steps_trained_lifetime_throughput": 231690.848895949}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0825259326494401e-06, "tensor_to_numpy": 2.791489224652084e-05, "normalize_and_clip_actions": 1.6615469572948765e-05, "get_actions": 9.17230441284171e-05, "listify_data_for_vector_env": 2.3883335558047076e-05, "un_batch_to_individual_items": 9.393504343905043e-06}}, "connector_pipeline_timer": 0.00021894524039327363}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.221060475511921e-06, "add_states_from_episodes_to_batch": 2.5959927797286008e-06, "add_time_dim_to_batch_and_zero_pad": 4.3263453446930345e-06, "numpy_to_tensor": 1.9013214080762343e-05, "batch_individual_items": 1.2930135500656014e-05}}, "connector_pipeline_timer": 7.987451813620579e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.008343491270206869, "num_episodes_lifetime": 300, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 1.95, "env_step_timer": 3.0461748538575635e-05, "env_reset_timer": 0.0012661564657652235, "agent_episode_returns_mean": {"default_agent": 1.95}, "module_episode_returns_mean": {"default_policy": 1.95}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "sample": 0.30354429637093416, "weights_seq_no": 15.0, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 75400, "rlmodule_inference_timer": 6.708697563527403e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5389512842606416}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-32", "timestamp": 1754933552, "time_this_iter_s": 2.9668030738830566, "time_total_s": 51.293360471725464, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.293360471725464, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 77.15, "ram_util_percent": 80.875}}
{"timers": {"training_iteration": 4.192950357359513, "restore_env_runners": 1.181275273729056e-05, "training_step": 4.192690835353031, "env_runner_sampling_timer": 3.9961779944643556, "learner_update_timer": 0.19200821414509056, "synch_weights": 0.0008516063743422128, "restore_eval_env_runners": 1.2364013384705872e-05, "evaluation_iteration": 0.34253667301807955, "synch_eval_env_connectors": 0.00045691662422066027, "synch_env_connectors": 0.00039201945731395565}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3678684800448555e-05, "un_batch_to_individual_items": 8.880070758912194e-06, "listify_data_for_vector_env": 1.9010173644416113e-05, "get_actions": 7.814706540344374e-05, "normalize_and_clip_actions": 1.527429493940122e-05, "remove_single_ts_time_rank_from_batch": 9.570727833394393e-07}}, "connector_pipeline_timer": 0.00018658014238285498}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.150318399834638e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.523462070427045e-06, "numpy_to_tensor": 1.6335458200666498e-05, "add_observations_from_episodes_to_batch": 4.6967953868797315e-06, "add_time_dim_to_batch_and_zero_pad": 3.991890203625231e-06, "batch_individual_items": 1.1451048532418628e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.619999999999999, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00810056065442041, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "num_episodes_lifetime": -431750.0, "env_step_timer": 2.5972755204006273e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "sample": 0.008748812799708041, "env_reset_timer": 8.400122200409227e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -8635000.0, "num_episodes": 250.0, "time_between_sampling": 0.0033166762493014143, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.298613351615793e-05, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime_throughput": 2364.0435260666186}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014866215003947223, "batch_individual_items": 0.05142864223899333, "add_observations_from_episodes_to_batch": 0.0016073766012968253, "add_one_ts_to_episodes_and_truncate": 0.020065775969935248, "add_columns_from_episodes_to_train_batch": 0.06271788329137412, "add_time_dim_to_batch_and_zero_pad": 4.607588864637884e-05, "add_states_from_episodes_to_batch": 5.3862682994702785e-06, "general_advantage_estimation": 0.01240185033387794}}, "connector_pipeline_timer": 0.14862722427330005}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1226719.5506008314, "num_module_steps_trained_throughput": 232739.12713373677, "num_module_steps_trained_lifetime_throughput": 232985.39133094583}, "default_policy": {"policy_loss": -0.2068527191877365, "weights_seq_no": 16.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.00046676889178343117, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.065872192382812, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 96000, "entropy": 0.49951738119125366, "curr_kl_coeff": 1.1390629879315384e-05, "vf_explained_var": 0.004887521266937256, "module_train_batch_size_mean": 1000.0, "total_loss": -0.1426362693309784, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03795118257403374, "num_module_steps_trained_lifetime_throughput": 232119.2738436109}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1430745620661069e-06, "tensor_to_numpy": 2.9640386873331708e-05, "normalize_and_clip_actions": 1.8446509069500725e-05, "get_actions": 0.00010019694142754195, "listify_data_for_vector_env": 2.2533769529644446e-05, "un_batch_to_individual_items": 1.4701393374891204e-05}}, "connector_pipeline_timer": 0.00023211335310563907}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.749499094164503e-06, "add_states_from_episodes_to_batch": 3.7881569355180256e-06, "add_time_dim_to_batch_and_zero_pad": 5.235917845992772e-06, "numpy_to_tensor": 2.4990050646401152e-05, "batch_individual_items": 1.5103899149930673e-05}}, "connector_pipeline_timer": 9.272971875925003e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.00888036418822594, "num_episodes_lifetime": 320, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 1.55, "env_step_timer": 3.3691594729722704e-05, "env_reset_timer": 0.0012550015703215666, "agent_episode_returns_mean": {"default_agent": 1.55}, "module_episode_returns_mean": {"default_policy": 1.55}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "sample": 0.3030465900670944, "weights_seq_no": 16.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 80400, "rlmodule_inference_timer": 7.584740676325945e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5295815568385387}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-35", "timestamp": 1754933555, "time_this_iter_s": 2.8372960090637207, "time_total_s": 54.130656480789185, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.130656480789185, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 77.225, "ram_util_percent": 80.625}}
{"timers": {"training_iteration": 4.180691797955547, "restore_env_runners": 1.1753785148163664e-05, "training_step": 4.180432583249497, "env_runner_sampling_timer": 3.984000464099712, "learner_update_timer": 0.19191957492343228, "synch_weights": 0.0008512586405492127, "restore_eval_env_runners": 1.2327453075738579e-05, "evaluation_iteration": 0.34175222712693837, "synch_eval_env_connectors": 0.0004556562072704995, "synch_env_connectors": 0.00038814134222304363}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.4441235190048723e-05, "un_batch_to_individual_items": 9.319536527351413e-06, "listify_data_for_vector_env": 2.0362328607990434e-05, "get_actions": 8.513750382409674e-05, "normalize_and_clip_actions": 1.6771827863846366e-05, "remove_single_ts_time_rank_from_batch": 9.920408716638025e-07}}, "connector_pipeline_timer": 0.000200517309913648}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.74020685684671e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.670042732654634e-06, "numpy_to_tensor": 1.7983930282821554e-05, "add_observations_from_episodes_to_batch": 5.227943175840131e-06, "add_time_dim_to_batch_and_zero_pad": 4.14508299829249e-06, "batch_individual_items": 1.2278070678679343e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 7.139999999999999, "agent_episode_returns_mean": {"default_agent": 7.139999999999999}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.009160062308888882, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 7.139999999999999}, "num_episodes_lifetime": -462625.0, "env_step_timer": 2.8339363735706408e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "sample": 0.009119597541948707, "env_reset_timer": 8.031385476697773e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -9252500.0, "num_episodes": 250.0, "time_between_sampling": 0.0028100671848744554, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 7.965698834367417e-05, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime_throughput": 2330.2650136785346}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014865885764519976, "batch_individual_items": 0.05152249622606182, "add_observations_from_episodes_to_batch": 0.001611735745234471, "add_one_ts_to_episodes_and_truncate": 0.02014060487019299, "add_columns_from_episodes_to_train_batch": 0.06271163820863904, "add_time_dim_to_batch_and_zero_pad": 4.57776292510404e-05, "add_states_from_episodes_to_batch": 5.369485060630673e-06, "general_advantage_estimation": 0.012356183081388826}}, "connector_pipeline_timer": 0.1487487853606209}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1230413.3551558491, "num_module_steps_trained_throughput": 233491.34216429695, "num_module_steps_trained_lifetime_throughput": 233723.37495757133}, "default_policy": {"policy_loss": -0.1093665286898613, "weights_seq_no": 17.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0006145501974970102, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 25.952669143676758, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 102000, "entropy": 0.4784937798976898, "curr_kl_coeff": 5.695314939657692e-06, "vf_explained_var": 0.004864335060119629, "module_train_batch_size_mean": 1000.0, "total_loss": -0.044959671795368195, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.10882989317178726, "num_module_steps_trained_lifetime_throughput": 232888.54942426845}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.810516177527521e-07, "tensor_to_numpy": 2.3349263406534685e-05, "normalize_and_clip_actions": 1.3349701458814091e-05, "get_actions": 6.248498187366308e-05, "listify_data_for_vector_env": 1.586067720715159e-05, "un_batch_to_individual_items": 7.388216063240716e-06}}, "connector_pipeline_timer": 0.00015919072966453796}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.031370792190553e-06, "add_states_from_episodes_to_batch": 2.135730857658698e-06, "add_time_dim_to_batch_and_zero_pad": 3.164418805060403e-06, "numpy_to_tensor": 1.3688587700664833e-05, "batch_individual_items": 9.379998579393055e-06}}, "connector_pipeline_timer": 6.0211828511324397e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.008305335011100397, "num_episodes_lifetime": 340, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 1.75, "env_step_timer": 2.134402370619314e-05, "env_reset_timer": 0.0012432823956362378, "agent_episode_returns_mean": {"default_agent": 1.75}, "module_episode_returns_mean": {"default_policy": 1.75}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "sample": 0.30166441625623586, "weights_seq_no": 17.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 85400, "rlmodule_inference_timer": 4.532416725291128e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5242147721011254}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-38", "timestamp": 1754933558, "time_this_iter_s": 3.148413896560669, "time_total_s": 57.27907037734985, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.27907037734985, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 80.28, "ram_util_percent": 80.42}}
{"timers": {"training_iteration": 4.174419667476502, "restore_env_runners": 1.1748747571235921e-05, "training_step": 4.17415948449692, "env_runner_sampling_timer": 3.9764459790386057, "learner_update_timer": 0.19320765126398293, "synch_weights": 0.0008519627145445731, "restore_eval_env_runners": 1.2282928853584243e-05, "evaluation_iteration": 0.34011919193479945, "synch_eval_env_connectors": 0.00045238839540670875, "synch_env_connectors": 0.0003843574289611497}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.75445955282816e-05, "un_batch_to_individual_items": 1.0818315259397152e-05, "listify_data_for_vector_env": 2.4854635986059728e-05, "get_actions": 0.00010907976952554145, "normalize_and_clip_actions": 1.9239041929913724e-05, "remove_single_ts_time_rank_from_batch": 1.2253198130111323e-06}}, "connector_pipeline_timer": 0.00025116744631318465}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_to_module_connector": {"connector_pipeline_timer": 8.826201676467456e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.747871026533313e-06, "numpy_to_tensor": 2.0460196798973423e-05, "add_observations_from_episodes_to_batch": 6.010120996535676e-06, "add_time_dim_to_batch_and_zero_pad": 4.883470620129774e-06, "batch_individual_items": 1.3798521181410804e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 7.2200000000000015, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.010889922497794031, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "num_episodes_lifetime": -493500.0, "env_step_timer": 3.26712674601643e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "sample": 0.011026981784222893, "env_reset_timer": 9.0283755838826e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -9870000.0, "num_episodes": 250.0, "time_between_sampling": 0.0029895239446571533, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 7.933337636895204e-05, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime_throughput": 2155.153838293706}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014803101833173635, "batch_individual_items": 0.05313263918301714, "add_observations_from_episodes_to_batch": 0.0016103033878422522, "add_one_ts_to_episodes_and_truncate": 0.02012847173184758, "add_columns_from_episodes_to_train_batch": 0.0625209439063542, "add_time_dim_to_batch_and_zero_pad": 4.567151221363227e-05, "add_states_from_episodes_to_batch": 5.35454021404768e-06, "general_advantage_estimation": 0.012315912920882455}}, "connector_pipeline_timer": 0.15011395250660234}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1228882.510154747, "num_module_steps_trained_throughput": 233259.73003477987, "num_module_steps_trained_lifetime_throughput": 233472.1522100597}, "default_policy": {"policy_loss": -0.044139228761196136, "weights_seq_no": 18.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 3.0231125492719002e-05, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.084064483642578, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 108000, "entropy": 0.46768543124198914, "curr_kl_coeff": 2.847657469828846e-06, "vf_explained_var": 0.005313515663146973, "module_train_batch_size_mean": 1000.0, "total_loss": 0.0203655194491148, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0484977550804615, "num_module_steps_trained_lifetime_throughput": 232674.34481687535}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1090061281249385e-06, "tensor_to_numpy": 2.5241603440961047e-05, "normalize_and_clip_actions": 1.8840622916061498e-05, "get_actions": 9.445323711383639e-05, "listify_data_for_vector_env": 2.0124408766834924e-05, "un_batch_to_individual_items": 1.0289091829793399e-05}}, "connector_pipeline_timer": 0.0002176372232627174}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.869349047272644e-06, "add_states_from_episodes_to_batch": 2.9432213897779024e-06, "add_time_dim_to_batch_and_zero_pad": 4.614061699174409e-06, "numpy_to_tensor": 2.0991403024573403e-05, "batch_individual_items": 1.3277181110483808e-05}}, "connector_pipeline_timer": 8.839394617992858e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.009046644970076158, "num_episodes_lifetime": 360, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 1.95, "env_step_timer": 3.0107087028194243e-05, "env_reset_timer": 0.001234897071649477, "agent_episode_returns_mean": {"default_agent": 1.95}, "module_episode_returns_mean": {"default_policy": 1.95}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "sample": 0.30095798625391657, "weights_seq_no": 18.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 90400, "rlmodule_inference_timer": 6.771658123228726e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.525086555629243}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-42", "timestamp": 1754933562, "time_this_iter_s": 3.798551082611084, "time_total_s": 61.07762145996094, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.07762145996094, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 87.74, "ram_util_percent": 81.94}}
{"timers": {"training_iteration": 4.161675253721155, "restore_env_runners": 1.1694600507976378e-05, "training_step": 4.161412897152004, "env_runner_sampling_timer": 3.961890822999109, "learner_update_timer": 0.19498053434202958, "synch_weights": 0.0008591460078993164, "restore_eval_env_runners": 1.2284689570774023e-05, "evaluation_iteration": 0.33914815709481283, "synch_eval_env_connectors": 0.0004491086815782155, "synch_env_connectors": 0.00038055343471680617}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.432529267017686e-05, "un_batch_to_individual_items": 9.069752610978505e-06, "listify_data_for_vector_env": 1.9260815847151557e-05, "get_actions": 8.458661155192884e-05, "normalize_and_clip_actions": 1.6871488413076765e-05, "remove_single_ts_time_rank_from_batch": 9.908395356770413e-07}}, "connector_pipeline_timer": 0.0001963535157918337}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.389822238353969e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.586523287262927e-06, "numpy_to_tensor": 1.732352596502496e-05, "add_observations_from_episodes_to_batch": 4.867240370828171e-06, "add_time_dim_to_batch_and_zero_pad": 3.9190596554448415e-06, "batch_individual_items": 1.125947876119145e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 7.2200000000000015, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008383785974234342, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "num_episodes_lifetime": -524375.0, "env_step_timer": 2.6620297763698446e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "sample": 0.009965675078703856, "env_reset_timer": 8.412643480176543e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -10487500.0, "num_episodes": 250.0, "time_between_sampling": 0.0036102824467690482, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.624445721059302e-05, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime_throughput": 2311.899917164574}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014824070821122738, "batch_individual_items": 0.05497166279116983, "add_observations_from_episodes_to_batch": 0.0016035253551197873, "add_one_ts_to_episodes_and_truncate": 0.0200226353548184, "add_columns_from_episodes_to_train_batch": 0.062316664047286224, "add_time_dim_to_batch_and_zero_pad": 4.559188727365132e-05, "add_states_from_episodes_to_batch": 5.358075572505386e-06, "general_advantage_estimation": 0.012306902121849879}}, "connector_pipeline_timer": 0.1516282921522536}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1218128.4885701898, "num_module_steps_trained_throughput": 231270.8677496384, "num_module_steps_trained_lifetime_throughput": 231462.89689601673}, "default_policy": {"policy_loss": -0.044341981410980225, "weights_seq_no": 19.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.00025957918842323124, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.0632381439209, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 114000, "entropy": 0.4804908037185669, "curr_kl_coeff": 1.423828734914423e-06, "vf_explained_var": 0.005652189254760742, "module_train_batch_size_mean": 1000.0, "total_loss": 0.02004677802324295, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03202617168426514, "num_module_steps_trained_lifetime_throughput": 230699.0405392303}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0071762978567888e-06, "tensor_to_numpy": 4.4484342614995344e-05, "normalize_and_clip_actions": 2.1759618991688038e-05, "get_actions": 0.00016660940474422608, "listify_data_for_vector_env": 2.432041853761286e-05, "un_batch_to_individual_items": 1.0342353817930858e-05}}, "connector_pipeline_timer": 0.0003579881924180556}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.474659384675685e-06, "add_states_from_episodes_to_batch": 5.051287574693159e-06, "add_time_dim_to_batch_and_zero_pad": 4.907689166485318e-06, "numpy_to_tensor": 2.5941805297443958e-05, "batch_individual_items": 3.254798066103835e-05}}, "connector_pipeline_timer": 0.00012352665921481787}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.009576510407496243, "num_episodes_lifetime": 380, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 2.55, "env_step_timer": 4.045893110845905e-05, "env_reset_timer": 0.0012232935210443254, "agent_episode_returns_mean": {"default_agent": 2.55}, "module_episode_returns_mean": {"default_policy": 2.55}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "sample": 0.2999224380616292, "weights_seq_no": 19.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 95400, "rlmodule_inference_timer": 0.00010153265979250526, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.5194754621530686}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-45", "timestamp": 1754933565, "time_this_iter_s": 3.1362051963806152, "time_total_s": 64.21382665634155, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.21382665634155, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 79.88, "ram_util_percent": 81.83999999999999}}
{"timers": {"training_iteration": 4.153534672854425, "restore_env_runners": 1.1645984476042933e-05, "training_step": 4.1532725023504495, "env_runner_sampling_timer": 3.9545011905982768, "learner_update_timer": 0.19422459024867642, "synch_weights": 0.0008663016281445408, "restore_eval_env_runners": 1.2562672269648603e-05, "evaluation_iteration": 0.3379600888545817, "synch_eval_env_connectors": 0.00044871634541331605, "synch_env_connectors": 0.0003767937412309139}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.048413166055531e-05, "un_batch_to_individual_items": 1.0324893490540093e-05, "listify_data_for_vector_env": 2.4386980043005337e-05, "get_actions": 0.00010473029687651375, "normalize_and_clip_actions": 1.983223382742901e-05, "remove_single_ts_time_rank_from_batch": 1.1430335738163844e-06}}, "connector_pipeline_timer": 0.00025106124162324226}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_to_module_connector": {"connector_pipeline_timer": 9.032954840218421e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.0106622765751584e-06, "numpy_to_tensor": 2.1398981387030087e-05, "add_observations_from_episodes_to_batch": 6.436211129230698e-06, "add_time_dim_to_batch_and_zero_pad": 4.992712405065873e-06, "batch_individual_items": 1.4791376092712892e-05}}}, "episode_return_min": -11.5, "episode_return_max": 8.5, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 6.580000000000001, "agent_episode_returns_mean": {"default_agent": 6.580000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.010761828109622005, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 6.580000000000001}, "num_episodes_lifetime": -555250.0, "env_step_timer": 3.4934746999422355e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "sample": 0.010703428142075776, "env_reset_timer": 8.803612469734468e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -11105000.0, "num_episodes": 250.0, "time_between_sampling": 0.003917041583986519, "episode_len_mean": 20.0, "episode_len_max": 20, "rlmodule_inference_timer": 6.980685238736637e-05, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime_throughput": 2099.0711545131344}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00014781289123140027, "batch_individual_items": 0.05477950532358753, "add_observations_from_episodes_to_batch": 0.0015973742618134268, "add_one_ts_to_episodes_and_truncate": 0.019921771091965867, "add_columns_from_episodes_to_train_batch": 0.06211394240686768, "add_time_dim_to_batch_and_zero_pad": 4.554721833095385e-05, "add_states_from_episodes_to_batch": 5.340745383844021e-06, "general_advantage_estimation": 0.0122478910109806}}, "connector_pipeline_timer": 0.1510662050703168}, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 1213357.8809675851, "num_module_steps_trained_throughput": 230426.01903518933, "num_module_steps_trained_lifetime_throughput": 230600.44328346234}, "default_policy": {"policy_loss": -0.013586264103651047, "weights_seq_no": 20.0, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0006841972935944796, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.30100440979004, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 120000, "entropy": 0.4970702528953552, "curr_kl_coeff": 7.119143674572115e-07, "vf_explained_var": 0.006448864936828613, "module_train_batch_size_mean": 1000.0, "total_loss": 0.050652336329221725, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.044757142663002014, "num_module_steps_trained_lifetime_throughput": 229827.12725865367}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.896904985973972e-07, "tensor_to_numpy": 2.7850796879625952e-05, "normalize_and_clip_actions": 2.0618654998025813e-05, "get_actions": 8.977108176285692e-05, "listify_data_for_vector_env": 2.21275482146729e-05, "un_batch_to_individual_items": 1.0072570195801986e-05}}, "connector_pipeline_timer": 0.00021928339586952842}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.052122210486889e-06, "add_states_from_episodes_to_batch": 3.471246473883059e-06, "add_time_dim_to_batch_and_zero_pad": 5.139334342691506e-06, "numpy_to_tensor": 1.707350785306263e-05, "batch_individual_items": 1.2584691613100745e-05}}, "connector_pipeline_timer": 8.082382443414016e-05}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_duration_sec_mean": 0.009229393330169842, "num_episodes_lifetime": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_mean": 1.95, "env_step_timer": 3.0248606007012643e-05, "env_reset_timer": 0.0012142226657902648, "agent_episode_returns_mean": {"default_agent": 1.95}, "module_episode_returns_mean": {"default_policy": 1.95}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "sample": 0.29852186618097365, "weights_seq_no": 20.0, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 100400, "rlmodule_inference_timer": 6.100323948220404e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "time_between_sampling": 3.518708681702077}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "5020f_00000", "date": "2025-08-11_19-32-49", "timestamp": 1754933569, "time_this_iter_s": 3.528074026107788, "time_total_s": 67.74190068244934, "pid": 24432, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862f9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.74190068244934, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 83.06, "ram_util_percent": 82.24000000000001}}
