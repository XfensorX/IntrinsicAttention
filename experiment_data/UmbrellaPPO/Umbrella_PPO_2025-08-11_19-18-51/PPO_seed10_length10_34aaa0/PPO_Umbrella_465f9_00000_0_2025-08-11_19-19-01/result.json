{"timers": {"training_iteration": 1.5441699580987915, "restore_env_runners": 1.2791948392987251e-05, "training_step": 1.544026124989614, "env_runner_sampling_timer": 1.4378012910019606, "learner_update_timer": 0.10318145796190947, "synch_weights": 0.0005304169608280063}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.623204674395168e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7418844635349802e-06, "add_observations_from_episodes_to_batch": 3.1593196380170028e-06, "add_time_dim_to_batch_and_zero_pad": 2.425273054402947e-06, "batch_individual_items": 6.386018646380842e-06, "numpy_to_tensor": 9.043728753616612e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.562135600369776e-06, "get_actions": 4.2845424550505896e-05, "normalize_and_clip_actions": 1.2781820773495227e-05, "tensor_to_numpy": 1.3111336653979452e-05, "remove_single_ts_time_rank_from_batch": 5.980784455183281e-07, "listify_data_for_vector_env": 1.1094283023950927e-05}}, "connector_pipeline_timer": 0.00011178190053048637}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "module_episode_returns_mean": {"default_policy": -2.0200000000000005}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0005074952292989319, "num_env_steps_sampled_lifetime": 627500.0, "episode_duration_sec_mean": 0.004836663361173123, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": -2.0200000000000005, "env_to_module_sum_episodes_length_out": 10.191744832559449, "rlmodule_inference_timer": 4.885501346272676e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 0.0, "sample": 0.005641064448242501, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "agent_episode_returns_mean": {"default_agent": -2.0200000000000005}, "num_episodes": 250.0, "env_reset_timer": 8.976966497520545e-05, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_episodes_lifetime": 31375.0, "env_step_timer": 1.4464745794086875e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3570.5545304598313}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0007990830345079303, "add_columns_from_episodes_to_train_batch": 0.033440624945797026, "add_states_from_episodes_to_batch": 3.2079406082630157e-06, "add_time_dim_to_batch_and_zero_pad": 1.1958065442740917e-05, "numpy_to_tensor": 7.458298932760954e-05, "general_advantage_estimation": 0.006280250032432377, "add_one_ts_to_episodes_and_truncate": 0.0074486249359324574, "batch_individual_items": 0.029899749904870987}}, "connector_pipeline_timer": 0.07807212497573346}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2475143.0153130568, "num_module_steps_trained_throughput": 474282.78100596514, "num_module_steps_trained_lifetime_throughput": 473185.55134173733}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 1.0, "vf_loss_unclipped": 28.793254852294922, "policy_loss": 0.05304957553744316, "gradients_default_optimizer_global_norm": 0.10005132108926773, "num_trainable_parameters": 6003, "vf_explained_var": -0.009449124336242676, "curr_kl_coeff": 0.3732481598854065, "total_loss": 0.11597263813018799, "mean_kl_loss": 0.0005800133803859353, "num_module_steps_trained_lifetime": 6000, "entropy": 0.6901261210441589, "num_module_steps_trained_lifetime_throughput": 475923.8863017196}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00010793712915112399, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.867620134697398e-07, "tensor_to_numpy": 1.4434275251662797e-05, "listify_data_for_vector_env": 1.1019182041682361e-05, "get_actions": 3.9766538996764035e-05, "un_batch_to_individual_items": 5.554478461833747e-06, "normalize_and_clip_actions": 1.0543598290347622e-05}}}, "episode_duration_sec_mean": 0.004567464702995494, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.229001000367037e-06, "add_observations_from_episodes_to_batch": 2.958563620511007e-06, "add_states_from_episodes_to_batch": 1.535821997775168e-06, "add_time_dim_to_batch_and_zero_pad": 2.2849441450146616e-06, "numpy_to_tensor": 8.428708232168593e-06}}, "connector_pipeline_timer": 4.439467910092372e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.55}, "episode_return_mean": -0.55, "rlmodule_inference_timer": 2.9454679867404724e-05, "weights_seq_no": 1.0, "env_step_timer": 1.460787713895564e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 5400, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.216013141322508, "module_episode_returns_mean": {"default_policy": -0.55}, "episode_return_min": -12.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10031837492715567, "env_reset_timer": 0.00014187500346451998, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes_lifetime": 20, "episode_return_max": 12.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-41", "timestamp": 1754933021, "time_this_iter_s": 1.6525850296020508, "time_total_s": 1.6525850296020508, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.6525850296020508, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.966666666666667, "ram_util_percent": 76.83333333333333}}
{"timers": {"training_iteration": 1.5440952814370394, "restore_env_runners": 1.2738608056679368e-05, "training_step": 1.5439506241597702, "env_runner_sampling_timer": 1.436920136421686, "learner_update_timer": 0.10398606130154803, "synch_weights": 0.0005311927921138704, "restore_eval_env_runners": 1.0041985660791397e-05, "evaluation_iteration": 0.10673883289564401, "synch_eval_env_connectors": 0.00012329209130257368, "synch_env_connectors": 4.625064320862293e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.302599537093857e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7244528694208985e-06, "add_observations_from_episodes_to_batch": 2.893392236840207e-06, "add_time_dim_to_batch_and_zero_pad": 2.316480447608712e-06, "batch_individual_items": 6.20731936781729e-06, "numpy_to_tensor": 8.444974743389749e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.372814386483005e-06, "get_actions": 3.701639122597752e-05, "normalize_and_clip_actions": 9.372703805286872e-06, "tensor_to_numpy": 1.2654074665370618e-05, "remove_single_ts_time_rank_from_batch": 5.873656688311454e-07, "listify_data_for_vector_env": 1.0901143539278243e-05}}, "connector_pipeline_timer": 0.00010106551487908022}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "module_episode_returns_mean": {"default_policy": -1.3799999999999994}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.001478579466282471, "num_env_steps_sampled_lifetime": 10000.0, "episode_duration_sec_mean": 0.0044402660890482375, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": -1.3799999999999994, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7240817573494626e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 1.0, "sample": 0.005104673792257275, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "agent_episode_returns_mean": {"default_agent": -1.3799999999999994}, "num_episodes": 250.0, "env_reset_timer": 3.6732095667032205e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": 500.0, "env_step_timer": 1.3511504553009228e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3801.2832969060673}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0007990880438592285, "add_columns_from_episodes_to_train_batch": 0.03344694869592786, "add_states_from_episodes_to_batch": 3.208781126886606e-06, "add_time_dim_to_batch_and_zero_pad": 1.1951405322179198e-05, "numpy_to_tensor": 7.501632906496525e-05, "general_advantage_estimation": 0.006272472532000393, "add_one_ts_to_episodes_and_truncate": 0.007448406186886132, "batch_individual_items": 0.030821321576368063}}, "connector_pipeline_timer": 0.07899230955634266}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2472862.300996228, "num_module_steps_trained_throughput": 473814.7993233729, "num_module_steps_trained_lifetime_throughput": 472729.24165630306}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 2.0, "vf_loss_unclipped": 28.727876663208008, "policy_loss": -0.00450977822765708, "gradients_default_optimizer_global_norm": 0.09314917027950287, "num_trainable_parameters": 6003, "vf_explained_var": -0.009900569915771484, "curr_kl_coeff": 0.18662407994270325, "total_loss": 0.05817184969782829, "mean_kl_loss": 0.0005508643225766718, "num_module_steps_trained_lifetime": 12000, "entropy": 0.691680371761322, "num_module_steps_trained_lifetime_throughput": 475413.0824475167}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.741853469355359e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.679347482219724e-07, "tensor_to_numpy": 1.2641888424087261e-05, "listify_data_for_vector_env": 1.0706265722805005e-05, "get_actions": 3.378209124048135e-05, "un_batch_to_individual_items": 5.332166146805524e-06, "normalize_and_clip_actions": 9.153869897617102e-06}}}, "episode_duration_sec_mean": 0.004502363648498431, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.967576194614972e-06, "add_observations_from_episodes_to_batch": 2.792359031385309e-06, "add_states_from_episodes_to_batch": 1.5317133266724094e-06, "add_time_dim_to_batch_and_zero_pad": 2.1638795580086087e-06, "numpy_to_tensor": 8.166114238126896e-06}}, "connector_pipeline_timer": 4.198782160439769e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.55}, "episode_return_mean": -1.55, "rlmodule_inference_timer": 2.643049490387474e-05, "weights_seq_no": 2.0, "env_step_timer": 1.355420056962075e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 10400, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.366003441359926, "module_episode_returns_mean": {"default_policy": -1.55}, "episode_return_min": -12.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10028451701859013, "env_reset_timer": 0.0001412783341947943, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes_lifetime": 40, "episode_return_max": 13.5, "time_between_sampling": 1.5686360830441117}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-43", "timestamp": 1754933023, "time_this_iter_s": 1.6404831409454346, "time_total_s": 3.2930681705474854, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.2930681705474854, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.1, "ram_util_percent": 77.05}}
{"timers": {"training_iteration": 1.5432571140323301, "restore_env_runners": 1.2679131689947098e-05, "training_step": 1.5431120933384985, "env_runner_sampling_timer": 1.436199260897946, "learner_update_timer": 0.10386852526797447, "synch_weights": 0.0005315892045153304, "restore_eval_env_runners": 1.0017395252361892e-05, "evaluation_iteration": 0.1066889424866531, "synch_eval_env_connectors": 0.00012310291989706457, "synch_env_connectors": 4.6196440234780314e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.342622422836737e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7336139974619718e-06, "add_observations_from_episodes_to_batch": 2.9487929945621083e-06, "add_time_dim_to_batch_and_zero_pad": 2.3220558472530903e-06, "batch_individual_items": 6.248048469785914e-06, "numpy_to_tensor": 8.532682566642786e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.477692035080446e-06, "get_actions": 3.7546106556330656e-05, "normalize_and_clip_actions": 9.447995616001727e-06, "tensor_to_numpy": 1.2745724440064148e-05, "remove_single_ts_time_rank_from_batch": 5.899492255839057e-07, "listify_data_for_vector_env": 1.0995680198861207e-05}}, "connector_pipeline_timer": 0.00010220638298705604}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0018158337593817317, "num_env_steps_sampled_lifetime": -607500.0, "episode_duration_sec_mean": 0.004492923830635846, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": -1.1400000000000001, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7256437571785888e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 2.0, "sample": 0.004831082198008198, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "num_episodes": 250.0, "env_reset_timer": 3.373230932617252e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -30375.0, "env_step_timer": 1.3641577907674215e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3759.9927357261313}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008008321630419232, "add_columns_from_episodes_to_train_batch": 0.03346368753863498, "add_states_from_episodes_to_batch": 3.211693582125008e-06, "add_time_dim_to_batch_and_zero_pad": 1.199772140244022e-05, "numpy_to_tensor": 7.491657584905624e-05, "general_advantage_estimation": 0.006264092807215639, "add_one_ts_to_episodes_and_truncate": 0.0074508512847125535, "batch_individual_items": 0.03081508753078524}}, "connector_pipeline_timer": 0.07899852437973022}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2471518.8979809606, "num_module_steps_trained_throughput": 473502.72160198406, "num_module_steps_trained_lifetime_throughput": 472436.5604777527}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 3.0, "vf_loss_unclipped": 28.677812576293945, "policy_loss": -0.007170871365815401, "gradients_default_optimizer_global_norm": 0.03816163167357445, "num_trainable_parameters": 6003, "vf_explained_var": -0.010045528411865234, "curr_kl_coeff": 0.09331203997135162, "total_loss": 0.05550922453403473, "mean_kl_loss": 0.0010828013764694333, "num_module_steps_trained_lifetime": 18000, "entropy": 0.6914566159248352, "num_module_steps_trained_lifetime_throughput": 475037.7986920503}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.859871484955259e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.764783843096797e-07, "tensor_to_numpy": 1.2575939975823349e-05, "listify_data_for_vector_env": 1.0835447182199543e-05, "get_actions": 3.4297657110710816e-05, "un_batch_to_individual_items": 5.362798433739806e-06, "normalize_and_clip_actions": 9.440704876128985e-06}}}, "episode_duration_sec_mean": 0.00448067994050992, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.031451367760332e-06, "add_observations_from_episodes_to_batch": 2.80155239167221e-06, "add_states_from_episodes_to_batch": 1.5573535905825538e-06, "add_time_dim_to_batch_and_zero_pad": 2.1844660336104883e-06, "numpy_to_tensor": 8.184217409980935e-06}}, "connector_pipeline_timer": 4.2433382207990726e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.55}, "episode_return_mean": -1.55, "rlmodule_inference_timer": 2.628167333832281e-05, "weights_seq_no": 3.0, "env_step_timer": 1.3570906117952076e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 15400, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368205581254823, "module_episode_returns_mean": {"default_policy": -1.55}, "episode_return_min": -12.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10024966017834379, "env_reset_timer": 0.00014068014029180632, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes_lifetime": 60, "episode_return_max": 13.5, "time_between_sampling": 1.5677154751343187}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-44", "timestamp": 1754933024, "time_this_iter_s": 1.5637590885162354, "time_total_s": 4.856827259063721, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.856827259063721, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.9, "ram_util_percent": 77.6}}
{"timers": {"training_iteration": 1.5432379803916714, "restore_env_runners": 1.2625260602333582e-05, "training_step": 1.5430927440655513, "env_runner_sampling_timer": 1.4363033878791818, "learner_update_timer": 0.10374501126553, "synch_weights": 0.0005319016533477696, "restore_eval_env_runners": 9.995971608441323e-06, "evaluation_iteration": 0.10663635139161487, "synch_eval_env_connectors": 0.00012286689128959553, "synch_env_connectors": 4.618036979809404e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.307302692913591e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7267389958248585e-06, "add_observations_from_episodes_to_batch": 3.001235597538329e-06, "add_time_dim_to_batch_and_zero_pad": 2.333883745100042e-06, "batch_individual_items": 6.161065093828848e-06, "numpy_to_tensor": 8.437022851849652e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.3859548574957224e-06, "get_actions": 3.756744093713302e-05, "normalize_and_clip_actions": 9.368546137808142e-06, "tensor_to_numpy": 1.266291085474403e-05, "remove_single_ts_time_rank_from_batch": 5.876581228518288e-07, "listify_data_for_vector_env": 1.0916872030518903e-05}}, "connector_pipeline_timer": 0.00010165154650134896}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "module_episode_returns_mean": {"default_policy": -0.3400000000000001}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0017586278176284246, "num_env_steps_sampled_lifetime": -1225000.0, "episode_duration_sec_mean": 0.004472424348816277, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": -0.3400000000000001, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.6948935627363858e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 3.0, "sample": 0.004767842061616109, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "agent_episode_returns_mean": {"default_agent": -0.3400000000000001}, "num_episodes": 250.0, "env_reset_timer": 3.333975849509553e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -61250.0, "env_step_timer": 1.3583277436668967e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3778.200510162511}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008013605012911139, "add_columns_from_episodes_to_train_batch": 0.03346557107315864, "add_states_from_episodes_to_batch": 3.220405827974901e-06, "add_time_dim_to_batch_and_zero_pad": 1.1981913782539777e-05, "numpy_to_tensor": 7.469907071627676e-05, "general_advantage_estimation": 0.0062553177095574794, "add_one_ts_to_episodes_and_truncate": 0.007457592352118343, "batch_individual_items": 0.030804857905353186}}, "connector_pipeline_timer": 0.0789882553850226}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2468118.317543882, "num_module_steps_trained_throughput": 472781.2004946252, "num_module_steps_trained_lifetime_throughput": 471741.06447001186}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 4.0, "vf_loss_unclipped": 28.70688247680664, "policy_loss": 0.04596720635890961, "gradients_default_optimizer_global_norm": 0.021336890757083893, "num_trainable_parameters": 6003, "vf_explained_var": -0.010156989097595215, "curr_kl_coeff": 0.04665601998567581, "total_loss": 0.10854453593492508, "mean_kl_loss": 0.0008237484726123512, "num_module_steps_trained_lifetime": 24000, "entropy": 0.6889801025390625, "num_module_steps_trained_lifetime_throughput": 474243.1488596571}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00010251187855235365, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.72677759364864e-07, "tensor_to_numpy": 1.3250228001213153e-05, "listify_data_for_vector_env": 1.1315780207534073e-05, "get_actions": 3.6334700760328815e-05, "un_batch_to_individual_items": 5.513087581651404e-06, "normalize_and_clip_actions": 9.44511139010602e-06}}}, "episode_duration_sec_mean": 0.004498281305131968, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.277940837056364e-06, "add_observations_from_episodes_to_batch": 2.8435021021760365e-06, "add_states_from_episodes_to_batch": 1.5628460656553486e-06, "add_time_dim_to_batch_and_zero_pad": 2.2252600660053938e-06, "numpy_to_tensor": 8.432279193800972e-06}}, "connector_pipeline_timer": 4.3515249643188967e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.05}, "episode_return_mean": -0.05, "rlmodule_inference_timer": 2.7945966093904024e-05, "weights_seq_no": 4.0, "env_step_timer": 1.4198600390042257e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 20400, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368237912813044, "module_episode_returns_mean": {"default_policy": -0.05}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10024166774635415, "env_reset_timer": 0.00014005583960853982, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes_lifetime": 80, "episode_return_max": 13.5, "time_between_sampling": 1.56761875205409}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-46", "timestamp": 1754933026, "time_this_iter_s": 1.6478288173675537, "time_total_s": 6.504656076431274, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.504656076431274, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.49999999999999, "ram_util_percent": 77.0}}
{"timers": {"training_iteration": 1.5431446480879198, "restore_env_runners": 1.256566740958835e-05, "training_step": 1.5429986407949767, "env_runner_sampling_timer": 1.4363341756710637, "learner_update_timer": 0.10361574698321449, "synch_weights": 0.0005327547164072352, "restore_eval_env_runners": 9.994342093938029e-06, "evaluation_iteration": 0.10661385370740492, "synch_eval_env_connectors": 0.00012285072287812363, "synch_env_connectors": 4.611856914591044e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.307450962113972e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7130794667060522e-06, "add_observations_from_episodes_to_batch": 2.9185672555116907e-06, "add_time_dim_to_batch_and_zero_pad": 2.3111698402626724e-06, "batch_individual_items": 6.147156618405697e-06, "numpy_to_tensor": 8.459193915585866e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.361827513109608e-06, "get_actions": 3.707421771804843e-05, "normalize_and_clip_actions": 9.366081483417847e-06, "tensor_to_numpy": 1.2684597170877056e-05, "remove_single_ts_time_rank_from_batch": 5.876844600365353e-07, "listify_data_for_vector_env": 1.0898298532631683e-05}}, "connector_pipeline_timer": 0.00010127175900636381}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0015839723030529624, "num_env_steps_sampled_lifetime": -1842500.0, "episode_duration_sec_mean": 0.004794747802894564, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": -1.1400000000000001, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.4566830187300435e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 4.0, "sample": 0.004819958878350823, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "num_episodes": 250.0, "env_reset_timer": 3.32193500146373e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -92125.0, "env_step_timer": 1.3515534075523017e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3792.473786925671}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008011060566403867, "add_columns_from_episodes_to_train_batch": 0.033470417023209895, "add_states_from_episodes_to_batch": 3.2157013970171103e-06, "add_time_dim_to_batch_and_zero_pad": 1.1943764649588846e-05, "numpy_to_tensor": 7.461791045738382e-05, "general_advantage_estimation": 0.006248701192381002, "add_one_ts_to_episodes_and_truncate": 0.007457463097911217, "batch_individual_items": 0.030795615166147428}}, "connector_pipeline_timer": 0.07897646991193767}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2465303.4748048075, "num_module_steps_trained_throughput": 472161.837019832, "num_module_steps_trained_lifetime_throughput": 471151.0170059052}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 5.0, "vf_loss_unclipped": 28.676191329956055, "policy_loss": -0.005832438822835684, "gradients_default_optimizer_global_norm": 0.02561800181865692, "num_trainable_parameters": 6003, "vf_explained_var": -0.010284781455993652, "curr_kl_coeff": 0.023328009992837906, "total_loss": 0.05677541345357895, "mean_kl_loss": 0.0012158984318375587, "num_module_steps_trained_lifetime": 30000, "entropy": 0.6833857297897339, "num_module_steps_trained_lifetime_throughput": 473538.71636356687}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00010077642450337807, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.98744484421928e-07, "tensor_to_numpy": 1.2773591441753782e-05, "listify_data_for_vector_env": 1.0964890437856425e-05, "get_actions": 3.564485022843813e-05, "un_batch_to_individual_items": 5.523044791923235e-06, "normalize_and_clip_actions": 9.483684139092618e-06}}}, "episode_duration_sec_mean": 0.0044887892040424045, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.070149626057421e-06, "add_observations_from_episodes_to_batch": 2.8727131290699405e-06, "add_states_from_episodes_to_batch": 1.5585033186352086e-06, "add_time_dim_to_batch_and_zero_pad": 2.2088282837916816e-06, "numpy_to_tensor": 8.336986259335176e-06}}, "connector_pipeline_timer": 4.2645179542548596e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.55}, "episode_return_mean": -0.55, "rlmodule_inference_timer": 2.7365338856803e-05, "weights_seq_no": 5.0, "env_step_timer": 1.4027434520031033e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 25400, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238387501162, "module_episode_returns_mean": {"default_policy": -0.55}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10021447189976886, "env_reset_timer": 0.00013958695070472895, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes_lifetime": 100, "episode_return_max": 13.5, "time_between_sampling": 1.567451919123289}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-48", "timestamp": 1754933028, "time_this_iter_s": 1.638441801071167, "time_total_s": 8.143097877502441, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.143097877502441, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.75, "ram_util_percent": 76.94999999999999}}
{"timers": {"training_iteration": 1.543049042856948, "restore_env_runners": 1.2502091534163117e-05, "training_step": 1.5429025243879315, "env_runner_sampling_timer": 1.4354935389147125, "learner_update_timer": 0.10435579701258842, "synch_weights": 0.0005335829995854853, "restore_eval_env_runners": 9.962728646144967e-06, "evaluation_iteration": 0.10657186183009627, "synch_eval_env_connectors": 0.00012308846546359942, "synch_env_connectors": 4.606578004495241e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.289327977652241e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7178988571383701e-06, "add_observations_from_episodes_to_batch": 2.895597590902553e-06, "add_time_dim_to_batch_and_zero_pad": 2.310883735790247e-06, "batch_individual_items": 6.142708512970558e-06, "numpy_to_tensor": 8.432958475957285e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.384618426645559e-06, "get_actions": 3.722111981483371e-05, "normalize_and_clip_actions": 9.345810478651319e-06, "tensor_to_numpy": 1.2686378082230432e-05, "remove_single_ts_time_rank_from_batch": 5.848447585098735e-07, "listify_data_for_vector_env": 1.0872035414849639e-05}}, "connector_pipeline_timer": 0.00010128417658670038}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "module_episode_returns_mean": {"default_policy": 0.54}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0014943278611676655, "num_env_steps_sampled_lifetime": -2460000.0, "episode_duration_sec_mean": 0.004445058677345514, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 0.54, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7223237617256295e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 5.0, "sample": 0.005037201012262266, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "agent_episode_returns_mean": {"default_agent": 0.54}, "num_episodes": 250.0, "env_reset_timer": 3.375189791348107e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -123000.0, "env_step_timer": 1.3502164439534682e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3783.5343362241806}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008012083360829867, "add_columns_from_episodes_to_train_batch": 0.033467117853738945, "add_states_from_episodes_to_batch": 3.2143851301053304e-06, "add_time_dim_to_batch_and_zero_pad": 1.1920156603561236e-05, "numpy_to_tensor": 7.469839073233696e-05, "general_advantage_estimation": 0.0062389033511548965, "add_one_ts_to_episodes_and_truncate": 0.007457886807501542, "batch_individual_items": 0.03165927818483132}}, "connector_pipeline_timer": 0.07982739896305076}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2460227.6157504884, "num_module_steps_trained_throughput": 471111.0095249527, "num_module_steps_trained_lifetime_throughput": 470129.5813629341}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 6.0, "vf_loss_unclipped": 28.676469802856445, "policy_loss": 0.13901302218437195, "gradients_default_optimizer_global_norm": 0.013501612469553947, "num_trainable_parameters": 6003, "vf_explained_var": -0.010419487953186035, "curr_kl_coeff": 0.011664004996418953, "total_loss": 0.20164747536182404, "mean_kl_loss": 0.0007163780392147601, "num_module_steps_trained_lifetime": 36000, "entropy": 0.6760303974151611, "num_module_steps_trained_lifetime_throughput": 472397.2509551206}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001007655753093277, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.91669869037417e-07, "tensor_to_numpy": 1.2804314235035182e-05, "listify_data_for_vector_env": 1.1005418429108662e-05, "get_actions": 3.539799055512702e-05, "un_batch_to_individual_items": 5.47137271355305e-06, "normalize_and_clip_actions": 9.400299763662553e-06}}}, "episode_duration_sec_mean": 0.004483462513890118, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.154432025084028e-06, "add_observations_from_episodes_to_batch": 2.8681322247656455e-06, "add_states_from_episodes_to_batch": 1.577701409612157e-06, "add_time_dim_to_batch_and_zero_pad": 2.2286421091080694e-06, "numpy_to_tensor": 8.318065387585555e-06}}, "connector_pipeline_timer": 4.283868024824421e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.15}, "episode_return_mean": -0.15, "rlmodule_inference_timer": 2.7002934846930068e-05, "weights_seq_no": 6.0, "env_step_timer": 1.3992869565153452e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 30400, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394470474, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10020802634103783, "env_reset_timer": 0.00013913566114914677, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes_lifetime": 120, "episode_return_max": 13.5, "time_between_sampling": 1.5672871315921875}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-49", "timestamp": 1754933029, "time_this_iter_s": 1.6405558586120605, "time_total_s": 9.783653736114502, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.783653736114502, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.25, "ram_util_percent": 77.15}}
{"timers": {"training_iteration": 1.5421192811785143, "restore_env_runners": 1.2443740509478554e-05, "training_step": 1.5419722999738037, "env_runner_sampling_timer": 1.434688864365549, "learner_update_timer": 0.10423000779210378, "synch_weights": 0.0005337629997152902, "restore_eval_env_runners": 9.934351029101257e-06, "evaluation_iteration": 0.10655412446166232, "synch_eval_env_connectors": 0.00012297341119129563, "synch_env_connectors": 4.599262228473602e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.311104395132576e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7296646926087848e-06, "add_observations_from_episodes_to_batch": 2.913110919718897e-06, "add_time_dim_to_batch_and_zero_pad": 2.302197599831611e-06, "batch_individual_items": 6.244689112011538e-06, "numpy_to_tensor": 8.51163355310825e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.418968268141902e-06, "get_actions": 3.739438914909523e-05, "normalize_and_clip_actions": 9.391385362277725e-06, "tensor_to_numpy": 1.2758525262394432e-05, "remove_single_ts_time_rank_from_batch": 5.844022484296099e-07, "listify_data_for_vector_env": 1.0930893717913379e-05}}, "connector_pipeline_timer": 0.00010167555841903248}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "module_episode_returns_mean": {"default_policy": 2.0599999999999996}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0018114877125962802, "num_env_steps_sampled_lifetime": -3077500.0, "episode_duration_sec_mean": 0.004466421150602402, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 2.0599999999999996, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7041633100334203e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 6.0, "sample": 0.004789288728908355, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "agent_episode_returns_mean": {"default_agent": 2.0599999999999996}, "num_episodes": 250.0, "env_reset_timer": 3.272835635711087e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -153875.0, "env_step_timer": 1.3578139250368692e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3794.2756976948717}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008013475033807136, "add_columns_from_episodes_to_train_batch": 0.03347784708520738, "add_states_from_episodes_to_batch": 3.2126617665508736e-06, "add_time_dim_to_batch_and_zero_pad": 1.1910954710966675e-05, "numpy_to_tensor": 7.460849681092066e-05, "general_advantage_estimation": 0.006228220987262654, "add_one_ts_to_episodes_and_truncate": 0.00746116293969892, "batch_individual_items": 0.03164267998296502}}, "connector_pipeline_timer": 0.07981401706285236}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2454456.03199937, "num_module_steps_trained_throughput": 469922.8193880149, "num_module_steps_trained_lifetime_throughput": 468972.6788341127}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 7.0, "vf_loss_unclipped": 28.562328338623047, "policy_loss": -0.034859273582696915, "gradients_default_optimizer_global_norm": 0.058202605694532394, "num_trainable_parameters": 6003, "vf_explained_var": -0.010401129722595215, "curr_kl_coeff": 0.0058320024982094765, "total_loss": 0.027804788202047348, "mean_kl_loss": 0.00041595392394810915, "num_module_steps_trained_lifetime": 42000, "entropy": 0.6714522838592529, "num_module_steps_trained_lifetime_throughput": 471116.7707332241}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00010031343677651995, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.936643896198267e-07, "tensor_to_numpy": 1.2705624742018568e-05, "listify_data_for_vector_env": 1.098347512265844e-05, "get_actions": 3.561359895173651e-05, "un_batch_to_individual_items": 5.470779030242752e-06, "normalize_and_clip_actions": 9.468810772114198e-06}}}, "episode_duration_sec_mean": 0.0044810124824289236, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.094228741472885e-06, "add_observations_from_episodes_to_batch": 2.8364617319401253e-06, "add_states_from_episodes_to_batch": 1.5429454326478692e-06, "add_time_dim_to_batch_and_zero_pad": 2.2897860044789058e-06, "numpy_to_tensor": 8.32392248593832e-06}}, "connector_pipeline_timer": 4.263664239522263e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.65}, "episode_return_mean": 0.65, "rlmodule_inference_timer": 2.7843252214047923e-05, "weights_seq_no": 7.0, "env_step_timer": 1.4741891079066625e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 35400, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394572801, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10017203524758791, "env_reset_timer": 0.00013847555341187255, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes_lifetime": 140, "episode_return_max": 13.5, "time_between_sampling": 1.5662921977762114}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-51", "timestamp": 1754933031, "time_this_iter_s": 1.5538959503173828, "time_total_s": 11.337549686431885, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.337549686431885, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 39.699999999999996, "ram_util_percent": 77.13333333333334}}
{"timers": {"training_iteration": 1.5421610087763564, "restore_env_runners": 1.2376383864981952e-05, "training_step": 1.5420137811343033, "env_runner_sampling_timer": 1.434865396551685, "learner_update_timer": 0.10409422771460884, "synch_weights": 0.000533850780063334, "restore_eval_env_runners": 9.899167495128723e-06, "evaluation_iteration": 0.10650434238686826, "synch_eval_env_connectors": 0.00012275408640288128, "synch_env_connectors": 4.596189607040021e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.3417351727067076e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7386526129376308e-06, "add_observations_from_episodes_to_batch": 3.0314284736485754e-06, "add_time_dim_to_batch_and_zero_pad": 2.3371012374304174e-06, "batch_individual_items": 6.2297621841697065e-06, "numpy_to_tensor": 8.51528750044479e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.448511384356688e-06, "get_actions": 3.7802833660608416e-05, "normalize_and_clip_actions": 9.431500966389123e-06, "tensor_to_numpy": 1.2812221675546883e-05, "remove_single_ts_time_rank_from_batch": 5.962955864014929e-07, "listify_data_for_vector_env": 1.0982691180475582e-05}}, "connector_pipeline_timer": 0.00010244123904294691}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "module_episode_returns_mean": {"default_policy": 1.6599999999999997}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0015101688816075022, "num_env_steps_sampled_lifetime": -3695000.0, "episode_duration_sec_mean": 0.0048360672914423055, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 1.6599999999999997, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.232165514819476e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 7.0, "sample": 0.005068007610816051, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "agent_episode_returns_mean": {"default_agent": 1.6599999999999997}, "num_episodes": 250.0, "env_reset_timer": 3.4902584236580466e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -184750.0, "env_step_timer": 1.3700156455233647e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3741.8619298105177}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008038077774815961, "add_columns_from_episodes_to_train_batch": 0.03348267152387185, "add_states_from_episodes_to_batch": 3.215125633459802e-06, "add_time_dim_to_batch_and_zero_pad": 1.190517547965553e-05, "numpy_to_tensor": 7.450408145518934e-05, "general_advantage_estimation": 0.0062190416869773515, "add_one_ts_to_episodes_and_truncate": 0.007460457559901462, "batch_individual_items": 0.031624016513298804}}, "connector_pipeline_timer": 0.0797924548124111}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2449413.351903558, "num_module_steps_trained_throughput": 468868.5477492767, "num_module_steps_trained_lifetime_throughput": 467950.02564943925}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 8.0, "vf_loss_unclipped": 28.607404708862305, "policy_loss": 0.006612226366996765, "gradients_default_optimizer_global_norm": 0.019486667588353157, "num_trainable_parameters": 6003, "vf_explained_var": -0.010833382606506348, "curr_kl_coeff": 0.0029160012491047382, "total_loss": 0.06938596069812775, "mean_kl_loss": 0.0010036317398771644, "num_module_steps_trained_lifetime": 48000, "entropy": 0.6594521403312683, "num_module_steps_trained_lifetime_throughput": 469970.9117688656}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00010316902959475589, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.284340130576098e-07, "tensor_to_numpy": 1.3213838278949069e-05, "listify_data_for_vector_env": 1.122876344302003e-05, "get_actions": 3.694082927517415e-05, "un_batch_to_individual_items": 5.534330231392368e-06, "normalize_and_clip_actions": 9.551190211773477e-06}}}, "episode_duration_sec_mean": 0.004495843286858872, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.1821968566704184e-06, "add_observations_from_episodes_to_batch": 2.8585918342270254e-06, "add_states_from_episodes_to_batch": 1.5412430017869952e-06, "add_time_dim_to_batch_and_zero_pad": 2.2381768933913e-06, "numpy_to_tensor": 8.799211462231077e-06}}, "connector_pipeline_timer": 4.314438954643081e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 1.25}, "episode_return_mean": 1.25, "rlmodule_inference_timer": 2.798392295477492e-05, "weights_seq_no": 8.0, "env_step_timer": 1.441765718465423e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 40400, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.3682383945743, "module_episode_returns_mean": {"default_policy": 1.25}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10016016822506857, "env_reset_timer": 0.0001378062177606623, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes_lifetime": 160, "episode_return_max": 13.5, "time_between_sampling": 1.566262260798715}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-52", "timestamp": 1754933032, "time_this_iter_s": 1.6525061130523682, "time_total_s": 12.990055799484253, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.990055799484253, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.1, "ram_util_percent": 77.15}}
{"timers": {"training_iteration": 1.5422207332791789, "restore_env_runners": 1.2360530044746393e-05, "training_step": 1.5420728437424644, "env_runner_sampling_timer": 1.4341680025863561, "learner_update_timer": 0.10484905084810582, "synch_weights": 0.0005345772730426274, "restore_eval_env_runners": 9.866005192210912e-06, "evaluation_iteration": 0.10647890771256059, "synch_eval_env_connectors": 0.00012262070520902658, "synch_env_connectors": 4.596058094866448e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.321803026358287e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7238082464115745e-06, "add_observations_from_episodes_to_batch": 2.9307335444560403e-06, "add_time_dim_to_batch_and_zero_pad": 2.323677422836684e-06, "batch_individual_items": 6.210836206957368e-06, "numpy_to_tensor": 8.474032408449406e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.425810383551409e-06, "get_actions": 3.769702490219237e-05, "normalize_and_clip_actions": 9.395170818363248e-06, "tensor_to_numpy": 1.2814045125413797e-05, "remove_single_ts_time_rank_from_batch": 5.905045997862589e-07, "listify_data_for_vector_env": 1.0949887848220528e-05}}, "connector_pipeline_timer": 0.00010222828077318904}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "module_episode_returns_mean": {"default_policy": 2.379999999999999}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0014928961491648262, "num_env_steps_sampled_lifetime": -4312500.0, "episode_duration_sec_mean": 0.004497467186301946, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 2.379999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7492709451625133e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 8.0, "sample": 0.004877226310201186, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "agent_episode_returns_mean": {"default_agent": 2.379999999999999}, "num_episodes": 250.0, "env_reset_timer": 3.529777871227329e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -215625.0, "env_step_timer": 1.3652938993438211e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3758.996299154114}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008038959490108214, "add_columns_from_episodes_to_train_batch": 0.03348307814937147, "add_states_from_episodes_to_batch": 3.2150549473610525e-06, "add_time_dim_to_batch_and_zero_pad": 1.188820366395614e-05, "numpy_to_tensor": 7.457320050705985e-05, "general_advantage_estimation": 0.006210660019760977, "add_one_ts_to_episodes_and_truncate": 0.008350637564585315, "batch_individual_items": 0.03160949968752789}}, "connector_pipeline_timer": 0.08066014443477496}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2444893.5521249045, "num_module_steps_trained_throughput": 467915.5447199924, "num_module_steps_trained_lifetime_throughput": 467027.95214758837}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 9.0, "vf_loss_unclipped": 28.564573287963867, "policy_loss": -0.08469157665967941, "gradients_default_optimizer_global_norm": 0.05511411279439926, "num_trainable_parameters": 6003, "vf_explained_var": -0.010897278785705566, "curr_kl_coeff": 0.0014580006245523691, "total_loss": -0.021834900602698326, "mean_kl_loss": 0.000535716419108212, "num_module_steps_trained_lifetime": 54000, "entropy": 0.6498231291770935, "num_module_steps_trained_lifetime_throughput": 468928.234503212}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.861246975017299e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.705444938554247e-07, "tensor_to_numpy": 1.261125508286309e-05, "listify_data_for_vector_env": 1.071975547616044e-05, "get_actions": 3.457115990587271e-05, "un_batch_to_individual_items": 5.315998365945374e-06, "normalize_and_clip_actions": 9.354196633437728e-06}}}, "episode_duration_sec_mean": 0.004470381209393963, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.970250475235581e-06, "add_observations_from_episodes_to_batch": 2.7930260732390223e-06, "add_states_from_episodes_to_batch": 1.5278772575938667e-06, "add_time_dim_to_batch_and_zero_pad": 2.1656762224463527e-06, "numpy_to_tensor": 8.13218483412734e-06}}, "connector_pipeline_timer": 4.1959829160191024e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_return_mean": 0.25, "rlmodule_inference_timer": 2.645957506952213e-05, "weights_seq_no": 9.0, "env_step_timer": 1.369352572979737e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 45400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10012957946389042, "env_reset_timer": 0.00013728190597212496, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes_lifetime": 180, "episode_return_max": 13.5, "time_between_sampling": 1.5662622669405788}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-54", "timestamp": 1754933034, "time_this_iter_s": 1.652646780014038, "time_total_s": 14.642702579498291, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.642702579498291, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.7, "ram_util_percent": 78.05}}
{"timers": {"training_iteration": 1.5421723684460715, "restore_env_runners": 1.2294004340743893e-05, "training_step": 1.542024266144579, "env_runner_sampling_timer": 1.4333809200609715, "learner_update_timer": 0.10558783867982285, "synch_weights": 0.0005347790012261638, "restore_eval_env_runners": 9.841095410819385e-06, "evaluation_iteration": 0.10643695446566152, "synch_eval_env_connectors": 0.00012253032869155838, "synch_env_connectors": 4.590097818497518e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.3118226802119074e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7299475848856312e-06, "add_observations_from_episodes_to_batch": 2.9607722679434215e-06, "add_time_dim_to_batch_and_zero_pad": 2.315544191515251e-06, "batch_individual_items": 6.178524400252931e-06, "numpy_to_tensor": 8.468235244461134e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.385645714335584e-06, "get_actions": 3.7433760297554534e-05, "normalize_and_clip_actions": 9.357720141101725e-06, "tensor_to_numpy": 1.2714045312600998e-05, "remove_single_ts_time_rank_from_batch": 5.89569129346389e-07, "listify_data_for_vector_env": 1.0884822878248691e-05}}, "connector_pipeline_timer": 0.00010162705749853087}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "module_episode_returns_mean": {"default_policy": 2.460000000000001}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0017952566549410416, "num_env_steps_sampled_lifetime": -4930000.0, "episode_duration_sec_mean": 0.0044682346503250306, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 2.460000000000001, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.6984644992819524e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 9.0, "sample": 0.0047856202446943915, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "agent_episode_returns_mean": {"default_agent": 2.460000000000001}, "num_episodes": 250.0, "env_reset_timer": 3.32218667212206e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -246500.0, "env_step_timer": 1.3601500245498739e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3795.728334639656}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008043582393518831, "add_columns_from_episodes_to_train_batch": 0.03349185736727739, "add_states_from_episodes_to_batch": 3.2208243606661296e-06, "add_time_dim_to_batch_and_zero_pad": 1.1860161667091354e-05, "numpy_to_tensor": 7.437705941556812e-05, "general_advantage_estimation": 0.006202220919014335, "add_one_ts_to_episodes_and_truncate": 0.008346680769053424, "batch_individual_items": 0.032468700100864736}}, "connector_pipeline_timer": 0.08151576340049851}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2442412.092349678, "num_module_steps_trained_throughput": 467353.77942325216, "num_module_steps_trained_lifetime_throughput": 466496.3925366272}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 10.0, "vf_loss_unclipped": 28.557741165161133, "policy_loss": -0.15532250702381134, "gradients_default_optimizer_global_norm": 0.012517706491053104, "num_trainable_parameters": 6003, "vf_explained_var": -0.010891318321228027, "curr_kl_coeff": 0.0007290003122761846, "total_loss": -0.09232137352228165, "mean_kl_loss": 0.0009032915695570409, "num_module_steps_trained_lifetime": 60000, "entropy": 0.6338445544242859, "num_module_steps_trained_lifetime_throughput": 468281.3107351566}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.946515418197995e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.692680883903216e-07, "tensor_to_numpy": 1.3050686780911013e-05, "listify_data_for_vector_env": 1.09063743866421e-05, "get_actions": 3.4671512646963665e-05, "un_batch_to_individual_items": 5.445577302207844e-06, "normalize_and_clip_actions": 9.310832292214859e-06}}}, "episode_duration_sec_mean": 0.004468575796345249, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.013484285663109e-06, "add_observations_from_episodes_to_batch": 2.8642590960027e-06, "add_states_from_episodes_to_batch": 1.5339162869956083e-06, "add_time_dim_to_batch_and_zero_pad": 2.1772408968484685e-06, "numpy_to_tensor": 8.249433184191885e-06}}, "connector_pipeline_timer": 4.2461447323160866e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_return_mean": 0.85, "rlmodule_inference_timer": 2.677773925053681e-05, "weights_seq_no": 10.0, "env_step_timer": 1.3862694079329522e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 50400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10009705866874338, "env_reset_timer": 0.00013680116588203132, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes_lifetime": 200, "episode_return_max": 13.5, "time_between_sampling": 1.5661427959413086}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-56", "timestamp": 1754933036, "time_this_iter_s": 1.6414740085601807, "time_total_s": 16.28417658805847, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.28417658805847, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.733333333333334, "ram_util_percent": 77.7}}
{"timers": {"training_iteration": 1.5413683335117605, "restore_env_runners": 1.225273430221092e-05, "training_step": 1.5412199709837031, "env_runner_sampling_timer": 1.4327245675198594, "learner_update_timer": 0.10543935488334655, "synch_weights": 0.0005352120410290962, "restore_eval_env_runners": 9.809354347368258e-06, "evaluation_iteration": 0.10639154784048414, "synch_eval_env_connectors": 0.00012291585606368955, "synch_env_connectors": 4.595446357440415e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.3293750877076696e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.729081400967589e-06, "add_observations_from_episodes_to_batch": 2.940345403816481e-06, "add_time_dim_to_batch_and_zero_pad": 2.3261821948240655e-06, "batch_individual_items": 6.226575986240321e-06, "numpy_to_tensor": 8.548057753760255e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.434599321539634e-06, "get_actions": 3.7840009730427114e-05, "normalize_and_clip_actions": 9.452433675210516e-06, "tensor_to_numpy": 1.2828437931196072e-05, "remove_single_ts_time_rank_from_batch": 5.871834077969627e-07, "listify_data_for_vector_env": 1.0960864419733262e-05}}, "connector_pipeline_timer": 0.00010243144357812559}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "module_episode_returns_mean": {"default_policy": 2.8600000000000008}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0018217425365466525, "num_env_steps_sampled_lifetime": -5547500.0, "episode_duration_sec_mean": 0.004510564523283392, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 2.8600000000000008, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7828867238465433e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 10.0, "sample": 0.00482197551972631, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "agent_episode_returns_mean": {"default_agent": 2.8600000000000008}, "num_episodes": 250.0, "env_reset_timer": 3.508291617770615e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -277375.0, "env_step_timer": 1.3688511874029557e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3753.5517750788936}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008044446559999216, "add_columns_from_episodes_to_train_batch": 0.033495056293673234, "add_states_from_episodes_to_batch": 3.224035478725313e-06, "add_time_dim_to_batch_and_zero_pad": 1.1859059198893583e-05, "numpy_to_tensor": 7.430120776055586e-05, "general_advantage_estimation": 0.006192043289690347, "add_one_ts_to_episodes_and_truncate": 0.008337278130674785, "batch_individual_items": 0.0324454439399013}}, "connector_pipeline_timer": 0.08147596617682808}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2439301.6401781086, "num_module_steps_trained_throughput": 466674.36834555306, "num_module_steps_trained_lifetime_throughput": 465846.6997457303}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 11.0, "vf_loss_unclipped": 28.637535095214844, "policy_loss": -0.020069513469934464, "gradients_default_optimizer_global_norm": 0.01735222153365612, "num_trainable_parameters": 6003, "vf_explained_var": -0.0113600492477417, "curr_kl_coeff": 0.0003645001561380923, "total_loss": 0.04307083040475845, "mean_kl_loss": 0.0006507525686174631, "num_module_steps_trained_lifetime": 66000, "entropy": 0.6183834671974182, "num_module_steps_trained_lifetime_throughput": 467519.2064310678}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.86358879435524e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.770175606078548e-07, "tensor_to_numpy": 1.2576086958698612e-05, "listify_data_for_vector_env": 1.0822384084702003e-05, "get_actions": 3.455511378752881e-05, "un_batch_to_individual_items": 5.361379080538802e-06, "normalize_and_clip_actions": 9.19742133646639e-06}}}, "episode_duration_sec_mean": 0.004447362895589322, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.1282725588593454e-06, "add_observations_from_episodes_to_batch": 2.769906381727536e-06, "add_states_from_episodes_to_batch": 1.5463458266066697e-06, "add_time_dim_to_batch_and_zero_pad": 2.186954238372263e-06, "numpy_to_tensor": 8.232573722345397e-06}}, "connector_pipeline_timer": 4.224423154732674e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_return_mean": 0.85, "rlmodule_inference_timer": 2.646253953611064e-05, "weights_seq_no": 11.0, "env_step_timer": 1.3610592557116917e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 55400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10006240308260676, "env_reset_timer": 0.00013617940321164568, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes_lifetime": 220, "episode_return_max": 13.5, "time_between_sampling": 1.5652766996516339}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-57", "timestamp": 1754933037, "time_this_iter_s": 1.5652940273284912, "time_total_s": 17.849470615386963, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.849470615386963, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.6, "ram_util_percent": 77.75}}
{"timers": {"training_iteration": 1.541447420176771, "restore_env_runners": 1.2190207416058413e-05, "training_step": 1.5412988516941906, "env_runner_sampling_timer": 1.432952028514539, "learner_update_timer": 0.1052906913347445, "synch_weights": 0.0005353986705930263, "restore_eval_env_runners": 9.78959085318583e-06, "evaluation_iteration": 0.10634063945273911, "synch_eval_env_connectors": 0.00012268877731027455, "synch_env_connectors": 4.5932407718085735e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.352526148427603e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7334335957366101e-06, "add_observations_from_episodes_to_batch": 3.006204198109975e-06, "add_time_dim_to_batch_and_zero_pad": 2.3441416030770575e-06, "batch_individual_items": 6.282428666270885e-06, "numpy_to_tensor": 8.562981055899362e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.453027854822464e-06, "get_actions": 3.775294812433843e-05, "normalize_and_clip_actions": 9.468995528911425e-06, "tensor_to_numpy": 1.2856809215588482e-05, "remove_single_ts_time_rank_from_batch": 5.99952754280159e-07, "listify_data_for_vector_env": 1.1006185263694815e-05}}, "connector_pipeline_timer": 0.00010254342236243762}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "module_episode_returns_mean": {"default_policy": 4.380000000000001}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0017787938139481078, "num_env_steps_sampled_lifetime": -6165000.0, "episode_duration_sec_mean": 0.004514559987001121, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 4.380000000000001, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7363286841826505e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 11.0, "sample": 0.004807723093962064, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "agent_episode_returns_mean": {"default_agent": 4.380000000000001}, "num_episodes": 250.0, "env_reset_timer": 3.447305994463146e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -308250.0, "env_step_timer": 1.3702129178384054e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3742.1853941401964}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008043785484209697, "add_columns_from_episodes_to_train_batch": 0.03349998073079983, "add_states_from_episodes_to_batch": 3.2205450518164398e-06, "add_time_dim_to_batch_and_zero_pad": 1.1823798694268366e-05, "numpy_to_tensor": 7.407402615319935e-05, "general_advantage_estimation": 0.006182249937064464, "add_one_ts_to_episodes_and_truncate": 0.008329587429718854, "batch_individual_items": 0.03242110408139804}}, "connector_pipeline_timer": 0.0814384460956985}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2436574.8875595876, "num_module_steps_trained_throughput": 466070.19052322616, "num_module_steps_trained_lifetime_throughput": 465271.71237643005}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 12.0, "vf_loss_unclipped": 28.60890007019043, "policy_loss": -0.04556255415081978, "gradients_default_optimizer_global_norm": 0.02542821504175663, "num_trainable_parameters": 6003, "vf_explained_var": -0.01087331771850586, "curr_kl_coeff": 0.00018225007806904614, "total_loss": 0.01771397329866886, "mean_kl_loss": 0.0004655509255826473, "num_module_steps_trained_lifetime": 72000, "entropy": 0.6033130884170532, "num_module_steps_trained_lifetime_throughput": 466835.3145612381}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.843133645345133e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.769604543649861e-07, "tensor_to_numpy": 1.2640065310102059e-05, "listify_data_for_vector_env": 1.079755883406268e-05, "get_actions": 3.4307025905952536e-05, "un_batch_to_individual_items": 5.29734115764179e-06, "normalize_and_clip_actions": 9.218562902476564e-06}}}, "episode_duration_sec_mean": 0.004442582491319627, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.0254566659685805e-06, "add_observations_from_episodes_to_batch": 2.795000186198806e-06, "add_states_from_episodes_to_batch": 1.5381785490249925e-06, "add_time_dim_to_batch_and_zero_pad": 2.1657338459139165e-06, "numpy_to_tensor": 8.123998219525697e-06}}, "connector_pipeline_timer": 4.22429443065368e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_return_mean": 0.25, "rlmodule_inference_timer": 2.625784190071432e-05, "weights_seq_no": 12.0, "env_step_timer": 1.3672243420329163e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 60400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.10002066613197698, "env_reset_timer": 0.0001356105290704843, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes_lifetime": 240, "episode_return_max": 13.5, "time_between_sampling": 1.5652819389052774}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "465f9_00000", "date": "2025-08-11_19-23-59", "timestamp": 1754933039, "time_this_iter_s": 1.6519999504089355, "time_total_s": 19.5014705657959, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.5014705657959, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.95, "ram_util_percent": 77.6}}
{"timers": {"training_iteration": 1.5414777684749974, "restore_env_runners": 1.2122885501383168e-05, "training_step": 1.5413288710964876, "env_runner_sampling_timer": 1.4331362761393507, "learner_update_timer": 0.10513536525131172, "synch_weights": 0.0005363309343144614, "restore_eval_env_runners": 9.760864272270663e-06, "evaluation_iteration": 0.10628217513868339, "synch_eval_env_connectors": 0.00012241813896049687, "synch_env_connectors": 4.589809269783065e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.33140833954191e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.728081714161301e-06, "add_observations_from_episodes_to_batch": 2.9086093463945566e-06, "add_time_dim_to_batch_and_zero_pad": 2.336374771099334e-06, "batch_individual_items": 6.226375581774387e-06, "numpy_to_tensor": 8.565903192483064e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.449130752485287e-06, "get_actions": 3.7716255048645624e-05, "normalize_and_clip_actions": 9.430431336198375e-06, "tensor_to_numpy": 1.278383426166878e-05, "remove_single_ts_time_rank_from_batch": 5.918209475688295e-07, "listify_data_for_vector_env": 1.0942514055932471e-05}}, "connector_pipeline_timer": 0.00010227385010842995}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0016644956801406307, "num_env_steps_sampled_lifetime": -6782500.0, "episode_duration_sec_mean": 0.004491493855137377, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 3.339999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7170415160143902e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 12.0, "sample": 0.004821443891745954, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "num_episodes": 250.0, "env_reset_timer": 3.509381152293797e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -339125.0, "env_step_timer": 1.3657316452429834e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3738.946169609592}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008042430932357202, "add_columns_from_episodes_to_train_batch": 0.03350008259268042, "add_states_from_episodes_to_batch": 3.2229196084937483e-06, "add_time_dim_to_batch_and_zero_pad": 1.1822230978707418e-05, "numpy_to_tensor": 7.381536639596557e-05, "general_advantage_estimation": 0.006173013278151869, "add_one_ts_to_episodes_and_truncate": 0.008321239056255906, "batch_individual_items": 0.03239993970084901}}, "connector_pipeline_timer": 0.08139918663466887}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2436056.9655783996, "num_module_steps_trained_throughput": 465891.97414379945, "num_module_steps_trained_lifetime_throughput": 465120.90462581}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 13.0, "vf_loss_unclipped": 28.610172271728516, "policy_loss": -0.039517566561698914, "gradients_default_optimizer_global_norm": 0.02619677409529686, "num_trainable_parameters": 6003, "vf_explained_var": -0.011479973793029785, "curr_kl_coeff": 9.112503903452307e-05, "total_loss": 0.023966753855347633, "mean_kl_loss": 0.0013015683507546782, "num_module_steps_trained_lifetime": 78000, "entropy": 0.5803787112236023, "num_module_steps_trained_lifetime_throughput": 466583.2420971902}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.820293088861416e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.709913729576767e-07, "tensor_to_numpy": 1.2548101119480552e-05, "listify_data_for_vector_env": 1.0790914932333799e-05, "get_actions": 3.424196712076317e-05, "un_batch_to_individual_items": 5.31126312358101e-06, "normalize_and_clip_actions": 9.289157221002193e-06}}}, "episode_duration_sec_mean": 0.004423819599905982, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.988728177986173e-06, "add_observations_from_episodes_to_batch": 2.7751206281791163e-06, "add_states_from_episodes_to_batch": 1.5202845115388435e-06, "add_time_dim_to_batch_and_zero_pad": 2.1468032041672264e-06, "numpy_to_tensor": 8.09711832263937e-06}}, "connector_pipeline_timer": 4.1998935707593914e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_return_mean": 0.25, "rlmodule_inference_timer": 2.6535601580916435e-05, "weights_seq_no": 13.0, "env_step_timer": 1.3639712698880194e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 65400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.09998184738014038, "env_reset_timer": 0.00013502900360093392, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes_lifetime": 260, "episode_return_max": 13.5, "time_between_sampling": 1.5652356132670446}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "465f9_00000", "date": "2025-08-11_19-24-01", "timestamp": 1754933041, "time_this_iter_s": 1.6480557918548584, "time_total_s": 21.149526357650757, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.149526357650757, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 41.6, "ram_util_percent": 77.73333333333333}}
{"timers": {"training_iteration": 1.541472582870643, "restore_env_runners": 1.2065825935913562e-05, "training_step": 1.541323384045999, "env_runner_sampling_timer": 1.4324045896279716, "learner_update_timer": 0.10585993576872271, "synch_weights": 0.000536366375043662, "restore_eval_env_runners": 9.742004773997786e-06, "evaluation_iteration": 0.10623173213673419, "synch_eval_env_connectors": 0.00012217978696333996, "synch_env_connectors": 4.5876612191810145e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.311210942507083e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7188395283464003e-06, "add_observations_from_episodes_to_batch": 2.9028472364126247e-06, "add_time_dim_to_batch_and_zero_pad": 2.310670097751431e-06, "batch_individual_items": 6.210985921559575e-06, "numpy_to_tensor": 8.5464898134877e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.408434255823145e-06, "get_actions": 3.745937813246631e-05, "normalize_and_clip_actions": 9.395857351060701e-06, "tensor_to_numpy": 1.2820199711573551e-05, "remove_single_ts_time_rank_from_batch": 5.915462449950731e-07, "listify_data_for_vector_env": 1.0988543764836564e-05}}, "connector_pipeline_timer": 0.00010191788581677904}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "module_episode_returns_mean": {"default_policy": 5.019999999999998}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.001662981173948651, "num_env_steps_sampled_lifetime": -7400000.0, "episode_duration_sec_mean": 0.004483194970060141, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 5.019999999999998, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7401536557471716e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 13.0, "sample": 0.004795926592966802, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "agent_episode_returns_mean": {"default_agent": 5.019999999999998}, "num_episodes": 250.0, "env_reset_timer": 3.461538442761148e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -370000.0, "env_step_timer": 1.3618316709610608e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3777.105404293053}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008040910821050602, "add_columns_from_episodes_to_train_batch": 0.03349996509667781, "add_states_from_episodes_to_batch": 3.2244403783596575e-06, "add_time_dim_to_batch_and_zero_pad": 1.1810678864157145e-05, "numpy_to_tensor": 7.369846193278213e-05, "general_advantage_estimation": 0.006163823144967125, "add_one_ts_to_episodes_and_truncate": 0.008312079165533382, "batch_individual_items": 0.033251247383524515}}, "connector_pipeline_timer": 0.08223155643831334}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2435311.601063011, "num_module_steps_trained_throughput": 465672.3429075585, "num_module_steps_trained_lifetime_throughput": 464928.5956755293}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 14.0, "vf_loss_unclipped": 28.610187530517578, "policy_loss": -0.19703388214111328, "gradients_default_optimizer_global_norm": 0.035518303513526917, "num_trainable_parameters": 6003, "vf_explained_var": -0.00948035717010498, "curr_kl_coeff": 4.5562519517261535e-05, "total_loss": -0.1332673281431198, "mean_kl_loss": 0.001021185191348195, "num_module_steps_trained_lifetime": 84000, "entropy": 0.5491995215415955, "num_module_steps_trained_lifetime_throughput": 466294.72965571616}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.796293269802158e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.627471970695303e-07, "tensor_to_numpy": 1.2584732199935489e-05, "listify_data_for_vector_env": 1.078977581838234e-05, "get_actions": 3.4148279157822495e-05, "un_batch_to_individual_items": 5.336409201665703e-06, "normalize_and_clip_actions": 9.179720002784713e-06}}}, "episode_duration_sec_mean": 0.004426475844811648, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.051955677026454e-06, "add_observations_from_episodes_to_batch": 2.749368943142902e-06, "add_states_from_episodes_to_batch": 1.5277739299903342e-06, "add_time_dim_to_batch_and_zero_pad": 2.132913540259137e-06, "numpy_to_tensor": 8.211932410970704e-06}}, "connector_pipeline_timer": 4.222802777236738e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_return_mean": 0.85, "rlmodule_inference_timer": 2.6403897680929768e-05, "weights_seq_no": 14.0, "env_step_timer": 1.3623725261238908e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 70400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.09994843224632846, "env_reset_timer": 0.0001344320534106117, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes_lifetime": 280, "episode_return_max": 13.5, "time_between_sampling": 1.5651681362945344}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "465f9_00000", "date": "2025-08-11_19-24-02", "timestamp": 1754933042, "time_this_iter_s": 1.6445503234863281, "time_total_s": 22.794076681137085, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.794076681137085, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.0, "ram_util_percent": 77.45}}
{"timers": {"training_iteration": 1.5415520024623164, "restore_env_runners": 1.200308779162298e-05, "training_step": 1.541402629375746, "env_runner_sampling_timer": 1.4317643853920778, "learner_update_timer": 0.10657957725168471, "synch_weights": 0.0005362589608625817, "restore_eval_env_runners": 9.708334920643456e-06, "evaluation_iteration": 0.10618274648591375, "synch_eval_env_connectors": 0.00012203131857034618, "synch_env_connectors": 4.581364652257144e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.339208946176608e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7370612685323642e-06, "add_observations_from_episodes_to_batch": 2.9998699174846463e-06, "add_time_dim_to_batch_and_zero_pad": 2.3292496685660385e-06, "batch_individual_items": 6.2208460861062005e-06, "numpy_to_tensor": 8.505275904007315e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.444664444983495e-06, "get_actions": 3.7573981743821614e-05, "normalize_and_clip_actions": 9.453317567111331e-06, "tensor_to_numpy": 1.2770273418949495e-05, "remove_single_ts_time_rank_from_batch": 5.940420678707582e-07, "listify_data_for_vector_env": 1.0906739725392032e-05}}, "connector_pipeline_timer": 0.00010213730727422716}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "module_episode_returns_mean": {"default_policy": 4.14}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0018241158390075228, "num_env_steps_sampled_lifetime": -8017500.0, "episode_duration_sec_mean": 0.004496384953148662, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 4.14, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7088239015193534e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 14.0, "sample": 0.004794283726723942, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "agent_episode_returns_mean": {"default_agent": 4.14}, "num_episodes": 250.0, "env_reset_timer": 3.458985548884347e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -400875.0, "env_step_timer": 1.3604282781664023e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3767.3177060771272}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000804128920808439, "add_columns_from_episodes_to_train_batch": 0.03350235794607991, "add_states_from_episodes_to_batch": 3.2209459024544406e-06, "add_time_dim_to_batch_and_zero_pad": 1.178466125169355e-05, "numpy_to_tensor": 7.358689767521159e-05, "general_advantage_estimation": 0.00615518574316568, "add_one_ts_to_episodes_and_truncate": 0.008303994623932885, "batch_individual_items": 0.03409734658031001}}, "connector_pipeline_timer": 0.08306308753339497}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2435675.661954317, "num_module_steps_trained_throughput": 465667.31457337574, "num_module_steps_trained_lifetime_throughput": 464949.6539176688}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 15.0, "vf_loss_unclipped": 28.692230224609375, "policy_loss": 0.13732679188251495, "gradients_default_optimizer_global_norm": 0.1371627002954483, "num_trainable_parameters": 6003, "vf_explained_var": -0.012212872505187988, "curr_kl_coeff": 2.2781259758630767e-05, "total_loss": 0.2012055665254593, "mean_kl_loss": 0.0006800030241720378, "num_module_steps_trained_lifetime": 90000, "entropy": 0.5368001461029053, "num_module_steps_trained_lifetime_throughput": 466221.98045073287}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.721327584075108e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.559297445343359e-07, "tensor_to_numpy": 1.2537814917339625e-05, "listify_data_for_vector_env": 1.073553668485359e-05, "get_actions": 3.371460033185602e-05, "un_batch_to_individual_items": 5.269730018225645e-06, "normalize_and_clip_actions": 9.174905995941756e-06}}}, "episode_duration_sec_mean": 0.00441077294992283, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.978380612299959e-06, "add_observations_from_episodes_to_batch": 2.7777816009119725e-06, "add_states_from_episodes_to_batch": 1.5143394656508912e-06, "add_time_dim_to_batch_and_zero_pad": 2.108661465839959e-06, "numpy_to_tensor": 8.07224243588686e-06}}, "connector_pipeline_timer": 4.166051154747551e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 1.25}, "episode_return_mean": 1.25, "rlmodule_inference_timer": 2.6276335375740217e-05, "weights_seq_no": 15.0, "env_step_timer": 1.3632482865694358e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 75400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.25}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.09989839667375386, "env_reset_timer": 0.00013383690272536492, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes_lifetime": 300, "episode_return_max": 13.5, "time_between_sampling": 1.565218943262015}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "465f9_00000", "date": "2025-08-11_19-24-04", "timestamp": 1754933044, "time_this_iter_s": 1.6518709659576416, "time_total_s": 24.445947647094727, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.445947647094727, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 77.7}}
{"timers": {"training_iteration": 1.5411895932786566, "restore_env_runners": 1.1938467114436717e-05, "training_step": 1.5410399714125937, "env_runner_sampling_timer": 1.4315562190378899, "learner_update_timer": 0.10642536814914003, "synch_weights": 0.0005364838713083452, "restore_eval_env_runners": 9.682080981542964e-06, "evaluation_iteration": 0.10612192443127136, "synch_eval_env_connectors": 0.00012176225593404854, "synch_env_connectors": 4.577220706029306e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.461086960950609e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7610291280792174e-06, "add_observations_from_episodes_to_batch": 3.0269488281423717e-06, "add_time_dim_to_batch_and_zero_pad": 2.4061577371177315e-06, "batch_individual_items": 6.451560622001813e-06, "numpy_to_tensor": 8.821879484018458e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.614991961817053e-06, "get_actions": 3.917315931617645e-05, "normalize_and_clip_actions": 9.719248070471676e-06, "tensor_to_numpy": 1.3221148999900677e-05, "remove_single_ts_time_rank_from_batch": 6.169108420246183e-07, "listify_data_for_vector_env": 1.1293515016181247e-05}}, "connector_pipeline_timer": 0.0001057084701477511}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "module_episode_returns_mean": {"default_policy": 6.62}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0018579316075593632, "num_env_steps_sampled_lifetime": -8635000.0, "episode_duration_sec_mean": 0.004641357982531189, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 6.62, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.8278316279850948e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 15.0, "sample": 0.004959645286222849, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "agent_episode_returns_mean": {"default_agent": 6.62}, "num_episodes": 250.0, "env_reset_timer": 3.71962041167179e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -431750.0, "env_step_timer": 1.4161982339081097e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3640.8350508940143}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008046355418566659, "add_columns_from_episodes_to_train_batch": 0.03350348311712172, "add_states_from_episodes_to_batch": 3.215826288819024e-06, "add_time_dim_to_batch_and_zero_pad": 1.1751814122255333e-05, "numpy_to_tensor": 7.348893809594234e-05, "general_advantage_estimation": 0.006150611385941745, "add_one_ts_to_episodes_and_truncate": 0.008298253428095962, "batch_individual_items": 0.03405743520436363}}, "connector_pipeline_timer": 0.08301425915819349}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2435425.101732381, "num_module_steps_trained_throughput": 465548.8137302346, "num_module_steps_trained_lifetime_throughput": 464856.1086853533}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 16.0, "vf_loss_unclipped": 28.64261817932129, "policy_loss": 0.2098601907491684, "gradients_default_optimizer_global_norm": 0.06061369180679321, "num_trainable_parameters": 6003, "vf_explained_var": -0.011586427688598633, "curr_kl_coeff": 1.1390629879315384e-05, "total_loss": 0.2740742564201355, "mean_kl_loss": 0.0011202433379366994, "num_module_steps_trained_lifetime": 96000, "entropy": 0.4997800886631012, "num_module_steps_trained_lifetime_throughput": 466038.47093908733}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.80722898677198e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.719809871449174e-07, "tensor_to_numpy": 1.2522144261899513e-05, "listify_data_for_vector_env": 1.0805667487599243e-05, "get_actions": 3.4062656672312725e-05, "un_batch_to_individual_items": 5.351705510616853e-06, "normalize_and_clip_actions": 9.253493500620256e-06}}}, "episode_duration_sec_mean": 0.004406626721611247, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.020963702671875e-06, "add_observations_from_episodes_to_batch": 2.794967178944794e-06, "add_states_from_episodes_to_batch": 1.5465288574481203e-06, "add_time_dim_to_batch_and_zero_pad": 2.1550468495196595e-06, "numpy_to_tensor": 8.156636029662571e-06}}, "connector_pipeline_timer": 4.21147259213521e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.65}, "episode_return_mean": 0.65, "rlmodule_inference_timer": 2.6169569964170614e-05, "weights_seq_no": 16.0, "env_step_timer": 1.3732448855587935e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 80400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.09985998020629443, "env_reset_timer": 0.00013325353362628767, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes_lifetime": 320, "episode_return_max": 13.5, "time_between_sampling": 1.5648310984091678}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "465f9_00000", "date": "2025-08-11_19-24-06", "timestamp": 1754933046, "time_this_iter_s": 1.6083741188049316, "time_total_s": 26.054321765899658, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.054321765899658, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 44.333333333333336, "ram_util_percent": 77.73333333333333}}
{"timers": {"training_iteration": 1.541187776925903, "restore_env_runners": 1.1877412340293735e-05, "training_step": 1.5410379441991464, "env_runner_sampling_timer": 1.4317006635075942, "learner_update_timer": 0.10627664571713266, "synch_weights": 0.0005369727826397417, "restore_eval_env_runners": 9.659429537416693e-06, "evaluation_iteration": 0.10606749601608258, "synch_eval_env_connectors": 0.00012151713321280692, "synch_env_connectors": 4.573949404661591e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.329948425101113e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7297452953242296e-06, "add_observations_from_episodes_to_batch": 3.009305106671401e-06, "add_time_dim_to_batch_and_zero_pad": 2.3235092265783665e-06, "batch_individual_items": 6.237044353097659e-06, "numpy_to_tensor": 8.497999911767953e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.44612385617425e-06, "get_actions": 3.7506148145559896e-05, "normalize_and_clip_actions": 9.412142817658144e-06, "tensor_to_numpy": 1.2806391693537257e-05, "remove_single_ts_time_rank_from_batch": 5.900741581597892e-07, "listify_data_for_vector_env": 1.0934134674669685e-05}}, "connector_pipeline_timer": 0.00010203719126418698}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "module_episode_returns_mean": {"default_policy": 7.18}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0015032907948064245, "num_env_steps_sampled_lifetime": -9252500.0, "episode_duration_sec_mean": 0.004827453493140636, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 7.18, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.263921901122048e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 16.0, "sample": 0.005041578646788297, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "agent_episode_returns_mean": {"default_agent": 7.18}, "num_episodes": 250.0, "env_reset_timer": 3.4357107534958826e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -462625.0, "env_step_timer": 1.3633967227898175e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3756.725481883457}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008073775165478892, "add_columns_from_episodes_to_train_batch": 0.03350769287492723, "add_states_from_episodes_to_batch": 3.2124179538092135e-06, "add_time_dim_to_batch_and_zero_pad": 1.1726796103296808e-05, "numpy_to_tensor": 7.330529854689782e-05, "general_advantage_estimation": 0.006140062351593463, "add_one_ts_to_episodes_and_truncate": 0.008291702564273988, "batch_individual_items": 0.03401590793265427}}, "connector_pipeline_timer": 0.08296218073676537}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2432377.612193465, "num_module_steps_trained_throughput": 464899.8790374358, "num_module_steps_trained_lifetime_throughput": 464231.19559323683}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 17.0, "vf_loss_unclipped": 28.64337730407715, "policy_loss": 0.08273464441299438, "gradients_default_optimizer_global_norm": 0.09873435646295547, "num_trainable_parameters": 6003, "vf_explained_var": -0.01027071475982666, "curr_kl_coeff": 5.695314939657692e-06, "total_loss": 0.14732712507247925, "mean_kl_loss": 0.0014901324175298214, "num_module_steps_trained_lifetime": 102000, "entropy": 0.4579978883266449, "num_module_steps_trained_lifetime_throughput": 465327.752676135}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.717349780395345e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.103128750080787e-07, "tensor_to_numpy": 1.2457371852541253e-05, "listify_data_for_vector_env": 1.0718563191065706e-05, "get_actions": 3.385262942333624e-05, "un_batch_to_individual_items": 5.245484847206709e-06, "normalize_and_clip_actions": 9.192179153168801e-06}}}, "episode_duration_sec_mean": 0.004398932548938319, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.0050083094670265e-06, "add_observations_from_episodes_to_batch": 2.768590540046919e-06, "add_states_from_episodes_to_batch": 1.5139483130560018e-06, "add_time_dim_to_batch_and_zero_pad": 2.1256780703204424e-06, "numpy_to_tensor": 8.099457365976187e-06}}, "connector_pipeline_timer": 4.176645242304696e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_return_mean": 0.85, "rlmodule_inference_timer": 2.618176946086106e-05, "weights_seq_no": 17.0, "env_step_timer": 1.3417621629367614e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 85400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.09981079623419546, "env_reset_timer": 0.00013258099865897754, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes_lifetime": 340, "episode_return_max": 13.5, "time_between_sampling": 1.5647614549255981}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "465f9_00000", "date": "2025-08-11_19-24-07", "timestamp": 1754933047, "time_this_iter_s": 1.642976999282837, "time_total_s": 27.697298765182495, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.697298765182495, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 40.25, "ram_util_percent": 77.5}}
{"timers": {"training_iteration": 1.541218576237508, "restore_env_runners": 1.1819887810163603e-05, "training_step": 1.5410685501662322, "env_runner_sampling_timer": 1.4310210127028058, "learner_update_timer": 0.10698664426031211, "synch_weights": 0.000536923884618331, "restore_eval_env_runners": 9.66325509865044e-06, "evaluation_iteration": 0.10600246813546589, "synch_eval_env_connectors": 0.0001214369623740563, "synch_env_connectors": 4.567789955882914e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.32191270365858e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7199982436716962e-06, "add_observations_from_episodes_to_batch": 2.9234952441981576e-06, "add_time_dim_to_batch_and_zero_pad": 2.321557128566721e-06, "batch_individual_items": 6.248269327662902e-06, "numpy_to_tensor": 8.51736734654552e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.393311123057378e-06, "get_actions": 3.758876798526803e-05, "normalize_and_clip_actions": 9.397114952241155e-06, "tensor_to_numpy": 1.2758686885992492e-05, "remove_single_ts_time_rank_from_batch": 5.87754708311411e-07, "listify_data_for_vector_env": 1.0922377931904794e-05}}, "connector_pipeline_timer": 0.00010186379900775111}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0014732535096136463, "num_env_steps_sampled_lifetime": -9870000.0, "episode_duration_sec_mean": 0.0044898898769170055, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 6.700000000000004, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.749431401163995e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 17.0, "sample": 0.004928556486627203, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "num_episodes": 250.0, "env_reset_timer": 3.547214015940156e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -493500.0, "env_step_timer": 1.3654673087547266e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3766.082632078338}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008075787415280691, "add_columns_from_episodes_to_train_batch": 0.03351413719626199, "add_states_from_episodes_to_batch": 3.214463999533763e-06, "add_time_dim_to_batch_and_zero_pad": 1.1721608157505939e-05, "numpy_to_tensor": 7.322599559175271e-05, "general_advantage_estimation": 0.006129859638293234, "add_one_ts_to_episodes_and_truncate": 0.008282945118448454, "batch_individual_items": 0.034844005943357965}}, "connector_pipeline_timer": 0.08377777225886378}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2430118.2410276863, "num_module_steps_trained_throughput": 464405.1748009444, "num_module_steps_trained_lifetime_throughput": 463758.90660205105}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 18.0, "vf_loss_unclipped": 28.636436462402344, "policy_loss": -0.11194947361946106, "gradients_default_optimizer_global_norm": 0.05914563685655594, "num_trainable_parameters": 6003, "vf_explained_var": -0.008368968963623047, "curr_kl_coeff": 2.847657469828846e-06, "total_loss": -0.04717446491122246, "mean_kl_loss": 0.00018082500901073217, "num_module_steps_trained_lifetime": 108000, "entropy": 0.43784546852111816, "num_module_steps_trained_lifetime_throughput": 464773.864341513}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.935159859966699e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.204883720916973e-07, "tensor_to_numpy": 1.2697128513281082e-05, "listify_data_for_vector_env": 1.0956448757656904e-05, "get_actions": 3.488636097396392e-05, "un_batch_to_individual_items": 5.383098406205392e-06, "normalize_and_clip_actions": 9.275529203469061e-06}}}, "episode_duration_sec_mean": 0.004543538810685277, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.091606872920201e-06, "add_observations_from_episodes_to_batch": 2.7605276148192893e-06, "add_states_from_episodes_to_batch": 1.5451232718794682e-06, "add_time_dim_to_batch_and_zero_pad": 2.195408041679498e-06, "numpy_to_tensor": 8.28937759825947e-06}}, "connector_pipeline_timer": 4.2331172198825706e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_return_mean": 0.25, "rlmodule_inference_timer": 2.679056621569929e-05, "weights_seq_no": 18.0, "env_step_timer": 1.3736400190098437e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 90400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.09993311494180317, "env_reset_timer": 0.0001320426882659586, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes_lifetime": 360, "episode_return_max": 13.5, "time_between_sampling": 1.5647226349560903}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "465f9_00000", "date": "2025-08-11_19-24-09", "timestamp": 1754933049, "time_this_iter_s": 1.6636731624603271, "time_total_s": 29.360971927642822, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.360971927642822, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 42.150000000000006, "ram_util_percent": 77.65}}
{"timers": {"training_iteration": 1.5411860058953757, "restore_env_runners": 1.1759609047130522e-05, "training_step": 1.541035548004909, "env_runner_sampling_timer": 1.4302888588253124, "learner_update_timer": 0.10768423739698677, "synch_weights": 0.0005373217350869064, "restore_eval_env_runners": 9.642451995842346e-06, "evaluation_iteration": 0.1061116847041382, "synch_eval_env_connectors": 0.00012119801344883925, "synch_env_connectors": 4.563772443393072e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.317559812821124e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7265066081168998e-06, "add_observations_from_episodes_to_batch": 2.9417706668457764e-06, "add_time_dim_to_batch_and_zero_pad": 2.3127668740786805e-06, "batch_individual_items": 6.220804206571157e-06, "numpy_to_tensor": 8.48258484022857e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.421991159717185e-06, "get_actions": 3.708449643923506e-05, "normalize_and_clip_actions": 9.428230535322855e-06, "tensor_to_numpy": 1.2694980475694149e-05, "remove_single_ts_time_rank_from_batch": 5.886811744130727e-07, "listify_data_for_vector_env": 1.0914343034671983e-05}}, "connector_pipeline_timer": 0.00010136036083667165}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "module_episode_returns_mean": {"default_policy": 7.659999999999997}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.001843347492928887, "num_env_steps_sampled_lifetime": -10487500.0, "episode_duration_sec_mean": 0.004477845613379031, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 7.659999999999997, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7472155270249522e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 18.0, "sample": 0.004797515704456315, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "agent_episode_returns_mean": {"default_agent": 7.659999999999997}, "num_episodes": 250.0, "env_reset_timer": 3.393138679439263e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -524375.0, "env_step_timer": 1.3613974331707891e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3785.167285753526}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008076292045809828, "add_columns_from_episodes_to_train_batch": 0.03352119832404106, "add_states_from_episodes_to_batch": 3.2114895467286004e-06, "add_time_dim_to_batch_and_zero_pad": 1.1700641935710952e-05, "numpy_to_tensor": 7.312665547262455e-05, "general_advantage_estimation": 0.006120634381376307, "add_one_ts_to_episodes_and_truncate": 0.00827565608763042, "batch_individual_items": 0.03565907297387453}}, "connector_pipeline_timer": 0.08458310370652945}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2429000.618491127, "num_module_steps_trained_throughput": 464129.9942402264, "num_module_steps_trained_lifetime_throughput": 463505.31760492455}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 19.0, "vf_loss_unclipped": 28.636056900024414, "policy_loss": 0.09650514274835587, "gradients_default_optimizer_global_norm": 0.0536673404276371, "num_trainable_parameters": 6003, "vf_explained_var": -0.009635567665100098, "curr_kl_coeff": 1.423828734914423e-06, "total_loss": 0.16122514009475708, "mean_kl_loss": 1.3710978237213567e-05, "num_module_steps_trained_lifetime": 114000, "entropy": 0.44391682744026184, "num_module_steps_trained_lifetime_throughput": 464441.57755595585}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.742527339802527e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.588437020247973e-07, "tensor_to_numpy": 1.2469939631622807e-05, "listify_data_for_vector_env": 1.0791063371160952e-05, "get_actions": 3.377328526499952e-05, "un_batch_to_individual_items": 5.34145152780656e-06, "normalize_and_clip_actions": 9.172225539997619e-06}}}, "episode_duration_sec_mean": 0.004536598424892873, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.997987856319978e-06, "add_observations_from_episodes_to_batch": 2.7674177349771513e-06, "add_states_from_episodes_to_batch": 1.5543757813263186e-06, "add_time_dim_to_batch_and_zero_pad": 2.1608252385515302e-06, "numpy_to_tensor": 8.067985333092436e-06}}, "connector_pipeline_timer": 4.219791141015948e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.95}, "episode_return_mean": -0.95, "rlmodule_inference_timer": 2.6008113043208514e-05, "weights_seq_no": 19.0, "env_step_timer": 1.364416551044504e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 95400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.95}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.09989159379220312, "env_reset_timer": 0.0001314380910481403, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes_lifetime": 380, "episode_return_max": 13.5, "time_between_sampling": 1.5646186215262583}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "465f9_00000", "date": "2025-08-11_19-24-11", "timestamp": 1754933051, "time_this_iter_s": 1.6411120891571045, "time_total_s": 31.002084016799927, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.002084016799927, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 41.333333333333336, "ram_util_percent": 77.6}}
{"timers": {"training_iteration": 1.5406269445863476, "restore_env_runners": 1.1693682733098883e-05, "training_step": 1.540476394195104, "env_runner_sampling_timer": 1.4298808273167811, "learner_update_timer": 0.10753228544388217, "synch_weights": 0.0005377276874687421, "restore_eval_env_runners": 9.62144830628272e-06, "evaluation_iteration": 0.10605733785719137, "synch_eval_env_connectors": 0.00012108394272204102, "synch_env_connectors": 4.558555282850671e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.369251509932479e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.735519434882079e-06, "add_observations_from_episodes_to_batch": 2.980254898636241e-06, "add_time_dim_to_batch_and_zero_pad": 2.3659282778502416e-06, "batch_individual_items": 6.3064847405039895e-06, "numpy_to_tensor": 8.630101804459165e-06}}}, "episode_len_mean": 20.0, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.491590941981929e-06, "get_actions": 3.822486102793844e-05, "normalize_and_clip_actions": 9.548618699601286e-06, "tensor_to_numpy": 1.2905184631446383e-05, "remove_single_ts_time_rank_from_batch": 5.871101298300382e-07, "listify_data_for_vector_env": 1.1036655427744983e-05}}, "connector_pipeline_timer": 0.00010323601677702714}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "module_episode_returns_mean": {"default_policy": 6.2200000000000015}, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0018269404910313996, "num_env_steps_sampled_lifetime": -11105000.0, "episode_duration_sec_mean": 0.004540557654108853, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -10.5, "episode_return_mean": 6.2200000000000015, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.758274771004485e-05, "num_env_steps_sampled": 5000.0, "episode_len_min": 20, "weights_seq_no": 19.0, "sample": 0.004838371406020949, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "agent_episode_returns_mean": {"default_agent": 6.2200000000000015}, "num_episodes": 250.0, "env_reset_timer": 3.632576640741105e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -555250.0, "env_step_timer": 1.3890140157291595e-05, "episode_return_max": 9.5, "num_env_steps_sampled_lifetime_throughput": 3715.945888165585}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008078679118212583, "add_columns_from_episodes_to_train_batch": 0.03352954884158483, "add_states_from_episodes_to_batch": 3.2197940509996262e-06, "add_time_dim_to_batch_and_zero_pad": 1.1781135273986455e-05, "numpy_to_tensor": 7.303913887207723e-05, "general_advantage_estimation": 0.0061134272077578555, "add_one_ts_to_episodes_and_truncate": 0.008273167437134032, "batch_individual_items": 0.03560762349427302}}, "connector_pipeline_timer": 0.08453054433841797}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 2427495.3720757095, "num_module_steps_trained_throughput": 463783.79393574846, "num_module_steps_trained_lifetime_throughput": 463179.90965609724}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 20.0, "vf_loss_unclipped": 28.659807205200195, "policy_loss": 0.16226932406425476, "gradients_default_optimizer_global_norm": 0.05579276755452156, "num_trainable_parameters": 6003, "vf_explained_var": -0.01161646842956543, "curr_kl_coeff": 7.119143674572115e-07, "total_loss": 0.2269459366798401, "mean_kl_loss": 2.8233316697878763e-05, "num_module_steps_trained_lifetime": 120000, "entropy": 0.4487060010433197, "num_module_steps_trained_lifetime_throughput": 464039.1004675365}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001001360781912025, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.832058843578007e-07, "tensor_to_numpy": 1.2927395283798076e-05, "listify_data_for_vector_env": 1.099869836265608e-05, "get_actions": 3.5284617342326086e-05, "un_batch_to_individual_items": 5.415395655823735e-06, "normalize_and_clip_actions": 9.368326696829576e-06}}}, "episode_duration_sec_mean": 0.004579172993544489, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.129460185157498e-06, "add_observations_from_episodes_to_batch": 2.79712447174822e-06, "add_states_from_episodes_to_batch": 1.5364298946510274e-06, "add_time_dim_to_batch_and_zero_pad": 2.178836344363882e-06, "numpy_to_tensor": 8.309423696393794e-06}}, "connector_pipeline_timer": 4.2526169176046164e-05}, "episode_len_min": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.15}, "episode_return_mean": -1.15, "rlmodule_inference_timer": 2.7105743866008994e-05, "weights_seq_no": 20.0, "env_step_timer": 1.393369398494227e-05, "episode_len_mean": 20.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 100400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -1.15}, "episode_return_min": -14.5, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.0998945295247251, "env_reset_timer": 0.00013129579007519144, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes_lifetime": 400, "episode_return_max": 13.5, "time_between_sampling": 1.564006922811084}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "465f9_00000", "date": "2025-08-11_19-24-12", "timestamp": 1754933052, "time_this_iter_s": 1.5932440757751465, "time_total_s": 32.59532809257507, "pid": 14462, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14c5f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.59532809257507, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 40.900000000000006, "ram_util_percent": 77.0}}
