{"timers": {"training_iteration": 1.8937693749321625, "restore_env_runners": 1.3875076547265053e-05, "training_step": 1.8936228749807924, "env_runner_sampling_timer": 1.7767933750292286, "learner_update_timer": 0.11379404203034937, "synch_weights": 0.000560375046916306}, "env_runners": {"rlmodule_inference_timer": 6.936850736248204e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_to_module_connector": {"connector_pipeline_timer": 5.447827503600165e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.655539098651242e-06, "numpy_to_tensor": 1.1237509583724052e-05, "add_states_from_episodes_to_batch": 1.9585313569053425e-06, "add_time_dim_to_batch_and_zero_pad": 3.0152351970324787e-06, "batch_individual_items": 7.76851607939329e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.603084868737389e-07, "listify_data_for_vector_env": 1.3688890605939554e-05, "un_batch_to_individual_items": 6.560363968287577e-06, "get_actions": 6.307039259250689e-05, "normalize_and_clip_actions": 1.9996309406339057e-05, "tensor_to_numpy": 1.680851222408785e-05}}, "connector_pipeline_timer": 0.00015134184347257996}, "episode_len_max": 20, "episode_return_mean": -0.14000000000000007, "sample": 0.007817557009499019, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime": 627500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.855643150556238e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 0.0, "env_reset_timer": 0.00014777988565285074, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "time_between_sampling": 0.0006173997869334895, "episode_duration_sec_mean": 0.005972434015478939, "num_env_steps_sampled_lifetime_throughput": 2867.568447812393}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008875420317053795, "general_advantage_estimation": 0.006940542021766305, "add_time_dim_to_batch_and_zero_pad": 1.300009898841381e-05, "batch_individual_items": 0.0317558340029791, "numpy_to_tensor": 7.537507917732e-05, "add_states_from_episodes_to_batch": 3.708992153406143e-06, "add_one_ts_to_episodes_and_truncate": 0.007479083025828004, "add_columns_from_episodes_to_train_batch": 0.0365598329808563}}, "connector_pipeline_timer": 0.08386066695675254}, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5250, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1926249.8615878387, "num_module_steps_trained_throughput": 368785.6813024673, "num_module_steps_trained_lifetime_throughput": 368104.9054915794}, "default_policy": {"total_loss": 0.12644556164741516, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.025468185544013977, "num_module_steps_trained_lifetime": 6000, "vf_loss_unclipped": 28.37276268005371, "vf_loss": 0.10278083384037018, "policy_loss": 0.06390514224767685, "vf_explained_var": -0.011374115943908691, "curr_kl_coeff": 0.3732481598854065, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6931197643280029, "mean_kl_loss": 0.00010375812416896224, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 369746.9497649743}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.491438102645473e-05, "remove_single_ts_time_rank_from_batch": 5.860225117489788e-07, "un_batch_to_individual_items": 5.435349533007111e-06, "get_actions": 4.1853415451555686e-05, "normalize_and_clip_actions": 1.092010718385396e-05, "listify_data_for_vector_env": 1.1378689436996202e-05}}, "connector_pipeline_timer": 0.00011117629076861242}, "num_env_steps_sampled_lifetime": 5400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.65, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4160404801705722e-06, "batch_individual_items": 6.607722662761661e-06, "add_states_from_episodes_to_batch": 1.6469887022092777e-06, "numpy_to_tensor": 8.664551910665477e-06, "add_observations_from_episodes_to_batch": 3.0925333094897494e-06}}, "connector_pipeline_timer": 4.522204892429163e-05}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10293904191348702, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004708170861704275, "episode_return_max": 12.5, "num_episodes_lifetime": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_step_timer": 1.4868344077157048e-05, "agent_episode_returns_mean": {"default_agent": 1.65}, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": 1.65}, "env_reset_timer": 0.0001976670464500785, "rlmodule_inference_timer": 3.185479808793325e-05}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-19", "timestamp": 1754932939, "time_this_iter_s": 2.0051472187042236, "time_total_s": 2.0051472187042236, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.0051472187042236, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.433333333333334, "ram_util_percent": 78.60000000000001}}
{"timers": {"training_iteration": 1.891132785353111, "restore_env_runners": 1.3798405416309833e-05, "training_step": 1.8909860337316058, "env_runner_sampling_timer": 1.77339969794848, "learner_update_timer": 0.11454953119973653, "synch_weights": 0.0005603246262762696, "restore_eval_env_runners": 7.459078915417194e-06, "evaluation_iteration": 0.10974600003100932, "synch_eval_env_connectors": 0.00011550006456673145, "synch_env_connectors": 4.458008334040642e-06}, "env_runners": {"rlmodule_inference_timer": 2.9459385331351998e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.471672378194875e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9939740844455347e-06, "numpy_to_tensor": 8.915313624687378e-06, "add_states_from_episodes_to_batch": 1.7614885470988973e-06, "add_time_dim_to_batch_and_zero_pad": 2.468388247335428e-06, "batch_individual_items": 6.463842253025815e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.871307446695422e-07, "listify_data_for_vector_env": 1.1521726802239344e-05, "un_batch_to_individual_items": 5.5258861901700884e-06, "get_actions": 4.225294317574921e-05, "normalize_and_clip_actions": 9.82623413434954e-06, "tensor_to_numpy": 1.3724629228155726e-05}}, "connector_pipeline_timer": 0.00010962513247130909}, "episode_len_max": 20, "episode_return_mean": 1.6200000000000008, "sample": 0.0058344000722794056, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "agent_episode_returns_mean": {"default_agent": 1.6200000000000008}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 1.6200000000000008}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.4396255389908463e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 1.0, "env_reset_timer": 5.125161735582966e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.001568962658232273, "episode_duration_sec_mean": 0.004732774014584719, "num_env_steps_sampled_lifetime_throughput": 3548.005937604263}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008865153614897281, "general_advantage_estimation": 0.006925037431064993, "add_time_dim_to_batch_and_zero_pad": 1.2999678729102015e-05, "batch_individual_items": 0.03267099441261962, "numpy_to_tensor": 7.524965913034974e-05, "add_states_from_episodes_to_batch": 3.706072457134724e-06, "add_one_ts_to_episodes_and_truncate": 0.007477108855964616, "add_columns_from_episodes_to_train_batch": 0.03653589465189725}}, "connector_pipeline_timer": 0.08473280528676695}, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 63000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1921094.0268525928, "num_module_steps_trained_throughput": 367781.18594658724, "num_module_steps_trained_lifetime_throughput": 367107.66245156}, "default_policy": {"total_loss": 0.03462845832109451, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.01637868583202362, "num_module_steps_trained_lifetime": 12000, "vf_loss_unclipped": 28.881858825683594, "vf_loss": 0.10278083384037018, "policy_loss": -0.027911582961678505, "vf_explained_var": -0.0108109712600708, "curr_kl_coeff": 0.18662407994270325, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6929256319999695, "mean_kl_loss": 0.00020176632096990943, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 368724.7514636044}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.388882215875633e-05, "remove_single_ts_time_rank_from_batch": 6.0039356468915e-07, "un_batch_to_individual_items": 5.407891431987973e-06, "get_actions": 3.858809888937957e-05, "normalize_and_clip_actions": 9.65187267133493e-06, "listify_data_for_vector_env": 1.13122479637154e-05}}, "connector_pipeline_timer": 0.0001058102786234665}, "num_env_steps_sampled_lifetime": 10400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.15, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.294569930114922e-06, "batch_individual_items": 6.342062110164126e-06, "add_states_from_episodes_to_batch": 1.603685093118144e-06, "numpy_to_tensor": 8.853697569154785e-06, "add_observations_from_episodes_to_batch": 2.870785646035026e-06}}, "connector_pipeline_timer": 4.3740664925014433e-05}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10295177316409536, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0047296093020122495, "episode_return_max": 13.5, "num_episodes_lifetime": 40, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_env_steps_sampled": 400, "env_step_timer": 1.483651137160588e-05, "agent_episode_returns_mean": {"default_agent": 0.15}, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": 0.15}, "env_reset_timer": 0.0001965503755491227, "rlmodule_inference_timer": 2.8714512072325335e-05, "time_between_sampling": 1.6563949160045013}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-21", "timestamp": 1754932941, "time_this_iter_s": 1.7418711185455322, "time_total_s": 3.747018337249756, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.747018337249756, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.76666666666667, "ram_util_percent": 78.93333333333334}}
{"timers": {"training_iteration": 1.888485859169194, "restore_env_runners": 1.3717921217903493e-05, "training_step": 1.8883387858942848, "env_runner_sampling_timer": 1.7709753176292289, "learner_update_timer": 0.11432654713798547, "synch_weights": 0.0005601326295989566, "restore_eval_env_runners": 7.48115824535489e-06, "evaluation_iteration": 0.10974630920100026, "synch_eval_env_connectors": 0.00011550256400369107, "synch_env_connectors": 4.4563482515513895e-06}, "env_runners": {"rlmodule_inference_timer": 3.159451569852751e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.694225001651658e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.179208020520285e-06, "numpy_to_tensor": 9.578833435904101e-06, "add_states_from_episodes_to_batch": 1.8446024775138308e-06, "add_time_dim_to_batch_and_zero_pad": 2.6325819003052563e-06, "batch_individual_items": 6.849782084695619e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.042368158459214e-07, "listify_data_for_vector_env": 1.2245272544406738e-05, "un_batch_to_individual_items": 5.966969628611395e-06, "get_actions": 4.598917476418988e-05, "normalize_and_clip_actions": 1.0365521011222924e-05, "tensor_to_numpy": 1.477577196924643e-05}}, "connector_pipeline_timer": 0.00011729652881426679}, "episode_len_max": 20, "episode_return_mean": 0.3400000000000001, "sample": 0.005431742841601123, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime": -607500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.5589186507959412e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 2.0, "env_reset_timer": 4.3114014269495735e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.001928866820514152, "episode_duration_sec_mean": 0.005065737173426896, "num_env_steps_sampled_lifetime_throughput": 3374.0503998044737}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008859322872362098, "general_advantage_estimation": 0.0069075716466410085, "add_time_dim_to_batch_and_zero_pad": 1.297051158035174e-05, "batch_individual_items": 0.03264674905797001, "numpy_to_tensor": 7.504508289275689e-05, "add_states_from_episodes_to_batch": 3.694432182237506e-06, "add_one_ts_to_episodes_and_truncate": 0.007479533597349655, "add_columns_from_episodes_to_train_batch": 0.03651741737578996}}, "connector_pipeline_timer": 0.08467362098371375}, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 94500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1921806.5570888056, "num_module_steps_trained_throughput": 367880.9581378555, "num_module_steps_trained_lifetime_throughput": 367218.28442981164}, "default_policy": {"total_loss": 6.134508294053376e-05, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.05247271806001663, "num_module_steps_trained_lifetime": 18000, "vf_loss_unclipped": 28.72089958190918, "vf_loss": 0.10278083384037018, "policy_loss": -0.06263282895088196, "vf_explained_var": -0.011661171913146973, "curr_kl_coeff": 0.09331203997135162, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6904634833335876, "mean_kl_loss": 0.0011100023984909058, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 368788.10441436653}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2842753371341658e-05, "remove_single_ts_time_rank_from_batch": 5.705407432839276e-07, "un_batch_to_individual_items": 5.227342027992778e-06, "get_actions": 3.5739850236436064e-05, "normalize_and_clip_actions": 9.231648675758348e-06, "listify_data_for_vector_env": 1.0896516704494712e-05}}, "connector_pipeline_timer": 9.986546180794175e-05}, "num_env_steps_sampled_lifetime": 15400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.016666666666666666, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.229306155447034e-06, "batch_individual_items": 6.17383790035592e-06, "add_states_from_episodes_to_batch": 1.6352151723911674e-06, "numpy_to_tensor": 8.202649502608296e-06, "add_observations_from_episodes_to_batch": 2.7941957173952183e-06}}, "connector_pipeline_timer": 4.233053512790096e-05}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10289345460290789, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0046389340015593914, "episode_return_max": 13.5, "num_episodes_lifetime": 60, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_env_steps_sampled": 400, "env_step_timer": 1.3929491666012846e-05, "agent_episode_returns_mean": {"default_agent": -0.016666666666666666}, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": -0.016666666666666666}, "env_reset_timer": 0.00019539820161880927, "rlmodule_inference_timer": 2.7466809573693962e-05, "time_between_sampling": 1.656266866014339}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-23", "timestamp": 1754932943, "time_this_iter_s": 1.7301771640777588, "time_total_s": 5.477195501327515, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.477195501327515, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.45, "ram_util_percent": 79.1}}
{"timers": {"training_iteration": 1.8858430609978383, "restore_env_runners": 1.364574133651331e-05, "training_step": 1.8856955151253976, "env_runner_sampling_timer": 1.7685596619530914, "learner_update_timer": 0.114098835826625, "synch_weights": 0.0005600633838434005, "restore_eval_env_runners": 7.484256452880799e-06, "evaluation_iteration": 0.10966600027895765, "synch_eval_env_connectors": 0.00011529128827387467, "synch_env_connectors": 4.453445156104862e-06}, "env_runners": {"rlmodule_inference_timer": 2.9144314331531755e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.493046303316855e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0633898732438457e-06, "numpy_to_tensor": 9.131659235890745e-06, "add_states_from_episodes_to_batch": 1.7739960402872595e-06, "add_time_dim_to_batch_and_zero_pad": 2.491368312212075e-06, "batch_individual_items": 6.403239906322537e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.932921835057543e-07, "listify_data_for_vector_env": 1.2081155118422542e-05, "un_batch_to_individual_items": 5.455688953429899e-06, "get_actions": 4.3975755057417575e-05, "normalize_and_clip_actions": 9.671867063990516e-06, "tensor_to_numpy": 1.360492445512429e-05}}, "connector_pipeline_timer": 0.00011148759012779284}, "episode_len_max": 20, "episode_return_mean": 1.94, "sample": 0.005215929150840092, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "agent_episode_returns_mean": {"default_agent": 1.94}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 1.94}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime": -1225000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.4317368374167387e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 3.0, "env_reset_timer": 3.749721720492476e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.001808344912888562, "episode_duration_sec_mean": 0.004791494139935822, "num_env_steps_sampled_lifetime_throughput": 3671.359005013539}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000885303794208099, "general_advantage_estimation": 0.006891984269937733, "add_time_dim_to_batch_and_zero_pad": 1.2982466448913329e-05, "batch_individual_items": 0.03262065781733324, "numpy_to_tensor": 7.491380208695772e-05, "add_states_from_episodes_to_batch": 3.7074870769865814e-06, "add_one_ts_to_episodes_and_truncate": 0.007482931591349305, "add_columns_from_episodes_to_train_batch": 0.036495757361353846}}, "connector_pipeline_timer": 0.08461250227395456}, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 126000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1928501.970384106, "num_module_steps_trained_throughput": 369110.3498135116, "num_module_steps_trained_lifetime_throughput": 368461.25284418627}, "default_policy": {"total_loss": 0.0583021305501461, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.08418809622526169, "num_module_steps_trained_lifetime": 24000, "vf_loss_unclipped": 28.880634307861328, "vf_loss": 0.10278083384037018, "policy_loss": -0.004411409143358469, "vf_explained_var": -0.011780023574829102, "curr_kl_coeff": 0.04665601998567581, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6837658882141113, "mean_kl_loss": 0.0017774610314518213, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 369968.95406780427}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.333142463061461e-05, "remove_single_ts_time_rank_from_batch": 5.871261034405204e-07, "un_batch_to_individual_items": 5.354178429745236e-06, "get_actions": 3.7476832625170543e-05, "normalize_and_clip_actions": 9.639313555706055e-06, "listify_data_for_vector_env": 1.1123810914288467e-05}}, "connector_pipeline_timer": 0.00010319903449833733}, "num_env_steps_sampled_lifetime": 20400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.15, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.281231519030325e-06, "batch_individual_items": 6.269681498000243e-06, "add_states_from_episodes_to_batch": 1.6015491041769963e-06, "numpy_to_tensor": 8.570389631323766e-06, "add_observations_from_episodes_to_batch": 2.8923342846971883e-06}}, "connector_pipeline_timer": 4.315205853522581e-05}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1028622683864158, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004617907240753993, "episode_return_max": 13.5, "num_episodes_lifetime": 80, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_env_steps_sampled": 400, "env_step_timer": 1.4763329697925535e-05, "agent_episode_returns_mean": {"default_agent": 0.15}, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": 0.15}, "env_reset_timer": 0.0001942767195388442, "rlmodule_inference_timer": 2.8205964896780794e-05, "time_between_sampling": 1.6561366169341372}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-25", "timestamp": 1754932945, "time_this_iter_s": 1.7310540676116943, "time_total_s": 7.208249568939209, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.208249568939209, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.166666666666664, "ram_util_percent": 78.26666666666667}}
{"timers": {"training_iteration": 1.8840151103878175, "restore_env_runners": 1.3564283177792094e-05, "training_step": 1.8838672516438366, "env_runner_sampling_timer": 1.7669479070026917, "learner_update_timer": 0.11387910913865949, "synch_weights": 0.0005623265002205862, "restore_eval_env_runners": 7.504833706887438e-06, "evaluation_iteration": 0.10961662152652571, "synch_eval_env_connectors": 0.00011513962515711318, "synch_env_connectors": 4.453490787884221e-06}, "env_runners": {"rlmodule_inference_timer": 5.0890777701208976e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.649719444041075e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0862992211245965e-06, "numpy_to_tensor": 9.356765833380292e-06, "add_states_from_episodes_to_batch": 1.847462173578572e-06, "add_time_dim_to_batch_and_zero_pad": 2.5989931017585424e-06, "batch_individual_items": 6.690209744946105e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.045203000002296e-07, "listify_data_for_vector_env": 1.2095638808861323e-05, "un_batch_to_individual_items": 5.70290333336463e-06, "get_actions": 4.4654571657878406e-05, "normalize_and_clip_actions": 1.0207020555362763e-05, "tensor_to_numpy": 1.4218764392980963e-05}}, "connector_pipeline_timer": 0.00011436787718939947}, "episode_len_max": 20, "episode_return_mean": 3.7, "sample": 0.005259920911133308, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 3.7}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime": -1842500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.5109642194339748e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 4.0, "env_reset_timer": 4.074887361486836e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0016335869022905678, "episode_duration_sec_mean": 0.005347445663996039, "num_env_steps_sampled_lifetime_throughput": 3424.4922745848853}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008850345061433069, "general_advantage_estimation": 0.006874326517220985, "add_time_dim_to_batch_and_zero_pad": 1.2958481938416372e-05, "batch_individual_items": 0.032592021239562535, "numpy_to_tensor": 7.476341367761486e-05, "add_states_from_episodes_to_batch": 3.702492776452564e-06, "add_one_ts_to_episodes_and_truncate": 0.007483504365296103, "add_columns_from_episodes_to_train_batch": 0.036478090618426995}}, "connector_pipeline_timer": 0.08454831934146742}, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 157500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1935943.8472514995, "num_module_steps_trained_throughput": 370475.84362112626, "num_module_steps_trained_lifetime_throughput": 369842.31194934266}, "default_policy": {"total_loss": 0.23743394017219543, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.03668160364031792, "num_module_steps_trained_lifetime": 30000, "vf_loss_unclipped": 28.88611602783203, "vf_loss": 0.10278083384037018, "policy_loss": 0.17475159466266632, "vf_explained_var": -0.012585759162902832, "curr_kl_coeff": 0.023328009992837906, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6739362478256226, "mean_kl_loss": 0.0009778609964996576, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 371281.9673384389}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.563252044568571e-05, "remove_single_ts_time_rank_from_batch": 6.411854960371925e-07, "un_batch_to_individual_items": 5.876228682429519e-06, "get_actions": 4.7549661647664244e-05, "normalize_and_clip_actions": 1.1249632927221267e-05, "listify_data_for_vector_env": 1.306036412859995e-05}}, "connector_pipeline_timer": 0.00012302399516675281}, "num_env_steps_sampled_lifetime": 25400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.15, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4136158136849495e-06, "batch_individual_items": 6.635714228133574e-06, "add_states_from_episodes_to_batch": 1.6591893583562767e-06, "numpy_to_tensor": 9.807467065854788e-06, "add_observations_from_episodes_to_batch": 2.996998399000593e-06}}, "connector_pipeline_timer": 4.6264910053263165e-05}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10291016654225771, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004673865812364965, "episode_return_max": 13.5, "num_episodes_lifetime": 100, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_env_steps_sampled": 400, "env_step_timer": 1.7677328855588764e-05, "agent_episode_returns_mean": {"default_agent": -0.15}, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": -0.15}, "env_reset_timer": 0.0001931568619854667, "rlmodule_inference_timer": 3.3238534796628554e-05, "time_between_sampling": 1.6568122057653492}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-27", "timestamp": 1754932947, "time_this_iter_s": 1.817798137664795, "time_total_s": 9.026047706604004, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.026047706604004, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.6, "ram_util_percent": 78.75}}
{"timers": {"training_iteration": 1.8818764322047705, "restore_env_runners": 1.3486141365924149e-05, "training_step": 1.8817280832974994, "env_runner_sampling_timer": 1.7640046071026214, "learner_update_timer": 0.11467686054731618, "synch_weights": 0.0005646232349892005, "restore_eval_env_runners": 7.489785826688166e-06, "evaluation_iteration": 0.10964743781110578, "synch_eval_env_connectors": 0.00011494072975550428, "synch_env_connectors": 4.449785061676521e-06}, "env_runners": {"rlmodule_inference_timer": 3.0254033964980102e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.541466569942933e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0554790722008947e-06, "numpy_to_tensor": 9.12043914673362e-06, "add_states_from_episodes_to_batch": 1.7807022498344113e-06, "add_time_dim_to_batch_and_zero_pad": 2.5417473950363168e-06, "batch_individual_items": 6.521661026965563e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.927255890704011e-07, "listify_data_for_vector_env": 1.1693806453300354e-05, "un_batch_to_individual_items": 5.562972165293197e-06, "get_actions": 4.357060052848826e-05, "normalize_and_clip_actions": 9.92260162248566e-06, "tensor_to_numpy": 1.3978288921649305e-05}}, "connector_pipeline_timer": 0.00011170195880289683}, "episode_len_max": 20, "episode_return_mean": 3.06, "sample": 0.005501473358255884, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "agent_episode_returns_mean": {"default_agent": 3.06}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 3.06}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime": -2460000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.4775386990838758e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 5.0, "env_reset_timer": 4.295665088885483e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.001594885426824221, "episode_duration_sec_mean": 0.004838616847526282, "num_env_steps_sampled_lifetime_throughput": 3501.701840924035}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008846733304950976, "general_advantage_estimation": 0.006865332831571533, "add_time_dim_to_batch_and_zero_pad": 1.2962646682279174e-05, "batch_individual_items": 0.03353818144791618, "numpy_to_tensor": 7.473660924375246e-05, "add_states_from_episodes_to_batch": 3.7004681151953064e-06, "add_one_ts_to_episodes_and_truncate": 0.007485836401659948, "add_columns_from_episodes_to_train_batch": 0.03646030346150549}}, "connector_pipeline_timer": 0.08546942280799456}, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 189000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1940058.2042661547, "num_module_steps_trained_throughput": 371203.35029033874, "num_module_steps_trained_lifetime_throughput": 370587.7182717833}, "default_policy": {"total_loss": -0.0718490481376648, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.07187046110630035, "num_module_steps_trained_lifetime": 36000, "vf_loss_unclipped": 29.362754821777344, "vf_loss": 0.10278083384037018, "policy_loss": -0.1344889998435974, "vf_explained_var": -0.011776924133300781, "curr_kl_coeff": 0.011664004996418953, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6738317012786865, "mean_kl_loss": 9.713070176076144e-05, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 371952.57451629546}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.622757200063188e-05, "remove_single_ts_time_rank_from_batch": 6.688482005117725e-07, "un_batch_to_individual_items": 5.999634002824575e-06, "get_actions": 4.555929217214496e-05, "normalize_and_clip_actions": 1.0740885692212841e-05, "listify_data_for_vector_env": 1.2569620819544906e-05}}, "connector_pipeline_timer": 0.00011993003237758133}, "num_env_steps_sampled_lifetime": 30400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.55, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.7390793880142475e-06, "batch_individual_items": 7.092795443037571e-06, "add_states_from_episodes_to_batch": 1.7092202368348336e-06, "numpy_to_tensor": 1.0678040333727377e-05, "add_observations_from_episodes_to_batch": 3.104941302672204e-06}}, "connector_pipeline_timer": 4.955684162896649e-05}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10305633737651192, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004802301640156656, "episode_return_max": 13.5, "num_episodes_lifetime": 120, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_env_steps_sampled": 400, "env_step_timer": 1.7529538207148158e-05, "agent_episode_returns_mean": {"default_agent": -0.55}, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": -0.55}, "env_reset_timer": 0.00019202862311464488, "rlmodule_inference_timer": 3.345206880307954e-05, "time_between_sampling": 1.6571582891272938}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-28", "timestamp": 1754932948, "time_this_iter_s": 1.7954630851745605, "time_total_s": 10.821510791778564, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.821510791778564, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 44.833333333333336, "ram_util_percent": 79.36666666666667}}
{"timers": {"training_iteration": 1.8808324678832022, "restore_env_runners": 1.3617950201667429e-05, "training_step": 1.8806825408049042, "env_runner_sampling_timer": 1.7630230964415468, "learner_update_timer": 0.11459437902134119, "synch_weights": 0.0005680078327543884, "restore_eval_env_runners": 7.485297119215432e-06, "evaluation_iteration": 0.1097821380230608, "synch_eval_env_connectors": 0.0001153125726910034, "synch_env_connectors": 4.446536652042694e-06}, "env_runners": {"rlmodule_inference_timer": 3.458546226970699e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_to_module_connector": {"connector_pipeline_timer": 5.066440575387549e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4589916818023368e-06, "numpy_to_tensor": 1.049231407221252e-05, "add_states_from_episodes_to_batch": 1.9687185950596486e-06, "add_time_dim_to_batch_and_zero_pad": 2.8643104949834933e-06, "batch_individual_items": 7.464016355741411e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.795086314019774e-07, "listify_data_for_vector_env": 1.309129461228916e-05, "un_batch_to_individual_items": 6.228918478280115e-06, "get_actions": 5.1136846709413973e-05, "normalize_and_clip_actions": 1.1207862437387288e-05, "tensor_to_numpy": 1.5877148323932682e-05}}, "connector_pipeline_timer": 0.00012724609720326163}, "episode_len_max": 20, "episode_return_mean": 4.5, "sample": 0.005811787965675672, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "agent_episode_returns_mean": {"default_agent": 4.5}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 4.5}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime": -3077500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.6936317912690397e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 6.0, "env_reset_timer": 5.290410924302458e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.002058926603855873, "episode_duration_sec_mean": 0.0054936193390749365, "num_env_steps_sampled_lifetime_throughput": 3111.3206608308}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008839832669819345, "general_advantage_estimation": 0.0068617807533306215, "add_time_dim_to_batch_and_zero_pad": 1.2992190228377476e-05, "batch_individual_items": 0.033533237544180076, "numpy_to_tensor": 7.479007346338816e-05, "add_states_from_episodes_to_batch": 3.694292539569562e-06, "add_one_ts_to_episodes_and_truncate": 0.007489674287627554, "add_columns_from_episodes_to_train_batch": 0.036444378757082785}}, "connector_pipeline_timer": 0.08544788107989584}, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 220500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1933841.0145135708, "num_module_steps_trained_throughput": 369960.74509787955, "num_module_steps_trained_lifetime_throughput": 369363.85139600124}, "default_policy": {"total_loss": 0.013212400488555431, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.118752621114254, "num_module_steps_trained_lifetime": 42000, "vf_loss_unclipped": 29.43939208984375, "vf_loss": 0.10278083384037018, "policy_loss": -0.04945483058691025, "vf_explained_var": -0.012065649032592773, "curr_kl_coeff": 0.0058320024982094765, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6708225607872009, "mean_kl_loss": 0.0001997690269490704, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 370656.36299919296}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.815496821511001e-05, "remove_single_ts_time_rank_from_batch": 8.710250209148534e-07, "un_batch_to_individual_items": 7.96605778016961e-06, "get_actions": 4.940852359930079e-05, "normalize_and_clip_actions": 1.3035432985359412e-05, "listify_data_for_vector_env": 1.392556018811324e-05}}, "connector_pipeline_timer": 0.00013343947955979886}, "num_env_steps_sampled_lifetime": 35400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.55, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.530743979864013e-06, "batch_individual_items": 8.058155416508637e-06, "add_states_from_episodes_to_batch": 2.115642118845188e-06, "numpy_to_tensor": 1.0371461679978882e-05, "add_observations_from_episodes_to_batch": 3.1485993550467457e-06}}, "connector_pipeline_timer": 5.212105671048981e-05}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10318346108214103, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004916445463895798, "episode_return_max": 14.5, "num_episodes_lifetime": 140, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_env_steps_sampled": 400, "env_step_timer": 1.7111246829429376e-05, "agent_episode_returns_mean": {"default_agent": -0.55}, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": -0.55}, "env_reset_timer": 0.00019163666633227288, "rlmodule_inference_timer": 3.172922134583137e-05, "time_between_sampling": 1.6585932287355114}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-30", "timestamp": 1754932950, "time_this_iter_s": 1.905310869216919, "time_total_s": 12.726821660995483, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.726821660995483, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 53.76666666666667, "ram_util_percent": 79.06666666666666}}
{"timers": {"training_iteration": 1.8815501648735233, "restore_env_runners": 1.3541361374587526e-05, "training_step": 1.8813993845661394, "env_runner_sampling_timer": 1.7618641938073576, "learner_update_timer": 0.1164419823221555, "synch_weights": 0.0005853735853211061, "restore_eval_env_runners": 7.621274624158293e-06, "evaluation_iteration": 0.10992696872308483, "synch_eval_env_connectors": 0.0001163281968888425, "synch_env_connectors": 4.483731977170988e-06}, "env_runners": {"rlmodule_inference_timer": 4.8779714417628824e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.843178662906869e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.3795584740017416e-06, "numpy_to_tensor": 9.692910271518589e-06, "add_states_from_episodes_to_batch": 1.913751350739644e-06, "add_time_dim_to_batch_and_zero_pad": 2.644918470460683e-06, "batch_individual_items": 6.9425763843886265e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.144716968760165e-07, "listify_data_for_vector_env": 1.2025506731232224e-05, "un_batch_to_individual_items": 5.802718600904475e-06, "get_actions": 4.575826729753611e-05, "normalize_and_clip_actions": 1.0290424632991568e-05, "tensor_to_numpy": 1.4640407896673937e-05}}, "connector_pipeline_timer": 0.00011660991272857789}, "episode_len_max": 20, "episode_return_mean": 3.4599999999999995, "sample": 0.005763007642488896, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime": -3695000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.53663289096631e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 7.0, "env_reset_timer": 4.445695634239347e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0017297214182859294, "episode_duration_sec_mean": 0.005491556805558501, "num_env_steps_sampled_lifetime_throughput": 3441.7393360663723}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009015917637570898, "general_advantage_estimation": 0.0068809583558697455, "add_time_dim_to_batch_and_zero_pad": 5.617268774959937e-05, "batch_individual_items": 0.03432615516950382, "numpy_to_tensor": 7.867759219249307e-05, "add_states_from_episodes_to_batch": 2.0240259352818826e-05, "add_one_ts_to_episodes_and_truncate": 0.007571087954990081, "add_columns_from_episodes_to_train_batch": 0.03726285246919389}}, "connector_pipeline_timer": 0.08727197434942781}, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 252000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1922922.299443945, "num_module_steps_trained_throughput": 367815.90434465086, "num_module_steps_trained_lifetime_throughput": 367239.40476996}, "default_policy": {"total_loss": 0.018546825274825096, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.023772811517119408, "num_module_steps_trained_lifetime": 48000, "vf_loss_unclipped": 29.270179748535156, "vf_loss": 0.10278083384037018, "policy_loss": -0.044244833290576935, "vf_explained_var": -0.013218998908996582, "curr_kl_coeff": 0.0029160012491047382, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6574549674987793, "mean_kl_loss": 0.0009722818504087627, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 368436.6050021077}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1894671100955526e-05, "remove_single_ts_time_rank_from_batch": 7.456733265935129e-07, "un_batch_to_individual_items": 8.660053519577144e-06, "get_actions": 7.712875496687275e-05, "normalize_and_clip_actions": 1.3151739056063156e-05, "listify_data_for_vector_env": 1.7142646559350573e-05}}, "connector_pipeline_timer": 0.00017592936557022675}, "num_env_steps_sampled_lifetime": 40400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.35, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.6143381709247876e-06, "batch_individual_items": 1.0076623429299434e-05, "add_states_from_episodes_to_batch": 2.7935670012841925e-06, "numpy_to_tensor": 1.6655089727459416e-05, "add_observations_from_episodes_to_batch": 4.369967762160797e-06}}, "connector_pipeline_timer": 7.18975502137264e-05}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10412424772105311, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005833498792489991, "episode_return_max": 14.5, "num_episodes_lifetime": 160, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_env_steps_sampled": 400, "env_step_timer": 2.3968922305614394e-05, "agent_episode_returns_mean": {"default_agent": -0.35}, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": -0.35}, "env_reset_timer": 0.00019123612960462004, "rlmodule_inference_timer": 5.995361680183119e-05, "time_between_sampling": 1.6617816497777143}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-32", "timestamp": 1754932952, "time_this_iter_s": 2.162696361541748, "time_total_s": 14.889518022537231, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.889518022537231, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.800000000000004, "ram_util_percent": 80.66666666666667}}
{"timers": {"training_iteration": 1.8792166278048044, "restore_env_runners": 1.3463857398531242e-05, "training_step": 1.8790656265609047, "env_runner_sampling_timer": 1.7584647864492253, "learner_update_timer": 0.11750830415881176, "synch_weights": 0.0005849844289122736, "restore_eval_env_runners": 7.956311807955759e-06, "evaluation_iteration": 0.11090233403558926, "synch_eval_env_connectors": 0.00011677700519278301, "synch_env_connectors": 4.490974215771776e-06}, "env_runners": {"rlmodule_inference_timer": 2.9153625427498314e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.439308413026271e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.007110459594172e-06, "numpy_to_tensor": 8.79337963025042e-06, "add_states_from_episodes_to_batch": 1.7707009661182477e-06, "add_time_dim_to_batch_and_zero_pad": 2.442671035803189e-06, "batch_individual_items": 6.36466555464047e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.914958699838512e-07, "listify_data_for_vector_env": 1.1286091802531316e-05, "un_batch_to_individual_items": 5.4380734891588665e-06, "get_actions": 4.150364577691046e-05, "normalize_and_clip_actions": 9.695426119765705e-06, "tensor_to_numpy": 1.3562648355303388e-05}}, "connector_pipeline_timer": 0.00010796799263971076}, "episode_len_max": 20, "episode_return_mean": 5.460000000000001, "sample": 0.00530451084319151, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime": -4312500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.4243145473332476e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 8.0, "env_reset_timer": 3.986481769233029e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0027703400457668244, "episode_duration_sec_mean": 0.004698592660482973, "num_env_steps_sampled_lifetime_throughput": 3625.454930814804}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000900685016131695, "general_advantage_estimation": 0.00686432211137435, "add_time_dim_to_batch_and_zero_pad": 5.5700131516163145e-05, "batch_individual_items": 0.034285052367936775, "numpy_to_tensor": 7.845831535310366e-05, "add_states_from_episodes_to_batch": 2.0066606687169016e-05, "add_one_ts_to_episodes_and_truncate": 0.00889142623525199, "add_columns_from_episodes_to_train_batch": 0.037228097285551945}}, "connector_pipeline_timer": 0.0884972629349823}, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 283500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1920739.4079841839, "num_module_steps_trained_throughput": 367335.241733211, "num_module_steps_trained_lifetime_throughput": 366779.10315481387}, "default_policy": {"total_loss": -0.044999025762081146, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.04388493672013283, "num_module_steps_trained_lifetime": 54000, "vf_loss_unclipped": 29.713878631591797, "vf_loss": 0.10278083384037018, "policy_loss": -0.10784247517585754, "vf_explained_var": -0.012197732925415039, "curr_kl_coeff": 0.0014580006245523691, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6512721180915833, "mean_kl_loss": 0.0005018218071199954, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 367884.8054666488}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2950912788064512e-05, "remove_single_ts_time_rank_from_batch": 5.710002396374612e-07, "un_batch_to_individual_items": 5.228426685522102e-06, "get_actions": 3.6015947549285176e-05, "normalize_and_clip_actions": 9.192466442741625e-06, "listify_data_for_vector_env": 1.0861708219926328e-05}}, "connector_pipeline_timer": 9.997352138816576e-05}, "num_env_steps_sampled_lifetime": 45400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.55, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2579419139556818e-06, "batch_individual_items": 6.125898633106953e-06, "add_states_from_episodes_to_batch": 1.632246529106009e-06, "numpy_to_tensor": 8.340801685239742e-06, "add_observations_from_episodes_to_batch": 2.779677700466423e-06}}, "connector_pipeline_timer": 4.252774143794062e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10404690232377042, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005807987140724435, "episode_return_max": 14.5, "num_episodes_lifetime": 180, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_env_steps_sampled": 400, "env_step_timer": 1.3866636467432534e-05, "agent_episode_returns_mean": {"default_agent": -0.55}, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": -0.55}, "env_reset_timer": 0.00019012293853815782, "rlmodule_inference_timer": 2.7377856347331834e-05, "time_between_sampling": 1.6619193078704009}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-34", "timestamp": 1754932954, "time_this_iter_s": 1.75160813331604, "time_total_s": 16.64112615585327, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.64112615585327, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.9, "ram_util_percent": 81.85}}
{"timers": {"training_iteration": 1.8763613273670963, "restore_env_runners": 1.338130886029739e-05, "training_step": 1.8762097552944128, "env_runner_sampling_timer": 1.7547325239941423, "learner_update_timer": 0.11837946403697416, "synch_weights": 0.0005858770841590542, "restore_eval_env_runners": 7.93632772328079e-06, "evaluation_iteration": 0.11080534361549521, "synch_eval_env_connectors": 0.00011665090547072397, "synch_env_connectors": 4.483154395148119e-06}, "env_runners": {"rlmodule_inference_timer": 2.781959923326769e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.357883831400152e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.942439466195177e-06, "numpy_to_tensor": 8.479030233163983e-06, "add_states_from_episodes_to_batch": 1.7459983269642502e-06, "add_time_dim_to_batch_and_zero_pad": 2.4358964979983674e-06, "batch_individual_items": 6.219661611815965e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.774662249376788e-07, "listify_data_for_vector_env": 1.1164776160624899e-05, "un_batch_to_individual_items": 5.317084930254266e-06, "get_actions": 4.007426286605577e-05, "normalize_and_clip_actions": 9.472560338872861e-06, "tensor_to_numpy": 1.3140817258036877e-05}}, "connector_pipeline_timer": 0.00010523453591686502}, "episode_len_max": 20, "episode_return_mean": 6.659999999999997, "sample": 0.004930648261918707, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime": -4930000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.3775517823064822e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 9.0, "env_reset_timer": 3.422714055347328e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.002073843990695846, "episode_duration_sec_mean": 0.004568449492566289, "num_env_steps_sampled_lifetime_throughput": 3707.089917125896}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.00090017524580472, "general_advantage_estimation": 0.00686401556078039, "add_time_dim_to_batch_and_zero_pad": 5.5241049456496585e-05, "batch_individual_items": 0.035272273924275406, "numpy_to_tensor": 7.837040223074763e-05, "add_states_from_episodes_to_batch": 1.989594084873213e-05, "add_one_ts_to_episodes_and_truncate": 0.008884603223123509, "add_columns_from_episodes_to_train_batch": 0.0372048967227839}}, "connector_pipeline_timer": 0.08945232905572031}, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 315000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1914593.4223922384, "num_module_steps_trained_throughput": 366100.39364345925, "num_module_steps_trained_lifetime_throughput": 365564.535323925}, "default_policy": {"total_loss": -0.019771618768572807, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.04102873429656029, "num_module_steps_trained_lifetime": 60000, "vf_loss_unclipped": 29.858129501342773, "vf_loss": 0.10278083384037018, "policy_loss": -0.08268185704946518, "vf_explained_var": -0.01230764389038086, "curr_kl_coeff": 0.0007290003122761846, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6437965035438538, "mean_kl_loss": 0.00037937649176456034, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 366585.9957949137}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.58266951538857e-05, "remove_single_ts_time_rank_from_batch": 6.432811621651708e-07, "un_batch_to_individual_items": 6.2368974939190245e-06, "get_actions": 4.5804628554234964e-05, "normalize_and_clip_actions": 1.1252571866273221e-05, "listify_data_for_vector_env": 1.3507710948368554e-05}}, "connector_pipeline_timer": 0.00012244463443772773}, "num_env_steps_sampled_lifetime": 50400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -0.15, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5993289099755613e-06, "batch_individual_items": 8.242353302454646e-06, "add_states_from_episodes_to_batch": 1.8242705087237073e-06, "numpy_to_tensor": 1.0494389562998731e-05, "add_observations_from_episodes_to_batch": 3.362687773545027e-06}}, "connector_pipeline_timer": 5.0778657249499475e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10423422830025511, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005949694205773994, "episode_return_max": 14.5, "num_episodes_lifetime": 200, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_env_steps_sampled": 400, "env_step_timer": 1.802897586782907e-05, "agent_episode_returns_mean": {"default_agent": -0.15}, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": -0.15}, "env_reset_timer": 0.00018908462841259264, "rlmodule_inference_timer": 3.302092612364614e-05, "time_between_sampling": 1.6614206897922288}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-36", "timestamp": 1754932956, "time_this_iter_s": 1.7252390384674072, "time_total_s": 18.36636519432068, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.36636519432068, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.9, "ram_util_percent": 79.43333333333332}}
{"timers": {"training_iteration": 1.87416706993259, "restore_env_runners": 1.3316244839999313e-05, "training_step": 1.8740151481613072, "env_runner_sampling_timer": 1.7527896229141746, "learner_update_timer": 0.11812649606756029, "synch_weights": 0.0005863187326536486, "restore_eval_env_runners": 7.924464377949676e-06, "evaluation_iteration": 0.11098501892995284, "synch_eval_env_connectors": 0.00011677272636561922, "synch_env_connectors": 4.482072893292418e-06}, "env_runners": {"rlmodule_inference_timer": 3.253308662119146e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.8007130870871306e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2827449164432577e-06, "numpy_to_tensor": 9.699004426932131e-06, "add_states_from_episodes_to_batch": 1.8699085881187073e-06, "add_time_dim_to_batch_and_zero_pad": 2.7520448697400473e-06, "batch_individual_items": 6.971608059546924e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.273735046892635e-07, "listify_data_for_vector_env": 1.243497414723503e-05, "un_batch_to_individual_items": 5.8772663444116296e-06, "get_actions": 4.70322444981913e-05, "normalize_and_clip_actions": 1.0525194049305877e-05, "tensor_to_numpy": 1.4722800924599748e-05}}, "connector_pipeline_timer": 0.00011880108969632407}, "episode_len_max": 20, "episode_return_mean": 5.940000000000001, "sample": 0.005331328508932185, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime": -5547500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.562525900423945e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 10.0, "env_reset_timer": 4.268809116652128e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0021086668434359694, "episode_duration_sec_mean": 0.005151499829720706, "num_env_steps_sampled_lifetime_throughput": 3347.4481656966204}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008991589033943679, "general_advantage_estimation": 0.006849762485190064, "add_time_dim_to_batch_and_zero_pad": 5.478030904295102e-05, "batch_individual_items": 0.03522106952516205, "numpy_to_tensor": 7.821794864951453e-05, "add_states_from_episodes_to_batch": 1.972698166867961e-05, "add_one_ts_to_episodes_and_truncate": 0.00887149719135816, "add_columns_from_episodes_to_train_batch": 0.037188232345194625}}, "connector_pipeline_timer": 0.08935451326470259}, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 346500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1915174.4755365613, "num_module_steps_trained_throughput": 366150.5764453703, "num_module_steps_trained_lifetime_throughput": 365633.4245378871}, "default_policy": {"total_loss": 0.024718768894672394, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.044992342591285706, "num_module_steps_trained_lifetime": 66000, "vf_loss_unclipped": 29.646411895751953, "vf_loss": 0.10278083384037018, "policy_loss": -0.03828921541571617, "vf_explained_var": -0.014516830444335938, "curr_kl_coeff": 0.0003645001561380923, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6329572796821594, "mean_kl_loss": 0.00017876990023069084, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 366574.5051959966}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2978495050104698e-05, "remove_single_ts_time_rank_from_batch": 5.770819179815436e-07, "un_batch_to_individual_items": 5.2520582411009635e-06, "get_actions": 3.619360767409199e-05, "normalize_and_clip_actions": 9.283076562213186e-06, "listify_data_for_vector_env": 1.0902428165479852e-05}}, "connector_pipeline_timer": 0.00010059519255145817}, "num_env_steps_sampled_lifetime": 55400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.45, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2479970449918525e-06, "batch_individual_items": 6.0635836942134415e-06, "add_states_from_episodes_to_batch": 1.6135727982809997e-06, "numpy_to_tensor": 8.212869592877619e-06, "add_observations_from_episodes_to_batch": 2.762899915165089e-06}}, "connector_pipeline_timer": 4.2331107205509544e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10416429893734386, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005772601296193898, "episode_return_max": 14.5, "num_episodes_lifetime": 220, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_env_steps_sampled": 400, "env_step_timer": 1.3860614094263678e-05, "agent_episode_returns_mean": {"default_agent": 0.45}, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": 0.45}, "env_reset_timer": 0.0001879441918005035, "rlmodule_inference_timer": 2.724993903848873e-05, "time_between_sampling": 1.6615719233138557}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-38", "timestamp": 1754932958, "time_this_iter_s": 1.7610929012298584, "time_total_s": 20.127458095550537, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.127458095550537, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 49.4, "ram_util_percent": 80.4}}
{"timers": {"training_iteration": 1.8710064763132512, "restore_env_runners": 1.3233081608170771e-05, "training_step": 1.8708544516798098, "env_runner_sampling_timer": 1.7499005725147916, "learner_update_timer": 0.11785474319645008, "synch_weights": 0.0005862980449948908, "restore_eval_env_runners": 7.909390187867622e-06, "evaluation_iteration": 0.11089469082038558, "synch_eval_env_connectors": 0.00011662916871650158, "synch_env_connectors": 4.4760021683828075e-06}, "env_runners": {"rlmodule_inference_timer": 2.7823318200446347e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.344985169882188e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0004577705166382e-06, "numpy_to_tensor": 8.439139382825094e-06, "add_states_from_episodes_to_batch": 1.7342985972451506e-06, "add_time_dim_to_batch_and_zero_pad": 2.3959993733779996e-06, "batch_individual_items": 6.22332748638698e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.732033832202378e-07, "listify_data_for_vector_env": 1.1018886163832649e-05, "un_batch_to_individual_items": 5.320024347665493e-06, "get_actions": 3.941005853889069e-05, "normalize_and_clip_actions": 9.416380046908221e-06, "tensor_to_numpy": 1.3064415296209552e-05}}, "connector_pipeline_timer": 0.00010414743896507073}, "episode_len_max": 20, "episode_return_mean": 6.659999999999997, "sample": 0.0050068457628631375, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime": -6165000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.3741823558932579e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 11.0, "env_reset_timer": 3.561047256234258e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018384997601352073, "episode_duration_sec_mean": 0.00454630749626085, "num_env_steps_sampled_lifetime_throughput": 3715.1651154412457}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008985923144841039, "general_advantage_estimation": 0.006832115280131441, "add_time_dim_to_batch_and_zero_pad": 5.431625629919702e-05, "batch_individual_items": 0.03516564342037452, "numpy_to_tensor": 7.796410962375197e-05, "add_states_from_episodes_to_batch": 1.955388200111052e-05, "add_one_ts_to_episodes_and_truncate": 0.008859523059894507, "add_columns_from_episodes_to_train_batch": 0.03716286210144723}}, "connector_pipeline_timer": 0.08924187646239923}, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 378000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1922114.5313384233, "num_module_steps_trained_throughput": 367421.9626507774, "num_module_steps_trained_lifetime_throughput": 366920.11150158785}, "default_policy": {"total_loss": 0.11514448374509811, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.04603158310055733, "num_module_steps_trained_lifetime": 72000, "vf_loss_unclipped": 29.652629852294922, "vf_loss": 0.10278083384037018, "policy_loss": 0.05211615562438965, "vf_explained_var": -0.015211820602416992, "curr_kl_coeff": 0.00018225007806904614, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6306999921798706, "mean_kl_loss": 3.76364951080177e-05, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 367790.703661194}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2945804196325066e-05, "remove_single_ts_time_rank_from_batch": 5.742367599556511e-07, "un_batch_to_individual_items": 5.364841820699133e-06, "get_actions": 3.565916499005122e-05, "normalize_and_clip_actions": 9.215108522033086e-06, "listify_data_for_vector_env": 1.0881933323016365e-05}}, "connector_pipeline_timer": 9.983759740055383e-05}, "num_env_steps_sampled_lifetime": 60400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.45, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.209173920981154e-06, "batch_individual_items": 6.051330777498034e-06, "add_states_from_episodes_to_batch": 1.5940913415121413e-06, "numpy_to_tensor": 8.202778397991062e-06, "add_observations_from_episodes_to_batch": 2.7484989363449757e-06}}, "connector_pipeline_timer": 4.20870344706462e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10409640344749038, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005602376261958852, "episode_return_max": 13.5, "num_episodes_lifetime": 240, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_env_steps_sampled": 400, "env_step_timer": 1.395192422824117e-05, "agent_episode_returns_mean": {"default_agent": 1.45}, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": 1.45}, "env_reset_timer": 0.00018721182962966868, "rlmodule_inference_timer": 2.713475750515652e-05, "time_between_sampling": 1.6606996732505461}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-39", "timestamp": 1754932959, "time_this_iter_s": 1.6629741191864014, "time_total_s": 21.79043221473694, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.79043221473694, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.900000000000006, "ram_util_percent": 79.69999999999999}}
{"timers": {"training_iteration": 1.8677444848804539, "restore_env_runners": 1.3153660391706187e-05, "training_step": 1.8675923050824523, "env_runner_sampling_timer": 1.7469080130396597, "learner_update_timer": 0.11758362409429607, "synch_weights": 0.0005860033944882859, "restore_eval_env_runners": 7.89904651844706e-06, "evaluation_iteration": 0.11081155391173707, "synch_eval_env_connectors": 0.00011702329636157262, "synch_env_connectors": 4.469992150722293e-06}, "env_runners": {"rlmodule_inference_timer": 2.726169631802536e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.328043123493292e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.911853554923769e-06, "numpy_to_tensor": 8.373574084579126e-06, "add_states_from_episodes_to_batch": 1.7359021848245352e-06, "add_time_dim_to_batch_and_zero_pad": 2.3817176035724257e-06, "batch_individual_items": 6.220442978755979e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.748849491147062e-07, "listify_data_for_vector_env": 1.098009211059349e-05, "un_batch_to_individual_items": 5.300640598561692e-06, "get_actions": 3.852483322974699e-05, "normalize_and_clip_actions": 9.367434798285436e-06, "tensor_to_numpy": 1.2883224775345592e-05}}, "connector_pipeline_timer": 0.00010301460296534974}, "episode_len_max": 20, "episode_return_mean": 7.46, "sample": 0.004825486876898982, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "agent_episode_returns_mean": {"default_agent": 7.46}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 7.46}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime": -6782500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.3656352730652201e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 12.0, "env_reset_timer": 3.1335463502433846e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0016796663781253037, "episode_duration_sec_mean": 0.004502456137910485, "num_env_steps_sampled_lifetime_throughput": 3758.4849928937824}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008975743111490067, "general_advantage_estimation": 0.0068155428775958145, "add_time_dim_to_batch_and_zero_pad": 5.3863513516668033e-05, "batch_individual_items": 0.03511228573601066, "numpy_to_tensor": 7.772696858384084e-05, "add_states_from_episodes_to_batch": 1.9385842808421375e-05, "add_one_ts_to_episodes_and_truncate": 0.008846396998828443, "add_columns_from_episodes_to_train_batch": 0.037135031399773186}}, "connector_pipeline_timer": 0.08912823853811251}, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 409500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1933566.6047244184, "num_module_steps_trained_throughput": 369554.1264949584, "num_module_steps_trained_lifetime_throughput": 369066.87286079995}, "default_policy": {"total_loss": -0.08020195364952087, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.12169253826141357, "num_module_steps_trained_lifetime": 78000, "vf_loss_unclipped": 30.071489334106445, "vf_loss": 0.10278083384037018, "policy_loss": -0.14317864179611206, "vf_explained_var": -0.012235283851623535, "curr_kl_coeff": 9.112503903452307e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6363987922668457, "mean_kl_loss": 0.0001085606127162464, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 369870.8347791836}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2840239403256289e-05, "remove_single_ts_time_rank_from_batch": 5.646418575273347e-07, "un_batch_to_individual_items": 5.159924874296003e-06, "get_actions": 3.563665316566365e-05, "normalize_and_clip_actions": 9.086998216908156e-06, "listify_data_for_vector_env": 1.0748219054776277e-05}}, "connector_pipeline_timer": 9.924225295642054e-05}, "num_env_steps_sampled_lifetime": 65400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.45, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.187297541926274e-06, "batch_individual_items": 5.999287795769329e-06, "add_states_from_episodes_to_batch": 1.5940259445877955e-06, "numpy_to_tensor": 8.183496614567643e-06, "add_observations_from_episodes_to_batch": 2.755054099699435e-06}}, "connector_pipeline_timer": 4.1953010180829436e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.104026201083048, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004685985820833594, "episode_return_max": 13.5, "num_episodes_lifetime": 260, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_env_steps_sampled": 400, "env_step_timer": 1.3780073329397232e-05, "agent_episode_returns_mean": {"default_agent": 1.45}, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": 1.45}, "env_reset_timer": 0.00018606554223851146, "rlmodule_inference_timer": 2.728532797387334e-05, "time_between_sampling": 1.6597078623478514}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-41", "timestamp": 1754932961, "time_this_iter_s": 1.6489942073822021, "time_total_s": 23.43942642211914, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.43942642211914, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 38.650000000000006, "ram_util_percent": 78.85}}
{"timers": {"training_iteration": 1.864559064610502, "restore_env_runners": 1.30829635991291e-05, "training_step": 1.864406648701868, "env_runner_sampling_timer": 1.743087442068947, "learner_update_timer": 0.1182188824342698, "synch_weights": 0.00058607211115897, "restore_eval_env_runners": 7.883385988336443e-06, "evaluation_iteration": 0.11072170003297577, "synch_eval_env_connectors": 0.0001175309830428193, "synch_env_connectors": 4.460712755034134e-06}, "env_runners": {"rlmodule_inference_timer": 2.7863855211325253e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.312781650675721e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8956166479072403e-06, "numpy_to_tensor": 8.387771222863462e-06, "add_states_from_episodes_to_batch": 1.7194301232525409e-06, "add_time_dim_to_batch_and_zero_pad": 2.3682546377718418e-06, "batch_individual_items": 6.1636737878626555e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.671353600265654e-07, "listify_data_for_vector_env": 1.0970116153070059e-05, "un_batch_to_individual_items": 5.265261973857305e-06, "get_actions": 3.922615575796658e-05, "normalize_and_clip_actions": 9.346347980047277e-06, "tensor_to_numpy": 1.293479874350734e-05}}, "connector_pipeline_timer": 0.00010361719006327682}, "episode_len_max": 20, "episode_return_mean": 7.54, "sample": 0.004825219897084587, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "agent_episode_returns_mean": {"default_agent": 7.54}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 7.54}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime": -7400000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.3589962948262744e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 13.0, "env_reset_timer": 3.155511961488051e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0016673686188619233, "episode_duration_sec_mean": 0.004521088350564242, "num_env_steps_sampled_lifetime_throughput": 3760.369453628965}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008969056580666371, "general_advantage_estimation": 0.006801835359335448, "add_time_dim_to_batch_and_zero_pad": 5.3413217820163285e-05, "batch_individual_items": 0.035957857879049454, "numpy_to_tensor": 7.76034489283263e-05, "add_states_from_episodes_to_batch": 1.9219063748347323e-05, "add_one_ts_to_episodes_and_truncate": 0.008834592619544526, "add_columns_from_episodes_to_train_batch": 0.03710718317632083}}, "connector_pipeline_timer": 0.08991835531302897}, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 441000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1947124.6445480257, "num_module_steps_trained_throughput": 372089.65803589835, "num_module_steps_trained_lifetime_throughput": 371615.847709377}, "default_policy": {"total_loss": 0.11680866777896881, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.08184441179037094, "num_module_steps_trained_lifetime": 84000, "vf_loss_unclipped": 29.760150909423828, "vf_loss": 0.10278083384037018, "policy_loss": 0.05362187325954437, "vf_explained_var": -0.015738248825073242, "curr_kl_coeff": 4.5562519517261535e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6132097840309143, "mean_kl_loss": 0.0007894618902355433, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 372354.68289307517}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3061141897256194e-05, "remove_single_ts_time_rank_from_batch": 5.776970206133195e-07, "un_batch_to_individual_items": 5.255950918047578e-06, "get_actions": 3.648146060468447e-05, "normalize_and_clip_actions": 9.299495418933195e-06, "listify_data_for_vector_env": 1.0958815889273674e-05}}, "connector_pipeline_timer": 0.00010096092521726699}, "num_env_steps_sampled_lifetime": 70400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.85, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2219021715554374e-06, "batch_individual_items": 6.163552836827815e-06, "add_states_from_episodes_to_batch": 1.6040993880612582e-06, "numpy_to_tensor": 8.286111983612097e-06, "add_observations_from_episodes_to_batch": 2.7991361690087005e-06}}, "connector_pipeline_timer": 4.239658669037862e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10396900157165315, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004703859160654247, "episode_return_max": 14.5, "num_episodes_lifetime": 280, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_env_steps_sampled": 400, "env_step_timer": 1.4023910976695386e-05, "agent_episode_returns_mean": {"default_agent": 1.85}, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": 1.85}, "env_reset_timer": 0.00018498030715590442, "rlmodule_inference_timer": 2.7176187459936194e-05, "time_between_sampling": 1.6587786928939423}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-43", "timestamp": 1754932963, "time_this_iter_s": 1.6547341346740723, "time_total_s": 25.094160556793213, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.094160556793213, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.8, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 1.8628387731343583, "restore_env_runners": 1.3008383518338145e-05, "training_step": 1.862685879305538, "env_runner_sampling_timer": 1.7404675530681568, "learner_update_timer": 0.11911691278023856, "synch_weights": 0.0005862384697003752, "restore_eval_env_runners": 7.867892540905895e-06, "evaluation_iteration": 0.11064638053257053, "synch_eval_env_connectors": 0.00011730067342316804, "synch_env_connectors": 4.454445849574275e-06}, "env_runners": {"rlmodule_inference_timer": 2.9809019792822334e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.588321521952369e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1781585942499165e-06, "numpy_to_tensor": 9.14801171786131e-06, "add_states_from_episodes_to_batch": 1.8004388621371921e-06, "add_time_dim_to_batch_and_zero_pad": 2.547323961570066e-06, "batch_individual_items": 6.668534357262274e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.953554922053876e-07, "listify_data_for_vector_env": 1.1723038936640603e-05, "un_batch_to_individual_items": 5.668786542804736e-06, "get_actions": 4.345823122682815e-05, "normalize_and_clip_actions": 9.950335435186893e-06, "tensor_to_numpy": 1.3887934459810923e-05}}, "connector_pipeline_timer": 0.00011218765914639867}, "episode_len_max": 20, "episode_return_mean": 7.46, "sample": 0.005030401691018143, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "agent_episode_returns_mean": {"default_agent": 7.46}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 7.46}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime": -8017500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.4716568664029709e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 14.0, "env_reset_timer": 3.4900070624594214e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018536829799009856, "episode_duration_sec_mean": 0.00487235511932522, "num_env_steps_sampled_lifetime_throughput": 3565.882637265543}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000896696600668046, "general_advantage_estimation": 0.006790167835287501, "add_time_dim_to_batch_and_zero_pad": 5.301075602756079e-05, "batch_individual_items": 0.037007630129457916, "numpy_to_tensor": 7.779199454279804e-05, "add_states_from_episodes_to_batch": 1.9055623038742227e-05, "add_one_ts_to_episodes_and_truncate": 0.008826952102985801, "add_columns_from_episodes_to_train_batch": 0.03709283175461217}}, "connector_pipeline_timer": 0.0909333988397316}, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 472500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1954776.6894200544, "num_module_steps_trained_throughput": 373500.2482813772, "num_module_steps_trained_lifetime_throughput": 373040.6025176274}, "default_policy": {"total_loss": 0.01164228841662407, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.04784759134054184, "num_module_steps_trained_lifetime": 90000, "vf_loss_unclipped": 29.84295654296875, "vf_loss": 0.10278083384037018, "policy_loss": -0.051738157868385315, "vf_explained_var": -0.01546335220336914, "curr_kl_coeff": 2.2781259758630767e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.5918295383453369, "mean_kl_loss": 0.0018565247301012278, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 373719.07182645024}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3812513938409495e-05, "remove_single_ts_time_rank_from_batch": 5.892043353774685e-07, "un_batch_to_individual_items": 5.338245492590956e-06, "get_actions": 3.9494367307125536e-05, "normalize_and_clip_actions": 9.585359365055604e-06, "listify_data_for_vector_env": 1.1562324903928321e-05}}, "connector_pipeline_timer": 0.00010632503812326142}, "num_env_steps_sampled_lifetime": 75400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.85, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3257821569199755e-06, "batch_individual_items": 6.614290581309032e-06, "add_states_from_episodes_to_batch": 1.6316923735319883e-06, "numpy_to_tensor": 8.824694038877551e-06, "add_observations_from_episodes_to_batch": 2.943620349892266e-06}}, "connector_pipeline_timer": 4.4127845723716454e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10398045447597806, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0045467128977179526, "episode_return_max": 14.5, "num_episodes_lifetime": 300, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_env_steps_sampled": 400, "env_step_timer": 1.5153302383622372e-05, "agent_episode_returns_mean": {"default_agent": 1.85}, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": 1.85}, "env_reset_timer": 0.0001839013341679838, "rlmodule_inference_timer": 2.9037761806587458e-05, "time_between_sampling": 1.6593109576248792}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-45", "timestamp": 1754932965, "time_this_iter_s": 1.8055028915405273, "time_total_s": 26.89966344833374, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.89966344833374, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 43.333333333333336, "ram_util_percent": 79.26666666666667}}
{"timers": {"training_iteration": 1.8601261570734213, "restore_env_runners": 1.2961629770518483e-05, "training_step": 1.8599729255120983, "env_runner_sampling_timer": 1.7380144141975578, "learner_update_timer": 0.11885717365278232, "synch_weights": 0.0005856581648043348, "restore_eval_env_runners": 7.851294414167485e-06, "evaluation_iteration": 0.11064522755683397, "synch_eval_env_connectors": 0.00011708058663405717, "synch_env_connectors": 4.453231173862517e-06}, "env_runners": {"rlmodule_inference_timer": 3.080124224854663e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.601931391914434e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.151974288281911e-06, "numpy_to_tensor": 9.123272337400799e-06, "add_states_from_episodes_to_batch": 1.7876463279473776e-06, "add_time_dim_to_batch_and_zero_pad": 2.796131913969337e-06, "batch_individual_items": 6.624791355781725e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.077570569248177e-07, "listify_data_for_vector_env": 1.1745501509596999e-05, "un_batch_to_individual_items": 6.129650368657714e-06, "get_actions": 4.4453211061859805e-05, "normalize_and_clip_actions": 9.993381060323821e-06, "tensor_to_numpy": 1.481553605765523e-05}}, "connector_pipeline_timer": 0.00011492906130069954}, "episode_len_max": 20, "episode_return_mean": 8.1, "sample": 0.005395158174706815, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "agent_episode_returns_mean": {"default_agent": 8.1}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 8.1}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime": -8635000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.5039817052057557e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 15.0, "env_reset_timer": 4.0998161573321145e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.002039278698892622, "episode_duration_sec_mean": 0.004956863341387361, "num_env_steps_sampled_lifetime_throughput": 3533.9589169375417}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008965704749712239, "general_advantage_estimation": 0.006774679487348027, "add_time_dim_to_batch_and_zero_pad": 5.2562318472159644e-05, "batch_individual_items": 0.036933795498311786, "numpy_to_tensor": 7.76744952256346e-05, "add_states_from_episodes_to_batch": 1.889172708120639e-05, "add_one_ts_to_episodes_and_truncate": 0.008821045491990078, "add_columns_from_episodes_to_train_batch": 0.03706796718739641}}, "connector_pipeline_timer": 0.09081173402128365}, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 504000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1962151.5489083396, "num_module_steps_trained_throughput": 374860.8964655566, "num_module_steps_trained_lifetime_throughput": 374414.0983745224}, "default_policy": {"total_loss": 0.03488733619451523, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.027136243879795074, "num_module_steps_trained_lifetime": 96000, "vf_loss_unclipped": 29.875362396240234, "vf_loss": 0.10278083384037018, "policy_loss": -0.028655797243118286, "vf_explained_var": -0.015216827392578125, "curr_kl_coeff": 1.1390629879315384e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.5738593339920044, "mean_kl_loss": 0.000879815430380404, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 375034.188040794}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.287057834204147e-05, "remove_single_ts_time_rank_from_batch": 5.729526002877865e-07, "un_batch_to_individual_items": 5.190158620010202e-06, "get_actions": 3.672256527609166e-05, "normalize_and_clip_actions": 9.247431707786025e-06, "listify_data_for_vector_env": 1.093129516214592e-05}}, "connector_pipeline_timer": 0.00010099016963632341}, "num_env_steps_sampled_lifetime": 80400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.45, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2041999120414874e-06, "batch_individual_items": 6.098968935947075e-06, "add_states_from_episodes_to_batch": 1.587257976111083e-06, "numpy_to_tensor": 8.182433321163142e-06, "add_observations_from_episodes_to_batch": 2.7910850237632367e-06}}, "connector_pipeline_timer": 4.210415305922468e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10392937534106131, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0045577007823158055, "episode_return_max": 14.5, "num_episodes_lifetime": 320, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_env_steps_sampled": 400, "env_step_timer": 1.390587281892353e-05, "agent_episode_returns_mean": {"default_agent": 1.45}, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": 1.45}, "env_reset_timer": 0.0001846981511411339, "rlmodule_inference_timer": 2.7214596705876798e-05, "time_between_sampling": 1.6588425155494746}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-46", "timestamp": 1754932966, "time_this_iter_s": 1.6993210315704346, "time_total_s": 28.598984479904175, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.598984479904175, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 49.8, "ram_util_percent": 81.2}}
{"timers": {"training_iteration": 1.8586173721621415, "restore_env_runners": 1.2887853246080807e-05, "training_step": 1.8584637633465946, "env_runner_sampling_timer": 1.7367290642265132, "learner_update_timer": 0.11862922524599266, "synch_weights": 0.0005857707426942178, "restore_eval_env_runners": 7.835281363855036e-06, "evaluation_iteration": 0.11059214987138498, "synch_eval_env_connectors": 0.00011709228104070587, "synch_env_connectors": 4.4557783824239225e-06}, "env_runners": {"rlmodule_inference_timer": 4.912810677975815e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.6742995038784415e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2028410406329495e-06, "numpy_to_tensor": 9.461347350172759e-06, "add_states_from_episodes_to_batch": 1.853633946082967e-06, "add_time_dim_to_batch_and_zero_pad": 2.602723287972393e-06, "batch_individual_items": 6.7753789330653716e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.176807437317049e-07, "listify_data_for_vector_env": 1.2031717266395847e-05, "un_batch_to_individual_items": 5.8076945587578805e-06, "get_actions": 4.499800847233158e-05, "normalize_and_clip_actions": 1.0184926125560677e-05, "tensor_to_numpy": 1.431108436013831e-05}}, "connector_pipeline_timer": 0.00011494845435726847}, "episode_len_max": 20, "episode_return_mean": 7.940000000000001, "sample": 0.005488777318929595, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "agent_episode_returns_mean": {"default_agent": 7.940000000000001}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 7.940000000000001}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime": -9252500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.5123903133751577e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 16.0, "env_reset_timer": 3.941115606383377e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0015827794690076189, "episode_duration_sec_mean": 0.005389857332687825, "num_env_steps_sampled_lifetime_throughput": 3452.9796635512603}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008989156095485639, "general_advantage_estimation": 0.006758716852788674, "add_time_dim_to_batch_and_zero_pad": 5.211752477368892e-05, "batch_individual_items": 0.036863421713834894, "numpy_to_tensor": 7.742691961120225e-05, "add_states_from_episodes_to_batch": 1.872822909591524e-05, "add_one_ts_to_episodes_and_truncate": 0.00881049087750245, "add_columns_from_episodes_to_train_batch": 0.037039015845180955}}, "connector_pipeline_timer": 0.09068662293076496}, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 535500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1964281.56432127, "num_module_steps_trained_throughput": 375219.075471255, "num_module_steps_trained_lifetime_throughput": 374786.83393868204}, "default_policy": {"total_loss": 0.11605548858642578, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.2044783979654312, "num_module_steps_trained_lifetime": 102000, "vf_loss_unclipped": 29.69392204284668, "vf_loss": 0.10278083384037018, "policy_loss": 0.0521533340215683, "vf_explained_var": -0.017306208610534668, "curr_kl_coeff": 5.695314939657692e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.5342195630073547, "mean_kl_loss": 0.0022154797334223986, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 375333.6897432306}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4282546025929386e-05, "remove_single_ts_time_rank_from_batch": 5.873713560363456e-07, "un_batch_to_individual_items": 5.625200942063359e-06, "get_actions": 4.158776101473218e-05, "normalize_and_clip_actions": 9.755348995929041e-06, "listify_data_for_vector_env": 1.1599078843018257e-05}}, "connector_pipeline_timer": 0.0001105100833651455}, "num_env_steps_sampled_lifetime": 85400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.65, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.386790640040183e-06, "batch_individual_items": 6.542831744479146e-06, "add_states_from_episodes_to_batch": 1.6895873602685914e-06, "numpy_to_tensor": 9.183999464564015e-06, "add_observations_from_episodes_to_batch": 3.085681082738646e-06}}, "connector_pipeline_timer": 4.521989249750395e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10401295325759136, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004690104086184874, "episode_return_max": 14.5, "num_episodes_lifetime": 340, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_env_steps_sampled": 400, "env_step_timer": 1.5759854843367374e-05, "agent_episode_returns_mean": {"default_agent": 0.65}, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": 0.65}, "env_reset_timer": 0.0001836365795682666, "rlmodule_inference_timer": 3.2134765845658986e-05, "time_between_sampling": 1.659732424972898}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-48", "timestamp": 1754932968, "time_this_iter_s": 1.8480167388916016, "time_total_s": 30.447001218795776, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.447001218795776, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 44.06666666666666, "ram_util_percent": 80.2}}
{"timers": {"training_iteration": 1.855866914269682, "restore_env_runners": 1.2812723667707493e-05, "training_step": 1.8557129848832172, "env_runner_sampling_timer": 1.7333585677544825, "learner_update_timer": 0.1192495700829994, "synch_weights": 0.000585240535670203, "restore_eval_env_runners": 7.929837899419595e-06, "evaluation_iteration": 0.11078806504328031, "synch_eval_env_connectors": 0.00011758427776094382, "synch_env_connectors": 4.45288098566867e-06}, "env_runners": {"rlmodule_inference_timer": 2.845961653393375e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.370804827464707e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.946333600646184e-06, "numpy_to_tensor": 8.613933476220252e-06, "add_states_from_episodes_to_batch": 1.7383457477092836e-06, "add_time_dim_to_batch_and_zero_pad": 2.4146700143972654e-06, "batch_individual_items": 6.26241394210827e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.741811543654888e-07, "listify_data_for_vector_env": 1.1219693244266326e-05, "un_batch_to_individual_items": 5.346740992846865e-06, "get_actions": 4.054553618766211e-05, "normalize_and_clip_actions": 9.591872098299373e-06, "tensor_to_numpy": 1.330825446985703e-05}}, "connector_pipeline_timer": 0.00010613559476334263}, "episode_len_max": 20, "episode_return_mean": 8.5, "sample": 0.0052275109189185535, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "agent_episode_returns_mean": {"default_agent": 8.5}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 8.5}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime": -9870000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.39811137828029e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 17.0, "env_reset_timer": 3.847938891240416e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0016606243994998508, "episode_duration_sec_mean": 0.0046148543143644935, "num_env_steps_sampled_lifetime_throughput": 3657.316500708169}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008984168731668586, "general_advantage_estimation": 0.00674396176407926, "add_time_dim_to_batch_and_zero_pad": 5.167718017635613e-05, "batch_individual_items": 0.03768909457670091, "numpy_to_tensor": 7.732515029714754e-05, "add_states_from_episodes_to_batch": 1.856927763767589e-05, "add_one_ts_to_episodes_and_truncate": 0.008798979308636294, "add_columns_from_episodes_to_train_batch": 0.03701146152656693}}, "connector_pipeline_timer": 0.0914565917012738}, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 567000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1971489.807743167, "num_module_steps_trained_throughput": 376549.4822339976, "num_module_steps_trained_lifetime_throughput": 376130.0196613187}, "default_policy": {"total_loss": -0.07469553500413895, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.031843796372413635, "num_module_steps_trained_lifetime": 108000, "vf_loss_unclipped": 29.967670440673828, "vf_loss": 0.10278083384037018, "policy_loss": -0.13860587775707245, "vf_explained_var": -0.013191699981689453, "curr_kl_coeff": 2.847657469828846e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.5333104133605957, "mean_kl_loss": 0.00045499237603507936, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 376614.288195441}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2915433893014592e-05, "remove_single_ts_time_rank_from_batch": 5.725425732786754e-07, "un_batch_to_individual_items": 5.212738183097729e-06, "get_actions": 3.6268687244202626e-05, "normalize_and_clip_actions": 9.303161164040674e-06, "listify_data_for_vector_env": 1.0862035420247336e-05}}, "connector_pipeline_timer": 0.00010065837254819609}, "num_env_steps_sampled_lifetime": 90400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.65, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.184310121069369e-06, "batch_individual_items": 6.0800769881159635e-06, "add_states_from_episodes_to_batch": 1.5826933226754986e-06, "numpy_to_tensor": 8.19984647212801e-06, "add_observations_from_episodes_to_batch": 2.779291113754349e-06}}, "connector_pipeline_timer": 4.222703598233242e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10394991622555866, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004696127023780718, "episode_return_max": 14.5, "num_episodes_lifetime": 360, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_env_steps_sampled": 400, "env_step_timer": 1.4031835267848202e-05, "agent_episode_returns_mean": {"default_agent": 0.65}, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": 0.65}, "env_reset_timer": 0.00018258854457155261, "rlmodule_inference_timer": 2.701104359759214e-05, "time_between_sampling": 1.659155256133684}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-50", "timestamp": 1754932970, "time_this_iter_s": 1.6885218620300293, "time_total_s": 32.135523080825806, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.135523080825806, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 45.35, "ram_util_percent": 80.4}}
{"timers": {"training_iteration": 1.8528920530473236, "restore_env_runners": 1.2738766808582928e-05, "training_step": 1.85273800086407, "env_runner_sampling_timer": 1.7297511462470128, "learner_update_timer": 0.11988230230236822, "synch_weights": 0.0005846447908289434, "restore_eval_env_runners": 7.91345967356642e-06, "evaluation_iteration": 0.11070611897309536, "synch_eval_env_connectors": 0.00011731885518691583, "synch_env_connectors": 4.4496016167949214e-06}, "env_runners": {"rlmodule_inference_timer": 2.818563955364549e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.336280180401744e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.948366138124268e-06, "numpy_to_tensor": 8.426710362324062e-06, "add_states_from_episodes_to_batch": 1.7495961648637866e-06, "add_time_dim_to_batch_and_zero_pad": 2.401616730457753e-06, "batch_individual_items": 6.2142480185083486e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.751970078520681e-07, "listify_data_for_vector_env": 1.1036351796375999e-05, "un_batch_to_individual_items": 5.329021768258818e-06, "get_actions": 3.9155277230311346e-05, "normalize_and_clip_actions": 9.397948319637442e-06, "tensor_to_numpy": 1.3005470314881553e-05}}, "connector_pipeline_timer": 0.00010381950130997773}, "episode_len_max": 20, "episode_return_mean": 8.980000000000004, "sample": 0.00488245289139632, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime": -10487500.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.3732313638020472e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 18.0, "env_reset_timer": 3.307033669783745e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.001822627647981567, "episode_duration_sec_mean": 0.004544475141447037, "num_env_steps_sampled_lifetime_throughput": 3746.356086327619}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008983956248364354, "general_advantage_estimation": 0.006729511315928059, "add_time_dim_to_batch_and_zero_pad": 5.125749758884301e-05, "batch_individual_items": 0.03850276572083904, "numpy_to_tensor": 7.714564836763033e-05, "add_states_from_episodes_to_batch": 1.8409835352217885e-05, "add_one_ts_to_episodes_and_truncate": 0.008789764925624673, "add_columns_from_episodes_to_train_batch": 0.03699020400187688}}, "connector_pipeline_timer": 0.09222391245350942}, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 598500, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1978364.7737655563, "num_module_steps_trained_throughput": 377818.29528064665, "num_module_steps_trained_lifetime_throughput": 377411.30436680315}, "default_policy": {"total_loss": -0.02297934889793396, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.018438857048749924, "num_module_steps_trained_lifetime": 114000, "vf_loss_unclipped": 29.897029876708984, "vf_loss": 0.10278083384037018, "policy_loss": -0.08715296536684036, "vf_explained_var": -0.013711333274841309, "curr_kl_coeff": 1.423828734914423e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.5042437314987183, "mean_kl_loss": 0.0012530607637017965, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 377839.3664802299}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2839005761928322e-05, "remove_single_ts_time_rank_from_batch": 5.695988858110748e-07, "un_batch_to_individual_items": 5.154353582454493e-06, "get_actions": 3.570144924340807e-05, "normalize_and_clip_actions": 9.14957855865253e-06, "listify_data_for_vector_env": 1.0831422378929457e-05}}, "connector_pipeline_timer": 9.928982916627915e-05}, "num_env_steps_sampled_lifetime": 95400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.25, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.204573734615438e-06, "batch_individual_items": 6.053021250520441e-06, "add_states_from_episodes_to_batch": 1.570100837897541e-06, "numpy_to_tensor": 8.132968974510744e-06, "add_observations_from_episodes_to_batch": 2.757794456334538e-06}}, "connector_pipeline_timer": 4.181728436860025e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10387387915388846, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004678265765542164, "episode_return_max": 14.5, "num_episodes_lifetime": 380, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_env_steps_sampled": 400, "env_step_timer": 1.38341100110696e-05, "agent_episode_returns_mean": {"default_agent": 0.25}, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": 0.25}, "env_reset_timer": 0.00018149766006587685, "rlmodule_inference_timer": 2.682238483798324e-05, "time_between_sampling": 1.658320752321712}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-52", "timestamp": 1754932972, "time_this_iter_s": 1.6619999408721924, "time_total_s": 33.797523021698, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.797523021698, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 43.26666666666667, "ram_util_percent": 79.89999999999999}}
{"timers": {"training_iteration": 1.8494668533462069, "restore_env_runners": 1.2663878958181392e-05, "training_step": 1.8493123162758824, "env_runner_sampling_timer": 1.7265386827047773, "learner_update_timer": 0.11966721177922526, "synch_weights": 0.0005846058423219253, "restore_eval_env_runners": 7.899325571772826e-06, "evaluation_iteration": 0.11061034570377422, "synch_eval_env_connectors": 0.00011706941639297731, "synch_env_connectors": 4.441355003537443e-06}, "env_runners": {"rlmodule_inference_timer": 2.838243091768183e-05, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_to_module_connector": {"connector_pipeline_timer": 4.387238539411292e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.989938850448101e-06, "numpy_to_tensor": 8.586444458854575e-06, "add_states_from_episodes_to_batch": 1.7394785728579502e-06, "add_time_dim_to_batch_and_zero_pad": 2.4388129493850605e-06, "batch_individual_items": 6.3097950924090954e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.78219190241199e-07, "listify_data_for_vector_env": 1.1113780483075542e-05, "un_batch_to_individual_items": 5.382150780105341e-06, "get_actions": 4.014728941126816e-05, "normalize_and_clip_actions": 9.550130069452488e-06, "tensor_to_numpy": 1.3181511994785012e-05}}, "connector_pipeline_timer": 0.00010548928310200991}, "episode_len_max": 20, "episode_return_mean": 8.580000000000002, "sample": 0.004870899403104424, "episode_return_max": 10.5, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "agent_episode_returns_mean": {"default_agent": 8.580000000000002}, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 8.580000000000002}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime": -11105000.0, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "env_step_timer": 1.4002470905917792e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 19.0, "env_reset_timer": 3.483660899275718e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018437303581355904, "episode_duration_sec_mean": 0.0046178289884701365, "num_env_steps_sampled_lifetime_throughput": 3680.399921644649}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008975370785376419, "general_advantage_estimation": 0.00672164661222445, "add_time_dim_to_batch_and_zero_pad": 5.084326212776144e-05, "batch_individual_items": 0.03842278473330383, "numpy_to_tensor": 7.705544154159985e-05, "add_states_from_episodes_to_batch": 1.8252397271547294e-05, "add_one_ts_to_episodes_and_truncate": 0.008776545616829532, "add_columns_from_episodes_to_train_batch": 0.03696448321124195}}, "connector_pipeline_timer": 0.0920948924992746}, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 630000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1979191.1843112747, "num_module_steps_trained_throughput": 377927.63600326877, "num_module_steps_trained_lifetime_throughput": 377534.2008390428}, "default_policy": {"total_loss": -0.012637391686439514, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.11064177006483078, "num_module_steps_trained_lifetime": 120000, "vf_loss_unclipped": 29.854867935180664, "vf_loss": 0.10278083384037018, "policy_loss": -0.07692054659128189, "vf_explained_var": -0.015539288520812988, "curr_kl_coeff": 7.119143674572115e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.4921499788761139, "mean_kl_loss": 4.868659016210586e-05, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 377913.69217427325}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2830051612659426e-05, "remove_single_ts_time_rank_from_batch": 5.683971733487359e-07, "un_batch_to_individual_items": 5.169159211980226e-06, "get_actions": 3.5731860936538797e-05, "normalize_and_clip_actions": 9.180823392930339e-06, "listify_data_for_vector_env": 1.082138188139749e-05}}, "connector_pipeline_timer": 9.959300522296817e-05}, "num_env_steps_sampled_lifetime": 100400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.45, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.223817051775218e-06, "batch_individual_items": 6.0632540057531605e-06, "add_states_from_episodes_to_batch": 1.615006998406012e-06, "numpy_to_tensor": 8.247167037788572e-06, "add_observations_from_episodes_to_batch": 2.7624255073605357e-06}}, "connector_pipeline_timer": 4.203443991122565e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.10382162786225346, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004618980383966118, "episode_return_max": 14.5, "num_episodes_lifetime": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_env_steps_sampled": 400, "env_step_timer": 1.3966080647592518e-05, "agent_episode_returns_mean": {"default_agent": 0.45}, "weights_seq_no": 20.0, "module_episode_returns_mean": {"default_policy": 0.45}, "env_reset_timer": 0.00018050309250611617, "rlmodule_inference_timer": 2.733528565102991e-05, "time_between_sampling": 1.6570135339582037}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4d87b_00000", "date": "2025-08-11_19-22-53", "timestamp": 1754932973, "time_this_iter_s": 1.6164817810058594, "time_total_s": 35.41400480270386, "pid": 14357, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3860edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.41400480270386, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 43.7, "ram_util_percent": 79.5}}
