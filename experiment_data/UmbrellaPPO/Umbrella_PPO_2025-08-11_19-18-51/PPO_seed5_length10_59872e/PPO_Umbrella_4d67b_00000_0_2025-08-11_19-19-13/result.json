{"timers": {"training_iteration": 2.251514583011158, "restore_env_runners": 2.6708003133535385e-05, "training_step": 2.251219041994773, "env_runner_sampling_timer": 2.1357849579071626, "learner_update_timer": 0.11129887506831437, "synch_weights": 0.0009490000084042549}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.511250675630279e-07, "normalize_and_clip_actions": 5.171206636127557e-05, "tensor_to_numpy": 2.1901070202133527e-05, "get_actions": 8.670909592556388e-05, "listify_data_for_vector_env": 1.7260761504196632e-05, "un_batch_to_individual_items": 7.517535186895829e-06}}, "connector_pipeline_timer": 0.00022451718070497958}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": 31375.0, "episode_return_mean": -3.7400000000000015, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.185229650286754e-06, "add_observations_from_episodes_to_batch": 4.092798403560916e-06, "add_time_dim_to_batch_and_zero_pad": 3.3445921284077345e-06, "numpy_to_tensor": 1.4669872658992363e-05, "batch_individual_items": 9.602516754993014e-06}}, "connector_pipeline_timer": 6.752184008227935e-05}, "rlmodule_inference_timer": 9.11293125240091e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 627500.0, "episode_duration_sec_mean": 0.0071913865134120005, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "module_episode_returns_mean": {"default_policy": -3.7400000000000015}, "sample": 0.01635209359540306, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_step_timer": 3.077680448763618e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.191744832559449, "time_between_sampling": 0.0007571737379360359, "episode_return_max": 6.5, "weights_seq_no": 0.0, "env_reset_timer": 0.0002537090695753099, "agent_episode_returns_mean": {"default_agent": -3.7400000000000015}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2866.9595894535555}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007613042020238936, "add_columns_from_episodes_to_train_batch": 0.034113834029994905, "add_states_from_episodes_to_batch": 3.958004526793957e-06, "add_observations_from_episodes_to_batch": 0.0008295830339193344, "add_time_dim_to_batch_and_zero_pad": 1.3999990187585354e-05, "general_advantage_estimation": 0.007193665951490402, "batch_individual_items": 0.03158104210160673, "numpy_to_tensor": 8.141703438013792e-05}}, "connector_pipeline_timer": 0.0815931250108406}, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2006704.2991492022, "num_module_steps_trained_throughput": 387228.7753627592, "num_module_steps_trained_lifetime_throughput": 384309.2094340914}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.11001160740852356, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.061082545667886734, "mean_kl_loss": 0.0017906971042975783, "vf_loss_unclipped": 31.674436569213867, "curr_kl_coeff": 0.3732481598854065, "total_loss": 0.12488927692174911, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "entropy": 0.6923456788063049, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.009245157241821289, "num_module_steps_trained_lifetime_throughput": 388245.22617372626}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.751468325674229e-06, "numpy_to_tensor": 9.158231470515318e-06, "add_states_from_episodes_to_batch": 1.7612076223140289e-06, "add_observations_from_episodes_to_batch": 3.5912746889262745e-06, "add_time_dim_to_batch_and_zero_pad": 2.8697262297106496e-06}}, "connector_pipeline_timer": 4.9391094912591555e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.78308890637768e-06, "listify_data_for_vector_env": 1.137226842226649e-05, "normalize_and_clip_actions": 1.1788786971356428e-05, "tensor_to_numpy": 1.689050366820194e-05, "get_actions": 4.732163344672069e-05, "remove_single_ts_time_rank_from_batch": 7.082563820494253e-07}}, "connector_pipeline_timer": 0.00012059131925515999}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "weights_seq_no": 1.0, "episode_return_mean": -2.3, "num_env_steps_sampled_lifetime": 5400, "sample": 0.10922908294014633, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -2.3}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "rlmodule_inference_timer": 3.450686096144164e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.5919597448804077e-05, "env_reset_timer": 0.0005355830071493983, "agent_episode_returns_mean": {"default_agent": -2.3}, "num_episodes_lifetime": 20, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004928708344232291}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4d67b_00000", "date": "2025-08-11_19-20-54", "timestamp": 1754932854, "time_this_iter_s": 2.3754661083221436, "time_total_s": 2.3754661083221436, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.3754661083221436, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 49.150000000000006, "ram_util_percent": 84.05}}
{"timers": {"training_iteration": 2.2463343792618256, "restore_env_runners": 2.653551404364407e-05, "training_step": 2.246039611984743, "env_runner_sampling_timer": 2.1297233166580556, "learner_update_timer": 0.11218918964848854, "synch_weights": 0.0009475600079167633, "restore_eval_env_runners": 1.7167069017887115e-05, "evaluation_iteration": 0.12196733301971108, "synch_eval_env_connectors": 0.00014474999625235796, "synch_env_connectors": 6.166985258460045e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.347691804298302e-07, "normalize_and_clip_actions": 1.0364933093074242e-05, "tensor_to_numpy": 1.4495567739779898e-05, "get_actions": 4.30711217548716e-05, "listify_data_for_vector_env": 1.2291648201568055e-05, "un_batch_to_individual_items": 5.727695304799777e-06}}, "connector_pipeline_timer": 0.00011430243479314756}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": 500.0, "episode_return_mean": -3.8199999999999994, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.899559518960212e-06, "add_observations_from_episodes_to_batch": 3.1852992059081055e-06, "add_time_dim_to_batch_and_zero_pad": 2.5234756473733924e-06, "numpy_to_tensor": 9.675407861070877e-06, "batch_individual_items": 6.899564507763382e-06}}, "connector_pipeline_timer": 4.730075073416684e-05}, "rlmodule_inference_timer": 3.1804475455029686e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 10000.0, "episode_duration_sec_mean": 0.005000762511976064, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "module_episode_returns_mean": {"default_policy": -3.8199999999999994}, "sample": 0.006784018540002065, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.5317211628356836e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.001708551548079753, "episode_return_max": 6.5, "weights_seq_no": 1.0, "env_reset_timer": 6.345264450223698e-05, "agent_episode_returns_mean": {"default_agent": -3.8199999999999994}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3423.1183424149513}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007621986180311069, "add_columns_from_episodes_to_train_batch": 0.03412878360948525, "add_states_from_episodes_to_batch": 3.957174485549331e-06, "add_observations_from_episodes_to_batch": 0.0008297959540504963, "add_time_dim_to_batch_and_zero_pad": 1.4053321210667491e-05, "general_advantage_estimation": 0.007183372621657327, "batch_individual_items": 0.03259678876027465, "numpy_to_tensor": 8.13161942642182e-05}}, "connector_pipeline_timer": 0.0826222429308109}, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2007852.4710664214, "num_module_steps_trained_throughput": 387382.69653398485, "num_module_steps_trained_lifetime_throughput": 384500.30806622497}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.14527708292007446, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.13185341656208038, "mean_kl_loss": 7.931759319035336e-05, "vf_loss_unclipped": 29.594585418701172, "curr_kl_coeff": 0.18662407994270325, "total_loss": -0.06935101747512817, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "entropy": 0.6920329928398132, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.011589646339416504, "num_module_steps_trained_lifetime_throughput": 388376.90346769325}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.020245839269616e-06, "numpy_to_tensor": 8.336174465497665e-06, "add_states_from_episodes_to_batch": 1.6057666503906356e-06, "add_observations_from_episodes_to_batch": 2.7988043929940144e-06, "add_time_dim_to_batch_and_zero_pad": 2.223531977056592e-06}}, "connector_pipeline_timer": 4.2355532429655686e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.316620601303614e-06, "listify_data_for_vector_env": 1.0786262113454669e-05, "normalize_and_clip_actions": 9.343452661795224e-06, "tensor_to_numpy": 1.2779802161457471e-05, "get_actions": 3.5085794388615056e-05, "remove_single_ts_time_rank_from_batch": 5.737463811762843e-07}}, "connector_pipeline_timer": 9.932121896824423e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "weights_seq_no": 2.0, "episode_return_mean": 1.2, "num_env_steps_sampled_lifetime": 10400, "sample": 0.10910578461014667, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "module_episode_returns_mean": {"default_policy": 1.2}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "rlmodule_inference_timer": 2.6867209867623133e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.375787749918677e-05, "env_reset_timer": 0.0005310846772044897, "agent_episode_returns_mean": {"default_agent": 1.2}, "num_episodes_lifetime": 40, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004688017774606123, "time_between_sampling": 1.7797866670880467}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4d67b_00000", "date": "2025-08-11_19-20-55", "timestamp": 1754932855, "time_this_iter_s": 1.8379762172698975, "time_total_s": 4.213442325592041, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.213442325592041, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.79999999999999, "ram_util_percent": 81.8}}
{"timers": {"training_iteration": 2.2401250892195153, "restore_env_runners": 2.634932830696925e-05, "training_step": 2.2398312417056996, "env_runner_sampling_timer": 2.1235889030711843, "learner_update_timer": 0.11211101650142809, "synch_weights": 0.0009497006569406948, "restore_eval_env_runners": 1.7081648111343383e-05, "evaluation_iteration": 0.12177130926866084, "synch_eval_env_connectors": 0.00014434666605666282, "synch_env_connectors": 6.149475229904056e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.369887672094121e-07, "normalize_and_clip_actions": 1.0404700935885657e-05, "tensor_to_numpy": 1.447764971009453e-05, "get_actions": 4.257883169854622e-05, "listify_data_for_vector_env": 1.2326175840148286e-05, "un_batch_to_individual_items": 5.845241910279943e-06}}, "connector_pipeline_timer": 0.00011387797308516443}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -30375.0, "episode_return_mean": -2.0599999999999996, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8264547017568838e-06, "add_observations_from_episodes_to_batch": 3.187081665786584e-06, "add_time_dim_to_batch_and_zero_pad": 2.473174505877719e-06, "numpy_to_tensor": 9.513810997206108e-06, "batch_individual_items": 6.9519939682938804e-06}}, "connector_pipeline_timer": 4.694682627196447e-05}, "rlmodule_inference_timer": 3.081886800425944e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -607500.0, "episode_duration_sec_mean": 0.004971910486463456, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "module_episode_returns_mean": {"default_policy": -2.0599999999999996}, "sample": 0.005513908445504938, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.524711885856678e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.001981760738163723, "episode_return_max": 6.5, "weights_seq_no": 2.0, "env_reset_timer": 4.7741425679226733e-05, "agent_episode_returns_mean": {"default_agent": -2.0599999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3410.1375024544145}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0076261638177675195, "add_columns_from_episodes_to_train_batch": 0.034160188692726655, "add_states_from_episodes_to_batch": 3.955932485405356e-06, "add_observations_from_episodes_to_batch": 0.0008301729953731411, "add_time_dim_to_batch_and_zero_pad": 1.4119038695935158e-05, "general_advantage_estimation": 0.007175911394914147, "batch_individual_items": 0.032609029622562236, "numpy_to_tensor": 8.118012245977297e-05}}, "connector_pipeline_timer": 0.08266251758134459}, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2006406.6682902963, "num_module_steps_trained_throughput": 386998.1993767042, "num_module_steps_trained_lifetime_throughput": 384178.62024127366}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.11601883918046951, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.21789036691188812, "mean_kl_loss": 0.0014248319203034043, "vf_loss_unclipped": 31.712276458740234, "curr_kl_coeff": 0.09331203997135162, "total_loss": 0.2806500792503357, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "entropy": 0.6897167563438416, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.009776949882507324, "num_module_steps_trained_lifetime_throughput": 387955.99770991347}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.030150337070475e-06, "numpy_to_tensor": 8.122577541397276e-06, "add_states_from_episodes_to_batch": 1.6408750139321294e-06, "add_observations_from_episodes_to_batch": 2.7742533236242904e-06, "add_time_dim_to_batch_and_zero_pad": 2.227387412160907e-06}}, "connector_pipeline_timer": 4.2121942057198836e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.274577184725993e-06, "listify_data_for_vector_env": 1.0725219337953719e-05, "normalize_and_clip_actions": 9.276122063779725e-06, "tensor_to_numpy": 1.2750153373051287e-05, "get_actions": 3.448337453133542e-05, "remove_single_ts_time_rank_from_batch": 5.727221323107758e-07}}, "connector_pipeline_timer": 9.849966928633159e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "weights_seq_no": 3.0, "episode_return_mean": 1.7, "num_env_steps_sampled_lifetime": 15400, "sample": 0.10897653009345523, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "module_episode_returns_mean": {"default_policy": 1.7}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "rlmodule_inference_timer": 2.6441967828444147e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3673584582651569e-05, "env_reset_timer": 0.0005265371610410511, "agent_episode_returns_mean": {"default_agent": 1.7}, "num_episodes_lifetime": 60, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004595688185266529, "time_between_sampling": 1.778433060417883}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4d67b_00000", "date": "2025-08-11_19-20-57", "timestamp": 1754932857, "time_this_iter_s": 1.7291491031646729, "time_total_s": 5.942591428756714, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.942591428756714, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.9, "ram_util_percent": 81.85}}
{"timers": {"training_iteration": 2.2380683691672587, "restore_env_runners": 2.618375544354785e-05, "training_step": 2.2377742959589697, "env_runner_sampling_timer": 2.1215968969606, "learner_update_timer": 0.11204170175618502, "synch_weights": 0.0009482519910495029, "restore_eval_env_runners": 1.705916104838252e-05, "evaluation_iteration": 0.12156918742600828, "synch_eval_env_connectors": 0.00014409194884356112, "synch_env_connectors": 6.1492300708778204e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.251403593927855e-07, "normalize_and_clip_actions": 1.1703337429470575e-05, "tensor_to_numpy": 1.6785885314566373e-05, "get_actions": 5.1565496406490395e-05, "listify_data_for_vector_env": 1.418456681211601e-05, "un_batch_to_individual_items": 6.60881221710337e-06}}, "connector_pipeline_timer": 0.00013294590278490508}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -61250.0, "episode_return_mean": -3.0199999999999996, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.044441457226665e-06, "add_observations_from_episodes_to_batch": 3.7145475058509314e-06, "add_time_dim_to_batch_and_zero_pad": 2.854208719951822e-06, "numpy_to_tensor": 1.1122093225727894e-05, "batch_individual_items": 7.971670656541856e-06}}, "connector_pipeline_timer": 5.3246967180669895e-05}, "rlmodule_inference_timer": 3.574134284464782e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -1225000.0, "episode_duration_sec_mean": 0.005757836811710148, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "module_episode_returns_mean": {"default_policy": -3.0199999999999996}, "sample": 0.00610558142119809, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.798668637977692e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.002289447898223939, "episode_return_max": 6.5, "weights_seq_no": 3.0, "env_reset_timer": 5.603771344268001e-05, "agent_episode_returns_mean": {"default_agent": -3.0199999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3065.114368122175}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007628182179605938, "add_columns_from_episodes_to_train_batch": 0.034166303055324934, "add_states_from_episodes_to_batch": 3.9563734651310366e-06, "add_observations_from_episodes_to_batch": 0.0008304695951516042, "add_time_dim_to_batch_and_zero_pad": 1.4110348735819568e-05, "general_advantage_estimation": 0.007176462701183861, "batch_individual_items": 0.03262793849696592, "numpy_to_tensor": 8.164874192781281e-05}}, "connector_pipeline_timer": 0.08269047407566826}, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2000031.6047739794, "num_module_steps_trained_throughput": 385645.8453887793, "num_module_steps_trained_lifetime_throughput": 382905.7425470946}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.11352477222681046, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.29342687129974365, "mean_kl_loss": 0.003163272514939308, "vf_loss_unclipped": 27.08785629272461, "curr_kl_coeff": 0.04665601998567581, "total_loss": -0.23051778972148895, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "entropy": 0.6764528751373291, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.01489114761352539, "num_module_steps_trained_lifetime_throughput": 386556.40358509467}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.786617897008242e-06, "numpy_to_tensor": 9.033748802111733e-06, "add_states_from_episodes_to_batch": 1.6896223317572804e-06, "add_observations_from_episodes_to_batch": 2.965472205057326e-06, "add_time_dim_to_batch_and_zero_pad": 2.3276565993782806e-06}}, "connector_pipeline_timer": 4.651344829402965e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.94268281241407e-06, "listify_data_for_vector_env": 1.3276465834929976e-05, "normalize_and_clip_actions": 1.0417270246563453e-05, "tensor_to_numpy": 1.5329967381465235e-05, "get_actions": 4.043399902294857e-05, "remove_single_ts_time_rank_from_batch": 6.264156837703519e-07}}, "connector_pipeline_timer": 0.00011455390856875932}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "weights_seq_no": 4.0, "episode_return_mean": 0.95, "num_env_steps_sampled_lifetime": 20400, "sample": 0.109019604792148, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "module_episode_returns_mean": {"default_policy": 0.95}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "rlmodule_inference_timer": 3.0124140923947894e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.6701592301464675e-05, "env_reset_timer": 0.000525030128874816, "agent_episode_returns_mean": {"default_agent": 0.95}, "num_episodes_lifetime": 80, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.00472586301912088, "time_between_sampling": 1.7813740106436422}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4d67b_00000", "date": "2025-08-11_19-20-59", "timestamp": 1754932859, "time_this_iter_s": 2.16434907913208, "time_total_s": 8.106940507888794, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.106940507888794, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 55.633333333333326, "ram_util_percent": 82.43333333333334}}
{"timers": {"training_iteration": 2.233907350475801, "restore_env_runners": 2.5996918460199374e-05, "training_step": 2.2336136288390187, "env_runner_sampling_timer": 2.1175575734007754, "learner_update_timer": 0.11192757223911826, "synch_weights": 0.0009450548810477495, "restore_eval_env_runners": 1.7039819716475904e-05, "evaluation_iteration": 0.1216280201424472, "synch_eval_env_connectors": 0.0001450043592650909, "synch_env_connectors": 6.175237854360603e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.494340625970597e-07, "normalize_and_clip_actions": 1.0753598476990806e-05, "tensor_to_numpy": 1.5213860510255093e-05, "get_actions": 4.592509186030173e-05, "listify_data_for_vector_env": 1.2870523408437786e-05, "un_batch_to_individual_items": 6.028263853135853e-06}}, "connector_pipeline_timer": 0.00012035328600126047}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -92125.0, "episode_return_mean": -1.0199999999999996, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8734948174676917e-06, "add_observations_from_episodes_to_batch": 3.332636293331596e-06, "add_time_dim_to_batch_and_zero_pad": 2.6271472730538206e-06, "numpy_to_tensor": 1.0099795123639396e-05, "batch_individual_items": 7.352710979620881e-06}}, "connector_pipeline_timer": 4.936014548636824e-05}, "rlmodule_inference_timer": 5.4267588300748835e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -1842500.0, "episode_duration_sec_mean": 0.0057035373896360386, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "sample": 0.005637551551016674, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.638695650055047e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0019502139804712052, "episode_return_max": 6.5, "weights_seq_no": 4.0, "env_reset_timer": 4.827615415656436e-05, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3270.4100263020573}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007628994518761552, "add_columns_from_episodes_to_train_batch": 0.03420110086453311, "add_states_from_episodes_to_batch": 3.948470041403779e-06, "add_observations_from_episodes_to_batch": 0.0008300807301382337, "add_time_dim_to_batch_and_zero_pad": 1.4077165744254595e-05, "general_advantage_estimation": 0.007162190153385284, "batch_individual_items": 0.032622193691219284, "numpy_to_tensor": 8.163184383327724e-05}}, "connector_pipeline_timer": 0.08270511141565481}, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1993293.9913197677, "num_module_steps_trained_throughput": 384204.70339092467, "num_module_steps_trained_lifetime_throughput": 381554.6708012748}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.16659164428710938, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.11087483167648315, "mean_kl_loss": 0.0017101932317018509, "vf_loss_unclipped": 29.599639892578125, "curr_kl_coeff": 0.023328009992837906, "total_loss": 0.17368201911449432, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "entropy": 0.6639235019683838, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012921690940856934, "num_module_steps_trained_lifetime_throughput": 385044.74222146353}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.6652386851973415e-06, "numpy_to_tensor": 9.65519000794927e-06, "add_states_from_episodes_to_batch": 1.6112481666497138e-06, "add_observations_from_episodes_to_batch": 2.8977804638483924e-06, "add_time_dim_to_batch_and_zero_pad": 2.3488583340334954e-06}}, "connector_pipeline_timer": 4.5567753975795805e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.867366255306163e-06, "listify_data_for_vector_env": 1.2644431597992078e-05, "normalize_and_clip_actions": 9.936244255225037e-06, "tensor_to_numpy": 1.495219770071152e-05, "get_actions": 4.197548874387281e-05, "remove_single_ts_time_rank_from_batch": 6.011798603412546e-07}}, "connector_pipeline_timer": 0.00011456692458248882}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "weights_seq_no": 5.0, "episode_return_mean": 1.5, "num_env_steps_sampled_lifetime": 25400, "sample": 0.10903516624427152, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "module_episode_returns_mean": {"default_policy": 1.5}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "rlmodule_inference_timer": 2.9696024951913103e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.5946125828259443e-05, "env_reset_timer": 0.0005206410774501693, "agent_episode_returns_mean": {"default_agent": 1.5}, "num_episodes_lifetime": 100, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004786450407700613, "time_between_sampling": 1.782072520116859}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-01", "timestamp": 1754932861, "time_this_iter_s": 1.9408597946166992, "time_total_s": 10.047800302505493, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.047800302505493, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 32.266666666666666, "ram_util_percent": 83.16666666666667}}
{"timers": {"training_iteration": 2.2301288682214686, "restore_env_runners": 2.6183199472143698e-05, "training_step": 2.2298341525510965, "env_runner_sampling_timer": 2.1126630205863424, "learner_update_timer": 0.11305213651731925, "synch_weights": 0.0009419797521445439, "restore_eval_env_runners": 1.6929841071339324e-05, "evaluation_iteration": 0.12157798160010706, "synch_eval_env_connectors": 0.00014460140629969306, "synch_env_connectors": 6.154315821641358e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.728929884395643e-07, "normalize_and_clip_actions": 1.0957514930637569e-05, "tensor_to_numpy": 1.5358344724823334e-05, "get_actions": 4.6807857066859846e-05, "listify_data_for_vector_env": 1.3129016718838503e-05, "un_batch_to_individual_items": 6.194349376918481e-06}}, "connector_pipeline_timer": 0.00012265585461573267}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -123000.0, "episode_return_mean": 0.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8950858648069052e-06, "add_observations_from_episodes_to_batch": 3.2986699311126805e-06, "add_time_dim_to_batch_and_zero_pad": 2.7441651328033905e-06, "numpy_to_tensor": 1.0265025413969082e-05, "batch_individual_items": 7.323671060767259e-06}}, "connector_pipeline_timer": 4.9966239877272135e-05}, "rlmodule_inference_timer": 3.405706932717853e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -2460000.0, "episode_duration_sec_mean": 0.0053368660248816, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "module_episode_returns_mean": {"default_policy": 0.5}, "sample": 0.006089018429391594, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.6481449202384457e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0017574552712367303, "episode_return_max": 6.5, "weights_seq_no": 5.0, "env_reset_timer": 5.000383790524454e-05, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3255.3881816137778}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007635626654338483, "add_columns_from_episodes_to_train_batch": 0.03422035568588492, "add_states_from_episodes_to_batch": 3.9414861705373855e-06, "add_observations_from_episodes_to_batch": 0.0008311390837406926, "add_time_dim_to_batch_and_zero_pad": 1.4048893197212726e-05, "general_advantage_estimation": 0.007151353671624742, "batch_individual_items": 0.03382749008417332, "numpy_to_tensor": 8.148594493520072e-05}}, "connector_pipeline_timer": 0.08392594530127266}, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1986595.3206953222, "num_module_steps_trained_throughput": 382760.1027557091, "num_module_steps_trained_lifetime_throughput": 380206.8769926827}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.017227962613105774, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.14476658403873444, "mean_kl_loss": 9.704682452138513e-05, "vf_loss_unclipped": 28.372112274169922, "curr_kl_coeff": 0.011664004996418953, "total_loss": 0.20755812525749207, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "entropy": 0.6570912599563599, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.013740062713623047, "num_module_steps_trained_lifetime_throughput": 383531.281560123}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.4434980091864244e-06, "numpy_to_tensor": 8.873553109144966e-06, "add_states_from_episodes_to_batch": 1.8863507735032073e-06, "add_observations_from_episodes_to_batch": 2.974996372858545e-06, "add_time_dim_to_batch_and_zero_pad": 2.3059786505490555e-06}}, "connector_pipeline_timer": 4.467210274690887e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.548692369071507e-06, "listify_data_for_vector_env": 1.2130331201101027e-05, "normalize_and_clip_actions": 1.0412438383650656e-05, "tensor_to_numpy": 1.3898129202845747e-05, "get_actions": 3.872486209829856e-05, "remove_single_ts_time_rank_from_batch": 5.92215398989106e-07}}, "connector_pipeline_timer": 0.00010785864486336478}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "weights_seq_no": 6.0, "episode_return_mean": 2.3, "num_env_steps_sampled_lifetime": 30400, "sample": 0.10903535917208965, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "module_episode_returns_mean": {"default_policy": 2.3}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "rlmodule_inference_timer": 2.8588659752424738e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.490382015653992e-05, "env_reset_timer": 0.0005188792470369147, "agent_episode_returns_mean": {"default_agent": 2.3}, "num_episodes_lifetime": 120, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004789592470042407, "time_between_sampling": 1.7830950470052636}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-03", "timestamp": 1754932863, "time_this_iter_s": 1.977768898010254, "time_total_s": 12.025569200515747, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.025569200515747, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 51.36666666666667, "ram_util_percent": 83.46666666666667}}
{"timers": {"training_iteration": 2.2240034116182787, "restore_env_runners": 2.602427745776405e-05, "training_step": 2.2237094760252454, "env_runner_sampling_timer": 2.10665277288017, "learner_update_timer": 0.1129423689024908, "synch_weights": 0.0009398366246990515, "restore_eval_env_runners": 1.6825543155568e-05, "evaluation_iteration": 0.12155746012397299, "synch_eval_env_connectors": 0.00014422956223195934, "synch_env_connectors": 6.179023611213302e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.324338118885588e-07, "normalize_and_clip_actions": 1.0314262322698352e-05, "tensor_to_numpy": 1.4161819145458e-05, "get_actions": 4.207801160873766e-05, "listify_data_for_vector_env": 1.2252093239261617e-05, "un_batch_to_individual_items": 5.837756084925469e-06}}, "connector_pipeline_timer": 0.00011273282735315297}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -153875.0, "episode_return_mean": 0.58, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8241295761328262e-06, "add_observations_from_episodes_to_batch": 3.190826127584081e-06, "add_time_dim_to_batch_and_zero_pad": 2.485639541596932e-06, "numpy_to_tensor": 9.590540758435185e-06, "batch_individual_items": 6.8930991319398335e-06}}, "connector_pipeline_timer": 4.7018748932054905e-05}, "rlmodule_inference_timer": 3.0508093540695568e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -3077500.0, "episode_duration_sec_mean": 0.00494411252392456, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "module_episode_returns_mean": {"default_policy": 0.58}, "sample": 0.005444592506410877, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.5086938366931561e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0021790467521827987, "episode_return_max": 6.5, "weights_seq_no": 6.0, "env_reset_timer": 4.5716683652643334e-05, "agent_episode_returns_mean": {"default_agent": 0.58}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3427.6154305931736}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007639947888022565, "add_columns_from_episodes_to_train_batch": 0.03423110879912966, "add_states_from_episodes_to_batch": 3.940411530922494e-06, "add_observations_from_episodes_to_batch": 0.0008314685235411728, "add_time_dim_to_batch_and_zero_pad": 1.418465433147626e-05, "general_advantage_estimation": 0.007150644714790446, "batch_individual_items": 0.0338136239329157, "numpy_to_tensor": 8.134774488735489e-05}}, "connector_pipeline_timer": 0.0839263320985023}, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1981985.4376770775, "num_module_steps_trained_throughput": 381709.2382685364, "num_module_steps_trained_lifetime_throughput": 379255.2617831076}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.058299656957387924, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.022446408867836, "mean_kl_loss": 0.0009009736822918057, "vf_loss_unclipped": 26.70923614501953, "curr_kl_coeff": 0.0058320024982094765, "total_loss": 0.040499333292245865, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "entropy": 0.640975832939148, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.016066908836364746, "num_module_steps_trained_lifetime_throughput": 382413.43364930555}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.5724800741617914e-06, "numpy_to_tensor": 9.259998337294488e-06, "add_states_from_episodes_to_batch": 1.668728119573568e-06, "add_observations_from_episodes_to_batch": 3.1631321726396743e-06, "add_time_dim_to_batch_and_zero_pad": 2.657126387208728e-06}}, "connector_pipeline_timer": 4.599167106638711e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.964810804086429e-06, "listify_data_for_vector_env": 1.1608245665801874e-05, "normalize_and_clip_actions": 1.0096728436014326e-05, "tensor_to_numpy": 1.5067078072257392e-05, "get_actions": 4.062997490622255e-05, "remove_single_ts_time_rank_from_batch": 6.132850964354383e-07}}, "connector_pipeline_timer": 0.00011099972521633761}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "weights_seq_no": 7.0, "episode_return_mean": 2.1, "num_env_steps_sampled_lifetime": 35400, "sample": 0.10903350183023636, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "module_episode_returns_mean": {"default_policy": 2.1}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "rlmodule_inference_timer": 3.0351841473530847e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.540029863830934e-05, "env_reset_timer": 0.0005145208648477418, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_episodes_lifetime": 140, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004891569927567616, "time_between_sampling": 1.7817288623649434}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-05", "timestamp": 1754932865, "time_this_iter_s": 1.734894037246704, "time_total_s": 13.760463237762451, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.760463237762451, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 50.45, "ram_util_percent": 83.9}}
{"timers": {"training_iteration": 2.2193159741715074, "restore_env_runners": 2.5829454273287057e-05, "training_step": 2.2190230316844275, "env_runner_sampling_timer": 2.1020371064014185, "learner_update_timer": 0.11287903480377881, "synch_weights": 0.0009388028390237125, "restore_eval_env_runners": 1.6861037820273822e-05, "evaluation_iteration": 0.12149160344249457, "synch_eval_env_connectors": 0.00014501393664945745, "synch_env_connectors": 6.174733230857928e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.280717614902145e-07, "normalize_and_clip_actions": 1.0267530220942817e-05, "tensor_to_numpy": 1.4261417134225886e-05, "get_actions": 4.227063757473936e-05, "listify_data_for_vector_env": 1.21343002506112e-05, "un_batch_to_individual_items": 5.777478614139081e-06}}, "connector_pipeline_timer": 0.00011292940178292518}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -184750.0, "episode_return_mean": 0.26, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8169045776723518e-06, "add_observations_from_episodes_to_batch": 3.2461011047757042e-06, "add_time_dim_to_batch_and_zero_pad": 2.4943789285526695e-06, "numpy_to_tensor": 9.517896746339786e-06, "batch_individual_items": 7.126311600442225e-06}}, "connector_pipeline_timer": 4.729357793351444e-05}, "rlmodule_inference_timer": 5.6276519537226494e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -3695000.0, "episode_duration_sec_mean": 0.005520652175415307, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "module_episode_returns_mean": {"default_policy": 0.26}, "sample": 0.005775869812702239, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.520752531197809e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0017061232096580536, "episode_return_max": 6.5, "weights_seq_no": 7.0, "env_reset_timer": 4.388851006137501e-05, "agent_episode_returns_mean": {"default_agent": 0.26}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3481.284152122583}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007642170078814768, "add_columns_from_episodes_to_train_batch": 0.03426673771117323, "add_states_from_episodes_to_batch": 3.936006517967318e-06, "add_observations_from_episodes_to_batch": 0.0008351592486957358, "add_time_dim_to_batch_and_zero_pad": 1.4183227949349146e-05, "general_advantage_estimation": 0.007143214938320873, "batch_individual_items": 0.03384071144312729, "numpy_to_tensor": 8.128009733175743e-05}}, "connector_pipeline_timer": 0.08398701294673126}, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1978067.1533441327, "num_module_steps_trained_throughput": 380786.1202744859, "num_module_steps_trained_lifetime_throughput": 378433.38788867556}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.0506206676363945, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.0741666927933693, "mean_kl_loss": 0.002404420170933008, "vf_loss_unclipped": 26.320615768432617, "curr_kl_coeff": 0.0029160012491047382, "total_loss": -0.010954849421977997, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "entropy": 0.6119840741157532, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.016090035438537598, "num_module_steps_trained_lifetime_throughput": 381423.72441779805}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.106027107028679e-06, "numpy_to_tensor": 8.328281545165039e-06, "add_states_from_episodes_to_batch": 1.5874461346587283e-06, "add_observations_from_episodes_to_batch": 2.7507549085050653e-06, "add_time_dim_to_batch_and_zero_pad": 2.209978349981284e-06}}, "connector_pipeline_timer": 4.230020355139684e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.263648205096674e-06, "listify_data_for_vector_env": 1.0873239595283318e-05, "normalize_and_clip_actions": 9.374822590997563e-06, "tensor_to_numpy": 1.2812981368149998e-05, "get_actions": 3.582124859271658e-05, "remove_single_ts_time_rank_from_batch": 5.824828781529318e-07}}, "connector_pipeline_timer": 0.0001001696750960395}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "weights_seq_no": 8.0, "episode_return_mean": 2.7, "num_env_steps_sampled_lifetime": 40400, "sample": 0.1089394672224133, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "module_episode_returns_mean": {"default_policy": 2.7}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "rlmodule_inference_timer": 2.7052839008423193e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3917299423950694e-05, "env_reset_timer": 0.0005124719067836134, "agent_episode_returns_mean": {"default_agent": 2.7}, "num_episodes_lifetime": 160, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004909457035828382, "time_between_sampling": 1.7817522604122642}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-07", "timestamp": 1754932867, "time_this_iter_s": 1.8719100952148438, "time_total_s": 15.632373332977295, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.632373332977295, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.86666666666667, "ram_util_percent": 83.60000000000001}}
{"timers": {"training_iteration": 2.2135633298501918, "restore_env_runners": 2.564782038413044e-05, "training_step": 2.2132713684483507, "env_runner_sampling_timer": 2.095452892416585, "learner_update_timer": 0.11372002404588578, "synch_weights": 0.0009368310603519923, "restore_eval_env_runners": 1.6946177919057254e-05, "evaluation_iteration": 0.12141983781798604, "synch_eval_env_connectors": 0.00014481463800647743, "synch_env_connectors": 6.1804858304510425e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.170349027502471e-07, "normalize_and_clip_actions": 9.943862777491323e-06, "tensor_to_numpy": 1.3574612523253372e-05, "get_actions": 3.9795582000060823e-05, "listify_data_for_vector_env": 1.1763647516367048e-05, "un_batch_to_individual_items": 5.567947804317469e-06}}, "connector_pipeline_timer": 0.00010805682145693954}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -215625.0, "episode_return_mean": 1.8600000000000003, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7845321408367266e-06, "add_observations_from_episodes_to_batch": 3.038484224320621e-06, "add_time_dim_to_batch_and_zero_pad": 2.4142840178924943e-06, "numpy_to_tensor": 8.97164314984519e-06, "batch_individual_items": 6.486875155620381e-06}}, "connector_pipeline_timer": 4.506133955018825e-05}, "rlmodule_inference_timer": 2.9198101251739463e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -4312500.0, "episode_duration_sec_mean": 0.004744821367319674, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "sample": 0.0052830031719412985, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.458127793232901e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0016728822371922594, "episode_return_max": 6.5, "weights_seq_no": 8.0, "env_reset_timer": 3.893725712055919e-05, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3586.9544943021874}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008618208798204869, "add_columns_from_episodes_to_train_batch": 0.034259854084113125, "add_states_from_episodes_to_batch": 3.929976159426697e-06, "add_observations_from_episodes_to_batch": 0.0008348434962097357, "add_time_dim_to_batch_and_zero_pad": 1.4144314963423193e-05, "general_advantage_estimation": 0.007136389458995066, "batch_individual_items": 0.033818377658582435, "numpy_to_tensor": 8.10435463807171e-05}}, "connector_pipeline_timer": 0.08492582739703124}, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1974165.024733165, "num_module_steps_trained_throughput": 379867.89968958386, "num_module_steps_trained_lifetime_throughput": 377615.8995804309}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.02396991103887558, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.07479322701692581, "mean_kl_loss": 0.0008853764156810939, "vf_loss_unclipped": 26.345033645629883, "curr_kl_coeff": 0.0014580006245523691, "total_loss": 0.13819031417369843, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "entropy": 0.5902684926986694, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.01631009578704834, "num_module_steps_trained_lifetime_throughput": 380443.32807467127}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.0072212167248465e-06, "numpy_to_tensor": 8.202818957353056e-06, "add_states_from_episodes_to_batch": 1.5974121967602124e-06, "add_observations_from_episodes_to_batch": 2.740925656298018e-06, "add_time_dim_to_batch_and_zero_pad": 2.1734436086559605e-06}}, "connector_pipeline_timer": 4.19842080349007e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.240053177370972e-06, "listify_data_for_vector_env": 1.0899980279480108e-05, "normalize_and_clip_actions": 9.26271462082218e-06, "tensor_to_numpy": 1.2656097733690468e-05, "get_actions": 3.490393774010236e-05, "remove_single_ts_time_rank_from_batch": 5.812896592798337e-07}}, "connector_pipeline_timer": 9.91306949664665e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 9.0, "episode_return_mean": 3.7, "num_env_steps_sampled_lifetime": 45400, "sample": 0.10881422921998654, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "module_episode_returns_mean": {"default_policy": 3.7}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "rlmodule_inference_timer": 2.6439741165981902e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.363954596249623e-05, "env_reset_timer": 0.0005082901075847532, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_episodes_lifetime": 180, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004770407862961293, "time_between_sampling": 1.7806606903076876}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-09", "timestamp": 1754932869, "time_this_iter_s": 1.7486960887908936, "time_total_s": 17.38106942176819, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.38106942176819, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 48.3, "ram_util_percent": 83.8}}
{"timers": {"training_iteration": 2.208099193631932, "restore_env_runners": 2.5469262447647558e-05, "training_step": 2.207808080594345, "env_runner_sampling_timer": 2.089177820162256, "learner_update_timer": 0.11454029630535258, "synch_weights": 0.0009355660896813314, "restore_eval_env_runners": 1.6844636331080168e-05, "evaluation_iteration": 0.1212294161095599, "synch_eval_env_connectors": 0.00014441232147573033, "synch_env_connectors": 6.165770969825527e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.342616842466557e-07, "normalize_and_clip_actions": 1.0496283008603746e-05, "tensor_to_numpy": 1.3642262318321191e-05, "get_actions": 4.053267262329925e-05, "listify_data_for_vector_env": 1.1767409356584726e-05, "un_batch_to_individual_items": 5.542567656655484e-06}}, "connector_pipeline_timer": 0.00011044325319125823}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -246500.0, "episode_return_mean": 2.1, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7761557232232921e-06, "add_observations_from_episodes_to_batch": 3.057607917504164e-06, "add_time_dim_to_batch_and_zero_pad": 2.4412346859294255e-06, "numpy_to_tensor": 9.10220591421254e-06, "batch_individual_items": 6.767576906651031e-06}}, "connector_pipeline_timer": 4.701979643465131e-05}, "rlmodule_inference_timer": 2.9633021870319563e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -4930000.0, "episode_duration_sec_mean": 0.0048552726400084775, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "module_episode_returns_mean": {"default_policy": 2.1}, "sample": 0.005185892724311321, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4564129393812813e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.001956407790198762, "episode_return_max": 6.5, "weights_seq_no": 9.0, "env_reset_timer": 3.765311969120515e-05, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3653.8987557339906}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008610603790498684, "add_columns_from_episodes_to_train_batch": 0.03426404263321961, "add_states_from_episodes_to_batch": 3.9206766262672306e-06, "add_observations_from_episodes_to_batch": 0.0008344579821834627, "add_time_dim_to_batch_and_zero_pad": 1.4095792195364783e-05, "general_advantage_estimation": 0.007124665564513745, "batch_individual_items": 0.03479287888200831, "numpy_to_tensor": 8.09147715206418e-05}}, "connector_pipeline_timer": 0.08588397662351609}, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1972539.4062841844, "num_module_steps_trained_throughput": 379386.8543879197, "num_module_steps_trained_lifetime_throughput": 377233.63391531876}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.14334608614444733, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.07686588913202286, "mean_kl_loss": 0.0009531740797683597, "vf_loss_unclipped": 26.331432342529297, "curr_kl_coeff": 0.0007290003122761846, "total_loss": 0.14046528935432434, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "entropy": 0.5677953362464905, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.016974687576293945, "num_module_steps_trained_lifetime_throughput": 379903.42534457776}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.088639523086356e-06, "numpy_to_tensor": 8.275909739546048e-06, "add_states_from_episodes_to_batch": 1.597528539706772e-06, "add_observations_from_episodes_to_batch": 2.7780812837136194e-06, "add_time_dim_to_batch_and_zero_pad": 2.184642678042434e-06}}, "connector_pipeline_timer": 4.2347942846207954e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.277308627982644e-06, "listify_data_for_vector_env": 1.0928651136060281e-05, "normalize_and_clip_actions": 9.349951274055243e-06, "tensor_to_numpy": 1.2763112545481655e-05, "get_actions": 3.507618041095188e-05, "remove_single_ts_time_rank_from_batch": 5.803051103056058e-07}}, "connector_pipeline_timer": 9.965066390306975e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 10.0, "episode_return_mean": 2.9, "num_env_steps_sampled_lifetime": 50400, "sample": 0.10869271942784473, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "module_episode_returns_mean": {"default_policy": 2.9}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "rlmodule_inference_timer": 2.640484901928861e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3910722946028113e-05, "env_reset_timer": 0.0005044530460301945, "agent_episode_returns_mean": {"default_agent": 2.9}, "num_episodes_lifetime": 200, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.00465044577838853, "time_between_sampling": 1.7797571575753064}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-10", "timestamp": 1754932870, "time_this_iter_s": 1.7721009254455566, "time_total_s": 19.153170347213745, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.153170347213745, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.8, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 2.20074889502567, "restore_env_runners": 2.5277489976312106e-05, "training_step": 2.2004589660377873, "env_runner_sampling_timer": 2.0820327957100715, "learner_update_timer": 0.11434543667211722, "synch_weights": 0.0009326554289654926, "restore_eval_env_runners": 1.6743269640359264e-05, "evaluation_iteration": 0.12104403277828776, "synch_eval_env_connectors": 0.00014395527795397752, "synch_env_connectors": 6.144113564707006e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.848255392746315e-07, "normalize_and_clip_actions": 9.506670221271885e-06, "tensor_to_numpy": 1.3013142402137683e-05, "get_actions": 3.742431519367505e-05, "listify_data_for_vector_env": 1.1237552268145917e-05, "un_batch_to_individual_items": 5.370653923901393e-06}}, "connector_pipeline_timer": 0.00010300721401926704}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -277375.0, "episode_return_mean": 2.899999999999998, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7212234644661262e-06, "add_observations_from_episodes_to_batch": 2.9682421300371826e-06, "add_time_dim_to_batch_and_zero_pad": 2.3109275536859934e-06, "numpy_to_tensor": 8.518538319395627e-06, "batch_individual_items": 6.300416155027249e-06}}, "connector_pipeline_timer": 4.374241199975232e-05}, "rlmodule_inference_timer": 2.80052968662017e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -5547500.0, "episode_duration_sec_mean": 0.00454644981957972, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "sample": 0.004913096866559209, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3807999169598872e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0019198052462424276, "episode_return_max": 6.5, "weights_seq_no": 10.0, "env_reset_timer": 3.3437948196196194e-05, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3743.477864969943}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008602211092881725, "add_columns_from_episodes_to_train_batch": 0.03427203970799308, "add_states_from_episodes_to_batch": 3.908549228014722e-06, "add_observations_from_episodes_to_batch": 0.0008342625726783839, "add_time_dim_to_batch_and_zero_pad": 1.4054413611395459e-05, "general_advantage_estimation": 0.007114850988979142, "batch_individual_items": 0.03475874051279286, "numpy_to_tensor": 8.062187337084301e-05}}, "connector_pipeline_timer": 0.08583838435703559}, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1975784.429253643, "num_module_steps_trained_throughput": 379841.063990385, "num_module_steps_trained_lifetime_throughput": 377782.1472454489}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.028718072921037674, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.03556709364056587, "mean_kl_loss": 0.001295494264923036, "vf_loss_unclipped": 24.314098358154297, "curr_kl_coeff": 0.0003645001561380923, "total_loss": 0.02838999032974243, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "entropy": 0.5282582640647888, "weights_seq_no": 11.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0189741849899292, "num_module_steps_trained_lifetime_throughput": 380296.44517070765}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.051978310950141e-06, "numpy_to_tensor": 8.304836537508537e-06, "add_states_from_episodes_to_batch": 1.6144106491382965e-06, "add_observations_from_episodes_to_batch": 2.7670398043561214e-06, "add_time_dim_to_batch_and_zero_pad": 2.2224133024711954e-06}}, "connector_pipeline_timer": 4.2168632391352135e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.262438316835517e-06, "listify_data_for_vector_env": 1.0965898081028087e-05, "normalize_and_clip_actions": 9.386488784584357e-06, "tensor_to_numpy": 1.2805912908743477e-05, "get_actions": 3.562546986166253e-05, "remove_single_ts_time_rank_from_batch": 5.790028694958202e-07}}, "connector_pipeline_timer": 0.00010011157379114612}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 11.0, "episode_return_mean": 3.1, "num_env_steps_sampled_lifetime": 55400, "sample": 0.1085666468235054, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "module_episode_returns_mean": {"default_policy": 3.1}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "rlmodule_inference_timer": 2.6932294265298014e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3933892663833335e-05, "env_reset_timer": 0.0005001647657986253, "agent_episode_returns_mean": {"default_agent": 3.1}, "num_episodes_lifetime": 220, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004544495355803519, "time_between_sampling": 1.7768994734987573}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-12", "timestamp": 1754932872, "time_this_iter_s": 1.577542781829834, "time_total_s": 20.73071312904358, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.73071312904358, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.25, "ram_util_percent": 83.4}}
{"timers": {"training_iteration": 2.1942458473262274, "restore_env_runners": 2.5090965872047475e-05, "training_step": 2.193957116787566, "env_runner_sampling_timer": 2.075761791912714, "learner_update_timer": 0.11412438480510533, "synch_weights": 0.000928971375149024, "restore_eval_env_runners": 1.6682507139192474e-05, "evaluation_iteration": 0.12085520578131802, "synch_eval_env_connectors": 0.00014362072543938037, "synch_env_connectors": 6.172252855052544e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.863381170853048e-07, "normalize_and_clip_actions": 9.47439915620655e-06, "tensor_to_numpy": 1.300389729397835e-05, "get_actions": 3.724588643331505e-05, "listify_data_for_vector_env": 1.1152445706355652e-05, "un_batch_to_individual_items": 5.362639834571374e-06}}, "connector_pipeline_timer": 0.00010263642204570841}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -308250.0, "episode_return_mean": 3.38, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7409607799236122e-06, "add_observations_from_episodes_to_batch": 3.0033623811233446e-06, "add_time_dim_to_batch_and_zero_pad": 2.324073345924869e-06, "numpy_to_tensor": 8.528944655802521e-06, "batch_individual_items": 6.295527639208668e-06}}, "connector_pipeline_timer": 4.3745383511329345e-05}, "rlmodule_inference_timer": 2.753353517462883e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -6165000.0, "episode_duration_sec_mean": 0.004519851661752908, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "module_episode_returns_mean": {"default_policy": 3.38}, "sample": 0.004854895978130172, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.375413763607517e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018205225016757333, "episode_return_max": 6.5, "weights_seq_no": 11.0, "env_reset_timer": 3.331339421635908e-05, "agent_episode_returns_mean": {"default_agent": 3.38}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3724.7962832947696}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008592213982260616, "add_columns_from_episodes_to_train_batch": 0.03427124515080667, "add_states_from_episodes_to_batch": 3.894043666785113e-06, "add_observations_from_episodes_to_batch": 0.0008338495370166323, "add_time_dim_to_batch_and_zero_pad": 1.400219960071769e-05, "general_advantage_estimation": 0.007098774570143521, "batch_individual_items": 0.03471438060749081, "numpy_to_tensor": 8.029523454031996e-05}}, "connector_pipeline_timer": 0.08576558718327348}, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1982113.9853698194, "num_module_steps_trained_throughput": 380888.9799812517, "num_module_steps_trained_lifetime_throughput": 378920.53835167695}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.04764096066355705, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.0541551373898983, "mean_kl_loss": 0.0012555166613310575, "vf_loss_unclipped": 23.894079208374023, "curr_kl_coeff": 0.00018225007806904614, "total_loss": 0.010113202035427094, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "entropy": 0.493836909532547, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.02031266689300537, "num_module_steps_trained_lifetime_throughput": 381286.1442023841}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.059441721132826e-06, "numpy_to_tensor": 8.227454011023957e-06, "add_states_from_episodes_to_batch": 1.606154824144512e-06, "add_observations_from_episodes_to_batch": 2.8413062793334885e-06, "add_time_dim_to_batch_and_zero_pad": 2.173576684096954e-06}}, "connector_pipeline_timer": 4.248652315646929e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.229760632560094e-06, "listify_data_for_vector_env": 1.0707961427807176e-05, "normalize_and_clip_actions": 9.276294909151458e-06, "tensor_to_numpy": 1.2661186978612131e-05, "get_actions": 3.434831961595733e-05, "remove_single_ts_time_rank_from_batch": 5.798548578430319e-07}}, "connector_pipeline_timer": 9.845560363513496e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 12.0, "episode_return_mean": 2.7, "num_env_steps_sampled_lifetime": 60400, "sample": 0.10844489577526799, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "module_episode_returns_mean": {"default_policy": 2.7}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "rlmodule_inference_timer": 2.6052583876400327e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.352742002039042e-05, "env_reset_timer": 0.0004958310382439357, "agent_episode_returns_mean": {"default_agent": 2.7}, "num_episodes_lifetime": 240, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004439021628350019, "time_between_sampling": 1.7748143208439495}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-14", "timestamp": 1754932874, "time_this_iter_s": 1.6542127132415771, "time_total_s": 22.384925842285156, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.384925842285156, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.8, "ram_util_percent": 82.45}}
{"timers": {"training_iteration": 2.1881544159325905, "restore_env_runners": 2.4892135771699495e-05, "training_step": 2.187866703119305, "env_runner_sampling_timer": 2.069827023162728, "learner_update_timer": 0.11397980887673474, "synch_weights": 0.0009255937413390152, "restore_eval_env_runners": 1.6584432300258663e-05, "evaluation_iteration": 0.12066129455419487, "synch_eval_env_connectors": 0.00014321743757511363, "synch_env_connectors": 6.1501103717699574e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.902484569969024e-07, "normalize_and_clip_actions": 9.598519373523791e-06, "tensor_to_numpy": 1.323018212137779e-05, "get_actions": 3.836954421417324e-05, "listify_data_for_vector_env": 1.1359107438782586e-05, "un_batch_to_individual_items": 5.418311339906651e-06}}, "connector_pipeline_timer": 0.00010489475314917926}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -339125.0, "episode_return_mean": 3.7799999999999994, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.766798323022505e-06, "add_observations_from_episodes_to_batch": 2.9715577652266457e-06, "add_time_dim_to_batch_and_zero_pad": 2.350585684755843e-06, "numpy_to_tensor": 8.675366842112321e-06, "batch_individual_items": 6.340551399672159e-06}}, "connector_pipeline_timer": 4.4114120361129576e-05}, "rlmodule_inference_timer": 2.7814044979091464e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -6782500.0, "episode_duration_sec_mean": 0.004601624977774918, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "sample": 0.004897822724581096, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.400286158203392e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0016843180178418321, "episode_return_max": 6.5, "weights_seq_no": 12.0, "env_reset_timer": 3.444061285689736e-05, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3672.2526153609842}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008593560593086955, "add_columns_from_episodes_to_train_batch": 0.034309968529211844, "add_states_from_episodes_to_batch": 3.889683237312735e-06, "add_observations_from_episodes_to_batch": 0.0008347635416682962, "add_time_dim_to_batch_and_zero_pad": 1.3977588262310082e-05, "general_advantage_estimation": 0.007085487654953835, "batch_individual_items": 0.03468329263175115, "numpy_to_tensor": 8.011811117445364e-05}}, "connector_pipeline_timer": 0.08576156048072792}, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1988904.354700748, "num_module_steps_trained_throughput": 382030.2005546881, "num_module_steps_trained_lifetime_throughput": 380149.0974411723}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.11829666048288345, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.0575651116669178, "mean_kl_loss": 0.00026610048371367157, "vf_loss_unclipped": 23.493480682373047, "curr_kl_coeff": 9.112503903452307e-05, "total_loss": 0.006881259847432375, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "entropy": 0.47413647174835205, "weights_seq_no": 13.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.021043896675109863, "num_module_steps_trained_lifetime_throughput": 382372.98956765665}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.069578303976421e-06, "numpy_to_tensor": 8.298164568684413e-06, "add_states_from_episodes_to_batch": 1.6442641899955634e-06, "add_observations_from_episodes_to_batch": 2.779031318547103e-06, "add_time_dim_to_batch_and_zero_pad": 2.2437812549212453e-06}}, "connector_pipeline_timer": 4.211709397494017e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.275855956880935e-06, "listify_data_for_vector_env": 1.0761522246120951e-05, "normalize_and_clip_actions": 9.235350628544168e-06, "tensor_to_numpy": 1.272345085231851e-05, "get_actions": 3.4896541298473085e-05, "remove_single_ts_time_rank_from_batch": 5.8312169339162e-07}}, "connector_pipeline_timer": 9.867964842350336e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 13.0, "episode_return_mean": 1.7, "num_env_steps_sampled_lifetime": 65400, "sample": 0.10833226264691341, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "module_episode_returns_mean": {"default_policy": 1.7}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "rlmodule_inference_timer": 2.6948759326300418e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.384668744591351e-05, "env_reset_timer": 0.000491636897824573, "agent_episode_returns_mean": {"default_agent": 1.7}, "num_episodes_lifetime": 260, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004427854119567201, "time_between_sampling": 1.7730926813865644}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-15", "timestamp": 1754932875, "time_this_iter_s": 1.690351963043213, "time_total_s": 24.07527780532837, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.07527780532837, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 43.23333333333333, "ram_util_percent": 82.5}}
{"timers": {"training_iteration": 2.181991877612465, "restore_env_runners": 2.4714044988241662e-05, "training_step": 2.1817051602482582, "env_runner_sampling_timer": 2.062938102930165, "learner_update_timer": 0.11471792162852527, "synch_weights": 0.0009218153043065732, "restore_eval_env_runners": 1.6481087871085303e-05, "evaluation_iteration": 0.1204829228583856, "synch_eval_env_connectors": 0.0001428281826656345, "synch_env_connectors": 6.1311090095916165e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.871153457286017e-07, "normalize_and_clip_actions": 9.502873863792619e-06, "tensor_to_numpy": 1.3085581693327623e-05, "get_actions": 3.7716552516313486e-05, "listify_data_for_vector_env": 1.125752197037329e-05, "un_batch_to_individual_items": 5.353322331265723e-06}}, "connector_pipeline_timer": 0.00010338755976972094}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -370000.0, "episode_return_mean": 4.18, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.724501122951708e-06, "add_observations_from_episodes_to_batch": 2.9417634512471448e-06, "add_time_dim_to_batch_and_zero_pad": 2.3208038859951954e-06, "numpy_to_tensor": 8.592517616646548e-06, "batch_individual_items": 6.357595126828033e-06}}, "connector_pipeline_timer": 4.386078230168105e-05}, "rlmodule_inference_timer": 2.8043844658573996e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -7400000.0, "episode_duration_sec_mean": 0.0045600272025913, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "module_episode_returns_mean": {"default_policy": 4.18}, "sample": 0.004869947866926534, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3891531638878055e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0017120426092596317, "episode_return_max": 6.5, "weights_seq_no": 13.0, "env_reset_timer": 3.375506643159728e-05, "agent_episode_returns_mean": {"default_agent": 4.18}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3724.5206313301032}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008584022067130498, "add_columns_from_episodes_to_train_batch": 0.03431899134352723, "add_states_from_episodes_to_batch": 3.889117313804344e-06, "add_observations_from_episodes_to_batch": 0.0008348567353666017, "add_time_dim_to_batch_and_zero_pad": 1.3938222923069148e-05, "general_advantage_estimation": 0.007071959027484075, "batch_individual_items": 0.03557757595560031, "numpy_to_tensor": 7.996859043800618e-05}}, "connector_pipeline_timer": 0.08664120820664473}, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1996360.7785743899, "num_module_steps_trained_throughput": 383305.27623028075, "num_module_steps_trained_lifetime_throughput": 381507.7030404243}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.035817701369524, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.04959893226623535, "mean_kl_loss": 4.542641545413062e-05, "vf_loss_unclipped": 23.913816452026367, "curr_kl_coeff": 4.5562519517261535e-05, "total_loss": 0.11405530571937561, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "entropy": 0.47302621603012085, "weights_seq_no": 14.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.019382357597351074, "num_module_steps_trained_lifetime_throughput": 383595.1537425019}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.760598863549901e-06, "numpy_to_tensor": 8.949246037627245e-06, "add_states_from_episodes_to_batch": 1.6537836581403838e-06, "add_observations_from_episodes_to_batch": 3.0925659652527452e-06, "add_time_dim_to_batch_and_zero_pad": 2.379678808658771e-06}}, "connector_pipeline_timer": 4.532917895873373e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.585863584718284e-06, "listify_data_for_vector_env": 1.2070940388144624e-05, "normalize_and_clip_actions": 9.721658485282522e-06, "tensor_to_numpy": 1.3628719286802136e-05, "get_actions": 3.840186818628395e-05, "remove_single_ts_time_rank_from_batch": 6.631086429549165e-07}}, "connector_pipeline_timer": 0.00010703607454505628}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 14.0, "episode_return_mean": 1.5, "num_env_steps_sampled_lifetime": 70400, "sample": 0.10828572418039518, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "module_episode_returns_mean": {"default_policy": 1.5}, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "rlmodule_inference_timer": 2.872051448250604e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.4937232459664093e-05, "env_reset_timer": 0.00048750094806002456, "agent_episode_returns_mean": {"default_agent": 1.5}, "num_episodes_lifetime": 280, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.0044902616052422675, "time_between_sampling": 1.7712755108226368}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-17", "timestamp": 1754932877, "time_this_iter_s": 1.6841950416564941, "time_total_s": 25.759472846984863, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.759472846984863, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.85, "ram_util_percent": 82.85}}
{"timers": {"training_iteration": 2.1758612188367032, "restore_env_runners": 2.457940481291314e-05, "training_step": 2.1755747857359005, "env_runner_sampling_timer": 2.0561171481513347, "learner_update_timer": 0.11541592074162584, "synch_weights": 0.0009202617311616265, "restore_eval_env_runners": 1.6377116803714422e-05, "evaluation_iteration": 0.12037777279951248, "synch_eval_env_connectors": 0.0001423082302233796, "synch_env_connectors": 6.115217357306479e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.895873819868141e-07, "normalize_and_clip_actions": 9.58258526560425e-06, "tensor_to_numpy": 1.3064717773139037e-05, "get_actions": 3.762098957899743e-05, "listify_data_for_vector_env": 1.1256160214997146e-05, "un_batch_to_individual_items": 5.4031218829426566e-06}}, "connector_pipeline_timer": 0.00010347616140219579}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -400875.0, "episode_return_mean": 4.019999999999998, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.743586912175195e-06, "add_observations_from_episodes_to_batch": 3.0377795505730916e-06, "add_time_dim_to_batch_and_zero_pad": 2.3394954980865797e-06, "numpy_to_tensor": 8.561971130788974e-06, "batch_individual_items": 6.329160998974388e-06}}, "connector_pipeline_timer": 4.3917328705873006e-05}, "rlmodule_inference_timer": 2.7503564221230278e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -8017500.0, "episode_duration_sec_mean": 0.0045471648355014625, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "sample": 0.00487709625162099, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3883263452028292e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0019154864082359696, "episode_return_max": 6.5, "weights_seq_no": 14.0, "env_reset_timer": 3.438792620661441e-05, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3714.2465727959775}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008575781847118198, "add_columns_from_episodes_to_train_batch": 0.03431664267965476, "add_states_from_episodes_to_batch": 3.876896890896852e-06, "add_observations_from_episodes_to_batch": 0.0008353314971300848, "add_time_dim_to_batch_and_zero_pad": 1.387717074312971e-05, "general_advantage_estimation": 0.007059349857568533, "batch_individual_items": 0.03644608936581217, "numpy_to_tensor": 7.968973387779442e-05}}, "connector_pipeline_timer": 0.08748598654547968}, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2005061.0886337862, "num_module_steps_trained_throughput": 384824.1250207741, "num_module_steps_trained_lifetime_throughput": 383106.396026041}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.042700961232185364, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.06058907508850098, "mean_kl_loss": 0.00023884468828327954, "vf_loss_unclipped": 23.113862991333008, "curr_kl_coeff": 2.2781259758630767e-05, "total_loss": 0.004048810340464115, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "entropy": 0.452986478805542, "weights_seq_no": 15.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.02093040943145752, "num_module_steps_trained_lifetime_throughput": 385067.1605562916}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.015017526873864e-06, "numpy_to_tensor": 8.233133683470766e-06, "add_states_from_episodes_to_batch": 1.6126876755805756e-06, "add_observations_from_episodes_to_batch": 2.7642645207822773e-06, "add_time_dim_to_batch_and_zero_pad": 2.2130720047847656e-06}}, "connector_pipeline_timer": 4.224038450273369e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.309315626975435e-06, "listify_data_for_vector_env": 1.0772929865476426e-05, "normalize_and_clip_actions": 9.53652233280772e-06, "tensor_to_numpy": 1.2722755676116008e-05, "get_actions": 3.494488211852994e-05, "remove_single_ts_time_rank_from_batch": 5.905139795106887e-07}}, "connector_pipeline_timer": 9.938541100640881e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 15.0, "episode_return_mean": 1.3, "num_env_steps_sampled_lifetime": 75400, "sample": 0.10817146901825651, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "module_episode_returns_mean": {"default_policy": 1.3}, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "rlmodule_inference_timer": 2.668788753110286e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3615781071432539e-05, "env_reset_timer": 0.0004838842694647452, "agent_episode_returns_mean": {"default_agent": 1.3}, "num_episodes_lifetime": 300, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.00449147954932414, "time_between_sampling": 1.7695148636347218}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-19", "timestamp": 1754932879, "time_this_iter_s": 1.6742620468139648, "time_total_s": 27.433734893798828, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.433734893798828, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.199999999999996, "ram_util_percent": 83.2}}
{"timers": {"training_iteration": 2.168817151227956, "restore_env_runners": 2.439986039612928e-05, "training_step": 2.16853200371855, "env_runner_sampling_timer": 2.04929080708982, "learner_update_timer": 0.11520850986423459, "synch_weights": 0.0009173582840497919, "restore_eval_env_runners": 1.6285005087027846e-05, "evaluation_iteration": 0.12020364341112603, "synch_eval_env_connectors": 0.00014185472806297326, "synch_env_connectors": 6.097815225829194e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.874721764929174e-07, "normalize_and_clip_actions": 9.52314518690844e-06, "tensor_to_numpy": 1.3040467410839853e-05, "get_actions": 3.756413208990079e-05, "listify_data_for_vector_env": 1.119482145249554e-05, "un_batch_to_individual_items": 5.33334684055045e-06}}, "connector_pipeline_timer": 0.00010307935452228321}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -431750.0, "episode_return_mean": 4.66, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.740186005840192e-06, "add_observations_from_episodes_to_batch": 2.9692068393564457e-06, "add_time_dim_to_batch_and_zero_pad": 2.325676937193366e-06, "numpy_to_tensor": 8.523103335852471e-06, "batch_individual_items": 6.2737394667600354e-06}}, "connector_pipeline_timer": 4.3702249685686903e-05}, "rlmodule_inference_timer": 2.7474445983633387e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -8635000.0, "episode_duration_sec_mean": 0.00453438732633367, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "module_episode_returns_mean": {"default_policy": 4.66}, "sample": 0.0048328976799848515, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.379807065297461e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018678931379251286, "episode_return_max": 6.5, "weights_seq_no": 15.0, "env_reset_timer": 3.273894629661761e-05, "agent_episode_returns_mean": {"default_agent": 4.66}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3744.0941232636856}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008567595278213987, "add_columns_from_episodes_to_train_batch": 0.034313638343582545, "add_states_from_episodes_to_batch": 3.869377286825887e-06, "add_observations_from_episodes_to_batch": 0.0008349165219994047, "add_time_dim_to_batch_and_zero_pad": 1.3835478936723113e-05, "general_advantage_estimation": 0.007044491768252644, "batch_individual_items": 0.03640157722153796, "numpy_to_tensor": 7.946949634322654e-05}}, "connector_pipeline_timer": 0.08741413625898303}, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2013449.532845155, "num_module_steps_trained_throughput": 386292.2989547782, "num_module_steps_trained_lifetime_throughput": 384649.9187122753}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.11287917196750641, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.1539374142885208, "mean_kl_loss": 0.0002914517535828054, "vf_loss_unclipped": 24.324419021606445, "curr_kl_coeff": 1.1390629879315384e-05, "total_loss": 0.21866542100906372, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "entropy": 0.4430331587791443, "weights_seq_no": 16.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.018616795539855957, "num_module_steps_trained_lifetime_throughput": 386495.27473401395}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.952630081938605e-06, "numpy_to_tensor": 8.238729046918153e-06, "add_states_from_episodes_to_batch": 1.5695485080740577e-06, "add_observations_from_episodes_to_batch": 2.7559699107805814e-06, "add_time_dim_to_batch_and_zero_pad": 2.183420366450309e-06}}, "connector_pipeline_timer": 4.200257736185571e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.244436004117564e-06, "listify_data_for_vector_env": 1.078963966586386e-05, "normalize_and_clip_actions": 9.346067458432529e-06, "tensor_to_numpy": 1.258456574423125e-05, "get_actions": 3.454432358628286e-05, "remove_single_ts_time_rank_from_batch": 5.803731244177311e-07}}, "connector_pipeline_timer": 9.864412320371162e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 16.0, "episode_return_mean": 0.5, "num_env_steps_sampled_lifetime": 80400, "sample": 0.10805196349875817, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "module_episode_returns_mean": {"default_policy": 0.5}, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "rlmodule_inference_timer": 2.659297914537207e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3551203224431901e-05, "env_reset_timer": 0.000479731676465816, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_episodes_lifetime": 320, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004493023328250274, "time_between_sampling": 1.7667198874978487}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-20", "timestamp": 1754932880, "time_this_iter_s": 1.5751628875732422, "time_total_s": 29.00889778137207, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.00889778137207, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 39.8, "ram_util_percent": 83.0}}
{"timers": {"training_iteration": 2.163630396795384, "restore_env_runners": 2.4212531606680122e-05, "training_step": 2.163346327851181, "env_runner_sampling_timer": 2.0443126156890714, "learner_update_timer": 0.11500746601654756, "synch_weights": 0.0009172334511348627, "restore_eval_env_runners": 1.6212984598553377e-05, "evaluation_iteration": 0.12001393989723266, "synch_eval_env_connectors": 0.00014141701130087234, "synch_env_connectors": 6.0972566255990816e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.10721429149698e-07, "normalize_and_clip_actions": 9.845143052711014e-06, "tensor_to_numpy": 1.4183028874606492e-05, "get_actions": 3.994084263173965e-05, "listify_data_for_vector_env": 1.1717332487519231e-05, "un_batch_to_individual_items": 6.477023875628504e-06}}, "connector_pipeline_timer": 0.00010963860276154464}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -462625.0, "episode_return_mean": 4.18, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7706793901765429e-06, "add_observations_from_episodes_to_batch": 3.4734873260205446e-06, "add_time_dim_to_batch_and_zero_pad": 2.398481489100562e-06, "numpy_to_tensor": 9.03870315183632e-06, "batch_individual_items": 6.58950873904173e-06}}, "connector_pipeline_timer": 4.642098406171946e-05}, "rlmodule_inference_timer": 4.711407065337171e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -9252500.0, "episode_duration_sec_mean": 0.005202627330552787, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "module_episode_returns_mean": {"default_policy": 4.18}, "sample": 0.005200317365357758, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4671671396045597e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0015403258828630315, "episode_return_max": 6.5, "weights_seq_no": 16.0, "env_reset_timer": 3.39252178931443e-05, "agent_episode_returns_mean": {"default_agent": 4.18}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3644.6805518942783}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008557492245463693, "add_columns_from_episodes_to_train_batch": 0.034312084880083346, "add_states_from_episodes_to_batch": 3.8586034005913826e-06, "add_observations_from_episodes_to_batch": 0.000837049856853842, "add_time_dim_to_batch_and_zero_pad": 1.3840874950900998e-05, "general_advantage_estimation": 0.007031516850453441, "batch_individual_items": 0.03634978394895579, "numpy_to_tensor": 7.923272180964985e-05}}, "connector_pipeline_timer": 0.08733893072721914}, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2018153.7987724482, "num_module_steps_trained_throughput": 387063.6227056694, "num_module_steps_trained_lifetime_throughput": 385493.4036659675}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.03710363060235977, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.05162852257490158, "mean_kl_loss": 0.0007178370142355561, "vf_loss_unclipped": 23.931560516357422, "curr_kl_coeff": 5.695314939657692e-06, "total_loss": 0.11662331223487854, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "entropy": 0.4135804772377014, "weights_seq_no": 17.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.019191503524780273, "num_module_steps_trained_lifetime_throughput": 387228.45597321977}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.970549306158213e-06, "numpy_to_tensor": 8.204020914493522e-06, "add_states_from_episodes_to_batch": 1.6196379183583123e-06, "add_observations_from_episodes_to_batch": 2.75786851947662e-06, "add_time_dim_to_batch_and_zero_pad": 2.2222756621291123e-06}}, "connector_pipeline_timer": 4.196887012347448e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.202069868693574e-06, "listify_data_for_vector_env": 1.0778343235103413e-05, "normalize_and_clip_actions": 9.180139743951029e-06, "tensor_to_numpy": 1.2563450820240686e-05, "get_actions": 3.4712876042007934e-05, "remove_single_ts_time_rank_from_batch": 5.746537720696686e-07}}, "connector_pipeline_timer": 9.827200801208128e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 17.0, "episode_return_mean": -0.1, "num_env_steps_sampled_lifetime": 85400, "sample": 0.10793645927351773, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "module_episode_returns_mean": {"default_policy": -0.1}, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "rlmodule_inference_timer": 2.656079110788735e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3630127854433316e-05, "env_reset_timer": 0.00047563518925178175, "agent_episode_returns_mean": {"default_agent": -0.1}, "num_episodes_lifetime": 340, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004488825426669792, "time_between_sampling": 1.765750673212134}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-22", "timestamp": 1754932882, "time_this_iter_s": 1.754417896270752, "time_total_s": 30.763315677642822, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.763315677642822, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 46.849999999999994, "ram_util_percent": 83.25}}
{"timers": {"training_iteration": 2.1594592069971843, "restore_env_runners": 2.403582588071397e-05, "training_step": 2.1591761399926828, "env_runner_sampling_timer": 2.0389685724519495, "learner_update_timer": 0.11618785885594182, "synch_weights": 0.0009151473661575547, "restore_eval_env_runners": 1.6162524985877113e-05, "evaluation_iteration": 0.11983195924863607, "synch_eval_env_connectors": 0.00014098201162390317, "synch_env_connectors": 6.08669422200059e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.312864426781797e-07, "normalize_and_clip_actions": 1.0209877516714425e-05, "tensor_to_numpy": 1.4219659616310696e-05, "get_actions": 4.182705606747262e-05, "listify_data_for_vector_env": 1.2005614467441014e-05, "un_batch_to_individual_items": 5.710444867775645e-06}}, "connector_pipeline_timer": 0.00011205591062813972}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -493500.0, "episode_return_mean": 3.5400000000000005, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8126564061942806e-06, "add_observations_from_episodes_to_batch": 3.1707457254118047e-06, "add_time_dim_to_batch_and_zero_pad": 2.5075312489610923e-06, "numpy_to_tensor": 9.343178598077972e-06, "batch_individual_items": 6.919056574712578e-06}}, "connector_pipeline_timer": 4.70832176572535e-05}, "rlmodule_inference_timer": 3.0304666429104704e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -9870000.0, "episode_duration_sec_mean": 0.004936662468593568, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "sample": 0.0054620306720502155, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.5176268705367447e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0015444551722246542, "episode_return_max": 6.5, "weights_seq_no": 17.0, "env_reset_timer": 3.9993097934824545e-05, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3508.857440515327}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008572028573076186, "add_columns_from_episodes_to_train_batch": 0.03432336153075069, "add_states_from_episodes_to_batch": 3.851266731423473e-06, "add_observations_from_episodes_to_batch": 0.0008428814384866612, "add_time_dim_to_batch_and_zero_pad": 1.3817886172217303e-05, "general_advantage_estimation": 0.007026658352657861, "batch_individual_items": 0.03762489860869398, "numpy_to_tensor": 7.907998502628342e-05}}, "connector_pipeline_timer": 0.08864147184058221}, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2020934.9922502935, "num_module_steps_trained_throughput": 387474.72373388323, "num_module_steps_trained_lifetime_throughput": 385973.1635859342}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.08192838728427887, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.20676639676094055, "mean_kl_loss": 0.000187661949894391, "vf_loss_unclipped": 25.955707550048828, "curr_kl_coeff": 2.847657469828846e-06, "total_loss": 0.271775484085083, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "entropy": 0.41199925541877747, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.01664602756500244, "num_module_steps_trained_lifetime_throughput": 387601.3193931414}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.27127553044956e-06, "numpy_to_tensor": 8.585304226541896e-06, "add_states_from_episodes_to_batch": 1.628193875946755e-06, "add_observations_from_episodes_to_batch": 2.887433901423929e-06, "add_time_dim_to_batch_and_zero_pad": 2.3027616958683924e-06}}, "connector_pipeline_timer": 4.3228603491390155e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.49842388600856e-06, "listify_data_for_vector_env": 1.1360158837189052e-05, "normalize_and_clip_actions": 9.633160121261044e-06, "tensor_to_numpy": 1.3279220893145737e-05, "get_actions": 3.666708792151887e-05, "remove_single_ts_time_rank_from_batch": 6.086874316552916e-07}}, "connector_pipeline_timer": 0.00010312047911627892}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 18.0, "episode_return_mean": 0.1, "num_env_steps_sampled_lifetime": 90400, "sample": 0.10791956343095206, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "rlmodule_inference_timer": 2.7685719394371385e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.4396840949315737e-05, "env_reset_timer": 0.00047175466707827094, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_episodes_lifetime": 360, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004565946278162301, "time_between_sampling": 1.765765052729458}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-24", "timestamp": 1754932884, "time_this_iter_s": 1.8613858222961426, "time_total_s": 32.624701499938965, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.624701499938965, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 50.26666666666667, "ram_util_percent": 83.5}}
{"timers": {"training_iteration": 2.158144487007058, "restore_env_runners": 2.3857967515736055e-05, "training_step": 2.157862146502912, "env_runner_sampling_timer": 2.036541327147372, "learner_update_timer": 0.11730918151763006, "synch_weights": 0.0009127338122531218, "restore_eval_env_runners": 1.607089910487966e-05, "evaluation_iteration": 0.11975674506593768, "synch_eval_env_connectors": 0.00014057635165668706, "synch_env_connectors": 6.067486502696352e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.579856175281458e-07, "normalize_and_clip_actions": 1.2271628150191165e-05, "tensor_to_numpy": 1.6337821511336496e-05, "get_actions": 5.1870639662087644e-05, "listify_data_for_vector_env": 1.4098892571424777e-05, "un_batch_to_individual_items": 7.481711591432265e-06}}, "connector_pipeline_timer": 0.00013371732571907874}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -524375.0, "episode_return_mean": 4.259999999999998, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9281267812953793e-06, "add_observations_from_episodes_to_batch": 4.18539722179962e-06, "add_time_dim_to_batch_and_zero_pad": 2.7360315705045404e-06, "numpy_to_tensor": 1.1160135959857369e-05, "batch_individual_items": 7.939393172952142e-06}}, "connector_pipeline_timer": 5.336562023124154e-05}, "rlmodule_inference_timer": 3.9245306552157e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -10487500.0, "episode_duration_sec_mean": 0.005891083468217403, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "module_episode_returns_mean": {"default_policy": 4.259999999999998}, "sample": 0.006172978893703488, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.1437046609251176e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0022898518379090575, "episode_return_max": 6.5, "weights_seq_no": 18.0, "env_reset_timer": 4.988501914297677e-05, "agent_episode_returns_mean": {"default_agent": 4.259999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3251.2069520989166}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008564827867765532, "add_columns_from_episodes_to_train_batch": 0.03437397291551464, "add_states_from_episodes_to_batch": 3.851504068132552e-06, "add_observations_from_episodes_to_batch": 0.000842631793482832, "add_time_dim_to_batch_and_zero_pad": 1.3902618204576125e-05, "general_advantage_estimation": 0.007034302179604405, "batch_individual_items": 0.03878684920358006, "numpy_to_tensor": 7.904126540792557e-05}}, "connector_pipeline_timer": 0.08985381920201692}, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2018115.5481642766, "num_module_steps_trained_throughput": 386823.03734611854, "num_module_steps_trained_lifetime_throughput": 385387.94034081814}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.08828224986791611, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.06076934561133385, "mean_kl_loss": 0.00026499663363210857, "vf_loss_unclipped": 23.938852310180664, "curr_kl_coeff": 1.423828734914423e-06, "total_loss": 0.12606894969940186, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "entropy": 0.37992289662361145, "weights_seq_no": 19.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.019092679023742676, "num_module_steps_trained_lifetime_throughput": 386914.66435814253}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.343189998614259e-06, "numpy_to_tensor": 9.068323806251208e-06, "add_states_from_episodes_to_batch": 1.627602947858497e-06, "add_observations_from_episodes_to_batch": 2.8923139495572476e-06, "add_time_dim_to_batch_and_zero_pad": 2.2991027230133966e-06}}, "connector_pipeline_timer": 4.411252947465887e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.721842730930162e-06, "listify_data_for_vector_env": 1.1733331701009051e-05, "normalize_and_clip_actions": 9.802810249544535e-06, "tensor_to_numpy": 1.3918358631042884e-05, "get_actions": 3.833923585981624e-05, "remove_single_ts_time_rank_from_batch": 6.048804741338508e-07}}, "connector_pipeline_timer": 0.00010666640300433125}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 19.0, "episode_return_mean": 0.1, "num_env_steps_sampled_lifetime": 95400, "sample": 0.10793099570651335, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "rlmodule_inference_timer": 2.8805170681257718e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.5012121154925852e-05, "env_reset_timer": 0.0004814483698383384, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_episodes_lifetime": 380, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004572917533805594, "time_between_sampling": 1.7686472451125295}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-26", "timestamp": 1754932886, "time_this_iter_s": 2.1501400470733643, "time_total_s": 34.77484154701233, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.77484154701233, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 58.36666666666667, "ram_util_percent": 83.76666666666667}}
{"timers": {"training_iteration": 2.1516411854770574, "restore_env_runners": 2.368272825303151e-05, "training_step": 2.1513596658679437, "env_runner_sampling_timer": 2.0302863559557345, "learner_update_timer": 0.11707160428221366, "synch_weights": 0.0009092848037473757, "restore_eval_env_runners": 1.6023940688941177e-05, "evaluation_iteration": 0.11975482345518552, "synch_eval_env_connectors": 0.00014023892922021954, "synch_env_connectors": 6.049731638520543e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.935936849927024e-07, "normalize_and_clip_actions": 9.698379406498073e-06, "tensor_to_numpy": 1.3318808588805264e-05, "get_actions": 3.853906400048709e-05, "listify_data_for_vector_env": 1.1453059108850254e-05, "un_batch_to_individual_items": 5.475459829199049e-06}}, "connector_pipeline_timer": 0.00010530696550372223}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -13.5, "num_episodes_lifetime": -555250.0, "episode_return_mean": 5.380000000000001, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7465174540096961e-06, "add_observations_from_episodes_to_batch": 3.024301450158749e-06, "add_time_dim_to_batch_and_zero_pad": 2.361469709298255e-06, "numpy_to_tensor": 8.754049554419788e-06, "batch_individual_items": 6.388310008167698e-06}}, "connector_pipeline_timer": 4.434741812077221e-05}, "rlmodule_inference_timer": 2.8337519350577802e-05, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -11105000.0, "episode_duration_sec_mean": 0.004626900513656438, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "sample": 0.005227632368581659, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4107613024643982e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.002198596147545221, "episode_return_max": 6.5, "weights_seq_no": 19.0, "env_reset_timer": 4.2721576845047165e-05, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3647.835679012038}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008555465838183451, "add_columns_from_episodes_to_train_batch": 0.03437001818690167, "add_states_from_episodes_to_batch": 3.8392395183699815e-06, "add_observations_from_episodes_to_batch": 0.0008424163052399652, "add_time_dim_to_batch_and_zero_pad": 1.3840261989332363e-05, "general_advantage_estimation": 0.007020103737820549, "batch_individual_items": 0.03871495279153283, "numpy_to_tensor": 7.88491925834402e-05}}, "connector_pipeline_timer": 0.08975324350977919}, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2019342.7599060095, "num_module_steps_trained_throughput": 386949.6620096079, "num_module_steps_trained_lifetime_throughput": 385576.9494548482}, "default_policy": {"num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.03705389052629471, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.010907428339123726, "mean_kl_loss": 1.596551010152325e-05, "vf_loss_unclipped": 22.31365966796875, "curr_kl_coeff": 7.119143674572115e-07, "total_loss": 0.05449638143181801, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "entropy": 0.36841875314712524, "weights_seq_no": 20.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.02270638942718506, "num_module_steps_trained_lifetime_throughput": 387007.27537338756}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.15339945962026e-06, "numpy_to_tensor": 8.531981240722029e-06, "add_states_from_episodes_to_batch": 1.6189600108991145e-06, "add_observations_from_episodes_to_batch": 2.8070892373496302e-06, "add_time_dim_to_batch_and_zero_pad": 2.2160451363705175e-06}}, "connector_pipeline_timer": 4.270094854135713e-05}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.522197926904883e-06, "listify_data_for_vector_env": 1.1164355304795808e-05, "normalize_and_clip_actions": 9.636183146420581e-06, "tensor_to_numpy": 1.340812252736367e-05, "get_actions": 3.620772115747928e-05, "remove_single_ts_time_rank_from_batch": 5.905550719182031e-07}}, "connector_pipeline_timer": 0.00010274126546748141}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 20.0, "episode_return_mean": 0.7, "num_env_steps_sampled_lifetime": 100400, "sample": 0.10785336157920522, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "module_episode_returns_mean": {"default_policy": 0.7}, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "rlmodule_inference_timer": 2.7503302247523265e-05, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.4246566357056135e-05, "env_reset_timer": 0.00047738471607130357, "agent_episode_returns_mean": {"default_agent": 0.7}, "num_episodes_lifetime": 400, "episode_return_min": -15.5, "episode_len_max": 20, "episode_duration_sec_mean": 0.004603318319423125, "time_between_sampling": 1.7663237918213992}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4d67b_00000", "date": "2025-08-11_19-21-28", "timestamp": 1754932888, "time_this_iter_s": 1.6158678531646729, "time_total_s": 36.390709400177, "pid": 14262, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a1e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.390709400177, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.55, "ram_util_percent": 80.75}}
