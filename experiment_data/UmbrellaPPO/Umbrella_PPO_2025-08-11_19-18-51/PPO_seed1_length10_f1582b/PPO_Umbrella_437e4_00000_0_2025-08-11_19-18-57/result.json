{"timers": {"training_iteration": 1.618452624999918, "restore_env_runners": 1.0834075510501862e-05, "training_step": 1.6183279589749873, "env_runner_sampling_timer": 1.5042754579335451, "learner_update_timer": 0.11099750001449138, "synch_weights": 0.0006188750267028809}, "env_runners": {"env_reset_timer": 8.118188768956486e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.463002305847304e-05, "tensor_to_numpy": 1.4019490557259137e-05, "un_batch_to_individual_items": 5.952573219818643e-06, "listify_data_for_vector_env": 1.1483047366151108e-05, "normalize_and_clip_actions": 1.4298465086037649e-05, "remove_single_ts_time_rank_from_batch": 6.293570966442164e-07}}, "connector_pipeline_timer": 0.00016764717543831336}, "episode_duration_sec_mean": 0.005041487679351122, "num_episodes_lifetime": 31375.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.323314772479892e-06, "add_states_from_episodes_to_batch": 1.7819003762595334e-06, "add_observations_from_episodes_to_batch": 3.1568688302100494e-06, "batch_individual_items": 6.620764195255867e-06, "add_time_dim_to_batch_and_zero_pad": 2.567851226540855e-06}}, "connector_pipeline_timer": 4.7014981923351284e-05}, "episode_return_mean": -0.09999999999999998, "agent_episode_returns_mean": {"default_agent": -0.09999999999999998}, "sample": 0.007185815200696718, "module_episode_returns_mean": {"default_policy": -0.09999999999999998}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 0.0, "env_step_timer": 1.539586432009969e-05, "episode_len_min": 20, "rlmodule_inference_timer": 5.081849761406366e-05, "num_env_steps_sampled_lifetime": 627500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "time_between_sampling": 0.0005319140074591303, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3445.9460288385994}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008225829806178808, "add_columns_from_episodes_to_train_batch": 0.03475541598163545, "add_time_dim_to_batch_and_zero_pad": 1.1541997082531452e-05, "batch_individual_items": 0.030420165974646807, "numpy_to_tensor": 7.420801557600498e-05, "add_states_from_episodes_to_batch": 3.5410048440098763e-06, "general_advantage_estimation": 0.00667941605206579, "add_one_ts_to_episodes_and_truncate": 0.007656874950043857}}, "connector_pipeline_timer": 0.08057216694578528}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1804412.345471721, "num_module_steps_trained_throughput": 345254.18134301266, "num_module_steps_trained_lifetime_throughput": 344773.3793315129}, "default_policy": {"weights_seq_no": 1.0, "vf_loss_unclipped": 28.586095809936523, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 6000, "gradients_default_optimizer_global_norm": 0.026657981798052788, "policy_loss": -0.0474664680659771, "curr_kl_coeff": 0.3732481598854065, "total_loss": 0.015051513910293579, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6927757263183594, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.011646151542663574, "num_module_steps_trained": 6000, "mean_kl_loss": 6.952471449039876e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 346130.88164946367}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 400}, "sample": 0.11006620805710554, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.143904104913818e-06, "add_states_from_episodes_to_batch": 1.7177085750936217e-06, "add_observations_from_episodes_to_batch": 3.304165277482859e-06, "add_time_dim_to_batch_and_zero_pad": 2.55984714161239e-06, "numpy_to_tensor": 1.0427474226235087e-05}}, "connector_pipeline_timer": 4.986011951813184e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.426944699400084e-05, "num_env_steps_sampled_lifetime": 5400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.80726795388211e-06, "listify_data_for_vector_env": 1.2122967192435728e-05, "normalize_and_clip_actions": 1.1630704365962788e-05, "remove_single_ts_time_rank_from_batch": 6.102849178359877e-07, "get_actions": 4.574888121910245e-05, "tensor_to_numpy": 1.6280442412046498e-05}}, "connector_pipeline_timer": 0.00011998928714574747}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "weights_seq_no": 1.0, "env_step_timer": 1.629077312341806e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.2}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_reset_timer": 0.00013879197649657726, "episode_duration_sec_mean": 0.005002679093740881, "episode_return_mean": 1.2, "num_episodes_lifetime": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 1.2}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-20", "timestamp": 1754933060, "time_this_iter_s": 1.736541986465454, "time_total_s": 1.736541986465454, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.736541986465454, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.7, "ram_util_percent": 77.7}}
{"timers": {"training_iteration": 1.6180657775001601, "restore_env_runners": 1.0786565253511071e-05, "training_step": 1.6179404427250847, "env_runner_sampling_timer": 1.5031491800234653, "learner_update_timer": 0.11173263459349983, "synch_weights": 0.0006193758558947593, "restore_eval_env_runners": 8.416944183409214e-06, "evaluation_iteration": 0.11648537509609014, "synch_eval_env_connectors": 0.00013754202518612146, "synch_env_connectors": 4.040892235934734e-06}, "env_runners": {"env_reset_timer": 4.3010080376867485e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.860350167841842e-05, "tensor_to_numpy": 1.3258167704670476e-05, "un_batch_to_individual_items": 5.510302583365202e-06, "listify_data_for_vector_env": 1.106181585639012e-05, "normalize_and_clip_actions": 9.641532692406718e-06, "remove_single_ts_time_rank_from_batch": 5.96298913676019e-07}}, "connector_pipeline_timer": 0.00010438444159892665}, "episode_duration_sec_mean": 0.004564453278668224, "num_episodes_lifetime": 500.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.824555611477396e-06, "add_states_from_episodes_to_batch": 1.7475539012682254e-06, "add_observations_from_episodes_to_batch": 2.919488282402341e-06, "batch_individual_items": 6.375283303893403e-06, "add_time_dim_to_batch_and_zero_pad": 2.440446439537226e-06}}, "connector_pipeline_timer": 4.410882025712033e-05}, "episode_return_mean": -0.8199999999999998, "agent_episode_returns_mean": {"default_agent": -0.8199999999999998}, "sample": 0.0054239970849594065, "module_episode_returns_mean": {"default_policy": -0.8199999999999998}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 1.0, "env_step_timer": 1.3986764432410433e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.8076708999002086e-05, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0015604696523352985, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3666.599539371018}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008225892414338887, "add_columns_from_episodes_to_train_batch": 0.0347505626513157, "add_time_dim_to_batch_and_zero_pad": 1.1549077462404967e-05, "batch_individual_items": 0.03132592389592901, "numpy_to_tensor": 7.421885500662029e-05, "add_states_from_episodes_to_batch": 3.5380944609642025e-06, "general_advantage_estimation": 0.006666970221558586, "add_one_ts_to_episodes_and_truncate": 0.007655010781018064}}, "connector_pipeline_timer": 0.08145827069645747}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1806668.813031432, "num_module_steps_trained_throughput": 345666.64542275673, "num_module_steps_trained_lifetime_throughput": 345190.05522584775}, "default_policy": {"weights_seq_no": 2.0, "vf_loss_unclipped": 28.918132781982422, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 12000, "gradients_default_optimizer_global_norm": 0.09095917642116547, "policy_loss": 0.01986965350806713, "curr_kl_coeff": 0.18662407994270325, "total_loss": 0.08293826133012772, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6898306608200073, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.012287616729736328, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0015428205952048302, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 346520.88379219285}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 800}, "sample": 0.10998024014639668, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.2172686068412185e-06, "add_states_from_episodes_to_batch": 1.6383575592680588e-06, "add_observations_from_episodes_to_batch": 2.8191184086390047e-06, "add_time_dim_to_batch_and_zero_pad": 2.288507208996419e-06, "numpy_to_tensor": 8.611402959867801e-06}}, "connector_pipeline_timer": 4.3502011160093775e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.85929539679189e-05, "num_env_steps_sampled_lifetime": 10400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.44682804276152e-06, "listify_data_for_vector_env": 1.1007517910113579e-05, "normalize_and_clip_actions": 9.597466164960745e-06, "remove_single_ts_time_rank_from_batch": 5.879385537643435e-07, "get_actions": 3.746572904370801e-05, "tensor_to_numpy": 1.330652545595892e-05}}, "connector_pipeline_timer": 0.00010360798689425563}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "weights_seq_no": 2.0, "env_step_timer": 1.4139138596422457e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.7}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_reset_timer": 0.0001381828065495938, "episode_duration_sec_mean": 0.004819036441040226, "episode_return_mean": 0.7, "num_episodes_lifetime": 40, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "module_episode_returns_mean": {"default_policy": 0.7}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6080040000379086}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-22", "timestamp": 1754933062, "time_this_iter_s": 1.6886098384857178, "time_total_s": 3.425151824951172, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.425151824951172, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.0, "ram_util_percent": 78.0}}
{"timers": {"training_iteration": 1.6174645884762517, "restore_env_runners": 1.0751619830261916e-05, "training_step": 1.6173385187078266, "env_runner_sampling_timer": 1.5026942894730948, "learner_update_timer": 0.11158331908757099, "synch_weights": 0.000619340427115094, "restore_eval_env_runners": 8.418194483965636e-06, "evaluation_iteration": 0.11638841967564076, "synch_eval_env_connectors": 0.00013725493452511727, "synch_env_connectors": 4.0467327926307915e-06}, "env_runners": {"env_reset_timer": 4.375378959079664e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.083591237456603e-05, "tensor_to_numpy": 1.3734854748939897e-05, "un_batch_to_individual_items": 5.740005019832747e-06, "listify_data_for_vector_env": 1.1382100051115466e-05, "normalize_and_clip_actions": 9.983424438807118e-06, "remove_single_ts_time_rank_from_batch": 6.160598101071746e-07}}, "connector_pipeline_timer": 0.00010863751275481126}, "episode_duration_sec_mean": 0.004760776821989567, "num_episodes_lifetime": -30375.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.221897548348673e-06, "add_states_from_episodes_to_batch": 1.7771814513154944e-06, "add_observations_from_episodes_to_batch": 3.0562255164904955e-06, "batch_individual_items": 6.578877075120634e-06, "add_time_dim_to_batch_and_zero_pad": 2.5260029012206515e-06}}, "connector_pipeline_timer": 4.539240390136204e-05}, "episode_return_mean": 0.22, "agent_episode_returns_mean": {"default_agent": 0.22}, "sample": 0.005099682674576485, "module_episode_returns_mean": {"default_policy": 0.22}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 2.0, "env_step_timer": 1.4631812488881561e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.9127776428119464e-05, "num_env_steps_sampled_lifetime": -607500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018898250440934463, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3537.5952257742365}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008229812679579482, "add_columns_from_episodes_to_train_batch": 0.03476085327424807, "add_time_dim_to_batch_and_zero_pad": 1.1562337377108635e-05, "batch_individual_items": 0.03132135173736606, "numpy_to_tensor": 7.418333656387404e-05, "add_states_from_episodes_to_batch": 3.5339628811925644e-06, "general_advantage_estimation": 0.006658254269126337, "add_one_ts_to_episodes_and_truncate": 0.007656568173656706}}, "connector_pipeline_timer": 0.08145683382956777}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1810843.566940829, "num_module_steps_trained_throughput": 346432.1922811194, "num_module_steps_trained_lifetime_throughput": 345962.6892770381}, "default_policy": {"weights_seq_no": 3.0, "vf_loss_unclipped": 28.84691619873047, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 18000, "gradients_default_optimizer_global_norm": 0.04352671653032303, "policy_loss": 0.05581562593579292, "curr_kl_coeff": 0.09331203997135162, "total_loss": 0.11864931136369705, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6824526190757751, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.014024496078491211, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0014687618240714073, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 347249.5851774601}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "sample": 0.10994866399528691, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.450641746632598e-06, "add_states_from_episodes_to_batch": 1.6606915570824504e-06, "add_observations_from_episodes_to_batch": 3.040338879277946e-06, "add_time_dim_to_batch_and_zero_pad": 2.457169081649303e-06, "numpy_to_tensor": 9.076556596921665e-06}}, "connector_pipeline_timer": 4.4979795556781847e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.04635555427044e-05, "num_env_steps_sampled_lifetime": 15400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.857461903649722e-06, "listify_data_for_vector_env": 1.151503132545103e-05, "normalize_and_clip_actions": 9.742043868804959e-06, "remove_single_ts_time_rank_from_batch": 5.977727003246227e-07, "get_actions": 3.9066261868493444e-05, "tensor_to_numpy": 1.4077536970839164e-05}}, "connector_pipeline_timer": 0.000108423697725169}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "weights_seq_no": 3.0, "env_step_timer": 1.4669160300978181e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.5333333333333333}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_reset_timer": 0.00013766014917055143, "episode_duration_sec_mean": 0.004840993091541653, "episode_return_mean": 0.5333333333333333, "num_episodes_lifetime": 60, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "module_episode_returns_mean": {"default_policy": 0.5333333333333333}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6076872996171006}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-24", "timestamp": 1754933064, "time_this_iter_s": 1.6724400520324707, "time_total_s": 5.097591876983643, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.097591876983643, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.56666666666666, "ram_util_percent": 77.83333333333334}}
{"timers": {"training_iteration": 1.617191775501511, "restore_env_runners": 1.0716193820000626e-05, "training_step": 1.6170646376807913, "env_runner_sampling_timer": 1.5026249282483874, "learner_update_timer": 0.11137722673654729, "synch_weights": 0.0006186378527792404, "restore_eval_env_runners": 8.423592965118588e-06, "evaluation_iteration": 0.11634791755899787, "synch_eval_env_connectors": 0.00013719904479803517, "synch_env_connectors": 4.05793524114415e-06}, "env_runners": {"env_reset_timer": 4.1593977493672674e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9101561478010194e-05, "tensor_to_numpy": 1.3278835817120465e-05, "un_batch_to_individual_items": 5.590302921857111e-06, "listify_data_for_vector_env": 1.1108001671481681e-05, "normalize_and_clip_actions": 9.652782060357932e-06, "remove_single_ts_time_rank_from_batch": 6.056559673084795e-07}}, "connector_pipeline_timer": 0.00010508236833079351}, "episode_duration_sec_mean": 0.004609272170811892, "num_episodes_lifetime": -61250.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.909962297417766e-06, "add_states_from_episodes_to_batch": 1.7525121993861357e-06, "add_observations_from_episodes_to_batch": 3.0215963523238485e-06, "batch_individual_items": 6.400632731027407e-06, "add_time_dim_to_batch_and_zero_pad": 2.454391635503589e-06}}, "connector_pipeline_timer": 4.44420540403339e-05}, "episode_return_mean": 1.8199999999999996, "agent_episode_returns_mean": {"default_agent": 1.8199999999999996}, "sample": 0.004988483507487472, "module_episode_returns_mean": {"default_policy": 1.8199999999999996}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 3.0, "env_step_timer": 1.410125020352308e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.7726661586088544e-05, "num_env_steps_sampled_lifetime": -1225000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0019166961685641653, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3650.960660700956}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008229393755991479, "add_columns_from_episodes_to_train_batch": 0.034753111821834576, "add_time_dim_to_batch_and_zero_pad": 1.1559214277891443e-05, "batch_individual_items": 0.03130596988012898, "numpy_to_tensor": 7.40656639462104e-05, "add_states_from_episodes_to_batch": 3.5390438162721687e-06, "general_advantage_estimation": 0.0066440983957160495, "add_one_ts_to_episodes_and_truncate": 0.007657444582180004}}, "connector_pipeline_timer": 0.08141978758046473}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1820685.809338989, "num_module_steps_trained_throughput": 348268.4781709568, "num_module_steps_trained_lifetime_throughput": 347808.1189737241}, "default_policy": {"weights_seq_no": 4.0, "vf_loss_unclipped": 28.459375381469727, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 24000, "gradients_default_optimizer_global_norm": 0.13250532746315002, "policy_loss": 0.03923654928803444, "curr_kl_coeff": 0.04665601998567581, "total_loss": 0.10210534930229187, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6710050106048584, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.01594841480255127, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0022027352824807167, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 349038.4123981632}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "sample": 0.10987160193563054, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.153028815563172e-06, "add_states_from_episodes_to_batch": 1.6234101279549045e-06, "add_observations_from_episodes_to_batch": 2.8226239443105184e-06, "add_time_dim_to_batch_and_zero_pad": 2.294528949454717e-06, "numpy_to_tensor": 8.553262503702507e-06}}, "connector_pipeline_timer": 4.3297198096467624e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.8142124332924926e-05, "num_env_steps_sampled_lifetime": 20400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.469624559765246e-06, "listify_data_for_vector_env": 1.0987203153357887e-05, "normalize_and_clip_actions": 9.500965717256143e-06, "remove_single_ts_time_rank_from_batch": 5.863530478688712e-07, "get_actions": 3.724092720036653e-05, "tensor_to_numpy": 1.3353929830849473e-05}}, "connector_pipeline_timer": 0.00010325777445483681}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "weights_seq_no": 4.0, "env_step_timer": 1.4123538190835493e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_reset_timer": 0.00013725688803556838, "episode_duration_sec_mean": 0.004797165108902846, "episode_return_mean": -0.3, "num_episodes_lifetime": 80, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "module_episode_returns_mean": {"default_policy": -0.3}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6077893928716658}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-26", "timestamp": 1754933066, "time_this_iter_s": 1.6995980739593506, "time_total_s": 6.797189950942993, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.797189950942993, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.5, "ram_util_percent": 77.35}}
{"timers": {"training_iteration": 1.6168437502469803, "restore_env_runners": 1.0663191781974165e-05, "training_step": 1.6167162246335105, "env_runner_sampling_timer": 1.5024782985556775, "learner_update_timer": 0.11117440446841552, "synch_weights": 0.0006183831433991332, "restore_eval_env_runners": 8.441438138717785e-06, "evaluation_iteration": 0.11625742838365584, "synch_eval_env_connectors": 0.00013786955418658908, "synch_env_connectors": 4.065275927656329e-06}, "env_runners": {"env_reset_timer": 3.823356651429171e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.87686773707267e-05, "tensor_to_numpy": 1.3118946644758738e-05, "un_batch_to_individual_items": 5.54052048953275e-06, "listify_data_for_vector_env": 1.1017174322137942e-05, "normalize_and_clip_actions": 9.596191418671786e-06, "remove_single_ts_time_rank_from_batch": 5.981135511330001e-07}}, "connector_pipeline_timer": 0.00010435715398824356}, "episode_duration_sec_mean": 0.004949026338756086, "num_episodes_lifetime": -92125.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.800911643448359e-06, "add_states_from_episodes_to_batch": 1.7464928599619833e-06, "add_observations_from_episodes_to_batch": 2.935784891395129e-06, "batch_individual_items": 6.3147349422652016e-06, "add_time_dim_to_batch_and_zero_pad": 2.4411422525505297e-06}}, "connector_pipeline_timer": 4.4106251215547084e-05}, "episode_return_mean": 3.66, "agent_episode_returns_mean": {"default_agent": 3.66}, "sample": 0.0049771923749328695, "module_episode_returns_mean": {"default_policy": 3.66}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 4.0, "env_step_timer": 1.3997989331205627e-05, "episode_len_min": 20, "rlmodule_inference_timer": 4.66575358680467e-05, "num_env_steps_sampled_lifetime": -1842500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0016182994998236407, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3678.2983363271433}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008226145624046006, "add_columns_from_episodes_to_train_batch": 0.03474490320354709, "add_time_dim_to_batch_and_zero_pad": 1.1534462174887303e-05, "batch_individual_items": 0.03129002143085652, "numpy_to_tensor": 7.399708692949381e-05, "add_states_from_episodes_to_batch": 3.5294929229421533e-06, "general_advantage_estimation": 0.006631976582062531, "add_one_ts_to_episodes_and_truncate": 0.007654832225731003}}, "connector_pipeline_timer": 0.08137998053485279}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1833071.1047970655, "num_module_steps_trained_throughput": 350584.6646909166, "num_module_steps_trained_lifetime_throughput": 350134.7095574844}, "default_policy": {"weights_seq_no": 5.0, "vf_loss_unclipped": 27.58094024658203, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 30000, "gradients_default_optimizer_global_norm": 0.3231657147407532, "policy_loss": -0.08898680657148361, "curr_kl_coeff": 0.023328009992837906, "total_loss": -0.026010937988758087, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6537670493125916, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.01769888401031494, "num_module_steps_trained": 6000, "mean_kl_loss": 0.003353710984811187, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 351303.1083634048}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "sample": 0.10977008508679849, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.108992849710635e-06, "add_states_from_episodes_to_batch": 1.6176003724977215e-06, "add_observations_from_episodes_to_batch": 2.8328691061641e-06, "add_time_dim_to_batch_and_zero_pad": 2.336781830516331e-06, "numpy_to_tensor": 8.505018262690817e-06}}, "connector_pipeline_timer": 4.306691985141575e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.812734468841579e-05, "num_env_steps_sampled_lifetime": 25400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.356625588411783e-06, "listify_data_for_vector_env": 1.0953090586360865e-05, "normalize_and_clip_actions": 9.372051999719566e-06, "remove_single_ts_time_rank_from_batch": 5.693922287705206e-07, "get_actions": 3.7558699971428315e-05, "tensor_to_numpy": 1.3327187126441636e-05}}, "connector_pipeline_timer": 0.00010287541895512827}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "weights_seq_no": 5.0, "env_step_timer": 1.3959691740028049e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.4}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_reset_timer": 0.00013674557018346733, "episode_duration_sec_mean": 0.004749496678123251, "episode_return_mean": 0.4, "num_episodes_lifetime": 100, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "module_episode_returns_mean": {"default_policy": 0.4}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6076973881030234}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-27", "timestamp": 1754933067, "time_this_iter_s": 1.6889569759368896, "time_total_s": 8.486146926879883, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.486146926879883, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.233333333333334, "ram_util_percent": 77.56666666666666}}
{"timers": {"training_iteration": 1.616453753164328, "restore_env_runners": 1.0615310020467605e-05, "training_step": 1.6163258378071204, "env_runner_sampling_timer": 1.501281304739857, "learner_update_timer": 0.1119797141735162, "synch_weights": 0.0006177184808822316, "restore_eval_env_runners": 8.422434034205507e-06, "evaluation_iteration": 0.11613929368011078, "synch_eval_env_connectors": 0.00013752835897776414, "synch_env_connectors": 4.067533856005173e-06}, "env_runners": {"env_reset_timer": 3.743413752583291e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.818077204281957e-05, "tensor_to_numpy": 1.3058302781310996e-05, "un_batch_to_individual_items": 5.449224253034046e-06, "listify_data_for_vector_env": 1.093061977898381e-05, "normalize_and_clip_actions": 9.530480563391032e-06, "remove_single_ts_time_rank_from_batch": 5.896970973810891e-07}}, "connector_pipeline_timer": 0.00010336334485342782}, "episode_duration_sec_mean": 0.004535291169770063, "num_episodes_lifetime": -123000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.713123671297298e-06, "add_states_from_episodes_to_batch": 1.7371268969351826e-06, "add_observations_from_episodes_to_batch": 2.9087880194101573e-06, "batch_individual_items": 6.240906784308349e-06, "add_time_dim_to_batch_and_zero_pad": 2.4261631811393245e-06}}, "connector_pipeline_timer": 4.383595314882162e-05}, "episode_return_mean": 3.98, "agent_episode_returns_mean": {"default_agent": 3.98}, "sample": 0.005160770061492056, "module_episode_returns_mean": {"default_policy": 3.98}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 5.0, "env_step_timer": 1.3849646380460279e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.7679780349911856e-05, "num_env_steps_sampled_lifetime": -2460000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0015166607964955609, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3708.906003112781}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008224413267601513, "add_columns_from_episodes_to_train_batch": 0.03473398708093473, "add_time_dim_to_batch_and_zero_pad": 1.1506617637329991e-05, "batch_individual_items": 0.03227848746681148, "numpy_to_tensor": 7.399920552918468e-05, "add_states_from_episodes_to_batch": 3.5225381396582807e-06, "general_advantage_estimation": 0.006621439315499382, "add_one_ts_to_episodes_and_truncate": 0.007654454733762595}}, "connector_pipeline_timer": 0.08234592614039923}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1848641.2074969707, "num_module_steps_trained_throughput": 353504.73761004786, "num_module_steps_trained_lifetime_throughput": 353066.3613693849}, "default_policy": {"weights_seq_no": 6.0, "vf_loss_unclipped": 27.55246925354004, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 36000, "gradients_default_optimizer_global_norm": 0.053384359925985336, "policy_loss": -0.07849463820457458, "curr_kl_coeff": 0.011664004996418953, "total_loss": -0.015575570054352283, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6439688205718994, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.018162131309509277, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00046910226228646934, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 354165.4523444617}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "sample": 0.10965236590631947, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.022889079304083e-06, "add_states_from_episodes_to_batch": 1.6708228038950622e-06, "add_observations_from_episodes_to_batch": 2.773963621293904e-06, "add_time_dim_to_batch_and_zero_pad": 2.3260050743707567e-06, "numpy_to_tensor": 8.198643343854623e-06}}, "connector_pipeline_timer": 4.265816755181418e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.717451720093126e-05, "num_env_steps_sampled_lifetime": 30400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.2935983913652705e-06, "listify_data_for_vector_env": 1.0900112556794242e-05, "normalize_and_clip_actions": 9.243040361791794e-06, "remove_single_ts_time_rank_from_batch": 5.774321609132356e-07, "get_actions": 3.592016448235526e-05, "tensor_to_numpy": 1.2937711052032561e-05}}, "connector_pipeline_timer": 0.0001006664616840679}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "weights_seq_no": 6.0, "env_step_timer": 1.3560933547044424e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.2}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_reset_timer": 0.00013620394498406823, "episode_duration_sec_mean": 0.0046481204184237864, "episode_return_mean": 0.2, "num_episodes_lifetime": 120, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6075630663019684}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-29", "timestamp": 1754933069, "time_this_iter_s": 1.6827819347381592, "time_total_s": 10.168928861618042, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.168928861618042, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.85, "ram_util_percent": 77.6}}
{"timers": {"training_iteration": 1.6155694552124182, "restore_env_runners": 1.0572066596024986e-05, "training_step": 1.615440948178472, "env_runner_sampling_timer": 1.500567714192289, "learner_update_timer": 0.11180591869139414, "synch_weights": 0.0006173371260028206, "restore_eval_env_runners": 8.408629322036564e-06, "evaluation_iteration": 0.11600561158388134, "synch_eval_env_connectors": 0.00013710682537435194, "synch_env_connectors": 4.0706085595409015e-06}, "env_runners": {"env_reset_timer": 3.941125019247418e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.98241490097941e-05, "tensor_to_numpy": 1.3485624260219481e-05, "un_batch_to_individual_items": 5.674453902238812e-06, "listify_data_for_vector_env": 1.1319419374386419e-05, "normalize_and_clip_actions": 9.798734835345518e-06, "remove_single_ts_time_rank_from_batch": 6.041322382049778e-07}}, "connector_pipeline_timer": 0.00010670330359400136}, "episode_duration_sec_mean": 0.004687524495646357, "num_episodes_lifetime": -153875.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.08306340665905e-06, "add_states_from_episodes_to_batch": 1.7581108803764767e-06, "add_observations_from_episodes_to_batch": 3.0435739464972525e-06, "batch_individual_items": 6.546388648737423e-06, "add_time_dim_to_batch_and_zero_pad": 2.470421830817084e-06}}, "connector_pipeline_timer": 4.5021948953537516e-05}, "episode_return_mean": 3.98, "agent_episode_returns_mean": {"default_agent": 3.98}, "sample": 0.004995674049536238, "module_episode_returns_mean": {"default_policy": 3.98}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 6.0, "env_step_timer": 1.4382397065596176e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.8571516250910627e-05, "num_env_steps_sampled_lifetime": -3077500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018952425500595325, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3601.0699257516517}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008228894125904335, "add_columns_from_episodes_to_train_batch": 0.03473295054085975, "add_time_dim_to_batch_and_zero_pad": 1.1494892177989243e-05, "batch_individual_items": 0.03225964301125104, "numpy_to_tensor": 7.389088301012578e-05, "add_states_from_episodes_to_batch": 3.517312986696499e-06, "general_advantage_estimation": 0.006609428262895272, "add_one_ts_to_episodes_and_truncate": 0.007657495606159908}}, "connector_pipeline_timer": 0.08231703396875592}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1860882.2673899587, "num_module_steps_trained_throughput": 355789.75880463305, "num_module_steps_trained_lifetime_throughput": 355362.16144020867}, "default_policy": {"weights_seq_no": 7.0, "vf_loss_unclipped": 27.66732406616211, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 42000, "gradients_default_optimizer_global_norm": 0.07997886091470718, "policy_loss": -0.02193720079958439, "curr_kl_coeff": 0.0058320024982094765, "total_loss": 0.04111754521727562, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6286616325378418, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.018402576446533203, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0006850841455161572, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 356392.21766282624}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "sample": 0.10966868641709462, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.416365562699885e-06, "add_states_from_episodes_to_batch": 1.6742684366309638e-06, "add_observations_from_episodes_to_batch": 2.9709095572657113e-06, "add_time_dim_to_batch_and_zero_pad": 2.5079758569248342e-06, "numpy_to_tensor": 9.063216624351382e-06}}, "connector_pipeline_timer": 4.501452261981809e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.0090932227526048e-05, "num_env_steps_sampled_lifetime": 35400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.707987918122807e-06, "listify_data_for_vector_env": 1.193522654480846e-05, "normalize_and_clip_actions": 1.0343667074947996e-05, "remove_single_ts_time_rank_from_batch": 6.154395115720936e-07, "get_actions": 4.144206356746414e-05, "tensor_to_numpy": 1.5461567245058515e-05}}, "connector_pipeline_timer": 0.0001127988852188006}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "weights_seq_no": 7.0, "env_step_timer": 1.524907056025709e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_reset_timer": 0.00013572856537062415, "episode_duration_sec_mean": 0.0047278458322398366, "episode_return_mean": 0.0, "num_episodes_lifetime": 140, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6069626860586437}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-31", "timestamp": 1754933071, "time_this_iter_s": 1.6468770503997803, "time_total_s": 11.815805912017822, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.815805912017822, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.5, "ram_util_percent": 77.95}}
{"timers": {"training_iteration": 1.6155240089896448, "restore_env_runners": 1.0535515257681428e-05, "training_step": 1.6153945753572765, "env_runner_sampling_timer": 1.5007062287210633, "learner_update_timer": 0.11161802200507027, "synch_weights": 0.0006175470943844081, "restore_eval_env_runners": 8.40287307810745e-06, "evaluation_iteration": 0.1160113442179739, "synch_eval_env_connectors": 0.00013716034771194967, "synch_env_connectors": 4.071992433552021e-06}, "env_runners": {"env_reset_timer": 4.018354328923026e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.946475583641001e-05, "tensor_to_numpy": 1.3426856286401831e-05, "un_batch_to_individual_items": 5.633878832430164e-06, "listify_data_for_vector_env": 1.1180587373238377e-05, "normalize_and_clip_actions": 9.75423017037753e-06, "remove_single_ts_time_rank_from_batch": 6.106706510928423e-07}}, "connector_pipeline_timer": 0.00010598712801516366}, "episode_duration_sec_mean": 0.0050464799953624595, "num_episodes_lifetime": -184750.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.942805501767397e-06, "add_states_from_episodes_to_batch": 1.7698437354913282e-06, "add_observations_from_episodes_to_batch": 3.074789225718084e-06, "batch_individual_items": 6.45064394335393e-06, "add_time_dim_to_batch_and_zero_pad": 2.483446242321769e-06}}, "connector_pipeline_timer": 4.4786717808305614e-05}, "episode_return_mean": 3.339999999999999, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "sample": 0.005310746875744285, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 7.0, "env_step_timer": 1.4330696660931395e-05, "episode_len_min": 20, "rlmodule_inference_timer": 4.583937827147862e-05, "num_env_steps_sampled_lifetime": -3695000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0016065688656649883, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3611.4371762913593}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008258338491775926, "add_columns_from_episodes_to_train_batch": 0.034720957286169835, "add_time_dim_to_batch_and_zero_pad": 1.1482863713930107e-05, "batch_individual_items": 0.03223897241098308, "numpy_to_tensor": 7.375989382645156e-05, "add_states_from_episodes_to_batch": 3.5133892216675385e-06, "general_advantage_estimation": 0.006599289819609689, "add_one_ts_to_episodes_and_truncate": 0.007657972730403602}}, "connector_pipeline_timer": 0.08227707695833698}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1871495.883870204, "num_module_steps_trained_throughput": 357767.3131037407, "num_module_steps_trained_lifetime_throughput": 357348.59963234933}, "default_policy": {"weights_seq_no": 8.0, "vf_loss_unclipped": 27.65814781188965, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 48000, "gradients_default_optimizer_global_norm": 0.016191862523555756, "policy_loss": -0.07748422771692276, "curr_kl_coeff": 0.0029160012491047382, "total_loss": -0.014293914660811424, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6131623983383179, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.018987655639648438, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0005429149605333805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 358313.18850528396}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "sample": 0.10957351080284776, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.183134281010177e-06, "add_states_from_episodes_to_batch": 1.6339211386579408e-06, "add_observations_from_episodes_to_batch": 2.826792553197357e-06, "add_time_dim_to_batch_and_zero_pad": 2.3701122700043667e-06, "numpy_to_tensor": 8.494332987741729e-06}}, "connector_pipeline_timer": 4.312834362152704e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.823582065556382e-05, "num_env_steps_sampled_lifetime": 40400, "episode_return_max": 12.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.410963915580885e-06, "listify_data_for_vector_env": 1.1120978585424657e-05, "normalize_and_clip_actions": 9.423697024129181e-06, "remove_single_ts_time_rank_from_batch": 5.856348294161249e-07, "get_actions": 3.724057192629742e-05, "tensor_to_numpy": 1.3360005436039623e-05}}, "connector_pipeline_timer": 0.00010308562630120451}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "weights_seq_no": 8.0, "env_step_timer": 1.4018914304496282e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.4}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_reset_timer": 0.00013520794964996878, "episode_duration_sec_mean": 0.004668062046403065, "episode_return_mean": 0.4, "num_episodes_lifetime": 160, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "module_episode_returns_mean": {"default_policy": 0.4}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6071785404484364}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-32", "timestamp": 1754933072, "time_this_iter_s": 1.7190568447113037, "time_total_s": 13.534862756729126, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.534862756729126, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.6, "ram_util_percent": 77.5}}
{"timers": {"training_iteration": 1.615679178069858, "restore_env_runners": 1.0486820606391001e-05, "training_step": 1.6155491171037677, "env_runner_sampling_timer": 1.5000795656030201, "learner_update_timer": 0.11239703220534727, "synch_weights": 0.0006173362031997296, "restore_eval_env_runners": 8.403424735246517e-06, "evaluation_iteration": 0.11590781952659242, "synch_eval_env_connectors": 0.00013700207361334564, "synch_env_connectors": 4.0766919470272795e-06}, "env_runners": {"env_reset_timer": 4.104485187819612e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.037331527734636e-05, "tensor_to_numpy": 1.3512485495289359e-05, "un_batch_to_individual_items": 5.606674181313063e-06, "listify_data_for_vector_env": 1.143714700703443e-05, "normalize_and_clip_actions": 9.768799047111653e-06, "remove_single_ts_time_rank_from_batch": 6.040510991240725e-07}}, "connector_pipeline_timer": 0.00010743812970523891}, "episode_duration_sec_mean": 0.004727571834344418, "num_episodes_lifetime": -215625.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.2186282815904e-06, "add_states_from_episodes_to_batch": 1.7984699841377292e-06, "add_observations_from_episodes_to_batch": 2.9944299413476818e-06, "batch_individual_items": 6.49292887668096e-06, "add_time_dim_to_batch_and_zero_pad": 2.5051415792434446e-06}}, "connector_pipeline_timer": 4.5190768536971983e-05}, "episode_return_mean": 5.259999999999999, "agent_episode_returns_mean": {"default_agent": 5.259999999999999}, "sample": 0.005114398934539846, "module_episode_returns_mean": {"default_policy": 5.259999999999999}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 8.0, "env_step_timer": 1.4639969522088497e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.891441099274027e-05, "num_env_steps_sampled_lifetime": -4312500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0015363650890338016, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3602.2894628708264}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.00082586301034458, "add_columns_from_episodes_to_train_batch": 0.03470835563368472, "add_time_dim_to_batch_and_zero_pad": 1.147636535451686e-05, "batch_individual_items": 0.032222848517168404, "numpy_to_tensor": 7.365896446249245e-05, "add_states_from_episodes_to_batch": 3.511595513468879e-06, "general_advantage_estimation": 0.00658624859236387, "add_one_ts_to_episodes_and_truncate": 0.00864457634311073}}, "connector_pipeline_timer": 0.08322148118961303}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1886253.616766404, "num_module_steps_trained_throughput": 360533.5599675147, "num_module_steps_trained_lifetime_throughput": 360124.0511058243}, "default_policy": {"weights_seq_no": 9.0, "vf_loss_unclipped": 27.53458595275879, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 54000, "gradients_default_optimizer_global_norm": 0.05883348360657692, "policy_loss": 0.06147141009569168, "curr_kl_coeff": 0.0014580006245523691, "total_loss": 0.12476349622011185, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6017114520072937, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.019598960876464844, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0004298215499147773, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 361020.7836649521}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "sample": 0.10948598694570189, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.199755682225222e-06, "add_states_from_episodes_to_batch": 1.6426315225703246e-06, "add_observations_from_episodes_to_batch": 2.8336487677949208e-06, "add_time_dim_to_batch_and_zero_pad": 2.31809135225221e-06, "numpy_to_tensor": 8.778466910479204e-06}}, "connector_pipeline_timer": 4.369658469896004e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.8239085188814287e-05, "num_env_steps_sampled_lifetime": 45400, "episode_return_max": 12.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.473487799324023e-06, "listify_data_for_vector_env": 1.107631693404875e-05, "normalize_and_clip_actions": 9.537933343202906e-06, "remove_single_ts_time_rank_from_batch": 5.714800989383098e-07, "get_actions": 3.838379219846157e-05, "tensor_to_numpy": 1.3450704652127538e-05}}, "connector_pipeline_timer": 0.00010466458480867651}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 9.0, "env_step_timer": 1.3977986867118866e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00013468671000720287, "episode_duration_sec_mean": 0.004656950001372024, "episode_return_mean": 0.8, "num_episodes_lifetime": 180, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "module_episode_returns_mean": {"default_policy": 0.8}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.607590532543477}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-34", "timestamp": 1754933074, "time_this_iter_s": 1.738969087600708, "time_total_s": 15.273831844329834, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.273831844329834, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.0, "ram_util_percent": 77.75}}
{"timers": {"training_iteration": 1.615350946708773, "restore_env_runners": 1.0438201955527428e-05, "training_step": 1.6152205550931238, "env_runner_sampling_timer": 1.4989920236964778, "learner_update_timer": 0.1131526423035029, "synch_weights": 0.000617239511419519, "restore_eval_env_runners": 8.397309591099257e-06, "evaluation_iteration": 0.11580545674083075, "synch_eval_env_connectors": 0.00013674788325954439, "synch_env_connectors": 4.083835753254882e-06}, "env_runners": {"env_reset_timer": 3.9207363248963744e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.861604818164495e-05, "tensor_to_numpy": 1.3209022176531079e-05, "un_batch_to_individual_items": 5.496440006132387e-06, "listify_data_for_vector_env": 1.1030678568831466e-05, "normalize_and_clip_actions": 9.550107572670655e-06, "remove_single_ts_time_rank_from_batch": 5.99488524329798e-07}}, "connector_pipeline_timer": 0.00010424739837654701}, "episode_duration_sec_mean": 0.004566496036481113, "num_episodes_lifetime": -246500.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.769675377023006e-06, "add_states_from_episodes_to_batch": 1.7366136338140057e-06, "add_observations_from_episodes_to_batch": 2.9728609405987546e-06, "batch_individual_items": 6.2816176656867076e-06, "add_time_dim_to_batch_and_zero_pad": 2.444456655867798e-06}}, "connector_pipeline_timer": 4.4036467239429e-05}, "episode_return_mean": 5.100000000000001, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "sample": 0.004957373976630339, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 9.0, "env_step_timer": 1.3962022115915681e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.7394137381558196e-05, "num_env_steps_sampled_lifetime": -4930000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018750390065460259, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3687.3519061382613}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008256502098408575, "add_columns_from_episodes_to_train_batch": 0.03469971041804344, "add_time_dim_to_batch_and_zero_pad": 1.1464101899380653e-05, "batch_individual_items": 0.03316490212212046, "numpy_to_tensor": 7.358737522489274e-05, "add_states_from_episodes_to_batch": 3.5068895687018224e-06, "general_advantage_estimation": 0.006574668196135566, "add_one_ts_to_episodes_and_truncate": 0.00863577182977961}}, "connector_pipeline_timer": 0.08413372971786337}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1901286.9734428183, "num_module_steps_trained_throughput": 363353.03492275934, "num_module_steps_trained_lifetime_throughput": 362952.8650871464}, "default_policy": {"weights_seq_no": 10.0, "vf_loss_unclipped": 27.54096031188965, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 60000, "gradients_default_optimizer_global_norm": 0.018817108124494553, "policy_loss": 0.044248078018426895, "curr_kl_coeff": 0.0007290003122761846, "total_loss": 0.10759363323450089, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.5956794023513794, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.02006387710571289, "num_module_steps_trained": 6000, "mean_kl_loss": 5.7940360420616344e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 363783.13404409855}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "sample": 0.10940648415685905, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.294750937621425e-06, "add_states_from_episodes_to_batch": 1.6346706270264457e-06, "add_observations_from_episodes_to_batch": 2.8039890768819383e-06, "add_time_dim_to_batch_and_zero_pad": 2.28836731292975e-06, "numpy_to_tensor": 8.56426401499906e-06}}, "connector_pipeline_timer": 4.350051066561409e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.8007192087030064e-05, "num_env_steps_sampled_lifetime": 50400, "episode_return_max": 12.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.4237456283152345e-06, "listify_data_for_vector_env": 1.1051916820540364e-05, "normalize_and_clip_actions": 9.348554571357922e-06, "remove_single_ts_time_rank_from_batch": 5.768995707512366e-07, "get_actions": 3.6991077229100595e-05, "tensor_to_numpy": 1.3366586135151571e-05}}, "connector_pipeline_timer": 0.00010267825185064266}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 10.0, "env_step_timer": 1.4305412092074917e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00013413859287740302, "episode_duration_sec_mean": 0.004676625411957502, "episode_return_mean": 0.0, "num_episodes_lifetime": 200, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6075095747183363}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-36", "timestamp": 1754933076, "time_this_iter_s": 1.6918840408325195, "time_total_s": 16.965715885162354, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.965715885162354, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 42.9, "ram_util_percent": 77.36666666666667}}
{"timers": {"training_iteration": 1.6141257493209678, "restore_env_runners": 1.0387570054212868e-05, "training_step": 1.613995031621869, "env_runner_sampling_timer": 1.4979690063800237, "learner_update_timer": 0.11294833755074901, "synch_weights": 0.0006173017062694752, "restore_eval_env_runners": 8.417506089312223e-06, "evaluation_iteration": 0.115714151343845, "synch_eval_env_connectors": 0.0001373554043315815, "synch_env_connectors": 4.08007683987743e-06}, "env_runners": {"env_reset_timer": 3.7584479076121064e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.839872740536427e-05, "tensor_to_numpy": 1.3145065228998605e-05, "un_batch_to_individual_items": 5.584848743620221e-06, "listify_data_for_vector_env": 1.1027612003729227e-05, "normalize_and_clip_actions": 9.606818910678393e-06, "remove_single_ts_time_rank_from_batch": 6.002131168109319e-07}}, "connector_pipeline_timer": 0.0001040627666872664}, "episode_duration_sec_mean": 0.004596548707690092, "num_episodes_lifetime": -277375.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.751759708154134e-06, "add_states_from_episodes_to_batch": 1.761589927184011e-06, "add_observations_from_episodes_to_batch": 2.9690450895927154e-06, "batch_individual_items": 6.339496057498395e-06, "add_time_dim_to_batch_and_zero_pad": 2.4425706829908476e-06}}, "connector_pipeline_timer": 4.4105203182114036e-05}, "episode_return_mean": 5.980000000000002, "agent_episode_returns_mean": {"default_agent": 5.980000000000002}, "sample": 0.004906634504169147, "module_episode_returns_mean": {"default_policy": 5.980000000000002}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 10.0, "env_step_timer": 1.4032595950821819e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.826329485625549e-05, "num_env_steps_sampled_lifetime": -5547500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018921142391322703, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3689.6263703457994}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008262403676542455, "add_columns_from_episodes_to_train_batch": 0.03470021539295683, "add_time_dim_to_batch_and_zero_pad": 1.1462369772720354e-05, "batch_individual_items": 0.03313579893080818, "numpy_to_tensor": 7.348025131260535e-05, "add_states_from_episodes_to_batch": 3.5018209014496055e-06, "general_advantage_estimation": 0.006562802764961737, "add_one_ts_to_episodes_and_truncate": 0.008626704110944478}}, "connector_pipeline_timer": 0.08408435492134635}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1916335.3261106093, "num_module_steps_trained_throughput": 366175.8356221807, "num_module_steps_trained_lifetime_throughput": 365784.9971091232}, "default_policy": {"weights_seq_no": 11.0, "vf_loss_unclipped": 27.205020904541016, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 66000, "gradients_default_optimizer_global_norm": 0.06588909029960632, "policy_loss": 0.0011768140830099583, "curr_kl_coeff": 0.0003645001561380923, "total_loss": 0.06442416459321976, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6065216660499573, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.020464658737182617, "num_module_steps_trained": 6000, "mean_kl_loss": 8.655712736072019e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 366549.19268424384}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "sample": 0.10933332681535073, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.18881980897249e-06, "add_states_from_episodes_to_batch": 1.6445334523007957e-06, "add_observations_from_episodes_to_batch": 2.8304620730164212e-06, "add_time_dim_to_batch_and_zero_pad": 2.3040528558833904e-06, "numpy_to_tensor": 8.504467228568232e-06}}, "connector_pipeline_timer": 4.3449764072481246e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.8208214998521192e-05, "num_env_steps_sampled_lifetime": 55400, "episode_return_max": 12.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.508268249892581e-06, "listify_data_for_vector_env": 1.1074806621042872e-05, "normalize_and_clip_actions": 9.611309743199649e-06, "remove_single_ts_time_rank_from_batch": 5.869055310239221e-07, "get_actions": 3.72866394982692e-05, "tensor_to_numpy": 1.3384256595095584e-05}}, "connector_pipeline_timer": 0.00010374117189542295}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 11.0, "env_step_timer": 1.4102339106351568e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0001335717867697835, "episode_duration_sec_mean": 0.004712497934233398, "episode_return_mean": -0.2, "num_episodes_lifetime": 220, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "module_episode_returns_mean": {"default_policy": -0.2}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.606523939381098}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-37", "timestamp": 1754933077, "time_this_iter_s": 1.6020150184631348, "time_total_s": 18.56773090362549, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.56773090362549, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 41.6, "ram_util_percent": 77.35}}
{"timers": {"training_iteration": 1.6140098180774134, "restore_env_runners": 1.0341194209427499e-05, "training_step": 1.61387858505598, "env_runner_sampling_timer": 1.4980493413169353, "learner_update_timer": 0.11274848959498467, "synch_weights": 0.0006166636894434854, "restore_eval_env_runners": 8.403331561433637e-06, "evaluation_iteration": 0.11562684191021758, "synch_eval_env_connectors": 0.0001369747612247405, "synch_env_connectors": 4.080945771773389e-06}, "env_runners": {"env_reset_timer": 3.8882194812363843e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9251531387515845e-05, "tensor_to_numpy": 1.332639540271444e-05, "un_batch_to_individual_items": 5.605617420077985e-06, "listify_data_for_vector_env": 1.1189730214528867e-05, "normalize_and_clip_actions": 9.735069751711833e-06, "remove_single_ts_time_rank_from_batch": 5.968853199391566e-07}}, "connector_pipeline_timer": 0.00010557087695718476}, "episode_duration_sec_mean": 0.00463306928239763, "num_episodes_lifetime": -308250.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.949370901402373e-06, "add_states_from_episodes_to_batch": 1.7472983140202426e-06, "add_observations_from_episodes_to_batch": 3.0581529655292086e-06, "batch_individual_items": 6.4350134696563996e-06, "add_time_dim_to_batch_and_zero_pad": 2.4736062487488294e-06}}, "connector_pipeline_timer": 4.464587753257454e-05}, "episode_return_mean": 5.740000000000001, "agent_episode_returns_mean": {"default_agent": 5.740000000000001}, "sample": 0.0049456002687393655, "module_episode_returns_mean": {"default_policy": 5.740000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 11.0, "env_step_timer": 1.417130179977e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.8106930860009864e-05, "num_env_steps_sampled_lifetime": -6165000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0018725959404061747, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3624.8350461627897}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008264854641475017, "add_columns_from_episodes_to_train_batch": 0.034693134908828964, "add_time_dim_to_batch_and_zero_pad": 1.1453575751606363e-05, "batch_individual_items": 0.03310634761171098, "numpy_to_tensor": 7.345002808761924e-05, "add_states_from_episodes_to_batch": 3.498472316584909e-06, "general_advantage_estimation": 0.006551378067385625, "add_one_ts_to_episodes_and_truncate": 0.008617075819868486}}, "connector_pipeline_timer": 0.0840266142826329}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1929512.2547801908, "num_module_steps_trained_throughput": 368643.78031540394, "num_module_steps_trained_lifetime_throughput": 368261.8195520005}, "default_policy": {"weights_seq_no": 12.0, "vf_loss_unclipped": 26.743595123291016, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 72000, "gradients_default_optimizer_global_norm": 0.020691007375717163, "policy_loss": -0.19873479008674622, "curr_kl_coeff": 0.00018225007806904614, "total_loss": -0.13557009398937225, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6156450510025024, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.020839571952819824, "num_module_steps_trained": 6000, "mean_kl_loss": 1.5084176993696019e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 368960.9267348036}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "sample": 0.10928812021726349, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.219813713026113e-06, "add_states_from_episodes_to_batch": 1.6406748866099717e-06, "add_observations_from_episodes_to_batch": 2.876910141404409e-06, "add_time_dim_to_batch_and_zero_pad": 2.357309259613984e-06, "numpy_to_tensor": 8.994358921276344e-06}}, "connector_pipeline_timer": 4.4295263292644294e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.0702361875085756e-05, "num_env_steps_sampled_lifetime": 60400, "episode_return_max": 12.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.5696029578210625e-06, "listify_data_for_vector_env": 1.1590151599424873e-05, "normalize_and_clip_actions": 9.823492802786035e-06, "remove_single_ts_time_rank_from_batch": 5.806741190930615e-07, "get_actions": 4.12713978652771e-05, "tensor_to_numpy": 1.4263548920992728e-05}}, "connector_pipeline_timer": 0.000110033502678127}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 12.0, "env_step_timer": 1.4591747989145379e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00013308898924991035, "episode_duration_sec_mean": 0.00466618959326297, "episode_return_mean": -0.2, "num_episodes_lifetime": 240, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "module_episode_returns_mean": {"default_policy": -0.2}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6066524987374602}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-39", "timestamp": 1754933079, "time_this_iter_s": 1.7152018547058105, "time_total_s": 20.2829327583313, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.2829327583313, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.6, "ram_util_percent": 77.5}}
{"timers": {"training_iteration": 1.613913439066323, "restore_env_runners": 1.0294441604466392e-05, "training_step": 1.613781649204876, "env_runner_sampling_timer": 1.4981491420634725, "learner_update_timer": 0.11254821844958161, "synch_weights": 0.0006164045527117713, "restore_eval_env_runners": 8.388048478277414e-06, "evaluation_iteration": 0.11557293516087933, "synch_eval_env_connectors": 0.00013661376401765567, "synch_env_connectors": 4.085555751866434e-06}, "env_runners": {"env_reset_timer": 4.0967253037601806e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.928888310051164e-05, "tensor_to_numpy": 1.3382221180763917e-05, "un_batch_to_individual_items": 5.572255803743996e-06, "listify_data_for_vector_env": 1.1112344776725483e-05, "normalize_and_clip_actions": 9.681454530931086e-06, "remove_single_ts_time_rank_from_batch": 5.983731080975948e-07}}, "connector_pipeline_timer": 0.00010558242321090662}, "episode_duration_sec_mean": 0.004632627981714905, "num_episodes_lifetime": -339125.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.915321960909014e-06, "add_states_from_episodes_to_batch": 1.749303064501595e-06, "add_observations_from_episodes_to_batch": 2.993473016755873e-06, "batch_individual_items": 6.3919223112046405e-06, "add_time_dim_to_batch_and_zero_pad": 2.475067369896343e-06}}, "connector_pipeline_timer": 4.457747314735297e-05}, "episode_return_mean": 6.940000000000001, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "sample": 0.004992027728439091, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 12.0, "env_step_timer": 1.4155620372740474e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.7861793599279336e-05, "num_env_steps_sampled_lifetime": -6782500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0017701743442485461, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3618.3506203141733}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008262351990541377, "add_columns_from_episodes_to_train_batch": 0.034685324389917074, "add_time_dim_to_batch_and_zero_pad": 1.145237030988882e-05, "batch_individual_items": 0.033075934965043165, "numpy_to_tensor": 7.331844857925083e-05, "add_states_from_episodes_to_batch": 3.493908081165656e-06, "general_advantage_estimation": 0.006538299286673175, "add_one_ts_to_episodes_and_truncate": 0.008609082151705553}}, "connector_pipeline_timer": 0.08396655521917615}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1940521.2031673181, "num_module_steps_trained_throughput": 370699.7893408734, "num_module_steps_trained_lifetime_throughput": 370326.1598302219}, "default_policy": {"weights_seq_no": 13.0, "vf_loss_unclipped": 26.886669158935547, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 78000, "gradients_default_optimizer_global_norm": 0.05055728554725647, "policy_loss": -0.037887606769800186, "curr_kl_coeff": 9.112503903452307e-05, "total_loss": 0.02526637353003025, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6168266534805298, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.02140367031097412, "num_module_steps_trained": 6000, "mean_kl_loss": 7.769689545966685e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 370966.0792647296}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "sample": 0.1092084694357399, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.286160056804453e-06, "add_states_from_episodes_to_batch": 1.6396409272639112e-06, "add_observations_from_episodes_to_batch": 2.819119960564332e-06, "add_time_dim_to_batch_and_zero_pad": 2.2927183560057863e-06, "numpy_to_tensor": 8.488579921518104e-06}}, "connector_pipeline_timer": 4.35212778628382e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.789688350338402e-05, "num_env_steps_sampled_lifetime": 65400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.421440489248767e-06, "listify_data_for_vector_env": 1.1004455240268088e-05, "normalize_and_clip_actions": 9.492812856598807e-06, "remove_single_ts_time_rank_from_batch": 5.791040370329372e-07, "get_actions": 3.7108276900387965e-05, "tensor_to_numpy": 1.3612269551180528e-05}}, "connector_pipeline_timer": 0.00010345843364085762}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 13.0, "env_step_timer": 1.446201850611925e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00013255017989389595, "episode_duration_sec_mean": 0.004678362081758678, "episode_return_mean": -1.4, "num_episodes_lifetime": 260, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "module_episode_returns_mean": {"default_policy": -1.4}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6068161279202746}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-41", "timestamp": 1754933081, "time_this_iter_s": 1.7132360935211182, "time_total_s": 21.996168851852417, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.996168851852417, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.800000000000004, "ram_util_percent": 77.03333333333333}}
{"timers": {"training_iteration": 1.6141255680159896, "restore_env_runners": 1.0250667604046704e-05, "training_step": 1.6139932843839488, "env_runner_sampling_timer": 1.4975390310529948, "learner_update_timer": 0.11336879085502044, "synch_weights": 0.0006158759272779664, "restore_eval_env_runners": 8.376247704157005e-06, "evaluation_iteration": 0.11548147372913505, "synch_eval_env_connectors": 0.0001364251266123959, "synch_env_connectors": 4.0867796765753335e-06}, "env_runners": {"env_reset_timer": 4.1483590710421986e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.052760840339666e-05, "tensor_to_numpy": 1.3649527507596841e-05, "un_batch_to_individual_items": 5.642996255498404e-06, "listify_data_for_vector_env": 1.1373247485827988e-05, "normalize_and_clip_actions": 9.873636911610068e-06, "remove_single_ts_time_rank_from_batch": 6.049197136826397e-07}}, "connector_pipeline_timer": 0.00010779186526606043}, "episode_duration_sec_mean": 0.004719864316284657, "num_episodes_lifetime": -370000.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.13621878603199e-06, "add_states_from_episodes_to_batch": 1.7576264838687567e-06, "add_observations_from_episodes_to_batch": 2.9735045175961886e-06, "batch_individual_items": 6.501065553079429e-06, "add_time_dim_to_batch_and_zero_pad": 2.4880557741302836e-06}}, "connector_pipeline_timer": 4.4974149333550944e-05}, "episode_return_mean": 6.62, "agent_episode_returns_mean": {"default_agent": 6.62}, "sample": 0.005025499671200496, "module_episode_returns_mean": {"default_policy": 6.62}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 13.0, "env_step_timer": 1.4416411930705652e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.8906606977399743e-05, "num_env_steps_sampled_lifetime": -7400000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0017497130851205722, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3585.949411638774}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008263886876297545, "add_columns_from_episodes_to_train_batch": 0.034678434066424735, "add_time_dim_to_batch_and_zero_pad": 1.1432017288922176e-05, "batch_individual_items": 0.03406860478569019, "numpy_to_tensor": 7.323192443068293e-05, "add_states_from_episodes_to_batch": 3.48563975058455e-06, "general_advantage_estimation": 0.006526345872935886, "add_one_ts_to_episodes_and_truncate": 0.008598000079451858}}, "connector_pipeline_timer": 0.08492891466661781}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1949609.3212560914, "num_module_steps_trained_throughput": 372393.59894379345, "num_module_steps_trained_lifetime_throughput": 372026.99618487584}, "default_policy": {"weights_seq_no": 14.0, "vf_loss_unclipped": 27.137771606445312, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 84000, "gradients_default_optimizer_global_norm": 0.02799815684556961, "policy_loss": 0.021915465593338013, "curr_kl_coeff": 4.5562519517261535e-05, "total_loss": 0.08509045839309692, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6145032048225403, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.022045254707336426, "num_module_steps_trained": 6000, "mean_kl_loss": 6.392585055436939e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 372613.33539818274}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "sample": 0.10910366182122176, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.00849576830422e-06, "add_states_from_episodes_to_batch": 1.6489106373560625e-06, "add_observations_from_episodes_to_batch": 2.7624561797748532e-06, "add_time_dim_to_batch_and_zero_pad": 2.326362745126501e-06, "numpy_to_tensor": 8.36120285700638e-06}}, "connector_pipeline_timer": 4.2697745514156764e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.720941281135867e-05, "num_env_steps_sampled_lifetime": 70400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.396927875448277e-06, "listify_data_for_vector_env": 1.0796398017851514e-05, "normalize_and_clip_actions": 9.255446767892464e-06, "remove_single_ts_time_rank_from_batch": 5.865472771024992e-07, "get_actions": 3.604340263326142e-05, "tensor_to_numpy": 1.3058970701433948e-05}}, "connector_pipeline_timer": 0.00010081689367035822}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 14.0, "env_step_timer": 1.3686629415758983e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00013206634806608032, "episode_duration_sec_mean": 0.004662370388396084, "episode_return_mean": -1.8, "num_episodes_lifetime": 280, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "module_episode_returns_mean": {"default_policy": -1.8}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6072667445607722}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-43", "timestamp": 1754933083, "time_this_iter_s": 1.741278886795044, "time_total_s": 23.73744773864746, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.73744773864746, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.9, "ram_util_percent": 77.3}}
{"timers": {"training_iteration": 1.6155480185857596, "restore_env_runners": 1.0204411647359794e-05, "training_step": 1.6154149386295493, "env_runner_sampling_timer": 1.4975430678326125, "learner_update_timer": 0.11477596461616524, "synch_weights": 0.0006176609176658128, "restore_eval_env_runners": 8.354155079700036e-06, "evaluation_iteration": 0.11536374983166181, "synch_eval_env_connectors": 0.00013612212556911882, "synch_env_connectors": 4.082582706185064e-06}, "env_runners": {"env_reset_timer": 4.265348382933362e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1922823382104024e-05, "tensor_to_numpy": 1.4064082185973357e-05, "un_batch_to_individual_items": 5.81421713601781e-06, "listify_data_for_vector_env": 1.1548991630243319e-05, "normalize_and_clip_actions": 1.006005996391013e-05, "remove_single_ts_time_rank_from_batch": 6.346028276644514e-07}}, "connector_pipeline_timer": 0.00011071421962815195}, "episode_duration_sec_mean": 0.004860832282807678, "num_episodes_lifetime": -400875.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.401200217065346e-06, "add_states_from_episodes_to_batch": 1.8017571687796929e-06, "add_observations_from_episodes_to_batch": 3.205316641514085e-06, "batch_individual_items": 6.687695427573767e-06, "add_time_dim_to_batch_and_zero_pad": 2.533492477259121e-06}}, "connector_pipeline_timer": 4.613079411970393e-05}, "episode_return_mean": 6.46, "agent_episode_returns_mean": {"default_agent": 6.46}, "sample": 0.005070764259030346, "module_episode_returns_mean": {"default_policy": 6.46}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 14.0, "env_step_timer": 1.4899748564974381e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.9585395469225142e-05, "num_env_steps_sampled_lifetime": -8017500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0019271516205528062, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3529.1390473508773}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008386564704781896, "add_columns_from_episodes_to_train_batch": 0.03488802431613874, "add_time_dim_to_batch_and_zero_pad": 1.1921027670473572e-05, "batch_individual_items": 0.03535905415800856, "numpy_to_tensor": 7.340085535505725e-05, "add_states_from_episodes_to_batch": 3.484533319029551e-06, "general_advantage_estimation": 0.006518800754746833, "add_one_ts_to_episodes_and_truncate": 0.008598207578931148}}, "connector_pipeline_timer": 0.08643575718000514}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1953192.3360723362, "num_module_steps_trained_throughput": 373039.16841963056, "num_module_steps_trained_lifetime_throughput": 372679.42505634436}, "default_policy": {"weights_seq_no": 15.0, "vf_loss_unclipped": 27.49070930480957, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 90000, "gradients_default_optimizer_global_norm": 0.07249045372009277, "policy_loss": 0.14473199844360352, "curr_kl_coeff": 2.2781259758630767e-05, "total_loss": 0.20799577236175537, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6047009825706482, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.022460103034973145, "num_module_steps_trained": 6000, "mean_kl_loss": 2.6270066882716492e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 373217.8292669689}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "sample": 0.10913585229242019, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.797873188144083e-06, "add_states_from_episodes_to_batch": 1.7116767965793756e-06, "add_observations_from_episodes_to_batch": 3.2035765814782752e-06, "add_time_dim_to_batch_and_zero_pad": 2.5264296586375074e-06, "numpy_to_tensor": 9.24504650698847e-06}}, "connector_pipeline_timer": 4.7336545314716406e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.1362821852872814e-05, "num_env_steps_sampled_lifetime": 75400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.0803267441729706e-06, "listify_data_for_vector_env": 1.1777540043234327e-05, "normalize_and_clip_actions": 1.0051814047499281e-05, "remove_single_ts_time_rank_from_batch": 6.210523582788949e-07, "get_actions": 4.133815805171042e-05, "tensor_to_numpy": 1.4401911900785562e-05}}, "connector_pipeline_timer": 0.00011274674262625802}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 15.0, "env_step_timer": 1.5668255549637556e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00013218193533539495, "episode_duration_sec_mean": 0.0047532633098308, "episode_return_mean": -1.6, "num_episodes_lifetime": 300, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "module_episode_returns_mean": {"default_policy": -1.6}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.608946572525551}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-44", "timestamp": 1754933084, "time_this_iter_s": 1.8778150081634521, "time_total_s": 25.615262746810913, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.615262746810913, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 45.73333333333333, "ram_util_percent": 78.23333333333333}}
{"timers": {"training_iteration": 1.6188152133997071, "restore_env_runners": 1.0174867500860356e-05, "training_step": 1.6186813304934007, "env_runner_sampling_timer": 1.500953971734423, "learner_update_timer": 0.11462930247056066, "synch_weights": 0.0006172643082631041, "restore_eval_env_runners": 8.3443626352804e-06, "evaluation_iteration": 0.11539588650437162, "synch_eval_env_connectors": 0.00013611798449548822, "synch_env_connectors": 4.0775871868751075e-06}, "env_runners": {"env_reset_timer": 5.461511023406407e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.53120747460957e-05, "tensor_to_numpy": 1.739565664018247e-05, "un_batch_to_individual_items": 6.9953608124636765e-06, "listify_data_for_vector_env": 1.5217068449889993e-05, "normalize_and_clip_actions": 1.1892738910062942e-05, "remove_single_ts_time_rank_from_batch": 7.588944840178545e-07}}, "connector_pipeline_timer": 0.00013857810229806416}, "episode_duration_sec_mean": 0.006042896180879323, "num_episodes_lifetime": -431750.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1646207469486103e-05, "add_states_from_episodes_to_batch": 2.03558230391296e-06, "add_observations_from_episodes_to_batch": 3.980927118875233e-06, "batch_individual_items": 8.241414958412208e-06, "add_time_dim_to_batch_and_zero_pad": 3.0349221226982532e-06}}, "connector_pipeline_timer": 5.516757351081744e-05}, "episode_return_mean": 6.7799999999999985, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "sample": 0.006264692610568472, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 15.0, "env_step_timer": 2.013027813807495e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.6968439179932204e-05, "num_env_steps_sampled_lifetime": -8635000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0024120256504335407, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3062.268990156401}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008397994963800971, "add_columns_from_episodes_to_train_batch": 0.034903231152629, "add_time_dim_to_batch_and_zero_pad": 1.1918066241685558e-05, "batch_individual_items": 0.03532802778619299, "numpy_to_tensor": 7.335392653846958e-05, "add_states_from_episodes_to_batch": 3.479278432341226e-06, "general_advantage_estimation": 0.006511070656187363, "add_one_ts_to_episodes_and_truncate": 0.008594149252672524}}, "connector_pipeline_timer": 0.08640903418771645}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1954150.6068556774, "num_module_steps_trained_throughput": 373185.7534706135, "num_module_steps_trained_lifetime_throughput": 372833.7943835613}, "default_policy": {"weights_seq_no": 16.0, "vf_loss_unclipped": 27.252580642700195, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 96000, "gradients_default_optimizer_global_norm": 0.0359240286052227, "policy_loss": 0.08797918260097504, "curr_kl_coeff": 1.1390629879315384e-05, "total_loss": 0.15125392377376556, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6034906506538391, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.022913694381713867, "num_module_steps_trained": 6000, "mean_kl_loss": 7.574491610284895e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 373327.0192003171}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "sample": 0.10922584043882345, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.6514076663893895e-06, "add_states_from_episodes_to_batch": 1.7173141894576654e-06, "add_observations_from_episodes_to_batch": 3.243025562614835e-06, "add_time_dim_to_batch_and_zero_pad": 3.806952980384364e-06, "numpy_to_tensor": 1.0156577049163123e-05}}, "connector_pipeline_timer": 4.9092480416162415e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.233579531648195e-05, "num_env_steps_sampled_lifetime": 80400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.81318755629496e-06, "listify_data_for_vector_env": 1.2421340404095155e-05, "normalize_and_clip_actions": 1.0296187485956601e-05, "remove_single_ts_time_rank_from_batch": 6.289251129605919e-07, "get_actions": 5.162175708539168e-05, "tensor_to_numpy": 1.4799640402877278e-05}}, "connector_pipeline_timer": 0.0001244958478419519}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 16.0, "env_step_timer": 1.655274562059629e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -2.0}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0001318021964965465, "episode_duration_sec_mean": 0.004901025360450149, "episode_return_mean": -2.0, "num_episodes_lifetime": 320, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "module_episode_returns_mean": {"default_policy": -2.0}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6124890026295204}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-47", "timestamp": 1754933087, "time_this_iter_s": 2.0697407722473145, "time_total_s": 27.685003519058228, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.685003519058228, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 79.8}}
{"timers": {"training_iteration": 1.6232770796052212, "restore_env_runners": 1.0140198498441652e-05, "training_step": 1.623142469268938, "env_runner_sampling_timer": 1.504507031186169, "learner_update_timer": 0.11548553694659065, "synch_weights": 0.000635162085948585, "restore_eval_env_runners": 8.330499282630336e-06, "evaluation_iteration": 0.11548826056018281, "synch_eval_env_connectors": 0.00013612680460501028, "synch_env_connectors": 4.077230714744668e-06}, "env_runners": {"env_reset_timer": 4.775911186720663e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.485479326201823e-05, "tensor_to_numpy": 2.0845822616845045e-05, "un_batch_to_individual_items": 6.314616102545905e-06, "listify_data_for_vector_env": 1.2859884292868125e-05, "normalize_and_clip_actions": 1.0810919013406635e-05, "remove_single_ts_time_rank_from_batch": 6.876312704667959e-07}}, "connector_pipeline_timer": 0.0001373420089347398}, "episode_duration_sec_mean": 0.006216826163232329, "num_episodes_lifetime": -462625.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2043125445245884e-05, "add_states_from_episodes_to_batch": 1.912097278359327e-06, "add_observations_from_episodes_to_batch": 3.5875415996494106e-06, "batch_individual_items": 7.330860836841952e-06, "add_time_dim_to_batch_and_zero_pad": 2.8204868840235524e-06}}, "connector_pipeline_timer": 5.216707390690761e-05}, "episode_return_mean": 6.62, "agent_episode_returns_mean": {"default_agent": 6.62}, "sample": 0.006417494622532167, "module_episode_returns_mean": {"default_policy": 6.62}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 16.0, "env_step_timer": 1.692235419443164e-05, "episode_len_min": 20, "rlmodule_inference_timer": 5.409971769981092e-05, "num_env_steps_sampled_lifetime": -9252500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0017808281899903825, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3355.405460806371}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000846639840963364, "add_columns_from_episodes_to_train_batch": 0.03522500718175835, "add_time_dim_to_batch_and_zero_pad": 1.2076806205372582e-05, "batch_individual_items": 0.03586214459830415, "numpy_to_tensor": 7.332996659929728e-05, "add_states_from_episodes_to_batch": 3.671985634085228e-06, "general_advantage_estimation": 0.006537318698821423, "add_one_ts_to_episodes_and_truncate": 0.00861147651039055}}, "connector_pipeline_timer": 0.0873162671751427}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1946941.369365206, "num_module_steps_trained_throughput": 371798.56555877347, "num_module_steps_trained_lifetime_throughput": 371453.23931601614}, "default_policy": {"weights_seq_no": 17.0, "vf_loss_unclipped": 26.885883331298828, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 102000, "gradients_default_optimizer_global_norm": 0.03156490996479988, "policy_loss": -0.07086284458637238, "curr_kl_coeff": 5.695314939657692e-06, "total_loss": -0.007574191316962242, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.6019554734230042, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.023396968841552734, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0002801602240651846, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 371909.0181697634}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "sample": 0.10927037870446975, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.589164935917638e-06, "add_states_from_episodes_to_batch": 1.7194546151958105e-06, "add_observations_from_episodes_to_batch": 2.9318967028205496e-06, "add_time_dim_to_batch_and_zero_pad": 2.5079514325982026e-06, "numpy_to_tensor": 8.889643282351929e-06}}, "connector_pipeline_timer": 4.534140469291121e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.8998011599701244e-05, "num_env_steps_sampled_lifetime": 85400, "episode_return_max": 11.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.6088071570529845e-06, "listify_data_for_vector_env": 1.1517500344694558e-05, "normalize_and_clip_actions": 9.856627585883034e-06, "remove_single_ts_time_rank_from_batch": 6.173547199030327e-07, "get_actions": 3.911201349852471e-05, "tensor_to_numpy": 1.4193425523765324e-05}}, "connector_pipeline_timer": 0.00010787547879010783}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 17.0, "env_step_timer": 1.4697040113862275e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0001319812546155175, "episode_duration_sec_mean": 0.004975806199945509, "episode_return_mean": -1.6, "num_episodes_lifetime": 340, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "module_episode_returns_mean": {"default_policy": -1.6}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6172239896827176}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-49", "timestamp": 1754933089, "time_this_iter_s": 2.186755657196045, "time_total_s": 29.871759176254272, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.871759176254272, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.53333333333333, "ram_util_percent": 79.63333333333334}}
{"timers": {"training_iteration": 1.6236498838088722, "restore_env_runners": 1.009712641045862e-05, "training_step": 1.6235147404056476, "env_runner_sampling_timer": 1.5036580579649148, "learner_update_timer": 0.1167044469965949, "synch_weights": 0.00063507588532293, "restore_eval_env_runners": 8.335944674552014e-06, "evaluation_iteration": 0.1155241237944301, "synch_eval_env_connectors": 0.00013661719675842353, "synch_env_connectors": 4.081879009561219e-06}, "env_runners": {"env_reset_timer": 4.2589723139033946e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9755023915885515e-05, "tensor_to_numpy": 1.3479889967557185e-05, "un_batch_to_individual_items": 5.604749200217668e-06, "listify_data_for_vector_env": 1.1311098977533889e-05, "normalize_and_clip_actions": 9.776015583868498e-06, "remove_single_ts_time_rank_from_batch": 6.103000271970463e-07}}, "connector_pipeline_timer": 0.00010695469396802696}, "episode_duration_sec_mean": 0.00466976015176624, "num_episodes_lifetime": -493500.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.117890305275135e-06, "add_states_from_episodes_to_batch": 1.7726964483246339e-06, "add_observations_from_episodes_to_batch": 3.024826890513738e-06, "batch_individual_items": 6.446770397600059e-06, "add_time_dim_to_batch_and_zero_pad": 2.500742160889028e-06}}, "connector_pipeline_timer": 4.507197779209253e-05}, "episode_return_mean": 6.7799999999999985, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "sample": 0.005559978368372152, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 17.0, "env_step_timer": 1.4337864069369407e-05, "episode_len_min": 20, "rlmodule_inference_timer": 2.8878622370562205e-05, "num_env_steps_sampled_lifetime": -9870000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.00212415431852497, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3580.85368651444}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008462246924508378, "add_columns_from_episodes_to_train_batch": 0.03523551210960072, "add_time_dim_to_batch_and_zero_pad": 1.211103815941211e-05, "batch_individual_items": 0.03722853731294116, "numpy_to_tensor": 7.342041709393883e-05, "add_states_from_episodes_to_batch": 3.667345183827006e-06, "general_advantage_estimation": 0.006526281761428716, "add_one_ts_to_episodes_and_truncate": 0.008603334655653598}}, "connector_pipeline_timer": 0.08867335408268864}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1944046.6069896396, "num_module_steps_trained_throughput": 371227.64922256366, "num_module_steps_trained_lifetime_throughput": 370889.02565233863}, "default_policy": {"weights_seq_no": 18.0, "vf_loss_unclipped": 26.647491455078125, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 108000, "gradients_default_optimizer_global_norm": 0.02470725029706955, "policy_loss": -0.1494331955909729, "curr_kl_coeff": 2.847657469828846e-06, "total_loss": -0.08611404895782471, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.5985884666442871, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.02406442165374756, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0001861961354734376, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 371304.6300006718}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "sample": 0.10916944991742729, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.104697031782554e-06, "add_states_from_episodes_to_batch": 1.641579927471555e-06, "add_observations_from_episodes_to_batch": 2.7941513273756816e-06, "add_time_dim_to_batch_and_zero_pad": 2.317442175460176e-06, "numpy_to_tensor": 8.536025550427355e-06}}, "connector_pipeline_timer": 4.318582014183539e-05}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.804174200911552e-05, "num_env_steps_sampled_lifetime": 90400, "episode_return_max": 12.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.387648216649119e-06, "listify_data_for_vector_env": 1.0960116412783528e-05, "normalize_and_clip_actions": 9.29500134753529e-06, "remove_single_ts_time_rank_from_batch": 5.763335578425114e-07, "get_actions": 3.833047116426154e-05, "tensor_to_numpy": 1.3180105954614622e-05}}, "connector_pipeline_timer": 0.00010366230577472917}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 18.0, "env_step_timer": 1.3724499591392003e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00013187019166911715, "episode_duration_sec_mean": 0.004954148707911372, "episode_return_mean": -0.6, "num_episodes_lifetime": 360, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.617863262286171}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-50", "timestamp": 1754933090, "time_this_iter_s": 1.7678372859954834, "time_total_s": 31.639596462249756, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.639596462249756, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.0, "ram_util_percent": 80.73333333333333}}
{"timers": {"training_iteration": 1.6461069349705177, "restore_env_runners": 1.0052824960866166e-05, "training_step": 1.6459697234223187, "env_runner_sampling_timer": 1.5180529615557565, "learner_update_timer": 0.12472663543691372, "synch_weights": 0.0006491813765281877, "restore_eval_env_runners": 8.318834859151767e-06, "evaluation_iteration": 0.11541650213654417, "synch_eval_env_connectors": 0.00013633560464418028, "synch_env_connectors": 4.081060524045341e-06}, "env_runners": {"env_reset_timer": 6.771787331267076e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.016731421135034e-05, "tensor_to_numpy": 2.939579525794665e-05, "un_batch_to_individual_items": 9.64659727400266e-06, "listify_data_for_vector_env": 2.141578693377768e-05, "normalize_and_clip_actions": 1.7917343526544492e-05, "remove_single_ts_time_rank_from_batch": 1.0678862294600334e-06}}, "connector_pipeline_timer": 0.00021443687128464432}, "episode_duration_sec_mean": 0.009407513003330675, "num_episodes_lifetime": -524375.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.8287159160949217e-05, "add_states_from_episodes_to_batch": 2.5964017578058855e-06, "add_observations_from_episodes_to_batch": 5.985682447275815e-06, "batch_individual_items": 1.2406274513885478e-05, "add_time_dim_to_batch_and_zero_pad": 4.55633258099652e-06}}, "connector_pipeline_timer": 7.846897211884816e-05}, "episode_return_mean": 7.1, "agent_episode_returns_mean": {"default_agent": 7.1}, "sample": 0.007940734031872109, "module_episode_returns_mean": {"default_policy": 7.1}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 18.0, "env_step_timer": 3.477528046759671e-05, "episode_len_min": 20, "rlmodule_inference_timer": 6.101905145915755e-05, "num_env_steps_sampled_lifetime": -10487500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.0023973843953148124, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2462.838721673264}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008582574455888398, "add_columns_from_episodes_to_train_batch": 0.03555863990841005, "add_time_dim_to_batch_and_zero_pad": 1.2185348357802771e-05, "batch_individual_items": 0.04385967319007684, "numpy_to_tensor": 7.49478832293244e-05, "add_states_from_episodes_to_batch": 3.665671998496004e-06, "general_advantage_estimation": 0.006569986444087568, "add_one_ts_to_episodes_and_truncate": 0.008644925899046908}}, "connector_pipeline_timer": 0.09572693013089198}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1922103.7877767459, "num_module_steps_trained_throughput": 367022.51040662156, "num_module_steps_trained_lifetime_throughput": 366692.7325162021}, "default_policy": {"weights_seq_no": 19.0, "vf_loss_unclipped": 26.865428924560547, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 114000, "gradients_default_optimizer_global_norm": 0.021649973466992378, "policy_loss": -0.019801601767539978, "curr_kl_coeff": 1.423828734914423e-06, "total_loss": 0.04370664060115814, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.577710747718811, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.024727582931518555, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00044902059016749263, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 367073.4593110522}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "sample": 0.11600852416862815, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 3.301825352926894e-05, "add_states_from_episodes_to_batch": 6.059814611936529e-06, "add_observations_from_episodes_to_batch": 1.3385245414850429e-05, "add_time_dim_to_batch_and_zero_pad": 1.2348283437462478e-05, "numpy_to_tensor": 9.627730580853426e-05}}, "connector_pipeline_timer": 0.00023921451266028815}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 0.0002979673160508295, "num_env_steps_sampled_lifetime": 95400, "episode_return_max": 12.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.13928481977054e-05, "listify_data_for_vector_env": 5.072378059053831e-05, "normalize_and_clip_actions": 6.80681063450573e-05, "remove_single_ts_time_rank_from_batch": 4.290002759943858e-06, "get_actions": 0.00038045765338477706, "tensor_to_numpy": 9.718374803661364e-05}}, "connector_pipeline_timer": 0.0008826893687358613}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 19.0, "env_step_timer": 0.0002805771084571981, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018350564966228527, "episode_duration_sec_mean": 0.011244613722665235, "episode_return_mean": 0.2, "num_episodes_lifetime": 380, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6407922196632216}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "437e4_00000", "date": "2025-08-11_19-24-55", "timestamp": 1754933095, "time_this_iter_s": 4.701840162277222, "time_total_s": 36.34143662452698, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.34143662452698, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 88.94999999999999, "ram_util_percent": 82.88333333333334}}
{"timers": {"training_iteration": 1.6820129752003123, "restore_env_runners": 1.0094797214246202e-05, "training_step": 1.6818722674383255, "env_runner_sampling_timer": 1.5513033936098544, "learner_update_timer": 0.12735414825269079, "synch_weights": 0.0006556879027158068, "restore_eval_env_runners": 8.392737345833515e-06, "evaluation_iteration": 0.12254177086502771, "synch_eval_env_connectors": 0.00015203016893818708, "synch_env_connectors": 4.103589167104487e-06}, "env_runners": {"env_reset_timer": 0.00010734782340751752, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001577284832225685, "tensor_to_numpy": 5.482372599518094e-05, "un_batch_to_individual_items": 1.490148809797865e-05, "listify_data_for_vector_env": 3.0879290684239924e-05, "normalize_and_clip_actions": 2.8038086135596212e-05, "remove_single_ts_time_rank_from_batch": 1.3498288797805144e-06}}, "connector_pipeline_timer": 0.00036732619653008844}, "episode_duration_sec_mean": 0.016342293981462724, "num_episodes_lifetime": -555250.0, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1617805865246176e-05, "add_states_from_episodes_to_batch": 4.484143614865404e-06, "add_observations_from_episodes_to_batch": 9.733820891914175e-06, "batch_individual_items": 1.7680991319532013e-05, "add_time_dim_to_batch_and_zero_pad": 7.159964798312015e-06}}, "connector_pipeline_timer": 0.00013718214658745663}, "episode_return_mean": 6.940000000000001, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "sample": 0.013760639787924894, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 19.0, "env_step_timer": 4.758140703718651e-05, "episode_len_min": 20, "rlmodule_inference_timer": 0.00011371125263427474, "num_env_steps_sampled_lifetime": -11105000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -10.5, "episode_return_max": 9.5, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "time_between_sampling": 0.008782943610831442, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 1811.6371925755504}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009163157103464568, "add_columns_from_episodes_to_train_batch": 0.03650152809962001, "add_time_dim_to_batch_and_zero_pad": 1.2378085162550888e-05, "batch_individual_items": 0.04442675061872735, "numpy_to_tensor": 7.543590392466434e-05, "add_states_from_episodes_to_batch": 3.6665161461311545e-06, "general_advantage_estimation": 0.007211721579868869, "add_one_ts_to_episodes_and_truncate": 0.008709397890517109}}, "connector_pipeline_timer": 0.09800986582903924}, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1890078.179895884, "num_module_steps_trained_throughput": 360890.95104220824, "num_module_steps_trained_lifetime_throughput": 360572.2353389526}, "default_policy": {"weights_seq_no": 20.0, "vf_loss_unclipped": 26.72565269470215, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 120000, "gradients_default_optimizer_global_norm": 0.0137735391035676, "policy_loss": -0.08537109941244125, "curr_kl_coeff": 7.119143674572115e-07, "total_loss": -0.021787814795970917, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "entropy": 0.5694254040718079, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.02492392063140869, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0002637100697029382, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 360920.74150942656}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "sample": 0.12037011517744248, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.7838413868332593e-05, "add_states_from_episodes_to_batch": 5.991770942455058e-06, "add_observations_from_episodes_to_batch": 2.178821354956199e-05, "add_time_dim_to_batch_and_zero_pad": 1.0721302502895369e-05, "numpy_to_tensor": 4.499416776560191e-05}}, "connector_pipeline_timer": 0.000592472879615336}, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 0.00020178931341611269, "num_env_steps_sampled_lifetime": 100400, "episode_return_max": 12.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.023724822452499e-05, "listify_data_for_vector_env": 3.5862247182217216e-05, "normalize_and_clip_actions": 5.5630924567468776e-05, "remove_single_ts_time_rank_from_batch": 1.6123516902807837e-06, "get_actions": 0.0002574112652413359, "tensor_to_numpy": 5.846537201707305e-05}}, "connector_pipeline_timer": 0.0006000930814937938}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 20.0, "env_step_timer": 7.040289983703001e-05, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018391475227927815, "episode_duration_sec_mean": 0.015504043289693072, "episode_return_mean": 0.6, "num_episodes_lifetime": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "module_episode_returns_mean": {"default_policy": 0.6}, "episode_len_max": 20, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "time_between_sampling": 1.6783526491268856}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "437e4_00000", "date": "2025-08-11_19-25-01", "timestamp": 1754933101, "time_this_iter_s": 5.877241849899292, "time_total_s": 42.21867847442627, "pid": 14504, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3882e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.21867847442627, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 91.375, "ram_util_percent": 81.65}}
