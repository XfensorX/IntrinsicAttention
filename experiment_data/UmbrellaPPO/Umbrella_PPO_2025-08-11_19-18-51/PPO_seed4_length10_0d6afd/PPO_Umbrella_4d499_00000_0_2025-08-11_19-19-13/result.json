{"timers": {"training_iteration": 5.473536417004652, "restore_env_runners": 3.716698847711086e-05, "training_step": 5.473321500001475, "env_runner_sampling_timer": 5.264298374997452, "learner_update_timer": 0.20494616706855595, "synch_weights": 0.0012272079475224018}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.0001449566807173e-06, "get_actions": 0.00021399458607389326, "tensor_to_numpy": 5.282284272788943e-05, "normalize_and_clip_actions": 3.4712790606693234e-05, "listify_data_for_vector_env": 3.887708514724085e-05, "un_batch_to_individual_items": 1.6757597794695546e-05}}, "connector_pipeline_timer": 0.0004377090136397387}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "env_step_timer": 6.330757958163163e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.1513577861150106e-05, "numpy_to_tensor": 4.8665426892012756e-05, "add_states_from_episodes_to_batch": 5.133779606948483e-06, "batch_individual_items": 2.5525265694113223e-05, "add_time_dim_to_batch_and_zero_pad": 8.68869730332437e-06}}, "connector_pipeline_timer": 0.00017981665038726262}, "sample": 0.024049118661991237, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 0.0002068974118175239, "episode_len_min": 20, "weights_seq_no": 0.0, "num_episodes": 250.0, "time_between_sampling": 0.0018297076998625011, "episode_duration_sec_mean": 0.018293328979052604, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 0.000419586755163722, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_return_mean": 2.899999999999998, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "num_episodes_lifetime": 31375.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": 627500.0, "num_env_steps_sampled_lifetime_throughput": 1361.0236843176863}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011504197027534246, "add_states_from_episodes_to_batch": 3.750086762011051e-06, "add_columns_from_episodes_to_train_batch": 0.06529325002338737, "add_time_dim_to_batch_and_zero_pad": 1.304189208894968e-05, "add_one_ts_to_episodes_and_truncate": 0.012257124995812774, "add_observations_from_episodes_to_batch": 0.0009670410072430968, "batch_individual_items": 0.04879100003745407, "general_advantage_estimation": 0.018947375006973743}}, "connector_pipeline_timer": 0.14660883403848857}, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5250, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 765078.4376392447, "num_module_steps_trained_throughput": 146002.14537537954, "num_module_steps_trained_lifetime_throughput": 145917.009249535}, "default_policy": {"entropy": 0.6919029951095581, "weights_seq_no": 1.0, "total_loss": -0.016456305980682373, "vf_loss": 0.10070119053125381, "vf_loss_unclipped": 28.695228576660156, "gradients_default_optimizer_global_norm": 0.10145387798547745, "vf_explained_var": 0.012743055820465088, "policy_loss": -0.07757909595966339, "curr_kl_coeff": 0.3732481598854065, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 5.3182855481281877e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 145847.2920202282}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_reset_timer": 0.00202550005633384, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.644853827069246e-05, "add_states_from_episodes_to_batch": 4.630671985046598e-06, "numpy_to_tensor": 2.9433442378830373e-05, "add_time_dim_to_batch_and_zero_pad": 1.131127145464604e-05, "add_observations_from_episodes_to_batch": 8.825946778365544e-06}}, "connector_pipeline_timer": 0.0001277567572785193}, "module_episode_returns_mean": {"default_policy": 3.15}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_env_steps_sampled": 400, "episode_return_mean": 3.15, "agent_episode_returns_mean": {"default_agent": 3.15}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00013769082368036997, "normalize_and_clip_actions": 2.5321073298524467e-05, "listify_data_for_vector_env": 3.131126416312934e-05, "tensor_to_numpy": 3.7380880262647385e-05, "un_batch_to_individual_items": 1.0783862559262366e-05, "remove_single_ts_time_rank_from_batch": 1.5702750524219204e-06}}, "connector_pipeline_timer": 0.00029495750248456734}, "env_step_timer": 6.668418023454466e-05, "sample": 0.32736912509426475, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 1.0, "episode_return_min": -13.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 5400, "episode_return_max": 11.5, "episode_duration_sec_mean": 0.014957385481102392, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes_lifetime": 20, "rlmodule_inference_timer": 0.00010030820583672176}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4d499_00000", "date": "2025-08-11_19-30-32", "timestamp": 1754933432, "time_this_iter_s": 5.8308022022247314, "time_total_s": 5.8308022022247314, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.8308022022247314, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 83.45555555555556, "ram_util_percent": 81.24444444444445}}
{"timers": {"training_iteration": 5.4539328999153796, "restore_env_runners": 3.6868648603558544e-05, "training_step": 5.4537166675017215, "env_runner_sampling_timer": 5.243687778747407, "learner_update_timer": 0.20592282705707474, "synch_weights": 0.0012283358676359057, "restore_eval_env_runners": 1.4416989870369434e-05, "evaluation_iteration": 0.35521650000009686, "synch_eval_env_connectors": 0.0005301249912008643, "synch_env_connectors": 4.624947905540466e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3696372166302311e-06, "get_actions": 0.0001137809527056028, "tensor_to_numpy": 3.101621271090133e-05, "normalize_and_clip_actions": 1.933742083804315e-05, "listify_data_for_vector_env": 2.5215629867528718e-05, "un_batch_to_individual_items": 1.1040623129776058e-05}}, "connector_pipeline_timer": 0.00025593535240370604}, "agent_episode_returns_mean": {"default_agent": 3.1399999999999992}, "env_step_timer": 3.545732151585822e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.80996500813668e-06, "numpy_to_tensor": 2.182384372368574e-05, "add_states_from_episodes_to_batch": 3.266199835052516e-06, "batch_individual_items": 1.757194032476224e-05, "add_time_dim_to_batch_and_zero_pad": 5.6810485381130315e-06}}, "connector_pipeline_timer": 9.551888193149035e-05}, "sample": 0.015978134966875373, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 7.546849535155474e-05, "episode_len_min": 20, "weights_seq_no": 1.0, "num_episodes": 250.0, "time_between_sampling": 0.0036899495931302967, "episode_duration_sec_mean": 0.010793663342483346, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 0.00016366916648451492, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 3.1399999999999992, "module_episode_returns_mean": {"default_policy": 3.1399999999999992}, "num_episodes_lifetime": 500.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled_lifetime_throughput": 1876.0397430327487}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011474446044303476, "add_states_from_episodes_to_batch": 3.9184163324534896e-06, "add_columns_from_episodes_to_train_batch": 0.06534755585365928, "add_time_dim_to_batch_and_zero_pad": 1.3156892964616417e-05, "add_one_ts_to_episodes_and_truncate": 0.012339742495678365, "add_observations_from_episodes_to_batch": 0.0010123864375054835, "batch_individual_items": 0.04994765128707513, "general_advantage_estimation": 0.018819417087361217}}, "connector_pipeline_timer": 0.14782028360757976}, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 766523.4886055706, "num_module_steps_trained_throughput": 146266.64296894864, "num_module_steps_trained_lifetime_throughput": 146181.0011147278}, "default_policy": {"entropy": 0.6910908818244934, "weights_seq_no": 2.0, "total_loss": 0.21512305736541748, "vf_loss": 0.10001108795404434, "vf_loss_unclipped": 28.312942504882812, "gradients_default_optimizer_global_norm": 0.09580280631780624, "vf_explained_var": 0.01552802324295044, "policy_loss": 0.15436917543411255, "curr_kl_coeff": 0.18662407994270325, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.00033477909164503217, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 146108.5857954807}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0020070483849849554, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.111495004662693e-06, "add_states_from_episodes_to_batch": 2.1029395887901435e-06, "numpy_to_tensor": 1.4359073776285319e-05, "add_time_dim_to_batch_and_zero_pad": 3.4687959854373043e-06, "add_observations_from_episodes_to_batch": 4.221937482932319e-06}}, "connector_pipeline_timer": 6.403051676686034e-05}, "module_episode_returns_mean": {"default_policy": 1.15}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_env_steps_sampled": 400, "episode_return_mean": 1.15, "agent_episode_returns_mean": {"default_agent": 1.15}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.176231010475554e-05, "normalize_and_clip_actions": 1.3920692368608232e-05, "listify_data_for_vector_env": 1.661891490678357e-05, "tensor_to_numpy": 1.993669664476773e-05, "un_batch_to_individual_items": 8.03842495329957e-06, "remove_single_ts_time_rank_from_batch": 9.56262547070765e-07}}, "connector_pipeline_timer": 0.00015731127057225765}, "env_step_timer": 2.5182084991866017e-05, "sample": 0.32581148092285733, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 2.0, "episode_return_min": -13.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 10400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.011436216719448566, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes_lifetime": 40, "rlmodule_inference_timer": 4.273545241567658e-05, "time_between_sampling": 3.569461374892853}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4d499_00000", "date": "2025-08-11_19-30-36", "timestamp": 1754933436, "time_this_iter_s": 3.6969540119171143, "time_total_s": 9.527756214141846, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.527756214141846, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 82.4, "ram_util_percent": 80.92}}
{"timers": {"training_iteration": 5.434205590496502, "restore_env_runners": 3.657455174252391e-05, "training_step": 5.433987537486082, "env_runner_sampling_timer": 5.224122034710238, "learner_update_timer": 0.20574638420550614, "synch_weights": 0.001227444169623777, "restore_eval_env_runners": 1.4361570356413722e-05, "evaluation_iteration": 0.35346156166982834, "synch_eval_env_connectors": 0.0005287812417373061, "synch_env_connectors": 4.631609190255404e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2643793857592428e-06, "get_actions": 0.00011060214922239533, "tensor_to_numpy": 3.239313713293919e-05, "normalize_and_clip_actions": 1.9410821911955435e-05, "listify_data_for_vector_env": 2.5104614490259558e-05, "un_batch_to_individual_items": 1.3946012095599865e-05}}, "connector_pipeline_timer": 0.0002553353740296147}, "agent_episode_returns_mean": {"default_agent": 3.06}, "env_step_timer": 3.871868082335231e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.4895452253138294e-06, "numpy_to_tensor": 2.342326602355128e-05, "add_states_from_episodes_to_batch": 3.189302654135281e-06, "batch_individual_items": 1.4185164967400802e-05, "add_time_dim_to_batch_and_zero_pad": 4.834033766552817e-06}}, "connector_pipeline_timer": 9.218549245841506e-05}, "sample": 0.011076136961837992, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 7.492842364308236e-05, "episode_len_min": 20, "weights_seq_no": 2.0, "num_episodes": 250.0, "time_between_sampling": 0.003277814884016015, "episode_duration_sec_mean": 0.011090523864142596, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 9.674759959194092e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 3.06, "module_episode_returns_mean": {"default_policy": 3.06}, "num_episodes_lifetime": -30375.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -607500.0, "num_env_steps_sampled_lifetime_throughput": 2114.730042031643}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011439368546707554, "add_states_from_episodes_to_batch": 3.9963122224435215e-06, "add_columns_from_episodes_to_train_batch": 0.06511124321430689, "add_time_dim_to_batch_and_zero_pad": 1.3303654443006961e-05, "add_one_ts_to_episodes_and_truncate": 0.012301579240104183, "add_observations_from_episodes_to_batch": 0.0010118204922415315, "batch_individual_items": 0.05039647394374478, "general_advantage_estimation": 0.01869871750609018}}, "connector_pipeline_timer": 0.14787270369059405}, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 768673.5633802881, "num_module_steps_trained_throughput": 146688.95954588812, "num_module_steps_trained_lifetime_throughput": 146587.90703667735}, "default_policy": {"entropy": 0.6889595985412598, "weights_seq_no": 3.0, "total_loss": 0.13235385715961456, "vf_loss": 0.1000901460647583, "vf_loss_unclipped": 28.33220672607422, "gradients_default_optimizer_global_norm": 0.10330437868833542, "vf_explained_var": 0.01814943552017212, "policy_loss": 0.07159475237131119, "curr_kl_coeff": 0.09331203997135162, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0003109359822701663, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 146528.68565469078}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.001988010820525233, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7154063859170886e-05, "add_states_from_episodes_to_batch": 3.027453100991586e-06, "numpy_to_tensor": 2.4829637237579306e-05, "add_time_dim_to_batch_and_zero_pad": 6.133966174088856e-06, "add_observations_from_episodes_to_batch": 7.631388094635408e-06}}, "connector_pipeline_timer": 0.000104101649458184}, "module_episode_returns_mean": {"default_policy": 0.15}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_env_steps_sampled": 400, "episode_return_mean": 0.15, "agent_episode_returns_mean": {"default_agent": 0.15}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00014500081067613573, "normalize_and_clip_actions": 2.976129601175709e-05, "listify_data_for_vector_env": 3.304279638210001e-05, "tensor_to_numpy": 3.962220369004314e-05, "un_batch_to_individual_items": 1.6475110008203685e-05, "remove_single_ts_time_rank_from_batch": 2.919247058744518e-06}}, "connector_pipeline_timer": 0.00033664674801123484}, "env_step_timer": 5.2125866541737115e-05, "sample": 0.32524748278380144, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 3.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 15400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.011773050776294742, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes_lifetime": 60, "rlmodule_inference_timer": 0.0001116418178582847, "time_between_sampling": 3.568803114473121}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4d499_00000", "date": "2025-08-11_19-30-40", "timestamp": 1754933440, "time_this_iter_s": 3.768812894821167, "time_total_s": 13.296569108963013, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.296569108963013, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 79.16, "ram_util_percent": 80.03999999999999}}
{"timers": {"training_iteration": 5.410483607090687, "restore_env_runners": 3.631213646475225e-05, "training_step": 5.410262317952131, "env_runner_sampling_timer": 5.201062653943549, "learner_update_timer": 0.2050371428633972, "synch_weights": 0.0012311518088770096, "restore_eval_env_runners": 1.438462414080277e-05, "evaluation_iteration": 0.3527761106338235, "synch_eval_env_connectors": 0.0005252742589451373, "synch_env_connectors": 4.681963217444718e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0994161469112483e-06, "get_actions": 9.367796333741645e-05, "tensor_to_numpy": 2.738487867341094e-05, "normalize_and_clip_actions": 1.6982828142452584e-05, "listify_data_for_vector_env": 2.205722081288437e-05, "un_batch_to_individual_items": 9.757350302772805e-06}}, "connector_pipeline_timer": 0.0002181983530258941}, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "env_step_timer": 2.9155050274654504e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.35385081297757e-06, "numpy_to_tensor": 1.936452200459855e-05, "add_states_from_episodes_to_batch": 2.836590127792947e-06, "batch_individual_items": 1.2628734400282934e-05, "add_time_dim_to_batch_and_zero_pad": 4.686571071819093e-06}}, "connector_pipeline_timer": 8.256081768307619e-05}, "sample": 0.011067329425405618, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 6.089969909936795e-05, "episode_len_min": 20, "weights_seq_no": 3.0, "num_episodes": 250.0, "time_between_sampling": 0.003797174945403329, "episode_duration_sec_mean": 0.009350435172673314, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 9.483727120040834e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 3.7799999999999994, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "num_episodes_lifetime": -61250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -1225000.0, "num_env_steps_sampled_lifetime_throughput": 2159.044253795723}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011396099966263862, "add_states_from_episodes_to_batch": 4.002179484115914e-06, "add_columns_from_episodes_to_train_batch": 0.06486571287277074, "add_time_dim_to_batch_and_zero_pad": 1.3300617724307811e-05, "add_one_ts_to_episodes_and_truncate": 0.012274000947397667, "add_observations_from_episodes_to_batch": 0.0010112606266895307, "batch_individual_items": 0.05022577420409745, "general_advantage_estimation": 0.018591179911545942}}, "connector_pipeline_timer": 0.14731938498303712}, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 770214.2940542971, "num_module_steps_trained_throughput": 146981.43480196918, "num_module_steps_trained_lifetime_throughput": 146874.4524519855}, "default_policy": {"entropy": 0.6815755367279053, "weights_seq_no": 4.0, "total_loss": 0.23179858922958374, "vf_loss": 0.10008808225393295, "vf_loss_unclipped": 28.318328857421875, "gradients_default_optimizer_global_norm": 0.026392024010419846, "vf_explained_var": 0.01967012882232666, "policy_loss": 0.1708587259054184, "curr_kl_coeff": 0.04665601998567581, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0018568553496152163, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 146809.70267560054}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0019702332126133844, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1570370784255874e-05, "add_states_from_episodes_to_batch": 2.6025321008939794e-06, "numpy_to_tensor": 1.536511775101201e-05, "add_time_dim_to_batch_and_zero_pad": 3.6151935233995857e-06, "add_observations_from_episodes_to_batch": 4.517604573532862e-06}}, "connector_pipeline_timer": 7.208123685929124e-05}, "module_episode_returns_mean": {"default_policy": 0.15}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_env_steps_sampled": 400, "episode_return_mean": 0.15, "agent_episode_returns_mean": {"default_agent": 0.15}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.676599572977579e-05, "normalize_and_clip_actions": 1.5029601797618382e-05, "listify_data_for_vector_env": 2.0274642739566444e-05, "tensor_to_numpy": 2.3262239314715433e-05, "un_batch_to_individual_items": 8.72392063064091e-06, "remove_single_ts_time_rank_from_batch": 8.453009103761899e-07}}, "connector_pipeline_timer": 0.00017613336836616676}, "env_step_timer": 2.5666406222528466e-05, "sample": 0.32363092503536556, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 4.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 20400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.010719609457009938, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes_lifetime": 80, "rlmodule_inference_timer": 5.140215824058526e-05, "time_between_sampling": 3.5643109249986593}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4d499_00000", "date": "2025-08-11_19-30-43", "timestamp": 1754933443, "time_this_iter_s": 3.2390520572662354, "time_total_s": 16.535621166229248, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.535621166229248, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 79.34, "ram_util_percent": 80.28}}
{"timers": {"training_iteration": 5.385405251850287, "restore_env_runners": 3.6024014507038514e-05, "training_step": 5.3851839239422, "env_runner_sampling_timer": 5.176528902824075, "learner_update_timer": 0.20449827309533372, "synch_weights": 0.0012265240407974038, "restore_eval_env_runners": 1.4514107105205766e-05, "evaluation_iteration": 0.3509622432774693, "synch_eval_env_connectors": 0.0005234648557296023, "synch_env_connectors": 4.69264344102703e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0045003016598302e-06, "get_actions": 8.492634124457324e-05, "tensor_to_numpy": 2.483270291478091e-05, "normalize_and_clip_actions": 1.5881499305419787e-05, "listify_data_for_vector_env": 2.031160030435257e-05, "un_batch_to_individual_items": 9.123786648621623e-06}}, "connector_pipeline_timer": 0.00019925136319377785}, "agent_episode_returns_mean": {"default_agent": 4.5}, "env_step_timer": 2.7308023347582263e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.304743115481575e-06, "numpy_to_tensor": 1.7255360387332962e-05, "add_states_from_episodes_to_batch": 2.714560300949168e-06, "batch_individual_items": 1.1262388004139866e-05, "add_time_dim_to_batch_and_zero_pad": 4.12332382076352e-06}}, "connector_pipeline_timer": 7.51502451278313e-05}, "sample": 0.0095833040932613, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 9.372011474692685e-05, "episode_len_min": 20, "weights_seq_no": 4.0, "num_episodes": 250.0, "time_between_sampling": 0.0026425907262552727, "episode_duration_sec_mean": 0.009259333323687313, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 8.182590503010389e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 4.5, "module_episode_returns_mean": {"default_policy": 4.5}, "num_episodes_lifetime": -92125.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -1842500.0, "num_env_steps_sampled_lifetime_throughput": 2250.404664729148}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001142063897347066, "add_states_from_episodes_to_batch": 4.029237361864653e-06, "add_columns_from_episodes_to_train_batch": 0.06480413574401143, "add_time_dim_to_batch_and_zero_pad": 1.3398020752024603e-05, "add_one_ts_to_episodes_and_truncate": 0.012259825938042378, "add_observations_from_episodes_to_batch": 0.0010198467704864123, "batch_individual_items": 0.05017752896217866, "general_advantage_estimation": 0.018481541442917793}}, "connector_pipeline_timer": 0.1470946257243138}, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 777099.0056257694, "num_module_steps_trained_throughput": 148276.41783733477, "num_module_steps_trained_lifetime_throughput": 148168.86435659454}, "default_policy": {"entropy": 0.6678587794303894, "weights_seq_no": 5.0, "total_loss": 0.16066518425941467, "vf_loss": 0.1004083901643753, "vf_loss_unclipped": 28.426040649414062, "gradients_default_optimizer_global_norm": 0.055656589567661285, "vf_explained_var": 0.02140355110168457, "policy_loss": 0.09948650747537613, "curr_kl_coeff": 0.023328009992837906, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.001579137286171317, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 148086.82221354468}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0019514892102523768, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1684109918927396e-05, "add_states_from_episodes_to_batch": 2.6503231885688547e-06, "numpy_to_tensor": 1.6806117568292675e-05, "add_time_dim_to_batch_and_zero_pad": 4.645043388038582e-06, "add_observations_from_episodes_to_batch": 4.8225807796652775e-06}}, "connector_pipeline_timer": 7.45112454331413e-05}, "module_episode_returns_mean": {"default_policy": 0.15}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_env_steps_sampled": 400, "episode_return_mean": 0.15, "agent_episode_returns_mean": {"default_agent": 0.15}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.502114286134471e-05, "normalize_and_clip_actions": 1.6068243541594866e-05, "listify_data_for_vector_env": 1.947345174810417e-05, "tensor_to_numpy": 2.469546908367679e-05, "un_batch_to_individual_items": 9.962036773721796e-06, "remove_single_ts_time_rank_from_batch": 1.0368814446922387e-06}}, "connector_pipeline_timer": 0.00018839270020503627}, "env_step_timer": 2.6688507870282687e-05, "sample": 0.32277512703466027, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 5.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 25400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.010756110069341957, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes_lifetime": 100, "rlmodule_inference_timer": 5.23073293547173e-05, "time_between_sampling": 3.557961767828861}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4d499_00000", "date": "2025-08-11_19-30-46", "timestamp": 1754933446, "time_this_iter_s": 3.1495490074157715, "time_total_s": 19.68517017364502, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.68517017364502, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 74.67500000000001, "ram_util_percent": 79.575}}
{"timers": {"training_iteration": 5.359554031831117, "restore_env_runners": 3.5730023993313404e-05, "training_step": 5.359331463452879, "env_runner_sampling_timer": 5.149786072135643, "learner_update_timer": 0.20539077619500593, "synch_weights": 0.0012252775501815584, "restore_eval_env_runners": 1.4441056222195037e-05, "evaluation_iteration": 0.34989770125421954, "synch_eval_env_connectors": 0.0005193627082287241, "synch_env_connectors": 4.7061272454191926e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.021097944091971e-06, "get_actions": 8.303362832376582e-05, "tensor_to_numpy": 2.446248078482671e-05, "normalize_and_clip_actions": 1.5742295679390985e-05, "listify_data_for_vector_env": 1.9773354576231537e-05, "un_batch_to_individual_items": 8.860271063952744e-06}}, "connector_pipeline_timer": 0.00019543447289417266}, "agent_episode_returns_mean": {"default_agent": 6.3400000000000025}, "env_step_timer": 2.653564236821492e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.336711383957016e-06, "numpy_to_tensor": 1.695792672831374e-05, "add_states_from_episodes_to_batch": 2.6234305995751374e-06, "batch_individual_items": 1.1576436566329215e-05, "add_time_dim_to_batch_and_zero_pad": 4.099784027382881e-06}}, "connector_pipeline_timer": 7.428888373665329e-05}, "sample": 0.009568452017753639, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.593563919313831e-05, "episode_len_min": 20, "weights_seq_no": 5.0, "num_episodes": 250.0, "time_between_sampling": 0.0027565844824674244, "episode_duration_sec_mean": 0.008381377360783513, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 8.380587226150708e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 6.3400000000000025, "module_episode_returns_mean": {"default_policy": 6.3400000000000025}, "num_episodes_lifetime": -123000.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -2460000.0, "num_env_steps_sampled_lifetime_throughput": 2309.9353820511164}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011377057568536768, "add_states_from_episodes_to_batch": 4.026855637798948e-06, "add_columns_from_episodes_to_train_batch": 0.0647848148060527, "add_time_dim_to_batch_and_zero_pad": 1.3395290670791698e-05, "add_one_ts_to_episodes_and_truncate": 0.012233330588545439, "add_observations_from_episodes_to_batch": 0.0010181120529092513, "batch_individual_items": 0.051546409922368745, "general_advantage_estimation": 0.01836015227861483}}, "connector_pipeline_timer": 0.14829320905712787}, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 786285.6795080124, "num_module_steps_trained_throughput": 150028.44589292136, "num_module_steps_trained_lifetime_throughput": 149922.62381189267}, "default_policy": {"entropy": 0.6470538377761841, "weights_seq_no": 6.0, "total_loss": -0.15098221600055695, "vf_loss": 0.10181018710136414, "vf_loss_unclipped": 28.623245239257812, "gradients_default_optimizer_global_norm": 0.029508594423532486, "vf_explained_var": 0.02075040340423584, "policy_loss": -0.2132357954978943, "curr_kl_coeff": 0.011664004996418953, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0009678311762399971, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 149821.6583212782}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.001932775157775152, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.083493943645355e-06, "add_states_from_episodes_to_batch": 1.960863456646454e-06, "numpy_to_tensor": 1.3484669451824728e-05, "add_time_dim_to_batch_and_zero_pad": 3.023250631135974e-06, "add_observations_from_episodes_to_batch": 3.903877395485865e-06}}, "connector_pipeline_timer": 5.9462379962655544e-05}, "module_episode_returns_mean": {"default_policy": -0.05}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_env_steps_sampled": 400, "episode_return_mean": -0.05, "agent_episode_returns_mean": {"default_agent": -0.05}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.138087505115847e-05, "normalize_and_clip_actions": 1.3878304990173294e-05, "listify_data_for_vector_env": 1.7293657641893103e-05, "tensor_to_numpy": 2.3329039334505616e-05, "un_batch_to_individual_items": 7.303329101464661e-06, "remove_single_ts_time_rank_from_batch": 9.303058368778002e-07}}, "connector_pipeline_timer": 0.00016049883141653427}, "env_step_timer": 2.223242174564335e-05, "sample": 0.32124583076460994, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 6.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 30400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.009333335895789788, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes_lifetime": 120, "rlmodule_inference_timer": 4.358795092866471e-05, "time_between_sampling": 3.5505937130704686}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4d499_00000", "date": "2025-08-11_19-30-49", "timestamp": 1754933449, "time_this_iter_s": 2.977987051010132, "time_total_s": 22.66315722465515, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.66315722465515, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 76.84, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 5.333009930682832, "restore_env_runners": 3.544730290100226e-05, "training_step": 5.33278602048857, "env_runner_sampling_timer": 5.123955666835348, "learner_update_timer": 0.2046822021834156, "synch_weights": 0.001219610195021905, "restore_eval_env_runners": 1.4362485509385527e-05, "evaluation_iteration": 0.34815217257224174, "synch_eval_env_connectors": 0.0005152528309585332, "synch_env_connectors": 4.700315413947939e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.760536649380112e-07, "get_actions": 8.513921869257819e-05, "tensor_to_numpy": 2.4932187244520142e-05, "normalize_and_clip_actions": 1.5958542304391496e-05, "listify_data_for_vector_env": 1.9696972541755867e-05, "un_batch_to_individual_items": 9.117073838888706e-06}}, "connector_pipeline_timer": 0.00019844358169030768}, "agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "env_step_timer": 2.752712785405749e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.141905807132487e-06, "numpy_to_tensor": 1.6461730789722316e-05, "add_states_from_episodes_to_batch": 2.671102676887129e-06, "batch_individual_items": 1.1574206023748224e-05, "add_time_dim_to_batch_and_zero_pad": 4.153011131529603e-06}}, "connector_pipeline_timer": 7.37606248471782e-05}, "sample": 0.00911617112037932, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.4756041660443774e-05, "episode_len_min": 20, "weights_seq_no": 6.0, "num_episodes": 250.0, "time_between_sampling": 0.0030194901211156215, "episode_duration_sec_mean": 0.008467108533252029, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.971591130335737e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 6.820000000000002, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "num_episodes_lifetime": -153875.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -3077500.0, "num_env_steps_sampled_lifetime_throughput": 2310.2666186084716}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001133716206060698, "add_states_from_episodes_to_batch": 4.022837648484648e-06, "add_columns_from_episodes_to_train_batch": 0.06470509207824218, "add_time_dim_to_batch_and_zero_pad": 1.3642587465688028e-05, "add_one_ts_to_episodes_and_truncate": 0.012231607702786453, "add_observations_from_episodes_to_batch": 0.001018791762459923, "batch_individual_items": 0.051403562072514515, "general_advantage_estimation": 0.018246987415563378}}, "connector_pipeline_timer": 0.14795542863618177}, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 803500.9950103572, "num_module_steps_trained_throughput": 153308.54236549855, "num_module_steps_trained_lifetime_throughput": 153203.08056758353}, "default_policy": {"entropy": 0.6315293908119202, "weights_seq_no": 7.0, "total_loss": 0.01327641773968935, "vf_loss": 0.10148672014474869, "vf_loss_unclipped": 28.57539176940918, "gradients_default_optimizer_global_norm": 0.06353103369474411, "vf_explained_var": 0.021754086017608643, "policy_loss": -0.04889311641454697, "curr_kl_coeff": 0.0058320024982094765, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0012224273523315787, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 153087.4190675501}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0019142982368901983, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1893603390023214e-05, "add_states_from_episodes_to_batch": 2.5991111450972846e-06, "numpy_to_tensor": 2.038383529024755e-05, "add_time_dim_to_batch_and_zero_pad": 4.106117815513091e-06, "add_observations_from_episodes_to_batch": 4.661822955368461e-06}}, "connector_pipeline_timer": 8.02329021535916e-05}, "module_episode_returns_mean": {"default_policy": 0.35}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_env_steps_sampled": 400, "episode_return_mean": 0.35, "agent_episode_returns_mean": {"default_agent": 0.35}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.625944743515844e-05, "normalize_and_clip_actions": 1.6505824507997998e-05, "listify_data_for_vector_env": 1.9364609895927567e-05, "tensor_to_numpy": 2.558340340034551e-05, "un_batch_to_individual_items": 9.928602547764344e-06, "remove_single_ts_time_rank_from_batch": 1.0241381059743536e-06}}, "connector_pipeline_timer": 0.00019371878906167297}, "env_step_timer": 2.8270088751191684e-05, "sample": 0.3197108353765791, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 7.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 35400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.00926639132318087, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes_lifetime": 140, "rlmodule_inference_timer": 5.2089625030717025e-05, "time_between_sampling": 3.5424941605191353}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4d499_00000", "date": "2025-08-11_19-30-52", "timestamp": 1754933452, "time_this_iter_s": 2.884031057357788, "time_total_s": 25.54718828201294, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.54718828201294, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 74.85, "ram_util_percent": 79.2}}
{"timers": {"training_iteration": 5.3076696463769135, "restore_env_runners": 3.516073958582677e-05, "training_step": 5.307443867784169, "env_runner_sampling_timer": 5.099160819747386, "learner_update_timer": 0.20413690766238596, "synch_weights": 0.001216144922066571, "restore_eval_env_runners": 1.4515110872817201e-05, "evaluation_iteration": 0.34642422459596656, "synch_eval_env_connectors": 0.0005114961421482575, "synch_env_connectors": 4.694142605632821e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.763688505963724e-07, "get_actions": 8.288370727812108e-05, "tensor_to_numpy": 2.4879210324437157e-05, "normalize_and_clip_actions": 1.6646726869261618e-05, "listify_data_for_vector_env": 1.9854168954599426e-05, "un_batch_to_individual_items": 9.216907859414698e-06}}, "connector_pipeline_timer": 0.00019754104898160523}, "agent_episode_returns_mean": {"default_agent": 7.46}, "env_step_timer": 2.649028412335909e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.155422092282988e-06, "numpy_to_tensor": 1.7096263677124518e-05, "add_states_from_episodes_to_batch": 2.726587887370812e-06, "batch_individual_items": 1.1531091306369048e-05, "add_time_dim_to_batch_and_zero_pad": 3.957044799209278e-06}}, "connector_pipeline_timer": 7.487518801438533e-05}, "sample": 0.009298948926240386, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 7.537775729693505e-05, "episode_len_min": 20, "weights_seq_no": 7.0, "num_episodes": 250.0, "time_between_sampling": 0.0026230109628816705, "episode_duration_sec_mean": 0.00890719466889277, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.574025765001774e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 7.46, "module_episode_returns_mean": {"default_policy": 7.46}, "num_episodes_lifetime": -184750.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -3695000.0, "num_env_steps_sampled_lifetime_throughput": 2308.9797332124685}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011426165438480991, "add_states_from_episodes_to_batch": 4.0180193204399e-06, "add_columns_from_episodes_to_train_batch": 0.0647132249076645, "add_time_dim_to_batch_and_zero_pad": 1.361908096074362e-05, "add_one_ts_to_episodes_and_truncate": 0.012265902045266659, "add_observations_from_episodes_to_batch": 0.0010284892546915387, "batch_individual_items": 0.05128279395153799, "general_advantage_estimation": 0.018148494201797198}}, "connector_pipeline_timer": 0.14778964726964058}, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 827142.3818216302, "num_module_steps_trained_throughput": 157811.20730614822, "num_module_steps_trained_lifetime_throughput": 157706.13997375325}, "default_policy": {"entropy": 0.6054023504257202, "weights_seq_no": 8.0, "total_loss": -0.05461999401450157, "vf_loss": 0.10170264542102814, "vf_loss_unclipped": 28.60869026184082, "gradients_default_optimizer_global_norm": 0.14886373281478882, "vf_explained_var": 0.020945727825164795, "policy_loss": -0.1171649619936943, "curr_kl_coeff": 0.0029160012491047382, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0014844421530142426, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 157575.53069416402}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0018962431743302205, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8436003480937765e-05, "add_states_from_episodes_to_batch": 2.6596946294840772e-06, "numpy_to_tensor": 1.8891944935138172e-05, "add_time_dim_to_batch_and_zero_pad": 3.4113198623112123e-06, "add_observations_from_episodes_to_batch": 4.254279962322663e-06}}, "connector_pipeline_timer": 8.340139904587995e-05}, "module_episode_returns_mean": {"default_policy": 0.95}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_env_steps_sampled": 400, "episode_return_mean": 0.95, "agent_episode_returns_mean": {"default_agent": 0.95}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.514396634040758e-05, "normalize_and_clip_actions": 1.803552853381502e-05, "listify_data_for_vector_env": 2.120792477098176e-05, "tensor_to_numpy": 3.2161716621769134e-05, "un_batch_to_individual_items": 8.516373416177678e-06, "remove_single_ts_time_rank_from_batch": 1.7276819749164513e-05}}, "connector_pipeline_timer": 0.00022841361828778264}, "env_step_timer": 3.460736955323766e-05, "sample": 0.3180933453522284, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 8.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 40400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.008217248785076663, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes_lifetime": 160, "rlmodule_inference_timer": 6.127262554012638e-05, "time_between_sampling": 3.535363805584762}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4d499_00000", "date": "2025-08-11_19-30-55", "timestamp": 1754933455, "time_this_iter_s": 2.9685208797454834, "time_total_s": 28.515709161758423, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.515709161758423, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 73.75, "ram_util_percent": 79.175}}
{"timers": {"training_iteration": 5.282498796573869, "restore_env_runners": 3.488913163497475e-05, "training_step": 5.282270837436399, "env_runner_sampling_timer": 5.073351719459979, "learner_update_timer": 0.20474767483616116, "synch_weights": 0.0012168680529104701, "restore_eval_env_runners": 1.4456620493810218e-05, "evaluation_iteration": 0.34462387401960254, "synch_eval_env_connectors": 0.0005080461805992211, "synch_env_connectors": 4.6951212185001135e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0269445756829691e-06, "get_actions": 8.251218561105342e-05, "tensor_to_numpy": 2.5279319496252506e-05, "normalize_and_clip_actions": 1.528539895806059e-05, "listify_data_for_vector_env": 1.914612273343054e-05, "un_batch_to_individual_items": 8.790633977636162e-06}}, "connector_pipeline_timer": 0.00019383338973911256}, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "env_step_timer": 2.6000626192963115e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.1032109370635595e-06, "numpy_to_tensor": 1.6776764492342474e-05, "add_states_from_episodes_to_batch": 2.6301516292324436e-06, "batch_individual_items": 1.1091707588592877e-05, "add_time_dim_to_batch_and_zero_pad": 4.036550729373881e-06}}, "connector_pipeline_timer": 7.316001319329788e-05}, "sample": 0.008976264008816815, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.438480161652742e-05, "episode_len_min": 20, "weights_seq_no": 8.0, "num_episodes": 250.0, "time_between_sampling": 0.002537884833626794, "episode_duration_sec_mean": 0.008320672508794816, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.376584806461828e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 8.980000000000004, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "num_episodes_lifetime": -215625.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -4312500.0, "num_env_steps_sampled_lifetime_throughput": 2357.0435728431403}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001138357080244267, "add_states_from_episodes_to_batch": 4.011589093186348e-06, "add_columns_from_episodes_to_train_batch": 0.06442762598771148, "add_time_dim_to_batch_and_zero_pad": 1.358497009023335e-05, "add_one_ts_to_episodes_and_truncate": 0.01336992760513821, "add_observations_from_episodes_to_batch": 0.001026784772066329, "batch_individual_items": 0.051258631842366564, "general_advantage_estimation": 0.018059856759542817}}, "connector_pipeline_timer": 0.1484925232975225}, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 841048.7097595138, "num_module_steps_trained_throughput": 160470.4289208162, "num_module_steps_trained_lifetime_throughput": 160361.27570343186}, "default_policy": {"entropy": 0.5701533555984497, "weights_seq_no": 9.0, "total_loss": -0.04069652780890465, "vf_loss": 0.10202646255493164, "vf_loss_unclipped": 28.674518585205078, "gradients_default_optimizer_global_norm": 0.023104187101125717, "vf_explained_var": 0.019284963607788086, "policy_loss": -0.10377395898103714, "curr_kl_coeff": 0.0014580006245523691, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0018121906323358417, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 160229.32170273957}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0018791761528284773, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0435030517793227e-05, "add_states_from_episodes_to_batch": 1.9299186061750164e-06, "numpy_to_tensor": 1.4854633883157056e-05, "add_time_dim_to_batch_and_zero_pad": 3.0892997484056146e-06, "add_observations_from_episodes_to_batch": 3.732859410232287e-06}}, "connector_pipeline_timer": 6.246273568990851e-05}, "module_episode_returns_mean": {"default_policy": 0.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_env_steps_sampled": 400, "episode_return_mean": 0.75, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.7025582460208676e-05, "normalize_and_clip_actions": 1.3677559642402691e-05, "listify_data_for_vector_env": 1.6158336616965774e-05, "tensor_to_numpy": 1.977741018522191e-05, "un_batch_to_individual_items": 7.616262988750827e-06, "remove_single_ts_time_rank_from_batch": 1.0087593336934292e-06}}, "connector_pipeline_timer": 0.00015031808897028454}, "env_step_timer": 2.097072922354206e-05, "sample": 0.316522211478889, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 9.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 45400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.008186028813943267, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes_lifetime": 180, "rlmodule_inference_timer": 3.9220156339615855e-05, "time_between_sampling": 3.528429596688172}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4d499_00000", "date": "2025-08-11_19-30-58", "timestamp": 1754933458, "time_this_iter_s": 2.967628240585327, "time_total_s": 31.48333740234375, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.48333740234375, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 72.7, "ram_util_percent": 79.275}}
{"timers": {"training_iteration": 5.258292525267387, "restore_env_runners": 3.460523964941386e-05, "training_step": 5.258063520311803, "env_runner_sampling_timer": 5.048811652685775, "learner_update_timer": 0.20505227433746234, "synch_weights": 0.0012121827017724724, "restore_eval_env_runners": 1.4404974670447937e-05, "evaluation_iteration": 0.34288048444936675, "synch_eval_env_connectors": 0.000506463219231472, "synch_env_connectors": 4.685249450470209e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1005836465576247e-06, "get_actions": 8.505648749573441e-05, "tensor_to_numpy": 2.5507808319454033e-05, "normalize_and_clip_actions": 1.643255049139327e-05, "listify_data_for_vector_env": 2.0532506461222637e-05, "un_batch_to_individual_items": 9.956735928146377e-06}}, "connector_pipeline_timer": 0.00020269067715220237}, "agent_episode_returns_mean": {"default_agent": 8.260000000000002}, "env_step_timer": 2.7451867487183604e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.3354462778751145e-06, "numpy_to_tensor": 1.7208757289710167e-05, "add_states_from_episodes_to_batch": 2.6872134034929362e-06, "batch_individual_items": 1.18393787428753e-05, "add_time_dim_to_batch_and_zero_pad": 4.122290989406121e-06}}, "connector_pipeline_timer": 7.542170771627276e-05}, "sample": 0.009066076786865974, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.758458877098994e-05, "episode_len_min": 20, "weights_seq_no": 9.0, "num_episodes": 250.0, "time_between_sampling": 0.002973391184758381, "episode_duration_sec_mean": 0.008680921988561751, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.59379256058782e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 8.260000000000002, "module_episode_returns_mean": {"default_policy": 8.260000000000002}, "num_episodes_lifetime": -246500.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -4930000.0, "num_env_steps_sampled_lifetime_throughput": 2267.376097480733}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011337193116804078, "add_states_from_episodes_to_batch": 4.00189369000108e-06, "add_columns_from_episodes_to_train_batch": 0.06426179222771411, "add_time_dim_to_batch_and_zero_pad": 1.3568699879605206e-05, "add_one_ts_to_episodes_and_truncate": 0.013338766249552521, "add_observations_from_episodes_to_batch": 0.0010280990043876556, "batch_individual_items": 0.05226527885456149, "general_advantage_estimation": 0.01794009069240515}}, "connector_pipeline_timer": 0.14918234015483023}, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 866540.1628053979, "num_module_steps_trained_throughput": 165334.88130154516, "num_module_steps_trained_lifetime_throughput": 165221.15179930715}, "default_policy": {"entropy": 0.5392490029335022, "weights_seq_no": 10.0, "total_loss": -0.06608772277832031, "vf_loss": 0.10191888362169266, "vf_loss_unclipped": 28.66448402404785, "gradients_default_optimizer_global_norm": 0.07620148360729218, "vf_explained_var": 0.019550085067749023, "policy_loss": -0.12937036156654358, "curr_kl_coeff": 0.0007290003122761846, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0017268538940697908, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 165086.87349146177}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00186118231122922, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.281448947730165e-06, "add_states_from_episodes_to_batch": 1.9739717012202195e-06, "numpy_to_tensor": 1.250722912540579e-05, "add_time_dim_to_batch_and_zero_pad": 2.9686262907027876e-06, "add_observations_from_episodes_to_batch": 3.648296411514389e-06}}, "connector_pipeline_timer": 5.6296383079963155e-05}, "module_episode_returns_mean": {"default_policy": 0.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_env_steps_sampled": 400, "episode_return_mean": 0.75, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.5937082300353635e-05, "normalize_and_clip_actions": 1.290756280766689e-05, "listify_data_for_vector_env": 1.4405348687688083e-05, "tensor_to_numpy": 1.8803656120930068e-05, "un_batch_to_individual_items": 7.103603676871306e-06, "remove_single_ts_time_rank_from_batch": 7.16433388688785e-07}}, "connector_pipeline_timer": 0.0001429139547073139}, "env_step_timer": 2.0374324091346304e-05, "sample": 0.3154128472744091, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 10.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 50400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.007889839223353193, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes_lifetime": 200, "rlmodule_inference_timer": 3.972750582751312e-05, "time_between_sampling": 3.5220548873916333}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-01", "timestamp": 1754933461, "time_this_iter_s": 3.082953929901123, "time_total_s": 34.56629133224487, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.56629133224487, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 74.91999999999999, "ram_util_percent": 79.42}}
{"timers": {"training_iteration": 5.232244665425139, "restore_env_runners": 3.432085710550432e-05, "training_step": 5.232015668029089, "env_runner_sampling_timer": 5.023430849909695, "learner_update_timer": 0.20438910951426312, "synch_weights": 0.0012077237840929984, "restore_eval_env_runners": 1.4403424262578935e-05, "evaluation_iteration": 0.34161198377381086, "synch_eval_env_connectors": 0.000504408586675718, "synch_env_connectors": 4.6788163557038184e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0902952263194301e-06, "get_actions": 8.192551602100919e-05, "tensor_to_numpy": 2.413216867247684e-05, "normalize_and_clip_actions": 1.5995332800501094e-05, "listify_data_for_vector_env": 1.913308030782166e-05, "un_batch_to_individual_items": 8.940087115939827e-06}}, "connector_pipeline_timer": 0.00019376326166483719}, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "env_step_timer": 2.5761621162962585e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.308399560431037e-06, "numpy_to_tensor": 1.6699400051315117e-05, "add_states_from_episodes_to_batch": 2.6027242787044246e-06, "batch_individual_items": 1.112285964628151e-05, "add_time_dim_to_batch_and_zero_pad": 4.020857596629472e-06}}, "connector_pipeline_timer": 7.300369717938523e-05}, "sample": 0.00908827981281719, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.5272776596507284e-05, "episode_len_min": 20, "weights_seq_no": 10.0, "num_episodes": 250.0, "time_between_sampling": 0.0031194244441748436, "episode_duration_sec_mean": 0.00833334120828658, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.93230453245464e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 8.980000000000004, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "num_episodes_lifetime": -277375.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -5547500.0, "num_env_steps_sampled_lifetime_throughput": 2309.0293295716124}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011293155124517792, "add_states_from_episodes_to_batch": 3.99812415601154e-06, "add_columns_from_episodes_to_train_batch": 0.06411447930624133, "add_time_dim_to_batch_and_zero_pad": 1.3558423614553657e-05, "add_one_ts_to_episodes_and_truncate": 0.013369569837280661, "add_observations_from_episodes_to_batch": 0.0010340909345276164, "batch_individual_items": 0.05217665981564096, "general_advantage_estimation": 0.017831079784790652}}, "connector_pipeline_timer": 0.14887290258302494}, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 892433.4513541876, "num_module_steps_trained_throughput": 170271.32771678205, "num_module_steps_trained_lifetime_throughput": 170154.8040298124}, "default_policy": {"entropy": 0.5055301785469055, "weights_seq_no": 11.0, "total_loss": 0.05192509666085243, "vf_loss": 0.10181104391813278, "vf_loss_unclipped": 28.64272689819336, "gradients_default_optimizer_global_norm": 0.041982702910900116, "vf_explained_var": 0.019914567470550537, "policy_loss": -0.011589430272579193, "curr_kl_coeff": 0.0003645001561380923, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0015682962257415056, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 170014.50252648737}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0018433854885019738, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.5223982127951082e-05, "add_states_from_episodes_to_batch": 3.6406560349683167e-06, "numpy_to_tensor": 2.3842247840601462e-05, "add_time_dim_to_batch_and_zero_pad": 4.5774128234879766e-06, "add_observations_from_episodes_to_batch": 5.56942227026564e-06}}, "connector_pipeline_timer": 9.41527122189395e-05}, "module_episode_returns_mean": {"default_policy": 0.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_env_steps_sampled": 400, "episode_return_mean": 0.75, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.881130785374155e-05, "normalize_and_clip_actions": 1.9225015381448444e-05, "listify_data_for_vector_env": 2.7049820961046704e-05, "tensor_to_numpy": 2.9561692173293952e-05, "un_batch_to_individual_items": 9.0025496335071e-06, "remove_single_ts_time_rank_from_batch": 1.1136550385102035e-06}}, "connector_pipeline_timer": 0.0002364589556018396}, "env_step_timer": 3.145189928746036e-05, "sample": 0.3138749717127093, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 11.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 55400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.0078039900690782815, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes_lifetime": 220, "rlmodule_inference_timer": 6.052069062159085e-05, "time_between_sampling": 3.5136105681078944}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-04", "timestamp": 1754933464, "time_this_iter_s": 2.8281302452087402, "time_total_s": 37.39442157745361, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.39442157745361, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 71.925, "ram_util_percent": 79.175}}
{"timers": {"training_iteration": 5.207491750441193, "restore_env_runners": 3.404847794455521e-05, "training_step": 5.207262711348264, "env_runner_sampling_timer": 4.99949923850103, "learner_update_timer": 0.2035756342583567, "synch_weights": 0.0012026252967137809, "restore_eval_env_runners": 1.4337299809932604e-05, "evaluation_iteration": 0.33991384351577103, "synch_eval_env_connectors": 0.0005005457507813937, "synch_env_connectors": 4.677867889269354e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.58183025343792e-07, "get_actions": 8.000812857626313e-05, "tensor_to_numpy": 2.3591128027144345e-05, "normalize_and_clip_actions": 1.5400629946805655e-05, "listify_data_for_vector_env": 1.8886835554403328e-05, "un_batch_to_individual_items": 8.880271812061341e-06}}, "connector_pipeline_timer": 0.00019044463086681604}, "agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "env_step_timer": 2.623453915856621e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.2727518842071445e-06, "numpy_to_tensor": 1.6052363360729053e-05, "add_states_from_episodes_to_batch": 2.4767075063654645e-06, "batch_individual_items": 1.0769742511826348e-05, "add_time_dim_to_batch_and_zero_pad": 3.825097041260007e-06}}, "connector_pipeline_timer": 7.110385889485595e-05}, "sample": 0.008769683872108363, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.3277302189553415e-05, "episode_len_min": 20, "weights_seq_no": 11.0, "num_episodes": 250.0, "time_between_sampling": 0.0030214861186265043, "episode_duration_sec_mean": 0.008202869000844657, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.783913178363463e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 9.700000000000003, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "num_episodes_lifetime": -308250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -6165000.0, "num_env_steps_sampled_lifetime_throughput": 2385.1378805540994}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011297348562901404, "add_states_from_episodes_to_batch": 3.992313139714066e-06, "add_columns_from_episodes_to_train_batch": 0.06394915742384537, "add_time_dim_to_batch_and_zero_pad": 1.3549928821093367e-05, "add_one_ts_to_episodes_and_truncate": 0.01333641163901924, "add_observations_from_episodes_to_batch": 0.001033788354237873, "batch_individual_items": 0.052065512387191024, "general_advantage_estimation": 0.017716071906677015}}, "connector_pipeline_timer": 0.14844710022703259}, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 925581.5190673587, "num_module_steps_trained_throughput": 176610.0528246866, "num_module_steps_trained_lifetime_throughput": 176475.52879326613}, "default_policy": {"entropy": 0.4821460247039795, "weights_seq_no": 12.0, "total_loss": 0.03486289083957672, "vf_loss": 0.1020260602235794, "vf_loss_unclipped": 28.63893699645996, "gradients_default_optimizer_global_norm": 0.05857674777507782, "vf_explained_var": 0.01924508810043335, "policy_loss": -0.02900618687272072, "curr_kl_coeff": 0.00018225007806904614, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.00028911055414937437, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 176359.36527554403}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00182571122380127, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2460617053822895e-05, "add_states_from_episodes_to_batch": 2.627124071089683e-06, "numpy_to_tensor": 1.797315450472825e-05, "add_time_dim_to_batch_and_zero_pad": 4.197978563106547e-06, "add_observations_from_episodes_to_batch": 5.416299460017724e-06}}, "connector_pipeline_timer": 7.8417281854447e-05}, "module_episode_returns_mean": {"default_policy": 0.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_env_steps_sampled": 400, "episode_return_mean": 0.55, "agent_episode_returns_mean": {"default_agent": 0.55}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.831826948070657e-05, "normalize_and_clip_actions": 1.688988750914531e-05, "listify_data_for_vector_env": 2.0058654418691695e-05, "tensor_to_numpy": 2.4748365301467916e-05, "un_batch_to_individual_items": 8.916427294582139e-06, "remove_single_ts_time_rank_from_batch": 9.217572578053426e-07}}, "connector_pipeline_timer": 0.00019384996192865094}, "env_step_timer": 2.976487872888053e-05, "sample": 0.3126215399146596, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 12.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 60400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.008033605891978369, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes_lifetime": 240, "rlmodule_inference_timer": 5.510743739599981e-05, "time_between_sampling": 3.5063484215967713}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-07", "timestamp": 1754933467, "time_this_iter_s": 2.9541938304901123, "time_total_s": 40.348615407943726, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.348615407943726, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 73.75, "ram_util_percent": 79.6}}
{"timers": {"training_iteration": 5.183631496685876, "restore_env_runners": 3.37696525403153e-05, "training_step": 5.183401692153856, "env_runner_sampling_timer": 4.975957126946057, "learner_update_timer": 0.20324947916625027, "synch_weights": 0.0011981365435153027, "restore_eval_env_runners": 1.4263927344847814e-05, "evaluation_iteration": 0.3384634180016162, "synch_eval_env_connectors": 0.0004965332135232803, "synch_env_connectors": 4.708179436490457e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.755985158150478e-07, "get_actions": 8.205622025353309e-05, "tensor_to_numpy": 2.358220850770131e-05, "normalize_and_clip_actions": 1.80547607398917e-05, "listify_data_for_vector_env": 1.9971682195438075e-05, "un_batch_to_individual_items": 8.524846574652956e-06}}, "connector_pipeline_timer": 0.0001956742032820049}, "agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "env_step_timer": 2.6782028860366498e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.967680613947133e-06, "numpy_to_tensor": 1.6452984197552914e-05, "add_states_from_episodes_to_batch": 2.5626304935033013e-06, "batch_individual_items": 1.0844839847104984e-05, "add_time_dim_to_batch_and_zero_pad": 4.711369174297733e-06}}, "connector_pipeline_timer": 7.306360101934112e-05}, "sample": 0.008965637817464983, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.320338547345828e-05, "episode_len_min": 20, "weights_seq_no": 12.0, "num_episodes": 250.0, "time_between_sampling": 0.0028796063392352786, "episode_duration_sec_mean": 0.008251843329053373, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.40999558236799e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 9.700000000000003, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "num_episodes_lifetime": -339125.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -6782500.0, "num_env_steps_sampled_lifetime_throughput": 2371.913773198271}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011258917088406717, "add_states_from_episodes_to_batch": 4.0553104660376815e-06, "add_columns_from_episodes_to_train_batch": 0.0640708658494404, "add_time_dim_to_batch_and_zero_pad": 1.3604839597415786e-05, "add_one_ts_to_episodes_and_truncate": 0.013408410022320592, "add_observations_from_episodes_to_batch": 0.0010425417196734236, "batch_individual_items": 0.05197475018281109, "general_advantage_estimation": 0.0176005699376656}}, "connector_pipeline_timer": 0.1484431617240253}, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 954067.0182120929, "num_module_steps_trained_throughput": 182047.84605768335, "num_module_steps_trained_lifetime_throughput": 181902.36666560845}, "default_policy": {"entropy": 0.45641592144966125, "weights_seq_no": 13.0, "total_loss": 0.03346370533108711, "vf_loss": 0.10202598571777344, "vf_loss_unclipped": 28.627490997314453, "gradients_default_optimizer_global_norm": 0.049361228942871094, "vf_explained_var": 0.019546985626220703, "policy_loss": -0.030638419091701508, "curr_kl_coeff": 9.112503903452307e-05, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0008334144367836416, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 181798.39829815686}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0018082945219205985, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3096487330426494e-05, "add_states_from_episodes_to_batch": 2.6422544308458363e-06, "numpy_to_tensor": 1.7219305938018218e-05, "add_time_dim_to_batch_and_zero_pad": 4.576435624791019e-06, "add_observations_from_episodes_to_batch": 5.138316925086558e-06}}, "connector_pipeline_timer": 7.778420347529901e-05}, "module_episode_returns_mean": {"default_policy": 0.95}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_env_steps_sampled": 400, "episode_return_mean": 0.95, "agent_episode_returns_mean": {"default_agent": 0.95}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.439410612485892e-05, "normalize_and_clip_actions": 1.6058255142956805e-05, "listify_data_for_vector_env": 2.0851890638531324e-05, "tensor_to_numpy": 2.3321190607320918e-05, "un_batch_to_individual_items": 8.198141191663638e-06, "remove_single_ts_time_rank_from_batch": 8.589906348515094e-07}}, "connector_pipeline_timer": 0.00018449942807630498}, "env_step_timer": 2.6182105119641918e-05, "sample": 0.3111398753463373, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 13.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 65400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.00809137505129911, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes_lifetime": 260, "rlmodule_inference_timer": 4.8515798999074306e-05, "time_between_sampling": 3.499797079051602}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-10", "timestamp": 1754933470, "time_this_iter_s": 2.9996089935302734, "time_total_s": 43.348224401474, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.348224401474, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 76.525, "ram_util_percent": 79.125}}
{"timers": {"training_iteration": 5.15942977005815, "restore_env_runners": 3.3497786551098844e-05, "training_step": 5.159198494812835, "env_runner_sampling_timer": 4.95123608317718, "learner_update_timer": 0.2037342731243925, "synch_weights": 0.0011972718471277737, "restore_eval_env_runners": 1.4208788155590897e-05, "evaluation_iteration": 0.33679059382114235, "synch_eval_env_connectors": 0.0004940674615385176, "synch_env_connectors": 4.704427424909537e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0486263825046425e-06, "get_actions": 8.165812386419342e-05, "tensor_to_numpy": 2.3647950670514582e-05, "normalize_and_clip_actions": 1.621068584664994e-05, "listify_data_for_vector_env": 1.9397355923149535e-05, "un_batch_to_individual_items": 9.026768614862762e-06}}, "connector_pipeline_timer": 0.00019327103361196826}, "agent_episode_returns_mean": {"default_agent": 10.42}, "env_step_timer": 2.565648914054443e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.2694542753256075e-06, "numpy_to_tensor": 1.643027908659949e-05, "add_states_from_episodes_to_batch": 2.880204711747618e-06, "batch_individual_items": 1.1139965615812891e-05, "add_time_dim_to_batch_and_zero_pad": 4.225528579575288e-06}}, "connector_pipeline_timer": 7.284087872010977e-05}, "sample": 0.008759884467999109, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.414653789699125e-05, "episode_len_min": 20, "weights_seq_no": 13.0, "num_episodes": 250.0, "time_between_sampling": 0.0029145697888474198, "episode_duration_sec_mean": 0.008258775003254417, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.680187808175273e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 10.42, "module_episode_returns_mean": {"default_policy": 10.42}, "num_episodes_lifetime": -370000.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -7400000.0, "num_env_steps_sampled_lifetime_throughput": 2345.70338719271}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011213077901921133, "add_states_from_episodes_to_batch": 4.05808714416129e-06, "add_columns_from_episodes_to_train_batch": 0.06390140261157702, "add_time_dim_to_batch_and_zero_pad": 1.3581290311842304e-05, "add_one_ts_to_episodes_and_truncate": 0.013380155922345193, "add_observations_from_episodes_to_batch": 0.0010418425523223878, "batch_individual_items": 0.052987924760769634, "general_advantage_estimation": 0.017476974238059988}}, "connector_pipeline_timer": 0.14913320927772025}, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 972290.843291468, "num_module_steps_trained_throughput": 185530.3676711443, "num_module_steps_trained_lifetime_throughput": 185374.9492738966}, "default_policy": {"entropy": 0.42842739820480347, "weights_seq_no": 14.0, "total_loss": -0.04048038646578789, "vf_loss": 0.10234943777322769, "vf_loss_unclipped": 28.65528678894043, "gradients_default_optimizer_global_norm": 0.06715603172779083, "vf_explained_var": 0.01694488525390625, "policy_loss": -0.10505218803882599, "curr_kl_coeff": 4.5562519517261535e-05, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0003316231013741344, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 185292.30326897584}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0017938719968900727, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.732918485388169e-06, "add_states_from_episodes_to_batch": 2.1097631105789203e-06, "numpy_to_tensor": 1.3365102338250506e-05, "add_time_dim_to_batch_and_zero_pad": 3.212255966697511e-06, "add_observations_from_episodes_to_batch": 4.001819146306673e-06}}, "connector_pipeline_timer": 6.196279208536593e-05}, "module_episode_returns_mean": {"default_policy": 1.35}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_env_steps_sampled": 400, "episode_return_mean": 1.35, "agent_episode_returns_mean": {"default_agent": 1.35}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.530404157143756e-05, "normalize_and_clip_actions": 1.4016874353349247e-05, "listify_data_for_vector_env": 2.0082987565788747e-05, "tensor_to_numpy": 2.0669009694770575e-05, "un_batch_to_individual_items": 7.68643826526355e-06, "remove_single_ts_time_rank_from_batch": 8.402538012754386e-07}}, "connector_pipeline_timer": 0.00016620387245776816}, "env_step_timer": 2.278824675654903e-05, "sample": 0.30986540784316485, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 14.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 70400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.008292442922247574, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes_lifetime": 280, "rlmodule_inference_timer": 4.301285654648924e-05, "time_between_sampling": 3.4927421007611157}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-13", "timestamp": 1754933473, "time_this_iter_s": 2.964754104614258, "time_total_s": 46.31297850608826, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.31297850608826, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 72.25, "ram_util_percent": 78.75}}
{"timers": {"training_iteration": 5.137560074437519, "restore_env_runners": 3.32265588799735e-05, "training_step": 5.137327934444327, "env_runner_sampling_timer": 4.927896809005391, "learner_update_timer": 0.20519382372316008, "synch_weights": 0.001203379958997701, "restore_eval_env_runners": 1.4207950476467263e-05, "evaluation_iteration": 0.33536017413288444, "synch_eval_env_connectors": 0.0004921888672822189, "synch_env_connectors": 4.6986325916433795e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0083839987539459e-06, "get_actions": 8.605516768536129e-05, "tensor_to_numpy": 2.4976455735069494e-05, "normalize_and_clip_actions": 1.6326297716614425e-05, "listify_data_for_vector_env": 2.021530337638603e-05, "un_batch_to_individual_items": 8.952802141329877e-06}}, "connector_pipeline_timer": 0.0002017713261784032}, "agent_episode_returns_mean": {"default_agent": 10.18}, "env_step_timer": 2.7587332139260934e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.33874650783386e-06, "numpy_to_tensor": 1.7732993043946064e-05, "add_states_from_episodes_to_batch": 2.8981493293285653e-06, "batch_individual_items": 1.1850743006035942e-05, "add_time_dim_to_batch_and_zero_pad": 3.948090671088194e-06}}, "connector_pipeline_timer": 7.654012123647078e-05}, "sample": 0.008880001384773465, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.670998073087806e-05, "episode_len_min": 20, "weights_seq_no": 14.0, "num_episodes": 250.0, "time_between_sampling": 0.0030903614574423264, "episode_duration_sec_mean": 0.008763581953477114, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.753119081928325e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 10.18, "module_episode_returns_mean": {"default_policy": 10.18}, "num_episodes_lifetime": -400875.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -8017500.0, "num_env_steps_sampled_lifetime_throughput": 2291.2874366100386}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001126303008000577, "add_states_from_episodes_to_batch": 4.055007140339787e-06, "add_columns_from_episodes_to_train_batch": 0.06372555150566618, "add_time_dim_to_batch_and_zero_pad": 1.3570058101223757e-05, "add_one_ts_to_episodes_and_truncate": 0.013340233112879745, "add_observations_from_episodes_to_batch": 0.001040509547551108, "batch_individual_items": 0.05492808551320575, "general_advantage_estimation": 0.01741635115529577}}, "connector_pipeline_timer": 0.15079550468581238}, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 991908.3350206055, "num_module_steps_trained_throughput": 189272.3540165428, "num_module_steps_trained_lifetime_throughput": 189110.36109802368}, "default_policy": {"entropy": 0.4188220798969269, "weights_seq_no": 15.0, "total_loss": 0.0381966270506382, "vf_loss": 0.10213375091552734, "vf_loss_unclipped": 28.625947952270508, "gradients_default_optimizer_global_norm": 0.008220300078392029, "vf_explained_var": 0.019069373607635498, "policy_loss": -0.02631792053580284, "curr_kl_coeff": 2.2781259758630767e-05, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.00024917605333030224, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 189039.83552802564}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0017786166163288395, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1921974457810569e-05, "add_states_from_episodes_to_batch": 2.9282586655434905e-06, "numpy_to_tensor": 1.7230303752168518e-05, "add_time_dim_to_batch_and_zero_pad": 3.5135765971264877e-06, "add_observations_from_episodes_to_batch": 5.075476449094787e-06}}, "connector_pipeline_timer": 7.340123111764936e-05}, "module_episode_returns_mean": {"default_policy": 1.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_env_steps_sampled": 400, "episode_return_mean": 1.75, "agent_episode_returns_mean": {"default_agent": 1.75}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.418932137187402e-05, "normalize_and_clip_actions": 1.594714114949038e-05, "listify_data_for_vector_env": 1.9892353162848174e-05, "tensor_to_numpy": 2.3306773498878724e-05, "un_batch_to_individual_items": 9.098004336509621e-06, "remove_single_ts_time_rank_from_batch": 1.0805519730562532e-06}}, "connector_pipeline_timer": 0.00018606088032153663}, "env_step_timer": 2.6893443656542315e-05, "sample": 0.30849551043464196, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 15.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 75400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.008006775004323572, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes_lifetime": 300, "rlmodule_inference_timer": 5.0748749404356166e-05, "time_between_sampling": 3.4878094672539772}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-16", "timestamp": 1754933476, "time_this_iter_s": 3.158594846725464, "time_total_s": 49.47157335281372, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.47157335281372, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 75.53999999999999, "ram_util_percent": 78.96}}
{"timers": {"training_iteration": 5.114800340363296, "restore_env_runners": 3.2965123865432926e-05, "training_step": 5.11456827093916, "env_runner_sampling_timer": 4.905678224664532, "learner_update_timer": 0.20464841798526234, "synch_weights": 0.0011988449103365133, "restore_eval_env_runners": 1.4147951922663108e-05, "evaluation_iteration": 0.33383337656124207, "synch_eval_env_connectors": 0.0004884148883978115, "synch_env_connectors": 4.7049761246558644e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1313169103620276e-06, "get_actions": 8.882422663424742e-05, "tensor_to_numpy": 2.692307500029155e-05, "normalize_and_clip_actions": 1.735349346127381e-05, "listify_data_for_vector_env": 2.1382054920421082e-05, "un_batch_to_individual_items": 9.602096387374486e-06}}, "connector_pipeline_timer": 0.00021086059634337211}, "agent_episode_returns_mean": {"default_agent": 11.059999999999997}, "env_step_timer": 2.9014498199621155e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.4170210218673235e-06, "numpy_to_tensor": 1.928343021767227e-05, "add_states_from_episodes_to_batch": 2.7751464408095884e-06, "batch_individual_items": 1.2231598331269266e-05, "add_time_dim_to_batch_and_zero_pad": 4.138492453539427e-06}}, "connector_pipeline_timer": 7.980268528929075e-05}, "sample": 0.009796490907238883, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 6.158515019467166e-05, "episode_len_min": 20, "weights_seq_no": 15.0, "num_episodes": 250.0, "time_between_sampling": 0.003386320362837529, "episode_duration_sec_mean": 0.00904484400851652, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 8.484546034364331e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 11.059999999999997, "module_episode_returns_mean": {"default_policy": 11.059999999999997}, "num_episodes_lifetime": -431750.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -8635000.0, "num_env_steps_sampled_lifetime_throughput": 2141.3447797999297}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011371315780331882, "add_states_from_episodes_to_batch": 4.056117456005376e-06, "add_columns_from_episodes_to_train_batch": 0.06350975432084775, "add_time_dim_to_batch_and_zero_pad": 1.3569777643326701e-05, "add_one_ts_to_episodes_and_truncate": 0.013311638691561864, "add_observations_from_episodes_to_batch": 0.001045177372435268, "batch_individual_items": 0.05481546799815236, "general_advantage_estimation": 0.017371291803748037}}, "connector_pipeline_timer": 0.1503993921387673}, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1002756.5466430256, "num_module_steps_trained_throughput": 191338.75587547303, "num_module_steps_trained_lifetime_throughput": 191172.0472568595}, "default_policy": {"entropy": 0.4002242386341095, "weights_seq_no": 16.0, "total_loss": -0.02420705370604992, "vf_loss": 0.10245729237794876, "vf_loss_unclipped": 28.66145133972168, "gradients_default_optimizer_global_norm": 0.06402754038572311, "vf_explained_var": 0.015397906303405762, "policy_loss": -0.08910641074180603, "curr_kl_coeff": 1.1390629879315384e-05, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 6.365888111758977e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 191112.0262194527}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0017632171202595346, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.567083660568993e-06, "add_states_from_episodes_to_batch": 1.9742489196920456e-06, "numpy_to_tensor": 1.1871282474602076e-05, "add_time_dim_to_batch_and_zero_pad": 2.701990053351265e-06, "add_observations_from_episodes_to_batch": 3.492036712692858e-06}}, "connector_pipeline_timer": 5.493712643394292e-05}, "module_episode_returns_mean": {"default_policy": 1.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_env_steps_sampled": 400, "episode_return_mean": 1.55, "agent_episode_returns_mean": {"default_agent": 1.55}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.3165742707364756e-05, "normalize_and_clip_actions": 1.1925966416756691e-05, "listify_data_for_vector_env": 1.4269567708089787e-05, "tensor_to_numpy": 1.731533065807404e-05, "un_batch_to_individual_items": 6.6853088471880775e-06, "remove_single_ts_time_rank_from_batch": 6.573231416179159e-07}}, "connector_pipeline_timer": 0.0001364038890867286}, "env_step_timer": 1.948440935181411e-05, "sample": 0.30716922365986227, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 16.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 80400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.008139385401736945, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes_lifetime": 320, "rlmodule_inference_timer": 3.665021548406139e-05, "time_between_sampling": 3.4819490984116364}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-19", "timestamp": 1754933479, "time_this_iter_s": 3.048222303390503, "time_total_s": 52.519795656204224, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.519795656204224, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 80.175, "ram_util_percent": 79.42500000000001}}
{"timers": {"training_iteration": 5.098647558209654, "restore_env_runners": 3.2693392741847155e-05, "training_step": 5.098415862390429, "env_runner_sampling_timer": 4.890473028667544, "learner_update_timer": 0.20370935880592828, "synch_weights": 0.0011935743820021543, "restore_eval_env_runners": 1.4150631824761208e-05, "evaluation_iteration": 0.3323207265458418, "synch_eval_env_connectors": 0.0004865719896793853, "synch_env_connectors": 4.698346927300836e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2262087108236784e-06, "get_actions": 0.00011250242791121087, "tensor_to_numpy": 2.9217701280666853e-05, "normalize_and_clip_actions": 2.015405558542393e-05, "listify_data_for_vector_env": 2.3792762512891412e-05, "un_batch_to_individual_items": 1.1354039735692652e-05}}, "connector_pipeline_timer": 0.00025141404582928014}, "agent_episode_returns_mean": {"default_agent": 10.5}, "env_step_timer": 3.6966708303841535e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.431721523591532e-06, "numpy_to_tensor": 2.1820477101496485e-05, "add_states_from_episodes_to_batch": 2.804846255207794e-06, "batch_individual_items": 1.4059765555468643e-05, "add_time_dim_to_batch_and_zero_pad": 5.314252273462024e-06}}, "connector_pipeline_timer": 9.138778796460852e-05}, "sample": 0.011650900454985931, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 9.873440349377967e-05, "episode_len_min": 20, "weights_seq_no": 16.0, "num_episodes": 250.0, "time_between_sampling": 0.002759310936298141, "episode_duration_sec_mean": 0.011459744201041759, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 9.308470018811314e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 10.5, "module_episode_returns_mean": {"default_policy": 10.5}, "num_episodes_lifetime": -462625.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -9252500.0, "num_env_steps_sampled_lifetime_throughput": 2000.4169000455631}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011330810630490075, "add_states_from_episodes_to_batch": 4.057225981740055e-06, "add_columns_from_episodes_to_train_batch": 0.06327559927762147, "add_time_dim_to_batch_and_zero_pad": 1.3564499951936149e-05, "add_one_ts_to_episodes_and_truncate": 0.013264121884261765, "add_observations_from_episodes_to_batch": 0.0010482114278239666, "batch_individual_items": 0.05462994373830244, "general_advantage_estimation": 0.017268201805303564}}, "connector_pipeline_timer": 0.14983088571660738}, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1021464.9036938001, "num_module_steps_trained_throughput": 194899.961911662, "num_module_steps_trained_lifetime_throughput": 194730.25552549565}, "default_policy": {"entropy": 0.3960508704185486, "weights_seq_no": 17.0, "total_loss": -0.03301073610782623, "vf_loss": 0.10234946012496948, "vf_loss_unclipped": 28.645084381103516, "gradients_default_optimizer_global_norm": 0.12811815738677979, "vf_explained_var": 0.01704394817352295, "policy_loss": -0.09787576645612717, "curr_kl_coeff": 5.695314939657692e-06, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.00011660082236630842, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 194671.85325675967}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.001747419949059696, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2737192986250373e-05, "add_states_from_episodes_to_batch": 2.5166168364087364e-06, "numpy_to_tensor": 1.711497493519231e-05, "add_time_dim_to_batch_and_zero_pad": 3.7696779417965286e-06, "add_observations_from_episodes_to_batch": 4.285293604406621e-06}}, "connector_pipeline_timer": 7.623088764671882e-05}, "module_episode_returns_mean": {"default_policy": 1.95}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_env_steps_sampled": 400, "episode_return_mean": 1.95, "agent_episode_returns_mean": {"default_agent": 1.95}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.261784476772206e-05, "normalize_and_clip_actions": 1.7960811509310668e-05, "listify_data_for_vector_env": 1.995818576130025e-05, "tensor_to_numpy": 2.382239131726933e-05, "un_batch_to_individual_items": 9.125583909738638e-06, "remove_single_ts_time_rank_from_batch": 9.20506384175534e-07}}, "connector_pipeline_timer": 0.0001869405082637107}, "env_step_timer": 2.878607415947508e-05, "sample": 0.30629576725355573, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 17.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 85400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.008408102478133514, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes_lifetime": 340, "rlmodule_inference_timer": 5.431029563537875e-05, "time_between_sampling": 3.4823271057672143}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-23", "timestamp": 1754933483, "time_this_iter_s": 3.7284669876098633, "time_total_s": 56.24826264381409, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.24826264381409, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 80.71666666666665, "ram_util_percent": 81.78333333333333}}
{"timers": {"training_iteration": 5.075955748038207, "restore_env_runners": 3.2487288605259295e-05, "training_step": 5.075723208766614, "env_runner_sampling_timer": 4.867243961721239, "learner_update_timer": 0.20425364396790638, "synch_weights": 0.001187344057644307, "restore_eval_env_runners": 1.4072875700899244e-05, "evaluation_iteration": 0.33126262678051743, "synch_eval_env_connectors": 0.00048273917985949274, "synch_env_connectors": 4.711363914897429e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.93703187533501e-07, "get_actions": 8.489281208556307e-05, "tensor_to_numpy": 2.5142606114575096e-05, "normalize_and_clip_actions": 1.6080238196222022e-05, "listify_data_for_vector_env": 2.0538140440938283e-05, "un_batch_to_individual_items": 9.171577531968727e-06}}, "connector_pipeline_timer": 0.00020001964724892084}, "agent_episode_returns_mean": {"default_agent": 10.980000000000002}, "env_step_timer": 2.7156915471818573e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.205402015922069e-06, "numpy_to_tensor": 1.77405777806049e-05, "add_states_from_episodes_to_batch": 2.7050121965347947e-06, "batch_individual_items": 1.168939032381552e-05, "add_time_dim_to_batch_and_zero_pad": 4.108219940765864e-06}}, "connector_pipeline_timer": 7.62378329059652e-05}, "sample": 0.009800639449579436, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.694118319133993e-05, "episode_len_min": 20, "weights_seq_no": 17.0, "num_episodes": 250.0, "time_between_sampling": 0.002596270605601963, "episode_duration_sec_mean": 0.008637106508016586, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 8.229584052663925e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 10.980000000000002, "module_episode_returns_mean": {"default_policy": 10.980000000000002}, "num_episodes_lifetime": -493500.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -9870000.0, "num_env_steps_sampled_lifetime_throughput": 2277.3066057979863}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011298502558882528, "add_states_from_episodes_to_batch": 4.050403687873502e-06, "add_columns_from_episodes_to_train_batch": 0.06307433453548317, "add_time_dim_to_batch_and_zero_pad": 1.3543025786838899e-05, "add_one_ts_to_episodes_and_truncate": 0.013220984834719346, "add_observations_from_episodes_to_batch": 0.001047285143001803, "batch_individual_items": 0.055830934300540404, "general_advantage_estimation": 0.017167982286625052}}, "connector_pipeline_timer": 0.1506854818593028}, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1042615.429668873, "num_module_steps_trained_throughput": 198925.6431317552, "num_module_steps_trained_lifetime_throughput": 198753.68260000876}, "default_policy": {"entropy": 0.36843931674957275, "weights_seq_no": 18.0, "total_loss": -0.03549296036362648, "vf_loss": 0.10245733708143234, "vf_loss_unclipped": 28.66659927368164, "gradients_default_optimizer_global_norm": 0.10874442011117935, "vf_explained_var": 0.015502631664276123, "policy_loss": -0.10068020969629288, "curr_kl_coeff": 2.847657469828846e-06, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0005068923346698284, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 198690.80111984466}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0017307003292379634, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.234789074978731e-06, "add_states_from_episodes_to_batch": 2.0179210860758618e-06, "numpy_to_tensor": 1.3417095096819165e-05, "add_time_dim_to_batch_and_zero_pad": 2.861376398133047e-06, "add_observations_from_episodes_to_batch": 3.669354833861816e-06}}, "connector_pipeline_timer": 5.889062973690711e-05}, "module_episode_returns_mean": {"default_policy": 2.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_env_steps_sampled": 400, "episode_return_mean": 2.15, "agent_episode_returns_mean": {"default_agent": 2.15}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.704249708753252e-05, "normalize_and_clip_actions": 1.2638592356005225e-05, "listify_data_for_vector_env": 1.5818270662020347e-05, "tensor_to_numpy": 1.8898269931840847e-05, "un_batch_to_individual_items": 7.0329258300424236e-06, "remove_single_ts_time_rank_from_batch": 7.195078238766572e-07}}, "connector_pipeline_timer": 0.00014637488141073024}, "env_step_timer": 2.4109344729240927e-05, "sample": 0.30472609874086387, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 18.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 90400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.008270045410608873, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes_lifetime": 360, "rlmodule_inference_timer": 4.030774636991463e-05, "time_between_sampling": 3.4760162226197013}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-26", "timestamp": 1754933486, "time_this_iter_s": 2.9866082668304443, "time_total_s": 59.23487091064453, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.23487091064453, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 76.97500000000001, "ram_util_percent": 81.175}}
{"timers": {"training_iteration": 5.0536050680581575, "restore_env_runners": 3.2219496479804884e-05, "training_step": 5.053372554179229, "env_runner_sampling_timer": 4.844359748774146, "learner_update_timer": 0.20478195877784763, "synch_weights": 0.0011858243676171206, "restore_eval_env_runners": 1.3991306882136262e-05, "evaluation_iteration": 0.32949597592239327, "synch_eval_env_connectors": 0.0004789009574089291, "synch_env_connectors": 4.698840760322892e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.971177045472167e-07, "get_actions": 8.407710581662098e-05, "tensor_to_numpy": 2.4124442988134786e-05, "normalize_and_clip_actions": 1.622331759988805e-05, "listify_data_for_vector_env": 2.0760597215856888e-05, "un_batch_to_individual_items": 9.436670964174822e-06}}, "connector_pipeline_timer": 0.00019861967076318602}, "agent_episode_returns_mean": {"default_agent": 10.66}, "env_step_timer": 2.7454573209474767e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.24021245974235e-06, "numpy_to_tensor": 1.7168728222333664e-05, "add_states_from_episodes_to_batch": 2.5857737130848326e-06, "batch_individual_items": 1.193481824276889e-05, "add_time_dim_to_batch_and_zero_pad": 4.153383865113268e-06}}, "connector_pipeline_timer": 7.488365581697554e-05}, "sample": 0.009164150648105884, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.6879079818300436e-05, "episode_len_min": 20, "weights_seq_no": 18.0, "num_episodes": 250.0, "time_between_sampling": 0.002769716726896744, "episode_duration_sec_mean": 0.00860470017278567, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 7.769161875200676e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 10.66, "module_episode_returns_mean": {"default_policy": 10.66}, "num_episodes_lifetime": -524375.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -10487500.0, "num_env_steps_sampled_lifetime_throughput": 2310.3634195020413}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011508517548053303, "add_states_from_episodes_to_batch": 4.044899917502034e-06, "add_columns_from_episodes_to_train_batch": 0.06290628661084802, "add_time_dim_to_batch_and_zero_pad": 1.3544675734574943e-05, "add_one_ts_to_episodes_and_truncate": 0.013178004566852758, "add_observations_from_episodes_to_batch": 0.001046541462277908, "batch_individual_items": 0.056832990796930674, "general_advantage_estimation": 0.017110780384337592}}, "connector_pipeline_timer": 0.15142021246068874}, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1056495.6161750641, "num_module_steps_trained_throughput": 201554.5170089886, "num_module_steps_trained_lifetime_throughput": 201381.8829006927}, "default_policy": {"entropy": 0.352801650762558, "weights_seq_no": 19.0, "total_loss": 0.01614151895046234, "vf_loss": 0.10224167257547379, "vf_loss_unclipped": 28.553913116455078, "gradients_default_optimizer_global_norm": 0.07589247077703476, "vf_explained_var": 0.018101215362548828, "policy_loss": -0.04904314875602722, "curr_kl_coeff": 1.423828734914423e-06, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0003655123873613775, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 201319.3609643153}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.001714225405622495, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.259728411503986e-06, "add_states_from_episodes_to_batch": 1.8483238084222871e-06, "numpy_to_tensor": 1.1664041657310274e-05, "add_time_dim_to_batch_and_zero_pad": 2.69237691117114e-06, "add_observations_from_episodes_to_batch": 3.4766398091153208e-06}}, "connector_pipeline_timer": 5.412174946910703e-05}, "module_episode_returns_mean": {"default_policy": 2.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_env_steps_sampled": 400, "episode_return_mean": 2.15, "agent_episode_returns_mean": {"default_agent": 2.15}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.6305151911816e-05, "normalize_and_clip_actions": 1.1590270378400839e-05, "listify_data_for_vector_env": 1.435952133529904e-05, "tensor_to_numpy": 1.8395963574648104e-05, "un_batch_to_individual_items": 6.662553969789122e-06, "remove_single_ts_time_rank_from_batch": 6.654172109614912e-07}}, "connector_pipeline_timer": 0.00013927463050567203}, "env_step_timer": 1.881743201295941e-05, "sample": 0.3031068869136228, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 19.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 95400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.007893506684340537, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes_lifetime": 380, "rlmodule_inference_timer": 3.739500579775063e-05, "time_between_sampling": 3.469925184563478}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-29", "timestamp": 1754933489, "time_this_iter_s": 2.994753122329712, "time_total_s": 62.22962403297424, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 62.22962403297424, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 75.6, "ram_util_percent": 80.6}}
{"timers": {"training_iteration": 5.029818440717073, "restore_env_runners": 3.1959381149524265e-05, "training_step": 5.029585049046841, "env_runner_sampling_timer": 4.821188169617274, "learner_update_timer": 0.20412814294082554, "synch_weights": 0.0011865057037068205, "restore_eval_env_runners": 1.4064723726409539e-05, "evaluation_iteration": 0.32770277866343495, "synch_eval_env_connectors": 0.0004779052875455224, "synch_env_connectors": 4.701852733444332e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.011617686047924e-06, "get_actions": 8.412351832427511e-05, "tensor_to_numpy": 2.500759192772246e-05, "normalize_and_clip_actions": 1.622692660231413e-05, "listify_data_for_vector_env": 1.9980171117120512e-05, "un_batch_to_individual_items": 9.249417526200509e-06}}, "connector_pipeline_timer": 0.00019906561815289742}, "agent_episode_returns_mean": {"default_agent": 10.66}, "env_step_timer": 2.7337768662226482e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.362161291870863e-06, "numpy_to_tensor": 1.7260973089485808e-05, "add_states_from_episodes_to_batch": 2.7082493690981885e-06, "batch_individual_items": 1.153823282907846e-05, "add_time_dim_to_batch_and_zero_pad": 4.060439252700922e-06}}, "connector_pipeline_timer": 7.537029939738024e-05}, "sample": 0.009221592074115052, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_max": 12.5, "rlmodule_inference_timer": 5.552719231261043e-05, "episode_len_min": 20, "weights_seq_no": 19.0, "num_episodes": 250.0, "time_between_sampling": 0.0028570844179044304, "episode_duration_sec_mean": 0.008404117691796274, "episode_return_min": -7.5, "episode_len_max": 20, "env_reset_timer": 8.157947641324215e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 10.66, "module_episode_returns_mean": {"default_policy": 10.66}, "num_episodes_lifetime": -555250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -11105000.0, "num_env_steps_sampled_lifetime_throughput": 2276.336750400555}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00011475265358897796, "add_states_from_episodes_to_batch": 4.040701485390703e-06, "add_columns_from_episodes_to_train_batch": 0.0626653462448928, "add_time_dim_to_batch_and_zero_pad": 1.354338832240899e-05, "add_one_ts_to_episodes_and_truncate": 0.013131539100957924, "add_observations_from_episodes_to_batch": 0.0010451343878749098, "batch_individual_items": 0.0566449633889411, "general_advantage_estimation": 0.016994092169490313}}, "connector_pipeline_timer": 0.15082548617555513}, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1066447.0333866095, "num_module_steps_trained_throughput": 203451.93983730752, "num_module_steps_trained_lifetime_throughput": 203269.71597797057}, "default_policy": {"entropy": 0.33666831254959106, "weights_seq_no": 20.0, "total_loss": 0.03985561802983284, "vf_loss": 0.10234948992729187, "vf_loss_unclipped": 28.65300178527832, "gradients_default_optimizer_global_norm": 0.03212713077664375, "vf_explained_var": 0.018335282802581787, "policy_loss": -0.025547273457050323, "curr_kl_coeff": 7.119143674572115e-07, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "mean_kl_loss": 0.00021589340758509934, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 203210.70890780186}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0016983406524103462, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.841757685138205e-06, "add_states_from_episodes_to_batch": 1.912969181512169e-06, "numpy_to_tensor": 1.4421754261411065e-05, "add_time_dim_to_batch_and_zero_pad": 3.0624705865811304e-06, "add_observations_from_episodes_to_batch": 3.7724990492882366e-06}}, "connector_pipeline_timer": 5.978890233989529e-05}, "module_episode_returns_mean": {"default_policy": 2.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_env_steps_sampled": 400, "episode_return_mean": 2.15, "agent_episode_returns_mean": {"default_agent": 2.15}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.58540224593928e-05, "normalize_and_clip_actions": 1.2942269970183767e-05, "listify_data_for_vector_env": 1.5722637937995807e-05, "tensor_to_numpy": 1.864178522892232e-05, "un_batch_to_individual_items": 7.613458702702967e-06, "remove_single_ts_time_rank_from_batch": 8.193969615794608e-07}}, "connector_pipeline_timer": 0.00014694321817209402}, "env_step_timer": 2.044805042808476e-05, "sample": 0.3019881572147171, "episode_len_min": 20, "num_episodes": 20, "weights_seq_no": 20.0, "episode_return_min": -16.5, "episode_len_max": 20, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 100400, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.008053027088753878, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes_lifetime": 400, "rlmodule_inference_timer": 4.005420079845008e-05, "time_between_sampling": 3.4622783752179784}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4d499_00000", "date": "2025-08-11_19-31-32", "timestamp": 1754933492, "time_this_iter_s": 2.879971742630005, "time_total_s": 65.10959577560425, "pid": 23147, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14bbedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.10959577560425, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 73.375, "ram_util_percent": 80.5}}
