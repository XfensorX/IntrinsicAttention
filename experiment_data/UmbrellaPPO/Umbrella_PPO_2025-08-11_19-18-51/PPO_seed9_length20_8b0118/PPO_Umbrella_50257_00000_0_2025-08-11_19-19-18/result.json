{"timers": {"training_iteration": 5.499559749965556, "restore_env_runners": 3.3958000130951405e-05, "training_step": 5.499155041994527, "env_runner_sampling_timer": 5.294728417065926, "learner_update_timer": 0.19480345805641264, "synch_weights": 0.0018021659925580025}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0017905093507940332, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00019157924166184057, "listify_data_for_vector_env": 3.9922844518431805e-05, "remove_single_ts_time_rank_from_batch": 1.6718527925638833e-06, "normalize_and_clip_actions": 3.3415426850282704e-05, "un_batch_to_individual_items": 1.6034316427399283e-05, "tensor_to_numpy": 5.023153876718312e-05}}, "connector_pipeline_timer": 0.0004112965170238937}, "episode_len_max": 20, "episode_duration_sec_mean": 0.01817614249046892, "rlmodule_inference_timer": 0.00019314750072156223, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_return_mean": 2.740000000000001, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.706259189239955e-06, "numpy_to_tensor": 3.572293199991286e-05, "add_time_dim_to_batch_and_zero_pad": 9.317305480308332e-06, "add_observations_from_episodes_to_batch": 8.817818438503461e-06, "batch_individual_items": 2.2046285174566404e-05}}, "connector_pipeline_timer": 0.00015065892061067075}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 2.740000000000001}, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime": 627500.0, "sample": 0.020320814256709473, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_step_timer": 5.54417050200407e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "agent_episode_returns_mean": {"default_agent": 2.740000000000001}, "weights_seq_no": 0.0, "env_reset_timer": 0.00019893769912829052, "num_env_steps_sampled_lifetime_throughput": 1362.8403155980989}, "learners": {"default_policy": {"entropy": 0.6885873675346375, "curr_kl_coeff": 0.3732481598854065, "vf_loss": 0.09794427454471588, "num_module_steps_trained_lifetime": 6000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 30.640653610229492, "vf_explained_var": 0.0010921955108642578, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.004588165320456028, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0010491644497960806, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.18117614090442657, "policy_loss": -0.06464065611362457, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 159165.65801496606}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.13750172406435e-05, "numpy_to_tensor": 7.54999928176403e-05, "add_one_ts_to_episodes_and_truncate": 0.017502167029306293, "add_observations_from_episodes_to_batch": 0.001152458949945867, "general_advantage_estimation": 0.012125459033995867, "add_columns_from_episodes_to_train_batch": 0.05476816603913903, "add_time_dim_to_batch_and_zero_pad": 2.795807085931301e-05, "batch_individual_items": 0.0528265000320971}}, "connector_pipeline_timer": 0.13879716594237834}, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained_lifetime_throughput": 832696.30036977, "num_module_steps_trained_throughput": 159013.55590634764, "num_module_steps_trained_lifetime_throughput": 158837.71727172824}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.0407474413746788e-05, "un_batch_to_individual_items": 1.0267697094990786e-05, "get_actions": 0.00012248061056962595, "tensor_to_numpy": 3.2180543908940436e-05, "listify_data_for_vector_env": 2.457080049874611e-05, "remove_single_ts_time_rank_from_batch": 1.3922692393972279e-06}}, "connector_pipeline_timer": 0.0002735474935898001}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "rlmodule_inference_timer": 7.4309343417333e-05, "sample": 0.29954683303367347, "num_env_steps_sampled_lifetime": 5400, "env_step_timer": 3.9550213410265804e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.889853364564494e-06, "add_time_dim_to_batch_and_zero_pad": 5.4828319355866006e-06, "batch_individual_items": 1.4215229342537664e-05, "add_states_from_episodes_to_batch": 3.0449631297476074e-06, "numpy_to_tensor": 2.072200702487474e-05}}, "connector_pipeline_timer": 9.168852174224452e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": -2.3}, "num_episodes_lifetime": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -2.3}, "env_reset_timer": 0.001192291034385562, "episode_duration_sec_mean": 0.013752358220517635, "episode_return_mean": -2.3, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 1.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "50257_00000", "date": "2025-08-11_19-30-32", "timestamp": 1754933432, "time_this_iter_s": 5.8343589305877686, "time_total_s": 5.8343589305877686, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.8343589305877686, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 61.27777777777778, "ram_util_percent": 81.28888888888889}}
{"timers": {"training_iteration": 5.478762664136011, "restore_env_runners": 3.368842066265642e-05, "training_step": 5.478359915324254, "env_runner_sampling_timer": 5.272928622065811, "learner_update_timer": 0.1958706576458644, "synch_weights": 0.0017909614124801008, "restore_eval_env_runners": 2.0542065612971783e-05, "evaluation_iteration": 0.3317817091010511, "synch_eval_env_connectors": 0.0005799169884994626, "synch_env_connectors": 5.66698145121336e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.00368244190448895, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00010862371768115144, "listify_data_for_vector_env": 2.4123038243510663e-05, "remove_single_ts_time_rank_from_batch": 1.2626073858214337e-06, "normalize_and_clip_actions": 1.9749058073704977e-05, "un_batch_to_individual_items": 1.162287690431452e-05, "tensor_to_numpy": 3.1392642153862434e-05}}, "connector_pipeline_timer": 0.000248258135104903}, "episode_len_max": 20, "episode_duration_sec_mean": 0.010577731146942824, "rlmodule_inference_timer": 7.065376670100565e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 4.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.0436108179376537e-06, "numpy_to_tensor": 2.5448191538361676e-05, "add_time_dim_to_batch_and_zero_pad": 7.4063762684904726e-06, "add_observations_from_episodes_to_batch": 5.981288823260343e-06, "batch_individual_items": 1.3959894952850378e-05}}, "connector_pipeline_timer": 9.57476040338492e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 4.5}, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime": 10000.0, "sample": 0.015544655366893314, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.5096683835659476e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "agent_episode_returns_mean": {"default_agent": 4.5}, "weights_seq_no": 1.0, "env_reset_timer": 0.0001381414584346993, "num_env_steps_sampled_lifetime_throughput": 1941.2456193921362}, "learners": {"default_policy": {"entropy": 0.691445529460907, "curr_kl_coeff": 0.18662407994270325, "vf_loss": 0.09875519573688507, "num_module_steps_trained_lifetime": 12000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 32.4010124206543, "vf_explained_var": 7.56978988647461e-05, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.019843995571136475, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0011109872721135616, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.04752764850854874, "policy_loss": -0.08004441857337952, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 162098.26469566955}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.1237516775727273e-05, "numpy_to_tensor": 7.562124286778272e-05, "add_one_ts_to_episodes_and_truncate": 0.017406187019078062, "add_observations_from_episodes_to_batch": 0.0011507935309782624, "general_advantage_estimation": 0.012068774444051087, "add_columns_from_episodes_to_train_batch": 0.05505350437946618, "add_time_dim_to_batch_and_zero_pad": 2.7929330244660377e-05, "batch_individual_items": 0.05416440503206104}}, "connector_pipeline_timer": 0.14026487761293538}, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained_lifetime_throughput": 848166.0999036746, "num_module_steps_trained_throughput": 161956.7311818151, "num_module_steps_trained_lifetime_throughput": 161781.65466246716}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2530871657781117e-05, "un_batch_to_individual_items": 7.780429990437208e-06, "get_actions": 5.6895837444635796e-05, "tensor_to_numpy": 1.850793868341708e-05, "listify_data_for_vector_env": 1.4444000955867666e-05, "remove_single_ts_time_rank_from_batch": 7.431007753660744e-07}}, "connector_pipeline_timer": 0.00014496171631267734}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "rlmodule_inference_timer": 4.093029225178551e-05, "sample": 0.2983625742932781, "num_env_steps_sampled_lifetime": 10400, "env_step_timer": 2.0768097016956817e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6577520156407673e-06, "add_time_dim_to_batch_and_zero_pad": 4.069647876026351e-06, "batch_individual_items": 9.378198776700548e-06, "add_states_from_episodes_to_batch": 1.983670704076874e-06, "numpy_to_tensor": 1.2943449331599978e-05}}, "connector_pipeline_timer": 6.0228661557801934e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "module_episode_returns_mean": {"default_policy": -0.8}, "num_episodes_lifetime": 40, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_reset_timer": 0.0011811281240079552, "episode_duration_sec_mean": 0.011048430134542287, "episode_return_mean": -0.8, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 2.0, "time_between_sampling": 3.4936240420211107}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "50257_00000", "date": "2025-08-11_19-30-36", "timestamp": 1754933436, "time_this_iter_s": 3.6107659339904785, "time_total_s": 9.445124864578247, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.445124864578247, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 81.14000000000001, "ram_util_percent": 80.85999999999999}}
{"timers": {"training_iteration": 5.457204112494341, "restore_env_runners": 3.3424456685315816e-05, "training_step": 5.456803057012067, "env_runner_sampling_timer": 5.251690460004809, "learner_update_timer": 0.19559275439862395, "synch_weights": 0.0017949872180004602, "restore_eval_env_runners": 2.042455482296646e-05, "evaluation_iteration": 0.3303326103405561, "synch_eval_env_connectors": 0.0005754357285331934, "synch_env_connectors": 5.6619814131408925e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0032528515760620424, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00011051528613628033, "listify_data_for_vector_env": 2.4780518185913043e-05, "remove_single_ts_time_rank_from_batch": 1.1599737259031177e-06, "normalize_and_clip_actions": 1.9351989995285167e-05, "un_batch_to_individual_items": 1.0700624428263285e-05, "tensor_to_numpy": 3.0017944710279525e-05}}, "connector_pipeline_timer": 0.00024779967832454935}, "episode_len_max": 20, "episode_duration_sec_mean": 0.010537856502458453, "rlmodule_inference_timer": 7.218807806510189e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 5.460000000000001, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3220466876567374e-06, "numpy_to_tensor": 2.0506578846841763e-05, "add_time_dim_to_batch_and_zero_pad": 5.231572760177364e-06, "add_observations_from_episodes_to_batch": 5.75715638352317e-06, "batch_individual_items": 1.3856377765847034e-05}}, "connector_pipeline_timer": 8.747982990922634e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime": -607500.0, "sample": 0.010503332623587103, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.3095344481748696e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "weights_seq_no": 2.0, "env_reset_timer": 8.877783477105897e-05, "num_env_steps_sampled_lifetime_throughput": 2210.7037211697257}, "learners": {"default_policy": {"entropy": 0.6914345622062683, "curr_kl_coeff": 0.09331203997135162, "vf_loss": 0.09795084595680237, "num_module_steps_trained_lifetime": 18000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 30.6032657623291, "vf_explained_var": 0.0010613203048706055, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.24234046041965485, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0013817347353324294, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.1847822666168213, "policy_loss": 0.1828346997499466, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 164921.02878213787}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.1057222178205848e-05, "numpy_to_tensor": 7.577753098448738e-05, "add_one_ts_to_episodes_and_truncate": 0.01734956764850067, "add_observations_from_episodes_to_batch": 0.0011645710152108223, "general_advantage_estimation": 0.012028746278863401, "add_columns_from_episodes_to_train_batch": 0.05516039224611596, "add_time_dim_to_batch_and_zero_pad": 2.781628733500838e-05, "batch_individual_items": 0.054152602651808414}}, "connector_pipeline_timer": 0.14027580091700656}, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained_lifetime_throughput": 863120.8728822273, "num_module_steps_trained_throughput": 164794.19075433508, "num_module_steps_trained_lifetime_throughput": 164622.03166115884}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.8063150514482713e-05, "un_batch_to_individual_items": 1.0307516860762672e-05, "get_actions": 9.513859329499502e-05, "tensor_to_numpy": 2.4585817310615937e-05, "listify_data_for_vector_env": 1.9542667297822315e-05, "remove_single_ts_time_rank_from_batch": 1.6548768967886117e-06}}, "connector_pipeline_timer": 0.00021701760012876928}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "rlmodule_inference_timer": 6.178560336951774e-05, "sample": 0.2973385785509832, "num_env_steps_sampled_lifetime": 15400, "env_step_timer": 3.1347388202209836e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.359772947353169e-06, "add_time_dim_to_batch_and_zero_pad": 3.881114794765662e-06, "batch_individual_items": 1.4319481707678625e-05, "add_states_from_episodes_to_batch": 2.7654248459020867e-06, "numpy_to_tensor": 1.737449569222812e-05}}, "connector_pipeline_timer": 7.988839875153062e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "module_episode_returns_mean": {"default_policy": -0.3}, "num_episodes_lifetime": 60, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_reset_timer": 0.0011713564229081383, "episode_duration_sec_mean": 0.010344154121897493, "episode_return_mean": -0.3, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 3.0, "time_between_sampling": 3.49222782910103}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "50257_00000", "date": "2025-08-11_19-30-39", "timestamp": 1754933439, "time_this_iter_s": 3.529406785964966, "time_total_s": 12.974531650543213, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.974531650543213, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 77.72, "ram_util_percent": 80.16}}
{"timers": {"training_iteration": 5.434203586369357, "restore_env_runners": 3.3181461940170265e-05, "training_step": 5.433804169360981, "env_runner_sampling_timer": 5.228897405824739, "learner_update_timer": 0.1954453714347639, "synch_weights": 0.0017844477654596555, "restore_eval_env_runners": 2.0442388963419946e-05, "evaluation_iteration": 0.3290711742378422, "synch_eval_env_connectors": 0.0005747909607947804, "synch_env_connectors": 5.674941872712224e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0033664151376834777, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.661975332741305e-05, "listify_data_for_vector_env": 2.3952474465466438e-05, "remove_single_ts_time_rank_from_batch": 1.2027100807279205e-06, "normalize_and_clip_actions": 1.7936816726548726e-05, "un_batch_to_individual_items": 9.861883443807696e-06, "tensor_to_numpy": 2.774259733129568e-05}}, "connector_pipeline_timer": 0.0002279053888616715}, "episode_len_max": 20, "episode_duration_sec_mean": 0.009658465147949755, "rlmodule_inference_timer": 6.396117186396354e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 5.940000000000001, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8059399135926664e-06, "numpy_to_tensor": 1.969060708198465e-05, "add_time_dim_to_batch_and_zero_pad": 4.945785697873194e-06, "add_observations_from_episodes_to_batch": 5.775183670500974e-06, "batch_individual_items": 1.2832174183237017e-05}}, "connector_pipeline_timer": 8.39251121276529e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime": -1225000.0, "sample": 0.011399226839057657, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.008994942996814e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "weights_seq_no": 3.0, "env_reset_timer": 0.00010626974903090972, "num_env_steps_sampled_lifetime_throughput": 2108.9598579122257}, "learners": {"default_policy": {"entropy": 0.6874051094055176, "curr_kl_coeff": 0.04665601998567581, "vf_loss": 0.09893853217363358, "num_module_steps_trained_lifetime": 24000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 32.7551155090332, "vf_explained_var": 0.0005099177360534668, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.06070161238312721, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0017084633000195026, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.15090256929397583, "policy_loss": 0.0005972132785245776, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 168392.1794336241}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.089582029590383e-05, "numpy_to_tensor": 7.598141608212609e-05, "add_one_ts_to_episodes_and_truncate": 0.017297731551469655, "add_observations_from_episodes_to_batch": 0.001171045304499101, "general_advantage_estimation": 0.01204088298622612, "add_columns_from_episodes_to_train_batch": 0.05545463916363288, "add_time_dim_to_batch_and_zero_pad": 2.7676874062977728e-05, "batch_individual_items": 0.05407254662573617}}, "connector_pipeline_timer": 0.1404554120684421}, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained_lifetime_throughput": 881492.6891515541, "num_module_steps_trained_throughput": 168283.7817444952, "num_module_steps_trained_lifetime_throughput": 168111.6222701803}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4623226375117198e-05, "un_batch_to_individual_items": 7.514570261397566e-06, "get_actions": 7.983715815869903e-05, "tensor_to_numpy": 2.199916240481123e-05, "listify_data_for_vector_env": 2.0521451246923856e-05, "remove_single_ts_time_rank_from_batch": 7.378349057021519e-07}}, "connector_pipeline_timer": 0.00018293275652940823}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "rlmodule_inference_timer": 5.929610191446066e-05, "sample": 0.2958523965157671, "num_env_steps_sampled_lifetime": 20400, "env_step_timer": 2.1754603320657246e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.85322142759561e-06, "add_time_dim_to_batch_and_zero_pad": 3.3568025846583227e-06, "batch_individual_items": 1.1283170395546694e-05, "add_states_from_episodes_to_batch": 2.005419731075804e-06, "numpy_to_tensor": 1.406221645575273e-05}}, "connector_pipeline_timer": 6.515100870654984e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "module_episode_returns_mean": {"default_policy": -0.8}, "num_episodes_lifetime": 80, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_reset_timer": 0.0011618349487116791, "episode_duration_sec_mean": 0.009457537962589413, "episode_return_mean": -0.8, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 4.0, "time_between_sampling": 3.489253823309741}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "50257_00000", "date": "2025-08-11_19-30-43", "timestamp": 1754933443, "time_this_iter_s": 3.3179290294647217, "time_total_s": 16.292460680007935, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.292460680007935, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 79.16, "ram_util_percent": 80.3}}
{"timers": {"training_iteration": 5.407990994665231, "restore_env_runners": 3.291964668962988e-05, "training_step": 5.407593461417388, "env_runner_sampling_timer": 5.203461819266651, "learner_update_timer": 0.19473047022060835, "synch_weights": 0.0017735507877377802, "restore_eval_env_runners": 2.0356294263503517e-05, "evaluation_iteration": 0.32736306707578977, "synch_eval_env_connectors": 0.0005714963806940941, "synch_env_connectors": 5.674443173338659e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0026570828549188526, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.438116395591752e-05, "listify_data_for_vector_env": 1.992042716844896e-05, "remove_single_ts_time_rank_from_batch": 1.0120048354880069e-06, "normalize_and_clip_actions": 1.630539403035484e-05, "un_batch_to_individual_items": 9.115855745504194e-06, "tensor_to_numpy": 2.5814902324723007e-05}}, "connector_pipeline_timer": 0.00019945410882170217}, "episode_len_max": 20, "episode_duration_sec_mean": 0.009067826039623469, "rlmodule_inference_timer": 7.743403717422922e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 6.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8572252830520314e-06, "numpy_to_tensor": 1.7320918521158466e-05, "add_time_dim_to_batch_and_zero_pad": 4.3292970995501e-06, "add_observations_from_episodes_to_batch": 5.087793313327232e-06, "batch_individual_items": 1.1603989179531118e-05}}, "connector_pipeline_timer": 7.475917210892103e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 6.5}, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime": -1842500.0, "sample": 0.009313464429518154, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.7134620671573586e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "agent_episode_returns_mean": {"default_agent": 6.5}, "weights_seq_no": 4.0, "env_reset_timer": 8.255063000733687e-05, "num_env_steps_sampled_lifetime_throughput": 2316.6600576604437}, "learners": {"default_policy": {"entropy": 0.6789590120315552, "curr_kl_coeff": 0.023328009992837906, "vf_loss": 0.09875169396400452, "num_module_steps_trained_lifetime": 30000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 32.43641662597656, "vf_explained_var": 0.0012282133102416992, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.13377542793750763, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0014019616646692157, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.07133479416370392, "policy_loss": 0.07381351292133331, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 172967.9483990262}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0727692438769155e-05, "numpy_to_tensor": 7.612618156819022e-05, "add_one_ts_to_episodes_and_truncate": 0.017232760075820613, "add_observations_from_episodes_to_batch": 0.0011749681823673703, "general_advantage_estimation": 0.011990567486359729, "add_columns_from_episodes_to_train_batch": 0.05542103569211698, "add_time_dim_to_batch_and_zero_pad": 2.7531355448635292e-05, "batch_individual_items": 0.05386666531913967}}, "connector_pipeline_timer": 0.14010340669806137}, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained_lifetime_throughput": 905683.6944980257, "num_module_steps_trained_throughput": 172882.43027367393, "num_module_steps_trained_lifetime_throughput": 172710.42024314552}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.730677813327263e-05, "un_batch_to_individual_items": 9.860388382423294e-06, "get_actions": 8.933017525099796e-05, "tensor_to_numpy": 2.6892163732149095e-05, "listify_data_for_vector_env": 1.958048361549238e-05, "remove_single_ts_time_rank_from_batch": 9.894798245028677e-07}}, "connector_pipeline_timer": 0.00021134414784831977}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "rlmodule_inference_timer": 6.429239512989004e-05, "sample": 0.29473544130070595, "num_env_steps_sampled_lifetime": 25400, "env_step_timer": 2.876404317878501e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.114042019479128e-06, "add_time_dim_to_batch_and_zero_pad": 5.080174052131866e-06, "batch_individual_items": 1.3464091788961442e-05, "add_states_from_episodes_to_batch": 2.7075329678818076e-06, "numpy_to_tensor": 1.9428230892771005e-05}}, "connector_pipeline_timer": 8.440393823144186e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "module_episode_returns_mean": {"default_policy": -0.5}, "num_episodes_lifetime": 100, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "agent_episode_returns_mean": {"default_agent": -0.5}, "env_reset_timer": 0.0011512870090049305, "episode_duration_sec_mean": 0.009270696610910819, "episode_return_mean": -0.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 5.0, "time_between_sampling": 3.482863392156483}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "50257_00000", "date": "2025-08-11_19-30-46", "timestamp": 1754933446, "time_this_iter_s": 3.0063328742980957, "time_total_s": 19.29879355430603, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.29879355430603, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 74.80000000000001, "ram_util_percent": 79.65}}
{"timers": {"training_iteration": 5.381959669309012, "restore_env_runners": 3.2720450048464504e-05, "training_step": 5.381562950142568, "env_runner_sampling_timer": 5.176800822744281, "learner_update_timer": 0.19541885259814853, "synch_weights": 0.0017643440304830474, "restore_eval_env_runners": 2.0221481553326598e-05, "evaluation_iteration": 0.3260015722454255, "synch_eval_env_connectors": 0.0005668655764811824, "synch_env_connectors": 5.670198559289566e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.002550039950599287, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.619677598334542e-05, "listify_data_for_vector_env": 1.9860865710594404e-05, "remove_single_ts_time_rank_from_batch": 9.695469640439749e-07, "normalize_and_clip_actions": 1.649722288656833e-05, "un_batch_to_individual_items": 9.389111523359806e-06, "tensor_to_numpy": 2.5096525078897275e-05}}, "connector_pipeline_timer": 0.00020138441452196898}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008499219719786195, "rlmodule_inference_timer": 5.6301070234387135e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 6.820000000000002, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.983127753093987e-06, "numpy_to_tensor": 1.7886297208405095e-05, "add_time_dim_to_batch_and_zero_pad": 4.467379930776045e-06, "add_observations_from_episodes_to_batch": 4.838345251972284e-06, "batch_individual_items": 1.1862765336666022e-05}}, "connector_pipeline_timer": 7.613570461280939e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime": -2460000.0, "sample": 0.009529846417371684, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.751426841548401e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "weights_seq_no": 5.0, "env_reset_timer": 8.152515347699349e-05, "num_env_steps_sampled_lifetime_throughput": 2297.2730942546045}, "learners": {"default_policy": {"entropy": 0.6706355810165405, "curr_kl_coeff": 0.011664004996418953, "vf_loss": 0.09929709136486053, "num_module_steps_trained_lifetime": 36000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 33.48452377319336, "vf_explained_var": 0.0018221735954284668, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.06740652769804001, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.000993289751932025, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03585651144385338, "policy_loss": 0.007046705111861229, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 177060.18693916514}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.055541578088873e-05, "numpy_to_tensor": 7.608533967348925e-05, "add_one_ts_to_episodes_and_truncate": 0.017195393304808383, "add_observations_from_episodes_to_batch": 0.001189807671573324, "general_advantage_estimation": 0.011951244312164374, "add_columns_from_episodes_to_train_batch": 0.05548304449534282, "add_time_dim_to_batch_and_zero_pad": 2.7403961530368678e-05, "batch_individual_items": 0.05486780158625437}}, "connector_pipeline_timer": 0.14110296055048177}, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 927349.6142505421, "num_module_steps_trained_throughput": 176995.68457289124, "num_module_steps_trained_lifetime_throughput": 176825.86935967277}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.525477378023821e-05, "un_batch_to_individual_items": 1.3765061754361607e-05, "get_actions": 0.00012150451392400327, "tensor_to_numpy": 3.626213249558852e-05, "listify_data_for_vector_env": 2.8335003425523566e-05, "remove_single_ts_time_rank_from_batch": 1.1855052341138843e-06}}, "connector_pipeline_timer": 0.00028723657944282755}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "rlmodule_inference_timer": 8.112704473673211e-05, "sample": 0.29401730688756167, "num_env_steps_sampled_lifetime": 30400, "env_step_timer": 3.938485526492508e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.669614924461587e-06, "add_time_dim_to_batch_and_zero_pad": 5.934690428956876e-06, "batch_individual_items": 1.6782964097448332e-05, "add_states_from_episodes_to_batch": 3.7952844581005386e-06, "numpy_to_tensor": 2.338588050659358e-05}}, "connector_pipeline_timer": 0.00010084639693805911}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "module_episode_returns_mean": {"default_policy": 0.3}, "num_episodes_lifetime": 120, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_reset_timer": 0.0011405349689223747, "episode_duration_sec_mean": 0.008583983696298673, "episode_return_mean": 0.3, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 6.0, "time_between_sampling": 3.4763989540655724}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "50257_00000", "date": "2025-08-11_19-30-49", "timestamp": 1754933449, "time_this_iter_s": 3.0377559661865234, "time_total_s": 22.336549520492554, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.336549520492554, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.400000000000006, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 5.354803817616181, "restore_env_runners": 3.245157544498124e-05, "training_step": 5.354408906471295, "env_runner_sampling_timer": 5.150407474097249, "learner_update_timer": 0.19469699949179398, "synch_weights": 0.0017557501701450304, "restore_eval_env_runners": 2.0095516445283538e-05, "evaluation_iteration": 0.32504727693304813, "synch_eval_env_connectors": 0.0005623865106824591, "synch_env_connectors": 5.661836871932086e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0030548462156162813, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.405231503343979e-05, "listify_data_for_vector_env": 1.9554608493872327e-05, "remove_single_ts_time_rank_from_batch": 1.0635957892037925e-06, "normalize_and_clip_actions": 1.638511999777327e-05, "un_batch_to_individual_items": 9.109462545781398e-06, "tensor_to_numpy": 2.4696363094878212e-05}}, "connector_pipeline_timer": 0.00019725162975822908}, "episode_len_max": 20, "episode_duration_sec_mean": 0.0084034474985674, "rlmodule_inference_timer": 5.507429047441524e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 7.54, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6838131574219937e-06, "numpy_to_tensor": 1.728162795942445e-05, "add_time_dim_to_batch_and_zero_pad": 4.374879770475447e-06, "add_observations_from_episodes_to_batch": 5.112515991867065e-06, "batch_individual_items": 1.159478735927217e-05}}, "connector_pipeline_timer": 7.404865472035349e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 7.54}, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime": -3077500.0, "sample": 0.009085119482325805, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.649801662771235e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "agent_episode_returns_mean": {"default_agent": 7.54}, "weights_seq_no": 6.0, "env_reset_timer": 8.205626109528788e-05, "num_env_steps_sampled_lifetime_throughput": 2302.400024390638}, "learners": {"default_policy": {"entropy": 0.6684635877609253, "curr_kl_coeff": 0.0058320024982094765, "vf_loss": 0.100577712059021, "num_module_steps_trained_lifetime": 42000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 36.07630157470703, "vf_explained_var": 0.0011950135231018066, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.14335104823112488, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0004201476403977722, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03081803396344185, "policy_loss": -0.2045687586069107, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 181099.34638598163}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0383191329718895e-05, "numpy_to_tensor": 7.6020316953459e-05, "add_one_ts_to_episodes_and_truncate": 0.017163323532359036, "add_observations_from_episodes_to_batch": 0.0011905091750803317, "general_advantage_estimation": 0.011892965199095076, "add_columns_from_episodes_to_train_batch": 0.055398106140575866, "add_time_dim_to_batch_and_zero_pad": 2.7256172003279866e-05, "batch_individual_items": 0.05463452732009246}}, "connector_pipeline_timer": 0.1406930813539695}, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained_lifetime_throughput": 948649.8392891864, "num_module_steps_trained_throughput": 181052.17133290588, "num_module_steps_trained_lifetime_throughput": 180873.07601511813}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.1347169311304862e-05, "un_batch_to_individual_items": 1.1618634009606486e-05, "get_actions": 0.00012732680046781988, "tensor_to_numpy": 3.472725733912348e-05, "listify_data_for_vector_env": 2.792909583919847e-05, "remove_single_ts_time_rank_from_batch": 1.3171984838206984e-06}}, "connector_pipeline_timer": 0.00028501938255436136}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "rlmodule_inference_timer": 7.658988808014667e-05, "sample": 0.29309449256972225, "num_env_steps_sampled_lifetime": 35400, "env_step_timer": 3.33843003983523e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.374537027011614e-06, "add_time_dim_to_batch_and_zero_pad": 7.4485539254992046e-06, "batch_individual_items": 1.7646997304817367e-05, "add_states_from_episodes_to_batch": 3.992517300406044e-06, "numpy_to_tensor": 2.83373679937171e-05}}, "connector_pipeline_timer": 0.00010223753233489027}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "module_episode_returns_mean": {"default_policy": 0.5}, "num_episodes_lifetime": 140, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "agent_episode_returns_mean": {"default_agent": 0.5}, "env_reset_timer": 0.0011299650400297988, "episode_duration_sec_mean": 0.008800533700268716, "episode_return_mean": 0.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 7.0, "time_between_sampling": 3.468530654945559}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "50257_00000", "date": "2025-08-11_19-30-52", "timestamp": 1754933452, "time_this_iter_s": 2.877823829650879, "time_total_s": 25.214373350143433, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.214373350143433, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 55.725, "ram_util_percent": 79.14999999999999}}
{"timers": {"training_iteration": 5.329158497360971, "restore_env_runners": 3.219331048602992e-05, "training_step": 5.328763549497416, "env_runner_sampling_timer": 5.124954438106723, "learner_update_timer": 0.19456073032741386, "synch_weights": 0.0017454660078771755, "restore_eval_env_runners": 1.9969561851917704e-05, "evaluation_iteration": 0.3238767408336242, "synch_eval_env_connectors": 0.0005579384764148363, "synch_env_connectors": 5.647299149593548e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.002653841853047158, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.270469366254064e-05, "listify_data_for_vector_env": 2.0023775556322974e-05, "remove_single_ts_time_rank_from_batch": 1.0425245063894534e-06, "normalize_and_clip_actions": 1.5818611020465825e-05, "un_batch_to_individual_items": 8.988492392108785e-06, "tensor_to_numpy": 2.463912409489865e-05}}, "connector_pipeline_timer": 0.00019599115325581712}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008774175046943125, "rlmodule_inference_timer": 7.380106348145323e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 8.419999999999998, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5021298624752925e-06, "numpy_to_tensor": 1.6764281783147804e-05, "add_time_dim_to_batch_and_zero_pad": 4.06010126134349e-06, "add_observations_from_episodes_to_batch": 4.986483607192079e-06, "batch_individual_items": 1.1360913426786597e-05}}, "connector_pipeline_timer": 7.287023468991366e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime": -3695000.0, "sample": 0.009255624380300979, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.562139427276401e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "weights_seq_no": 7.0, "env_reset_timer": 7.654711414412002e-05, "num_env_steps_sampled_lifetime_throughput": 2310.027869197316}, "learners": {"default_policy": {"entropy": 0.6606499552726746, "curr_kl_coeff": 0.0029160012491047382, "vf_loss": 0.10039109736680984, "num_module_steps_trained_lifetime": 48000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 35.76835250854492, "vf_explained_var": 0.0018621087074279785, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.045362912118434906, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0003812006616499275, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0560244545340538, "policy_loss": -0.10652390867471695, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 184236.51146366657}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0271859538685734e-05, "numpy_to_tensor": 7.700511426552993e-05, "add_one_ts_to_episodes_and_truncate": 0.017173308216623908, "add_observations_from_episodes_to_batch": 0.0012008540839497893, "general_advantage_estimation": 0.011854165967496503, "add_columns_from_episodes_to_train_batch": 0.055626523829477144, "add_time_dim_to_batch_and_zero_pad": 2.7516940304673147e-05, "batch_individual_items": 0.05455680788645835}}, "connector_pipeline_timer": 0.1408255621993166}, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained_lifetime_throughput": 965364.5786457323, "num_module_steps_trained_throughput": 184203.52960464428, "num_module_steps_trained_lifetime_throughput": 184032.44721397644}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.8352874587032922e-05, "un_batch_to_individual_items": 9.532414845054353e-06, "get_actions": 7.974850222629069e-05, "tensor_to_numpy": 2.646176459691318e-05, "listify_data_for_vector_env": 2.367298702052101e-05, "remove_single_ts_time_rank_from_batch": 7.970148712143161e-07}}, "connector_pipeline_timer": 0.00020190775826765649}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "rlmodule_inference_timer": 6.614410511094604e-05, "sample": 0.2916729009843956, "num_env_steps_sampled_lifetime": 40400, "env_step_timer": 2.8533750140834235e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.9447752908944034e-06, "add_time_dim_to_batch_and_zero_pad": 4.046928860863107e-06, "batch_individual_items": 1.1511973889070527e-05, "add_states_from_episodes_to_batch": 2.5713387777137953e-06, "numpy_to_tensor": 2.204953144302192e-05}}, "connector_pipeline_timer": 7.951964752403025e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "module_episode_returns_mean": {"default_policy": 0.3}, "num_episodes_lifetime": 160, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_reset_timer": 0.0011199262199517812, "episode_duration_sec_mean": 0.008392965771490709, "episode_return_mean": 0.3, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 8.0, "time_between_sampling": 3.4620866204758616}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "50257_00000", "date": "2025-08-11_19-30-55", "timestamp": 1754933455, "time_this_iter_s": 2.9522740840911865, "time_total_s": 28.16664743423462, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.16664743423462, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 74.34, "ram_util_percent": 79.16}}
{"timers": {"training_iteration": 5.303622249047554, "restore_env_runners": 3.200220724814517e-05, "training_step": 5.303225806092656, "env_runner_sampling_timer": 5.098665383725159, "learner_update_timer": 0.195318450114852, "synch_weights": 0.0017431542570495572, "restore_eval_env_runners": 1.984361650392911e-05, "evaluation_iteration": 0.3222275434253572, "synch_eval_env_connectors": 0.0005539986710734598, "synch_env_connectors": 5.637075637153017e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0025243854109917104, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.20570142639317e-05, "listify_data_for_vector_env": 1.947790203916221e-05, "remove_single_ts_time_rank_from_batch": 1.0016505736533022e-06, "normalize_and_clip_actions": 1.5392949498739268e-05, "un_batch_to_individual_items": 8.715328742289323e-06, "tensor_to_numpy": 2.4334806421916926e-05}}, "connector_pipeline_timer": 0.00019327317010481111}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008221094327047467, "rlmodule_inference_timer": 5.3012683245221386e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 8.419999999999998, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.4328145024197265e-06, "numpy_to_tensor": 1.7220787557040227e-05, "add_time_dim_to_batch_and_zero_pad": 4.184464754250149e-06, "add_observations_from_episodes_to_batch": 5.104606407933252e-06, "batch_individual_items": 1.1257552902542285e-05}}, "connector_pipeline_timer": 7.328932094098388e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime": -4312500.0, "sample": 0.00889932331886016, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.5135462938481863e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "weights_seq_no": 8.0, "env_reset_timer": 8.218549792406658e-05, "num_env_steps_sampled_lifetime_throughput": 2379.1141485889275}, "learners": {"default_policy": {"entropy": 0.6526697874069214, "curr_kl_coeff": 0.0014580006245523691, "vf_loss": 0.10038838535547256, "num_module_steps_trained_lifetime": 54000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 35.71833038330078, "vf_explained_var": 0.0028856992721557617, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.02790551446378231, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00035186053719371557, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0056614866480231285, "policy_loss": -0.0891357809305191, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 185957.3699521689}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0107890947322187e-05, "numpy_to_tensor": 7.693673319212211e-05, "add_one_ts_to_episodes_and_truncate": 0.018481663054084052, "add_observations_from_episodes_to_batch": 0.0011976047029378962, "general_advantage_estimation": 0.01179310139739796, "add_columns_from_episodes_to_train_batch": 0.055482274421116175, "add_time_dim_to_batch_and_zero_pad": 2.737969046170122e-05, "batch_individual_items": 0.05436487605679514}}, "connector_pipeline_timer": 0.14173195657693077}, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained_lifetime_throughput": 974577.5764671523, "num_module_steps_trained_throughput": 185936.38987978606, "num_module_steps_trained_lifetime_throughput": 185773.11117645164}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2200843174553708e-05, "un_batch_to_individual_items": 6.746818342213774e-06, "get_actions": 5.737867303617969e-05, "tensor_to_numpy": 1.736859640480589e-05, "listify_data_for_vector_env": 1.3968348194946567e-05, "remove_single_ts_time_rank_from_batch": 6.713744956239049e-07}}, "connector_pipeline_timer": 0.00014184615115317323}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.791190809904023e-05, "sample": 0.2903261790643099, "num_env_steps_sampled_lifetime": 45400, "env_step_timer": 1.8961209423540694e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.990509889564588e-06, "add_time_dim_to_batch_and_zero_pad": 3.0093816086153387e-06, "batch_individual_items": 9.005094387145221e-06, "add_states_from_episodes_to_batch": 2.3420208708681015e-06, "numpy_to_tensor": 1.2314978499101804e-05}}, "connector_pipeline_timer": 5.858296152436101e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "module_episode_returns_mean": {"default_policy": 1.3}, "num_episodes_lifetime": 180, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "agent_episode_returns_mean": {"default_agent": 1.3}, "env_reset_timer": 0.0011103007078030018, "episode_duration_sec_mean": 0.008463877872563898, "episode_return_mean": 1.3, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 9.0, "time_between_sampling": 3.455592998440694}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "50257_00000", "date": "2025-08-11_19-30-58", "timestamp": 1754933458, "time_this_iter_s": 2.949146032333374, "time_total_s": 31.115793466567993, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.115793466567993, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 72.95, "ram_util_percent": 79.275}}
{"timers": {"training_iteration": 5.2790431690570525, "restore_env_runners": 3.174218563253332e-05, "training_step": 5.278648285951112, "env_runner_sampling_timer": 5.073096218638443, "learner_update_timer": 0.19634952769340244, "synch_weights": 0.0017326060439580855, "restore_eval_env_runners": 1.9783510845050675e-05, "evaluation_iteration": 0.320665523830919, "synch_eval_env_connectors": 0.0005524616042489864, "synch_env_connectors": 5.624875182189062e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0030174154013353958, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.339697710368217e-05, "listify_data_for_vector_env": 1.9353952066807027e-05, "remove_single_ts_time_rank_from_batch": 1.12711088157405e-06, "normalize_and_clip_actions": 1.5644570085465354e-05, "un_batch_to_individual_items": 8.983178942740297e-06, "tensor_to_numpy": 2.4866128166606928e-05}}, "connector_pipeline_timer": 0.00019521458000292818}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008476860342547295, "rlmodule_inference_timer": 5.48774457646858e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 9.940000000000001, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6404358914534494e-06, "numpy_to_tensor": 1.7285377837554932e-05, "add_time_dim_to_batch_and_zero_pad": 4.232130692933221e-06, "add_observations_from_episodes_to_batch": 5.192939614077286e-06, "batch_individual_items": 1.1405511378567816e-05}}, "connector_pipeline_timer": 7.437206900447069e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 9.940000000000001}, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime": -4930000.0, "sample": 0.0088434223813162, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.6480452062837668e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "agent_episode_returns_mean": {"default_agent": 9.940000000000001}, "weights_seq_no": 9.0, "env_reset_timer": 7.879516936693124e-05, "num_env_steps_sampled_lifetime_throughput": 2343.3891325286127}, "learners": {"default_policy": {"entropy": 0.64539635181427, "curr_kl_coeff": 0.0007290003122761846, "vf_loss": 0.10020184516906738, "num_module_steps_trained_lifetime": 60000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 35.351341247558594, "vf_explained_var": 0.0037711262702941895, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.15950974822044373, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00015151759725995362, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.06948995590209961, "policy_loss": 0.09833916276693344, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 189051.56106833648}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9973481928506034e-05, "numpy_to_tensor": 7.689402680658496e-05, "add_one_ts_to_episodes_and_truncate": 0.018403200593090772, "add_observations_from_episodes_to_batch": 0.0011945286549924683, "general_advantage_estimation": 0.011729769133272063, "add_columns_from_episodes_to_train_batch": 0.05578251833676533, "add_time_dim_to_batch_and_zero_pad": 2.730589275167645e-05, "batch_individual_items": 0.05560089479616803}}, "connector_pipeline_timer": 0.14312197868084758}, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained_lifetime_throughput": 990907.6440813532, "num_module_steps_trained_throughput": 189039.32655964146, "num_module_steps_trained_lifetime_throughput": 188881.3801363053}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4291143065529134e-05, "un_batch_to_individual_items": 8.424981013155499e-06, "get_actions": 6.462723009446119e-05, "tensor_to_numpy": 2.3395369089471922e-05, "listify_data_for_vector_env": 1.620856396432779e-05, "remove_single_ts_time_rank_from_batch": 8.070579617338505e-07}}, "connector_pipeline_timer": 0.00016740481042775462}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.629725229224057e-05, "sample": 0.28933579977399493, "num_env_steps_sampled_lifetime": 50400, "env_step_timer": 2.299538542312323e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7682786658763903e-06, "add_time_dim_to_batch_and_zero_pad": 3.1998561704148374e-06, "batch_individual_items": 9.912813859641515e-06, "add_states_from_episodes_to_batch": 2.4366721308950553e-06, "numpy_to_tensor": 1.4501619300675067e-05}}, "connector_pipeline_timer": 6.456083790802814e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "module_episode_returns_mean": {"default_policy": 1.5}, "num_episodes_lifetime": 200, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "agent_episode_returns_mean": {"default_agent": 1.5}, "env_reset_timer": 0.0011006406209087348, "episode_duration_sec_mean": 0.008518542870879173, "episode_return_mean": 1.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 10.0, "time_between_sampling": 3.4497761901254917}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "50257_00000", "date": "2025-08-11_19-31-01", "timestamp": 1754933461, "time_this_iter_s": 3.0470809936523438, "time_total_s": 34.16287446022034, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.16287446022034, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 57.15, "ram_util_percent": 79.475}}
{"timers": {"training_iteration": 5.252526609037192, "restore_env_runners": 3.1733513507838074e-05, "training_step": 5.252132141431566, "env_runner_sampling_timer": 5.047058218542543, "learner_update_timer": 0.19587174658615322, "synch_weights": 0.0017329137336219186, "restore_eval_env_runners": 1.9657755447262534e-05, "evaluation_iteration": 0.3194462744229056, "synch_eval_env_connectors": 0.0005479419877099899, "synch_env_connectors": 5.619877111648261e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0032020240073529797, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.140084763826095e-05, "listify_data_for_vector_env": 1.91467091673069e-05, "remove_single_ts_time_rank_from_batch": 1.125930916275747e-06, "normalize_and_clip_actions": 1.578696725640742e-05, "un_batch_to_individual_items": 8.86555335926803e-06, "tensor_to_numpy": 2.396789136382657e-05}}, "connector_pipeline_timer": 0.00019242382338124112}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008213305154815317, "rlmodule_inference_timer": 5.512116378319659e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 9.460000000000004, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5917466166794642e-06, "numpy_to_tensor": 1.644824493583759e-05, "add_time_dim_to_batch_and_zero_pad": 4.237010200819234e-06, "add_observations_from_episodes_to_batch": 4.93325105084744e-06, "batch_individual_items": 1.1221558554145708e-05}}, "connector_pipeline_timer": 7.29161737823632e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime": -5547500.0, "sample": 0.008950353607226855, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.5779908411014137e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "weights_seq_no": 10.0, "env_reset_timer": 7.882182997866176e-05, "num_env_steps_sampled_lifetime_throughput": 2327.799549648373}, "learners": {"default_policy": {"entropy": 0.6424030065536499, "curr_kl_coeff": 0.0003645001561380923, "vf_loss": 0.10056816786527634, "num_module_steps_trained_lifetime": 66000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 36.1129264831543, "vf_explained_var": 0.003722965717315674, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.024965224787592888, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00011596082913456485, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.05864938348531723, "policy_loss": -0.03647731989622116, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 190869.88232529568}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9997086411686293e-05, "numpy_to_tensor": 7.691050695444211e-05, "add_one_ts_to_episodes_and_truncate": 0.018297589007337144, "add_observations_from_episodes_to_batch": 0.0011909000382884973, "general_advantage_estimation": 0.011695077692592386, "add_columns_from_episodes_to_train_batch": 0.05566586940444031, "add_time_dim_to_batch_and_zero_pad": 2.737033348366815e-05, "batch_individual_items": 0.055572905847825926}}, "connector_pipeline_timer": 0.1428331326449567}, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained_lifetime_throughput": 1000460.5785257214, "num_module_steps_trained_throughput": 190866.65868849072, "num_module_steps_trained_lifetime_throughput": 190714.97604147455}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.1384689778831299e-05, "un_batch_to_individual_items": 6.801904608002198e-06, "get_actions": 4.978431174544296e-05, "tensor_to_numpy": 1.6222136999055466e-05, "listify_data_for_vector_env": 1.4339370297004507e-05, "remove_single_ts_time_rank_from_batch": 7.060234764190094e-07}}, "connector_pipeline_timer": 0.0001303320205972487}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.4540748744008205e-05, "sample": 0.28793640177589824, "num_env_steps_sampled_lifetime": 55400, "env_step_timer": 1.8007142589491493e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.638237078870758e-06, "add_time_dim_to_batch_and_zero_pad": 2.788977331147389e-06, "batch_individual_items": 8.731368314713331e-06, "add_states_from_episodes_to_batch": 1.9196075488785986e-06, "numpy_to_tensor": 1.0786474607825698e-05}}, "connector_pipeline_timer": 5.413593365400849e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "module_episode_returns_mean": {"default_policy": 1.7}, "num_episodes_lifetime": 220, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "agent_episode_returns_mean": {"default_agent": 1.7}, "env_reset_timer": 0.0010904383849673037, "episode_duration_sec_mean": 0.007838097871281207, "episode_return_mean": 1.7, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "weights_seq_no": 11.0, "time_between_sampling": 3.4418799648940053}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "50257_00000", "date": "2025-08-11_19-31-04", "timestamp": 1754933464, "time_this_iter_s": 2.79498291015625, "time_total_s": 36.95785737037659, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.95785737037659, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 36.75, "ram_util_percent": 79.15}}
{"timers": {"training_iteration": 5.227657901697715, "restore_env_runners": 3.147409848782825e-05, "training_step": 5.227265375428095, "env_runner_sampling_timer": 5.022910490946788, "learner_update_timer": 0.19519980620009555, "synch_weights": 0.0017228425071966933, "restore_eval_env_runners": 1.9537847859591908e-05, "evaluation_iteration": 0.3178505445995057, "synch_eval_env_connectors": 0.0005465196580967037, "synch_env_connectors": 5.625348193116379e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0029336263850473538, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.192214840470109e-05, "listify_data_for_vector_env": 1.9163794395595413e-05, "remove_single_ts_time_rank_from_batch": 9.944664863003201e-07, "normalize_and_clip_actions": 1.585451415230085e-05, "un_batch_to_individual_items": 9.144769329674235e-06, "tensor_to_numpy": 2.3842812831418384e-05}}, "connector_pipeline_timer": 0.00019240237324663628}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008269117190036921, "rlmodule_inference_timer": 5.348513659033742e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 9.539999999999996, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.524695720441308e-06, "numpy_to_tensor": 1.7446589362237004e-05, "add_time_dim_to_batch_and_zero_pad": 3.972775204951392e-06, "add_observations_from_episodes_to_batch": 4.987426260612537e-06, "batch_individual_items": 1.146442963614418e-05}}, "connector_pipeline_timer": 7.36419270352493e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 9.539999999999996}, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime": -6165000.0, "sample": 0.008783402418739376, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.5608675150741106e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "agent_episode_returns_mean": {"default_agent": 9.539999999999996}, "weights_seq_no": 11.0, "env_reset_timer": 8.039075680186434e-05, "num_env_steps_sampled_lifetime_throughput": 2367.488106069799}, "learners": {"default_policy": {"entropy": 0.6375489234924316, "curr_kl_coeff": 0.00018225007806904614, "vf_loss": 0.10111989825963974, "num_module_steps_trained_lifetime": 72000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 37.25564193725586, "vf_explained_var": 0.0028873085975646973, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.09505714476108551, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0003195784520357847, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.030036011710762978, "policy_loss": -0.156912699341774, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 192663.95654539}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.983044525420848e-05, "numpy_to_tensor": 7.680807168763791e-05, "add_one_ts_to_episodes_and_truncate": 0.018258140197335862, "add_observations_from_episodes_to_batch": 0.001190214377148473, "general_advantage_estimation": 0.011637896915600823, "add_columns_from_episodes_to_train_batch": 0.055599040289996966, "add_time_dim_to_batch_and_zero_pad": 2.723079997139023e-05, "batch_individual_items": 0.05535174345911911}}, "connector_pipeline_timer": 0.142445833819305}, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 1009949.0365214437, "num_module_steps_trained_throughput": 192672.62935526727, "num_module_steps_trained_lifetime_throughput": 192527.87343737742}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.9234239370399972e-05, "un_batch_to_individual_items": 1.0541177893465434e-05, "get_actions": 9.230862508666811e-05, "tensor_to_numpy": 3.674434415752759e-05, "listify_data_for_vector_env": 2.2122295808218407e-05, "remove_single_ts_time_rank_from_batch": 1.806271414050093e-06}}, "connector_pipeline_timer": 0.00023425065234529194}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 7.170702501459768e-05, "sample": 0.2866839265080274, "num_env_steps_sampled_lifetime": 60400, "env_step_timer": 3.5604516494059876e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.875775978822313e-06, "add_time_dim_to_batch_and_zero_pad": 7.211003669876497e-06, "batch_individual_items": 1.4737045561432095e-05, "add_states_from_episodes_to_batch": 2.6226940279724924e-06, "numpy_to_tensor": 2.1298359050523025e-05}}, "connector_pipeline_timer": 9.654876587493014e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "module_episode_returns_mean": {"default_policy": 2.3}, "num_episodes_lifetime": 240, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "agent_episode_returns_mean": {"default_agent": 2.3}, "env_reset_timer": 0.0010804590011761176, "episode_duration_sec_mean": 0.0074483858281746505, "episode_return_mean": 2.3, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "weights_seq_no": 12.0, "time_between_sampling": 3.435393218574488}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "50257_00000", "date": "2025-08-11_19-31-07", "timestamp": 1754933467, "time_this_iter_s": 2.942270040512085, "time_total_s": 39.90012741088867, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.90012741088867, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 73.275, "ram_util_percent": 79.375}}
{"timers": {"training_iteration": 5.203577248090411, "restore_env_runners": 3.122226717871202e-05, "training_step": 5.203186201262767, "env_runner_sampling_timer": 4.999533313538004, "learner_update_timer": 0.19455111480825554, "synch_weights": 0.0017128228320094658, "restore_eval_env_runners": 1.9419969389042614e-05, "evaluation_iteration": 0.31639879957422606, "synch_eval_env_connectors": 0.0005433402914938004, "synch_env_connectors": 5.644925323516844e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.002787886841932575, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.44943596290212e-05, "listify_data_for_vector_env": 1.945050129427699e-05, "remove_single_ts_time_rank_from_batch": 1.1840229534328245e-06, "normalize_and_clip_actions": 1.5549378199447406e-05, "un_batch_to_individual_items": 9.111999252215775e-06, "tensor_to_numpy": 2.4982561288485805e-05}}, "connector_pipeline_timer": 0.00019871370138853665}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008549179018475114, "rlmodule_inference_timer": 5.678577012085963e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 9.460000000000004, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6678909555446267e-06, "numpy_to_tensor": 1.703191693799565e-05, "add_time_dim_to_batch_and_zero_pad": 4.4909923079992905e-06, "add_observations_from_episodes_to_batch": 5.0648531205067245e-06, "batch_individual_items": 1.2158757952122003e-05}}, "connector_pipeline_timer": 7.632224094933108e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime": -6782500.0, "sample": 0.008993485428152002, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.6580445804310127e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "weights_seq_no": 12.0, "env_reset_timer": 8.263785337928048e-05, "num_env_steps_sampled_lifetime_throughput": 2340.648120945024}, "learners": {"default_policy": {"entropy": 0.6236662864685059, "curr_kl_coeff": 9.112503903452307e-05, "vf_loss": 0.10056453198194504, "num_module_steps_trained_lifetime": 78000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 36.1948127746582, "vf_explained_var": 0.004157304763793945, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.00666135223582387, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00024740456137806177, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.024964654818177223, "policy_loss": -0.05494841933250427, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 194434.00686913013}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9691720999224203e-05, "numpy_to_tensor": 7.67479113786379e-05, "add_one_ts_to_episodes_and_truncate": 0.018179527965375947, "add_observations_from_episodes_to_batch": 0.0011880193235890204, "general_advantage_estimation": 0.01161086711572892, "add_columns_from_episodes_to_train_batch": 0.055418915716507026, "add_time_dim_to_batch_and_zero_pad": 2.7718911033083775e-05, "batch_individual_items": 0.0552480660237287}}, "connector_pipeline_timer": 0.14205423632131706}, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained_lifetime_throughput": 1019348.7879765786, "num_module_steps_trained_throughput": 194456.31813881735, "num_module_steps_trained_lifetime_throughput": 194318.19286683612}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3069340340690744e-05, "un_batch_to_individual_items": 7.053156563616995e-06, "get_actions": 5.955050456930487e-05, "tensor_to_numpy": 1.9939163233633506e-05, "listify_data_for_vector_env": 1.6359951770288444e-05, "remove_single_ts_time_rank_from_batch": 7.718665643655487e-07}}, "connector_pipeline_timer": 0.00015144520597538643}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.175683773810618e-05, "sample": 0.2854514176630034, "num_env_steps_sampled_lifetime": 65400, "env_step_timer": 2.1059345847724895e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.84264784085188e-06, "add_time_dim_to_batch_and_zero_pad": 3.2203395107993067e-06, "batch_individual_items": 8.893388010411486e-06, "add_states_from_episodes_to_batch": 1.971826670701032e-06, "numpy_to_tensor": 1.2645269769807763e-05}}, "connector_pipeline_timer": 5.791982560479095e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "module_episode_returns_mean": {"default_policy": 2.7}, "num_episodes_lifetime": 260, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_reset_timer": 0.0010703965017974954, "episode_duration_sec_mean": 0.007572541278786957, "episode_return_mean": 2.7, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 14.5, "episode_len_min": 20, "weights_seq_no": 13.0, "time_between_sampling": 3.429568330139348}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "50257_00000", "date": "2025-08-11_19-31-10", "timestamp": 1754933470, "time_this_iter_s": 2.9912712574005127, "time_total_s": 42.891398668289185, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.891398668289185, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 60.2, "ram_util_percent": 79.18}}
{"timers": {"training_iteration": 5.179073695609209, "restore_env_runners": 3.096838488130525e-05, "training_step": 5.1786845046695875, "env_runner_sampling_timer": 4.974135525403349, "learner_update_timer": 0.19549283033045495, "synch_weights": 0.0017056158538557426, "restore_eval_env_runners": 1.9299940224994564e-05, "evaluation_iteration": 0.3149242053293414, "synch_eval_env_connectors": 0.0005403789784152363, "synch_env_connectors": 5.6297255112646135e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0026514509994605816, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.187257562911883e-05, "listify_data_for_vector_env": 1.9229065231359826e-05, "remove_single_ts_time_rank_from_batch": 1.0136215705679327e-06, "normalize_and_clip_actions": 1.572014032490385e-05, "un_batch_to_individual_items": 8.764848940298838e-06, "tensor_to_numpy": 2.4263614773571766e-05}}, "connector_pipeline_timer": 0.0001925754336034346}, "episode_len_max": 20, "episode_duration_sec_mean": 0.00822541950177401, "rlmodule_inference_timer": 5.345365048353347e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 11.859999999999996, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6379304878481505e-06, "numpy_to_tensor": 1.6307531587728502e-05, "add_time_dim_to_batch_and_zero_pad": 4.1047290857229394e-06, "add_observations_from_episodes_to_batch": 4.758679086825492e-06, "batch_individual_items": 1.1175979682016352e-05}}, "connector_pipeline_timer": 7.158163685086214e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 11.859999999999996}, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime": -7400000.0, "sample": 0.008969556180275862, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.612196850475519e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "agent_episode_returns_mean": {"default_agent": 11.859999999999996}, "weights_seq_no": 13.0, "env_reset_timer": 7.718049971294927e-05, "num_env_steps_sampled_lifetime_throughput": 2351.1017472963936}, "learners": {"default_policy": {"entropy": 0.6360170841217041, "curr_kl_coeff": 4.5562519517261535e-05, "vf_loss": 0.1025959849357605, "num_module_steps_trained_lifetime": 84000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 40.3286018371582, "vf_explained_var": -0.01017308235168457, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.26746711134910583, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0002494497748557478, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03703908249735832, "policy_loss": -0.3303236663341522, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 195681.6033527175}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9675634036932176e-05, "numpy_to_tensor": 7.70804324917217e-05, "add_one_ts_to_episodes_and_truncate": 0.018096859355533273, "add_observations_from_episodes_to_batch": 0.00118549247049088, "general_advantage_estimation": 0.011567395523855226, "add_columns_from_episodes_to_train_batch": 0.05526022822860543, "add_time_dim_to_batch_and_zero_pad": 2.7567552915809236e-05, "batch_individual_items": 0.05670044702286177}}, "connector_pipeline_timer": 0.14321805104863106}, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained_lifetime_throughput": 1025942.4817868068, "num_module_steps_trained_throughput": 195708.26417980506, "num_module_steps_trained_lifetime_throughput": 195575.28324869927}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.724271157682142e-05, "un_batch_to_individual_items": 1.0188169497138535e-05, "get_actions": 8.451732560133586e-05, "tensor_to_numpy": 2.6764967052243425e-05, "listify_data_for_vector_env": 2.0209263343385055e-05, "remove_single_ts_time_rank_from_batch": 9.590398207029796e-07}}, "connector_pipeline_timer": 0.0002076575409000582}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 6.021659089003765e-05, "sample": 0.2843612580769328, "num_env_steps_sampled_lifetime": 70400, "env_step_timer": 2.9293850504426857e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.620620167421246e-06, "add_time_dim_to_batch_and_zero_pad": 4.4557623265591126e-06, "batch_individual_items": 1.7028880117379916e-05, "add_states_from_episodes_to_batch": 2.5792386676489534e-06, "numpy_to_tensor": 1.9271922411863046e-05}}, "connector_pipeline_timer": 8.881886867094903e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "module_episode_returns_mean": {"default_policy": 2.7}, "num_episodes_lifetime": 280, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_reset_timer": 0.0010608879463475471, "episode_duration_sec_mean": 0.007761000882601366, "episode_return_mean": 2.7, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 14.0, "time_between_sampling": 3.4230169734981315}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "50257_00000", "date": "2025-08-11_19-31-12", "timestamp": 1754933472, "time_this_iter_s": 2.9410219192504883, "time_total_s": 45.83242058753967, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.83242058753967, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 72.425, "ram_util_percent": 78.725}}
{"timers": {"training_iteration": 5.154985971153541, "restore_env_runners": 3.092286136755613e-05, "training_step": 5.154598419213262, "env_runner_sampling_timer": 4.94875451806918, "learner_update_timer": 0.19683969660617018, "synch_weights": 0.0016976309459961565, "restore_eval_env_runners": 1.9201110340723644e-05, "evaluation_iteration": 0.31361440536501517, "synch_eval_env_connectors": 0.0005366135189174528, "synch_env_connectors": 5.611348218930655e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0030291546817857095, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.181233097942484e-05, "listify_data_for_vector_env": 1.9355567742234448e-05, "remove_single_ts_time_rank_from_batch": 1.028853502981067e-06, "normalize_and_clip_actions": 1.570170764361947e-05, "un_batch_to_individual_items": 9.108489217866302e-06, "tensor_to_numpy": 2.3726004520542658e-05}}, "connector_pipeline_timer": 0.00019178946055510693}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008150710847694427, "rlmodule_inference_timer": 5.296588989042357e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.4781860040795143e-06, "numpy_to_tensor": 1.6427310022156632e-05, "add_time_dim_to_batch_and_zero_pad": 4.0948282162857915e-06, "add_observations_from_episodes_to_batch": 5.038140184484468e-06, "batch_individual_items": 1.107485961317849e-05}}, "connector_pipeline_timer": 7.108763512452988e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 10.5}, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime": -8017500.0, "sample": 0.008727466145802972, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.553617893145547e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "agent_episode_returns_mean": {"default_agent": 10.5}, "weights_seq_no": 14.0, "env_reset_timer": 7.307965015013934e-05, "num_env_steps_sampled_lifetime_throughput": 2365.209900944187}, "learners": {"default_policy": {"entropy": 0.6198380589485168, "curr_kl_coeff": 2.2781259758630767e-05, "vf_loss": 0.10167106240987778, "num_module_steps_trained_lifetime": 90000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 38.51253128051758, "vf_explained_var": 0.0007898807525634766, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.16265712678432465, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00010712061339290813, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.04398268088698387, "policy_loss": -0.22504158318042755, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 196563.48169616767}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.975470750348672e-05, "numpy_to_tensor": 7.78808776164301e-05, "add_one_ts_to_episodes_and_truncate": 0.018029773672205342, "add_observations_from_episodes_to_batch": 0.0011824762952766495, "general_advantage_estimation": 0.011545811988205285, "add_columns_from_episodes_to_train_batch": 0.05522620427567576, "add_time_dim_to_batch_and_zero_pad": 2.7516047894514305e-05, "batch_individual_items": 0.05841990546333933}}, "connector_pipeline_timer": 0.14481143095908255}, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained_lifetime_throughput": 1030671.3185610232, "num_module_steps_trained_throughput": 196597.52481851648, "num_module_steps_trained_lifetime_throughput": 196470.20533635747}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.997169557271712e-05, "un_batch_to_individual_items": 9.878819486413701e-06, "get_actions": 8.996644990978465e-05, "tensor_to_numpy": 2.8297581377576987e-05, "listify_data_for_vector_env": 2.4537868427518505e-05, "remove_single_ts_time_rank_from_batch": 1.6226163547583727e-06}}, "connector_pipeline_timer": 0.00022510697887747266}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 6.15218575580918e-05, "sample": 0.28404665008605084, "num_env_steps_sampled_lifetime": 75400, "env_step_timer": 2.9801867177217006e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.094493330082872e-06, "add_time_dim_to_batch_and_zero_pad": 4.155496306637264e-06, "batch_individual_items": 1.3178244404735848e-05, "add_states_from_episodes_to_batch": 2.2108669595398607e-06, "numpy_to_tensor": 1.891296000215908e-05}}, "connector_pipeline_timer": 7.835554445494407e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "module_episode_returns_mean": {"default_policy": 2.9}, "num_episodes_lifetime": 300, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "agent_episode_returns_mean": {"default_agent": 2.9}, "env_reset_timer": 0.0010518223964470635, "episode_duration_sec_mean": 0.008332786302780733, "episode_return_mean": 2.9, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 15.0, "time_between_sampling": 3.4167798712637976}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "50257_00000", "date": "2025-08-11_19-31-16", "timestamp": 1754933476, "time_this_iter_s": 3.032188892364502, "time_total_s": 48.864609479904175, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.864609479904175, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 54.225, "ram_util_percent": 78.92499999999998}}
{"timers": {"training_iteration": 5.132782770611538, "restore_env_runners": 3.0671133773790546e-05, "training_step": 5.132397287940587, "env_runner_sampling_timer": 4.927090270807728, "learner_update_timer": 0.19635527588969154, "synch_weights": 0.0016885738074299238, "restore_eval_env_runners": 1.9080769166045943e-05, "evaluation_iteration": 0.31307305090158594, "synch_eval_env_connectors": 0.000535081974044097, "synch_env_connectors": 5.598984778837128e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0034749958725527152, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.158842784438493e-05, "listify_data_for_vector_env": 2.1482587294673138e-05, "remove_single_ts_time_rank_from_batch": 1.0939017095026206e-06, "normalize_and_clip_actions": 1.7191500651001737e-05, "un_batch_to_individual_items": 1.0048592979870247e-05, "tensor_to_numpy": 2.6419427678620094e-05}}, "connector_pipeline_timer": 0.0002150039857899826}, "episode_len_max": 20, "episode_duration_sec_mean": 0.009368541345931592, "rlmodule_inference_timer": 6.0072396588032756e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 11.700000000000003, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7184177961387057e-06, "numpy_to_tensor": 1.8412526771432222e-05, "add_time_dim_to_batch_and_zero_pad": 4.799184140542966e-06, "add_observations_from_episodes_to_batch": 5.398962771165274e-06, "batch_individual_items": 1.2562288611640627e-05}}, "connector_pipeline_timer": 7.876254226129667e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 11.700000000000003}, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime": -8635000.0, "sample": 0.009381465016399262, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.060441965699899e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "agent_episode_returns_mean": {"default_agent": 11.700000000000003}, "weights_seq_no": 15.0, "env_reset_timer": 7.902236630018339e-05, "num_env_steps_sampled_lifetime_throughput": 2174.239039224108}, "learners": {"default_policy": {"entropy": 0.6082354187965393, "curr_kl_coeff": 1.1390629879315384e-05, "vf_loss": 0.10140769928693771, "num_module_steps_trained_lifetime": 96000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 37.72899627685547, "vf_explained_var": 0.003667175769805908, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.07125132530927658, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0001255715760635212, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.12816815078258514, "policy_loss": 0.00893791951239109, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 198328.0687317024}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9589660093846277e-05, "numpy_to_tensor": 7.783498827435128e-05, "add_one_ts_to_episodes_and_truncate": 0.017988288856260415, "add_observations_from_episodes_to_batch": 0.0011973402826914946, "general_advantage_estimation": 0.011489713868628109, "add_columns_from_episodes_to_train_batch": 0.05529551973305184, "add_time_dim_to_batch_and_zero_pad": 2.7365887203227615e-05, "batch_individual_items": 0.05827031348865703}}, "connector_pipeline_timer": 0.14464661664926895}, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained_lifetime_throughput": 1040083.155683511, "num_module_steps_trained_throughput": 198380.41875494667, "num_module_steps_trained_lifetime_throughput": 198257.16216062105}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.734937311290367e-05, "un_batch_to_individual_items": 1.36895113209128e-05, "get_actions": 9.810634839881945e-05, "tensor_to_numpy": 2.7044847708234175e-05, "listify_data_for_vector_env": 2.0399451218812117e-05, "remove_single_ts_time_rank_from_batch": 1.5365687861531568e-06}}, "connector_pipeline_timer": 0.00023085147684371603}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 6.781322389064944e-05, "sample": 0.28292303774537625, "num_env_steps_sampled_lifetime": 80400, "env_step_timer": 3.4921434212471046e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.462472711277468e-06, "add_time_dim_to_batch_and_zero_pad": 6.1725971276275915e-06, "batch_individual_items": 1.6016691849709938e-05, "add_states_from_episodes_to_batch": 3.2711718018441816e-06, "numpy_to_tensor": 2.151720540686388e-05}}, "connector_pipeline_timer": 9.436487951227576e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "module_episode_returns_mean": {"default_policy": 2.7}, "num_episodes_lifetime": 320, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_reset_timer": 0.0010421729218217264, "episode_duration_sec_mean": 0.008553440064424649, "episode_return_mean": 2.7, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 16.0, "time_between_sampling": 3.412177094211106}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "50257_00000", "date": "2025-08-11_19-31-19", "timestamp": 1754933479, "time_this_iter_s": 3.1203489303588867, "time_total_s": 51.98495841026306, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.98495841026306, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 57.275000000000006, "ram_util_percent": 79.55}}
{"timers": {"training_iteration": 5.115328619155645, "restore_env_runners": 3.0426922329881865e-05, "training_step": 5.114944942971011, "env_runner_sampling_timer": 4.910256461009473, "learner_update_timer": 0.19577887896095625, "synch_weights": 0.0016840880694789315, "restore_eval_env_runners": 1.8965381140631062e-05, "evaluation_iteration": 0.3117713333136501, "synch_eval_env_connectors": 0.0005328069937896291, "synch_env_connectors": 5.587164068303115e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0026320541515138162, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00010913248592638276, "listify_data_for_vector_env": 2.326160340309122e-05, "remove_single_ts_time_rank_from_batch": 1.114517258703332e-06, "normalize_and_clip_actions": 1.9744966218297377e-05, "un_batch_to_individual_items": 1.035171776271182e-05, "tensor_to_numpy": 2.9493654713325594e-05}}, "connector_pipeline_timer": 0.00024298834982985204}, "episode_len_max": 20, "episode_duration_sec_mean": 0.011100440974812956, "rlmodule_inference_timer": 9.959059351645553e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 11.380000000000003, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9121680336826457e-06, "numpy_to_tensor": 2.253322870739729e-05, "add_time_dim_to_batch_and_zero_pad": 5.119513016774706e-06, "add_observations_from_episodes_to_batch": 6.3492884497278955e-06, "batch_individual_items": 1.6347345592947232e-05}}, "connector_pipeline_timer": 9.450957702784151e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 11.380000000000003}, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime": -9252500.0, "sample": 0.011165317883265488, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.380965909054869e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "agent_episode_returns_mean": {"default_agent": 11.380000000000003}, "weights_seq_no": 16.0, "env_reset_timer": 8.670619170532976e-05, "num_env_steps_sampled_lifetime_throughput": 2076.446253915991}, "learners": {"default_policy": {"entropy": 0.5945951342582703, "curr_kl_coeff": 5.695314939657692e-06, "vf_loss": 0.10092901438474655, "num_module_steps_trained_lifetime": 102000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 37.01144027709961, "vf_explained_var": 0.004249453544616699, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.113533154129982, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00019485194934532046, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0712444856762886, "policy_loss": 0.05141635611653328, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 200468.0242971285}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.943793379431539e-05, "numpy_to_tensor": 7.841080819062269e-05, "add_one_ts_to_episodes_and_truncate": 0.018011780547712308, "add_observations_from_episodes_to_batch": 0.0012123168801842095, "general_advantage_estimation": 0.011443290899762376, "add_columns_from_episodes_to_train_batch": 0.05521082661582448, "add_time_dim_to_batch_and_zero_pad": 2.7224727593885883e-05, "batch_individual_items": 0.05808838285478649}}, "connector_pipeline_timer": 0.14437257257192457}, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained_lifetime_throughput": 1051472.843876896, "num_module_steps_trained_throughput": 200540.61206713974, "num_module_steps_trained_lifetime_throughput": 200420.84008796324}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.470340815953227e-05, "un_batch_to_individual_items": 8.621247196673242e-06, "get_actions": 7.41367251056732e-05, "tensor_to_numpy": 2.2498337275416367e-05, "listify_data_for_vector_env": 1.8152119230114363e-05, "remove_single_ts_time_rank_from_batch": 1.2394057526718496e-06}}, "connector_pipeline_timer": 0.00018046250124458208}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 5.205153398416876e-05, "sample": 0.2822533073677567, "num_env_steps_sampled_lifetime": 85400, "env_step_timer": 2.410697087379627e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.710515248899039e-06, "add_time_dim_to_batch_and_zero_pad": 4.242873656358715e-06, "batch_individual_items": 1.076745748398188e-05, "add_states_from_episodes_to_batch": 2.9462842731473775e-06, "numpy_to_tensor": 1.5370406306910067e-05}}, "connector_pipeline_timer": 7.161870408379033e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "module_episode_returns_mean": {"default_policy": 2.1}, "num_episodes_lifetime": 340, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "agent_episode_returns_mean": {"default_agent": 2.1}, "env_reset_timer": 0.0010325391124563917, "episode_duration_sec_mean": 0.00905076169059612, "episode_return_mean": 2.1, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 17.0, "time_between_sampling": 3.4122154328492567}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "50257_00000", "date": "2025-08-11_19-31-22", "timestamp": 1754933482, "time_this_iter_s": 3.613252878189087, "time_total_s": 55.59821128845215, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.59821128845215, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 81.8, "ram_util_percent": 81.53333333333333}}
{"timers": {"training_iteration": 5.092253146293961, "restore_env_runners": 3.0184322959167646e-05, "training_step": 5.091871369791233, "env_runner_sampling_timer": 4.886658908070134, "learner_update_timer": 0.19635595225053865, "synch_weights": 0.0016750196891780543, "restore_eval_env_runners": 1.8854896732986375e-05, "evaluation_iteration": 0.3108844724805835, "synch_eval_env_connectors": 0.0005294260038697316, "synch_env_connectors": 5.574212428471238e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.002692872575084622, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.526430670120499e-05, "listify_data_for_vector_env": 1.962376933113307e-05, "remove_single_ts_time_rank_from_batch": 1.1047910006369988e-06, "normalize_and_clip_actions": 1.6181140863343115e-05, "un_batch_to_individual_items": 9.397935162335603e-06, "tensor_to_numpy": 2.5610366727278655e-05}}, "connector_pipeline_timer": 0.00020039452472848365}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008538775498978794, "rlmodule_inference_timer": 5.601236022445116e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 12.420000000000002, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6956040409742322e-06, "numpy_to_tensor": 1.7090700413632574e-05, "add_time_dim_to_batch_and_zero_pad": 4.51811171475155e-06, "add_observations_from_episodes_to_batch": 5.840544517540511e-06, "batch_individual_items": 1.1588719656082071e-05}}, "connector_pipeline_timer": 7.543729493378958e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 12.420000000000002}, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime": -9870000.0, "sample": 0.009995278962180627, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.752891040806802e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "agent_episode_returns_mean": {"default_agent": 12.420000000000002}, "weights_seq_no": 17.0, "env_reset_timer": 8.239445580480587e-05, "num_env_steps_sampled_lifetime_throughput": 2264.8133598500467}, "learners": {"default_policy": {"entropy": 0.6081311106681824, "curr_kl_coeff": 2.847657469828846e-06, "vf_loss": 0.10222505033016205, "num_module_steps_trained_lifetime": 108000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 39.726741790771484, "vf_explained_var": -0.004913330078125, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.1346408873796463, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0001815491123124957, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.019866973161697388, "policy_loss": -0.19750188291072845, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 203330.6959913915}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.927521476729629e-05, "numpy_to_tensor": 7.984294981307742e-05, "add_one_ts_to_episodes_and_truncate": 0.017925772742880926, "add_observations_from_episodes_to_batch": 0.001210382871621319, "general_advantage_estimation": 0.011443682581037954, "add_columns_from_episodes_to_train_batch": 0.05505951251906612, "add_time_dim_to_batch_and_zero_pad": 2.7061230854984875e-05, "batch_individual_items": 0.059219377776013396}}, "connector_pipeline_timer": 0.14526472225539494}, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 1066676.4561903274, "num_module_steps_trained_throughput": 203421.50810627828, "num_module_steps_trained_lifetime_throughput": 203309.9387625818}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2520671237001104e-05, "un_batch_to_individual_items": 7.891675064543978e-06, "get_actions": 5.297310597921227e-05, "tensor_to_numpy": 2.2068122822970242e-05, "listify_data_for_vector_env": 1.3970987617147396e-05, "remove_single_ts_time_rank_from_batch": 7.979833763357367e-07}}, "connector_pipeline_timer": 0.00014173272858071683}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.0095183128935886e-05, "sample": 0.2808578976346244, "num_env_steps_sampled_lifetime": 90400, "env_step_timer": 1.851498363598443e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.655475918848975e-06, "add_time_dim_to_batch_and_zero_pad": 3.306773231450132e-06, "batch_individual_items": 9.205607782518225e-06, "add_states_from_episodes_to_batch": 3.0826922413601494e-06, "numpy_to_tensor": 1.1543921581435049e-05}}, "connector_pipeline_timer": 5.8973911163315214e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "module_episode_returns_mean": {"default_policy": 2.7}, "num_episodes_lifetime": 360, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_reset_timer": 0.0010237428912992258, "episode_duration_sec_mean": 0.008867276688106359, "episode_return_mean": 2.7, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 18.0, "time_between_sampling": 3.4064033485213527}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "50257_00000", "date": "2025-08-11_19-31-25", "timestamp": 1754933485, "time_this_iter_s": 2.9595398902893066, "time_total_s": 58.557751178741455, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.557751178741455, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 76.42500000000001, "ram_util_percent": 81.17500000000001}}
{"timers": {"training_iteration": 5.069283756911245, "restore_env_runners": 2.9944560528246617e-05, "training_step": 5.068901686093338, "env_runner_sampling_timer": 4.862745748569634, "learner_update_timer": 0.19732771772846838, "synch_weights": 0.0016711511526545672, "restore_eval_env_runners": 1.8744677814947763e-05, "evaluation_iteration": 0.3092681298456003, "synch_eval_env_connectors": 0.0005252096542505877, "synch_env_connectors": 5.564300688083353e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0027890151204040866, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.37325548733299e-05, "listify_data_for_vector_env": 1.9827224646257812e-05, "remove_single_ts_time_rank_from_batch": 1.0153238902634996e-06, "normalize_and_clip_actions": 1.608353113390341e-05, "un_batch_to_individual_items": 9.142520485366242e-06, "tensor_to_numpy": 2.5453513146161517e-05}}, "connector_pipeline_timer": 0.00019797398420354844}, "episode_len_max": 20, "episode_duration_sec_mean": 0.008410343697760255, "rlmodule_inference_timer": 5.444494679767649e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 11.940000000000003, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.580455087416188e-06, "numpy_to_tensor": 1.7304702343142282e-05, "add_time_dim_to_batch_and_zero_pad": 4.696728145250252e-06, "add_observations_from_episodes_to_batch": 5.028954188303177e-06, "batch_individual_items": 1.2107643208108802e-05}}, "connector_pipeline_timer": 7.522901136981889e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 11.940000000000003}, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime": -10487500.0, "sample": 0.009091865097854207, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.6350932767153285e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "agent_episode_returns_mean": {"default_agent": 11.940000000000003}, "weights_seq_no": 18.0, "env_reset_timer": 7.950933873725221e-05, "num_env_steps_sampled_lifetime_throughput": 2306.464368032779}, "learners": {"default_policy": {"entropy": 0.5988801717758179, "curr_kl_coeff": 1.423828734914423e-06, "vf_loss": 0.10185413807630539, "num_module_steps_trained_lifetime": 114000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 38.91197967529297, "vf_explained_var": 0.0010715723037719727, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.05254727974534035, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 4.5508480980060995e-05, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.04448277875781059, "policy_loss": -0.11524400860071182, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 205179.1848385723}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9120801677560592e-05, "numpy_to_tensor": 7.975868058407294e-05, "add_one_ts_to_episodes_and_truncate": 0.017855596685395523, "add_observations_from_episodes_to_batch": 0.0012105127937997715, "general_advantage_estimation": 0.011426765755063215, "add_columns_from_episodes_to_train_batch": 0.054987480724710186, "add_time_dim_to_batch_and_zero_pad": 2.6930198188999085e-05, "batch_individual_items": 0.06055735191774375}}, "connector_pipeline_timer": 0.1464419558623224}, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained_lifetime_throughput": 1076523.7387193798, "num_module_steps_trained_throughput": 205283.0340250834, "num_module_steps_trained_lifetime_throughput": 205178.58981977272}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.544901182270176e-05, "un_batch_to_individual_items": 9.085142256385755e-06, "get_actions": 8.109019454133254e-05, "tensor_to_numpy": 2.3874760421366075e-05, "listify_data_for_vector_env": 1.8330545472499423e-05, "remove_single_ts_time_rank_from_batch": 9.766951381085823e-07}}, "connector_pipeline_timer": 0.00019485407014654393}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 5.605134141541312e-05, "sample": 0.2797663161583215, "num_env_steps_sampled_lifetime": 95400, "env_step_timer": 2.5446856436635257e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.610285245567119e-06, "add_time_dim_to_batch_and_zero_pad": 4.765300419507177e-06, "batch_individual_items": 1.1835801454177584e-05, "add_states_from_episodes_to_batch": 2.5928452440759032e-06, "numpy_to_tensor": 1.6367883136149348e-05}}, "connector_pipeline_timer": 7.316042921623224e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "module_episode_returns_mean": {"default_policy": 2.9}, "num_episodes_lifetime": 380, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "agent_episode_returns_mean": {"default_agent": 2.9}, "env_reset_timer": 0.0010159129615095982, "episode_duration_sec_mean": 0.008832439975813032, "episode_return_mean": 2.9, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 19.0, "time_between_sampling": 3.4006924900354956}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "50257_00000", "date": "2025-08-11_19-31-28", "timestamp": 1754933488, "time_this_iter_s": 2.978947877883911, "time_total_s": 61.536699056625366, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.536699056625366, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 75.0, "ram_util_percent": 80.725}}
{"timers": {"training_iteration": 5.0450074939213305, "restore_env_runners": 2.9702614778720913e-05, "training_step": 5.044627237982592, "env_runner_sampling_timer": 4.839342573164245, "learner_update_timer": 0.196510492221152, "synch_weights": 0.0016618246414817006, "restore_eval_env_runners": 1.8624310709388184e-05, "evaluation_iteration": 0.3079745210469969, "synch_eval_env_connectors": 0.0005233063084688607, "synch_env_connectors": 5.60906706043147e-06}, "env_runners": {"episode_len_mean": 20.0, "time_between_sampling": 0.0030213320458846132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 8.23497720709764e-05, "listify_data_for_vector_env": 2.0272217094097753e-05, "remove_single_ts_time_rank_from_batch": 9.421395987096786e-07, "normalize_and_clip_actions": 1.5941309532754143e-05, "un_batch_to_individual_items": 9.344219142250157e-06, "tensor_to_numpy": 2.4136460090202655e-05}}, "connector_pipeline_timer": 0.0001956898994520597}, "episode_len_max": 20, "episode_duration_sec_mean": 0.00833875196473673, "rlmodule_inference_timer": 5.3439242031545794e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6201397439265007e-06, "numpy_to_tensor": 1.6531063165239378e-05, "add_time_dim_to_batch_and_zero_pad": 4.232564881540531e-06, "add_observations_from_episodes_to_batch": 4.902429024885494e-06, "batch_individual_items": 1.096436311740237e-05}}, "connector_pipeline_timer": 7.292970476775382e-05}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 12.5}, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime": -11105000.0, "sample": 0.00896805829643429, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.538950140134042e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_return_min": -5.5, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "agent_episode_returns_mean": {"default_agent": 12.5}, "weights_seq_no": 19.0, "env_reset_timer": 7.727840168451046e-05, "num_env_steps_sampled_lifetime_throughput": 2336.1859759238428}, "learners": {"default_policy": {"entropy": 0.6000101566314697, "curr_kl_coeff": 7.119143674572115e-07, "vf_loss": 0.10185357928276062, "num_module_steps_trained_lifetime": 120000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 38.9202995300293, "vf_explained_var": 0.0011566877365112305, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.01072325836867094, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "mean_kl_loss": 8.406594133703038e-05, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03812684118747711, "policy_loss": -0.05196285992860794, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 208258.4618832}, "__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.896209332617941e-05, "numpy_to_tensor": 7.972275382697032e-05, "add_one_ts_to_episodes_and_truncate": 0.01778614780893465, "add_observations_from_episodes_to_batch": 0.0012144976649787309, "general_advantage_estimation": 0.011374495177268695, "add_columns_from_episodes_to_train_batch": 0.05487015591655858, "add_time_dim_to_batch_and_zero_pad": 2.678089595669508e-05, "batch_individual_items": 0.06029959631824903}}, "connector_pipeline_timer": 0.1459473563029991}, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained_lifetime_throughput": 1092629.2927804007, "num_module_steps_trained_throughput": 208343.62292205886, "num_module_steps_trained_lifetime_throughput": 208241.350048808}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.680156921183235e-05, "un_batch_to_individual_items": 8.99293606887283e-06, "get_actions": 8.384462275071806e-05, "tensor_to_numpy": 2.5353836136839263e-05, "listify_data_for_vector_env": 1.96856248722878e-05, "remove_single_ts_time_rank_from_batch": 9.707770808808998e-07}}, "connector_pipeline_timer": 0.0002015401932629399}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 6.0075714645576044e-05, "sample": 0.27918981466748827, "num_env_steps_sampled_lifetime": 100400, "env_step_timer": 2.9089619782193357e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.764412233288155e-06, "add_time_dim_to_batch_and_zero_pad": 4.24180388163956e-06, "batch_individual_items": 1.2572946626510795e-05, "add_states_from_episodes_to_batch": 2.3986175892563413e-06, "numpy_to_tensor": 1.7102250860114836e-05}}, "connector_pipeline_timer": 7.714099427133365e-05}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "module_episode_returns_mean": {"default_policy": 2.7}, "num_episodes_lifetime": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_reset_timer": 0.0010064775812936874, "episode_duration_sec_mean": 0.008543416250031442, "episode_return_mean": 2.7, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "episode_len_min": 20, "weights_seq_no": 20.0, "time_between_sampling": 3.3933726155445227}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "50257_00000", "date": "2025-08-11_19-31-31", "timestamp": 1754933491, "time_this_iter_s": 2.8717150688171387, "time_total_s": 64.4084141254425, "pid": 23116, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.4084141254425, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 74.75, "ram_util_percent": 80.35}}
