{"timers": {"training_iteration": 1.5192610420053825, "restore_env_runners": 8.999952115118504e-06, "training_step": 1.5191178750246763, "env_runner_sampling_timer": 1.4143381250323728, "learner_update_timer": 0.10182204109150916, "synch_weights": 0.0005221250467002392}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1221979246585796e-06, "add_states_from_episodes_to_batch": 1.7245791903311455e-06, "add_time_dim_to_batch_and_zero_pad": 2.4911204173878517e-06, "batch_individual_items": 6.38610199272694e-06, "numpy_to_tensor": 8.759119288369247e-06}}, "connector_pipeline_timer": 4.5486151397038486e-05}, "episode_duration_sec_mean": 0.0047775352848693714, "num_env_steps_sampled_lifetime": 627500.0, "module_episode_returns_mean": {"default_policy": -4.459999999999999}, "num_episodes_lifetime": 31375.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010762725770215991, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.705065294294125e-07, "normalize_and_clip_actions": 1.2369824348509313e-05, "get_actions": 4.040607780858506e-05, "listify_data_for_vector_env": 1.0857361671017082e-05, "un_batch_to_individual_items": 5.403338813052081e-06, "tensor_to_numpy": 1.2737186220047637e-05}}}, "episode_return_mean": -4.459999999999999, "rlmodule_inference_timer": 4.885322329704481e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 0.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -4.459999999999999}, "sample": 0.005418542763717315, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_step_timer": 1.4081776073756887e-05, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 6.997478096047274e-05, "time_between_sampling": 0.0004883958527485729, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3655.363551508888}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 6000, "gradients_default_optimizer_global_norm": 0.01337447576224804, "vf_loss": 0.1004081591963768, "curr_kl_coeff": 0.3732481598854065, "vf_loss_unclipped": 30.21761131286621, "entropy": 0.6885641813278198, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.02556947059929371, "total_loss": 0.035620804876089096, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0003655994951259345, "vf_explained_var": -0.013725519180297852, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 450073.61684133555}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.030184292001649737, "add_states_from_episodes_to_batch": 3.374996595084667e-06, "add_time_dim_to_batch_and_zero_pad": 1.166702713817358e-05, "numpy_to_tensor": 6.96659553796053e-05, "add_columns_from_episodes_to_train_batch": 0.033384416019544005, "add_one_ts_to_episodes_and_truncate": 0.008314959006384015, "add_observations_from_episodes_to_batch": 0.0008003750117495656, "general_advantage_estimation": 0.006160458899103105}}, "connector_pipeline_timer": 0.07904662494547665}, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2342410.4089588425, "num_module_steps_trained_throughput": 448731.19782284764, "num_module_steps_trained_lifetime_throughput": 447817.8938004046}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.82948895800839e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8557646397137265e-06, "add_time_dim_to_batch_and_zero_pad": 2.1962565496643435e-06, "batch_individual_items": 6.231605327038128e-06, "add_states_from_episodes_to_batch": 1.598267922849095e-06, "numpy_to_tensor": 8.336599184841293e-06}}, "connector_pipeline_timer": 4.401862281116481e-05}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "module_episode_returns_mean": {"default_policy": 4.6}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010507015380368867, "timers": {"connectors": {"un_batch_to_individual_items": 5.356070542351132e-06, "normalize_and_clip_actions": 1.0366592378386036e-05, "tensor_to_numpy": 1.4040640920848845e-05, "remove_single_ts_time_rank_from_batch": 5.814457882437461e-07, "get_actions": 3.842265817606281e-05, "listify_data_for_vector_env": 1.0817615017202665e-05}}}, "env_reset_timer": 0.0001700409920886159, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 5400, "episode_return_mean": 4.6, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "weights_seq_no": 1.0, "sample": 0.09664454206358641, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 4.6}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.4248943649437395e-05, "episode_len_max": 20, "num_episodes_lifetime": 20, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_duration_sec_mean": 0.004431243689032272}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "46945_00000", "date": "2025-08-11_19-36-11", "timestamp": 1754933771, "time_this_iter_s": 1.6237080097198486, "time_total_s": 1.6237080097198486, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.6237080097198486, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.23333333333333, "ram_util_percent": 74.60000000000001}}
{"timers": {"training_iteration": 1.519759999915259, "restore_env_runners": 8.97203222848475e-06, "training_step": 1.5196163266943767, "env_runner_sampling_timer": 1.4139947675319853, "learner_update_timer": 0.10266373943071812, "synch_weights": 0.0005217929661739618, "restore_eval_env_runners": 8.584000170230865e-06, "evaluation_iteration": 0.102764124982059, "synch_eval_env_connectors": 0.00011999998241662979, "synch_env_connectors": 4.500034265220165e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9721082172217985e-06, "add_states_from_episodes_to_batch": 1.7943346142624742e-06, "add_time_dim_to_batch_and_zero_pad": 2.500223580671481e-06, "batch_individual_items": 6.429781773629658e-06, "numpy_to_tensor": 8.640761244772546e-06}}, "connector_pipeline_timer": 4.400895908643897e-05}, "episode_duration_sec_mean": 0.004560201501008123, "num_env_steps_sampled_lifetime": 10000.0, "module_episode_returns_mean": {"default_policy": -5.5}, "num_episodes_lifetime": 500.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010395102373088088, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.747150153257131e-07, "normalize_and_clip_actions": 9.521135589837263e-06, "get_actions": 3.800940885913554e-05, "listify_data_for_vector_env": 1.1135426158627066e-05, "un_batch_to_individual_items": 5.4284054246798614e-06, "tensor_to_numpy": 1.3437384186936928e-05}}}, "episode_return_mean": -5.5, "rlmodule_inference_timer": 2.8132604717279673e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 1.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -5.5}, "sample": 0.005076729644505804, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4014458278111767e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.3505555914487436e-05, "time_between_sampling": 0.0014230760323328253, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3820.621142258064}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 12000, "gradients_default_optimizer_global_norm": 0.0885528028011322, "vf_loss": 0.10040832310914993, "curr_kl_coeff": 0.18662407994270325, "vf_loss_unclipped": 30.189531326293945, "entropy": 0.6920790672302246, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.11839213222265244, "total_loss": -0.05691200867295265, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0015927486820146441, "vf_explained_var": -0.013575196266174316, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 449855.9308991427}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0311161628307309, "add_states_from_episodes_to_batch": 3.3745856489986183e-06, "add_time_dim_to_batch_and_zero_pad": 1.1676606955006718e-05, "numpy_to_tensor": 6.962638581171632e-05, "add_columns_from_episodes_to_train_batch": 0.03340217394870706, "add_one_ts_to_episodes_and_truncate": 0.008307441916549578, "add_observations_from_episodes_to_batch": 0.000800966671667993, "general_advantage_estimation": 0.006153635559603572}}, "connector_pipeline_timer": 0.07998230285593308}, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 63000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2341565.4506346085, "num_module_steps_trained_throughput": 448541.82190447196, "num_module_steps_trained_lifetime_throughput": 447637.8105956404}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.627145634023785e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7533232253003577e-06, "add_time_dim_to_batch_and_zero_pad": 2.114345278205099e-06, "batch_individual_items": 6.065205779688338e-06, "add_states_from_episodes_to_batch": 1.5520599392548167e-06, "numpy_to_tensor": 8.162408877796007e-06}}, "connector_pipeline_timer": 4.196684208609385e-05}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "module_episode_returns_mean": {"default_policy": 2.6}, "module_to_env_connector": {"connector_pipeline_timer": 9.709639745639656e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.215486032335512e-06, "normalize_and_clip_actions": 9.177620523391607e-06, "tensor_to_numpy": 1.2385746854084319e-05, "remove_single_ts_time_rank_from_batch": 5.769625847976527e-07, "get_actions": 3.38377961188613e-05, "listify_data_for_vector_env": 1.0668593773529731e-05}}}, "env_reset_timer": 0.0001690984924789518, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 10400, "episode_return_mean": 2.6, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "weights_seq_no": 2.0, "sample": 0.09662818873301147, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.6}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3633072564351397e-05, "episode_len_max": 20, "num_episodes_lifetime": 40, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_duration_sec_mean": 0.0043988749413983895, "time_between_sampling": 1.5958400840172544}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "46945_00000", "date": "2025-08-11_19-36-13", "timestamp": 1754933773, "time_this_iter_s": 1.670701026916504, "time_total_s": 3.2944090366363525, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.2944090366363525, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.65, "ram_util_percent": 74.6}}
{"timers": {"training_iteration": 1.5216286978267481, "restore_env_runners": 8.940641803201289e-06, "training_step": 1.5214842034279834, "env_runner_sampling_timer": 1.4159168144367518, "learner_update_timer": 0.10260041453680023, "synch_weights": 0.0005265167070901953, "restore_eval_env_runners": 8.582329610362648e-06, "evaluation_iteration": 0.10273155957227573, "synch_eval_env_connectors": 0.00012007581302896142, "synch_env_connectors": 4.495454486459493e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.276326606708294e-06, "add_states_from_episodes_to_batch": 1.8490313218449277e-06, "add_time_dim_to_batch_and_zero_pad": 3.0265734201021167e-06, "batch_individual_items": 7.159657455469759e-06, "numpy_to_tensor": 1.4938165709558288e-05}}, "connector_pipeline_timer": 5.361034643588132e-05}, "episode_duration_sec_mean": 0.0053239061897620565, "num_env_steps_sampled_lifetime": -607500.0, "module_episode_returns_mean": {"default_policy": -3.100000000000002}, "num_episodes_lifetime": -30375.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00011885199346666208, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.172114689700754e-07, "normalize_and_clip_actions": 1.1566911446974898e-05, "get_actions": 4.5724082359702105e-05, "listify_data_for_vector_env": 1.228964618224013e-05, "un_batch_to_individual_items": 6.118000504586286e-06, "tensor_to_numpy": 1.455202105316878e-05}}}, "episode_return_mean": -3.100000000000002, "rlmodule_inference_timer": 3.3408594329740034e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 2.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -3.100000000000002}, "sample": 0.005380973627581278, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.5925845624269834e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.787692832431643e-05, "time_between_sampling": 0.0018499627143728195, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3511.840011080222}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 18000, "gradients_default_optimizer_global_norm": 0.024950962513685226, "vf_loss": 0.09986981749534607, "curr_kl_coeff": 0.09331203997135162, "vf_loss_unclipped": 28.8149471282959, "entropy": 0.6908020377159119, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.07973822951316833, "total_loss": -0.01838073693215847, "num_module_steps_trained": 6000, "mean_kl_loss": 0.004396282602101564, "vf_explained_var": -0.012913346290588379, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 450111.7696420525}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03110708078314783, "add_states_from_episodes_to_batch": 3.3733394579030572e-06, "add_time_dim_to_batch_and_zero_pad": 1.1860681360121815e-05, "numpy_to_tensor": 6.953137216623871e-05, "add_columns_from_episodes_to_train_batch": 0.03341438095847843, "add_one_ts_to_episodes_and_truncate": 0.008301456666446756, "add_observations_from_episodes_to_batch": 0.0008011495050508528, "general_advantage_estimation": 0.006164998364448547}}, "connector_pipeline_timer": 0.07999080274713924}, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 94500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2343421.007263915, "num_module_steps_trained_throughput": 448845.44425534655, "num_module_steps_trained_lifetime_throughput": 447957.22978124325}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.6549107052877603e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7833930944428822e-06, "add_time_dim_to_batch_and_zero_pad": 2.184775846524297e-06, "batch_individual_items": 6.100131048194056e-06, "add_states_from_episodes_to_batch": 1.5976347305867193e-06, "numpy_to_tensor": 8.199270138845172e-06}}, "connector_pipeline_timer": 4.213280961430807e-05}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "module_episode_returns_mean": {"default_policy": 1.6}, "module_to_env_connector": {"connector_pipeline_timer": 9.753953140551827e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.21646560944884e-06, "normalize_and_clip_actions": 9.232594965791856e-06, "tensor_to_numpy": 1.2434036375707605e-05, "remove_single_ts_time_rank_from_batch": 5.743357089237014e-07, "get_actions": 3.434882638875703e-05, "listify_data_for_vector_env": 1.0564651395866625e-05}}}, "env_reset_timer": 0.00017194250716129317, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 15400, "episode_return_mean": 1.6, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "weights_seq_no": 3.0, "sample": 0.09664653976568952, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.6}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3643086552142713e-05, "episode_len_max": 20, "num_episodes_lifetime": 60, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_duration_sec_mean": 0.004430083280506854, "time_between_sampling": 1.5971371085976716}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "46945_00000", "date": "2025-08-11_19-36-15", "timestamp": 1754933775, "time_this_iter_s": 1.8145558834075928, "time_total_s": 5.108964920043945, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.108964920043945, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.76666666666667, "ram_util_percent": 76.10000000000001}}
{"timers": {"training_iteration": 1.5217182787677133, "restore_env_runners": 8.905815544654616e-06, "training_step": 1.5215735026443753, "env_runner_sampling_timer": 1.4161319412928368, "learner_update_timer": 0.10247304330153482, "synch_weights": 0.000526607379404013, "restore_eval_env_runners": 8.863176160957664e-06, "evaluation_iteration": 0.10276241147627588, "synch_eval_env_connectors": 0.00012096796489786356, "synch_env_connectors": 4.494249983690678e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9918845961288576e-06, "add_states_from_episodes_to_batch": 1.7166404358702178e-06, "add_time_dim_to_batch_and_zero_pad": 2.4158349275386575e-06, "batch_individual_items": 6.257863518120731e-06, "numpy_to_tensor": 8.373181014207042e-06}}, "connector_pipeline_timer": 4.2991240436505967e-05}, "episode_duration_sec_mean": 0.004416530711576341, "num_env_steps_sampled_lifetime": -1225000.0, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "num_episodes_lifetime": -61250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010021840544699523, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.794013523642826e-07, "normalize_and_clip_actions": 9.323847664042759e-06, "get_actions": 3.680661213014626e-05, "listify_data_for_vector_env": 1.076893017541164e-05, "un_batch_to_individual_items": 5.326268529960299e-06, "tensor_to_numpy": 1.2588085381148453e-05}}}, "episode_return_mean": -1.9799999999999998, "rlmodule_inference_timer": 2.6793707386199366e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 3.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "sample": 0.005158459700972868, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3517622766463601e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.7249986453958817e-05, "time_between_sampling": 0.0018764685979286721, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3782.7433433747233}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 24000, "gradients_default_optimizer_global_norm": 0.022418634966015816, "vf_loss": 0.1000857725739479, "curr_kl_coeff": 0.04665601998567581, "vf_loss_unclipped": 29.42681121826172, "entropy": 0.6751035451889038, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": 0.09290732443332672, "total_loss": 0.15422971546649933, "num_module_steps_trained": 6000, "mean_kl_loss": 0.005344749428331852, "vf_explained_var": -0.01295316219329834, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 450710.1072546496}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.031100419565633287, "add_states_from_episodes_to_batch": 3.3733560292748734e-06, "add_time_dim_to_batch_and_zero_pad": 1.1827074029599315e-05, "numpy_to_tensor": 6.932605868321842e-05, "add_columns_from_episodes_to_train_batch": 0.03341327297930198, "add_one_ts_to_episodes_and_truncate": 0.00829411959919019, "add_observations_from_episodes_to_batch": 0.0008009913398805073, "general_advantage_estimation": 0.006156816301319748}}, "connector_pipeline_timer": 0.07996673137926322}, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 126000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2347201.928298115, "num_module_steps_trained_throughput": 449503.3456150451, "num_module_steps_trained_lifetime_throughput": 448634.744502711}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.6431111619073378e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7998342170711044e-06, "add_time_dim_to_batch_and_zero_pad": 2.180048735720508e-06, "batch_individual_items": 6.089120612132327e-06, "add_states_from_episodes_to_batch": 1.5943564678716794e-06, "numpy_to_tensor": 8.10378630947539e-06}}, "connector_pipeline_timer": 4.2213353234128515e-05}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "module_episode_returns_mean": {"default_policy": 1.6}, "module_to_env_connector": {"connector_pipeline_timer": 9.791365730560232e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.286280055571783e-06, "normalize_and_clip_actions": 9.242306529118793e-06, "tensor_to_numpy": 1.2409583599344724e-05, "remove_single_ts_time_rank_from_batch": 5.926941131963349e-07, "get_actions": 3.415984445190581e-05, "listify_data_for_vector_env": 1.0710705918966657e-05}}}, "env_reset_timer": 0.0001709447523112176, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 20400, "episode_return_mean": 1.6, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "weights_seq_no": 4.0, "sample": 0.0966432201977698, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.6}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3695801550233483e-05, "episode_len_max": 20, "num_episodes_lifetime": 80, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_duration_sec_mean": 0.004427665610273834, "time_between_sampling": 1.5966341437616967}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "46945_00000", "date": "2025-08-11_19-36-17", "timestamp": 1754933777, "time_this_iter_s": 1.6335558891296387, "time_total_s": 6.742520809173584, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.742520809173584, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.3, "ram_util_percent": 76.1}}
{"timers": {"training_iteration": 1.5216498763992945, "restore_env_runners": 8.868417852421989e-06, "training_step": 1.521504940116914, "env_runner_sampling_timer": 1.4161914277197767, "learner_update_timer": 0.10234499994890464, "synch_weights": 0.0005265050550570652, "restore_eval_env_runners": 8.87079425912816e-06, "evaluation_iteration": 0.1027438719415136, "synch_eval_env_connectors": 0.00012076578535349107, "synch_env_connectors": 4.48847774718888e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9090552800799123e-06, "add_states_from_episodes_to_batch": 1.7023367902880018e-06, "add_time_dim_to_batch_and_zero_pad": 2.38935280058306e-06, "batch_individual_items": 6.199158267782767e-06, "numpy_to_tensor": 8.296934893443527e-06}}, "connector_pipeline_timer": 4.269872993820021e-05}, "episode_duration_sec_mean": 0.004755063808057457, "num_env_steps_sampled_lifetime": -1842500.0, "module_episode_returns_mean": {"default_policy": -2.6200000000000006}, "num_episodes_lifetime": -92125.0, "module_to_env_connector": {"connector_pipeline_timer": 9.986176642419867e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.626130929168615e-07, "normalize_and_clip_actions": 9.226560512361705e-06, "get_actions": 3.6811809014477e-05, "listify_data_for_vector_env": 1.0744252782829725e-05, "un_batch_to_individual_items": 5.2845493979105565e-06, "tensor_to_numpy": 1.2520595745755547e-05}}}, "episode_return_mean": -2.6200000000000006, "rlmodule_inference_timer": 4.505549600629824e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 4.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.6200000000000006}, "sample": 0.004778623550084624, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3460924920546585e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.067296247617333e-05, "time_between_sampling": 0.0015531549043350423, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3853.169539730802}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 30000, "gradients_default_optimizer_global_norm": 0.3873364329338074, "vf_loss": 0.09976178407669067, "curr_kl_coeff": 0.023328009992837906, "vf_loss_unclipped": 28.310836791992188, "entropy": 0.6418144702911377, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.08939778804779053, "total_loss": -0.028190553188323975, "num_module_steps_trained": 6000, "mean_kl_loss": 0.006403516978025436, "vf_explained_var": -0.012333512306213379, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 451260.75021240354}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03109094244940457, "add_states_from_episodes_to_batch": 3.3650417545030355e-06, "add_time_dim_to_batch_and_zero_pad": 1.1790054199019214e-05, "numpy_to_tensor": 6.910737796149914e-05, "add_columns_from_episodes_to_train_batch": 0.03341079899958295, "add_one_ts_to_episodes_and_truncate": 0.008285786743126378, "add_observations_from_episodes_to_batch": 0.0008008251765450322, "general_advantage_estimation": 0.006147548967281245}}, "connector_pipeline_timer": 0.07993635198486339}, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 157500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2350840.6403662516, "num_module_steps_trained_throughput": 450122.8397582816, "num_module_steps_trained_lifetime_throughput": 449276.82217539806}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.6299651002540168e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.759414363173942e-06, "add_time_dim_to_batch_and_zero_pad": 2.142322392897379e-06, "batch_individual_items": 6.046688023800164e-06, "add_states_from_episodes_to_batch": 1.5941016869351308e-06, "numpy_to_tensor": 8.10200049947622e-06}}, "connector_pipeline_timer": 4.188354562722351e-05}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "module_episode_returns_mean": {"default_policy": 1.2}, "module_to_env_connector": {"connector_pipeline_timer": 9.724579748384724e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.1042081684107375e-06, "normalize_and_clip_actions": 9.16367407211586e-06, "tensor_to_numpy": 1.2384009726598133e-05, "remove_single_ts_time_rank_from_batch": 5.647571518266099e-07, "get_actions": 3.412632577827212e-05, "listify_data_for_vector_env": 1.0611429729250825e-05}}}, "env_reset_timer": 0.0001700386357012915, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 25400, "episode_return_mean": 1.2, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "weights_seq_no": 5.0, "sample": 0.09662952382542483, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.2}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3694548998025073e-05, "episode_len_max": 20, "num_episodes_lifetime": 100, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_duration_sec_mean": 0.004416820008773356, "time_between_sampling": 1.5959742694038699}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "46945_00000", "date": "2025-08-11_19-36-18", "timestamp": 1754933778, "time_this_iter_s": 1.6167678833007812, "time_total_s": 8.359288692474365, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.359288692474365, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.1, "ram_util_percent": 75.69999999999999}}
{"timers": {"training_iteration": 1.5214411513848318, "restore_env_runners": 8.836403488409901e-06, "training_step": 1.5212961511359406, "env_runner_sampling_timer": 1.4151977596927128, "learner_update_timer": 0.10312713369908054, "synch_weights": 0.0005269012548314143, "restore_eval_env_runners": 8.84083647285006e-06, "evaluation_iteration": 0.1027146211428756, "synch_eval_env_connectors": 0.00012049312647043493, "synch_env_connectors": 4.479423277468885e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.89740588149668e-06, "add_states_from_episodes_to_batch": 1.6953942785074112e-06, "add_time_dim_to_batch_and_zero_pad": 2.381574455741418e-06, "batch_individual_items": 6.130965354984031e-06, "numpy_to_tensor": 8.215140320794384e-06}}, "connector_pipeline_timer": 4.2258081733136495e-05}, "episode_duration_sec_mean": 0.004350419311318547, "num_env_steps_sampled_lifetime": -2460000.0, "module_episode_returns_mean": {"default_policy": 0.26}, "num_episodes_lifetime": -123000.0, "module_to_env_connector": {"connector_pipeline_timer": 9.885321862299175e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.595735855412155e-07, "normalize_and_clip_actions": 9.171528899062133e-06, "get_actions": 3.629875226098461e-05, "listify_data_for_vector_env": 1.0616460087577364e-05, "un_batch_to_individual_items": 5.228260303197989e-06, "tensor_to_numpy": 1.2396106713788645e-05}}}, "episode_return_mean": 0.26, "rlmodule_inference_timer": 2.670964152494445e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 5.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 0.26}, "sample": 0.004945686528150679, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3268972582432084e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 2.9949120440711367e-05, "time_between_sampling": 0.0014653362779597115, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3884.1195536860337}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 36000, "gradients_default_optimizer_global_norm": 0.12068164348602295, "vf_loss": 0.0991143062710762, "curr_kl_coeff": 0.011664004996418953, "vf_loss_unclipped": 26.507795333862305, "entropy": 0.6319625973701477, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.07772266864776611, "total_loss": -0.017150528728961945, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00032041617669165134, "vf_explained_var": -0.010851740837097168, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 451728.43140961806}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.031986413854591236, "add_states_from_episodes_to_batch": 3.3576406637235424e-06, "add_time_dim_to_batch_and_zero_pad": 1.176173408302163e-05, "numpy_to_tensor": 6.974672525524637e-05, "add_columns_from_episodes_to_train_batch": 0.033409546008583604, "add_one_ts_to_episodes_and_truncate": 0.008278253456234131, "add_observations_from_episodes_to_batch": 0.0008008823447496621, "general_advantage_estimation": 0.006139070557519143}}, "connector_pipeline_timer": 0.08081498971585362}, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 189000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2354087.911267907, "num_module_steps_trained_throughput": 450663.33528057876, "num_module_steps_trained_lifetime_throughput": 449841.4008481307}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.648838125343834e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7857834685536485e-06, "add_time_dim_to_batch_and_zero_pad": 2.1367212228565196e-06, "batch_individual_items": 6.0900990676249575e-06, "add_states_from_episodes_to_batch": 1.5838728462103477e-06, "numpy_to_tensor": 8.139535506224955e-06}}, "connector_pipeline_timer": 4.1971808984234265e-05}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "module_episode_returns_mean": {"default_policy": 1.0}, "module_to_env_connector": {"connector_pipeline_timer": 9.768375654882286e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.211723346061767e-06, "normalize_and_clip_actions": 9.148355068137999e-06, "tensor_to_numpy": 1.2450725465944397e-05, "remove_single_ts_time_rank_from_batch": 6.155677733860307e-07, "get_actions": 3.434124293541332e-05, "listify_data_for_vector_env": 1.0666057539125636e-05}}}, "env_reset_timer": 0.00016905657961023272, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 30400, "episode_return_mean": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "weights_seq_no": 6.0, "sample": 0.09662234192752976, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.0}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3684514327691956e-05, "episode_len_max": 20, "num_episodes_lifetime": 120, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_duration_sec_mean": 0.004411705455277115, "time_between_sampling": 1.5952295896198234}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "46945_00000", "date": "2025-08-11_19-36-20", "timestamp": 1754933780, "time_this_iter_s": 1.6034300327301025, "time_total_s": 9.962718725204468, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.962718725204468, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.06666666666667, "ram_util_percent": 75.03333333333333}}
{"timers": {"training_iteration": 1.5204193886210149, "restore_env_runners": 8.805539309282562e-06, "training_step": 1.5202742479655293, "env_runner_sampling_timer": 1.4143143229256714, "learner_update_timer": 0.10298843027141241, "synch_weights": 0.0005273114124185088, "restore_eval_env_runners": 8.8220083818243e-06, "evaluation_iteration": 0.1026929916018583, "synch_eval_env_connectors": 0.00012030903534206488, "synch_env_connectors": 4.4808785237496e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9238196763866173e-06, "add_states_from_episodes_to_batch": 1.7136878960592783e-06, "add_time_dim_to_batch_and_zero_pad": 2.3937251198179215e-06, "batch_individual_items": 6.219948465348642e-06, "numpy_to_tensor": 8.328926970317089e-06}}, "connector_pipeline_timer": 4.2710988194228875e-05}, "episode_duration_sec_mean": 0.0043920152769424, "num_env_steps_sampled_lifetime": -3077500.0, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "num_episodes_lifetime": -153875.0, "module_to_env_connector": {"connector_pipeline_timer": 9.93150549848073e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.640504822501061e-07, "normalize_and_clip_actions": 9.223903252652848e-06, "get_actions": 3.630881192342605e-05, "listify_data_for_vector_env": 1.0735919150360566e-05, "un_batch_to_individual_items": 5.293593128444362e-06, "tensor_to_numpy": 1.2490570970856682e-05}}}, "episode_return_mean": 0.17999999999999997, "rlmodule_inference_timer": 2.6623160980994694e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 6.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "sample": 0.004691071403378805, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3434661710736703e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 2.9003114931373873e-05, "time_between_sampling": 0.0017818766475700563, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3871.8437885387375}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 42000, "gradients_default_optimizer_global_norm": 0.1225818544626236, "vf_loss": 0.09954539686441422, "curr_kl_coeff": 0.0058320024982094765, "vf_loss_unclipped": 27.996871948242188, "entropy": 0.6225767731666565, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": 0.11239685118198395, "total_loss": 0.1733374446630478, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00022236791846808046, "vf_explained_var": -0.012020707130432129, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 452681.73444354313}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.031970016796275216, "add_states_from_episodes_to_batch": 3.3503147480050628e-06, "add_time_dim_to_batch_and_zero_pad": 1.1725366487754085e-05, "numpy_to_tensor": 6.953508824450815e-05, "add_columns_from_episodes_to_train_batch": 0.033408573878990294, "add_one_ts_to_episodes_and_truncate": 0.008273351341229704, "add_observations_from_episodes_to_batch": 0.0008008826917170455, "general_advantage_estimation": 0.006128163181631219}}, "connector_pipeline_timer": 0.08078116814782982}, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 220500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2359905.6510611945, "num_module_steps_trained_throughput": 451691.84736137796, "num_module_steps_trained_lifetime_throughput": 450894.36219991196}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.6115042024970346e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7840102293750184e-06, "add_time_dim_to_batch_and_zero_pad": 2.13770930476198e-06, "batch_individual_items": 6.083189455101543e-06, "add_states_from_episodes_to_batch": 1.5576333931545897e-06, "numpy_to_tensor": 8.113719712639703e-06}}, "connector_pipeline_timer": 4.2074488821152925e-05}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "module_episode_returns_mean": {"default_policy": 1.6}, "module_to_env_connector": {"connector_pipeline_timer": 9.72560346792646e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.1465939498119505e-06, "normalize_and_clip_actions": 9.183030053107403e-06, "tensor_to_numpy": 1.2416118784909043e-05, "remove_single_ts_time_rank_from_batch": 5.64258056061152e-07, "get_actions": 3.418066901481646e-05, "listify_data_for_vector_env": 1.0634801972872929e-05}}}, "env_reset_timer": 0.00016803018301575777, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 35400, "episode_return_mean": 1.6, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "weights_seq_no": 7.0, "sample": 0.09661075309856172, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.6}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3723899084881515e-05, "episode_len_max": 20, "num_episodes_lifetime": 140, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_duration_sec_mean": 0.004414996281266213, "time_between_sampling": 1.5936472883036725}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "46945_00000", "date": "2025-08-11_19-36-21", "timestamp": 1754933781, "time_this_iter_s": 1.5212957859039307, "time_total_s": 11.484014511108398, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.484014511108398, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.05, "ram_util_percent": 74.95}}
{"timers": {"training_iteration": 1.520302185985087, "restore_env_runners": 8.776654331814713e-06, "training_step": 1.520156844235797, "env_runner_sampling_timer": 1.4143151617766918, "learner_update_timer": 0.10286819054821315, "synch_weights": 0.000527670798691365, "restore_eval_env_runners": 8.79086905860424e-06, "evaluation_iteration": 0.10266564043676485, "synch_eval_env_connectors": 0.00011999886564104865, "synch_env_connectors": 4.472319141422575e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0172912368829318e-06, "add_states_from_episodes_to_batch": 1.7259533671649868e-06, "add_time_dim_to_batch_and_zero_pad": 2.410675585207978e-06, "batch_individual_items": 6.252690622189481e-06, "numpy_to_tensor": 8.300303774700375e-06}}, "connector_pipeline_timer": 4.2998237915628514e-05}, "episode_duration_sec_mean": 0.004743843666277825, "num_env_steps_sampled_lifetime": -3695000.0, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "num_episodes_lifetime": -184750.0, "module_to_env_connector": {"connector_pipeline_timer": 9.991554888515943e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.630700445708867e-07, "normalize_and_clip_actions": 9.294438012086553e-06, "get_actions": 3.650863782468732e-05, "listify_data_for_vector_env": 1.0796548562397958e-05, "un_batch_to_individual_items": 5.360796967279835e-06, "tensor_to_numpy": 1.2542371727620488e-05}}}, "episode_return_mean": 1.0600000000000005, "rlmodule_inference_timer": 4.197585299418739e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 7.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "sample": 0.004959770277721178, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3431048325848993e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 2.933768237422915e-05, "time_between_sampling": 0.0014594688716296615, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3839.9455339981123}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 48000, "gradients_default_optimizer_global_norm": 0.04937148466706276, "vf_loss": 0.09922180324792862, "curr_kl_coeff": 0.0029160012491047382, "vf_loss_unclipped": 26.816692352294922, "entropy": 0.6227813363075256, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": 0.03571588546037674, "total_loss": 0.09643588215112686, "num_module_steps_trained": 6000, "mean_kl_loss": 4.653878204408102e-05, "vf_explained_var": -0.011062145233154297, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 453986.09978175035}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03196092662789091, "add_states_from_episodes_to_batch": 3.3451412690915965e-06, "add_time_dim_to_batch_and_zero_pad": 1.1696442948312731e-05, "numpy_to_tensor": 6.935389727244391e-05, "add_columns_from_episodes_to_train_batch": 0.03341077272992128, "add_one_ts_to_episodes_and_truncate": 0.008265617828469332, "add_observations_from_episodes_to_batch": 0.0008033842847609401, "general_advantage_estimation": 0.006122686970085095}}, "connector_pipeline_timer": 0.08076301729640223}, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 252000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2367610.580348077, "num_module_steps_trained_throughput": 453077.94776898413, "num_module_steps_trained_lifetime_throughput": 452305.0018618295}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.617801908037497e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8462005949257903e-06, "add_time_dim_to_batch_and_zero_pad": 2.147353596057642e-06, "batch_individual_items": 6.157822723685556e-06, "add_states_from_episodes_to_batch": 1.5791081606997352e-06, "numpy_to_tensor": 8.193927487292185e-06}}, "connector_pipeline_timer": 4.2550592184735314e-05}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "module_episode_returns_mean": {"default_policy": 2.4}, "module_to_env_connector": {"connector_pipeline_timer": 9.781609651622872e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.19864959844488e-06, "normalize_and_clip_actions": 9.207152768135468e-06, "tensor_to_numpy": 1.2479096948801762e-05, "remove_single_ts_time_rank_from_batch": 5.691198361567992e-07, "get_actions": 3.431711395885252e-05, "listify_data_for_vector_env": 1.0652479472695761e-05}}}, "env_reset_timer": 0.0001670961313381881, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 40400, "episode_return_mean": 2.4, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "weights_seq_no": 8.0, "sample": 0.09660481098812322, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.4}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.367063237808951e-05, "episode_len_max": 20, "num_episodes_lifetime": 160, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_duration_sec_mean": 0.004399876319803297, "time_between_sampling": 1.5929590645903078}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "46945_00000", "date": "2025-08-11_19-36-23", "timestamp": 1754933783, "time_this_iter_s": 1.6112630367279053, "time_total_s": 13.095277547836304, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.095277547836304, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.05, "ram_util_percent": 75.0}}
{"timers": {"training_iteration": 1.5201588299555762, "restore_env_runners": 8.738888169221234e-06, "training_step": 1.52001349246257, "env_runner_sampling_timer": 1.4134465934981504, "learner_update_timer": 0.10359335030225084, "synch_weights": 0.0005279036704914821, "restore_eval_env_runners": 8.76629030309205e-06, "evaluation_iteration": 0.10264302944247894, "synch_eval_env_connectors": 0.00011977637686080953, "synch_env_connectors": 4.4696859096148775e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9073186632451916e-06, "add_states_from_episodes_to_batch": 1.7118080466004473e-06, "add_time_dim_to_batch_and_zero_pad": 2.385479932273558e-06, "batch_individual_items": 6.212605615459971e-06, "numpy_to_tensor": 8.282819608632326e-06}}, "connector_pipeline_timer": 4.26788567863865e-05}, "episode_duration_sec_mean": 0.004398523857817053, "num_env_steps_sampled_lifetime": -4312500.0, "module_episode_returns_mean": {"default_policy": 1.5399999999999994}, "num_episodes_lifetime": -215625.0, "module_to_env_connector": {"connector_pipeline_timer": 9.951664042769646e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.639750862855747e-07, "normalize_and_clip_actions": 9.244213062985332e-06, "get_actions": 3.6454181482929955e-05, "listify_data_for_vector_env": 1.0706309812398243e-05, "un_batch_to_individual_items": 5.271100880415661e-06, "tensor_to_numpy": 1.2490302023963208e-05}}}, "episode_return_mean": 1.5399999999999994, "rlmodule_inference_timer": 2.6884949876789792e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 8.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 1.5399999999999994}, "sample": 0.004758164679634671, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3422688750895761e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 2.941938523923398e-05, "time_between_sampling": 0.0014381953072729904, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3865.9871284811807}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 54000, "gradients_default_optimizer_global_norm": 0.059552472084760666, "vf_loss": 0.09900609403848648, "curr_kl_coeff": 0.0014580006245523691, "vf_loss_unclipped": 26.217327117919922, "entropy": 0.6220744848251343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.0015838929684832692, "total_loss": 0.05899802967905998, "num_module_steps_trained": 6000, "mean_kl_loss": 2.5744730010046624e-05, "vf_explained_var": -0.010414361953735352, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 455356.9249456624}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0319523544424401, "add_states_from_episodes_to_batch": 3.3383501292522667e-06, "add_time_dim_to_batch_and_zero_pad": 1.1678649239034315e-05, "numpy_to_tensor": 6.923452798019565e-05, "add_columns_from_episodes_to_train_batch": 0.0334111145923402, "add_one_ts_to_episodes_and_truncate": 0.009108745819415249, "add_observations_from_episodes_to_batch": 0.000803732942295471, "general_advantage_estimation": 0.006112776350267046}}, "connector_pipeline_timer": 0.08158798753381395}, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 283500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2375659.1784619363, "num_module_steps_trained_throughput": 454530.31767592207, "num_module_steps_trained_lifetime_throughput": 453781.50685194903}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.5989997154680232e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7920535290185125e-06, "add_time_dim_to_batch_and_zero_pad": 2.1586028786779555e-06, "batch_individual_items": 6.09204231625627e-06, "add_states_from_episodes_to_batch": 1.5748150777873564e-06, "numpy_to_tensor": 8.246740237068484e-06}}, "connector_pipeline_timer": 4.219300605815038e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.4}, "module_to_env_connector": {"connector_pipeline_timer": 9.797452591091465e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.2548354739113265e-06, "normalize_and_clip_actions": 9.209479262388918e-06, "tensor_to_numpy": 1.2572773748153469e-05, "remove_single_ts_time_rank_from_batch": 5.635828257846975e-07, "get_actions": 3.430728315535619e-05, "listify_data_for_vector_env": 1.0737485120666078e-05}}}, "env_reset_timer": 0.00016612975047709938, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 45400, "episode_return_mean": 2.4, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "weights_seq_no": 9.0, "sample": 0.09659465829770737, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.4}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3741866144918276e-05, "episode_len_max": 20, "num_episodes_lifetime": 180, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_duration_sec_mean": 0.004394147170241922, "time_between_sampling": 1.5922493564452282}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "46945_00000", "date": "2025-08-11_19-36-25", "timestamp": 1754933785, "time_this_iter_s": 1.6081931591033936, "time_total_s": 14.703470706939697, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.703470706939697, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.55, "ram_util_percent": 75.0}}
{"timers": {"training_iteration": 1.5764603912366966, "restore_env_runners": 8.70441936452511e-06, "training_step": 1.5763146158783754, "env_runner_sampling_timer": 1.4676403392327462, "learner_update_timer": 0.10569177970870552, "synch_weights": 0.0005300271336914235, "restore_eval_env_runners": 8.741537075823186e-06, "evaluation_iteration": 0.10261759414841283, "synch_eval_env_connectors": 0.00011959736357350893, "synch_env_connectors": 4.464569095786668e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.4091389937162468e-05, "add_states_from_episodes_to_batch": 3.3561117620322855e-06, "add_time_dim_to_batch_and_zero_pad": 1.8372928038895412e-05, "batch_individual_items": 3.9102677316842314e-05, "numpy_to_tensor": 4.340684684001137e-05}}, "connector_pipeline_timer": 0.00022004321892420676}, "episode_duration_sec_mean": 0.018299873792100695, "num_env_steps_sampled_lifetime": -4930000.0, "module_episode_returns_mean": {"default_policy": 0.58}, "num_episodes_lifetime": -246500.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0004529501914868504, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.795027686409837e-07, "normalize_and_clip_actions": 2.9000506112323753e-05, "get_actions": 0.0001451595719819836, "listify_data_for_vector_env": 5.30293120468753e-05, "un_batch_to_individual_items": 9.671824347364442e-06, "tensor_to_numpy": 0.00012435936950887436}}}, "episode_return_mean": 0.58, "rlmodule_inference_timer": 0.00011141371616877012, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 9.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 0.58}, "sample": 0.013822354454636688, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.4299802716725065e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 8.614199102354769e-05, "time_between_sampling": 0.0050578816658428186, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2872.3940779111026}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 60000, "gradients_default_optimizer_global_norm": 0.019865432754158974, "vf_loss": 0.09900609403848648, "curr_kl_coeff": 0.0007290003122761846, "vf_loss_unclipped": 26.218334197998047, "entropy": 0.6069930195808411, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.08808911591768265, "total_loss": -0.027369648218154907, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0007112051243893802, "vf_explained_var": -0.010382890701293945, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 456131.56569615856}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03401931506741693, "add_states_from_episodes_to_batch": 3.3399657303137937e-06, "add_time_dim_to_batch_and_zero_pad": 1.1858533224481297e-05, "numpy_to_tensor": 6.924843254840185e-05, "add_columns_from_episodes_to_train_batch": 0.03344379969687188, "add_one_ts_to_episodes_and_truncate": 0.009124176280560335, "add_observations_from_episodes_to_batch": 0.0008061639428739747, "general_advantage_estimation": 0.006110324425864408}}, "connector_pipeline_timer": 0.08370333348916488}, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 315000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2380573.9451305335, "num_module_steps_trained_throughput": 455384.7441711528, "num_module_steps_trained_lifetime_throughput": 454661.3172492861}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.629990321724565e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.811509824505377e-06, "add_time_dim_to_batch_and_zero_pad": 2.178124025854264e-06, "batch_individual_items": 6.10792563202526e-06, "add_states_from_episodes_to_batch": 1.5545219247563522e-06, "numpy_to_tensor": 8.16399769387618e-06}}, "connector_pipeline_timer": 4.214432196657496e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.2}, "module_to_env_connector": {"connector_pipeline_timer": 9.756809411483241e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.161078200169655e-06, "normalize_and_clip_actions": 9.170160571820868e-06, "tensor_to_numpy": 1.240685458375679e-05, "remove_single_ts_time_rank_from_batch": 5.758648547886683e-07, "get_actions": 3.429373387631685e-05, "listify_data_for_vector_env": 1.0651970088157272e-05}}}, "env_reset_timer": 0.00017020678304598304, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 50400, "episode_return_mean": 3.2, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "weights_seq_no": 10.0, "sample": 0.09666715755438868, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.2}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3798212011875006e-05, "episode_len_max": 20, "num_episodes_lifetime": 200, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_duration_sec_mean": 0.004441522570559755, "time_between_sampling": 1.6481457095509884}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "46945_00000", "date": "2025-08-11_19-36-32", "timestamp": 1754933792, "time_this_iter_s": 7.275070905685425, "time_total_s": 21.978541612625122, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.978541612625122, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 74.26, "ram_util_percent": 81.86999999999999}}
{"timers": {"training_iteration": 1.5758430985740774, "restore_env_runners": 8.673624726080195e-06, "training_step": 1.5756966593000992, "env_runner_sampling_timer": 1.467093298760485, "learner_update_timer": 0.10560835066178753, "synch_weights": 0.0005323726912367415, "restore_eval_env_runners": 8.744541485527935e-06, "evaluation_iteration": 0.10281636820594262, "synch_eval_env_connectors": 0.00011934222015172293, "synch_env_connectors": 4.464923747481003e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0395769652608305e-06, "add_states_from_episodes_to_batch": 1.7643662521833964e-06, "add_time_dim_to_batch_and_zero_pad": 2.509792787027551e-06, "batch_individual_items": 6.473824908293436e-06, "numpy_to_tensor": 8.82258548878111e-06}}, "connector_pipeline_timer": 4.434296429073448e-05}, "episode_duration_sec_mean": 0.00464459814922884, "num_env_steps_sampled_lifetime": -5547500.0, "module_episode_returns_mean": {"default_policy": 2.42}, "num_episodes_lifetime": -277375.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010545106927512165, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.925638752695149e-07, "normalize_and_clip_actions": 9.711634502217813e-06, "get_actions": 3.923951283225256e-05, "listify_data_for_vector_env": 1.129131864323905e-05, "un_batch_to_individual_items": 5.566832784181732e-06, "tensor_to_numpy": 1.331200820918381e-05}}}, "episode_return_mean": 2.42, "rlmodule_inference_timer": 2.8992519066556314e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 10.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.42}, "sample": 0.010814872868126702, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4238778591829272e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 6.405227229944657e-05, "time_between_sampling": 0.005223634187231428, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3634.1990238351295}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 66000, "gradients_default_optimizer_global_norm": 0.04201570525765419, "vf_loss": 0.09868254512548447, "curr_kl_coeff": 0.0003645001561380923, "vf_loss_unclipped": 25.318986892700195, "entropy": 0.5904287099838257, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.04522467032074928, "total_loss": 0.015427875332534313, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0006328527233563364, "vf_explained_var": -0.009004473686218262, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 454758.92155656975}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03398936108695506, "add_states_from_episodes_to_batch": 3.338646643246504e-06, "add_time_dim_to_batch_and_zero_pad": 1.184494752760507e-05, "numpy_to_tensor": 6.920511847448102e-05, "add_columns_from_episodes_to_train_batch": 0.033454160449914415, "add_one_ts_to_episodes_and_truncate": 0.009110716188015905, "add_observations_from_episodes_to_batch": 0.000806331473206997, "general_advantage_estimation": 0.006104514511829995}}, "connector_pipeline_timer": 0.08366446181389581}, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 346500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2374077.828567999, "num_module_steps_trained_throughput": 454077.8015291859, "num_module_steps_trained_lifetime_throughput": 453376.23291060707}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 6.26177161187578e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.009639039099509e-06, "add_time_dim_to_batch_and_zero_pad": 6.965281753687556e-06, "batch_individual_items": 1.3150177763750535e-05, "add_states_from_episodes_to_batch": 2.7032593557177584e-06, "numpy_to_tensor": 3.37350781375101e-05}}, "connector_pipeline_timer": 0.00010252783379271187}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.0002762287984821023, "timers": {"connectors": {"un_batch_to_individual_items": 1.2323929082931087e-05, "normalize_and_clip_actions": 5.150801755569155e-05, "tensor_to_numpy": 2.6760675663402263e-05, "remove_single_ts_time_rank_from_batch": 1.0882442700639238e-06, "get_actions": 9.736867394469292e-05, "listify_data_for_vector_env": 2.9391110139994093e-05}}}, "env_reset_timer": 0.00016919471581291077, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 55400, "episode_return_mean": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "weights_seq_no": 11.0, "sample": 0.09742580764820913, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.0}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 3.399204809014506e-05, "episode_len_max": 20, "num_episodes_lifetime": 220, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_duration_sec_mean": 0.0051471742056310174, "time_between_sampling": 1.6470544274555445}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "46945_00000", "date": "2025-08-11_19-36-34", "timestamp": 1754933794, "time_this_iter_s": 1.6962809562683105, "time_total_s": 23.674822568893433, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.674822568893433, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.2, "ram_util_percent": 76.9}}
{"timers": {"training_iteration": 1.588845775927868, "restore_env_runners": 8.646467512223982e-06, "training_step": 1.5886974906163, "env_runner_sampling_timer": 1.479876625772675, "learner_update_timer": 0.10582281923482861, "synch_weights": 0.0005333014647857885, "restore_eval_env_runners": 8.755426272253776e-06, "evaluation_iteration": 0.10357901494452673, "synch_eval_env_connectors": 0.00012000629754221191, "synch_env_connectors": 4.478614884386543e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.9505224227321456e-06, "add_states_from_episodes_to_batch": 2.240181707345329e-06, "add_time_dim_to_batch_and_zero_pad": 3.4464628438900715e-06, "batch_individual_items": 1.0900037318928938e-05, "numpy_to_tensor": 1.535532995663885e-05}}, "connector_pipeline_timer": 6.843775889745789e-05}, "episode_duration_sec_mean": 0.007775612691417338, "num_env_steps_sampled_lifetime": -6165000.0, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "num_episodes_lifetime": -308250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00015780167927801272, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.229395704985793e-07, "normalize_and_clip_actions": 1.3643345064703092e-05, "get_actions": 6.698482387607467e-05, "listify_data_for_vector_env": 1.533660126237719e-05, "un_batch_to_individual_items": 7.09758734504815e-06, "tensor_to_numpy": 1.9454049220022342e-05}}}, "episode_return_mean": 1.8600000000000003, "rlmodule_inference_timer": 7.579050797130195e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 11.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "sample": 0.007895444460564647, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.987749537137258e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 5.61702990409191e-05, "time_between_sampling": 0.003756911599504374, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2932.1550102844985}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 72000, "gradients_default_optimizer_global_norm": 0.22185371816158295, "vf_loss": 0.09889824688434601, "curr_kl_coeff": 0.00018225007806904614, "vf_loss_unclipped": 26.199382781982422, "entropy": 0.548987865447998, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": 0.026909515261650085, "total_loss": 0.0880821943283081, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0027911753859370947, "vf_explained_var": -0.010240793228149414, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 453281.67728375737}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0340140995563946, "add_states_from_episodes_to_batch": 3.3369309651170563e-06, "add_time_dim_to_batch_and_zero_pad": 1.1845247501358585e-05, "numpy_to_tensor": 6.919514815277988e-05, "add_columns_from_episodes_to_train_batch": 0.03361837426597342, "add_one_ts_to_episodes_and_truncate": 0.009182995685832444, "add_observations_from_episodes_to_batch": 0.0008113956588990886, "general_advantage_estimation": 0.0061085831162996035}}, "connector_pipeline_timer": 0.0839349609461711}, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 378000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2367016.873157032, "num_module_steps_trained_throughput": 452662.91725894785, "num_module_steps_trained_lifetime_throughput": 451984.7685616426}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.513314591568961e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.467827003305578e-06, "add_time_dim_to_batch_and_zero_pad": 2.6153448666233236e-06, "batch_individual_items": 7.859746832722913e-06, "add_states_from_episodes_to_batch": 1.9967374697006794e-06, "numpy_to_tensor": 1.129464235430125e-05}}, "connector_pipeline_timer": 5.327252876586469e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.4}, "module_to_env_connector": {"connector_pipeline_timer": 0.00013035490872754938, "timers": {"connectors": {"un_batch_to_individual_items": 6.48851276485111e-06, "normalize_and_clip_actions": 1.2177073720182926e-05, "tensor_to_numpy": 1.6218967968574252e-05, "remove_single_ts_time_rank_from_batch": 6.574921617759824e-07, "get_actions": 4.752556448322892e-05, "listify_data_for_vector_env": 1.4116912547961675e-05}}}, "env_reset_timer": 0.00017091942912939495, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 60400, "episode_return_mean": 3.4, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "weights_seq_no": 12.0, "sample": 0.09772022957193909, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.4}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.779354795763802e-05, "episode_len_max": 20, "num_episodes_lifetime": 240, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_duration_sec_mean": 0.005428452553460374, "time_between_sampling": 1.659597610270612}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "46945_00000", "date": "2025-08-11_19-36-37", "timestamp": 1754933797, "time_this_iter_s": 3.0140111446380615, "time_total_s": 26.688833713531494, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.688833713531494, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 61.025000000000006, "ram_util_percent": 78.95}}
{"timers": {"training_iteration": 1.5920216631686683, "restore_env_runners": 8.616252392302079e-06, "training_step": 1.5918714011297406, "env_runner_sampling_timer": 1.4829827311845463, "learner_update_timer": 0.10588618729293056, "synch_weights": 0.0005341151209227319, "restore_eval_env_runners": 8.730371903360465e-06, "evaluation_iteration": 0.1038991152148813, "synch_eval_env_connectors": 0.00011981582549057595, "synch_env_connectors": 4.474668394592784e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4481820208438005e-06, "add_states_from_episodes_to_batch": 1.9146308403022573e-06, "add_time_dim_to_batch_and_zero_pad": 2.9589617781578137e-06, "batch_individual_items": 7.82096360044349e-06, "numpy_to_tensor": 1.1122008465108454e-05}}, "connector_pipeline_timer": 5.156838862814507e-05}, "episode_duration_sec_mean": 0.00550982614699751, "num_env_steps_sampled_lifetime": -6782500.0, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "num_episodes_lifetime": -339125.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0001269200926698668, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.597976992542173e-07, "normalize_and_clip_actions": 1.2403729262984859e-05, "get_actions": 4.9017469480767835e-05, "listify_data_for_vector_env": 1.2912886408997537e-05, "un_batch_to_individual_items": 6.446961502008796e-06, "tensor_to_numpy": 1.573157977643453e-05}}}, "episode_return_mean": 2.899999999999998, "rlmodule_inference_timer": 3.426859523419337e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 12.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "sample": 0.006178290964398046, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.728257140665746e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 5.278548703172084e-05, "time_between_sampling": 0.002434788505227943, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3292.731920582351}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 78000, "gradients_default_optimizer_global_norm": 0.05305613577365875, "vf_loss": 0.09868254512548447, "curr_kl_coeff": 9.112503903452307e-05, "vf_loss_unclipped": 25.324901580810547, "entropy": 0.527543842792511, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": 0.0031821199227124453, "total_loss": 0.06440390646457672, "num_module_steps_trained": 6000, "mean_kl_loss": 0.000769394391681999, "vf_explained_var": -0.009009599685668945, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 449075.8391996032}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03400860731038891, "add_states_from_episodes_to_batch": 3.3327213652770964e-06, "add_time_dim_to_batch_and_zero_pad": 1.1845544475374564e-05, "numpy_to_tensor": 6.920653730036779e-05, "add_columns_from_episodes_to_train_batch": 0.03365440302339229, "add_one_ts_to_episodes_and_truncate": 0.009172462388747334, "add_observations_from_episodes_to_batch": 0.0008178146127371764, "general_advantage_estimation": 0.006108010205745352}}, "connector_pipeline_timer": 0.08396111716686136}, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 409500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2345450.4682135587, "num_module_steps_trained_throughput": 448493.20003954263, "num_module_steps_trained_lifetime_throughput": 447834.1902653919}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.2395703538712846e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2192509533552483e-06, "add_time_dim_to_batch_and_zero_pad": 2.4290001964279467e-06, "batch_individual_items": 7.298239806494611e-06, "add_states_from_episodes_to_batch": 1.685219163688398e-06, "numpy_to_tensor": 1.0070991412053246e-05}}, "connector_pipeline_timer": 4.7918201010771746e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.8}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011325083279472197, "timers": {"connectors": {"un_batch_to_individual_items": 6.036531513280093e-06, "normalize_and_clip_actions": 1.06067079943027e-05, "tensor_to_numpy": 1.466184347642457e-05, "remove_single_ts_time_rank_from_batch": 6.371870930659479e-07, "get_actions": 4.158562722939741e-05, "listify_data_for_vector_env": 1.1915073572574631e-05}}}, "env_reset_timer": 0.0001698914844957468, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 65400, "episode_return_mean": 2.8, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "weights_seq_no": 13.0, "sample": 0.09787839685622592, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.8}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.6175055365629863e-05, "episode_len_max": 20, "num_episodes_lifetime": 260, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_duration_sec_mean": 0.005577269634231925, "time_between_sampling": 1.662333087917816}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "46945_00000", "date": "2025-08-11_19-36-39", "timestamp": 1754933799, "time_this_iter_s": 2.027880907058716, "time_total_s": 28.71671462059021, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.71671462059021, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 75.66666666666667, "ram_util_percent": 78.73333333333333}}
{"timers": {"training_iteration": 1.5945828519574432, "restore_env_runners": 8.603840138909639e-06, "training_step": 1.5944320658680595, "env_runner_sampling_timer": 1.4846838051221989, "learner_update_timer": 0.10674483876001435, "synch_weights": 0.0005341406392156139, "restore_eval_env_runners": 8.713068717341397e-06, "evaluation_iteration": 0.10405146947292114, "synch_eval_env_connectors": 0.0001196693364775307, "synch_env_connectors": 4.469091973981965e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.643174017773845e-06, "add_states_from_episodes_to_batch": 1.9585777064101147e-06, "add_time_dim_to_batch_and_zero_pad": 2.944023951231193e-06, "batch_individual_items": 7.620967314098586e-06, "numpy_to_tensor": 1.086409628314873e-05}}, "connector_pipeline_timer": 5.263615345313505e-05}, "episode_duration_sec_mean": 0.0054470085422508455, "num_env_steps_sampled_lifetime": -7400000.0, "module_episode_returns_mean": {"default_policy": 3.9399999999999995}, "num_episodes_lifetime": -370000.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0001241496161533722, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.731934451419367e-07, "normalize_and_clip_actions": 1.1226095621479351e-05, "get_actions": 4.818885783576075e-05, "listify_data_for_vector_env": 1.3117041985004391e-05, "un_batch_to_individual_items": 6.2636345023163664e-06, "tensor_to_numpy": 1.5533302183988747e-05}}}, "episode_return_mean": 3.9399999999999995, "rlmodule_inference_timer": 3.515010835080201e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 13.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.9399999999999995}, "sample": 0.006367510323549929, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.7147223343884003e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 5.854451123581698e-05, "time_between_sampling": 0.002118273060541533, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3177.8384861345075}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 84000, "gradients_default_optimizer_global_norm": 0.06801996380090714, "vf_loss": 0.09835900366306305, "curr_kl_coeff": 4.5562519517261535e-05, "vf_loss_unclipped": 24.430038452148438, "entropy": 0.5081238746643066, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.02879970334470272, "total_loss": 0.032381489872932434, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0006089486996643245, "vf_explained_var": -0.007025957107543945, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 446648.0808373467}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0349923924877822, "add_states_from_episodes_to_batch": 3.3252243832312857e-06, "add_time_dim_to_batch_and_zero_pad": 1.1874168148216967e-05, "numpy_to_tensor": 6.90494725086584e-05, "add_columns_from_episodes_to_train_batch": 0.033651802333387236, "add_one_ts_to_episodes_and_truncate": 0.009156991515454195, "add_observations_from_episodes_to_batch": 0.000817865217276408, "general_advantage_estimation": 0.006100216763219194}}, "connector_pipeline_timer": 0.0849186397457078}, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 441000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2333250.832606088, "num_module_steps_trained_throughput": 446108.39789789845, "num_module_steps_trained_lifetime_throughput": 445468.15380284254}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.604946373548243e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.761390638317045e-06, "add_time_dim_to_batch_and_zero_pad": 2.1498608399133284e-06, "batch_individual_items": 6.112997033552919e-06, "add_states_from_episodes_to_batch": 1.5931816898996022e-06, "numpy_to_tensor": 8.161800726277344e-06}}, "connector_pipeline_timer": 4.2123016282262515e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.4}, "module_to_env_connector": {"connector_pipeline_timer": 9.719934703075568e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.2284925566331805e-06, "normalize_and_clip_actions": 9.196481282196904e-06, "tensor_to_numpy": 1.2455287126019472e-05, "remove_single_ts_time_rank_from_batch": 5.805426504833943e-07, "get_actions": 3.376811452623235e-05, "listify_data_for_vector_env": 1.0659236265459561e-05}}}, "env_reset_timer": 0.00016898173980422836, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 70400, "episode_return_mean": 3.4, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "weights_seq_no": 14.0, "sample": 0.09784737204843563, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.4}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3638503114247584e-05, "episode_len_max": 20, "num_episodes_lifetime": 280, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_duration_sec_mean": 0.005570897106081247, "time_between_sampling": 1.664389630368458}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "46945_00000", "date": "2025-08-11_19-36-41", "timestamp": 1754933801, "time_this_iter_s": 1.9499077796936035, "time_total_s": 30.666622400283813, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.666622400283813, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 76.56666666666666, "ram_util_percent": 79.4}}
{"timers": {"training_iteration": 1.5938053617685641, "restore_env_runners": 8.571131596449463e-06, "training_step": 1.5936545852096897, "env_runner_sampling_timer": 1.4831918883211153, "learner_update_timer": 0.10745976912233612, "synch_weights": 0.000534227562864926, "restore_eval_env_runners": 8.691358784421849e-06, "evaluation_iteration": 0.1040056593581264, "synch_eval_env_connectors": 0.00011938389335758147, "synch_env_connectors": 4.468560878270757e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9997642058891514e-06, "add_states_from_episodes_to_batch": 1.7269552067095376e-06, "add_time_dim_to_batch_and_zero_pad": 2.419698761428404e-06, "batch_individual_items": 6.217207379333664e-06, "numpy_to_tensor": 8.327983478093223e-06}}, "connector_pipeline_timer": 4.293465410335211e-05}, "episode_duration_sec_mean": 0.004406767052132636, "num_env_steps_sampled_lifetime": -8017500.0, "module_episode_returns_mean": {"default_policy": 3.7}, "num_episodes_lifetime": -400875.0, "module_to_env_connector": {"connector_pipeline_timer": 9.986454419520174e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.682108459131737e-07, "normalize_and_clip_actions": 9.265170205245394e-06, "get_actions": 3.6609522976802775e-05, "listify_data_for_vector_env": 1.0770158602288956e-05, "un_batch_to_individual_items": 5.332571825028144e-06, "tensor_to_numpy": 1.2520416764145732e-05}}}, "episode_return_mean": 3.7, "rlmodule_inference_timer": 2.6673294664103956e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 14.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.7}, "sample": 0.004964417103620505, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3483669452311865e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.563345661362615e-05, "time_between_sampling": 0.0018867574423872984, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3839.830315154878}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 90000, "gradients_default_optimizer_global_norm": 0.09681214392185211, "vf_loss": 0.09825114160776138, "curr_kl_coeff": 2.2781259758630767e-05, "vf_loss_unclipped": 24.126394271850586, "entropy": 0.5022678375244141, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.09887556731700897, "total_loss": -0.03771353140473366, "num_module_steps_trained": 6000, "mean_kl_loss": 3.665469921543263e-05, "vf_explained_var": -0.0060272216796875, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 445094.74942189944}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0358171323128935, "add_states_from_episodes_to_batch": 3.316971165608089e-06, "add_time_dim_to_batch_and_zero_pad": 1.1846676288442404e-05, "numpy_to_tensor": 6.90285579693577e-05, "add_columns_from_episodes_to_train_batch": 0.033653949730475696, "add_one_ts_to_episodes_and_truncate": 0.009142711599762317, "add_observations_from_episodes_to_batch": 0.0008180869852962729, "general_advantage_estimation": 0.0060932850154517305}}, "connector_pipeline_timer": 0.08572419001798484}, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 472500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2325671.957872026, "num_module_steps_trained_throughput": 444604.2184459281, "num_module_steps_trained_lifetime_throughput": 443982.2180840827}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.6184056804171503e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7853996284027527e-06, "add_time_dim_to_batch_and_zero_pad": 2.147140206051932e-06, "batch_individual_items": 6.128391393767623e-06, "add_states_from_episodes_to_batch": 1.605884049886277e-06, "numpy_to_tensor": 8.048246737114598e-06}}, "connector_pipeline_timer": 4.220331543898451e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.6}, "module_to_env_connector": {"connector_pipeline_timer": 9.731425965822386e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.2071168527995875e-06, "normalize_and_clip_actions": 9.151124833261926e-06, "tensor_to_numpy": 1.2401822647833182e-05, "remove_single_ts_time_rank_from_batch": 5.967687298293521e-07, "get_actions": 3.4056870199946505e-05, "listify_data_for_vector_env": 1.0625412963454803e-05}}}, "env_reset_timer": 0.00016798108248495004, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 75400, "episode_return_mean": 3.6, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "weights_seq_no": 15.0, "sample": 0.09782442166774995, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.6}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3703586630140932e-05, "episode_len_max": 20, "num_episodes_lifetime": 300, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_duration_sec_mean": 0.005528078796342015, "time_between_sampling": 1.663075831154528}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "46945_00000", "date": "2025-08-11_19-36-42", "timestamp": 1754933802, "time_this_iter_s": 1.6192150115966797, "time_total_s": 32.28583741188049, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.28583741188049, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.06666666666666, "ram_util_percent": 79.03333333333333}}
{"timers": {"training_iteration": 1.592106006899983, "restore_env_runners": 8.537499838857466e-06, "training_step": 1.5919551906083018, "env_runner_sampling_timer": 1.4816605623581813, "learner_update_timer": 0.10729041893174472, "synch_weights": 0.0005347561177367751, "restore_eval_env_runners": 8.669855473452529e-06, "evaluation_iteration": 0.10396661943445182, "synch_eval_env_connectors": 0.00011920380370308747, "synch_env_connectors": 4.462205014199568e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9333032238663587e-06, "add_states_from_episodes_to_batch": 1.7215965085830028e-06, "add_time_dim_to_batch_and_zero_pad": 2.4176627632706375e-06, "batch_individual_items": 6.207836911246321e-06, "numpy_to_tensor": 8.286236561174134e-06}}, "connector_pipeline_timer": 4.278459618732869e-05}, "episode_duration_sec_mean": 0.004397559307981283, "num_env_steps_sampled_lifetime": -8635000.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "num_episodes_lifetime": -431750.0, "module_to_env_connector": {"connector_pipeline_timer": 9.975055385103998e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.648953737607549e-07, "normalize_and_clip_actions": 9.221100227244913e-06, "get_actions": 3.6612998801739986e-05, "listify_data_for_vector_env": 1.0735639039000784e-05, "un_batch_to_individual_items": 5.287738706127113e-06, "tensor_to_numpy": 1.2483328372772954e-05}}}, "episode_return_mean": 3.8600000000000008, "rlmodule_inference_timer": 2.6592049983967305e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 15.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "sample": 0.004711577192341489, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3443898431525258e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.086161869577924e-05, "time_between_sampling": 0.001800972409949052, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3862.701026495348}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 96000, "gradients_default_optimizer_global_norm": 0.04237082600593567, "vf_loss": 0.098574697971344, "curr_kl_coeff": 1.1390629879315384e-05, "vf_loss_unclipped": 25.01618003845215, "entropy": 0.5057782530784607, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": 0.05892258882522583, "total_loss": 0.12026922404766083, "num_module_steps_trained": 6000, "mean_kl_loss": 5.30047582287807e-05, "vf_explained_var": -0.00821065902709961, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 444134.89834956604}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.035769375569927174, "add_states_from_episodes_to_batch": 3.310050780717545e-06, "add_time_dim_to_batch_and_zero_pad": 1.1822369730311259e-05, "numpy_to_tensor": 6.895910133112855e-05, "add_columns_from_episodes_to_train_batch": 0.03364423440277691, "add_one_ts_to_episodes_and_truncate": 0.009127950733425469, "add_observations_from_episodes_to_batch": 0.0008177181958824903, "general_advantage_estimation": 0.006086246745639089}}, "connector_pipeline_timer": 0.08564413311712005}, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 504000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2321207.117733886, "num_module_steps_trained_throughput": 443693.804107419, "num_module_steps_trained_lifetime_throughput": 443089.5377502792}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.7527923863869808e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9518217802285656e-06, "add_time_dim_to_batch_and_zero_pad": 2.2204233938745556e-06, "batch_individual_items": 6.415971686187266e-06, "add_states_from_episodes_to_batch": 1.6334957513130249e-06, "numpy_to_tensor": 8.525449708769832e-06}}, "connector_pipeline_timer": 4.3860614630907554e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.4}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010169788411614423, "timers": {"connectors": {"un_batch_to_individual_items": 5.462498249260353e-06, "normalize_and_clip_actions": 9.578113534391787e-06, "tensor_to_numpy": 1.2876549992570084e-05, "remove_single_ts_time_rank_from_batch": 5.807299001493214e-07, "get_actions": 3.591677327050359e-05, "listify_data_for_vector_env": 1.0972842043776024e-05}}}, "env_reset_timer": 0.00016696961085855576, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 80400, "episode_return_mean": 3.4, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "weights_seq_no": 16.0, "sample": 0.09784234828082118, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.4}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.4283783972377354e-05, "episode_len_max": 20, "num_episodes_lifetime": 320, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_duration_sec_mean": 0.00485474756336771, "time_between_sampling": 1.660846761173091}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "46945_00000", "date": "2025-08-11_19-36-44", "timestamp": 1754933804, "time_this_iter_s": 1.5308637619018555, "time_total_s": 33.81670117378235, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.81670117378235, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 48.0, "ram_util_percent": 78.85}}
{"timers": {"training_iteration": 1.591375146001012, "restore_env_runners": 8.507124095112809e-06, "training_step": 1.5912241020324875, "env_runner_sampling_timer": 1.4810928734043483, "learner_update_timer": 0.10712727974195103, "synch_weights": 0.0005348727169086274, "restore_eval_env_runners": 8.649826809375071e-06, "evaluation_iteration": 0.10397192866033457, "synch_eval_env_connectors": 0.00011888884568562003, "synch_env_connectors": 4.4634133479544e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.012523884720753e-06, "add_states_from_episodes_to_batch": 1.7271005207368421e-06, "add_time_dim_to_batch_and_zero_pad": 2.4215983643066863e-06, "batch_individual_items": 6.306999156251327e-06, "numpy_to_tensor": 8.394423305164153e-06}}, "connector_pipeline_timer": 4.319861984324332e-05}, "episode_duration_sec_mean": 0.004770131673198194, "num_env_steps_sampled_lifetime": -9252500.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "num_episodes_lifetime": -462625.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010031127300216361, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.715546782963024e-07, "normalize_and_clip_actions": 9.296409624569614e-06, "get_actions": 3.670441257852362e-05, "listify_data_for_vector_env": 1.0813073497651288e-05, "un_batch_to_individual_items": 5.3419444300690045e-06, "tensor_to_numpy": 1.2595833128938207e-05}}}, "episode_return_mean": 3.8600000000000008, "rlmodule_inference_timer": 4.2240239008357575e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 16.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "sample": 0.004954098229889606, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3543227716864676e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.098229594250063e-05, "time_between_sampling": 0.0014942824037919786, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3813.8300468494726}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 102000, "gradients_default_optimizer_global_norm": 0.12520335614681244, "vf_loss": 0.09846686571836472, "curr_kl_coeff": 5.695314939657692e-06, "vf_loss_unclipped": 24.70703125, "entropy": 0.5125570893287659, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": 0.010529711842536926, "total_loss": 0.07174283266067505, "num_module_steps_trained": 6000, "mean_kl_loss": 8.060758409556001e-05, "vf_explained_var": -0.007464289665222168, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 443975.6692004027}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.035724553895058755, "add_states_from_episodes_to_batch": 3.309029678993e-06, "add_time_dim_to_batch_and_zero_pad": 1.1832896722335864e-05, "numpy_to_tensor": 6.875951055645936e-05, "add_columns_from_episodes_to_train_batch": 0.033646252889720736, "add_one_ts_to_episodes_and_truncate": 0.00911152372620208, "add_observations_from_episodes_to_batch": 0.000819769344425952, "general_advantage_estimation": 0.006076335528778669}}, "connector_pipeline_timer": 0.08557659053685565}, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 535500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2320926.0658099037, "num_module_steps_trained_throughput": 443582.32439321076, "num_module_steps_trained_lifetime_throughput": 442995.4161172646}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.394566049965647e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5316164927502093e-06, "add_time_dim_to_batch_and_zero_pad": 2.8153341067126315e-06, "batch_individual_items": 7.4422245742383755e-06, "add_states_from_episodes_to_batch": 1.8204976856748635e-06, "numpy_to_tensor": 1.0029558250907612e-05}}, "connector_pipeline_timer": 5.076547157498753e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00012426648431719165, "timers": {"connectors": {"un_batch_to_individual_items": 6.5772914281759494e-06, "normalize_and_clip_actions": 1.1284004762157397e-05, "tensor_to_numpy": 1.62263394019604e-05, "remove_single_ts_time_rank_from_batch": 6.567575804262227e-07, "get_actions": 4.465748922935013e-05, "listify_data_for_vector_env": 1.357631920923984e-05}}}, "env_reset_timer": 0.00016605408463690199, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 85400, "episode_return_mean": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "weights_seq_no": 17.0, "sample": 0.09817292895858853, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.0}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.7535658168808134e-05, "episode_len_max": 20, "num_episodes_lifetime": 340, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_duration_sec_mean": 0.004899339227704331, "time_between_sampling": 1.6596007289811712}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "46945_00000", "date": "2025-08-11_19-36-45", "timestamp": 1754933805, "time_this_iter_s": 1.65724515914917, "time_total_s": 35.47394633293152, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.47394633293152, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 48.3, "ram_util_percent": 78.85}}
{"timers": {"training_iteration": 1.591228245791084, "restore_env_runners": 8.478302409362018e-06, "training_step": 1.5910770406022519, "env_runner_sampling_timer": 1.4802390938401782, "learner_update_timer": 0.107834111524539, "synch_weights": 0.0005349710696327427, "restore_eval_env_runners": 8.624998393865922e-06, "evaluation_iteration": 0.10429100520331418, "synch_eval_env_connectors": 0.00011858120724515511, "synch_env_connectors": 4.463779557127058e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9861667752274717e-06, "add_states_from_episodes_to_batch": 1.7580884237861668e-06, "add_time_dim_to_batch_and_zero_pad": 2.4885540539062175e-06, "batch_individual_items": 6.504110873962125e-06, "numpy_to_tensor": 8.736795690618505e-06}}, "connector_pipeline_timer": 4.435397684202833e-05}, "episode_duration_sec_mean": 0.004616776173934342, "num_env_steps_sampled_lifetime": -9870000.0, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "num_episodes_lifetime": -493500.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010488808794051544, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.809668719618652e-07, "normalize_and_clip_actions": 9.548475818660117e-06, "get_actions": 3.9575672266463485e-05, "listify_data_for_vector_env": 1.1228635535899027e-05, "un_batch_to_individual_items": 5.4743109302914665e-06, "tensor_to_numpy": 1.3094508343444347e-05}}}, "episode_return_mean": 2.8199999999999994, "rlmodule_inference_timer": 2.8270719602226767e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 17.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "sample": 0.004979085360377386, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4074766998904548e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.384727001977526e-05, "time_between_sampling": 0.0015957214170737887, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3735.6756154482955}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 108000, "gradients_default_optimizer_global_norm": 0.06099133938550949, "vf_loss": 0.09911397844552994, "curr_kl_coeff": 2.847657469828846e-06, "vf_loss_unclipped": 26.49570655822754, "entropy": 0.5282083749771118, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": 0.1711471825838089, "total_loss": 0.23265135288238525, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0007358924485743046, "vf_explained_var": -0.009949445724487305, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 444301.9128619233}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03654735501670095, "add_states_from_episodes_to_batch": 3.302599655054656e-06, "add_time_dim_to_batch_and_zero_pad": 1.181247769738183e-05, "numpy_to_tensor": 6.864733543192737e-05, "add_columns_from_episodes_to_train_batch": 0.03364797911056157, "add_one_ts_to_episodes_and_truncate": 0.009094896399546026, "add_observations_from_episodes_to_batch": 0.0008195783207954595, "general_advantage_estimation": 0.00606830217453441}}, "connector_pipeline_timer": 0.08637580296196704}, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 567000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2323208.116009177, "num_module_steps_trained_throughput": 443960.1557560348, "num_module_steps_trained_lifetime_throughput": 443390.2036023497}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.6058749446917225e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.83399534832132e-06, "add_time_dim_to_batch_and_zero_pad": 2.165966428161724e-06, "batch_individual_items": 6.139335413421447e-06, "add_states_from_episodes_to_batch": 1.595375462159725e-06, "numpy_to_tensor": 8.196410133248763e-06}}, "connector_pipeline_timer": 4.2487318760392446e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.4}, "module_to_env_connector": {"connector_pipeline_timer": 9.884495561140815e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.295014680329528e-06, "normalize_and_clip_actions": 9.255620712617065e-06, "tensor_to_numpy": 1.257646203302143e-05, "remove_single_ts_time_rank_from_batch": 5.839534919513993e-07, "get_actions": 3.455518248341161e-05, "listify_data_for_vector_env": 1.0818894071336548e-05}}}, "env_reset_timer": 0.00016516937391224386, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 90400, "episode_return_mean": 3.4, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "weights_seq_no": 18.0, "sample": 0.09815050257890774, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.4}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3821966265238067e-05, "episode_len_max": 20, "num_episodes_lifetime": 360, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_duration_sec_mean": 0.004750600006664172, "time_between_sampling": 1.6589447579411722}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "46945_00000", "date": "2025-08-11_19-36-47", "timestamp": 1754933807, "time_this_iter_s": 1.6796319484710693, "time_total_s": 37.15357828140259, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.15357828140259, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 50.25, "ram_util_percent": 77.7}}
{"timers": {"training_iteration": 1.5905203604134066, "restore_env_runners": 8.44934984531016e-06, "training_step": 1.590369063105924, "env_runner_sampling_timer": 1.4788399158211418, "learner_update_timer": 0.1085248020797038, "synch_weights": 0.0005352546893747014, "restore_eval_env_runners": 8.60666860114075e-06, "evaluation_iteration": 0.10425380182197509, "synch_eval_env_connectors": 0.00011836998466582924, "synch_env_connectors": 4.459142066135522e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9511735227742454e-06, "add_states_from_episodes_to_batch": 1.7186313057821194e-06, "add_time_dim_to_batch_and_zero_pad": 2.4152954927967867e-06, "batch_individual_items": 6.2582394119716836e-06, "numpy_to_tensor": 8.37659021802715e-06}}, "connector_pipeline_timer": 4.30246545112333e-05}, "episode_duration_sec_mean": 0.0044376478446647525, "num_env_steps_sampled_lifetime": -10487500.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "num_episodes_lifetime": -524375.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010040776503210942, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.729252128247961e-07, "normalize_and_clip_actions": 9.343587036280755e-06, "get_actions": 3.684175461599013e-05, "listify_data_for_vector_env": 1.0800642214121799e-05, "un_batch_to_individual_items": 5.346071695600892e-06, "tensor_to_numpy": 1.2584189927709072e-05}}}, "episode_return_mean": 3.8600000000000008, "rlmodule_inference_timer": 2.729853704586685e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 18.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "sample": 0.004792978018923305, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3588820021992513e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.196118571928287e-05, "time_between_sampling": 0.0017847400142107343, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3825.3697411085864}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 114000, "gradients_default_optimizer_global_norm": 0.11087688058614731, "vf_loss": 0.09814337641000748, "curr_kl_coeff": 1.423828734914423e-06, "vf_loss_unclipped": 24.051631927490234, "entropy": 0.5417179465293884, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": -0.08550427854061127, "total_loss": -0.024771621450781822, "num_module_steps_trained": 6000, "mean_kl_loss": 3.7580906791845337e-05, "vf_explained_var": -0.005461335182189941, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 445095.2946666727}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03734890354716028, "add_states_from_episodes_to_batch": 3.2958229852696467e-06, "add_time_dim_to_batch_and_zero_pad": 1.178726282460487e-05, "numpy_to_tensor": 6.84750313012147e-05, "add_columns_from_episodes_to_train_batch": 0.033653910989591286, "add_one_ts_to_episodes_and_truncate": 0.009080989104833629, "add_observations_from_episodes_to_batch": 0.0008195450374586099, "general_advantage_estimation": 0.006059202902962515}}, "connector_pipeline_timer": 0.08715972159256098}, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 598500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2327941.5465928656, "num_module_steps_trained_throughput": 444805.1060618438, "num_module_steps_trained_lifetime_throughput": 444252.32197182765}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.5830258824416206e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7800585874703537e-06, "add_time_dim_to_batch_and_zero_pad": 2.134184344588312e-06, "batch_individual_items": 6.107698576596646e-06, "add_states_from_episodes_to_batch": 1.5872436465671798e-06, "numpy_to_tensor": 8.078546857023877e-06}}, "connector_pipeline_timer": 4.195663270610493e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.2}, "module_to_env_connector": {"connector_pipeline_timer": 9.736306504558653e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.1627931430849355e-06, "normalize_and_clip_actions": 9.149213750898199e-06, "tensor_to_numpy": 1.2356692639436667e-05, "remove_single_ts_time_rank_from_batch": 5.790589946127227e-07, "get_actions": 3.406330917461455e-05, "listify_data_for_vector_env": 1.0677637595674994e-05}}}, "env_reset_timer": 0.00016426601066751038, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 95400, "episode_return_mean": 3.2, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "weights_seq_no": 19.0, "sample": 0.09811728380288666, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.2}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.356606711562884e-05, "episode_len_max": 20, "num_episodes_lifetime": 380, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_duration_sec_mean": 0.004751252894056961, "time_between_sampling": 1.657729370772301}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "46945_00000", "date": "2025-08-11_19-36-49", "timestamp": 1754933809, "time_this_iter_s": 1.6221129894256592, "time_total_s": 38.77569127082825, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.77569127082825, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 38.699999999999996, "ram_util_percent": 78.13333333333334}}
{"timers": {"training_iteration": 1.5887396126395876, "restore_env_runners": 8.420266547587024e-06, "training_step": 1.5885882016455295, "env_runner_sampling_timer": 1.4772490099937388, "learner_update_timer": 0.10833460071935053, "synch_weights": 0.000535682143419057, "restore_eval_env_runners": 8.590181024678865e-06, "evaluation_iteration": 0.10420411713327228, "synch_eval_env_connectors": 0.00011811294496014725, "synch_env_connectors": 4.4533006494974806e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.914991578696612e-06, "add_states_from_episodes_to_batch": 1.7009161536239886e-06, "add_time_dim_to_batch_and_zero_pad": 2.3793973924518954e-06, "batch_individual_items": 6.154431181773348e-06, "numpy_to_tensor": 8.202963565778826e-06}}, "connector_pipeline_timer": 4.234845581944098e-05}, "episode_duration_sec_mean": 0.004364222051575779, "num_env_steps_sampled_lifetime": -11105000.0, "module_episode_returns_mean": {"default_policy": 3.62}, "num_episodes_lifetime": -555250.0, "module_to_env_connector": {"connector_pipeline_timer": 9.891538593709447e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.616687897902926e-07, "normalize_and_clip_actions": 9.186736100729722e-06, "get_actions": 3.620048643587764e-05, "listify_data_for_vector_env": 1.0642615466852673e-05, "un_batch_to_individual_items": 5.275493421132873e-06, "tensor_to_numpy": 1.2441881100672251e-05}}}, "episode_return_mean": 3.62, "rlmodule_inference_timer": 2.6439537231995552e-05, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 19.0, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.62}, "sample": 0.004681209787094621, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3337867933151933e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_max": 20, "episode_len_mean": 20.0, "env_reset_timer": 3.014741605066967e-05, "time_between_sampling": 0.0017812998795628174, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3889.301161777267}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 120000, "gradients_default_optimizer_global_norm": 0.08247192203998566, "vf_loss": 0.09868261218070984, "curr_kl_coeff": 7.119143674572115e-07, "vf_loss_unclipped": 25.19484519958496, "entropy": 0.5321364998817444, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "policy_loss": 0.05764909088611603, "total_loss": 0.1188291683793068, "num_module_steps_trained": 6000, "mean_kl_loss": 3.7657540815416723e-05, "vf_explained_var": -0.007982969284057617, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 446046.4271116462}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0372764615909538, "add_states_from_episodes_to_batch": 3.290365546892127e-06, "add_time_dim_to_batch_and_zero_pad": 1.1763970660423895e-05, "numpy_to_tensor": 6.842528116679297e-05, "add_columns_from_episodes_to_train_batch": 0.03365196479995774, "add_one_ts_to_episodes_and_truncate": 0.009064245463438989, "add_observations_from_episodes_to_batch": 0.0008192270871133046, "general_advantage_estimation": 0.006050477124511205}}, "connector_pipeline_timer": 0.08705918270648208}, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 630000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2333494.4765430335, "num_module_steps_trained_throughput": 445806.08217137266, "num_module_steps_trained_lifetime_throughput": 445270.5602953001}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 2.541935374006387e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.727517474307606e-06, "add_time_dim_to_batch_and_zero_pad": 2.1543004944832435e-06, "batch_individual_items": 5.937152616127235e-06, "add_states_from_episodes_to_batch": 1.5908530556999757e-06, "numpy_to_tensor": 8.043558833726099e-06}}, "connector_pipeline_timer": 4.1236706605283816e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.4}, "module_to_env_connector": {"connector_pipeline_timer": 9.519028871529939e-05, "timers": {"connectors": {"un_batch_to_individual_items": 5.089754981485831e-06, "normalize_and_clip_actions": 9.009703461095728e-06, "tensor_to_numpy": 1.2129620173938458e-05, "remove_single_ts_time_rank_from_batch": 5.662332432621829e-07, "get_actions": 3.322566760117393e-05, "listify_data_for_vector_env": 1.0392029869575734e-05}}}, "env_reset_timer": 0.0001632600212992939, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 100400, "episode_return_mean": 2.4, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "weights_seq_no": 20.0, "sample": 0.09806655679472984, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.4}, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 1.3311536806919169e-05, "episode_len_max": 20, "num_episodes_lifetime": 400, "episode_len_min": 20, "episode_return_min": -13.5, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_duration_sec_mean": 0.004728345351759344, "time_between_sampling": 1.6554404545644843}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "46945_00000", "date": "2025-08-11_19-36-50", "timestamp": 1754933810, "time_this_iter_s": 1.5122449398040771, "time_total_s": 40.287936210632324, "pid": 28168, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1618edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.287936210632324, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.35, "ram_util_percent": 76.75}}
