{"timers": {"training_iteration": 2.757149582961574, "restore_env_runners": 1.4499993994832039e-05, "training_step": 2.7569772501010448, "env_runner_sampling_timer": 2.589405208011158, "learner_update_timer": 0.1608396249357611, "synch_weights": 0.0013174170162528753}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00021672049472520633, "timers": {"connectors": {"normalize_and_clip_actions": 2.5315829503349005e-05, "tensor_to_numpy": 2.498843552465982e-05, "un_batch_to_individual_items": 9.121934095771384e-06, "listify_data_for_vector_env": 1.9619421177976687e-05, "get_actions": 9.282475336769214e-05, "remove_single_ts_time_rank_from_batch": 9.948513852416857e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.0012209032128238258, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.108237882171587e-05, "numpy_to_tensor": 1.7421688079744188e-05, "add_time_dim_to_batch_and_zero_pad": 4.300973196801122e-06, "add_observations_from_episodes_to_batch": 4.963041691255876e-06, "add_states_from_episodes_to_batch": 2.644564751430695e-06}}, "connector_pipeline_timer": 7.394890483455978e-05}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.014682758973131748, "rlmodule_inference_timer": 8.983882128438858e-05, "env_step_timer": 3.0199319819162222e-05, "env_reset_timer": 0.00029957900833264004, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_mean": 0.8199999999999998, "weights_seq_no": 0.0, "episode_duration_sec_mean": 0.00881945050600916, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2249.6398609605476}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.858306005597115e-05, "add_columns_from_episodes_to_train_batch": 0.03918874997179955, "general_advantage_estimation": 0.0068898750469088554, "batch_individual_items": 0.03191070898901671, "add_one_ts_to_episodes_and_truncate": 0.008602124988101423, "add_states_from_episodes_to_batch": 3.6249402910470963e-06, "add_time_dim_to_batch_and_zero_pad": 1.4082994312047958e-05, "add_observations_from_episodes_to_batch": 0.0011427499121055007}}, "connector_pipeline_timer": 0.08798470802139491}, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained_lifetime": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 774691.513132168, "num_module_steps_trained_throughput": 148154.08457561908, "num_module_steps_trained_lifetime_throughput": 147200.46770161059}, "default_policy": {"vf_explained_var": -0.009175658226013184, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.07857398688793182, "mean_kl_loss": 0.00025177394854836166, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.039243698120117, "num_trainable_parameters": 6003, "policy_loss": -0.2681262493133545, "entropy": 0.6600642800331116, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": -0.2051759511232376, "curr_kl_coeff": 0.3732481598854065, "num_module_steps_trained_lifetime": 6000, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 148577.8109830774}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.2865202380057307e-06, "batch_individual_items": 9.286542428056241e-06, "add_states_from_episodes_to_batch": 2.2098403360005686e-06, "add_observations_from_episodes_to_batch": 4.22801369620375e-06, "numpy_to_tensor": 1.5667289354819257e-05}}, "connector_pipeline_timer": 6.575421293559064e-05}, "env_step_timer": 2.3835120530802154e-05, "module_episode_returns_mean": {"default_policy": 1.8}, "num_env_steps_sampled_lifetime": 5400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001891831401436094, "timers": {"connectors": {"get_actions": 8.066066129375867e-05, "remove_single_ts_time_rank_from_batch": 1.1602851415111504e-06, "normalize_and_clip_actions": 1.5165117418217879e-05, "tensor_to_numpy": 2.5131712783770152e-05, "listify_data_for_vector_env": 1.7559686045459265e-05, "un_batch_to_individual_items": 8.135453601006639e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 1.8}, "env_reset_timer": 0.00019712501671165228, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_return_max": 12.5, "sample": 0.19055366702377796, "episode_return_mean": 1.8, "num_env_steps_sampled": 400, "num_episodes_lifetime": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "rlmodule_inference_timer": 5.792563372138689e-05, "episode_duration_sec_mean": 0.008742874988820403, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-14", "timestamp": 1754933654, "time_this_iter_s": 2.960137128829956, "time_total_s": 2.960137128829956, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.960137128829956, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.339999999999996, "ram_util_percent": 77.42}}
{"timers": {"training_iteration": 2.755309629632393, "restore_env_runners": 1.443291432224214e-05, "training_step": 2.7551365605101457, "env_runner_sampling_timer": 2.5865980896819383, "learner_update_timer": 0.16183294993592426, "synch_weights": 0.001310627015773207, "restore_eval_env_runners": 1.0750023648142815e-05, "evaluation_iteration": 0.1999049170408398, "synch_eval_env_connectors": 0.0002633749973028898, "synch_env_connectors": 4.417030140757561e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00018107569269842151, "timers": {"connectors": {"normalize_and_clip_actions": 1.5100666533911814e-05, "tensor_to_numpy": 2.295365173776154e-05, "un_batch_to_individual_items": 8.594855015147676e-06, "listify_data_for_vector_env": 1.8272240014342897e-05, "get_actions": 7.614799398595198e-05, "remove_single_ts_time_rank_from_batch": 9.408385407591272e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002538952881564902, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.2200000000000002}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0697979354676316e-05, "numpy_to_tensor": 1.5539075485571463e-05, "add_time_dim_to_batch_and_zero_pad": 4.036549481562178e-06, "add_observations_from_episodes_to_batch": 4.720676819015416e-06, "add_states_from_episodes_to_batch": 2.5246325823864463e-06}}, "connector_pipeline_timer": 6.85033526804795e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.009074651851904257, "rlmodule_inference_timer": 4.9593519306910514e-05, "env_step_timer": 2.3881859827023082e-05, "env_reset_timer": 9.136100581609249e-05, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_mean": 1.2200000000000002, "weights_seq_no": 1.0, "episode_duration_sec_mean": 0.007674356492236257, "module_episode_returns_mean": {"default_policy": 1.2200000000000002}, "num_episodes_lifetime": 500.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2411.5175439763557}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.859805900603532e-05, "add_columns_from_episodes_to_train_batch": 0.03926299331127666, "general_advantage_estimation": 0.006879844636423513, "batch_individual_items": 0.033372893149498845, "add_one_ts_to_episodes_and_truncate": 0.008597402898594737, "add_states_from_episodes_to_batch": 3.6299414932727813e-06, "add_time_dim_to_batch_and_zero_pad": 1.4074244536459446e-05, "add_observations_from_episodes_to_batch": 0.001139975752448663}}, "connector_pipeline_timer": 0.08950314511079341}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained_lifetime": 63000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 784408.5666187542, "num_module_steps_trained_throughput": 150000.55830030618, "num_module_steps_trained_lifetime_throughput": 149057.1974670461}, "default_policy": {"vf_explained_var": -0.012158751487731934, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.04126502946019173, "mean_kl_loss": 0.0004314855032134801, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.439332962036133, "num_trainable_parameters": 6003, "policy_loss": -0.003029095707461238, "entropy": 0.6536862254142761, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.05995207279920578, "curr_kl_coeff": 0.18662407994270325, "num_module_steps_trained_lifetime": 12000, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 150418.05369214335}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.409681263360292e-06, "batch_individual_items": 6.791342748313084e-06, "add_states_from_episodes_to_batch": 1.6718999442368785e-06, "add_observations_from_episodes_to_batch": 3.1367179198205253e-06, "numpy_to_tensor": 9.590471331946106e-06}}, "connector_pipeline_timer": 4.676028511408997e-05}, "env_step_timer": 1.7453660026539178e-05, "module_episode_returns_mean": {"default_policy": 0.3}, "num_env_steps_sampled_lifetime": 10400, "module_to_env_connector": {"connector_pipeline_timer": 0.00011977221387069099, "timers": {"connectors": {"get_actions": 4.620582655878466e-05, "remove_single_ts_time_rank_from_batch": 6.298239130121739e-07, "normalize_and_clip_actions": 1.0471434594067499e-05, "tensor_to_numpy": 1.5007580378921572e-05, "listify_data_for_vector_env": 1.2532558481753171e-05, "un_batch_to_individual_items": 5.812359850556755e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_reset_timer": 0.0001960337662603706, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_return_max": 14.5, "sample": 0.18985473618377, "episode_return_mean": 0.3, "num_env_steps_sampled": 400, "num_episodes_lifetime": 40, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.366003441359926, "rlmodule_inference_timer": 3.421468312812031e-05, "episode_duration_sec_mean": 0.007115959402290173, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.636576542048715}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-17", "timestamp": 1754933657, "time_this_iter_s": 2.7012879848480225, "time_total_s": 5.6614251136779785, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.6614251136779785, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 68.9, "ram_util_percent": 77.575}}
{"timers": {"training_iteration": 2.754885895836342, "restore_env_runners": 1.4351915114093571e-05, "training_step": 2.7547120778253187, "env_runner_sampling_timer": 2.586470596284885, "learner_update_timer": 0.16156113709697964, "synch_weights": 0.0013069865755503997, "restore_eval_env_runners": 1.0725443717092276e-05, "evaluation_iteration": 0.199163937040139, "synch_eval_env_connectors": 0.00026182249770499765, "synch_env_connectors": 4.418269963935018e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001951006277635327, "timers": {"connectors": {"normalize_and_clip_actions": 1.6426160552630366e-05, "tensor_to_numpy": 2.379736432510457e-05, "un_batch_to_individual_items": 8.913040421039575e-06, "listify_data_for_vector_env": 1.950658251316247e-05, "get_actions": 8.373909456895657e-05, "remove_single_ts_time_rank_from_batch": 9.58501491897322e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002649975811544356, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1784356548320402e-05, "numpy_to_tensor": 1.7113508754947876e-05, "add_time_dim_to_batch_and_zero_pad": 4.450963533964954e-06, "add_observations_from_episodes_to_batch": 5.026598999842278e-06, "add_states_from_episodes_to_batch": 2.5157575468844227e-06}}, "connector_pipeline_timer": 7.431483391539982e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00909324885959505, "rlmodule_inference_timer": 5.464356779332041e-05, "env_step_timer": 2.6842745792276017e-05, "env_reset_timer": 7.937109817874908e-05, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_mean": 1.0600000000000005, "weights_seq_no": 2.0, "episode_duration_sec_mean": 0.008355339467059823, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2301.7411357604474}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.88791579566896e-05, "add_columns_from_episodes_to_train_batch": 0.039439852957811675, "general_advantage_estimation": 0.006880095360765699, "batch_individual_items": 0.03339553463819902, "add_one_ts_to_episodes_and_truncate": 0.008615309699019417, "add_states_from_episodes_to_batch": 3.6419718991965056e-06, "add_time_dim_to_batch_and_zero_pad": 1.4086842024698853e-05, "add_observations_from_episodes_to_batch": 0.0011410480852355248}}, "connector_pipeline_timer": 0.08972203323934227}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained_lifetime": 94500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 797373.7981421121, "num_module_steps_trained_throughput": 152471.66122939152, "num_module_steps_trained_lifetime_throughput": 151544.82674374842}, "default_policy": {"vf_explained_var": -0.012941598892211914, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.039692364633083344, "mean_kl_loss": 0.0006657454650849104, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.58755874633789, "num_trainable_parameters": 6003, "policy_loss": 0.04044210910797119, "entropy": 0.6424447298049927, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.10348828136920929, "curr_kl_coeff": 0.09331203997135162, "num_module_steps_trained_lifetime": 18000, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 152873.5735405492}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.9546409610031945e-06, "batch_individual_items": 8.935799915226263e-06, "add_states_from_episodes_to_batch": 1.7906856687705778e-06, "add_observations_from_episodes_to_batch": 5.214005579920804e-06, "numpy_to_tensor": 1.2218119376265604e-05}}, "connector_pipeline_timer": 5.677431486684619e-05}, "env_step_timer": 2.1371806162075727e-05, "module_episode_returns_mean": {"default_policy": 0.8}, "num_env_steps_sampled_lifetime": 15400, "module_to_env_connector": {"connector_pipeline_timer": 0.00014891555875952027, "timers": {"connectors": {"get_actions": 5.6499043059164885e-05, "remove_single_ts_time_rank_from_batch": 7.70028545777703e-07, "normalize_and_clip_actions": 1.1838309372229204e-05, "tensor_to_numpy": 2.0706189702784963e-05, "listify_data_for_vector_env": 1.5110198570700103e-05, "un_batch_to_individual_items": 6.931297583764754e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.8}, "env_reset_timer": 0.0001951705184415914, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_return_max": 14.5, "sample": 0.18930079924082382, "episode_return_mean": 0.8, "num_env_steps_sampled": 400, "num_episodes_lifetime": 60, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368205581254823, "rlmodule_inference_timer": 4.049287326975682e-05, "episode_duration_sec_mean": 0.006793957704212516, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.637565436218865}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-20", "timestamp": 1754933660, "time_this_iter_s": 2.856956958770752, "time_total_s": 8.51838207244873, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.51838207244873, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 74.65, "ram_util_percent": 77.925}}
{"timers": {"training_iteration": 2.752484233548274, "restore_env_runners": 1.4278396495967172e-05, "training_step": 2.7523090812166666, "env_runner_sampling_timer": 2.5841957961623807, "learner_update_timer": 0.16146369447576323, "synch_weights": 0.0013012621289391535, "restore_eval_env_runners": 1.071485939901322e-05, "evaluation_iteration": 0.19858392391905655, "synch_eval_env_connectors": 0.00026040593263460324, "synch_env_connectors": 4.427417123224586e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017242439073069377, "timers": {"connectors": {"normalize_and_clip_actions": 1.4505463257103738e-05, "tensor_to_numpy": 2.1322972664278537e-05, "un_batch_to_individual_items": 8.499676266414942e-06, "listify_data_for_vector_env": 1.7273287934579536e-05, "get_actions": 7.245350606450061e-05, "remove_single_ts_time_rank_from_batch": 8.791449869278413e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002598880446603694, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.7399999999999999}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.04190539159312e-05, "numpy_to_tensor": 1.4892537274660697e-05, "add_time_dim_to_batch_and_zero_pad": 3.8783818094452805e-06, "add_observations_from_episodes_to_batch": 4.553832195700056e-06, "add_states_from_episodes_to_batch": 2.459480598553936e-06}}, "connector_pipeline_timer": 6.659175210742446e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00829022753814815, "rlmodule_inference_timer": 4.705323528814191e-05, "env_step_timer": 2.287051427482712e-05, "env_reset_timer": 7.621406295049424e-05, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_mean": 0.7399999999999999, "weights_seq_no": 3.0, "episode_duration_sec_mean": 0.007409876158460976, "module_episode_returns_mean": {"default_policy": 0.7399999999999999}, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2470.3526106841236}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.889494682941586e-05, "add_columns_from_episodes_to_train_batch": 0.03969883358728176, "general_advantage_estimation": 0.006893528567667002, "batch_individual_items": 0.033443688882390264, "add_one_ts_to_episodes_and_truncate": 0.008686775352847297, "add_states_from_episodes_to_batch": 3.6630520359613e-06, "add_time_dim_to_batch_and_zero_pad": 1.420805359771475e-05, "add_observations_from_episodes_to_batch": 0.0011474501043924829}}, "connector_pipeline_timer": 0.09012067665664107}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained_lifetime": 126000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 814421.8767768833, "num_module_steps_trained_throughput": 155706.6112837767, "num_module_steps_trained_lifetime_throughput": 154805.49252386947}, "default_policy": {"vf_explained_var": -0.013248324394226074, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.0398266464471817, "mean_kl_loss": 0.0006002793088555336, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.65396499633789, "num_trainable_parameters": 6003, "policy_loss": 0.07163538783788681, "entropy": 0.6283105611801147, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.13474135100841522, "curr_kl_coeff": 0.04665601998567581, "num_module_steps_trained_lifetime": 24000, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 156079.31700053546}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.95196349072183e-06, "batch_individual_items": 7.196634099577174e-06, "add_states_from_episodes_to_batch": 1.8013123360175699e-06, "add_observations_from_episodes_to_batch": 3.442865625739438e-06, "numpy_to_tensor": 1.1216712547989224e-05}}, "connector_pipeline_timer": 5.21572660555411e-05}, "env_step_timer": 1.863272701640602e-05, "module_episode_returns_mean": {"default_policy": 0.05}, "num_env_steps_sampled_lifetime": 20400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001383361092317846, "timers": {"connectors": {"get_actions": 5.333079181406815e-05, "remove_single_ts_time_rank_from_batch": 7.302114440574254e-07, "normalize_and_clip_actions": 1.1636098892387978e-05, "tensor_to_numpy": 1.7960397413600178e-05, "listify_data_for_vector_env": 1.3721890021982796e-05, "un_batch_to_individual_items": 6.972724629432193e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.05}, "env_reset_timer": 0.00019402756330359262, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_return_max": 14.5, "sample": 0.18868516999821644, "episode_return_mean": 0.05, "num_env_steps_sampled": 400, "num_episodes_lifetime": 80, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368237912813044, "rlmodule_inference_timer": 3.80438426201669e-05, "episode_duration_sec_mean": 0.006546912087651435, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6365860972760244}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-22", "timestamp": 1754933662, "time_this_iter_s": 2.650045156478882, "time_total_s": 11.168427228927612, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.168427228927612, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 68.9, "ram_util_percent": 77.44999999999999}}
{"timers": {"training_iteration": 2.750217851213414, "restore_env_runners": 1.4193112386764259e-05, "training_step": 2.7500421449847745, "env_runner_sampling_timer": 2.5822063144502057, "learner_update_timer": 0.1612154442006935, "synch_weights": 0.0012954261769642654, "restore_eval_env_runners": 1.0705210965359584e-05, "evaluation_iteration": 0.19792866759031616, "synch_eval_env_connectors": 0.0002590014528731117, "synch_env_connectors": 4.430232949671336e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017348909478383945, "timers": {"connectors": {"normalize_and_clip_actions": 1.4851350843409394e-05, "tensor_to_numpy": 2.1812930105441183e-05, "un_batch_to_individual_items": 8.278309564456317e-06, "listify_data_for_vector_env": 1.754562097033192e-05, "get_actions": 7.189115189073822e-05, "remove_single_ts_time_rank_from_batch": 9.000824532672419e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002376673154691833, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0398871025776478e-05, "numpy_to_tensor": 1.495344379032451e-05, "add_time_dim_to_batch_and_zero_pad": 3.919228759729528e-06, "add_observations_from_episodes_to_batch": 4.615199358226503e-06, "add_states_from_episodes_to_batch": 2.456804876921705e-06}}, "connector_pipeline_timer": 6.704258789396266e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.008025450327980476, "rlmodule_inference_timer": 7.05301001587102e-05, "env_step_timer": 2.3114508282381336e-05, "env_reset_timer": 7.478364561776746e-05, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_mean": 2.8199999999999994, "weights_seq_no": 4.0, "episode_duration_sec_mean": 0.007910646688193081, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2497.3709906182935}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.019932685817591e-05, "add_columns_from_episodes_to_train_batch": 0.0398887544212058, "general_advantage_estimation": 0.006903378701454444, "batch_individual_items": 0.033460657824154555, "add_one_ts_to_episodes_and_truncate": 0.00873959467925509, "add_states_from_episodes_to_batch": 3.657250621127896e-06, "add_time_dim_to_batch_and_zero_pad": 1.4189723712992852e-05, "add_observations_from_episodes_to_batch": 0.001150511443949287}}, "connector_pipeline_timer": 0.0903946611400059}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained_lifetime": 157500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 836105.3575570041, "num_module_steps_trained_throughput": 159841.46036662965, "num_module_steps_trained_lifetime_throughput": 158966.45763774114}, "default_policy": {"vf_explained_var": -0.010551810264587402, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.029085060581564903, "mean_kl_loss": 0.0002633107651490718, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.329936981201172, "num_trainable_parameters": 6003, "policy_loss": 0.042711563408374786, "entropy": 0.6176988482475281, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.10586991161108017, "curr_kl_coeff": 0.023328009992837906, "num_module_steps_trained_lifetime": 30000, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 160184.4895529446}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.154282141034145e-06, "batch_individual_items": 1.083082486921771e-05, "add_states_from_episodes_to_batch": 1.878783534855796e-06, "add_observations_from_episodes_to_batch": 3.532094541280454e-06, "numpy_to_tensor": 1.2260075842434903e-05}}, "connector_pipeline_timer": 5.9225053396183596e-05}, "env_step_timer": 1.790266698487719e-05, "module_episode_returns_mean": {"default_policy": 0.2}, "num_env_steps_sampled_lifetime": 25400, "module_to_env_connector": {"connector_pipeline_timer": 0.00014312249193096632, "timers": {"connectors": {"get_actions": 5.6878580202596e-05, "remove_single_ts_time_rank_from_batch": 6.65348777637143e-07, "normalize_and_clip_actions": 1.1395488539244292e-05, "tensor_to_numpy": 1.7736390665702317e-05, "listify_data_for_vector_env": 1.328373190390355e-05, "un_batch_to_individual_items": 6.807247070104202e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.2}, "env_reset_timer": 0.00019299270783606568, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_return_max": 14.5, "sample": 0.18808829704851715, "episode_return_mean": 0.2, "num_env_steps_sampled": 400, "num_episodes_lifetime": 100, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238387501162, "rlmodule_inference_timer": 3.977223046839897e-05, "episode_duration_sec_mean": 0.006422689259052277, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.635669606722638}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-25", "timestamp": 1754933665, "time_this_iter_s": 2.664396047592163, "time_total_s": 13.832823276519775, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.832823276519775, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.06666666666666, "ram_util_percent": 77.00000000000001}}
{"timers": {"training_iteration": 2.7476840777016798, "restore_env_runners": 1.411868119479831e-05, "training_step": 2.747507768955078, "env_runner_sampling_timer": 2.5787285088066576, "learner_update_timer": 0.16218697850885114, "synch_weights": 0.0012892389958257297, "restore_eval_env_runners": 1.0669818307056558e-05, "evaluation_iteration": 0.19730798299514, "synch_eval_env_connectors": 0.00025812643859755136, "synch_env_connectors": 4.462180327664828e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001731139793510114, "timers": {"connectors": {"normalize_and_clip_actions": 1.467648845838135e-05, "tensor_to_numpy": 2.1536647424646797e-05, "un_batch_to_individual_items": 8.313707325737859e-06, "listify_data_for_vector_env": 1.7493305346080353e-05, "get_actions": 7.241364773655055e-05, "remove_single_ts_time_rank_from_batch": 8.678627233985289e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002280464733611412, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.34}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.053074433875039e-05, "numpy_to_tensor": 1.4704604307261255e-05, "add_time_dim_to_batch_and_zero_pad": 3.914797523297017e-06, "add_observations_from_episodes_to_batch": 4.504492840936814e-06, "add_states_from_episodes_to_batch": 2.455681745000559e-06}}, "connector_pipeline_timer": 6.661771441043306e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.008342481654892172, "rlmodule_inference_timer": 4.766406753240549e-05, "env_step_timer": 2.317126589943655e-05, "env_reset_timer": 7.291784479307282e-05, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_mean": 2.34, "weights_seq_no": 5.0, "episode_duration_sec_mean": 0.007380561691708864, "module_episode_returns_mean": {"default_policy": 2.34}, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2471.6706268122534}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.035233311506668e-05, "add_columns_from_episodes_to_train_batch": 0.03988192937688012, "general_advantage_estimation": 0.006895114493580369, "batch_individual_items": 0.03485393416528041, "add_one_ts_to_episodes_and_truncate": 0.008828723322232081, "add_states_from_episodes_to_batch": 3.6510986026632135e-06, "add_time_dim_to_batch_and_zero_pad": 1.4177826301593843e-05, "add_observations_from_episodes_to_batch": 0.001165103418794825}}, "connector_pipeline_timer": 0.09187653827854296}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime": 189000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 860577.6559947431, "num_module_steps_trained_throughput": 164499.38654000653, "num_module_steps_trained_lifetime_throughput": 163653.29751560075}, "default_policy": {"vf_explained_var": -0.0063784122467041016, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.044034115970134735, "mean_kl_loss": 0.0003197113692294806, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.01873207092285, "num_trainable_parameters": 6003, "policy_loss": -0.2018829733133316, "entropy": 0.6058812141418457, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": -0.1386224329471588, "curr_kl_coeff": 0.011664004996418953, "num_module_steps_trained_lifetime": 36000, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 164801.64291480236}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.27947480696096e-06, "batch_individual_items": 9.800260943551158e-06, "add_states_from_episodes_to_batch": 2.1565883786084354e-06, "add_observations_from_episodes_to_batch": 4.569493492191679e-06, "numpy_to_tensor": 1.3960971639793868e-05}}, "connector_pipeline_timer": 6.469858767205205e-05}, "env_step_timer": 2.225183714763402e-05, "module_episode_returns_mean": {"default_policy": -0.8}, "num_env_steps_sampled_lifetime": 30400, "module_to_env_connector": {"connector_pipeline_timer": 0.00017427451955042547, "timers": {"connectors": {"get_actions": 6.947483729995443e-05, "remove_single_ts_time_rank_from_batch": 8.835486779750701e-07, "normalize_and_clip_actions": 1.5688539768757058e-05, "tensor_to_numpy": 2.1760472938304857e-05, "listify_data_for_vector_env": 1.8497476266234003e-05, "un_batch_to_individual_items": 7.870520288395186e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_reset_timer": 0.00019196445118569797, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_return_max": 14.5, "sample": 0.18765018823856427, "episode_return_mean": -0.8, "num_env_steps_sampled": 400, "num_episodes_lifetime": 120, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394470474, "rlmodule_inference_timer": 4.603137221304159e-05, "episode_duration_sec_mean": 0.005985888032009825, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.634566062324579}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-28", "timestamp": 1754933668, "time_this_iter_s": 2.6500887870788574, "time_total_s": 16.482912063598633, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.482912063598633, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 68.375, "ram_util_percent": 77.375}}
{"timers": {"training_iteration": 2.74343779942462, "restore_env_runners": 1.4036244539163508e-05, "training_step": 2.743260972515285, "env_runner_sampling_timer": 2.5749961645485757, "learner_update_timer": 0.16170345705404057, "synch_weights": 0.0012827116054392874, "restore_eval_env_runners": 1.0646450211349713e-05, "evaluation_iteration": 0.19684247316485548, "synch_eval_env_connectors": 0.000256643094096645, "synch_env_connectors": 4.460478525239334e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00016814861054576324, "timers": {"connectors": {"normalize_and_clip_actions": 1.4296467402720149e-05, "tensor_to_numpy": 2.1046918569068666e-05, "un_batch_to_individual_items": 8.11735648512584e-06, "listify_data_for_vector_env": 1.7196416571368616e-05, "get_actions": 6.97868153667395e-05, "remove_single_ts_time_rank_from_batch": 8.459667932917359e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.0027269062436155434, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.023520560263901e-05, "numpy_to_tensor": 1.4549359691561283e-05, "add_time_dim_to_batch_and_zero_pad": 3.732973622230735e-06, "add_observations_from_episodes_to_batch": 4.4065464808385365e-06, "add_states_from_episodes_to_batch": 2.331587878792606e-06}}, "connector_pipeline_timer": 6.523655944361684e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.0077109440596952565, "rlmodule_inference_timer": 4.592063661457688e-05, "env_step_timer": 2.243599802270524e-05, "env_reset_timer": 6.79712847678041e-05, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_mean": 2.259999999999999, "weights_seq_no": 6.0, "episode_duration_sec_mean": 0.007235379859805109, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2541.106004237866}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.038088869937791e-05, "add_columns_from_episodes_to_train_batch": 0.03991840258271689, "general_advantage_estimation": 0.006885595018878172, "batch_individual_items": 0.03486962649343728, "add_one_ts_to_episodes_and_truncate": 0.008841472339135377, "add_states_from_episodes_to_batch": 3.6587579180441567e-06, "add_time_dim_to_batch_and_zero_pad": 1.4258547986572851e-05, "add_observations_from_episodes_to_batch": 0.0011665019740769056}}, "connector_pipeline_timer": 0.09193360664632028}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained_lifetime": 220500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 891096.9085888277, "num_module_steps_trained_throughput": 170303.65572545098, "num_module_steps_trained_lifetime_throughput": 169487.0141162379}, "default_policy": {"vf_explained_var": -0.008970975875854492, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.013988404534757137, "mean_kl_loss": 0.00020801420032512397, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.27447509765625, "num_trainable_parameters": 6003, "policy_loss": -0.02636248804628849, "entropy": 0.5972712635993958, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.03697100281715393, "curr_kl_coeff": 0.0058320024982094765, "num_module_steps_trained_lifetime": 42000, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 170559.1932582312}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.663808426813996e-06, "batch_individual_items": 7.6075493571656235e-06, "add_states_from_episodes_to_batch": 1.80797244768016e-06, "add_observations_from_episodes_to_batch": 3.2866012813348032e-06, "numpy_to_tensor": 1.057010460359066e-05}}, "connector_pipeline_timer": 5.167893305345838e-05}, "env_step_timer": 1.7912028603023976e-05, "module_episode_returns_mean": {"default_policy": -1.2}, "num_env_steps_sampled_lifetime": 35400, "module_to_env_connector": {"connector_pipeline_timer": 0.00012518051534165703, "timers": {"connectors": {"get_actions": 4.9048448799768855e-05, "remove_single_ts_time_rank_from_batch": 6.456833561150061e-07, "normalize_and_clip_actions": 1.1401217794549983e-05, "tensor_to_numpy": 1.5245987529240613e-05, "listify_data_for_vector_env": 1.314591602860693e-05, "un_batch_to_individual_items": 5.971502250924079e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_reset_timer": 0.00019077438615234326, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_return_max": 14.5, "sample": 0.18701604427703392, "episode_return_mean": -1.2, "num_env_steps_sampled": 400, "num_episodes_lifetime": 140, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394572801, "rlmodule_inference_timer": 3.373269450810372e-05, "episode_duration_sec_mean": 0.006020165119552985, "weights_seq_no": 7.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6316981550311223}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-30", "timestamp": 1754933670, "time_this_iter_s": 2.4544458389282227, "time_total_s": 18.937357902526855, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.937357902526855, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 66.73333333333333, "ram_util_percent": 77.3}}
{"timers": {"training_iteration": 2.7410503622604443, "restore_env_runners": 1.3967131763189611e-05, "training_step": 2.7408730607009124, "env_runner_sampling_timer": 2.5730279637328235, "learner_update_timer": 0.16130868290324515, "synch_weights": 0.0012788040683618237, "restore_eval_env_runners": 1.0612905938522172e-05, "evaluation_iteration": 0.19616500468220185, "synch_eval_env_connectors": 0.0002550787429629004, "synch_env_connectors": 4.464203560843393e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017466734949616485, "timers": {"connectors": {"normalize_and_clip_actions": 1.4721137599291489e-05, "tensor_to_numpy": 2.16812370763884e-05, "un_batch_to_individual_items": 8.304672143796869e-06, "listify_data_for_vector_env": 1.8026296350756526e-05, "get_actions": 7.29668996436871e-05, "remove_single_ts_time_rank_from_batch": 8.683559259440333e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.0021585605487329535, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0538793402739171e-05, "numpy_to_tensor": 1.5172095007822264e-05, "add_time_dim_to_batch_and_zero_pad": 3.991234503298751e-06, "add_observations_from_episodes_to_batch": 4.724571368391415e-06, "add_states_from_episodes_to_batch": 2.529077316068954e-06}}, "connector_pipeline_timer": 6.762299004394574e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.008318877221342653, "rlmodule_inference_timer": 6.779210807316781e-05, "env_step_timer": 2.2993599731730608e-05, "env_reset_timer": 6.784039777351877e-05, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_mean": 2.899999999999998, "weights_seq_no": 7.0, "episode_duration_sec_mean": 0.007983030872419476, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2497.5620426650953}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.067415958153356e-05, "add_columns_from_episodes_to_train_batch": 0.03998535605620538, "general_advantage_estimation": 0.006878693648703962, "batch_individual_items": 0.03486788272832468, "add_one_ts_to_episodes_and_truncate": 0.008840126785129382, "add_states_from_episodes_to_batch": 3.658000646615609e-06, "add_time_dim_to_batch_and_zero_pad": 1.423721255684953e-05, "add_observations_from_episodes_to_batch": 0.0011771782047781051}}, "connector_pipeline_timer": 0.0920013589097143}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 916374.0201903607, "num_module_steps_trained_throughput": 175106.30727990266, "num_module_steps_trained_lifetime_throughput": 174319.47059984805}, "default_policy": {"vf_explained_var": -0.0067958831787109375, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.025655152276158333, "mean_kl_loss": 9.257249621441588e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.120574951171875, "num_trainable_parameters": 6003, "policy_loss": -0.07245510071516037, "entropy": 0.5958549976348877, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": -0.009110665880143642, "curr_kl_coeff": 0.0029160012491047382, "num_module_steps_trained_lifetime": 48000, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 175324.98750577393}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.914548342698008e-06, "batch_individual_items": 1.17374451245671e-05, "add_states_from_episodes_to_batch": 2.8199794730046816e-06, "add_observations_from_episodes_to_batch": 5.235553899250569e-06, "numpy_to_tensor": 1.915606454580881e-05}}, "connector_pipeline_timer": 7.94739384084307e-05}, "env_step_timer": 2.7232031557453346e-05, "module_episode_returns_mean": {"default_policy": -2.0}, "num_env_steps_sampled_lifetime": 40400, "module_to_env_connector": {"connector_pipeline_timer": 0.00020813502424400215, "timers": {"connectors": {"get_actions": 8.339123305302146e-05, "remove_single_ts_time_rank_from_batch": 8.825223740779201e-07, "normalize_and_clip_actions": 1.7786887879346233e-05, "tensor_to_numpy": 2.7244366885837183e-05, "listify_data_for_vector_env": 2.0648055668494584e-05, "un_batch_to_individual_items": 9.64831121030896e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -2.0}, "env_reset_timer": 0.0001898691423573535, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_return_max": 12.5, "sample": 0.18688679383419854, "episode_return_mean": -2.0, "num_env_steps_sampled": 400, "num_episodes_lifetime": 160, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.3682383945743, "rlmodule_inference_timer": 5.471527252246766e-05, "episode_duration_sec_mean": 0.0063842888677027075, "weights_seq_no": 8.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6306475359804895}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-33", "timestamp": 1754933673, "time_this_iter_s": 2.6886000633239746, "time_total_s": 21.62595796585083, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.62595796585083, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 67.15, "ram_util_percent": 77.25}}
{"timers": {"training_iteration": 2.745531583638299, "restore_env_runners": 1.3884120946844104e-05, "training_step": 2.7453527780146953, "env_runner_sampling_timer": 2.5758381303450304, "learner_update_timer": 0.16297526899468376, "synch_weights": 0.0012842735287476618, "restore_eval_env_runners": 1.0580936931600362e-05, "evaluation_iteration": 0.19601523380550703, "synch_eval_env_connectors": 0.0002540929558084213, "synch_env_connectors": 4.476232503900312e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00022717092174146967, "timers": {"connectors": {"normalize_and_clip_actions": 1.8316751442674763e-05, "tensor_to_numpy": 2.9281296087424076e-05, "un_batch_to_individual_items": 1.0228368859242318e-05, "listify_data_for_vector_env": 2.2699774629754144e-05, "get_actions": 9.893505410901156e-05, "remove_single_ts_time_rank_from_batch": 9.948014413331461e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002421199566437124, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3973588810082548e-05, "numpy_to_tensor": 1.8918530316637776e-05, "add_time_dim_to_batch_and_zero_pad": 5.103220045261857e-06, "add_observations_from_episodes_to_batch": 7.791668264410966e-06, "add_states_from_episodes_to_batch": 2.897171345136481e-06}}, "connector_pipeline_timer": 8.746202624463987e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.009769585322339997, "rlmodule_inference_timer": 6.447512773805927e-05, "env_step_timer": 3.143245667165158e-05, "env_reset_timer": 7.548392313054939e-05, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_mean": 4.740000000000002, "weights_seq_no": 8.0, "episode_duration_sec_mean": 0.009688302986323834, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2206.028740183696}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.137991884588776e-05, "add_columns_from_episodes_to_train_batch": 0.04006509082613384, "general_advantage_estimation": 0.0069203200418927165, "batch_individual_items": 0.03510963932120441, "add_one_ts_to_episodes_and_truncate": 0.010444639268163143, "add_states_from_episodes_to_batch": 3.698501553037503e-06, "add_time_dim_to_batch_and_zero_pad": 1.4334009889208381e-05, "add_observations_from_episodes_to_batch": 0.0011754089226422583}}, "connector_pipeline_timer": 0.09396853157033522}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained_lifetime": 283500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 931719.9023034315, "num_module_steps_trained_throughput": 178009.6892479691, "num_module_steps_trained_lifetime_throughput": 177254.22668352196}, "default_policy": {"vf_explained_var": 0.0010166168212890625, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.05536004900932312, "mean_kl_loss": 0.0007413393468596041, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.78199577331543, "num_trainable_parameters": 6003, "policy_loss": -0.16278362274169922, "entropy": 0.5808447599411011, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": -0.09930161386728287, "curr_kl_coeff": 0.0014580006245523691, "num_module_steps_trained_lifetime": 54000, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 178198.5309400041}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.2678483647231963e-06, "batch_individual_items": 9.168480713788157e-06, "add_states_from_episodes_to_batch": 1.9445643547161266e-06, "add_observations_from_episodes_to_batch": 4.290762658259873e-06, "numpy_to_tensor": 1.4588613919797958e-05}}, "connector_pipeline_timer": 6.404481581166642e-05}, "env_step_timer": 2.0968239633129197e-05, "module_episode_returns_mean": {"default_policy": -1.0}, "num_env_steps_sampled_lifetime": 45400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001578410164812393, "timers": {"connectors": {"get_actions": 6.561523557083496e-05, "remove_single_ts_time_rank_from_batch": 7.68842020501785e-07, "normalize_and_clip_actions": 1.2692880053024154e-05, "tensor_to_numpy": 1.9699516286224034e-05, "listify_data_for_vector_env": 1.5268869930200152e-05, "un_batch_to_individual_items": 7.0512149087839915e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_reset_timer": 0.00019579795058233607, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "sample": 0.1865815321452579, "episode_return_mean": -1.0, "num_env_steps_sampled": 400, "num_episodes_lifetime": 180, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.2951058702669146e-05, "episode_duration_sec_mean": 0.0066339504974894225, "weights_seq_no": 9.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6366264322902526}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-36", "timestamp": 1754933676, "time_this_iter_s": 3.3656508922576904, "time_total_s": 24.99160885810852, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.99160885810852, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 74.9, "ram_util_percent": 80.08}}
{"timers": {"training_iteration": 2.7450906278025284, "restore_env_runners": 1.3987779837660478e-05, "training_step": 2.744909875653755, "env_runner_sampling_timer": 2.574763703212485, "learner_update_timer": 0.16360435838463713, "synch_weights": 0.001287960793599213, "restore_eval_env_runners": 1.0590547533109672e-05, "evaluation_iteration": 0.1957704760472574, "synch_eval_env_connectors": 0.00025602077622612274, "synch_env_connectors": 4.471470483441043e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00019117997797739487, "timers": {"connectors": {"normalize_and_clip_actions": 1.6134914444636493e-05, "tensor_to_numpy": 2.3893070186530127e-05, "un_batch_to_individual_items": 8.874145557135515e-06, "listify_data_for_vector_env": 1.9416950354041846e-05, "get_actions": 8.038167024913732e-05, "remove_single_ts_time_rank_from_batch": 9.458139155754183e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.0031088198113397004, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1482171984356259e-05, "numpy_to_tensor": 1.6569707667778425e-05, "add_time_dim_to_batch_and_zero_pad": 4.161199442170934e-06, "add_observations_from_episodes_to_batch": 4.995392056369936e-06, "add_states_from_episodes_to_batch": 2.5873681471475465e-06}}, "connector_pipeline_timer": 7.268378203610667e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.009152223861978797, "rlmodule_inference_timer": 5.209130129585586e-05, "env_step_timer": 2.5698965475835327e-05, "env_reset_timer": 7.498713061713444e-05, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_mean": 3.7, "weights_seq_no": 9.0, "episode_duration_sec_mean": 0.00823187032248825, "module_episode_returns_mean": {"default_policy": 3.7}, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2312.4120991248096}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.175195912455204e-05, "add_columns_from_episodes_to_train_batch": 0.04004123407798338, "general_advantage_estimation": 0.006913324340759949, "batch_individual_items": 0.036269472097591335, "add_one_ts_to_episodes_and_truncate": 0.010440219126065563, "add_states_from_episodes_to_batch": 3.710266617675375e-06, "add_time_dim_to_batch_and_zero_pad": 1.4291919688168836e-05, "add_observations_from_episodes_to_batch": 0.001172177333699852}}, "connector_pipeline_timer": 0.09508981458452902}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained_lifetime": 315000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 954628.9875456344, "num_module_steps_trained_throughput": 182354.8340195323, "num_module_steps_trained_lifetime_throughput": 181629.3901517166}, "default_policy": {"vf_explained_var": -0.005507946014404297, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.05242887884378433, "mean_kl_loss": 0.001431760611012578, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.12540626525879, "num_trainable_parameters": 6003, "policy_loss": -0.01831967383623123, "entropy": 0.5488011240959167, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.045452482998371124, "curr_kl_coeff": 0.0007290003122761846, "num_module_steps_trained_lifetime": 60000, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 182509.32315411768}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.435736609002821e-06, "batch_individual_items": 1.017550568425594e-05, "add_states_from_episodes_to_batch": 2.301857873228967e-06, "add_observations_from_episodes_to_batch": 4.66983497379666e-06, "numpy_to_tensor": 1.3479291391016892e-05}}, "connector_pipeline_timer": 6.468062124941369e-05}, "env_step_timer": 2.232632064082167e-05, "module_episode_returns_mean": {"default_policy": -1.4}, "num_env_steps_sampled_lifetime": 50400, "module_to_env_connector": {"connector_pipeline_timer": 0.00016024859954292853, "timers": {"connectors": {"get_actions": 6.339084004300299e-05, "remove_single_ts_time_rank_from_batch": 8.381021386677166e-07, "normalize_and_clip_actions": 1.3343310015793435e-05, "tensor_to_numpy": 2.168352222544925e-05, "listify_data_for_vector_env": 1.6261197202752763e-05, "un_batch_to_individual_items": 7.412285794807306e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.4}, "env_reset_timer": 0.00019553789087366498, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "sample": 0.1866748493247295, "episode_return_mean": -1.4, "num_env_steps_sampled": 400, "num_episodes_lifetime": 200, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.2857422093488565e-05, "episode_duration_sec_mean": 0.0072581150918267666, "weights_seq_no": 10.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6376740238073366}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-39", "timestamp": 1754933679, "time_this_iter_s": 2.9155080318450928, "time_total_s": 27.907116889953613, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.907116889953613, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 70.4, "ram_util_percent": 78.3}}
{"timers": {"training_iteration": 2.7406343331847545, "restore_env_runners": 1.3900403021121383e-05, "training_step": 2.740453358557146, "env_runner_sampling_timer": 2.5706755361795004, "learner_update_timer": 0.16325699397074736, "synch_weights": 0.0012815720150639392, "restore_eval_env_runners": 1.0580471658246853e-05, "evaluation_iteration": 0.19588719712660382, "synch_eval_env_connectors": 0.0002570138993621464, "synch_env_connectors": 4.471334697793821e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00016800663931751, "timers": {"connectors": {"normalize_and_clip_actions": 1.416488270745963e-05, "tensor_to_numpy": 2.0889242454589025e-05, "un_batch_to_individual_items": 8.027137321801225e-06, "listify_data_for_vector_env": 1.708349142278355e-05, "get_actions": 7.002071895374655e-05, "remove_single_ts_time_rank_from_batch": 8.528382578640871e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.0028447674951088014, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 5.14}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.800849973316954e-06, "numpy_to_tensor": 1.429960493319956e-05, "add_time_dim_to_batch_and_zero_pad": 3.7377495095359683e-06, "add_observations_from_episodes_to_batch": 4.441687402997874e-06, "add_states_from_episodes_to_batch": 2.4843658428295496e-06}}, "connector_pipeline_timer": 6.450882292882488e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00794746527464143, "rlmodule_inference_timer": 4.7045267239402415e-05, "env_step_timer": 2.1751700865948305e-05, "env_reset_timer": 7.015728344089803e-05, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_mean": 5.14, "weights_seq_no": 10.0, "episode_duration_sec_mean": 0.0071871738131158045, "module_episode_returns_mean": {"default_policy": 5.14}, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2574.9260626556375}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.241026956710057e-05, "add_columns_from_episodes_to_train_batch": 0.040187894657220495, "general_advantage_estimation": 0.0069293944271520466, "batch_individual_items": 0.03626529529628249, "add_one_ts_to_episodes_and_truncate": 0.010415994845663672, "add_states_from_episodes_to_batch": 3.7056636168930464e-06, "add_time_dim_to_batch_and_zero_pad": 1.4260250465284622e-05, "add_observations_from_episodes_to_batch": 0.0011808118108240443}}, "connector_pipeline_timer": 0.09523337977938899}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime": 346500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 979434.3936199953, "num_module_steps_trained_throughput": 187060.88028289596, "num_module_steps_trained_lifetime_throughput": 186365.15415722062}, "default_policy": {"vf_explained_var": -0.0021424293518066406, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.034589968621730804, "mean_kl_loss": 0.0012500360608100891, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.9683895111084, "num_trainable_parameters": 6003, "policy_loss": -0.03413091599941254, "entropy": 0.5197477340698242, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.02990320324897766, "curr_kl_coeff": 0.0003645001561380923, "num_module_steps_trained_lifetime": 66000, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 187182.48273083603}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.1988745234681157e-06, "batch_individual_items": 1.0968640673872363e-05, "add_states_from_episodes_to_batch": 2.5574279771326932e-06, "add_observations_from_episodes_to_batch": 3.789056811348419e-06, "numpy_to_tensor": 1.246291527809229e-05}}, "connector_pipeline_timer": 6.286281515971671e-05}, "env_step_timer": 2.305890072938661e-05, "module_episode_returns_mean": {"default_policy": -0.4}, "num_env_steps_sampled_lifetime": 55400, "module_to_env_connector": {"connector_pipeline_timer": 0.00015990547368464246, "timers": {"connectors": {"get_actions": 6.733133802398066e-05, "remove_single_ts_time_rank_from_batch": 7.366153286606316e-07, "normalize_and_clip_actions": 1.2458444904464242e-05, "tensor_to_numpy": 2.081619077331532e-05, "listify_data_for_vector_env": 1.5998547108135714e-05, "un_batch_to_individual_items": 7.08604947801785e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_reset_timer": 0.00019454709206868332, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "sample": 0.18614844541230388, "episode_return_mean": -0.4, "num_env_steps_sampled": 400, "num_episodes_lifetime": 220, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.646412211272507e-05, "episode_duration_sec_mean": 0.007176932989386842, "weights_seq_no": 11.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6344808518988136}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-42", "timestamp": 1754933682, "time_this_iter_s": 2.441519021987915, "time_total_s": 30.34863591194153, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.34863591194153, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 68.125, "ram_util_percent": 77.975}}
{"timers": {"training_iteration": 2.7430116327735723, "restore_env_runners": 1.3819728887911554e-05, "training_step": 2.7428301099720738, "env_runner_sampling_timer": 2.573486397898066, "learner_update_timer": 0.16284802070193755, "synch_weights": 0.001276557964330249, "restore_eval_env_runners": 1.0549667512751388e-05, "evaluation_iteration": 0.1953229051549523, "synch_eval_env_connectors": 0.000255657930265664, "synch_env_connectors": 4.471210747382035e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0002234906052121479, "timers": {"connectors": {"normalize_and_clip_actions": 1.6809798767412146e-05, "tensor_to_numpy": 2.4245010370348056e-05, "un_batch_to_individual_items": 8.962916216551012e-06, "listify_data_for_vector_env": 1.9333349651065838e-05, "get_actions": 0.00010951950628766403, "remove_single_ts_time_rank_from_batch": 1.0750078536225066e-06}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.0027785458026063276, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 4.980000000000002}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2293289444766265e-05, "numpy_to_tensor": 1.7039702732205604e-05, "add_time_dim_to_batch_and_zero_pad": 4.679257226762948e-06, "add_observations_from_episodes_to_batch": 5.2844034701200795e-06, "add_states_from_episodes_to_batch": 2.631884405891784e-06}}, "connector_pipeline_timer": 7.713161863877242e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.009395455773030852, "rlmodule_inference_timer": 5.963237095167168e-05, "env_step_timer": 2.757447652424142e-05, "env_reset_timer": 7.557836868596854e-05, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_mean": 4.980000000000002, "weights_seq_no": 11.0, "episode_duration_sec_mean": 0.009190877978689973, "module_episode_returns_mean": {"default_policy": 4.980000000000002}, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2322.3961838082787}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.261699700923371e-05, "add_columns_from_episodes_to_train_batch": 0.04027016112124003, "general_advantage_estimation": 0.006927527562073821, "batch_individual_items": 0.03625589484338247, "add_one_ts_to_episodes_and_truncate": 0.010394205737452892, "add_states_from_episodes_to_batch": 3.703186987919589e-06, "add_time_dim_to_batch_and_zero_pad": 1.4262647900580095e-05, "add_observations_from_episodes_to_batch": 0.001178921191980506}}, "connector_pipeline_timer": 0.0952806226510143}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained_lifetime": 378000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1001970.5662245064, "num_module_steps_trained_throughput": 191339.15484053848, "num_module_steps_trained_lifetime_throughput": 190669.27810877684}, "default_policy": {"vf_explained_var": -0.00040781497955322266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.06014768406748772, "mean_kl_loss": 0.0005731904529966414, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.940900802612305, "num_trainable_parameters": 6003, "policy_loss": -0.09440136700868607, "entropy": 0.4981132447719574, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": -0.030171997845172882, "curr_kl_coeff": 0.00018225007806904614, "num_module_steps_trained_lifetime": 72000, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 191432.13481365336}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.015090409661535e-06, "batch_individual_items": 1.0909863242848943e-05, "add_states_from_episodes_to_batch": 2.8575046432403826e-06, "add_observations_from_episodes_to_batch": 5.074281619586574e-06, "numpy_to_tensor": 1.7941351095540793e-05}}, "connector_pipeline_timer": 7.664813345375787e-05}, "env_step_timer": 2.8199943517622097e-05, "module_episode_returns_mean": {"default_policy": 0.6}, "num_env_steps_sampled_lifetime": 60400, "module_to_env_connector": {"connector_pipeline_timer": 0.00019435586066502732, "timers": {"connectors": {"get_actions": 7.825497449842789e-05, "remove_single_ts_time_rank_from_batch": 1.0114683815581356e-06, "normalize_and_clip_actions": 1.5829547684437892e-05, "tensor_to_numpy": 2.493081829769718e-05, "listify_data_for_vector_env": 2.0785170017954375e-05, "un_batch_to_individual_items": 8.833910302917824e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.6}, "env_reset_timer": 0.0001934616218756947, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "sample": 0.1862299288785121, "episode_return_mean": 0.6, "num_env_steps_sampled": 400, "num_episodes_lifetime": 240, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 5.366071781126216e-05, "episode_duration_sec_mean": 0.007838247935287654, "weights_seq_no": 12.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.638161984219958}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-45", "timestamp": 1754933685, "time_this_iter_s": 3.181670904159546, "time_total_s": 33.530306816101074, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.530306816101074, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 75.275, "ram_util_percent": 79.525}}
{"timers": {"training_iteration": 2.740625041036856, "restore_env_runners": 1.3823202060776508e-05, "training_step": 2.7404433892925733, "env_runner_sampling_timer": 2.571669346419234, "learner_update_timer": 0.16230860133464942, "synch_weights": 0.0012702815446919498, "restore_eval_env_runners": 1.0527091143054763e-05, "evaluation_iteration": 0.19537873235350187, "synch_eval_env_connectors": 0.0002544576011038233, "synch_env_connectors": 4.466919203799745e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017735025070704448, "timers": {"connectors": {"normalize_and_clip_actions": 1.4941636660035353e-05, "tensor_to_numpy": 2.1977142838505014e-05, "un_batch_to_individual_items": 8.239860194724724e-06, "listify_data_for_vector_env": 1.77915773396256e-05, "get_actions": 7.492039007054793e-05, "remove_single_ts_time_rank_from_batch": 8.704687215285059e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.0026727657942893722, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0615754163785625e-05, "numpy_to_tensor": 1.5035465640850343e-05, "add_time_dim_to_batch_and_zero_pad": 3.924371961284031e-06, "add_observations_from_episodes_to_batch": 4.485613497227743e-06, "add_states_from_episodes_to_batch": 2.5451652383431946e-06}}, "connector_pipeline_timer": 6.702259056166588e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.008361836553048136, "rlmodule_inference_timer": 4.784959126311691e-05, "env_step_timer": 2.3717124622443773e-05, "env_reset_timer": 7.410018932566349e-05, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_mean": 5.619999999999999, "weights_seq_no": 12.0, "episode_duration_sec_mean": 0.00749500468187034, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2455.1352502391055}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.264624722662957e-05, "add_columns_from_episodes_to_train_batch": 0.04024419658937791, "general_advantage_estimation": 0.00694159770687884, "batch_individual_items": 0.03621236756517257, "add_one_ts_to_episodes_and_truncate": 0.01038824118048725, "add_states_from_episodes_to_batch": 3.6986559475880368e-06, "add_time_dim_to_batch_and_zero_pad": 1.4235022297241033e-05, "add_observations_from_episodes_to_batch": 0.0011759174008566034}}, "connector_pipeline_timer": 0.09521590101447351}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained_lifetime": 409500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1024384.7911607682, "num_module_steps_trained_throughput": 195593.0923045494, "num_module_steps_trained_lifetime_throughput": 194949.1610684317}, "default_policy": {"vf_explained_var": -0.003191232681274414, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.030830301344394684, "mean_kl_loss": 0.00074898696038872, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.0755558013916, "num_trainable_parameters": 6003, "policy_loss": 0.06699463725090027, "entropy": 0.47185197472572327, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.13146176934242249, "curr_kl_coeff": 9.112503903452307e-05, "num_module_steps_trained_lifetime": 78000, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 195653.55911496523}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.6415683100079477e-06, "batch_individual_items": 1.0836296261016815e-05, "add_states_from_episodes_to_batch": 2.903347931441715e-06, "add_observations_from_episodes_to_batch": 4.872107911606665e-06, "numpy_to_tensor": 1.452784152842979e-05}}, "connector_pipeline_timer": 6.999899419160108e-05}, "env_step_timer": 2.5503208506655155e-05, "module_episode_returns_mean": {"default_policy": 1.0}, "num_env_steps_sampled_lifetime": 65400, "module_to_env_connector": {"connector_pipeline_timer": 0.00017836605968107275, "timers": {"connectors": {"get_actions": 7.319731937472182e-05, "remove_single_ts_time_rank_from_batch": 9.681992537127569e-07, "normalize_and_clip_actions": 1.4982038375298427e-05, "tensor_to_numpy": 2.130851225832291e-05, "listify_data_for_vector_env": 1.7891892884699187e-05, "un_batch_to_individual_items": 8.50078652406894e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 1.0}, "env_reset_timer": 0.0001924586763133655, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "sample": 0.18643417750925742, "episode_return_mean": 1.0, "num_env_steps_sampled": 400, "num_episodes_lifetime": 260, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 5.066323743657404e-05, "episode_duration_sec_mean": 0.008151340396143496, "weights_seq_no": 13.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.637060656878733}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-48", "timestamp": 1754933688, "time_this_iter_s": 2.719062089920044, "time_total_s": 36.24936890602112, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.24936890602112, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 69.17500000000001, "ram_util_percent": 78.55}}
{"timers": {"training_iteration": 2.738205541876013, "restore_env_runners": 1.3741219595369081e-05, "training_step": 2.7380235378992483, "env_runner_sampling_timer": 2.568330761705605, "learner_update_timer": 0.1632535769804155, "synch_weights": 0.0012657858091994756, "restore_eval_env_runners": 1.0501400581471888e-05, "evaluation_iteration": 0.19554826543999496, "synch_eval_env_connectors": 0.0002554259447404042, "synch_env_connectors": 4.460590233852229e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017228635099159306, "timers": {"connectors": {"normalize_and_clip_actions": 1.436705061900647e-05, "tensor_to_numpy": 2.101249967922482e-05, "un_batch_to_individual_items": 8.338142082902563e-06, "listify_data_for_vector_env": 1.699851669725677e-05, "get_actions": 7.264175371554704e-05, "remove_single_ts_time_rank_from_batch": 8.85466181768169e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002630731159856748, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0235691408994209e-05, "numpy_to_tensor": 1.474414690841059e-05, "add_time_dim_to_batch_and_zero_pad": 3.7558250186261628e-06, "add_observations_from_episodes_to_batch": 4.497800085693906e-06, "add_states_from_episodes_to_batch": 2.4064587150648218e-06}}, "connector_pipeline_timer": 6.61424889378726e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.0078080324373590885, "rlmodule_inference_timer": 4.682866736350264e-05, "env_step_timer": 2.289676794910804e-05, "env_reset_timer": 6.9658286334526e-05, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_mean": 5.299999999999998, "weights_seq_no": 13.0, "episode_duration_sec_mean": 0.007451616040430963, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2523.076204519885}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.280895450509844e-05, "add_columns_from_episodes_to_train_batch": 0.04035788795401369, "general_advantage_estimation": 0.006956219639792777, "batch_individual_items": 0.03748271596946657, "add_one_ts_to_episodes_and_truncate": 0.010369694189126985, "add_states_from_episodes_to_batch": 3.693749958348005e-06, "add_time_dim_to_batch_and_zero_pad": 1.4261421904022857e-05, "add_observations_from_episodes_to_batch": 0.0011756069764219386}}, "connector_pipeline_timer": 0.09659740367489252}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained_lifetime": 441000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1045584.7910699885, "num_module_steps_trained_throughput": 199596.01239839545, "num_module_steps_trained_lifetime_throughput": 198988.17902190905}, "default_policy": {"vf_explained_var": 0.001467287540435791, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.011624989099800587, "mean_kl_loss": 0.000890470459125936, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.947935104370117, "num_trainable_parameters": 6003, "policy_loss": -0.10861422121524811, "entropy": 0.4444359540939331, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": -0.043898805975914, "curr_kl_coeff": 4.5562519517261535e-05, "num_module_steps_trained_lifetime": 84000, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 199623.77352417924}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.8895227727945004e-06, "batch_individual_items": 8.558491345815077e-06, "add_states_from_episodes_to_batch": 2.0080249631199294e-06, "add_observations_from_episodes_to_batch": 3.6259554940051565e-06, "numpy_to_tensor": 1.1050406747631581e-05}}, "connector_pipeline_timer": 5.45938670047447e-05}, "env_step_timer": 1.826590384941968e-05, "module_episode_returns_mean": {"default_policy": 0.6}, "num_env_steps_sampled_lifetime": 70400, "module_to_env_connector": {"connector_pipeline_timer": 0.00013734038166470655, "timers": {"connectors": {"get_actions": 5.269786430150094e-05, "remove_single_ts_time_rank_from_batch": 7.349432022893347e-07, "normalize_and_clip_actions": 1.1776663501405128e-05, "tensor_to_numpy": 1.7456181610019568e-05, "listify_data_for_vector_env": 1.4652134410921906e-05, "un_batch_to_individual_items": 6.667175381419492e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.6}, "env_reset_timer": 0.00019159783921003835, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "sample": 0.18613417323476872, "episode_return_mean": 0.6, "num_env_steps_sampled": 400, "num_episodes_lifetime": 280, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.593739154858444e-05, "episode_duration_sec_mean": 0.008177013718523085, "weights_seq_no": 14.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.63588870739071}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-50", "timestamp": 1754933690, "time_this_iter_s": 2.664760112762451, "time_total_s": 38.91412901878357, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.91412901878357, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 68.55, "ram_util_percent": 78.275}}
{"timers": {"training_iteration": 2.7358704868768347, "restore_env_runners": 1.377089831083359e-05, "training_step": 2.7356875525195927, "env_runner_sampling_timer": 2.565135326178972, "learner_update_timer": 0.164109156620699, "synch_weights": 0.0012780275306920794, "restore_eval_env_runners": 1.0465136808115284e-05, "evaluation_iteration": 0.19522908028582164, "synch_eval_env_connectors": 0.0002547187750269286, "synch_env_connectors": 4.456814677338068e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017580398151894306, "timers": {"connectors": {"normalize_and_clip_actions": 1.4623801600021216e-05, "tensor_to_numpy": 2.2187907646568076e-05, "un_batch_to_individual_items": 8.576503088111469e-06, "listify_data_for_vector_env": 1.7543578090534895e-05, "get_actions": 7.369616816003147e-05, "remove_single_ts_time_rank_from_batch": 9.206501963649212e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002758404564177769, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 6.74}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0641604421528132e-05, "numpy_to_tensor": 1.5058386363859812e-05, "add_time_dim_to_batch_and_zero_pad": 4.150430384368867e-06, "add_observations_from_episodes_to_batch": 4.68871702618952e-06, "add_states_from_episodes_to_batch": 2.406398170047469e-06}}, "connector_pipeline_timer": 6.789046738220578e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.008092179432778943, "rlmodule_inference_timer": 4.761650185402329e-05, "env_step_timer": 2.3303918009335457e-05, "env_reset_timer": 7.846960523538336e-05, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_mean": 6.74, "weights_seq_no": 14.0, "episode_duration_sec_mean": 0.007435658506583426, "module_episode_returns_mean": {"default_policy": 6.74}, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2483.359880668838}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.290919489944264e-05, "add_columns_from_episodes_to_train_batch": 0.040345607404396855, "general_advantage_estimation": 0.006946939533375169, "batch_individual_items": 0.03884157422966666, "add_one_ts_to_episodes_and_truncate": 0.010354412666685745, "add_states_from_episodes_to_batch": 3.6939035444518045e-06, "add_time_dim_to_batch_and_zero_pad": 1.4232968042025775e-05, "add_observations_from_episodes_to_batch": 0.001172505907368579}}, "connector_pipeline_timer": 0.0979159746378548}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained_lifetime": 472500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1070658.3243231801, "num_module_steps_trained_throughput": 204344.35790043, "num_module_steps_trained_lifetime_throughput": 203767.42834812892}, "default_policy": {"vf_explained_var": 0.004027366638183594, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.04951922968029976, "mean_kl_loss": 0.00040324131259694695, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.907155990600586, "num_trainable_parameters": 6003, "policy_loss": -0.0023636831901967525, "entropy": 0.4242554008960724, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.06253442168235779, "curr_kl_coeff": 2.2781259758630767e-05, "num_module_steps_trained_lifetime": 90000, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 204341.72741752493}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.800042054331065e-06, "batch_individual_items": 7.474574368543288e-06, "add_states_from_episodes_to_batch": 1.852777063950037e-06, "add_observations_from_episodes_to_batch": 3.3568434372790873e-06, "numpy_to_tensor": 1.0745327717794057e-05}}, "connector_pipeline_timer": 5.1613318214255024e-05}, "env_step_timer": 1.753754020205686e-05, "module_episode_returns_mean": {"default_policy": 1.0}, "num_env_steps_sampled_lifetime": 75400, "module_to_env_connector": {"connector_pipeline_timer": 0.000127734538070206, "timers": {"connectors": {"get_actions": 4.8589335100590856e-05, "remove_single_ts_time_rank_from_batch": 8.241882415200901e-07, "normalize_and_clip_actions": 1.1142042441470925e-05, "tensor_to_numpy": 1.617779966847543e-05, "listify_data_for_vector_env": 1.3453761895915293e-05, "un_batch_to_individual_items": 6.300039381352535e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 1.0}, "env_reset_timer": 0.00019050311037745963, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "sample": 0.18599557275283543, "episode_return_mean": 1.0, "num_env_steps_sampled": 400, "num_episodes_lifetime": 300, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.480427260064641e-05, "episode_duration_sec_mean": 0.007950879125855863, "weights_seq_no": 15.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6348052040667795}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-53", "timestamp": 1754933693, "time_this_iter_s": 2.68436598777771, "time_total_s": 41.59849500656128, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.59849500656128, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 68.475, "ram_util_percent": 78.325}}
{"timers": {"training_iteration": 2.7406905790873166, "restore_env_runners": 1.370610955701121e-05, "training_step": 2.7405072715749204, "env_runner_sampling_timer": 2.56997778458764, "learner_update_timer": 0.1640838883941629, "synch_weights": 0.0012909780950828029, "restore_eval_env_runners": 1.0430065713736873e-05, "evaluation_iteration": 0.195049063232775, "synch_eval_env_connectors": 0.0002532140876477727, "synch_env_connectors": 4.45849717377331e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00023175019837502186, "timers": {"connectors": {"normalize_and_clip_actions": 1.969732318691191e-05, "tensor_to_numpy": 2.8037276356751972e-05, "un_batch_to_individual_items": 1.0043389526886737e-05, "listify_data_for_vector_env": 2.249971591806836e-05, "get_actions": 0.0001027822381813546, "remove_single_ts_time_rank_from_batch": 1.08920869584825e-06}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002994504392427571, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4463108692640233e-05, "numpy_to_tensor": 2.0429039424182167e-05, "add_time_dim_to_batch_and_zero_pad": 5.198709176203988e-06, "add_observations_from_episodes_to_batch": 6.437644682791582e-06, "add_states_from_episodes_to_batch": 2.9512219522841184e-06}}, "connector_pipeline_timer": 8.861987744321761e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.01018859671026767, "rlmodule_inference_timer": 7.56089738522406e-05, "env_step_timer": 3.1077911905130835e-05, "env_reset_timer": 8.632580504842393e-05, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_mean": 7.059999999999999, "weights_seq_no": 15.0, "episode_duration_sec_mean": 0.01021992231253535, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2100.54465633689}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.308510285664541e-05, "add_columns_from_episodes_to_train_batch": 0.040601834660803096, "general_advantage_estimation": 0.006939625138674046, "batch_individual_items": 0.038879503908371305, "add_one_ts_to_episodes_and_truncate": 0.010479373959818945, "add_states_from_episodes_to_batch": 3.6911347342699283e-06, "add_time_dim_to_batch_and_zero_pad": 1.426146736900758e-05, "add_observations_from_episodes_to_batch": 0.0011714066882267836}}, "connector_pipeline_timer": 0.0983269503112641}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1093667.4320864074, "num_module_steps_trained_throughput": 208700.2722026869, "num_module_steps_trained_lifetime_throughput": 208151.9272324189}, "default_policy": {"vf_explained_var": 0.010698795318603516, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.09217683970928192, "mean_kl_loss": 6.271064921747893e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.8068904876709, "num_trainable_parameters": 6003, "policy_loss": -0.07398297637701035, "entropy": 0.4163439869880676, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": -0.009013228118419647, "curr_kl_coeff": 1.1390629879315384e-05, "num_module_steps_trained_lifetime": 96000, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 208672.9567378004}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.3733182503426052e-06, "batch_individual_items": 1.0310105250805675e-05, "add_states_from_episodes_to_batch": 2.244791463484946e-06, "add_observations_from_episodes_to_batch": 4.0021504608648976e-06, "numpy_to_tensor": 1.3390345706825326e-05}}, "connector_pipeline_timer": 6.315919149642916e-05}, "env_step_timer": 2.3007713197117935e-05, "module_episode_returns_mean": {"default_policy": 0.6}, "num_env_steps_sampled_lifetime": 80400, "module_to_env_connector": {"connector_pipeline_timer": 0.00017805751055026588, "timers": {"connectors": {"get_actions": 7.100905547163615e-05, "remove_single_ts_time_rank_from_batch": 7.976055604150937e-07, "normalize_and_clip_actions": 1.5084902881871737e-05, "tensor_to_numpy": 2.257711525751589e-05, "listify_data_for_vector_env": 1.932659010700641e-05, "un_batch_to_individual_items": 8.444312333710806e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.6}, "env_reset_timer": 0.0001900839194582991, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "sample": 0.18583752952573696, "episode_return_mean": 0.6, "num_env_steps_sampled": 400, "num_episodes_lifetime": 320, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.309119343697159e-05, "episode_duration_sec_mean": 0.008292130775516852, "weights_seq_no": 16.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6409163791056374}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "43a37_00000", "date": "2025-08-11_19-34-56", "timestamp": 1754933696, "time_this_iter_s": 3.4029550552368164, "time_total_s": 45.001450061798096, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.001450061798096, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 74.85, "ram_util_percent": 79.175}}
{"timers": {"training_iteration": 2.7429299853763016, "restore_env_runners": 1.3630299218867121e-05, "training_step": 2.742745355529671, "env_runner_sampling_timer": 2.5727686054918313, "learner_update_timer": 0.16355587076021108, "synch_weights": 0.0012853891440319563, "restore_eval_env_runners": 1.0503684921254045e-05, "evaluation_iteration": 0.19491041385061167, "synch_eval_env_connectors": 0.0002521856962890189, "synch_env_connectors": 4.458072026064189e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00020183469105289947, "timers": {"connectors": {"normalize_and_clip_actions": 1.7235931953604383e-05, "tensor_to_numpy": 2.4610736440103398e-05, "un_batch_to_individual_items": 9.081393759297229e-06, "listify_data_for_vector_env": 2.0114721211968663e-05, "get_actions": 8.652262383381387e-05, "remove_single_ts_time_rank_from_batch": 9.489162947058946e-07}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002671051962869966, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 6.9}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2158021228860363e-05, "numpy_to_tensor": 1.8126936636369635e-05, "add_time_dim_to_batch_and_zero_pad": 4.569527387993006e-06, "add_observations_from_episodes_to_batch": 5.2265467978177486e-06, "add_states_from_episodes_to_batch": 2.7547800897811655e-06}}, "connector_pipeline_timer": 7.78269923123134e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00967297902880694, "rlmodule_inference_timer": 9.762094167887419e-05, "env_step_timer": 2.699325069390511e-05, "env_reset_timer": 7.963781815147518e-05, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_mean": 6.9, "weights_seq_no": 16.0, "episode_duration_sec_mean": 0.009656381993554536, "module_episode_returns_mean": {"default_policy": 6.9}, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2282.352382825996}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.315716131780001e-05, "add_columns_from_episodes_to_train_batch": 0.04060944715409798, "general_advantage_estimation": 0.006930492637197824, "batch_individual_items": 0.038827684699429044, "add_one_ts_to_episodes_and_truncate": 0.010476041470090073, "add_states_from_episodes_to_batch": 3.6875530935662805e-06, "add_time_dim_to_batch_and_zero_pad": 1.4226351767645713e-05, "add_observations_from_episodes_to_batch": 0.0011766401217522115}}, "connector_pipeline_timer": 0.09827519747854055}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained_lifetime": 535500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1117307.997230774, "num_module_steps_trained_throughput": 213182.56063339568, "num_module_steps_trained_lifetime_throughput": 212658.6502787783}, "default_policy": {"vf_explained_var": 0.011242687702178955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.06734903156757355, "mean_kl_loss": 8.43530724523589e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.776878356933594, "num_trainable_parameters": 6003, "policy_loss": -0.09269465506076813, "entropy": 0.4231090247631073, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": -0.027786191552877426, "curr_kl_coeff": 5.695314939657692e-06, "num_module_steps_trained_lifetime": 102000, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 213131.52521041178}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.979946352682215e-06, "batch_individual_items": 1.764184274306703e-05, "add_states_from_episodes_to_batch": 5.37894132614831e-06, "add_observations_from_episodes_to_batch": 1.028953306647677e-05, "numpy_to_tensor": 2.3729108653435905e-05}}, "connector_pipeline_timer": 0.00010452860903952867}, "env_step_timer": 3.876123482724985e-05, "module_episode_returns_mean": {"default_policy": 0.0}, "num_env_steps_sampled_lifetime": 85400, "module_to_env_connector": {"connector_pipeline_timer": 0.0002709244675848205, "timers": {"connectors": {"get_actions": 0.00011898476064693626, "remove_single_ts_time_rank_from_batch": 1.9471458117005155e-06, "normalize_and_clip_actions": 2.0081941828020616e-05, "tensor_to_numpy": 3.520535491051966e-05, "listify_data_for_vector_env": 2.4792640155739604e-05, "un_batch_to_individual_items": 1.2361881908140542e-05}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_reset_timer": 0.0001889651607240559, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "sample": 0.18603159714039644, "episode_return_mean": 0.0, "num_env_steps_sampled": 400, "num_episodes_lifetime": 340, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 7.836933269710108e-05, "episode_duration_sec_mean": 0.008379192501306533, "weights_seq_no": 17.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6444754182354444}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "43a37_00000", "date": "2025-08-11_19-35-00", "timestamp": 1754933700, "time_this_iter_s": 3.179509162902832, "time_total_s": 48.18095922470093, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.18095922470093, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 73.22, "ram_util_percent": 77.88}}
{"timers": {"training_iteration": 2.7512489834427565, "restore_env_runners": 1.3554826724792678e-05, "training_step": 2.7510640907248645, "env_runner_sampling_timer": 2.5787001344376037, "learner_update_timer": 0.16594444330294386, "synch_weights": 0.0012844935822971582, "restore_eval_env_runners": 1.0475308725617759e-05, "evaluation_iteration": 0.19508184971213818, "synch_eval_env_connectors": 0.00025136758920259807, "synch_env_connectors": 4.469321765845308e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00024923818281154773, "timers": {"connectors": {"normalize_and_clip_actions": 1.9778229129662908e-05, "tensor_to_numpy": 2.97527210066082e-05, "un_batch_to_individual_items": 1.1226093708345202e-05, "listify_data_for_vector_env": 2.3230980562330056e-05, "get_actions": 0.000108661479423868, "remove_single_ts_time_rank_from_batch": 1.215319746165882e-06}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.002662795343555196, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4271450725791518e-05, "numpy_to_tensor": 2.084246263811778e-05, "add_time_dim_to_batch_and_zero_pad": 5.414890526068735e-06, "add_observations_from_episodes_to_batch": 5.948846752192008e-06, "add_states_from_episodes_to_batch": 3.161137629373996e-06}}, "connector_pipeline_timer": 9.612233909136242e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.011621039478673685, "rlmodule_inference_timer": 7.022792537356741e-05, "env_step_timer": 3.34166906320471e-05, "env_reset_timer": 9.358825115680705e-05, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_mean": 7.059999999999999, "weights_seq_no": 17.0, "episode_duration_sec_mean": 0.010502658026292926, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 1933.0857063538685}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.315851030286071e-05, "add_columns_from_episodes_to_train_batch": 0.0405867493423019, "general_advantage_estimation": 0.006920469800176591, "batch_individual_items": 0.041466500763504964, "add_one_ts_to_episodes_and_truncate": 0.010462225636122948, "add_states_from_episodes_to_batch": 3.689847825965727e-06, "add_time_dim_to_batch_and_zero_pad": 1.424825830096282e-05, "add_observations_from_episodes_to_batch": 0.0011747624710356664}}, "connector_pipeline_timer": 0.10086532300372854}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained_lifetime": 567000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1127756.405728804, "num_module_steps_trained_throughput": 215153.7262593945, "num_module_steps_trained_lifetime_throughput": 214654.6329317353}, "default_policy": {"vf_explained_var": 0.01639944314956665, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.08864210546016693, "mean_kl_loss": 0.00011860190716106445, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.705440521240234, "num_trainable_parameters": 6003, "policy_loss": -0.1296107918024063, "entropy": 0.43428218364715576, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": -0.06480350345373154, "curr_kl_coeff": 2.847657469828846e-06, "num_module_steps_trained_lifetime": 108000, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 215086.39256518212}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.990560813784176e-06, "batch_individual_items": 8.313815439290046e-06, "add_states_from_episodes_to_batch": 2.1099609592611784e-06, "add_observations_from_episodes_to_batch": 3.9738974889839105e-06, "numpy_to_tensor": 1.3050945508307301e-05}}, "connector_pipeline_timer": 5.8992416632402264e-05}, "env_step_timer": 2.1436302982245466e-05, "module_episode_returns_mean": {"default_policy": 0.6}, "num_env_steps_sampled_lifetime": 90400, "module_to_env_connector": {"connector_pipeline_timer": 0.00015063768592819368, "timers": {"connectors": {"get_actions": 6.0580673540205833e-05, "remove_single_ts_time_rank_from_batch": 7.788025652856562e-07, "normalize_and_clip_actions": 1.2704548336783201e-05, "tensor_to_numpy": 1.9086801757694594e-05, "listify_data_for_vector_env": 1.535987758300519e-05, "un_batch_to_individual_items": 7.078668113855115e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.6}, "env_reset_timer": 0.00019143800915667595, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "sample": 0.18636360533960242, "episode_return_mean": 0.6, "num_env_steps_sampled": 400, "num_episodes_lifetime": 360, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.289225622540044e-05, "episode_duration_sec_mean": 0.00849865083117038, "weights_seq_no": 18.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6541848798930143}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "43a37_00000", "date": "2025-08-11_19-35-03", "timestamp": 1754933703, "time_this_iter_s": 3.8123271465301514, "time_total_s": 51.99328637123108, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.99328637123108, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 77.66, "ram_util_percent": 79.32000000000001}}
{"timers": {"training_iteration": 2.752310267358433, "restore_env_runners": 1.3497198724903174e-05, "training_step": 2.7521240223175, "env_runner_sampling_timer": 2.5787739993432326, "learner_update_timer": 0.1669148463696892, "synch_weights": 0.0012939923963531147, "restore_eval_env_runners": 1.0443475867647536e-05, "evaluation_iteration": 0.19545951037464018, "synch_eval_env_connectors": 0.00025014350287395676, "synch_env_connectors": 4.465457729857998e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00020272987310842965, "timers": {"connectors": {"normalize_and_clip_actions": 1.6903552806300834e-05, "tensor_to_numpy": 2.510874682489382e-05, "un_batch_to_individual_items": 9.509556038826094e-06, "listify_data_for_vector_env": 2.068465418539999e-05, "get_actions": 8.623881318330521e-05, "remove_single_ts_time_rank_from_batch": 1.0354658411174762e-06}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.0037769713422090385, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 6.74}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2066595133020299e-05, "numpy_to_tensor": 1.7398666790982565e-05, "add_time_dim_to_batch_and_zero_pad": 4.433430978245017e-06, "add_observations_from_episodes_to_batch": 5.166777187098475e-06, "add_states_from_episodes_to_batch": 2.5863389304458787e-06}}, "connector_pipeline_timer": 7.56933155899191e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.009885316423993151, "rlmodule_inference_timer": 5.5709769857322556e-05, "env_step_timer": 2.7276920875824266e-05, "env_reset_timer": 8.336819075392923e-05, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_mean": 6.74, "weights_seq_no": 18.0, "episode_duration_sec_mean": 0.008683273281902076, "module_episode_returns_mean": {"default_policy": 6.74}, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2237.2463915292196}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.321484505271473e-05, "add_columns_from_episodes_to_train_batch": 0.040652582679263964, "general_advantage_estimation": 0.006936411352378077, "batch_individual_items": 0.04265155367605033, "add_one_ts_to_episodes_and_truncate": 0.010522128800166689, "add_states_from_episodes_to_batch": 3.698789044828643e-06, "add_time_dim_to_batch_and_zero_pad": 1.4302025175029384e-05, "add_observations_from_episodes_to_batch": 0.0011787794262007045}}, "connector_pipeline_timer": 0.10219629018345745}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained_lifetime": 598500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1133797.7318568206, "num_module_steps_trained_throughput": 216294.73721014793, "num_module_steps_trained_lifetime_throughput": 215816.40578225223}, "default_policy": {"vf_explained_var": 0.007687926292419434, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.13775816559791565, "mean_kl_loss": 0.000583978951908648, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.868133544921875, "num_trainable_parameters": 6003, "policy_loss": -0.059229280799627304, "entropy": 0.41222673654556274, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.005777741316705942, "curr_kl_coeff": 1.423828734914423e-06, "num_module_steps_trained_lifetime": 114000, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 216215.25938634068}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.5601419894349148e-06, "batch_individual_items": 9.903256102285827e-06, "add_states_from_episodes_to_batch": 2.2024129417279872e-06, "add_observations_from_episodes_to_batch": 5.0503782870803975e-06, "numpy_to_tensor": 1.628781385618408e-05}}, "connector_pipeline_timer": 6.789599197675284e-05}, "env_step_timer": 2.386601769096351e-05, "module_episode_returns_mean": {"default_policy": 0.4}, "num_env_steps_sampled_lifetime": 95400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001706840202694225, "timers": {"connectors": {"get_actions": 6.790204456522338e-05, "remove_single_ts_time_rank_from_batch": 7.747429217842516e-07, "normalize_and_clip_actions": 1.3804391740885599e-05, "tensor_to_numpy": 2.1784233960562776e-05, "listify_data_for_vector_env": 1.653824935827314e-05, "un_batch_to_individual_items": 8.672441155971953e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.4}, "env_reset_timer": 0.0001910032200752476, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "sample": 0.18647728012578116, "episode_return_mean": 0.4, "num_env_steps_sampled": 400, "num_episodes_lifetime": 380, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_return_min": -14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.374128304214075e-05, "episode_duration_sec_mean": 0.008889380836626515, "weights_seq_no": 19.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6568484785946556}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "43a37_00000", "date": "2025-08-11_19-35-07", "timestamp": 1754933707, "time_this_iter_s": 3.0699520111083984, "time_total_s": 55.06323838233948, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.06323838233948, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 72.125, "ram_util_percent": 78.85}}
{"timers": {"training_iteration": 2.752228559264213, "restore_env_runners": 1.3438476445144348e-05, "training_step": 2.7520406637540415, "env_runner_sampling_timer": 2.579103296010235, "learner_update_timer": 0.16650818290559868, "synch_weights": 0.001294119142315631, "restore_eval_env_runners": 1.0490711646860064e-05, "evaluation_iteration": 0.1955695965207973, "synch_eval_env_connectors": 0.0002514878980603584, "synch_env_connectors": 4.462053757695573e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00021019198246821185, "timers": {"connectors": {"normalize_and_clip_actions": 1.7067012578536328e-05, "tensor_to_numpy": 2.6456824262497915e-05, "un_batch_to_individual_items": 9.417694824451308e-06, "listify_data_for_vector_env": 2.0882555745620653e-05, "get_actions": 8.96971527299622e-05, "remove_single_ts_time_rank_from_batch": 1.092011271549714e-06}}}, "episode_return_min": -11.5, "episode_len_max": 20, "time_between_sampling": 0.0031447390943604, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 6.5}, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2164999843708333e-05, "numpy_to_tensor": 1.8070521220932613e-05, "add_time_dim_to_batch_and_zero_pad": 4.546417210757495e-06, "add_observations_from_episodes_to_batch": 5.206777544448721e-06, "add_states_from_episodes_to_batch": 2.851953150355733e-06}}, "connector_pipeline_timer": 7.631565833532144e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.009433798869435994, "rlmodule_inference_timer": 5.585485535730056e-05, "env_step_timer": 2.781524324214137e-05, "env_reset_timer": 7.855619367132621e-05, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_mean": 6.5, "weights_seq_no": 19.0, "episode_duration_sec_mean": 0.008746760369744151, "module_episode_returns_mean": {"default_policy": 6.5}, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2296.6249126588114}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.31339460313986e-05, "add_columns_from_episodes_to_train_batch": 0.040711586852399874, "general_advantage_estimation": 0.006922057658891729, "batch_individual_items": 0.04253352938932425, "add_one_ts_to_episodes_and_truncate": 0.010614717091714378, "add_states_from_episodes_to_batch": 3.700130899091875e-06, "add_time_dim_to_batch_and_zero_pad": 1.4294834828327103e-05, "add_observations_from_episodes_to_batch": 0.0011824153815122261}}, "connector_pipeline_timer": 0.10221882478202945}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained_lifetime": 630000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1142819.4031205121, "num_module_steps_trained_throughput": 218006.6966494166, "num_module_steps_trained_lifetime_throughput": 217537.96267712628}, "default_policy": {"vf_explained_var": 0.004387497901916504, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.04194527864456177, "mean_kl_loss": 0.001483448431827128, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.988771438598633, "num_trainable_parameters": 6003, "policy_loss": -0.0328749418258667, "entropy": 0.37009090185165405, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "total_loss": 0.03251373767852783, "curr_kl_coeff": 7.119143674572115e-07, "num_module_steps_trained_lifetime": 120000, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 217894.29600261312}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.1281773392438235e-06, "batch_individual_items": 8.977686947283863e-06, "add_states_from_episodes_to_batch": 2.0973694160294997e-06, "add_observations_from_episodes_to_batch": 4.012783582146579e-06, "numpy_to_tensor": 1.1796683855903158e-05}}, "connector_pipeline_timer": 5.8573305097845476e-05}, "env_step_timer": 1.9785064243798735e-05, "module_episode_returns_mean": {"default_policy": 0.6}, "num_env_steps_sampled_lifetime": 100400, "module_to_env_connector": {"connector_pipeline_timer": 0.0001385303900227786, "timers": {"connectors": {"get_actions": 5.430301544626681e-05, "remove_single_ts_time_rank_from_batch": 6.956713964282753e-07, "normalize_and_clip_actions": 1.161574092833356e-05, "tensor_to_numpy": 1.7244330617070725e-05, "listify_data_for_vector_env": 1.4651386688535065e-05, "un_batch_to_individual_items": 6.595510168392773e-06}}}, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.6}, "env_reset_timer": 0.00018984360802391087, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "sample": 0.18617524524484486, "episode_return_mean": 0.6, "num_env_steps_sampled": 400, "num_episodes_lifetime": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_return_min": -12.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.9254332412211086e-05, "episode_duration_sec_mean": 0.008745754145784303, "weights_seq_no": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "time_between_sampling": 2.6580175700577646}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "43a37_00000", "date": "2025-08-11_19-35-09", "timestamp": 1754933709, "time_this_iter_s": 2.9105300903320312, "time_total_s": 57.97376847267151, "pid": 26822, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fbf18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.97376847267151, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 57.1, "ram_util_percent": 78.92}}
