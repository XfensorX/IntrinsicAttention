{"timers": {"training_iteration": 17.437333750072867, "restore_env_runners": 5.124998278915882e-05, "training_step": 17.43666016694624, "env_runner_sampling_timer": 16.682461499935016, "learner_update_timer": 0.7308824580395594, "synch_weights": 0.007324166945181787}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.0006190626360640723, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.1068009416268952e-05, "numpy_to_tensor": 0.000122119911387022, "batch_individual_items": 0.00010036104069752304, "add_time_dim_to_batch_and_zero_pad": 2.422688224041937e-05, "add_observations_from_episodes_to_batch": 2.6372321085111394e-05}}, "connector_pipeline_timer": 0.0004654570928119918}, "num_episodes_lifetime": 31375.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "agent_episode_returns_mean": {"default_agent": 2.740000000000001}, "episode_return_min": -5.5, "time_between_sampling": 0.0033286267591269843, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 4.433706354057362e-06, "get_actions": 0.0006036023842956906, "listify_data_for_vector_env": 0.00014091353200546342, "un_batch_to_individual_items": 5.4082844540035204e-05, "normalize_and_clip_actions": 0.00010186886473690907, "tensor_to_numpy": 0.00013870162300592492}}, "connector_pipeline_timer": 0.0012387936144049613}, "sample": 0.05281182982816124, "episode_duration_sec_mean": 0.05931289403839036, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 2.740000000000001}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_reset_timer": 0.0006916991896073643, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 0.0002001858655957044, "episode_return_mean": 2.740000000000001, "episode_len_max": 20, "weights_seq_no": 0.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 597.4872269251119}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.3732481598854065, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 6000, "vf_loss": 0.09794427454471588, "gradients_default_optimizer_global_norm": 0.18117614090442657, "entropy": 0.6885873675346375, "num_trainable_parameters": 6003, "vf_explained_var": 0.0010921955108642578, "vf_loss_unclipped": 30.640653610229492, "policy_loss": -0.06464065611362457, "weights_seq_no": 1.0, "mean_kl_loss": 0.0010491644497960806, "total_loss": -0.004588165320456028, "num_module_steps_trained_lifetime_throughput": 90017.48231713584}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00042112497612833977, "general_advantage_estimation": 0.045056666946038604, "batch_individual_items": 0.16969916701782495, "add_time_dim_to_batch_and_zero_pad": 5.570892244577408e-05, "add_columns_from_episodes_to_train_batch": 0.1251940419897437, "add_observations_from_episodes_to_batch": 0.008732250076718628, "add_one_ts_to_episodes_and_truncate": 0.03512537502683699, "add_states_from_episodes_to_batch": 7.834052667021751e-06}}, "connector_pipeline_timer": 0.38461058295797557}, "learner_connector_sum_episodes_length_out": 5250, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 464352.7539630189, "num_module_steps_trained_throughput": 88816.09304693765, "num_module_steps_trained_lifetime_throughput": 88665.63117432663}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 5.426810495495023e-06, "numpy_to_tensor": 5.8939070298648615e-05, "batch_individual_items": 0.00021887051562282847, "add_time_dim_to_batch_and_zero_pad": 1.0314777198956366e-05, "add_observations_from_episodes_to_batch": 9.687952550879186e-05}}, "connector_pipeline_timer": 0.0006499560377697211}, "rlmodule_inference_timer": 0.00034590266198143775, "num_episodes_lifetime": 20, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.3}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_return_mean": -0.3, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 6.516535939398697e-05, "remove_single_ts_time_rank_from_batch": 4.7274919124538635e-06, "tensor_to_numpy": 0.0001688964602853435, "listify_data_for_vector_env": 0.0001021843938848012, "get_actions": 0.0004302842166197468, "un_batch_to_individual_items": 5.679853257093608e-05}}, "connector_pipeline_timer": 0.0009548685003955587}, "env_reset_timer": 0.00102937500923872, "env_step_timer": 0.0003197214569775383, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 5400, "env_to_module_sum_episodes_length_in": 10.216013141322508, "sample": 1.5789409580174834, "episode_return_max": 14.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_duration_sec_mean": 0.07518696874612943, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": -0.3}, "weights_seq_no": 1.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "49ece_00000", "date": "2025-08-11_19-28-15", "timestamp": 1754933295, "time_this_iter_s": 19.199641227722168, "time_total_s": 19.199641227722168, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.199641227722168, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 96.28888888888889, "ram_util_percent": 83.23333333333333}}
{"timers": {"training_iteration": 17.414105218412587, "restore_env_runners": 5.102832335978746e-05, "training_step": 17.41343336068676, "env_runner_sampling_timer": 16.6584365016059, "learner_update_timer": 0.7317969955399166, "synch_weights": 0.007273780695395545, "restore_eval_env_runners": 5.6333024986088276e-05, "evaluation_iteration": 1.7018793750321493, "synch_eval_env_connectors": 0.0006893329555168748, "synch_env_connectors": 1.0750023648142815e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00033555456828339344, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.463929284287032e-06, "numpy_to_tensor": 0.00010097393471271375, "batch_individual_items": 4.634326092177542e-05, "add_time_dim_to_batch_and_zero_pad": 3.609825332678285e-05, "add_observations_from_episodes_to_batch": 2.387123946839246e-05}}, "connector_pipeline_timer": 0.0003265634228469888}, "num_episodes_lifetime": 500.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 4.5}, "episode_return_min": -5.5, "time_between_sampling": 0.015122253310096137, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 4.346316766013611e-06, "get_actions": 0.0006121009988443648, "listify_data_for_vector_env": 9.20099853711236e-05, "un_batch_to_individual_items": 4.183688844913068e-05, "normalize_and_clip_actions": 9.869480381467616e-05, "tensor_to_numpy": 0.00013229503245965486}}, "connector_pipeline_timer": 0.0013151001714304853}, "sample": 0.05869457493559577, "episode_duration_sec_mean": 0.04912854249170048, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 4.5}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00032598676618776146, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 0.00015133602235771671, "episode_return_mean": 4.5, "episode_len_max": 20, "weights_seq_no": 1.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 729.5037805080467}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.18662407994270325, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 12000, "vf_loss": 0.09875519573688507, "gradients_default_optimizer_global_norm": 0.04752764850854874, "entropy": 0.691445529460907, "num_trainable_parameters": 6003, "vf_explained_var": 7.56978988647461e-05, "vf_loss_unclipped": 32.4010124206543, "policy_loss": -0.08004441857337952, "weights_seq_no": 2.0, "mean_kl_loss": 0.0011109872721135616, "total_loss": -0.019843995571136475, "num_module_steps_trained_lifetime_throughput": 89821.25730870702}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00042307706666179, "general_advantage_estimation": 0.04478603860596195, "batch_individual_items": 0.17356838242849335, "add_time_dim_to_batch_and_zero_pad": 5.624808254651726e-05, "add_columns_from_episodes_to_train_batch": 0.12523123865015803, "add_observations_from_episodes_to_batch": 0.008675812575966118, "add_one_ts_to_episodes_and_truncate": 0.03501559169613756, "add_states_from_episodes_to_batch": 7.914461893960833e-06}}, "connector_pipeline_timer": 0.38808196295751257}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 463405.21763963543, "num_module_steps_trained_throughput": 88636.24973511185, "num_module_steps_trained_lifetime_throughput": 88483.28488331907}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1175485634627717e-06, "numpy_to_tensor": 3.661286373793642e-05, "batch_individual_items": 2.421568061953233e-05, "add_time_dim_to_batch_and_zero_pad": 9.531051099154065e-06, "add_observations_from_episodes_to_batch": 9.80020787347109e-06}}, "connector_pipeline_timer": 0.00013490050118220218}, "rlmodule_inference_timer": 0.00013509754016923992, "num_episodes_lifetime": 40, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.7}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_return_mean": 0.7, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.0337331499694785e-05, "remove_single_ts_time_rank_from_batch": 2.009461895244329e-06, "tensor_to_numpy": 0.00010766390688285999, "listify_data_for_vector_env": 3.237293222128411e-05, "get_actions": 0.0001943575481868874, "un_batch_to_individual_items": 1.5560052454335316e-05}}, "connector_pipeline_timer": 0.0004540823157447091}, "env_reset_timer": 0.0010258375096600502, "env_step_timer": 6.392145510348438e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 10400, "env_to_module_sum_episodes_length_in": 10.366003441359926, "sample": 1.5687316780269611, "episode_return_max": 14.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_duration_sec_mean": 0.04927851774264127, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 0.7}, "weights_seq_no": 2.0, "time_between_sampling": 15.317589750047773}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "49ece_00000", "date": "2025-08-11_19-28-30", "timestamp": 1754933310, "time_this_iter_s": 15.70841383934021, "time_total_s": 34.90805506706238, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.90805506706238, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 94.89047619047619, "ram_util_percent": 82.33333333333334}}
{"timers": {"training_iteration": 17.32333349747773, "restore_env_runners": 5.064346017315983e-05, "training_step": 17.32266140792001, "env_runner_sampling_timer": 16.572272323670585, "learner_update_timer": 0.727344454744237, "synch_weights": 0.0072157437174930235, "restore_eval_env_runners": 5.594761460088193e-05, "evaluation_iteration": 1.6907221342017875, "synch_eval_env_connectors": 0.0006868508760817349, "synch_env_connectors": 1.0708774207159877e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00022368020746545367, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 6.1926824572641525e-06, "numpy_to_tensor": 5.626815771849153e-05, "batch_individual_items": 3.371120831422991e-05, "add_time_dim_to_batch_and_zero_pad": 2.244571877826723e-05, "add_observations_from_episodes_to_batch": 1.3324262906891739e-05}}, "connector_pipeline_timer": 0.0002242057638525338}, "num_episodes_lifetime": -30375.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "episode_return_min": -5.5, "time_between_sampling": 0.009830366839508217, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.6402042785116073e-06, "get_actions": 0.0003037063438899454, "listify_data_for_vector_env": 5.969118906666158e-05, "un_batch_to_individual_items": 2.544807249466018e-05, "normalize_and_clip_actions": 4.20966462017219e-05, "tensor_to_numpy": 8.541048210180189e-05}}, "connector_pipeline_timer": 0.0006304300311989888}, "sample": 0.0361985813325081, "episode_duration_sec_mean": 0.028244550826027993, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.0002606070506207614, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 0.00010600285942226612, "episode_return_mean": 5.460000000000001, "episode_len_max": 20, "weights_seq_no": 2.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 985.576570501788}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.09331203997135162, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 18000, "vf_loss": 0.09795084595680237, "gradients_default_optimizer_global_norm": 0.1847822666168213, "entropy": 0.6914345622062683, "num_trainable_parameters": 6003, "vf_explained_var": 0.0010613203048706055, "vf_loss_unclipped": 30.6032657623291, "policy_loss": 0.1828346997499466, "weights_seq_no": 3.0, "mean_kl_loss": 0.0013817347353324294, "total_loss": 0.24234046041965485, "num_module_steps_trained_lifetime_throughput": 90550.13033702674}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0004198571255779825, "general_advantage_estimation": 0.04453328446920495, "batch_individual_items": 0.1723160581846023, "add_time_dim_to_batch_and_zero_pad": 5.605519126402214e-05, "add_columns_from_episodes_to_train_batch": 0.125213089593593, "add_observations_from_episodes_to_batch": 0.008674844450363888, "add_one_ts_to_episodes_and_truncate": 0.034921630359755367, "add_states_from_episodes_to_batch": 7.90823750430718e-06}}, "connector_pipeline_timer": 0.3864595520774135}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 467403.82935966155, "num_module_steps_trained_throughput": 89393.66194913966, "num_module_steps_trained_lifetime_throughput": 89240.50169989989}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.921651437075507e-06, "numpy_to_tensor": 5.1486430419816896e-05, "batch_individual_items": 2.1448736394612262e-05, "add_time_dim_to_batch_and_zero_pad": 6.358009260559596e-06, "add_observations_from_episodes_to_batch": 1.3417880954434798e-05}}, "connector_pipeline_timer": 0.00019337747569151377}, "rlmodule_inference_timer": 0.00012534390828426592, "num_episodes_lifetime": 60, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.36666666666666664}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_return_mean": 0.36666666666666664, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 5.631882650053314e-05, "remove_single_ts_time_rank_from_batch": 1.4443544042819138e-06, "tensor_to_numpy": 5.301932122429408e-05, "listify_data_for_vector_env": 4.324678058494099e-05, "get_actions": 0.00018595502343852506, "un_batch_to_individual_items": 1.7009046215862537e-05}}, "connector_pipeline_timer": 0.00043374285742818367}, "env_reset_timer": 0.0010175266348407604, "env_step_timer": 5.6403332858498206e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 15400, "env_to_module_sum_episodes_length_in": 10.368205581254823, "sample": 1.556904067496478, "episode_return_max": 14.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_duration_sec_mean": 0.038851452083326875, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 0.36666666666666664}, "weights_seq_no": 3.0, "time_between_sampling": 15.249172055887756}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "49ece_00000", "date": "2025-08-11_19-28-39", "timestamp": 1754933319, "time_this_iter_s": 8.75534987449646, "time_total_s": 43.66340494155884, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.66340494155884, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 81.60833333333335, "ram_util_percent": 78.825}}
{"timers": {"training_iteration": 17.199353201252983, "restore_env_runners": 5.025494497921316e-05, "training_step": 17.198666204250365, "env_runner_sampling_timer": 16.453637279603953, "learner_update_timer": 0.7221280422766962, "synch_weights": 0.007158689199742046, "restore_eval_env_runners": 5.562188877956942e-05, "evaluation_iteration": 1.6779243978601417, "synch_eval_env_connectors": 0.0006859069572528823, "synch_env_connectors": 1.068918538512662e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010771552621920815, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.641604574286812e-06, "numpy_to_tensor": 3.39141898060284e-05, "batch_individual_items": 1.9247636462707374e-05, "add_time_dim_to_batch_and_zero_pad": 6.834722920606125e-06, "add_observations_from_episodes_to_batch": 8.31279594893527e-06}}, "connector_pipeline_timer": 0.00012746402406911688}, "num_episodes_lifetime": -61250.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "episode_return_min": -5.5, "time_between_sampling": 0.0059328686380312875, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.487324117170076e-06, "get_actions": 0.00016705814710275146, "listify_data_for_vector_env": 3.5381123668720655e-05, "un_batch_to_individual_items": 1.5534568897558044e-05, "normalize_and_clip_actions": 2.7654223740905963e-05, "tensor_to_numpy": 4.6051351462105855e-05}}, "connector_pipeline_timer": 0.0003603392536231416}, "sample": 0.021517447746328425, "episode_duration_sec_mean": 0.015369334985502059, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.0001697697810735241, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 5.3402280167932936e-05, "episode_return_mean": 5.940000000000001, "episode_len_max": 20, "weights_seq_no": 3.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1560.3195592189102}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.04665601998567581, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 24000, "vf_loss": 0.09893853217363358, "gradients_default_optimizer_global_norm": 0.15090256929397583, "entropy": 0.6874051094055176, "num_trainable_parameters": 6003, "vf_explained_var": 0.0005099177360534668, "vf_loss_unclipped": 32.7551155090332, "policy_loss": 0.0005972132785245776, "weights_seq_no": 4.0, "mean_kl_loss": 0.0017084633000195026, "total_loss": 0.06070161238312721, "num_module_steps_trained_lifetime_throughput": 91169.06025416951}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00041639730499975846, "general_advantage_estimation": 0.044254809964893616, "batch_individual_items": 0.17097843177237432, "add_time_dim_to_batch_and_zero_pad": 5.561963913904037e-05, "add_columns_from_episodes_to_train_batch": 0.12468156994721943, "add_observations_from_episodes_to_batch": 0.008601222675079014, "add_one_ts_to_episodes_and_truncate": 0.034771666146109, "add_states_from_episodes_to_batch": 7.875405772472731e-06}}, "connector_pipeline_timer": 0.3840837361466389}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 470909.5108588544, "num_module_steps_trained_throughput": 90052.35516226024, "num_module_steps_trained_lifetime_throughput": 89900.07972984016}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.4924820672784673e-06, "numpy_to_tensor": 2.3449646824495646e-05, "batch_individual_items": 1.8981635663822388e-05, "add_time_dim_to_batch_and_zero_pad": 5.615133188688847e-06, "add_observations_from_episodes_to_batch": 6.485634662148027e-06}}, "connector_pipeline_timer": 0.00011686403377730516}, "rlmodule_inference_timer": 0.00011544444331738431, "num_episodes_lifetime": 80, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.7}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_return_mean": 0.7, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.7484074255954277e-05, "remove_single_ts_time_rank_from_batch": 1.2983740019317796e-06, "tensor_to_numpy": 0.00010713628239764747, "listify_data_for_vector_env": 2.5724713840468052e-05, "get_actions": 0.00014180454592873666, "un_batch_to_individual_items": 1.2596517897186233e-05}}, "connector_pipeline_timer": 0.0003800015247503275}, "env_reset_timer": 0.0010086905288639247, "env_step_timer": 3.5367044178886585e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 20400, "env_to_module_sum_episodes_length_in": 10.368237912813044, "sample": 1.5437745209824485, "episode_return_max": 14.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_duration_sec_mean": 0.0319866156365606, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 0.7}, "weights_seq_no": 4.0, "time_between_sampling": 15.146478391169534}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "49ece_00000", "date": "2025-08-11_19-28-45", "timestamp": 1754933325, "time_this_iter_s": 5.182943105697632, "time_total_s": 48.84634804725647, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.84634804725647, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 89.21428571428571, "ram_util_percent": 76.68571428571428}}
{"timers": {"training_iteration": 17.069874939660572, "restore_env_runners": 4.981614572380668e-05, "training_step": 17.069188462208263, "env_runner_sampling_timer": 16.329382039727395, "learner_update_timer": 0.7170564431037956, "synch_weights": 0.0071139743866327435, "restore_eval_env_runners": 5.518816907831934e-05, "evaluation_iteration": 1.6636749784718508, "synch_eval_env_connectors": 0.0006831407977745402, "synch_env_connectors": 1.0638123991317114e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00012991493228004433, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7633260174091185e-06, "numpy_to_tensor": 2.645578747500416e-05, "batch_individual_items": 1.8343345341424376e-05, "add_time_dim_to_batch_and_zero_pad": 5.660462830373478e-06, "add_observations_from_episodes_to_batch": 8.03188318032396e-06}}, "connector_pipeline_timer": 0.00010909081460037255}, "num_episodes_lifetime": -92125.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 6.5}, "episode_return_min": -5.5, "time_between_sampling": 0.0039436346804389115, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4262941286059577e-06, "get_actions": 0.00013113501836564212, "listify_data_for_vector_env": 2.9423261853830183e-05, "un_batch_to_individual_items": 1.2802427177971043e-05, "normalize_and_clip_actions": 2.409848340970091e-05, "tensor_to_numpy": 3.77369204249729e-05}}, "connector_pipeline_timer": 0.0002977567998768328}, "sample": 0.014824516206152187, "episode_duration_sec_mean": 0.01384400784596801, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 6.5}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.0001310706065133566, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 4.2137623120318697e-05, "episode_return_mean": 6.5, "episode_len_max": 20, "weights_seq_no": 4.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1769.0796982361148}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.023328009992837906, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 30000, "vf_loss": 0.09875169396400452, "gradients_default_optimizer_global_norm": 0.07133479416370392, "entropy": 0.6789590120315552, "num_trainable_parameters": 6003, "vf_explained_var": 0.0012282133102416992, "vf_loss_unclipped": 32.43641662597656, "policy_loss": 0.07381351292133331, "weights_seq_no": 5.0, "mean_kl_loss": 0.0014019616646692157, "total_loss": 0.13377542793750763, "num_module_steps_trained_lifetime_throughput": 91831.60781657821}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0004136979123683029, "general_advantage_estimation": 0.04423586478573593, "batch_individual_items": 0.16983561203486236, "add_time_dim_to_batch_and_zero_pad": 5.518760201668483e-05, "add_columns_from_episodes_to_train_batch": 0.1238800946678667, "add_observations_from_episodes_to_batch": 0.008527029197227028, "add_one_ts_to_episodes_and_truncate": 0.034520924894772195, "add_states_from_episodes_to_batch": 7.829571639454224e-06}}, "connector_pipeline_timer": 0.38179062878562925}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 474723.52535404795, "num_module_steps_trained_throughput": 90765.4790176288, "num_module_steps_trained_lifetime_throughput": 90616.06939020913}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3775010003903717e-06, "numpy_to_tensor": 2.703611471152287e-05, "batch_individual_items": 1.75551130494902e-05, "add_time_dim_to_batch_and_zero_pad": 1.9878959183339873e-05, "add_observations_from_episodes_to_batch": 9.471702930090245e-06}}, "connector_pipeline_timer": 0.00012497023491385287}, "rlmodule_inference_timer": 9.74797231412734e-05, "num_episodes_lifetime": 100, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.7}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_return_mean": 1.7, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.8799661091740852e-05, "remove_single_ts_time_rank_from_batch": 1.4321985157503158e-06, "tensor_to_numpy": 5.750962127935526e-05, "listify_data_for_vector_env": 3.4075375476805106e-05, "get_actions": 0.00013603829242034662, "un_batch_to_individual_items": 1.342270221026775e-05}}, "connector_pipeline_timer": 0.000342563431005836}, "env_reset_timer": 0.0010003136237903836, "env_step_timer": 4.763575327048092e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 25400, "env_to_module_sum_episodes_length_in": 10.368238387501162, "sample": 1.5314240107737727, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_duration_sec_mean": 0.028461947118630634, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 1.7}, "weights_seq_no": 5.0, "time_between_sampling": 15.037925901008398}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "49ece_00000", "date": "2025-08-11_19-28-49", "timestamp": 1754933329, "time_this_iter_s": 4.585952997207642, "time_total_s": 53.43230104446411, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.43230104446411, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 87.85714285714286, "ram_util_percent": 77.0}}
{"timers": {"training_iteration": 16.941217548183772, "restore_env_runners": 4.944423435478348e-05, "training_step": 16.94053262758664, "env_runner_sampling_timer": 16.204900441420904, "learner_update_timer": 0.713050659513501, "synch_weights": 0.007051314223049581, "restore_eval_env_runners": 5.471503769613919e-05, "evaluation_iteration": 1.650334878277034, "synch_eval_env_connectors": 0.000680056469551043, "synch_env_connectors": 1.0585492869644658e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 8.955346175195292e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5708234526380696e-06, "numpy_to_tensor": 2.7324673865175443e-05, "batch_individual_items": 1.652155714298864e-05, "add_time_dim_to_batch_and_zero_pad": 6.797633752182217e-06, "add_observations_from_episodes_to_batch": 9.633116537887073e-06}}, "connector_pipeline_timer": 0.00010882933754903181}, "num_episodes_lifetime": -123000.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "episode_return_min": -5.5, "time_between_sampling": 0.0038410367599361356, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7088190577563355e-06, "get_actions": 0.00013412476287721374, "listify_data_for_vector_env": 3.337661353607757e-05, "un_batch_to_individual_items": 1.2789748890371329e-05, "normalize_and_clip_actions": 2.454798800357322e-05, "tensor_to_numpy": 3.630856364562146e-05}}, "connector_pipeline_timer": 0.0003048205301858033}, "sample": 0.014615657434594575, "episode_duration_sec_mean": 0.01317263497039675, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00012451000824554366, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 4.2505203553416886e-05, "episode_return_mean": 6.820000000000002, "episode_len_max": 20, "weights_seq_no": 5.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1806.3676201613018}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.011664004996418953, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 36000, "vf_loss": 0.09929709136486053, "gradients_default_optimizer_global_norm": 0.03585651144385338, "entropy": 0.6706355810165405, "num_trainable_parameters": 6003, "vf_explained_var": 0.0018221735954284668, "vf_loss_unclipped": 33.48452377319336, "policy_loss": 0.007046705111861229, "weights_seq_no": 6.0, "mean_kl_loss": 0.000993289751932025, "total_loss": 0.06740652769804001, "num_module_steps_trained_lifetime_throughput": 93498.81294271605}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00041026427387373557, "general_advantage_estimation": 0.04387002905699511, "batch_individual_items": 0.17034967966424744, "add_time_dim_to_batch_and_zero_pad": 5.475155574927612e-05, "add_columns_from_episodes_to_train_batch": 0.1231043437208591, "add_observations_from_episodes_to_batch": 0.008454392655702761, "add_one_ts_to_episodes_and_truncate": 0.0342814473158707, "add_states_from_episodes_to_batch": 7.785025889010529e-06}}, "connector_pipeline_timer": 0.38084519916749987}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 483763.1500496883, "num_module_steps_trained_throughput": 92480.45633167455, "num_module_steps_trained_lifetime_throughput": 92330.94518643414}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.000415616086915e-06, "numpy_to_tensor": 1.961169125807426e-05, "batch_individual_items": 1.3253624289628212e-05, "add_time_dim_to_batch_and_zero_pad": 5.105789580393859e-06, "add_observations_from_episodes_to_batch": 5.052090169230212e-06}}, "connector_pipeline_timer": 8.915788268118152e-05}, "rlmodule_inference_timer": 6.573668692876376e-05, "num_episodes_lifetime": 120, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.9}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_return_mean": 1.9, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.6055497887979588e-05, "remove_single_ts_time_rank_from_batch": 8.942477889743381e-07, "tensor_to_numpy": 2.9163429265818633e-05, "listify_data_for_vector_env": 1.861594243486018e-05, "get_actions": 0.00010224245835685681, "un_batch_to_individual_items": 9.488077992262835e-06}}, "connector_pipeline_timer": 0.00022306522365393244}, "env_reset_timer": 0.0009912071567782469, "env_step_timer": 2.8019411788584355e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 30400, "env_to_module_sum_episodes_length_in": 10.368238394470474, "sample": 1.5187526935761981, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_duration_sec_mean": 0.01584470084053464, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 1.9}, "weights_seq_no": 6.0, "time_between_sampling": 14.929977738248972}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "49ece_00000", "date": "2025-08-11_19-28-54", "timestamp": 1754933334, "time_this_iter_s": 4.482173919677734, "time_total_s": 57.914474964141846, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.914474964141846, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 86.96666666666665, "ram_util_percent": 76.95}}
{"timers": {"training_iteration": 16.812873048111072, "restore_env_runners": 4.906313164025991e-05, "training_step": 16.81219121589151, "env_runner_sampling_timer": 16.081672519506036, "learner_update_timer": 0.7080769537486371, "synch_weights": 0.00699396983068423, "restore_eval_env_runners": 5.424205784902018e-05, "evaluation_iteration": 1.6365709024147412, "synch_eval_env_connectors": 0.0006749196544274221, "synch_env_connectors": 1.0523387983043992e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.114217343555738e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6986586666524056e-06, "numpy_to_tensor": 2.5834510640833536e-05, "batch_individual_items": 1.817796008461961e-05, "add_time_dim_to_batch_and_zero_pad": 5.637081676102534e-06, "add_observations_from_episodes_to_batch": 7.757961370968241e-06}}, "connector_pipeline_timer": 0.00011205097510527197}, "num_episodes_lifetime": -153875.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 7.54}, "episode_return_min": -5.5, "time_between_sampling": 0.003948490918874682, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4843150553944302e-06, "get_actions": 0.00013746959091574942, "listify_data_for_vector_env": 3.472029658477858e-05, "un_batch_to_individual_items": 1.3073893958320616e-05, "normalize_and_clip_actions": 2.4438422818278235e-05, "tensor_to_numpy": 3.748522640385236e-05}}, "connector_pipeline_timer": 0.00031142966879406305}, "sample": 0.01409216294389703, "episode_duration_sec_mean": 0.013173737834207708, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 7.54}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00013201054811434387, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 4.097239120111932e-05, "episode_return_mean": 7.54, "episode_len_max": 20, "weights_seq_no": 6.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1784.451414760645}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0058320024982094765, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 42000, "vf_loss": 0.100577712059021, "gradients_default_optimizer_global_norm": 0.03081803396344185, "entropy": 0.6684635877609253, "num_trainable_parameters": 6003, "vf_explained_var": 0.0011950135231018066, "vf_loss_unclipped": 36.07630157470703, "policy_loss": -0.2045687586069107, "weights_seq_no": 7.0, "mean_kl_loss": 0.0004201476403977722, "total_loss": -0.14335104823112488, "num_module_steps_trained_lifetime_throughput": 95691.80022710138}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0004086849611752743, "general_advantage_estimation": 0.04358823167593686, "batch_individual_items": 0.16968070869720514, "add_time_dim_to_batch_and_zero_pad": 5.43352903180707e-05, "add_columns_from_episodes_to_train_batch": 0.12231230653446784, "add_observations_from_episodes_to_batch": 0.008380437890102175, "add_one_ts_to_episodes_and_truncate": 0.03409502326287318, "add_states_from_episodes_to_batch": 7.739675295514848e-06}}, "connector_pipeline_timer": 0.3788385880157324}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 495555.130770937, "num_module_steps_trained_throughput": 94724.1331683546, "num_module_steps_trained_lifetime_throughput": 94569.72106894833}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.27187939821779e-06, "numpy_to_tensor": 2.3030241967481643e-05, "batch_individual_items": 1.4142248809392056e-05, "add_time_dim_to_batch_and_zero_pad": 4.610531883370484e-06, "add_observations_from_episodes_to_batch": 5.8807641231446005e-06}}, "connector_pipeline_timer": 9.147602342981386e-05}, "rlmodule_inference_timer": 7.350386327216516e-05, "num_episodes_lifetime": 140, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.3}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_return_mean": 1.3, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.9094394485369576e-05, "remove_single_ts_time_rank_from_batch": 3.5091389513262978e-06, "tensor_to_numpy": 3.07889399196464e-05, "listify_data_for_vector_env": 3.9196172163385255e-05, "get_actions": 0.00010502546455449171, "un_batch_to_individual_items": 1.0488177775069602e-05}}, "connector_pipeline_timer": 0.00026077570303620855}, "env_reset_timer": 0.0009836759252251307, "env_step_timer": 3.267020630701263e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 35400, "env_to_module_sum_episodes_length_in": 10.368238394572801, "sample": 1.5059970328911356, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_duration_sec_mean": 0.013408435421297327, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 1.3}, "weights_seq_no": 7.0, "time_between_sampling": 14.822119121285972}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "49ece_00000", "date": "2025-08-11_19-28-58", "timestamp": 1754933338, "time_this_iter_s": 4.366184234619141, "time_total_s": 62.280659198760986, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 62.280659198760986, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 85.41666666666667, "ram_util_percent": 76.95}}
{"timers": {"training_iteration": 16.721153981380052, "restore_env_runners": 4.8638749955202585e-05, "training_step": 16.720474309142208, "env_runner_sampling_timer": 15.994106363061057, "learner_update_timer": 0.7039889608818768, "synch_weights": 0.006986369302049146, "restore_eval_env_runners": 5.377463784161698e-05, "evaluation_iteration": 1.6227351442205151, "synch_eval_env_connectors": 0.0006708275479640499, "synch_env_connectors": 1.048856441816092e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00020579300974766227, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 6.937890995700885e-06, "numpy_to_tensor": 5.457312149579366e-05, "batch_individual_items": 2.9249317525850357e-05, "add_time_dim_to_batch_and_zero_pad": 1.693186438007399e-05, "add_observations_from_episodes_to_batch": 1.2921223344049547e-05}}, "connector_pipeline_timer": 0.0002022362352683243}, "num_episodes_lifetime": -184750.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "episode_return_min": -5.5, "time_between_sampling": 0.003876338747776125, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.0260072283886214e-06, "get_actions": 0.0002448370554359937, "listify_data_for_vector_env": 5.049129841707946e-05, "un_batch_to_individual_items": 2.3263080728584073e-05, "normalize_and_clip_actions": 4.585076551279916e-05, "tensor_to_numpy": 6.784359474119036e-05}}, "connector_pipeline_timer": 0.000547093510321519}, "sample": 0.020474736446443674, "episode_duration_sec_mean": 0.024391027827281503, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.0001550618826280594, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 7.741607548083365e-05, "episode_return_mean": 8.419999999999998, "episode_len_max": 20, "weights_seq_no": 7.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1302.9076599432065}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0029160012491047382, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 48000, "vf_loss": 0.10039109736680984, "gradients_default_optimizer_global_norm": 0.0560244545340538, "entropy": 0.6606499552726746, "num_trainable_parameters": 6003, "vf_explained_var": 0.0018621087074279785, "vf_loss_unclipped": 35.76835250854492, "policy_loss": -0.10652390867471695, "weights_seq_no": 8.0, "mean_kl_loss": 0.0003812006616499275, "total_loss": -0.045362912118434906, "num_module_steps_trained_lifetime_throughput": 97282.47493698334}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000406595202439624, "general_advantage_estimation": 0.04329209352918758, "batch_individual_items": 0.168793108690398, "add_time_dim_to_batch_and_zero_pad": 5.4622766791244805e-05, "add_columns_from_episodes_to_train_batch": 0.1217702213894175, "add_observations_from_episodes_to_batch": 0.008322090181174363, "add_one_ts_to_episodes_and_truncate": 0.0340281709508727, "add_states_from_episodes_to_batch": 7.736449072402076e-06}}, "connector_pipeline_timer": 0.3769846517163059}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 504206.648405771, "num_module_steps_trained_throughput": 96364.5448084377, "num_module_steps_trained_lifetime_throughput": 96208.85722928472}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.871630371378547e-06, "numpy_to_tensor": 2.5723340568403297e-05, "batch_individual_items": 1.9721942110433835e-05, "add_time_dim_to_batch_and_zero_pad": 4.993273255301817e-06, "add_observations_from_episodes_to_batch": 7.239965914998268e-06}}, "connector_pipeline_timer": 0.00010962980714629285}, "rlmodule_inference_timer": 8.325642622177865e-05, "num_episodes_lifetime": 160, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.5}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_return_mean": 1.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.416407947319776e-05, "remove_single_ts_time_rank_from_batch": 1.3170033270712185e-06, "tensor_to_numpy": 3.251483211613927e-05, "listify_data_for_vector_env": 3.8095858291420995e-05, "get_actions": 0.0001340163993321695, "un_batch_to_individual_items": 1.3905935621736394e-05}}, "connector_pipeline_timer": 0.0003069960736985653}, "env_reset_timer": 0.0009835154154378533, "env_step_timer": 3.8955216190783465e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 40400, "env_to_module_sum_episodes_length_in": 10.3682383945743, "sample": 1.494165031312513, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_duration_sec_mean": 0.012775298738852144, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 1.5}, "weights_seq_no": 8.0, "time_between_sampling": 14.75087434632264}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-06", "timestamp": 1754933346, "time_this_iter_s": 7.99043869972229, "time_total_s": 70.27109789848328, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.27109789848328, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 93.25, "ram_util_percent": 79.58333333333333}}
{"timers": {"training_iteration": 16.60905844531568, "restore_env_runners": 4.821528260879158e-05, "training_step": 16.608382986880663, "env_runner_sampling_timer": 15.875571816510478, "learner_update_timer": 0.710577511272942, "synch_weights": 0.006928155199479925, "restore_eval_env_runners": 5.379814137126064e-05, "evaluation_iteration": 1.6099386465274697, "synch_eval_env_connectors": 0.0006686684433286663, "synch_env_connectors": 1.1578259464914564e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.775157810973193e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6578041360240033e-06, "numpy_to_tensor": 3.062361754678369e-05, "batch_individual_items": 1.7204148213989015e-05, "add_time_dim_to_batch_and_zero_pad": 7.767296307649229e-06, "add_observations_from_episodes_to_batch": 7.952927267583114e-06}}, "connector_pipeline_timer": 0.0001151043057181703}, "num_episodes_lifetime": -215625.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "episode_return_min": -5.5, "time_between_sampling": 0.005809395779805373, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3965617451947807e-06, "get_actions": 0.00014487560127045816, "listify_data_for_vector_env": 3.2233811731198007e-05, "un_batch_to_individual_items": 1.4218976081490914e-05, "normalize_and_clip_actions": 2.612344330603321e-05, "tensor_to_numpy": 3.934199053841052e-05}}, "connector_pipeline_timer": 0.00032247438672376136}, "sample": 0.019272982927956157, "episode_duration_sec_mean": 0.014032218330074099, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.0001623191592862605, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 4.110766704573046e-05, "episode_return_mean": 8.419999999999998, "episode_len_max": 20, "weights_seq_no": 8.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1678.719813018855}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0014580006245523691, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 54000, "vf_loss": 0.10038838535547256, "gradients_default_optimizer_global_norm": 0.0056614866480231285, "entropy": 0.6526697874069214, "num_trainable_parameters": 6003, "vf_explained_var": 0.0028856992721557617, "vf_loss_unclipped": 35.71833038330078, "policy_loss": -0.0891357809305191, "weights_seq_no": 9.0, "mean_kl_loss": 0.00035186053719371557, "total_loss": -0.02790551446378231, "num_module_steps_trained_lifetime_throughput": 98324.7411936014}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00040456132991630527, "general_advantage_estimation": 0.04303460592390074, "batch_individual_items": 0.16795482301369274, "add_time_dim_to_batch_and_zero_pad": 5.431070854318724e-05, "add_columns_from_episodes_to_train_batch": 0.12125813208503777, "add_observations_from_episodes_to_batch": 0.008253043448990569, "add_one_ts_to_episodes_and_truncate": 0.04466021966140916, "add_states_from_episodes_to_batch": 7.709084962402724e-06}}, "connector_pipeline_timer": 0.38593653602835937}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 510009.5871392266, "num_module_steps_trained_throughput": 97456.21999569201, "num_module_steps_trained_lifetime_throughput": 97302.30002050496}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 9.008847350830963e-06, "numpy_to_tensor": 5.6811591114691e-05, "batch_individual_items": 4.390425786292906e-05, "add_time_dim_to_batch_and_zero_pad": 1.0659039625367726e-05, "add_observations_from_episodes_to_batch": 1.3968621387582166e-05}}, "connector_pipeline_timer": 0.00022917771576398804}, "rlmodule_inference_timer": 0.00022722554332174378, "num_episodes_lifetime": 180, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_return_mean": 2.1, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 4.706883128710829e-05, "remove_single_ts_time_rank_from_batch": 3.784757021187184e-06, "tensor_to_numpy": 0.0001318083678813874, "listify_data_for_vector_env": 5.3080090766509936e-05, "get_actions": 0.00030575593319257053, "un_batch_to_individual_items": 2.8564875108035705e-05}}, "connector_pipeline_timer": 0.0006753778033725779}, "env_reset_timer": 0.0009849377614383724, "env_step_timer": 7.942673550087317e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 45400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.4843276526699585, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_duration_sec_mean": 0.015235974560491741, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 2.1}, "weights_seq_no": 9.0, "time_between_sampling": 14.659378804109874}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-12", "timestamp": 1754933352, "time_this_iter_s": 6.064542770385742, "time_total_s": 76.33564066886902, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.33564066886902, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 90.625, "ram_util_percent": 82.85}}
{"timers": {"training_iteration": 16.49167960544317, "restore_env_runners": 4.7878959763896604e-05, "training_step": 16.491006448682, "env_runner_sampling_timer": 15.760782801675306, "learner_update_timer": 0.7080877053210171, "synch_weights": 0.0068807398966385155, "restore_eval_env_runners": 5.3401830419292106e-05, "evaluation_iteration": 1.599333802562432, "synch_eval_env_connectors": 0.0006686038395865385, "synch_env_connectors": 1.1519137371551806e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010804784246597234, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.29190777015514e-06, "numpy_to_tensor": 3.33625284224044e-05, "batch_individual_items": 2.072132793886215e-05, "add_time_dim_to_batch_and_zero_pad": 6.62999189536129e-06, "add_observations_from_episodes_to_batch": 9.03114524980828e-06}}, "connector_pipeline_timer": 0.00012961916597488974}, "num_episodes_lifetime": -246500.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 9.940000000000001}, "episode_return_min": -5.5, "time_between_sampling": 0.009387768553817519, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4910879903288824e-06, "get_actions": 0.00015874830822772585, "listify_data_for_vector_env": 3.421674570758502e-05, "un_batch_to_individual_items": 1.41008856928801e-05, "normalize_and_clip_actions": 2.6727949556236182e-05, "tensor_to_numpy": 4.465655267618757e-05}}, "connector_pipeline_timer": 0.0003491221085563452}, "sample": 0.015532755408653086, "episode_duration_sec_mean": 0.014778461506590243, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 9.940000000000001}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00012705880298361145, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 4.7132600215897257e-05, "episode_return_mean": 9.940000000000001, "episode_len_max": 20, "weights_seq_no": 9.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1608.4839521737058}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0007290003122761846, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 60000, "vf_loss": 0.10020184516906738, "gradients_default_optimizer_global_norm": 0.06948995590209961, "entropy": 0.64539635181427, "num_trainable_parameters": 6003, "vf_explained_var": 0.0037711262702941895, "vf_loss_unclipped": 35.351341247558594, "policy_loss": 0.09833916276693344, "weights_seq_no": 10.0, "mean_kl_loss": 0.00015151759725995362, "total_loss": 0.15950974822044373, "num_module_steps_trained_lifetime_throughput": 100288.97777182166}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0004024257160268327, "general_advantage_estimation": 0.042679687784753624, "batch_individual_items": 0.1694311031230692, "add_time_dim_to_batch_and_zero_pad": 5.404552091970602e-05, "add_columns_from_episodes_to_train_batch": 0.12076167992374223, "add_observations_from_episodes_to_batch": 0.008181718014837877, "add_one_ts_to_episodes_and_truncate": 0.044397529545042023, "add_states_from_episodes_to_batch": 7.706164642621074e-06}}, "connector_pipeline_timer": 0.38622444857787247}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 520556.0775187908, "num_module_steps_trained_throughput": 99452.193673437, "num_module_steps_trained_lifetime_throughput": 99294.585757732}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.0369736887889665e-06, "numpy_to_tensor": 2.5716121807119803e-05, "batch_individual_items": 1.8773233537566647e-05, "add_time_dim_to_batch_and_zero_pad": 5.56279050791114e-06, "add_observations_from_episodes_to_batch": 6.7279138520111565e-06}}, "connector_pipeline_timer": 0.00011521765764720196}, "rlmodule_inference_timer": 7.48695268101522e-05, "num_episodes_lifetime": 200, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_return_mean": 1.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.4723115766953302e-05, "remove_single_ts_time_rank_from_batch": 1.5604446061306635e-06, "tensor_to_numpy": 3.808377288793573e-05, "listify_data_for_vector_env": 3.4345856431272835e-05, "get_actions": 0.00013823012367044808, "un_batch_to_individual_items": 1.1880442844121265e-05}}, "connector_pipeline_timer": 0.00031013538099779414}, "env_reset_timer": 0.0009784087932746687, "env_step_timer": 4.2825571461885785e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 50400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.473240785313132, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_duration_sec_mean": 0.015835922880796716, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 1.5}, "weights_seq_no": 10.0, "time_between_sampling": 14.562816616907769}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-18", "timestamp": 1754933358, "time_this_iter_s": 5.293527841567993, "time_total_s": 81.62916851043701, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.62916851043701, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 64.41428571428571, "ram_util_percent": 82.74285714285715}}
{"timers": {"training_iteration": 16.370042563558957, "restore_env_runners": 4.746975043996038e-05, "training_step": 16.36937212961543, "env_runner_sampling_timer": 15.64121617574807, "learner_update_timer": 0.706133687018398, "synch_weights": 0.006834169577355822, "restore_eval_env_runners": 5.302322191312527e-05, "evaluation_iteration": 1.587408989537283, "synch_eval_env_connectors": 0.0006675657114838647, "synch_env_connectors": 1.1449785694958862e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 8.746373582192043e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.79667200462624e-06, "numpy_to_tensor": 2.5038435797835762e-05, "batch_individual_items": 1.92013421992842e-05, "add_time_dim_to_batch_and_zero_pad": 5.673183261687907e-06, "add_observations_from_episodes_to_batch": 7.79505474572345e-06}}, "connector_pipeline_timer": 0.00010888900658063485}, "num_episodes_lifetime": -277375.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "episode_return_min": -5.5, "time_between_sampling": 0.00568949211283556, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2879779421439253e-06, "get_actions": 0.0001273936752282827, "listify_data_for_vector_env": 2.7957638349722694e-05, "un_batch_to_individual_items": 1.2995128694690494e-05, "normalize_and_clip_actions": 2.1618202620173012e-05, "tensor_to_numpy": 3.7026974833488245e-05}}, "connector_pipeline_timer": 0.0002866393424599799}, "sample": 0.014435792041006323, "episode_duration_sec_mean": 0.012627204671036453, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00010709119267359005, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 3.939334133456641e-05, "episode_return_mean": 9.460000000000004, "episode_len_max": 20, "weights_seq_no": 10.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1781.735310431354}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0003645001561380923, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 66000, "vf_loss": 0.10056816786527634, "gradients_default_optimizer_global_norm": 0.05864938348531723, "entropy": 0.6424030065536499, "num_trainable_parameters": 6003, "vf_explained_var": 0.003722965717315674, "vf_loss_unclipped": 36.1129264831543, "policy_loss": -0.03647731989622116, "weights_seq_no": 11.0, "mean_kl_loss": 0.00011596082913456485, "total_loss": 0.024965224787592888, "num_module_steps_trained_lifetime_throughput": 101655.1095428872}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00040347354871001634, "general_advantage_estimation": 0.042371571736088354, "batch_individual_items": 0.1703071500012646, "add_time_dim_to_batch_and_zero_pad": 5.3637145878040924e-05, "add_columns_from_episodes_to_train_batch": 0.1208660789552768, "add_observations_from_episodes_to_batch": 0.00813049417474179, "add_one_ts_to_episodes_and_truncate": 0.04430507299954951, "add_states_from_episodes_to_batch": 7.828683095628524e-06}}, "connector_pipeline_timer": 0.38676518075215166}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 528103.9520912251, "num_module_steps_trained_throughput": 100865.13885816139, "num_module_steps_trained_lifetime_throughput": 100708.62003633202}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.836847071463936e-06, "numpy_to_tensor": 3.0267197852838242e-05, "batch_individual_items": 2.1514755056411225e-05, "add_time_dim_to_batch_and_zero_pad": 7.0587557872222605e-06, "add_observations_from_episodes_to_batch": 7.362979079693197e-06}}, "connector_pipeline_timer": 0.00011892249331978925}, "rlmodule_inference_timer": 0.00011878669092260412, "num_episodes_lifetime": 220, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_return_mean": 1.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.7023171917663125e-05, "remove_single_ts_time_rank_from_batch": 1.5673155092611536e-06, "tensor_to_numpy": 4.2190894924239736e-05, "listify_data_for_vector_env": 3.760707051263933e-05, "get_actions": 0.00016249020805135262, "un_batch_to_individual_items": 1.5093434739767454e-05}}, "connector_pipeline_timer": 0.00035560144259230746}, "env_reset_timer": 0.0009730763643843102, "env_step_timer": 5.531526305448601e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 55400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.4622235970403363, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_duration_sec_mean": 0.01688098541344516, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 1.5}, "weights_seq_no": 11.0, "time_between_sampling": 14.460859161578488}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-22", "timestamp": 1754933362, "time_this_iter_s": 4.719239950180054, "time_total_s": 86.34840846061707, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.34840846061707, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 88.98571428571428, "ram_util_percent": 81.9142857142857}}
{"timers": {"training_iteration": 16.268152451253865, "restore_env_runners": 4.712713310309274e-05, "training_step": 16.267482057068175, "env_runner_sampling_timer": 15.544461541491119, "learner_update_timer": 0.7011444688982889, "synch_weights": 0.006793609961578805, "restore_eval_env_runners": 5.264215963077018e-05, "evaluation_iteration": 1.5753846354723549, "synch_eval_env_connectors": 0.0006809329648424473, "synch_env_connectors": 1.1403617811155591e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00013045706888028017, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 6.35356303132994e-06, "numpy_to_tensor": 4.1843652216639175e-05, "batch_individual_items": 2.3093550011618766e-05, "add_time_dim_to_batch_and_zero_pad": 8.760495012322845e-06, "add_observations_from_episodes_to_batch": 1.0168832044910663e-05}}, "connector_pipeline_timer": 0.0001535328468251026}, "num_episodes_lifetime": -308250.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 9.539999999999996}, "episode_return_min": -5.5, "time_between_sampling": 0.007440808312356568, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.1167305820594204e-06, "get_actions": 0.00020353790439509617, "listify_data_for_vector_env": 4.0768340002684366e-05, "un_batch_to_individual_items": 1.7635178126338085e-05, "normalize_and_clip_actions": 3.256147822031131e-05, "tensor_to_numpy": 5.603127102395528e-05}}, "connector_pipeline_timer": 0.00044881973441586}, "sample": 0.0192791767992671, "episode_duration_sec_mean": 0.01920615898631513, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 9.539999999999996}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00013682206180637004, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 6.430251346163955e-05, "episode_return_mean": 9.539999999999996, "episode_len_max": 20, "weights_seq_no": 11.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1347.144332704189}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00018225007806904614, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 72000, "vf_loss": 0.10111989825963974, "gradients_default_optimizer_global_norm": 0.030036011710762978, "entropy": 0.6375489234924316, "num_trainable_parameters": 6003, "vf_explained_var": 0.0028873085975646973, "vf_loss_unclipped": 37.25564193725586, "policy_loss": -0.156912699341774, "weights_seq_no": 12.0, "mean_kl_loss": 0.0003195784520357847, "total_loss": -0.09505714476108551, "num_module_steps_trained_lifetime_throughput": 103077.63963337021}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0004002654830798221, "general_advantage_estimation": 0.042038871428871354, "batch_individual_items": 0.16920438100120375, "add_time_dim_to_batch_and_zero_pad": 5.37253542623942e-05, "add_columns_from_episodes_to_train_batch": 0.12040801483569225, "add_observations_from_episodes_to_batch": 0.008083658813272172, "add_one_ts_to_episodes_and_truncate": 0.043994677269169634, "add_states_from_episodes_to_batch": 7.803316341668328e-06}}, "connector_pipeline_timer": 0.38451041977535927}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 535909.0329404507, "num_module_steps_trained_throughput": 102331.31151954754, "num_module_steps_trained_lifetime_throughput": 102177.42219488688}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4369445749310834e-06, "numpy_to_tensor": 1.8009546713155067e-05, "batch_individual_items": 1.3364444923433026e-05, "add_time_dim_to_batch_and_zero_pad": 4.2094901740225415e-06, "add_observations_from_episodes_to_batch": 5.904717714227305e-06}}, "connector_pipeline_timer": 8.237237637381103e-05}, "rlmodule_inference_timer": 6.692931890975774e-05, "num_episodes_lifetime": 240, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_return_mean": 2.1, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.8401388617358622e-05, "remove_single_ts_time_rank_from_batch": 1.143231691929274e-06, "tensor_to_numpy": 2.7943625110291424e-05, "listify_data_for_vector_env": 2.3238106380035223e-05, "get_actions": 9.379527624780384e-05, "un_batch_to_individual_items": 1.067180093243896e-05}}, "connector_pipeline_timer": 0.00022489264261398283}, "env_reset_timer": 0.00096933685008571, "env_step_timer": 3.120816473984318e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 60400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.4504230310699087, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_duration_sec_mean": 0.017245894154766576, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 2.1}, "weights_seq_no": 12.0, "time_between_sampling": 14.378985126212045}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-29", "timestamp": 1754933369, "time_this_iter_s": 6.485635995864868, "time_total_s": 92.83404445648193, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.83404445648193, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 83.24444444444445, "ram_util_percent": 81.33333333333333}}
{"timers": {"training_iteration": 16.159505617991744, "restore_env_runners": 4.677919216400527e-05, "training_step": 16.158839029417344, "env_runner_sampling_timer": 15.440923214406418, "learner_update_timer": 0.6962105250387791, "synch_weights": 0.006735835531887872, "restore_eval_env_runners": 5.5186578646516346e-05, "evaluation_iteration": 1.5626218657882183, "synch_eval_env_connectors": 0.000677380725187008, "synch_env_connectors": 1.1325002158863097e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00011587621186012409, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 5.346518243133227e-06, "numpy_to_tensor": 3.451345000690837e-05, "batch_individual_items": 2.3020450126045808e-05, "add_time_dim_to_batch_and_zero_pad": 8.300820584579941e-06, "add_observations_from_episodes_to_batch": 1.0178598966354552e-05}}, "connector_pipeline_timer": 0.0001414465568850618}, "num_episodes_lifetime": -339125.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "episode_return_min": -5.5, "time_between_sampling": 0.0047441259734120516, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7968456559880652e-06, "get_actions": 0.00018440041838415977, "listify_data_for_vector_env": 3.588810306886285e-05, "un_batch_to_individual_items": 1.8908968073984568e-05, "normalize_and_clip_actions": 3.377161972861006e-05, "tensor_to_numpy": 4.832730430360279e-05}}, "connector_pipeline_timer": 0.00040822071734729045}, "sample": 0.01799095633114222, "episode_duration_sec_mean": 0.017065713504794987, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00013118777992792409, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 5.281006287587921e-05, "episode_return_mean": 9.460000000000004, "episode_len_max": 20, "weights_seq_no": 12.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1407.6607469175835}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 9.112503903452307e-05, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 78000, "vf_loss": 0.10056453198194504, "gradients_default_optimizer_global_norm": 0.024964654818177223, "entropy": 0.6236662864685059, "num_trainable_parameters": 6003, "vf_explained_var": 0.004157304763793945, "vf_loss_unclipped": 36.1948127746582, "policy_loss": -0.05494841933250427, "weights_seq_no": 13.0, "mean_kl_loss": 0.00024740456137806177, "total_loss": 0.00666135223582387, "num_module_steps_trained_lifetime_throughput": 104704.24342983624}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000396984918729873, "general_advantage_estimation": 0.041726239804009385, "batch_individual_items": 0.16809954719098585, "add_time_dim_to_batch_and_zero_pad": 5.33110096882487e-05, "add_columns_from_episodes_to_train_batch": 0.11989728676775126, "add_observations_from_episodes_to_batch": 0.00802857847480939, "add_one_ts_to_episodes_and_truncate": 0.04382281090679266, "add_states_from_episodes_to_batch": 7.762782881718537e-06}}, "connector_pipeline_timer": 0.38235013349851027}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 544725.0182018009, "num_module_steps_trained_throughput": 103998.14629930163, "num_module_steps_trained_lifetime_throughput": 103844.45558423572}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1361931360709693e-06, "numpy_to_tensor": 2.3667995914311864e-05, "batch_individual_items": 1.8063683375110907e-05, "add_time_dim_to_batch_and_zero_pad": 5.0113526167041445e-06, "add_observations_from_episodes_to_batch": 6.7420365885831705e-06}}, "connector_pipeline_timer": 9.986713379671027e-05}, "rlmodule_inference_timer": 8.47031857563015e-05, "num_episodes_lifetime": 260, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_return_mean": 2.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.41200479648657e-05, "remove_single_ts_time_rank_from_batch": 1.3401334887406643e-06, "tensor_to_numpy": 3.285614168028984e-05, "listify_data_for_vector_env": 3.2289578349982165e-05, "get_actions": 0.00012249385098371461, "un_batch_to_individual_items": 1.3698170906824364e-05}}, "connector_pipeline_timer": 0.0002827341479886568}, "env_reset_timer": 0.0009611697318559796, "env_step_timer": 3.8817256177355165e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 65400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.4389498420088425, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_duration_sec_mean": 0.01702448252472095, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 2.5}, "weights_seq_no": 13.0, "time_between_sampling": 14.289515344530496}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-35", "timestamp": 1754933375, "time_this_iter_s": 5.717371940612793, "time_total_s": 98.55141639709473, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.55141639709473, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 56.95, "ram_util_percent": 80.8625}}
{"timers": {"training_iteration": 16.049271473901992, "restore_env_runners": 4.645640018231353e-05, "training_step": 16.048606847462736, "env_runner_sampling_timer": 15.334035448921735, "learner_update_timer": 0.6930366714580032, "synch_weights": 0.006679465096091443, "restore_eval_env_runners": 5.4704712228912495e-05, "evaluation_iteration": 1.5501100683804019, "synch_eval_env_connectors": 0.0006724731684668858, "synch_env_connectors": 1.1265922514826976e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.0001139523201809794, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.4655658631312634e-06, "numpy_to_tensor": 3.6137052118036994e-05, "batch_individual_items": 2.0120535326943334e-05, "add_time_dim_to_batch_and_zero_pad": 7.647662260535858e-06, "add_observations_from_episodes_to_batch": 1.176011616374174e-05}}, "connector_pipeline_timer": 0.00013712445230335584}, "num_episodes_lifetime": -370000.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 11.859999999999996}, "episode_return_min": -5.5, "time_between_sampling": 0.00441576181849129, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.803528060163734e-06, "get_actions": 0.0001735499831804885, "listify_data_for_vector_env": 3.795586607739824e-05, "un_batch_to_individual_items": 1.9954921453037942e-05, "normalize_and_clip_actions": 2.9160649777767513e-05, "tensor_to_numpy": 4.666466619617497e-05}}, "connector_pipeline_timer": 0.00038679651356986677}, "sample": 0.017257435556623024, "episode_duration_sec_mean": 0.016387746982276435, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 11.859999999999996}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00012247294535770167, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 5.078610890195427e-05, "episode_return_mean": 11.859999999999996, "episode_len_max": 20, "weights_seq_no": 13.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1404.8315985943264}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 4.5562519517261535e-05, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 84000, "vf_loss": 0.1025959849357605, "gradients_default_optimizer_global_norm": 0.03703908249735832, "entropy": 0.6360170841217041, "num_trainable_parameters": 6003, "vf_explained_var": -0.01017308235168457, "vf_loss_unclipped": 40.3286018371582, "policy_loss": -0.3303236663341522, "weights_seq_no": 14.0, "mean_kl_loss": 0.0002494497748557478, "total_loss": -0.26746711134910583, "num_module_steps_trained_lifetime_throughput": 106895.75247020774}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00039485172962782023, "general_advantage_estimation": 0.041397010736363246, "batch_individual_items": 0.1690021912989011, "add_time_dim_to_batch_and_zero_pad": 5.28978993409522e-05, "add_columns_from_episodes_to_train_batch": 0.1193094497397912, "add_observations_from_episodes_to_batch": 0.00797325977074195, "add_one_ts_to_episodes_and_truncate": 0.04354432821782117, "add_states_from_episodes_to_batch": 7.718495236919368e-06}}, "connector_pipeline_timer": 0.38199957549277747}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 556529.9239739174, "num_module_steps_trained_throughput": 106232.04539493426, "num_module_steps_trained_lifetime_throughput": 106075.95110688882}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.2528096821560427e-06, "numpy_to_tensor": 2.367965011886635e-05, "batch_individual_items": 1.3705283989460334e-05, "add_time_dim_to_batch_and_zero_pad": 7.34860177726589e-06, "add_observations_from_episodes_to_batch": 6.14301099664246e-06}}, "connector_pipeline_timer": 9.738396838908152e-05}, "rlmodule_inference_timer": 8.002385838685745e-05, "num_episodes_lifetime": 280, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.9}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_return_mean": 1.9, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.1684663065894316e-05, "remove_single_ts_time_rank_from_batch": 7.440948600935763e-06, "tensor_to_numpy": 3.334167284893634e-05, "listify_data_for_vector_env": 2.903961791009665e-05, "get_actions": 0.00011771191331608885, "un_batch_to_individual_items": 1.2841829918787313e-05}}, "connector_pipeline_timer": 0.0002776746049818036}, "env_reset_timer": 0.000952323034541741, "env_step_timer": 3.8225580564759286e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 70400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.4273451439983262, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_duration_sec_mean": 0.014882702145259828, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 1.9}, "weights_seq_no": 14.0, "time_between_sampling": 14.198304030254754}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-40", "timestamp": 1754933380, "time_this_iter_s": 5.423268795013428, "time_total_s": 103.97468519210815, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 103.97468519210815, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 79.6, "ram_util_percent": 80.5875}}
{"timers": {"training_iteration": 15.931318931243016, "restore_env_runners": 4.6064745932397384e-05, "training_step": 15.930656612738261, "env_runner_sampling_timer": 15.218967640682893, "learner_update_timer": 0.6903084930829732, "synch_weights": 0.0066281283556160935, "restore_eval_env_runners": 5.422766447548469e-05, "evaluation_iteration": 1.5374470897869228, "synch_eval_env_connectors": 0.0006669055177696853, "synch_env_connectors": 1.1193263594258442e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 8.828901958851525e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.587422755769224e-06, "numpy_to_tensor": 2.68123679262851e-05, "batch_individual_items": 1.8127903330834028e-05, "add_time_dim_to_batch_and_zero_pad": 6.30820735357685e-06, "add_observations_from_episodes_to_batch": 8.510516898918086e-06}}, "connector_pipeline_timer": 0.00010908458995984507}, "num_episodes_lifetime": -400875.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 10.5}, "episode_return_min": -5.5, "time_between_sampling": 0.004320308438616025, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.372071003738873e-06, "get_actions": 0.00013534657163868076, "listify_data_for_vector_env": 3.2006902111504155e-05, "un_batch_to_individual_items": 1.3008265916631398e-05, "normalize_and_clip_actions": 2.3437266251710498e-05, "tensor_to_numpy": 3.9609658001867335e-05}}, "connector_pipeline_timer": 0.00030966326816234146}, "sample": 0.015072356673112254, "episode_duration_sec_mean": 0.013031220480799677, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 10.5}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00010685617442293197, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 4.323106359815561e-05, "episode_return_mean": 10.5, "episode_len_max": 20, "weights_seq_no": 14.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1657.2769585663136}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 2.2781259758630767e-05, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 90000, "vf_loss": 0.10167106240987778, "gradients_default_optimizer_global_norm": 0.04398268088698387, "entropy": 0.6198380589485168, "num_trainable_parameters": 6003, "vf_explained_var": 0.0007898807525634766, "vf_loss_unclipped": 38.51253128051758, "policy_loss": -0.22504158318042755, "weights_seq_no": 15.0, "mean_kl_loss": 0.00010712061339290813, "total_loss": -0.16265712678432465, "num_module_steps_trained_lifetime_throughput": 109123.95094616196}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00039183571186506114, "general_advantage_estimation": 0.04110012103970922, "batch_individual_items": 0.1700531581359228, "add_time_dim_to_batch_and_zero_pad": 5.248017032154015e-05, "add_columns_from_episodes_to_train_batch": 0.11884813649319051, "add_observations_from_episodes_to_batch": 0.00791025467293119, "add_one_ts_to_episodes_and_truncate": 0.04329305868610125, "add_states_from_episodes_to_batch": 7.6738099499446e-06}}, "connector_pipeline_timer": 0.38197269764707625}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 568467.6381205793, "num_module_steps_trained_throughput": 108499.87972554353, "num_module_steps_trained_lifetime_throughput": 108340.84393491449}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.057487260984673e-06, "numpy_to_tensor": 2.7603881329314605e-05, "batch_individual_items": 1.5713387537269907e-05, "add_time_dim_to_batch_and_zero_pad": 4.461388873084557e-06, "add_observations_from_episodes_to_batch": 6.215925890817212e-06}}, "connector_pipeline_timer": 0.00010477170637917601}, "rlmodule_inference_timer": 8.418877217948531e-05, "num_episodes_lifetime": 300, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.9}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_return_mean": 1.9, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.815874467461305e-05, "remove_single_ts_time_rank_from_batch": 1.2250631589733634e-06, "tensor_to_numpy": 3.202932639668896e-05, "listify_data_for_vector_env": 2.496794131738645e-05, "get_actions": 0.00010175113015223341, "un_batch_to_individual_items": 1.1221836361092585e-05}}, "connector_pipeline_timer": 0.00025889538542299016}, "env_reset_timer": 0.0009436031351095096, "env_step_timer": 3.7070897271254125e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 75400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.415500004649267, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_duration_sec_mean": 0.01363093132385984, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 1.9}, "weights_seq_no": 15.0, "time_between_sampling": 14.099253106612728}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-45", "timestamp": 1754933385, "time_this_iter_s": 4.513751029968262, "time_total_s": 108.48843622207642, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 108.48843622207642, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 89.36666666666667, "ram_util_percent": 80.16666666666667}}
{"timers": {"training_iteration": 15.82226628276079, "restore_env_runners": 4.5665348066346216e-05, "training_step": 15.821606201611413, "env_runner_sampling_timer": 15.114684825946844, "learner_update_timer": 0.6856468485721825, "synch_weights": 0.006579815402126584, "restore_eval_env_runners": 5.3771227832432144e-05, "evaluation_iteration": 1.5246128463897755, "synch_eval_env_connectors": 0.0006638564622167771, "synch_env_connectors": 1.1349241030895837e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00012253998654963873, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.180597977973056e-06, "numpy_to_tensor": 3.259844224145247e-05, "batch_individual_items": 2.0308224095522666e-05, "add_time_dim_to_batch_and_zero_pad": 6.832792250650276e-06, "add_observations_from_episodes_to_batch": 8.408770608043197e-06}}, "connector_pipeline_timer": 0.00012587126353828495}, "num_episodes_lifetime": -431750.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 11.700000000000003}, "episode_return_min": -5.5, "time_between_sampling": 0.004534393345470895, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5387459306249936e-06, "get_actions": 0.0001717414884827769, "listify_data_for_vector_env": 3.486756130353282e-05, "un_batch_to_individual_items": 1.6965988315432647e-05, "normalize_and_clip_actions": 3.09303064834308e-05, "tensor_to_numpy": 4.511739822193558e-05}}, "connector_pipeline_timer": 0.00037990303729549965}, "sample": 0.015711867025761325, "episode_duration_sec_mean": 0.0162820271900855, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 11.700000000000003}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00011267516353834517, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 5.090162675391456e-05, "episode_return_mean": 11.700000000000003, "episode_len_max": 20, "weights_seq_no": 15.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1555.005361112437}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.1390629879315384e-05, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 96000, "vf_loss": 0.10140769928693771, "gradients_default_optimizer_global_norm": 0.12816815078258514, "entropy": 0.6082354187965393, "num_trainable_parameters": 6003, "vf_explained_var": 0.003667175769805908, "vf_loss_unclipped": 37.72899627685547, "policy_loss": 0.00893791951239109, "weights_seq_no": 16.0, "mean_kl_loss": 0.0001255715760635212, "total_loss": 0.07125132530927658, "num_module_steps_trained_lifetime_throughput": 110553.37335094683}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0003890956850225719, "general_advantage_estimation": 0.04087411732993105, "batch_individual_items": 0.16915759988421383, "add_time_dim_to_batch_and_zero_pad": 5.213494856546854e-05, "add_columns_from_episodes_to_train_batch": 0.1180947892878925, "add_observations_from_episodes_to_batch": 0.007849083376824374, "add_one_ts_to_episodes_and_truncate": 0.042986896019104735, "add_states_from_episodes_to_batch": 7.632070952799204e-06}}, "connector_pipeline_timer": 0.37972599650162686}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 576164.3368226681, "num_module_steps_trained_throughput": 109968.3145137634, "num_module_steps_trained_lifetime_throughput": 109808.4305990809}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.045187514806091e-05, "numpy_to_tensor": 6.68798782757362e-05, "batch_individual_items": 3.5316151462761365e-05, "add_time_dim_to_batch_and_zero_pad": 1.2488912815324055e-05, "add_observations_from_episodes_to_batch": 9.967772553692574e-06}}, "connector_pipeline_timer": 0.0002241931914978536}, "rlmodule_inference_timer": 0.00017346148582270308, "num_episodes_lifetime": 320, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_return_mean": 2.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 4.8348125148125775e-05, "remove_single_ts_time_rank_from_batch": 1.8328562321697428e-06, "tensor_to_numpy": 6.579405072803233e-05, "listify_data_for_vector_env": 4.196155404814021e-05, "get_actions": 0.0002309428931455739, "un_batch_to_individual_items": 1.9052938229040964e-05}}, "connector_pipeline_timer": 0.0004930911433171457}, "env_reset_timer": 0.000935980443526392, "env_step_timer": 8.13201998057962e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 80400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.4049537008527864, "episode_return_max": 14.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_duration_sec_mean": 0.013514069250086323, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 2.5}, "weights_seq_no": 16.0, "time_between_sampling": 14.00897882721708}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-50", "timestamp": 1754933390, "time_this_iter_s": 5.40575909614563, "time_total_s": 113.89419531822205, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 113.89419531822205, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 91.5875, "ram_util_percent": 80.35}}
{"timers": {"training_iteration": 15.733939144933938, "restore_env_runners": 4.526744474199593e-05, "training_step": 15.73328310375467, "env_runner_sampling_timer": 15.029387791437621, "learner_update_timer": 0.6823959867564864, "synch_weights": 0.006544418498219982, "restore_eval_env_runners": 5.337185537349443e-05, "evaluation_iteration": 1.5131119687558388, "synch_eval_env_connectors": 0.0006610195679857218, "synch_env_connectors": 1.1281998099642284e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.0001943241261308164, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 9.081163145382229e-06, "numpy_to_tensor": 4.454002533401817e-05, "batch_individual_items": 2.6936286152260125e-05, "add_time_dim_to_batch_and_zero_pad": 8.465212561928065e-06, "add_observations_from_episodes_to_batch": 1.1924318645990688e-05}}, "connector_pipeline_timer": 0.00017301775560648092}, "num_episodes_lifetime": -462625.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 11.380000000000003}, "episode_return_min": -5.5, "time_between_sampling": 0.004629556494722332, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.260239281573399e-06, "get_actions": 0.0002495674052247921, "listify_data_for_vector_env": 4.728866904852409e-05, "un_batch_to_individual_items": 2.0725846902517955e-05, "normalize_and_clip_actions": 3.476397671878915e-05, "tensor_to_numpy": 6.581818803064424e-05}}, "connector_pipeline_timer": 0.0005167106327030514}, "sample": 0.020329578347864072, "episode_duration_sec_mean": 0.022551150828599927, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 11.380000000000003}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.0001511419578739697, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 6.724372703783577e-05, "episode_return_mean": 11.380000000000003, "episode_len_max": 20, "weights_seq_no": 16.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1235.241932537065}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 5.695314939657692e-06, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 102000, "vf_loss": 0.10092901438474655, "gradients_default_optimizer_global_norm": 0.0712444856762886, "entropy": 0.5945951342582703, "num_trainable_parameters": 6003, "vf_explained_var": 0.004249453544616699, "vf_loss_unclipped": 37.01144027709961, "policy_loss": 0.05141635611653328, "weights_seq_no": 17.0, "mean_kl_loss": 0.00019485194934532046, "total_loss": 0.113533154129982, "num_module_steps_trained_lifetime_throughput": 111429.15793492501}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00038614806830063387, "general_advantage_estimation": 0.040570759906683, "batch_individual_items": 0.16806117430534825, "add_time_dim_to_batch_and_zero_pad": 5.1757768978517547e-05, "add_columns_from_episodes_to_train_batch": 0.11905640681537667, "add_observations_from_episodes_to_batch": 0.007787960043169452, "add_one_ts_to_episodes_and_truncate": 0.042713906229012964, "add_states_from_episodes_to_batch": 7.590340727845649e-06}}, "connector_pipeline_timer": 0.3789510611168441}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 580938.5913151655, "num_module_steps_trained_throughput": 110879.31377641535, "num_module_steps_trained_lifetime_throughput": 110719.14740530282}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.640729473774557e-06, "numpy_to_tensor": 5.103162309977227e-05, "batch_individual_items": 2.4207053522577318e-05, "add_time_dim_to_batch_and_zero_pad": 7.72908680413385e-06, "add_observations_from_episodes_to_batch": 2.554336401430225e-05}}, "connector_pipeline_timer": 0.00021184432274785805}, "rlmodule_inference_timer": 0.0001268212329941233, "num_episodes_lifetime": 340, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_return_mean": 2.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 5.975781974635901e-05, "remove_single_ts_time_rank_from_batch": 3.520109309900091e-06, "tensor_to_numpy": 6.146709483453207e-05, "listify_data_for_vector_env": 4.2826173316800825e-05, "get_actions": 0.00023552610408337192, "un_batch_to_individual_items": 1.3574065367213882e-05}}, "connector_pipeline_timer": 0.0005607898233849449}, "env_reset_timer": 0.0009274752183572888, "env_step_timer": 7.5374167597861e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 85400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.3953255542638516, "episode_return_max": 14.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_duration_sec_mean": 0.01500850633950904, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 2.5}, "weights_seq_no": 17.0, "time_between_sampling": 13.93930297602463}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "49ece_00000", "date": "2025-08-11_19-29-57", "timestamp": 1754933397, "time_this_iter_s": 7.455051898956299, "time_total_s": 121.34924721717834, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.34924721717834, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 94.67272727272729, "ram_util_percent": 81.84545454545454}}
{"timers": {"training_iteration": 15.624610171814686, "restore_env_runners": 4.495811015203504e-05, "training_step": 15.623955828967116, "env_runner_sampling_timer": 14.921400149354008, "learner_update_timer": 0.681214730639558, "synch_weights": 0.006494355563069772, "restore_eval_env_runners": 5.370188612082052e-05, "evaluation_iteration": 1.5025204286485856, "synch_eval_env_connectors": 0.0006588039622291869, "synch_env_connectors": 1.1263758582710936e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010784922490732226, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.888238321126834e-06, "numpy_to_tensor": 3.100927419764867e-05, "batch_individual_items": 1.9584771935278147e-05, "add_time_dim_to_batch_and_zero_pad": 6.426859707953266e-06, "add_observations_from_episodes_to_batch": 1.0745091472669367e-05}}, "connector_pipeline_timer": 0.00012073743567824806}, "num_episodes_lifetime": -493500.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 12.420000000000002}, "episode_return_min": -5.5, "time_between_sampling": 0.005726001966818229, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7161897241526141e-06, "get_actions": 0.0001480825534737739, "listify_data_for_vector_env": 3.2820202773905334e-05, "un_batch_to_individual_items": 1.3676565505049393e-05, "normalize_and_clip_actions": 2.7650928334860923e-05, "tensor_to_numpy": 4.123105485612179e-05}}, "connector_pipeline_timer": 0.0003368274826692331}, "sample": 0.019412094570145498, "episode_duration_sec_mean": 0.014383596658241009, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 12.420000000000002}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00012596735103997248, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 4.7468263729457815e-05, "episode_return_mean": 12.420000000000002, "episode_len_max": 20, "weights_seq_no": 17.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1478.3283490666652}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 2.847657469828846e-06, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 108000, "vf_loss": 0.10222505033016205, "gradients_default_optimizer_global_norm": 0.019866973161697388, "entropy": 0.6081311106681824, "num_trainable_parameters": 6003, "vf_explained_var": -0.004913330078125, "vf_loss_unclipped": 39.726741790771484, "policy_loss": -0.19750188291072845, "weights_seq_no": 18.0, "mean_kl_loss": 0.0001815491123124957, "total_loss": -0.1346408873796463, "num_module_steps_trained_lifetime_throughput": 112027.94008342078}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0003830240868304737, "general_advantage_estimation": 0.04029505396805256, "batch_individual_items": 0.17079476256159554, "add_time_dim_to_batch_and_zero_pad": 5.1411030773513396e-05, "add_columns_from_episodes_to_train_batch": 0.11833105399734369, "add_observations_from_episodes_to_batch": 0.007729084613054961, "add_one_ts_to_episodes_and_truncate": 0.042406859246464715, "add_states_from_episodes_to_batch": 7.550267628319086e-06}}, "connector_pipeline_timer": 0.38031306258484937}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 584221.2849477538, "num_module_steps_trained_throughput": 111505.79343644237, "num_module_steps_trained_lifetime_throughput": 111345.14525223736}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.515842476387559e-06, "numpy_to_tensor": 2.7338751153520926e-05, "batch_individual_items": 2.3837326292312785e-05, "add_time_dim_to_batch_and_zero_pad": 7.861468745975513e-06, "add_observations_from_episodes_to_batch": 1.0727637291120936e-05}}, "connector_pipeline_timer": 0.00012279230246216744}, "rlmodule_inference_timer": 9.979818482801339e-05, "num_episodes_lifetime": 360, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.7}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_return_mean": 2.7, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.4993056732451134e-05, "remove_single_ts_time_rank_from_batch": 1.7570295746103664e-06, "tensor_to_numpy": 4.002951605226264e-05, "listify_data_for_vector_env": 3.517657375239443e-05, "get_actions": 0.0001437714872030837, "un_batch_to_individual_items": 1.5540195622586825e-05}}, "connector_pipeline_timer": 0.0003395513666473027}, "env_reset_timer": 0.0009215942161129937, "env_step_timer": 5.216791471965257e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 90400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.3842999474711142, "episode_return_max": 14.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_duration_sec_mean": 0.014980276357382536, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 2.7}, "weights_seq_no": 18.0, "time_between_sampling": 13.848411329183877}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "49ece_00000", "date": "2025-08-11_19-30-03", "timestamp": 1754933403, "time_this_iter_s": 5.109981060028076, "time_total_s": 126.45922827720642, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.45922827720642, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 91.85714285714286, "ram_util_percent": 82.05714285714285}}
{"timers": {"training_iteration": 15.515849308435826, "restore_env_runners": 4.457686950103997e-05, "training_step": 15.515197659017682, "env_runner_sampling_timer": 14.815850362020994, "learner_update_timer": 0.6781203329222852, "synch_weights": 0.00644154116731615, "restore_eval_env_runners": 5.324320662212931e-05, "evaluation_iteration": 1.4905508060325872, "synch_eval_env_connectors": 0.0006556934228928483, "synch_env_connectors": 1.1190701042151767e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.941191389595648e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6195305816522976e-06, "numpy_to_tensor": 3.1762692838692015e-05, "batch_individual_items": 1.913965349439158e-05, "add_time_dim_to_batch_and_zero_pad": 6.609134600400126e-06, "add_observations_from_episodes_to_batch": 8.754984570035777e-06}}, "connector_pipeline_timer": 0.00012446030040191895}, "num_episodes_lifetime": -524375.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 11.940000000000003}, "episode_return_min": -5.5, "time_between_sampling": 0.0054006763850689655, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.49492543682849e-06, "get_actions": 0.00015451002034275952, "listify_data_for_vector_env": 3.4034648650736036e-05, "un_batch_to_individual_items": 1.4211791812822964e-05, "normalize_and_clip_actions": 2.7012355670787898e-05, "tensor_to_numpy": 4.3593159121586276e-05}}, "connector_pipeline_timer": 0.00034591815081648356}, "sample": 0.01553941742878269, "episode_duration_sec_mean": 0.014639026819262655, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 11.940000000000003}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00011189304521377833, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 4.5917510472188324e-05, "episode_return_mean": 11.940000000000003, "episode_len_max": 20, "weights_seq_no": 18.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1557.877231357172}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.423828734914423e-06, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 114000, "vf_loss": 0.10185413807630539, "gradients_default_optimizer_global_norm": 0.04448277875781059, "entropy": 0.5988801717758179, "num_trainable_parameters": 6003, "vf_explained_var": 0.0010715723037719727, "vf_loss_unclipped": 38.91197967529297, "policy_loss": -0.11524400860071182, "weights_seq_no": 19.0, "mean_kl_loss": 4.5508480980060995e-05, "total_loss": -0.05254727974534035, "num_module_steps_trained_lifetime_throughput": 113274.80476739435}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00038030467630642865, "general_advantage_estimation": 0.039977661767859794, "batch_individual_items": 0.17141176577653658, "add_time_dim_to_batch_and_zero_pad": 5.1006920139219314e-05, "add_columns_from_episodes_to_train_batch": 0.11791641303794533, "add_observations_from_episodes_to_batch": 0.00768703167784889, "add_one_ts_to_episodes_and_truncate": 0.04216812190337683, "add_states_from_episodes_to_batch": 7.510595259787789e-06}}, "connector_pipeline_timer": 0.37991296154868187}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 590927.0520765334, "num_module_steps_trained_throughput": 112782.1577670757, "num_module_steps_trained_lifetime_throughput": 112622.41481304118}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.0446675754257935e-06, "numpy_to_tensor": 3.362080338842537e-05, "batch_individual_items": 1.913817330451629e-05, "add_time_dim_to_batch_and_zero_pad": 6.882629837682855e-06, "add_observations_from_episodes_to_batch": 9.387692623903816e-06}}, "connector_pipeline_timer": 0.000127363737124265}, "rlmodule_inference_timer": 0.00011456137948692445, "num_episodes_lifetime": 380, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.9}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_return_mean": 2.9, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.0389889577363124e-05, "remove_single_ts_time_rank_from_batch": 2.4195084214314183e-06, "tensor_to_numpy": 4.7044394604535814e-05, "listify_data_for_vector_env": 5.831251631104568e-05, "get_actions": 0.0001729308596708584, "un_batch_to_individual_items": 3.850405523321048e-05}}, "connector_pipeline_timer": 0.0004355822119548339}, "env_reset_timer": 0.0009135003535086716, "env_step_timer": 6.388225359910474e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 95400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.3735413463263595, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_duration_sec_mean": 0.015207972953794524, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 2.9}, "weights_seq_no": 19.0, "time_between_sampling": 13.757804330472517}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "49ece_00000", "date": "2025-08-11_19-30-08", "timestamp": 1754933408, "time_this_iter_s": 5.07567286491394, "time_total_s": 131.53490114212036, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 131.53490114212036, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 91.37142857142858, "ram_util_percent": 81.47142857142856}}
{"timers": {"training_iteration": 15.408654369521448, "restore_env_runners": 4.425193059686018e-05, "training_step": 15.408004974086566, "env_runner_sampling_timer": 14.713018968820531, "learner_update_timer": 0.6739109775033567, "synch_weights": 0.0063928986650346594, "restore_eval_env_runners": 5.284244494150715e-05, "evaluation_iteration": 1.4788459642224565, "synch_eval_env_connectors": 0.0006521956481625816, "synch_env_connectors": 1.1153374343505456e-05}, "env_runners": {"num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.959641206333017e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.067310096249352e-06, "numpy_to_tensor": 3.258280693930139e-05, "batch_individual_items": 1.8888831090602895e-05, "add_time_dim_to_batch_and_zero_pad": 6.66286760419349e-06, "add_observations_from_episodes_to_batch": 1.0716246658855948e-05}}, "connector_pipeline_timer": 0.00012841666295792373}, "num_episodes_lifetime": -555250.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 12.5}, "episode_return_min": -5.5, "time_between_sampling": 0.005074022812348874, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4983725626864803e-06, "get_actions": 0.00015784923230874545, "listify_data_for_vector_env": 3.41676085562711e-05, "un_batch_to_individual_items": 1.4885103021708239e-05, "normalize_and_clip_actions": 2.7490300018779856e-05, "tensor_to_numpy": 4.973945461283314e-05}}, "connector_pipeline_timer": 0.0003529853824239253}, "sample": 0.015094329573217036, "episode_duration_sec_mean": 0.015092264019884165, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes": 250.0, "module_episode_returns_mean": {"default_policy": 12.5}, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.0001062114104013969, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_step_timer": 4.681494998953739e-05, "episode_return_mean": 12.5, "episode_len_max": 20, "weights_seq_no": 19.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 1564.5426249466836}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 7.119143674572115e-07, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 120000, "vf_loss": 0.10185357928276062, "gradients_default_optimizer_global_norm": 0.03812684118747711, "entropy": 0.6000101566314697, "num_trainable_parameters": 6003, "vf_explained_var": 0.0011566877365112305, "vf_loss_unclipped": 38.9202995300293, "policy_loss": -0.05196285992860794, "weights_seq_no": 20.0, "mean_kl_loss": 8.406594133703038e-05, "total_loss": 0.01072325836867094, "num_module_steps_trained_lifetime_throughput": 113925.9698972094}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0003788920388974849, "general_advantage_estimation": 0.03979089140074148, "batch_individual_items": 0.17025200728868095, "add_time_dim_to_batch_and_zero_pad": 5.0698511379061826e-05, "add_columns_from_episodes_to_train_batch": 0.117613633076662, "add_observations_from_episodes_to_batch": 0.007626142201032541, "add_one_ts_to_episodes_and_truncate": 0.04192934651478596, "add_states_from_episodes_to_batch": 7.474649093146055e-06}}, "connector_pipeline_timer": 0.3779610331825244}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 594509.3317892409, "num_module_steps_trained_throughput": 113458.31663203324, "num_module_steps_trained_lifetime_throughput": 113301.70466995699}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5509084313256574e-06, "numpy_to_tensor": 2.956764836945604e-05, "batch_individual_items": 1.803987310138978e-05, "add_time_dim_to_batch_and_zero_pad": 7.729048794497912e-06, "add_observations_from_episodes_to_batch": 7.878397615843904e-06}}, "connector_pipeline_timer": 0.0001252112089330799}, "rlmodule_inference_timer": 9.78530861159267e-05, "num_episodes_lifetime": 400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.7}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_return_mean": 2.7, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.6748147708260135e-05, "remove_single_ts_time_rank_from_batch": 5.191379048036422e-06, "tensor_to_numpy": 3.697768708846708e-05, "listify_data_for_vector_env": 3.176008346000033e-05, "get_actions": 0.00013646799760971308, "un_batch_to_individual_items": 1.7462210610436924e-05}}, "connector_pipeline_timer": 0.00031612860087961326}, "env_reset_timer": 0.0009090036902977483, "env_step_timer": 4.892511887854506e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 100400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 1.363262754942702, "episode_return_max": 15.5, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_duration_sec_mean": 0.016129198756534607, "num_env_steps_sampled": 400, "agent_episode_returns_mean": {"default_agent": 2.7}, "weights_seq_no": 20.0, "time_between_sampling": 13.668984433417249}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "49ece_00000", "date": "2025-08-11_19-30-13", "timestamp": 1754933413, "time_this_iter_s": 5.161813974380493, "time_total_s": 136.69671511650085, "pid": 19765, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388b75b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.69671511650085, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 92.64285714285714, "ram_util_percent": 81.37142857142858}}
