{"timers": {"training_iteration": 2.706022624974139, "restore_env_runners": 1.1792057193815708e-05, "training_step": 2.7058517918922007, "env_runner_sampling_timer": 2.4795869580702856, "learner_update_timer": 0.22238724993076175, "synch_weights": 0.0009234589524567127}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.4448999869592778e-06, "numpy_to_tensor": 1.5411093080059928e-05, "add_observations_from_episodes_to_batch": 4.843603616582429e-06, "add_time_dim_to_batch_and_zero_pad": 3.872362040944133e-06, "batch_individual_items": 1.1011069461430514e-05}}, "connector_pipeline_timer": 7.125584296187979e-05}, "rlmodule_inference_timer": 8.627395076564157e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.329874664542155e-06, "normalize_and_clip_actions": 1.8788811376376253e-05, "tensor_to_numpy": 2.3718470507478216e-05, "remove_single_ts_time_rank_from_batch": 9.078064146986122e-07, "get_actions": 7.767563105327416e-05, "listify_data_for_vector_env": 1.8299493264664498e-05}}, "connector_pipeline_timer": 0.00018779511264932456}, "time_between_sampling": 0.0006938909470070054, "agent_episode_returns_mean": {"default_agent": 2.740000000000001}, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.4686836782172616e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_max": 14.5, "weights_seq_no": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_duration_sec_mean": 0.008405721159186214, "sample": 0.008140279144327911, "episode_len_min": 20, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_mean": 20.0, "num_episodes_lifetime": 31375.0, "episode_return_mean": 2.740000000000001, "env_reset_timer": 0.00010109603312520968, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 2.740000000000001}, "num_env_steps_sampled_lifetime_throughput": 2311.504137992538}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.3999990187585354e-05, "batch_individual_items": 0.04612929199356586, "add_states_from_episodes_to_batch": 3.999914042651653e-06, "add_one_ts_to_episodes_and_truncate": 0.00999062496703118, "general_advantage_estimation": 0.011200916953384876, "numpy_to_tensor": 8.433405309915543e-05, "add_observations_from_episodes_to_batch": 0.0008029579184949398, "add_columns_from_episodes_to_train_batch": 0.05020979209803045}}, "connector_pipeline_timer": 0.11868008400779217}, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained_lifetime": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1459016.8719733858, "num_module_steps_trained_throughput": 279211.57219465094, "num_module_steps_trained_lifetime_throughput": 278732.19794159697}, "default_policy": {"vf_loss": 0.09794427454471588, "total_loss": -0.004588165320456028, "vf_loss_unclipped": 30.640653610229492, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.06464065611362457, "num_module_steps_trained_lifetime": 6000, "entropy": 0.6885873675346375, "mean_kl_loss": 0.0010491644497960806, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.18117614090442657, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 1.0, "curr_kl_coeff": 0.3732481598854065, "vf_explained_var": 0.0010921955108642578, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 279936.74313669046}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1407367385831522e-05, "add_observations_from_episodes_to_batch": 3.5273565108024006e-06, "add_time_dim_to_batch_and_zero_pad": 2.8297397798636625e-06, "batch_individual_items": 8.183651647839426e-06, "add_states_from_episodes_to_batch": 1.9291879280866374e-06}}, "connector_pipeline_timer": 5.440253453994154e-05}, "episode_return_max": 12.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.5201993858410763e-05, "tensor_to_numpy": 1.935580624275455e-05, "remove_single_ts_time_rank_from_batch": 7.188330805351911e-07, "normalize_and_clip_actions": 1.29388380026782e-05, "get_actions": 5.927610186505616e-05, "un_batch_to_individual_items": 6.629866957995787e-06}}, "connector_pipeline_timer": 0.00014588227335993181}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 20, "episode_len_max": 20, "env_step_timer": 1.9402621405571034e-05, "rlmodule_inference_timer": 4.0624064099969875e-05, "num_env_steps_sampled": 400, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_min": 20, "sample": 0.1279377080500126, "agent_episode_returns_mean": {"default_agent": 2.7}, "episode_return_mean": 2.7, "env_reset_timer": 0.00017837504856288433, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_duration_sec_mean": 0.005854470760095864, "module_episode_returns_mean": {"default_policy": 2.7}, "num_env_steps_sampled_lifetime": 5400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-22", "timestamp": 1754933722, "time_this_iter_s": 2.8430659770965576, "time_total_s": 2.8430659770965576, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.8430659770965576, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 58.11999999999999, "ram_util_percent": 76.24}}
{"timers": {"training_iteration": 2.7031925316445995, "restore_env_runners": 1.1760387569665908e-05, "training_step": 2.703021086893277, "env_runner_sampling_timer": 2.4763225322391373, "learner_update_timer": 0.22280068951193244, "synch_weights": 0.0009240956127177923, "restore_eval_env_runners": 1.0624993592500687e-05, "evaluation_iteration": 0.13529833301436156, "synch_eval_env_connectors": 0.0001436250749975443, "synch_env_connectors": 4.708999767899513e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.386906917571697e-06, "numpy_to_tensor": 1.3952128099884759e-05, "add_observations_from_episodes_to_batch": 4.485595031971039e-06, "add_time_dim_to_batch_and_zero_pad": 3.7190276456715266e-06, "batch_individual_items": 9.898663680900099e-06}}, "connector_pipeline_timer": 6.457004497695331e-05}, "rlmodule_inference_timer": 4.700139493564116e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.729899334735048e-06, "normalize_and_clip_actions": 1.4061812022599438e-05, "tensor_to_numpy": 2.0862681561177065e-05, "remove_single_ts_time_rank_from_batch": 8.576563405385933e-07, "get_actions": 6.701260382949545e-05, "listify_data_for_vector_env": 1.6972798315115917e-05}}, "connector_pipeline_timer": 0.00016486187414543297}, "time_between_sampling": 0.0023024109697920674, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.2002651765154326e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_max": 14.5, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.00715413211705163, "sample": 0.00841366071511107, "episode_len_min": 20, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": 500.0, "episode_return_mean": 4.5, "env_reset_timer": 7.262711247287198e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 4.5}, "num_env_steps_sampled_lifetime_throughput": 2548.3676252598507}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.4009149745106698e-05, "batch_individual_items": 0.04745815740432591, "add_states_from_episodes_to_batch": 4.006165545433759e-06, "add_one_ts_to_episodes_and_truncate": 0.009974105797009542, "general_advantage_estimation": 0.011173480703728273, "numpy_to_tensor": 8.496905211359262e-05, "add_observations_from_episodes_to_batch": 0.0008039812499191612, "add_columns_from_episodes_to_train_batch": 0.0500943312572781}}, "connector_pipeline_timer": 0.11985029441770166}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 12000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1453545.494451952, "num_module_steps_trained_throughput": 278153.05284086487, "num_module_steps_trained_lifetime_throughput": 277677.2441892108}, "default_policy": {"vf_loss": 0.09875519573688507, "total_loss": -0.019843995571136475, "vf_loss_unclipped": 32.4010124206543, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.08004441857337952, "num_module_steps_trained_lifetime": 12000, "entropy": 0.691445529460907, "mean_kl_loss": 0.0011109872721135616, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.04752764850854874, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 2.0, "curr_kl_coeff": 0.18662407994270325, "vf_explained_var": 7.56978988647461e-05, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 278864.6600782538}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1551562424015277e-05, "add_observations_from_episodes_to_batch": 3.840894521941989e-06, "add_time_dim_to_batch_and_zero_pad": 3.080302454497963e-06, "batch_individual_items": 8.423359280555914e-06, "add_states_from_episodes_to_batch": 1.9629093663677662e-06}}, "connector_pipeline_timer": 5.573561630633784e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.5450653721565015e-05, "tensor_to_numpy": 1.8840543836960094e-05, "remove_single_ts_time_rank_from_batch": 8.701004779194765e-07, "normalize_and_clip_actions": 1.285810280912273e-05, "get_actions": 6.248480382726325e-05, "un_batch_to_individual_items": 7.153952212524341e-06}}, "connector_pipeline_timer": 0.00015218282096036406}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 40, "episode_len_max": 20, "env_step_timer": 2.1035051848051183e-05, "rlmodule_inference_timer": 4.3572477355845975e-05, "num_env_steps_sampled": 400, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_min": 20, "sample": 0.1280855422199238, "agent_episode_returns_mean": {"default_agent": 1.7}, "episode_return_mean": 1.7, "env_reset_timer": 0.00017747754813171923, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_duration_sec_mean": 0.006215180238359608, "module_episode_returns_mean": {"default_policy": 1.7}, "num_env_steps_sampled_lifetime": 10400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "time_between_sampling": 2.4515275409212336}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-25", "timestamp": 1754933725, "time_this_iter_s": 2.574751853942871, "time_total_s": 5.417817831039429, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.417817831039429, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 66.06666666666666, "ram_util_percent": 75.33333333333333}}
{"timers": {"training_iteration": 2.6990900559078317, "restore_env_runners": 1.1722364043816923e-05, "training_step": 2.6989182951846042, "env_runner_sampling_timer": 2.473167211496469, "learner_update_timer": 0.2218551755371038, "synch_weights": 0.0009221309075714087, "restore_eval_env_runners": 1.0601653484627604e-05, "evaluation_iteration": 0.13543392051476985, "synch_eval_env_connectors": 0.00014637757441960276, "synch_env_connectors": 4.708160413429141e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.3842490765026155e-06, "numpy_to_tensor": 1.4165182850947193e-05, "add_observations_from_episodes_to_batch": 4.448650618350862e-06, "add_time_dim_to_batch_and_zero_pad": 3.6480055077625772e-06, "batch_individual_items": 1.0072708012601454e-05}}, "connector_pipeline_timer": 6.506377746416683e-05}, "rlmodule_inference_timer": 4.578037271924371e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.067718813928745e-06, "normalize_and_clip_actions": 1.4214161996435907e-05, "tensor_to_numpy": 2.0085800167719036e-05, "remove_single_ts_time_rank_from_batch": 8.174254156267605e-07, "get_actions": 6.66535162136229e-05, "listify_data_for_vector_env": 1.6727764294915284e-05}}, "connector_pipeline_timer": 0.0001631913023841695}, "time_between_sampling": 0.002649458587908036, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.2465710086017942e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_max": 14.5, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.007132197359111162, "sample": 0.0077623500623350185, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -30375.0, "episode_return_mean": 5.460000000000001, "env_reset_timer": 6.757564478378203e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "num_env_steps_sampled_lifetime_throughput": 2562.0721391120883}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.3994058035314085e-05, "batch_individual_items": 0.04734816708024592, "add_states_from_episodes_to_batch": 4.00110415648669e-06, "add_one_ts_to_episodes_and_truncate": 0.010011067648406605, "general_advantage_estimation": 0.011140074646787252, "numpy_to_tensor": 8.482436230406166e-05, "add_observations_from_episodes_to_batch": 0.0008212168475729413, "add_columns_from_episodes_to_train_batch": 0.050052966694429046}}, "connector_pipeline_timer": 0.11971861939309164}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 18000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1448727.4589263955, "num_module_steps_trained_throughput": 277202.73351235746, "num_module_steps_trained_lifetime_throughput": 276734.84062663553}, "default_policy": {"vf_loss": 0.09795084595680237, "total_loss": 0.24234046041965485, "vf_loss_unclipped": 30.6032657623291, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.1828346997499466, "num_module_steps_trained_lifetime": 18000, "entropy": 0.6914345622062683, "mean_kl_loss": 0.0013817347353324294, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.1847822666168213, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 3.0, "curr_kl_coeff": 0.09331203997135162, "vf_explained_var": 0.0010613203048706055, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 277892.4001036555}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2644402829694465e-05, "add_observations_from_episodes_to_batch": 4.758952589347514e-06, "add_time_dim_to_batch_and_zero_pad": 3.707643428875588e-06, "batch_individual_items": 1.0818414647991851e-05, "add_states_from_episodes_to_batch": 2.8640932070915747e-06}}, "connector_pipeline_timer": 6.601485333366722e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.6449961449147223e-05, "tensor_to_numpy": 1.913263750298538e-05, "remove_single_ts_time_rank_from_batch": 8.375643494210386e-07, "normalize_and_clip_actions": 1.3426041821955893e-05, "get_actions": 6.636844487742976e-05, "un_batch_to_individual_items": 8.243336187469689e-06}}, "connector_pipeline_timer": 0.00016019209813074892}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 60, "episode_len_max": 20, "env_step_timer": 2.3947830247976065e-05, "rlmodule_inference_timer": 4.35515381772058e-05, "num_env_steps_sampled": 400, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_min": 20, "sample": 0.12809392262849723, "agent_episode_returns_mean": {"default_agent": 1.3666666666666667}, "episode_return_mean": 1.3666666666666667, "env_reset_timer": 0.00017644610194256528, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_duration_sec_mean": 0.006093367324986805, "module_episode_returns_mean": {"default_policy": 1.3666666666666667}, "num_env_steps_sampled_lifetime": 15400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "time_between_sampling": 2.450143113841768}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-27", "timestamp": 1754933727, "time_this_iter_s": 2.4305028915405273, "time_total_s": 7.848320722579956, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.848320722579956, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.375, "ram_util_percent": 75.525}}
{"timers": {"training_iteration": 2.6960519415983275, "restore_env_runners": 1.169347052881494e-05, "training_step": 2.695879461823499, "env_runner_sampling_timer": 2.4713300202106314, "learner_update_timer": 0.2206354642010755, "synch_weights": 0.0009192791790104236, "restore_eval_env_runners": 1.0598556243348866e-05, "evaluation_iteration": 0.13543256505886095, "synch_eval_env_connectors": 0.00014702087874757125, "synch_env_connectors": 4.715238709468395e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.431186974475673e-06, "numpy_to_tensor": 1.3804011086790298e-05, "add_observations_from_episodes_to_batch": 4.34582574342697e-06, "add_time_dim_to_batch_and_zero_pad": 3.6100236320096747e-06, "batch_individual_items": 9.82317816903178e-06}}, "connector_pipeline_timer": 6.446663651878081e-05}, "rlmodule_inference_timer": 4.625466030530613e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.71654870822158e-06, "normalize_and_clip_actions": 1.3945633667343426e-05, "tensor_to_numpy": 2.1059475528569696e-05, "remove_single_ts_time_rank_from_batch": 8.475406689420123e-07, "get_actions": 6.942719148038017e-05, "listify_data_for_vector_env": 1.6773479409239734e-05}}, "connector_pipeline_timer": 0.0001688400860882775}, "time_between_sampling": 0.00250553874454463, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.1769461631962895e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_max": 14.5, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.007192622655071319, "sample": 0.00764822714379461, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -61250.0, "episode_return_mean": 5.940000000000001, "env_reset_timer": 7.493530429618394e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "num_env_steps_sampled_lifetime_throughput": 2575.3049692337227}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.4001207049936058e-05, "batch_individual_items": 0.04718583208016307, "add_states_from_episodes_to_batch": 4.006093457574025e-06, "add_one_ts_to_episodes_and_truncate": 0.009993674471385426, "general_advantage_estimation": 0.011103468480315175, "numpy_to_tensor": 8.46206986764446e-05, "add_observations_from_episodes_to_batch": 0.000822068429136998, "add_columns_from_episodes_to_train_batch": 0.04992190286753384}}, "connector_pipeline_timer": 0.11937063694941903}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 24000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1453117.6107086632, "num_module_steps_trained_throughput": 278003.7663309722, "num_module_steps_trained_lifetime_throughput": 277544.81527250784}, "default_policy": {"vf_loss": 0.09893853217363358, "total_loss": 0.06070161238312721, "vf_loss_unclipped": 32.7551155090332, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.0005972132785245776, "num_module_steps_trained_lifetime": 24000, "entropy": 0.6874051094055176, "mean_kl_loss": 0.0017084633000195026, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.15090256929397583, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 4.0, "curr_kl_coeff": 0.04665601998567581, "vf_explained_var": 0.0005099177360534668, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 278660.69827146805}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4254676018899287e-05, "add_observations_from_episodes_to_batch": 4.102681034163256e-06, "add_time_dim_to_batch_and_zero_pad": 3.7217230795470514e-06, "batch_individual_items": 9.765518691152123e-06, "add_states_from_episodes_to_batch": 2.173706550903601e-06}}, "connector_pipeline_timer": 6.418529581122532e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.719076318847269e-05, "tensor_to_numpy": 2.0008376094321416e-05, "remove_single_ts_time_rank_from_batch": 1.0265827297270784e-06, "normalize_and_clip_actions": 1.3551929614748457e-05, "get_actions": 6.570567029238312e-05, "un_batch_to_individual_items": 7.538909830047596e-06}}, "connector_pipeline_timer": 0.00016077194773299794}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 80, "episode_len_max": 20, "env_step_timer": 2.2720275426080996e-05, "rlmodule_inference_timer": 4.340348904448321e-05, "num_env_steps_sampled": 400, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_min": 20, "sample": 0.1289649204829923, "agent_episode_returns_mean": {"default_agent": 1.2}, "episode_return_mean": 1.2, "env_reset_timer": 0.00017576206009287852, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_duration_sec_mean": 0.00702184894180391, "module_episode_returns_mean": {"default_policy": 1.2}, "num_env_steps_sampled_lifetime": 20400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "time_between_sampling": 2.4498069668724898}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-30", "timestamp": 1754933730, "time_this_iter_s": 2.6195449829101562, "time_total_s": 10.467865705490112, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.467865705490112, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 69.0, "ram_util_percent": 75.86666666666666}}
{"timers": {"training_iteration": 2.693340729681611, "restore_env_runners": 1.165612548660021e-05, "training_step": 2.6931670492957602, "env_runner_sampling_timer": 2.4694033958491413, "learner_update_timer": 0.21984624705989475, "synch_weights": 0.0009162288880082927, "restore_eval_env_runners": 1.0612570430501363e-05, "evaluation_iteration": 0.13629735190858788, "synch_eval_env_connectors": 0.00014720400036068165, "synch_env_connectors": 4.723505836329423e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.308822393521262e-06, "numpy_to_tensor": 1.4269304746640603e-05, "add_observations_from_episodes_to_batch": 4.394165920684503e-06, "add_time_dim_to_batch_and_zero_pad": 3.5683048910899027e-06, "batch_individual_items": 9.868054206816193e-06}}, "connector_pipeline_timer": 6.448049775202485e-05}, "rlmodule_inference_timer": 7.192771874880863e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.802667015904977e-06, "normalize_and_clip_actions": 1.4388245749154127e-05, "tensor_to_numpy": 2.0793095861474485e-05, "remove_single_ts_time_rank_from_batch": 8.341357971313529e-07, "get_actions": 6.675526015809807e-05, "listify_data_for_vector_env": 1.668976389417162e-05}}, "connector_pipeline_timer": 0.00016406741406101012}, "time_between_sampling": 0.0024364951303096952, "agent_episode_returns_mean": {"default_agent": 6.5}, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.1731218600870176e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_max": 14.5, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.007610616763588044, "sample": 0.00773339889617424, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -92125.0, "episode_return_mean": 6.5, "env_reset_timer": 6.905412423868304e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 6.5}, "num_env_steps_sampled_lifetime_throughput": 2590.368806290323}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.3982854811511937e-05, "batch_individual_items": 0.04710475625881449, "add_states_from_episodes_to_batch": 3.99812240645988e-06, "add_one_ts_to_episodes_and_truncate": 0.010017941897096063, "general_advantage_estimation": 0.011064378796184736, "numpy_to_tensor": 8.458407177734188e-05, "add_observations_from_episodes_to_batch": 0.0008240044147324108, "add_columns_from_episodes_to_train_batch": 0.05007005675892462}}, "connector_pipeline_timer": 0.11942387391054991}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 30000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1460017.2601750784, "num_module_steps_trained_throughput": 279277.9485788066, "num_module_steps_trained_lifetime_throughput": 278829.87686899264}, "default_policy": {"vf_loss": 0.09875169396400452, "total_loss": 0.13377542793750763, "vf_loss_unclipped": 32.43641662597656, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.07381351292133331, "num_module_steps_trained_lifetime": 30000, "entropy": 0.6789590120315552, "mean_kl_loss": 0.0014019616646692157, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.07133479416370392, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 5.0, "curr_kl_coeff": 0.023328009992837906, "vf_explained_var": 0.0012282133102416992, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 279898.16599031346}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1043436626399211e-05, "add_observations_from_episodes_to_batch": 4.173847669855663e-06, "add_time_dim_to_batch_and_zero_pad": 2.936486128393461e-06, "batch_individual_items": 8.194363716384359e-06, "add_states_from_episodes_to_batch": 2.031335377296444e-06}}, "connector_pipeline_timer": 5.529579869589532e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.3950062883801995e-05, "tensor_to_numpy": 1.763132464269742e-05, "remove_single_ts_time_rank_from_batch": 7.107315486280146e-07, "normalize_and_clip_actions": 1.1699604487372624e-05, "get_actions": 5.3470422250978846e-05, "un_batch_to_individual_items": 6.770963353682331e-06}}, "connector_pipeline_timer": 0.0001359509441017285}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 100, "episode_len_max": 20, "env_step_timer": 1.929853007327105e-05, "rlmodule_inference_timer": 3.8525616650285665e-05, "num_env_steps_sampled": 400, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_min": 20, "sample": 0.129019289197781, "agent_episode_returns_mean": {"default_agent": 0.7}, "episode_return_mean": 0.7, "env_reset_timer": 0.00017491151973994797, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_duration_sec_mean": 0.006843883733963594, "module_episode_returns_mean": {"default_policy": 0.7}, "num_env_steps_sampled_lifetime": 25400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "time_between_sampling": 2.44983525970322}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-32", "timestamp": 1754933732, "time_this_iter_s": 2.567861795425415, "time_total_s": 13.035727500915527, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.035727500915527, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.22500000000001, "ram_util_percent": 75.6}}
{"timers": {"training_iteration": 2.690368098634673, "restore_env_runners": 1.1604984985988073e-05, "training_step": 2.690194213383647, "env_runner_sampling_timer": 2.46635842189085, "learner_update_timer": 0.21992407208957668, "synch_weights": 0.0009133499286951504, "restore_eval_env_runners": 1.0569774661270203e-05, "evaluation_iteration": 0.1363397379799281, "synch_eval_env_connectors": 0.00014694111973876249, "synch_env_connectors": 4.720441079373704e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.4414489747820194e-06, "numpy_to_tensor": 1.4299435344640731e-05, "add_observations_from_episodes_to_batch": 4.4887309040671614e-06, "add_time_dim_to_batch_and_zero_pad": 3.670280850430402e-06, "batch_individual_items": 1.0515796141674996e-05}}, "connector_pipeline_timer": 6.57349448462784e-05}, "rlmodule_inference_timer": 4.7484708464481e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.803089623669061e-06, "normalize_and_clip_actions": 1.4228431266841195e-05, "tensor_to_numpy": 2.0867649429691832e-05, "remove_single_ts_time_rank_from_batch": 8.957369880920809e-07, "get_actions": 6.765856175381788e-05, "listify_data_for_vector_env": 1.68420367176177e-05}}, "connector_pipeline_timer": 0.0001657894535192939}, "time_between_sampling": 0.002225147917532941, "agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.2508799197373145e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_max": 14.5, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.00721963099669665, "sample": 0.008120088438375868, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -123000.0, "episode_return_mean": 6.820000000000002, "env_reset_timer": 6.831806411432694e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "num_env_steps_sampled_lifetime_throughput": 2561.7623926749775}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.3960106316711384e-05, "batch_individual_items": 0.04817550828598508, "add_states_from_episodes_to_batch": 3.9902205884779105e-06, "add_one_ts_to_episodes_and_truncate": 0.010011421647631384, "general_advantage_estimation": 0.01101032750899149, "numpy_to_tensor": 8.44432306070202e-05, "add_observations_from_episodes_to_batch": 0.0008287464601232138, "add_columns_from_episodes_to_train_batch": 0.04996190244112177}}, "connector_pipeline_timer": 0.12032966309095852}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1468513.6841129286, "num_module_steps_trained_throughput": 280866.6277371152, "num_module_steps_trained_lifetime_throughput": 280425.1940075027}, "default_policy": {"vf_loss": 0.09929709136486053, "total_loss": 0.06740652769804001, "vf_loss_unclipped": 33.48452377319336, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.007046705111861229, "num_module_steps_trained_lifetime": 36000, "entropy": 0.6706355810165405, "mean_kl_loss": 0.000993289751932025, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.03585651144385338, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 6.0, "curr_kl_coeff": 0.011664004996418953, "vf_explained_var": 0.0018221735954284668, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 281446.11947068333}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.7316190154443588e-05, "add_observations_from_episodes_to_batch": 5.199009346832808e-06, "add_time_dim_to_batch_and_zero_pad": 4.180368845175373e-06, "batch_individual_items": 1.17369912876981e-05, "add_states_from_episodes_to_batch": 3.451894167566347e-06}}, "connector_pipeline_timer": 7.65672885017332e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.1530431586525973e-05, "tensor_to_numpy": 2.6093255548072347e-05, "remove_single_ts_time_rank_from_batch": 1.4759760939379945e-06, "normalize_and_clip_actions": 1.7412531418921006e-05, "get_actions": 8.309038206706636e-05, "un_batch_to_individual_items": 9.173115065223768e-06}}, "connector_pipeline_timer": 0.00020419912466377845}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 120, "episode_len_max": 20, "env_step_timer": 2.7733693943976284e-05, "rlmodule_inference_timer": 5.997685571801334e-05, "num_env_steps_sampled": 400, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_min": 20, "sample": 0.12972802214581963, "agent_episode_returns_mean": {"default_agent": -0.3}, "episode_return_mean": -0.3, "env_reset_timer": 0.0001740611541101168, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_duration_sec_mean": 0.007514028310542926, "module_episode_returns_mean": {"default_policy": -0.3}, "num_env_steps_sampled_lifetime": 30400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "time_between_sampling": 2.4494848421059703}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-35", "timestamp": 1754933735, "time_this_iter_s": 2.60471773147583, "time_total_s": 15.640445232391357, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.640445232391357, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 69.375, "ram_util_percent": 75.525}}
{"timers": {"training_iteration": 2.685841099308861, "restore_env_runners": 1.1549765634242421e-05, "training_step": 2.685664624579367, "env_runner_sampling_timer": 2.4625330489217343, "learner_update_timer": 0.21919233886888237, "synch_weights": 0.0009135610092929813, "restore_eval_env_runners": 1.0534496542830613e-05, "evaluation_iteration": 0.13703861560004535, "synch_eval_env_connectors": 0.00014646670913287646, "synch_env_connectors": 4.72240700806001e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.2781273810648793e-06, "numpy_to_tensor": 1.3555039897032934e-05, "add_observations_from_episodes_to_batch": 4.319267379649856e-06, "add_time_dim_to_batch_and_zero_pad": 3.900669644697814e-06, "batch_individual_items": 9.683262698103906e-06}}, "connector_pipeline_timer": 6.283211290296356e-05}, "rlmodule_inference_timer": 4.47560185172731e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.797181265802486e-06, "normalize_and_clip_actions": 1.431848140595475e-05, "tensor_to_numpy": 2.01418870914399e-05, "remove_single_ts_time_rank_from_batch": 8.505999563385114e-07, "get_actions": 6.413757111954807e-05, "listify_data_for_vector_env": 1.664840726675276e-05}}, "connector_pipeline_timer": 0.00016041995707087654}, "time_between_sampling": 0.002691897397958441, "agent_episode_returns_mean": {"default_agent": 7.54}, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.19228838775899e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_max": 14.5, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006946281877346336, "sample": 0.0074822498426750685, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -153875.0, "episode_return_mean": 7.54, "env_reset_timer": 6.478493899930963e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 7.54}, "num_env_steps_sampled_lifetime_throughput": 2639.176622673182}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.4054255578240572e-05, "batch_individual_items": 0.0480947244530353, "add_states_from_episodes_to_batch": 4.025738048838711e-06, "add_one_ts_to_episodes_and_truncate": 0.010010941181660815, "general_advantage_estimation": 0.010990960903855488, "numpy_to_tensor": 8.429671746852821e-05, "add_observations_from_episodes_to_batch": 0.0008298544163061124, "add_columns_from_episodes_to_train_batch": 0.04997761799610568}}, "connector_pipeline_timer": 0.12024525437090115}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 42000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1466766.1274042157, "num_module_steps_trained_throughput": 280499.56850321055, "num_module_steps_trained_lifetime_throughput": 280065.63851619285}, "default_policy": {"vf_loss": 0.100577712059021, "total_loss": -0.14335104823112488, "vf_loss_unclipped": 36.07630157470703, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.2045687586069107, "num_module_steps_trained_lifetime": 42000, "entropy": 0.6684635877609253, "mean_kl_loss": 0.0004201476403977722, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.03081803396344185, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 7.0, "curr_kl_coeff": 0.0058320024982094765, "vf_explained_var": 0.0011950135231018066, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 281041.92514753947}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.238488004952874e-05, "add_observations_from_episodes_to_batch": 4.243418236041229e-06, "add_time_dim_to_batch_and_zero_pad": 3.5936512917241814e-06, "batch_individual_items": 8.475705449023434e-06, "add_states_from_episodes_to_batch": 2.046479002430254e-06}}, "connector_pipeline_timer": 5.770566021104252e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.7077395983879614e-05, "tensor_to_numpy": 1.884122040479094e-05, "remove_single_ts_time_rank_from_batch": 7.595797250673074e-07, "normalize_and_clip_actions": 1.2446005799529401e-05, "get_actions": 6.0556647973410376e-05, "un_batch_to_individual_items": 7.483590501878785e-06}}, "connector_pipeline_timer": 0.00015075255723344527}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 140, "episode_len_max": 20, "env_step_timer": 2.0629215025217587e-05, "rlmodule_inference_timer": 3.795167768023511e-05, "num_env_steps_sampled": 400, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_min": 20, "sample": 0.1298560756750285, "agent_episode_returns_mean": {"default_agent": -0.3}, "episode_return_mean": -0.3, "env_reset_timer": 0.00017312554171376347, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_duration_sec_mean": 0.007496498710243032, "module_episode_returns_mean": {"default_policy": -0.3}, "num_env_steps_sampled_lifetime": 35400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "time_between_sampling": 2.4476348461848536}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-38", "timestamp": 1754933738, "time_this_iter_s": 2.3895046710968018, "time_total_s": 18.02994990348816, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.02994990348816, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 67.26666666666667, "ram_util_percent": 75.5}}
{"timers": {"training_iteration": 2.6835523066556557, "restore_env_runners": 1.1497597912973849e-05, "training_step": 2.6833755237531323, "env_runner_sampling_timer": 2.4612591171831912, "learner_update_timer": 0.21817597673061384, "synch_weights": 0.0009118849891787315, "restore_eval_env_runners": 1.0500401246820046e-05, "evaluation_iteration": 0.137153954853629, "synch_eval_env_connectors": 0.00014700121209529796, "synch_env_connectors": 4.72518215455086e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.3224322889751503e-06, "numpy_to_tensor": 1.4838195201803598e-05, "add_observations_from_episodes_to_batch": 4.629683602874677e-06, "add_time_dim_to_batch_and_zero_pad": 3.614327863224127e-06, "batch_individual_items": 1.0203441299471855e-05}}, "connector_pipeline_timer": 6.55188211617067e-05}, "rlmodule_inference_timer": 6.624762614792316e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.924410974058445e-06, "normalize_and_clip_actions": 1.5737875023097608e-05, "tensor_to_numpy": 2.1439986694544174e-05, "remove_single_ts_time_rank_from_batch": 9.133924466092451e-07, "get_actions": 6.817141640383456e-05, "listify_data_for_vector_env": 1.7166998000646877e-05}}, "connector_pipeline_timer": 0.00017019205846527207}, "time_between_sampling": 0.002247396904700423, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.379259748381666e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_max": 14.5, "weights_seq_no": 7.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.007848872317001225, "sample": 0.008041570798938582, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -184750.0, "episode_return_mean": 8.419999999999998, "env_reset_timer": 6.795441874689287e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "num_env_steps_sampled_lifetime_throughput": 2566.2045492669713}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.6013302932816358e-05, "batch_individual_items": 0.0479984763787498, "add_states_from_episodes_to_batch": 4.0888109080039115e-06, "add_one_ts_to_episodes_and_truncate": 0.01001657844000465, "general_advantage_estimation": 0.010969942964691943, "numpy_to_tensor": 8.494249969734944e-05, "add_observations_from_episodes_to_batch": 0.0008333054517142388, "add_columns_from_episodes_to_train_batch": 0.049850430565886755}}, "connector_pipeline_timer": 0.12001233598729578}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 48000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1467526.316849109, "num_module_steps_trained_throughput": 280597.4074587471, "num_module_steps_trained_lifetime_throughput": 280169.32776134077}, "default_policy": {"vf_loss": 0.10039109736680984, "total_loss": -0.045362912118434906, "vf_loss_unclipped": 35.76835250854492, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.10652390867471695, "num_module_steps_trained_lifetime": 48000, "entropy": 0.6606499552726746, "mean_kl_loss": 0.0003812006616499275, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.0560244545340538, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 8.0, "curr_kl_coeff": 0.0029160012491047382, "vf_explained_var": 0.0018621087074279785, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 281087.82997793367}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.125992957755431e-05, "add_observations_from_episodes_to_batch": 3.551258684276277e-06, "add_time_dim_to_batch_and_zero_pad": 3.2276130159456413e-06, "batch_individual_items": 8.789434157883644e-06, "add_states_from_episodes_to_batch": 1.9462296805342404e-06}}, "connector_pipeline_timer": 5.600461820307781e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.5122837672728163e-05, "tensor_to_numpy": 1.76460714079856e-05, "remove_single_ts_time_rank_from_batch": 6.703933502735663e-07, "normalize_and_clip_actions": 1.1331615052528165e-05, "get_actions": 5.5931332099724365e-05, "un_batch_to_individual_items": 6.366793987066751e-06}}, "connector_pipeline_timer": 0.00013714442032440117}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 160, "episode_len_max": 20, "env_step_timer": 1.9737000322909526e-05, "rlmodule_inference_timer": 3.797520228271296e-05, "num_env_steps_sampled": 400, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_min": 20, "sample": 0.13002969866828923, "agent_episode_returns_mean": {"default_agent": -0.9}, "episode_return_mean": -0.9, "env_reset_timer": 0.0001722297059291203, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_duration_sec_mean": 0.007679178741527721, "module_episode_returns_mean": {"default_policy": -0.9}, "num_env_steps_sampled_lifetime": 40400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "time_between_sampling": 2.4479223435534623}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-40", "timestamp": 1754933740, "time_this_iter_s": 2.6131319999694824, "time_total_s": 20.64308190345764, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.64308190345764, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 68.9, "ram_util_percent": 75.32499999999999}}
{"timers": {"training_iteration": 2.6803558560890357, "restore_env_runners": 1.1438872653197667e-05, "training_step": 2.6801788543461607, "env_runner_sampling_timer": 2.457680133511499, "learner_update_timer": 0.2185614298837108, "synch_weights": 0.0009102869695456713, "restore_eval_env_runners": 1.0465396603213162e-05, "evaluation_iteration": 0.13731787488499259, "synch_eval_env_connectors": 0.00014681329006269755, "synch_env_connectors": 4.872510394366545e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.329464430144175e-06, "numpy_to_tensor": 1.3656076822790296e-05, "add_observations_from_episodes_to_batch": 4.324582420700489e-06, "add_time_dim_to_batch_and_zero_pad": 3.5019281298388753e-06, "batch_individual_items": 9.605707212915358e-06}}, "connector_pipeline_timer": 6.260097582666821e-05}, "rlmodule_inference_timer": 4.6101413786783325e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.691274814687636e-06, "normalize_and_clip_actions": 1.4150901825628878e-05, "tensor_to_numpy": 2.0089349577559947e-05, "remove_single_ts_time_rank_from_batch": 8.071593962373238e-07, "get_actions": 6.499839988014151e-05, "listify_data_for_vector_env": 1.6289458654567884e-05}}, "connector_pipeline_timer": 0.00016060532582666708}, "time_between_sampling": 0.0021028682446188078, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.1571613876813427e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_max": 14.5, "weights_seq_no": 8.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.007002897008787842, "sample": 0.00773411480804792, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -215625.0, "episode_return_mean": 8.419999999999998, "env_reset_timer": 6.439200553553236e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "num_env_steps_sampled_lifetime_throughput": 2628.2814317060465}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.5967339573757088e-05, "batch_individual_items": 0.047954151204673875, "add_states_from_episodes_to_batch": 4.080012682385467e-06, "add_one_ts_to_episodes_and_truncate": 0.011350588485240537, "general_advantage_estimation": 0.010920243945348495, "numpy_to_tensor": 8.477182492106216e-05, "add_observations_from_episodes_to_batch": 0.0008340244870782483, "add_columns_from_episodes_to_train_batch": 0.04977950542985517}}, "connector_pipeline_timer": 0.12118076137736888}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 54000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1469734.6169078315, "num_module_steps_trained_throughput": 280970.9591647608, "num_module_steps_trained_lifetime_throughput": 280552.51222802064}, "default_policy": {"vf_loss": 0.10038838535547256, "total_loss": -0.02790551446378231, "vf_loss_unclipped": 35.71833038330078, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.0891357809305191, "num_module_steps_trained_lifetime": 54000, "entropy": 0.6526697874069214, "mean_kl_loss": 0.00035186053719371557, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.0056614866480231285, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 9.0, "curr_kl_coeff": 0.0014580006245523691, "vf_explained_var": 0.0028856992721557617, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 281399.5197503877}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1560637157029251e-05, "add_observations_from_episodes_to_batch": 3.12576366284882e-06, "add_time_dim_to_batch_and_zero_pad": 2.72899332918779e-06, "batch_individual_items": 7.141705642270154e-06, "add_states_from_episodes_to_batch": 1.6921756901755806e-06}}, "connector_pipeline_timer": 5.0067286172844794e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.2536143382464987e-05, "tensor_to_numpy": 1.6183576678782463e-05, "remove_single_ts_time_rank_from_batch": 7.884734304619018e-07, "normalize_and_clip_actions": 1.0632802827760432e-05, "get_actions": 4.5791981611016066e-05, "un_batch_to_individual_items": 6.084336371960928e-06}}, "connector_pipeline_timer": 0.00012043740520499247}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 180, "episode_len_max": 20, "env_step_timer": 1.635780544928227e-05, "rlmodule_inference_timer": 3.2546218971512e-05, "num_env_steps_sampled": 400, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.12994453835094968, "agent_episode_returns_mean": {"default_agent": -0.3}, "episode_return_mean": -0.3, "env_reset_timer": 0.00017119073886927595, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_duration_sec_mean": 0.0068308808235451575, "module_episode_returns_mean": {"default_policy": -0.3}, "num_env_steps_sampled_lifetime": 45400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.447302498458349}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-43", "timestamp": 1754933743, "time_this_iter_s": 2.4933440685272217, "time_total_s": 23.136425971984863, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.136425971984863, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 66.8, "ram_util_percent": 75.46666666666667}}
{"timers": {"training_iteration": 2.671734512527251, "restore_env_runners": 1.140489431775799e-05, "training_step": 2.6715572653929778, "env_runner_sampling_timer": 2.4494100259258866, "learner_update_timer": 0.2182170564151275, "synch_weights": 0.0009072407699497115, "restore_eval_env_runners": 1.0436582562738405e-05, "evaluation_iteration": 0.13721253363517819, "synch_eval_env_connectors": 0.00014720390705463322, "synch_env_connectors": 4.865454990717613e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9337068394221076e-06, "numpy_to_tensor": 1.0506387691006247e-05, "add_observations_from_episodes_to_batch": 3.54231380567349e-06, "add_time_dim_to_batch_and_zero_pad": 2.8337577875132234e-06, "batch_individual_items": 7.544866615316316e-06}}, "connector_pipeline_timer": 5.072668210995364e-05}, "rlmodule_inference_timer": 3.4115770951946354e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.242507405983971e-06, "normalize_and_clip_actions": 1.1093954362023596e-05, "tensor_to_numpy": 1.601162909267819e-05, "remove_single_ts_time_rank_from_batch": 6.811677974802769e-07, "get_actions": 4.911445633641402e-05, "listify_data_for_vector_env": 1.2949605643271368e-05}}, "connector_pipeline_timer": 0.00012578345081274849}, "time_between_sampling": 0.0024130064213127786, "agent_episode_returns_mean": {"default_agent": 9.940000000000001}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.6632670990296196e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_max": 14.5, "weights_seq_no": 9.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005410778324585404, "sample": 0.006681842002289553, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -246500.0, "episode_return_mean": 9.940000000000001, "env_reset_timer": 5.453470760804761e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 9.940000000000001}, "num_env_steps_sampled_lifetime_throughput": 3242.6086288872198}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.5893075443031066e-05, "batch_individual_items": 0.04871002802280666, "add_states_from_episodes_to_batch": 4.065872828413198e-06, "add_one_ts_to_episodes_and_truncate": 0.01131264969034066, "general_advantage_estimation": 0.010862413165978543, "numpy_to_tensor": 8.447619702239003e-05, "add_observations_from_episodes_to_batch": 0.0008337800826652927, "add_columns_from_episodes_to_train_batch": 0.04961630995477539}}, "connector_pipeline_timer": 0.12167548751341585}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 60000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1481262.183958698, "num_module_steps_trained_throughput": 283126.37485827954, "num_module_steps_trained_lifetime_throughput": 282716.5720597788}, "default_policy": {"vf_loss": 0.10020184516906738, "total_loss": 0.15950974822044373, "vf_loss_unclipped": 35.351341247558594, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.09833916276693344, "num_module_steps_trained_lifetime": 60000, "entropy": 0.64539635181427, "mean_kl_loss": 0.00015151759725995362, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.06948995590209961, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 10.0, "curr_kl_coeff": 0.0007290003122761846, "vf_explained_var": 0.0037711262702941895, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 283498.0716541054}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.050380919371208e-06, "add_observations_from_episodes_to_batch": 2.7321871000267197e-06, "add_time_dim_to_batch_and_zero_pad": 2.257133049801452e-06, "batch_individual_items": 5.975312944595727e-06, "add_states_from_episodes_to_batch": 1.5733613514631842e-06}}, "connector_pipeline_timer": 4.167379334288714e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.069467324064509e-05, "tensor_to_numpy": 1.2796302700205255e-05, "remove_single_ts_time_rank_from_batch": 5.790313327505299e-07, "normalize_and_clip_actions": 9.115904481700583e-06, "get_actions": 3.591217568521679e-05, "un_batch_to_individual_items": 5.218035905395136e-06}}, "connector_pipeline_timer": 9.91684505028709e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 200, "episode_len_max": 20, "env_step_timer": 1.34957518703717e-05, "rlmodule_inference_timer": 2.6493866303615454e-05, "num_env_steps_sampled": 400, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.12960223213793598, "agent_episode_returns_mean": {"default_agent": 0.9}, "episode_return_mean": 0.9, "env_reset_timer": 0.0001702534206149634, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_duration_sec_mean": 0.006484992473851889, "module_episode_returns_mean": {"default_policy": 0.9}, "num_env_steps_sampled_lifetime": 50400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.4412027838930306}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-45", "timestamp": 1754933745, "time_this_iter_s": 1.921079158782959, "time_total_s": 25.057505130767822, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.057505130767822, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 61.33333333333332, "ram_util_percent": 75.33333333333333}}
{"timers": {"training_iteration": 2.659590733242234, "restore_env_runners": 1.1347515189092542e-05, "training_step": 2.659413448989273, "env_runner_sampling_timer": 2.4385258452460947, "learner_update_timer": 0.21695605335059484, "synch_weights": 0.0009058116928596403, "restore_eval_env_runners": 1.0397216067899872e-05, "evaluation_iteration": 0.13684628579969202, "synch_eval_env_connectors": 0.00014670269842647078, "synch_env_connectors": 4.856799581236953e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7043762028652927e-06, "numpy_to_tensor": 8.415129952315796e-06, "add_observations_from_episodes_to_batch": 2.959608420335823e-06, "add_time_dim_to_batch_and_zero_pad": 2.390255064384318e-06, "batch_individual_items": 6.184810292503308e-06}}, "connector_pipeline_timer": 4.3047993366266146e-05}, "rlmodule_inference_timer": 2.8269780386813686e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.312457415907832e-06, "normalize_and_clip_actions": 9.370165007246243e-06, "tensor_to_numpy": 1.2911763604914926e-05, "remove_single_ts_time_rank_from_batch": 5.763884919097626e-07, "get_actions": 3.8685841142527985e-05, "listify_data_for_vector_env": 1.0816051092521713e-05}}, "connector_pipeline_timer": 0.00010298626922514907}, "time_between_sampling": 0.0018721904795872709, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3428390186416488e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_max": 14.5, "weights_seq_no": 10.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.0045140376412309705, "sample": 0.005014474771995149, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -277375.0, "episode_return_mean": 9.460000000000004, "env_reset_timer": 3.418786139925463e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "num_env_steps_sampled_lifetime_throughput": 3774.8713049343487}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.582706507017658e-05, "batch_individual_items": 0.048522532323083414, "add_states_from_episodes_to_batch": 4.053964028007446e-06, "add_one_ts_to_episodes_and_truncate": 0.011274411942951028, "general_advantage_estimation": 0.01080663194425462, "numpy_to_tensor": 8.412893476584031e-05, "add_observations_from_episodes_to_batch": 0.0008335497812909476, "add_columns_from_episodes_to_train_batch": 0.04946260352570562}}, "connector_pipeline_timer": 0.12123809096846443}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1498054.5933560624, "num_module_steps_trained_throughput": 286288.7090573178, "num_module_steps_trained_lifetime_throughput": 285887.53458170145}, "default_policy": {"vf_loss": 0.10056816786527634, "total_loss": 0.024965224787592888, "vf_loss_unclipped": 36.1129264831543, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.03647731989622116, "num_module_steps_trained_lifetime": 66000, "entropy": 0.6424030065536499, "mean_kl_loss": 0.00011596082913456485, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.05864938348531723, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 11.0, "curr_kl_coeff": 0.0003645001561380923, "vf_explained_var": 0.003722965717315674, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 286601.2265394375}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.037300630853534e-06, "add_observations_from_episodes_to_batch": 2.7414676694472773e-06, "add_time_dim_to_batch_and_zero_pad": 2.246484473250398e-06, "batch_individual_items": 5.929682168540945e-06, "add_states_from_episodes_to_batch": 1.5918608191135922e-06}}, "connector_pipeline_timer": 4.157374629266545e-05}, "episode_return_max": 15.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0685703728418744e-05, "tensor_to_numpy": 1.2713593108839301e-05, "remove_single_ts_time_rank_from_batch": 5.834909125824739e-07, "normalize_and_clip_actions": 9.045112945483987e-06, "get_actions": 3.524176724392726e-05, "un_batch_to_individual_items": 5.247466483743621e-06}}, "connector_pipeline_timer": 9.837966080405647e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 220, "episode_len_max": 20, "env_step_timer": 1.360849191712356e-05, "rlmodule_inference_timer": 2.6483937924086606e-05, "num_env_steps_sampled": 400, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.12927163273697367, "agent_episode_returns_mean": {"default_agent": 1.7}, "episode_return_mean": 1.7, "env_reset_timer": 0.00016950379704070882, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_duration_sec_mean": 0.005528282918967307, "module_episode_returns_mean": {"default_policy": 1.7}, "num_env_steps_sampled_lifetime": 55400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.4315342402242766}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-46", "timestamp": 1754933746, "time_this_iter_s": 1.561155080795288, "time_total_s": 26.61866021156311, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.61866021156311, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 36.599999999999994, "ram_util_percent": 74.6}}
{"timers": {"training_iteration": 2.64904946923951, "restore_env_runners": 1.129111963364658e-05, "training_step": 2.648872351998458, "env_runner_sampling_timer": 2.429269220962866, "learner_update_timer": 0.21567881322743737, "synch_weights": 0.0009023948261036738, "restore_eval_env_runners": 1.038449372892848e-05, "evaluation_iteration": 0.13649251211268337, "synch_eval_env_connectors": 0.00014634942148273724, "synch_env_connectors": 4.849901285719317e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.74181854434519e-06, "numpy_to_tensor": 8.836736261887576e-06, "add_observations_from_episodes_to_batch": 3.105687955484414e-06, "add_time_dim_to_batch_and_zero_pad": 2.483037248522197e-06, "batch_individual_items": 6.430769226570148e-06}}, "connector_pipeline_timer": 4.451708594892781e-05}, "rlmodule_inference_timer": 2.966381224951775e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.480788622396831e-06, "normalize_and_clip_actions": 9.709002372208612e-06, "tensor_to_numpy": 1.3550707523024173e-05, "remove_single_ts_time_rank_from_batch": 6.02544600032777e-07, "get_actions": 4.1913094545168864e-05, "listify_data_for_vector_env": 1.1340616996539646e-05}}, "connector_pipeline_timer": 0.00010859220946561901}, "time_between_sampling": 0.0018161757136201059, "agent_episode_returns_mean": {"default_agent": 9.539999999999996}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.4119053985533757e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_max": 14.5, "weights_seq_no": 11.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.004729121677577496, "sample": 0.005021728623935045, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -308250.0, "episode_return_mean": 9.539999999999996, "env_reset_timer": 3.3706864657360155e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 9.539999999999996}, "num_env_steps_sampled_lifetime_throughput": 3666.7918736419106}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.5761714801050636e-05, "batch_individual_items": 0.04833037992061086, "add_states_from_episodes_to_batch": 4.0421743156057515e-06, "add_one_ts_to_episodes_and_truncate": 0.011237663653642035, "general_advantage_estimation": 0.010749914785306357, "numpy_to_tensor": 8.390222634932387e-05, "add_observations_from_episodes_to_batch": 0.0008332901133061961, "add_columns_from_episodes_to_train_batch": 0.049300367490560916}}, "connector_pipeline_timer": 0.12078818380870796}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1521060.226949706, "num_module_steps_trained_throughput": 290638.7473627731, "num_module_steps_trained_lifetime_throughput": 290245.2857439418}, "default_policy": {"vf_loss": 0.10111989825963974, "total_loss": -0.09505714476108551, "vf_loss_unclipped": 37.25564193725586, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.156912699341774, "num_module_steps_trained_lifetime": 72000, "entropy": 0.6375489234924316, "mean_kl_loss": 0.0003195784520357847, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.030036011710762978, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 12.0, "curr_kl_coeff": 0.00018225007806904614, "vf_explained_var": 0.0028873085975646973, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 290900.05232148065}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.480866398981454e-06, "add_observations_from_episodes_to_batch": 2.8564972170195424e-06, "add_time_dim_to_batch_and_zero_pad": 2.3240328404053377e-06, "batch_individual_items": 6.16179128258906e-06, "add_states_from_episodes_to_batch": 1.5900775270969308e-06}}, "connector_pipeline_timer": 4.297879214676223e-05}, "episode_return_max": 15.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1234204435785405e-05, "tensor_to_numpy": 1.317042191190289e-05, "remove_single_ts_time_rank_from_batch": 6.029626552616799e-07, "normalize_and_clip_actions": 9.69261638199641e-06, "get_actions": 3.790032653566389e-05, "un_batch_to_individual_items": 5.398834641380289e-06}}, "connector_pipeline_timer": 0.00010350264951503452}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 240, "episode_len_max": 20, "env_step_timer": 1.4088195158856016e-05, "rlmodule_inference_timer": 2.785695469949533e-05, "num_env_steps_sampled": 400, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.12896138849942168, "agent_episode_returns_mean": {"default_agent": 2.1}, "episode_return_mean": 2.1, "env_reset_timer": 0.00016855166926730642, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_duration_sec_mean": 0.005132783306762576, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled_lifetime": 60400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.4234386049021968}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-48", "timestamp": 1754933748, "time_this_iter_s": 1.7107269763946533, "time_total_s": 28.329387187957764, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.329387187957764, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.56666666666666, "ram_util_percent": 74.83333333333333}}
{"timers": {"training_iteration": 2.638196840377328, "restore_env_runners": 1.123236833748366e-05, "training_step": 2.6380194418087735, "env_runner_sampling_timer": 2.419672105423584, "learner_update_timer": 0.21442768925438085, "synch_weights": 0.0008994329577621392, "restore_eval_env_runners": 1.0342318644223797e-05, "evaluation_iteration": 0.13615699199171044, "synch_eval_env_connectors": 0.0001458875961290457, "synch_env_connectors": 4.839732017573642e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7090952285049374e-06, "numpy_to_tensor": 8.491231778462704e-06, "add_observations_from_episodes_to_batch": 2.9561560340358894e-06, "add_time_dim_to_batch_and_zero_pad": 2.4030391314516217e-06, "batch_individual_items": 6.204406063027631e-06}}, "connector_pipeline_timer": 4.3128362359167606e-05}, "rlmodule_inference_timer": 2.7950057351784083e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.330110221769136e-06, "normalize_and_clip_actions": 9.400233959262094e-06, "tensor_to_numpy": 1.3048335142864474e-05, "remove_single_ts_time_rank_from_batch": 5.757210811003647e-07, "get_actions": 3.922700817662941e-05, "listify_data_for_vector_env": 1.0847194220952739e-05}}, "connector_pipeline_timer": 0.00010371033581925548}, "time_between_sampling": 0.0016702341209754205, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3514512411567194e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_max": 14.5, "weights_seq_no": 12.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.004530594332609326, "sample": 0.004831545479186932, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -339125.0, "episode_return_mean": 9.460000000000004, "env_reset_timer": 3.119708855069171e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "num_env_steps_sampled_lifetime_throughput": 3758.3623553449765}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.5831597639107542e-05, "batch_individual_items": 0.04814447945115527, "add_states_from_episodes_to_batch": 4.032162582817326e-06, "add_one_ts_to_episodes_and_truncate": 0.011198504927354401, "general_advantage_estimation": 0.010694237716566047, "numpy_to_tensor": 8.367029369101304e-05, "add_observations_from_episodes_to_batch": 0.000832723043133259, "add_columns_from_episodes_to_train_batch": 0.049144442155308395}}, "connector_pipeline_timer": 0.12034944405071926}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 78000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1547063.1498706173, "num_module_steps_trained_throughput": 295561.6291840177, "num_module_steps_trained_lifetime_throughput": 295175.5795611539}, "default_policy": {"vf_loss": 0.10056453198194504, "total_loss": 0.00666135223582387, "vf_loss_unclipped": 36.1948127746582, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.05494841933250427, "num_module_steps_trained_lifetime": 78000, "entropy": 0.6236662864685059, "mean_kl_loss": 0.00024740456137806177, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.024964654818177223, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 13.0, "curr_kl_coeff": 9.112503903452307e-05, "vf_explained_var": 0.004157304763793945, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 295772.0806316984}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.02313268901372e-06, "add_observations_from_episodes_to_batch": 2.88618948595127e-06, "add_time_dim_to_batch_and_zero_pad": 2.547549153748605e-06, "batch_individual_items": 6.449467796502898e-06, "add_states_from_episodes_to_batch": 1.6571734285525613e-06}}, "connector_pipeline_timer": 4.449015394026603e-05}, "episode_return_max": 15.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.4979650170676822e-05, "tensor_to_numpy": 1.388678837057777e-05, "remove_single_ts_time_rank_from_batch": 6.02371407351263e-07, "normalize_and_clip_actions": 9.561054892629152e-06, "get_actions": 4.142564156030982e-05, "un_batch_to_individual_items": 5.641058093922781e-06}}, "connector_pipeline_timer": 0.00011190264950009917}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 260, "episode_len_max": 20, "env_step_timer": 1.5008683247134232e-05, "rlmodule_inference_timer": 2.9233578968049822e-05, "num_env_steps_sampled": 400, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.12872081002482422, "agent_episode_returns_mean": {"default_agent": 2.7}, "episode_return_mean": 2.7, "env_reset_timer": 0.0001676399035186964, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_duration_sec_mean": 0.004741967887384817, "module_episode_returns_mean": {"default_policy": 2.7}, "num_env_steps_sampled_lifetime": 65400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.415004405933342}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-50", "timestamp": 1754933750, "time_this_iter_s": 1.6758761405944824, "time_total_s": 30.005263328552246, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.005263328552246, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.099999999999994, "ram_util_percent": 74.65}}
{"timers": {"training_iteration": 2.628145200723746, "restore_env_runners": 1.1178374551110208e-05, "training_step": 2.6279675361404773, "env_runner_sampling_timer": 2.4098402660396836, "learner_update_timer": 0.2142009748628764, "synch_weights": 0.0009042719581973757, "restore_eval_env_runners": 1.0305145089126832e-05, "evaluation_iteration": 0.13589291457176883, "synch_eval_env_connectors": 0.00014545539038340665, "synch_env_connectors": 4.833004397692639e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7551059615284036e-06, "numpy_to_tensor": 8.965971456006212e-06, "add_observations_from_episodes_to_batch": 3.0333039145475914e-06, "add_time_dim_to_batch_and_zero_pad": 2.4554475334314216e-06, "batch_individual_items": 6.581778280525234e-06}}, "connector_pipeline_timer": 4.4829893335882496e-05}, "rlmodule_inference_timer": 2.988565947031785e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.520943140814756e-06, "normalize_and_clip_actions": 9.808911923109405e-06, "tensor_to_numpy": 1.3650815173270326e-05, "remove_single_ts_time_rank_from_batch": 6.003660732259643e-07, "get_actions": 4.187522863491315e-05, "listify_data_for_vector_env": 1.1418287979055719e-05}}, "connector_pipeline_timer": 0.00010892043229721144}, "time_between_sampling": 0.0017410742590349992, "agent_episode_returns_mean": {"default_agent": 11.859999999999996}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.4301816582887067e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_max": 14.5, "weights_seq_no": 13.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.004757305340375752, "sample": 0.005043349625632868, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -370000.0, "episode_return_mean": 11.859999999999996, "env_reset_timer": 3.7443404570839266e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 11.859999999999996}, "num_env_steps_sampled_lifetime_throughput": 3566.670449049474}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.5749942316292722e-05, "batch_individual_items": 0.04891849882630617, "add_states_from_episodes_to_batch": 4.018920324999316e-06, "add_one_ts_to_episodes_and_truncate": 0.011161205719181147, "general_advantage_estimation": 0.010646380759034743, "numpy_to_tensor": 8.35877606410347e-05, "add_observations_from_episodes_to_batch": 0.0008322908122823842, "add_columns_from_episodes_to_train_batch": 0.04898552773376954}}, "connector_pipeline_timer": 0.12087746335932165}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 84000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1566774.5693597605, "num_module_steps_trained_throughput": 299283.54231534293, "num_module_steps_trained_lifetime_throughput": 298906.39613560494}, "default_policy": {"vf_loss": 0.1025959849357605, "total_loss": -0.26746711134910583, "vf_loss_unclipped": 40.3286018371582, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.3303236663341522, "num_module_steps_trained_lifetime": 84000, "entropy": 0.6360170841217041, "mean_kl_loss": 0.0002494497748557478, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.03703908249735832, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 14.0, "curr_kl_coeff": 4.5562519517261535e-05, "vf_explained_var": -0.01017308235168457, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 299441.58595198276}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.301087294785303e-06, "add_observations_from_episodes_to_batch": 2.8039619494219644e-06, "add_time_dim_to_batch_and_zero_pad": 2.307728075398713e-06, "batch_individual_items": 6.145294238661116e-06, "add_states_from_episodes_to_batch": 1.6033195794216085e-06}}, "connector_pipeline_timer": 4.262347632683117e-05}, "episode_return_max": 15.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1160162217101705e-05, "tensor_to_numpy": 1.314929243944287e-05, "remove_single_ts_time_rank_from_batch": 5.933498805120612e-07, "normalize_and_clip_actions": 9.524281529292777e-06, "get_actions": 3.731000055445401e-05, "un_batch_to_individual_items": 5.436642916140379e-06}}, "connector_pipeline_timer": 0.00010251676063492244}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "num_episodes_lifetime": 280, "episode_len_max": 20, "env_step_timer": 1.4135306564846153e-05, "rlmodule_inference_timer": 2.771856540135699e-05, "num_env_steps_sampled": 400, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.1284608702553754, "agent_episode_returns_mean": {"default_agent": 2.3}, "episode_return_mean": 2.3, "env_reset_timer": 0.00016703017500374056, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_duration_sec_mean": 0.004572789114899933, "module_episode_returns_mean": {"default_policy": 2.3}, "num_env_steps_sampled_lifetime": 70400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.407363118123686}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-51", "timestamp": 1754933751, "time_this_iter_s": 1.7441260814666748, "time_total_s": 31.74938941001892, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.74938941001892, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 37.800000000000004, "ram_util_percent": 74.56666666666668}}
{"timers": {"training_iteration": 2.620481059546668, "restore_env_runners": 1.1122001006329073e-05, "training_step": 2.620303604119997, "env_runner_sampling_timer": 2.402135517129706, "learner_update_timer": 0.2142473555342989, "synch_weights": 0.0009024850784978205, "restore_eval_env_runners": 1.0266253614554042e-05, "evaluation_iteration": 0.135614365845786, "synch_eval_env_connectors": 0.00014516708633778805, "synch_env_connectors": 4.823834139671857e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.931150530786625e-06, "numpy_to_tensor": 1.0011241447929995e-05, "add_observations_from_episodes_to_batch": 3.4738342519305296e-06, "add_time_dim_to_batch_and_zero_pad": 2.8078671419754156e-06, "batch_individual_items": 7.4348990435610405e-06}}, "connector_pipeline_timer": 4.944938430299746e-05}, "rlmodule_inference_timer": 3.650670531390874e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.977212074525e-06, "normalize_and_clip_actions": 1.0972102713188059e-05, "tensor_to_numpy": 1.5464219558057627e-05, "remove_single_ts_time_rank_from_batch": 7.355675918187903e-07, "get_actions": 5.001388475045945e-05, "listify_data_for_vector_env": 1.3074276138741183e-05}}, "connector_pipeline_timer": 0.00012530687643712656}, "time_between_sampling": 0.0019200512470040963, "agent_episode_returns_mean": {"default_agent": 10.5}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.691569357570881e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_max": 14.5, "weights_seq_no": 14.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005474737968761476, "sample": 0.005317405866404837, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -400875.0, "episode_return_mean": 10.5, "env_reset_timer": 3.755111683278893e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 10.5}, "num_env_steps_sampled_lifetime_throughput": 3482.5605620190927}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.574619260866663e-05, "batch_individual_items": 0.04992119633874748, "add_states_from_episodes_to_batch": 4.016651084528011e-06, "add_one_ts_to_episodes_and_truncate": 0.01112543157239749, "general_advantage_estimation": 0.01059359028097468, "numpy_to_tensor": 8.339147230520119e-05, "add_observations_from_episodes_to_batch": 0.0008323741544315065, "add_columns_from_episodes_to_train_batch": 0.04891111453597032}}, "connector_pipeline_timer": 0.12171583539508458}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 90000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1588908.803683979, "num_module_steps_trained_throughput": 303465.85912863555, "num_module_steps_trained_lifetime_throughput": 303098.5622329193}, "default_policy": {"vf_loss": 0.10167106240987778, "total_loss": -0.16265712678432465, "vf_loss_unclipped": 38.51253128051758, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.22504158318042755, "num_module_steps_trained_lifetime": 90000, "entropy": 0.6198380589485168, "mean_kl_loss": 0.00010712061339290813, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.04398268088698387, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 15.0, "curr_kl_coeff": 2.2781259758630767e-05, "vf_explained_var": 0.0007898807525634766, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 303572.0217510998}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.190449348130495e-06, "add_observations_from_episodes_to_batch": 2.7622313959214093e-06, "add_time_dim_to_batch_and_zero_pad": 2.275167507195774e-06, "batch_individual_items": 6.030135186131149e-06, "add_states_from_episodes_to_batch": 1.5807665469242916e-06}}, "connector_pipeline_timer": 4.193931067127624e-05}, "episode_return_max": 15.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.086280858154314e-05, "tensor_to_numpy": 1.3112258462546529e-05, "remove_single_ts_time_rank_from_batch": 5.687388928346126e-07, "normalize_and_clip_actions": 9.28600353516638e-06, "get_actions": 3.695760344257342e-05, "un_batch_to_individual_items": 5.323645252858168e-06}}, "connector_pipeline_timer": 0.00010126647420106706}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "num_episodes_lifetime": 300, "episode_len_max": 20, "env_step_timer": 1.3798574330767202e-05, "rlmodule_inference_timer": 2.906672708545226e-05, "num_env_steps_sampled": 400, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.12814565780267845, "agent_episode_returns_mean": {"default_agent": 1.7}, "episode_return_mean": 1.7, "env_reset_timer": 0.00016649529284223918, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_duration_sec_mean": 0.004583194962469861, "module_episode_returns_mean": {"default_policy": 1.7}, "num_env_steps_sampled_lifetime": 75400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.4020756865230943}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-53", "timestamp": 1754933753, "time_this_iter_s": 1.9664747714996338, "time_total_s": 33.715864181518555, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.715864181518555, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 46.6, "ram_util_percent": 76.96666666666667}}
{"timers": {"training_iteration": 2.609338343121336, "restore_env_runners": 1.1064531114506497e-05, "training_step": 2.609161045999139, "env_runner_sampling_timer": 2.392250939458798, "learner_update_timer": 0.21299700364972357, "synch_weights": 0.0008992402274867917, "restore_eval_env_runners": 1.0230260969065568e-05, "evaluation_iteration": 0.13528179593702686, "synch_eval_env_connectors": 0.00014498124583476314, "synch_env_connectors": 4.81601519801345e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7653793166035948e-06, "numpy_to_tensor": 8.851391131317144e-06, "add_observations_from_episodes_to_batch": 3.0627966471132707e-06, "add_time_dim_to_batch_and_zero_pad": 2.4575318678186475e-06, "batch_individual_items": 6.467332052393193e-06}}, "connector_pipeline_timer": 4.446221060059071e-05}, "rlmodule_inference_timer": 2.9248648113025536e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.462479604066095e-06, "normalize_and_clip_actions": 9.6296390392818e-06, "tensor_to_numpy": 1.3420672275580531e-05, "remove_single_ts_time_rank_from_batch": 5.917906504035169e-07, "get_actions": 4.13809737863525e-05, "listify_data_for_vector_env": 1.1198904419141145e-05}}, "connector_pipeline_timer": 0.0001075501992888832}, "time_between_sampling": 0.002038614750511768, "agent_episode_returns_mean": {"default_agent": 11.700000000000003}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3951692384331568e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_max": 14.5, "weights_seq_no": 15.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.004682188034057616, "sample": 0.005494073675432225, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -431750.0, "episode_return_mean": 11.700000000000003, "env_reset_timer": 3.950271493054104e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 11.700000000000003}, "num_env_steps_sampled_lifetime_throughput": 3621.2904952119497}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.567790132663974e-05, "batch_individual_items": 0.049718551874531954, "add_states_from_episodes_to_batch": 4.002733900448268e-06, "add_one_ts_to_episodes_and_truncate": 0.011089971836134733, "general_advantage_estimation": 0.010539086878059805, "numpy_to_tensor": 8.303839826326994e-05, "add_observations_from_episodes_to_batch": 0.0008317087529240605, "add_columns_from_episodes_to_train_batch": 0.04875534172041195}}, "connector_pipeline_timer": 0.12126485037103654}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 96000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1615578.4298024222, "num_module_steps_trained_throughput": 308515.96886802657, "num_module_steps_trained_lifetime_throughput": 308157.90568741516}, "default_policy": {"vf_loss": 0.10140769928693771, "total_loss": 0.07125132530927658, "vf_loss_unclipped": 37.72899627685547, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.00893791951239109, "num_module_steps_trained_lifetime": 96000, "entropy": 0.6082354187965393, "mean_kl_loss": 0.0001255715760635212, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.12816815078258514, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 16.0, "curr_kl_coeff": 1.1390629879315384e-05, "vf_explained_var": 0.003667175769805908, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 308574.7996672203}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.24661868623628e-06, "add_observations_from_episodes_to_batch": 2.7688626585452988e-06, "add_time_dim_to_batch_and_zero_pad": 2.239413456163061e-06, "batch_individual_items": 6.062787853209054e-06, "add_states_from_episodes_to_batch": 1.5610781109843588e-06}}, "connector_pipeline_timer": 4.195080156946871e-05}, "episode_return_max": 15.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0809030741620567e-05, "tensor_to_numpy": 1.2954574367802423e-05, "remove_single_ts_time_rank_from_batch": 5.881071876516947e-07, "normalize_and_clip_actions": 9.184415040130692e-06, "get_actions": 3.633489179111242e-05, "un_batch_to_individual_items": 5.29960062975108e-06}}, "connector_pipeline_timer": 0.00010033098103043776}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "num_episodes_lifetime": 320, "episode_len_max": 20, "env_step_timer": 1.3681393504429513e-05, "rlmodule_inference_timer": 2.669973547660874e-05, "num_env_steps_sampled": 400, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.1278377245653053, "agent_episode_returns_mean": {"default_agent": 1.3}, "episode_return_mean": 1.3, "env_reset_timer": 0.0001655853398419932, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_duration_sec_mean": 0.0045930370315909385, "module_episode_returns_mean": {"default_policy": 1.3}, "num_env_steps_sampled_lifetime": 80400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.3932884100782923}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-55", "timestamp": 1754933755, "time_this_iter_s": 1.6105377674102783, "time_total_s": 35.32640194892883, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.32640194892883, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.35, "ram_util_percent": 75.4}}
{"timers": {"training_iteration": 2.5986987280207487, "restore_env_runners": 1.1000975801040427e-05, "training_step": 2.5985215521994554, "env_runner_sampling_timer": 2.382817653393793, "learner_update_timer": 0.21179378736376292, "synch_weights": 0.000896248654374, "restore_eval_env_runners": 1.0192127648919138e-05, "evaluation_iteration": 0.13494860672874825, "synch_eval_env_connectors": 0.00014443185350385203, "synch_env_connectors": 4.808684227704458e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7092574168070799e-06, "numpy_to_tensor": 8.434345842276938e-06, "add_observations_from_episodes_to_batch": 3.01088287067537e-06, "add_time_dim_to_batch_and_zero_pad": 2.3832058391355295e-06, "batch_individual_items": 6.243630308170524e-06}}, "connector_pipeline_timer": 4.314463806440061e-05}, "rlmodule_inference_timer": 4.439479511675936e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.323910697285905e-06, "normalize_and_clip_actions": 9.361002748599766e-06, "tensor_to_numpy": 1.2942749239376867e-05, "remove_single_ts_time_rank_from_batch": 5.770871409832997e-07, "get_actions": 3.869895145360429e-05, "listify_data_for_vector_env": 1.0883632456235789e-05}}, "connector_pipeline_timer": 0.0001030490718475244}, "time_between_sampling": 0.0014964035806297406, "agent_episode_returns_mean": {"default_agent": 11.380000000000003}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3505244415896451e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_max": 14.5, "weights_seq_no": 16.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.004873928362969307, "sample": 0.0051316328185274296, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -462625.0, "episode_return_mean": 11.380000000000003, "env_reset_timer": 3.2063904605564244e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 11.380000000000003}, "num_env_steps_sampled_lifetime_throughput": 3758.4349017944633}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.5607781878941313e-05, "batch_individual_items": 0.049517960105449496, "add_states_from_episodes_to_batch": 3.991036230010369e-06, "add_one_ts_to_episodes_and_truncate": 0.011053413368356916, "general_advantage_estimation": 0.010485458509358555, "numpy_to_tensor": 8.270634403555606e-05, "add_observations_from_episodes_to_batch": 0.0008336366654070388, "add_columns_from_episodes_to_train_batch": 0.048599186633371046}}, "connector_pipeline_timer": 0.12081796144669785}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 102000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1636994.454662633, "num_module_steps_trained_throughput": 312565.52409638965, "num_module_steps_trained_lifetime_throughput": 312217.02177602454}, "default_policy": {"vf_loss": 0.10092901438474655, "total_loss": 0.113533154129982, "vf_loss_unclipped": 37.01144027709961, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.05141635611653328, "num_module_steps_trained_lifetime": 102000, "entropy": 0.5945951342582703, "mean_kl_loss": 0.00019485194934532046, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.0712444856762886, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 17.0, "curr_kl_coeff": 5.695314939657692e-06, "vf_explained_var": 0.004249453544616699, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 312579.1707226976}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.864258823702784e-06, "add_observations_from_episodes_to_batch": 3.008242990850366e-06, "add_time_dim_to_batch_and_zero_pad": 2.354544954812915e-06, "batch_individual_items": 6.4669649445186925e-06, "add_states_from_episodes_to_batch": 1.6454935053129372e-06}}, "connector_pipeline_timer": 4.4402304004796684e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1331150388998645e-05, "tensor_to_numpy": 1.3855570213411782e-05, "remove_single_ts_time_rank_from_batch": 6.035573204411883e-07, "normalize_and_clip_actions": 9.642743866324486e-06, "get_actions": 4.109125189530064e-05, "un_batch_to_individual_items": 5.6821783564619026e-06}}, "connector_pipeline_timer": 0.00010825458261129254}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "num_episodes_lifetime": 340, "episode_len_max": 20, "env_step_timer": 1.4663018859321497e-05, "rlmodule_inference_timer": 2.9851977870744576e-05, "num_env_steps_sampled": 400, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.1276739819000968, "agent_episode_returns_mean": {"default_agent": 1.5}, "episode_return_mean": 1.5, "env_reset_timer": 0.00016484698586287502, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_duration_sec_mean": 0.004714245797367766, "module_episode_returns_mean": {"default_policy": 1.5}, "num_env_steps_sampled_lifetime": 85400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.384973771807337}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-57", "timestamp": 1754933757, "time_this_iter_s": 1.6646721363067627, "time_total_s": 36.991074085235596, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.991074085235596, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 35.8, "ram_util_percent": 74.95}}
{"timers": {"training_iteration": 2.5922804165715014, "restore_env_runners": 1.0940136382510064e-05, "training_step": 2.5921034925073245, "env_runner_sampling_timer": 2.3764896981095025, "learner_update_timer": 0.21171058824078795, "synch_weights": 0.0008935294970926209, "restore_eval_env_runners": 1.0155625962530592e-05, "evaluation_iteration": 0.13476497066098542, "synch_eval_env_connectors": 0.00014409378437015938, "synch_env_connectors": 4.798097088894305e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0207757426105275e-06, "numpy_to_tensor": 1.1007984301539531e-05, "add_observations_from_episodes_to_batch": 3.5081444488840307e-06, "add_time_dim_to_batch_and_zero_pad": 2.8612231192864716e-06, "batch_individual_items": 7.74095880564113e-06}}, "connector_pipeline_timer": 5.647101536880608e-05}, "rlmodule_inference_timer": 3.589849630172394e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.325352087366775e-06, "normalize_and_clip_actions": 1.1808275075423522e-05, "tensor_to_numpy": 1.6178265315715998e-05, "remove_single_ts_time_rank_from_batch": 7.760179292343283e-07, "get_actions": 5.509139978974977e-05, "listify_data_for_vector_env": 1.3315109357763127e-05}}, "connector_pipeline_timer": 0.00013383659459061378}, "time_between_sampling": 0.0015855259747294891, "agent_episode_returns_mean": {"default_agent": 12.420000000000002}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.7030174730015312e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_max": 14.5, "weights_seq_no": 17.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005853529809042814, "sample": 0.005812566770107018, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -493500.0, "episode_return_mean": 12.420000000000002, "env_reset_timer": 4.55145918999235e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 12.420000000000002}, "num_env_steps_sampled_lifetime_throughput": 3241.4564016625563}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.555211343938085e-05, "batch_individual_items": 0.05037693425439366, "add_states_from_episodes_to_batch": 3.981965450615439e-06, "add_one_ts_to_episodes_and_truncate": 0.011021799644688034, "general_advantage_estimation": 0.010434038084337325, "numpy_to_tensor": 8.256012047091349e-05, "add_observations_from_episodes_to_batch": 0.0008335319691158433, "add_columns_from_episodes_to_train_batch": 0.048494411436958165}}, "connector_pipeline_timer": 0.12148761558256264}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1656291.5317433449, "num_module_steps_trained_throughput": 316224.14237760194, "num_module_steps_trained_lifetime_throughput": 315880.2900465609}, "default_policy": {"vf_loss": 0.10222505033016205, "total_loss": -0.1346408873796463, "vf_loss_unclipped": 39.726741790771484, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.19750188291072845, "num_module_steps_trained_lifetime": 108000, "entropy": 0.6081311106681824, "mean_kl_loss": 0.0001815491123124957, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.019866973161697388, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 18.0, "curr_kl_coeff": 2.847657469828846e-06, "vf_explained_var": -0.004913330078125, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 316199.578376306}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0530440555961714e-05, "add_observations_from_episodes_to_batch": 3.301834997558054e-06, "add_time_dim_to_batch_and_zero_pad": 3.0396678622285824e-06, "batch_individual_items": 7.63672665163466e-06, "add_states_from_episodes_to_batch": 1.7339258596615043e-06}}, "connector_pipeline_timer": 5.156904838137028e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.3680037937097446e-05, "tensor_to_numpy": 1.6009773169515687e-05, "remove_single_ts_time_rank_from_batch": 6.555339472872429e-07, "normalize_and_clip_actions": 1.1063473470924955e-05, "get_actions": 4.907930662829975e-05, "un_batch_to_individual_items": 6.0634054998327655e-06}}, "connector_pipeline_timer": 0.00012709237751392294}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 360, "episode_len_max": 20, "env_step_timer": 1.87507422239794e-05, "rlmodule_inference_timer": 3.626228905873631e-05, "num_env_steps_sampled": 400, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.12757971249122674, "agent_episode_returns_mean": {"default_agent": 2.1}, "episode_return_mean": 2.1, "env_reset_timer": 0.00016398726589837354, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_duration_sec_mean": 0.004835029521491379, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled_lifetime": 90400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.380863481169328}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "468f1_00000", "date": "2025-08-11_19-35-59", "timestamp": 1754933759, "time_this_iter_s": 2.083988904953003, "time_total_s": 39.0750629901886, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.0750629901886, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 51.96666666666667, "ram_util_percent": 77.33333333333333}}
{"timers": {"training_iteration": 2.584947641576523, "restore_env_runners": 1.0901984688102703e-05, "training_step": 2.5847704825817317, "env_runner_sampling_timer": 2.3693021427978795, "learner_update_timer": 0.21156511902902167, "synch_weights": 0.0008923296114299196, "restore_eval_env_runners": 1.011532046033131e-05, "evaluation_iteration": 0.13466293970448395, "synch_eval_env_connectors": 0.00014356242621141565, "synch_env_connectors": 4.791776505074349e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.91741386862546e-06, "numpy_to_tensor": 1.0415992443924377e-05, "add_observations_from_episodes_to_batch": 3.378824447202498e-06, "add_time_dim_to_batch_and_zero_pad": 2.7683617658014873e-06, "batch_individual_items": 7.5469258592110175e-06}}, "connector_pipeline_timer": 5.029136028587722e-05}, "rlmodule_inference_timer": 3.534089806868851e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.0875597064419455e-06, "normalize_and_clip_actions": 1.0940012047496476e-05, "tensor_to_numpy": 1.5733306780633093e-05, "remove_single_ts_time_rank_from_batch": 6.53706100078963e-07, "get_actions": 4.934427974195562e-05, "listify_data_for_vector_env": 1.306288156690848e-05}}, "connector_pipeline_timer": 0.0001246493599215396}, "time_between_sampling": 0.0021201298985130527, "agent_episode_returns_mean": {"default_agent": 11.940000000000003}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.6710042452393872e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_max": 14.5, "weights_seq_no": 18.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005453715977258979, "sample": 0.005951331524556, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -524375.0, "episode_return_mean": 11.940000000000003, "env_reset_timer": 5.0433054504384055e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 11.940000000000003}, "num_env_steps_sampled_lifetime_throughput": 3256.2698435019415}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.549201212352249e-05, "batch_individual_items": 0.05114879616289615, "add_states_from_episodes_to_batch": 3.970895723987664e-06, "add_one_ts_to_episodes_and_truncate": 0.010987063318451291, "general_advantage_estimation": 0.010385224373096792, "numpy_to_tensor": 8.243659911738466e-05, "add_observations_from_episodes_to_batch": 0.0008331887289061674, "add_columns_from_episodes_to_train_batch": 0.048343326073116304}}, "connector_pipeline_timer": 0.12202313359667669}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 114000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1664933.648334581, "num_module_steps_trained_throughput": 317848.4737617484, "num_module_steps_trained_lifetime_throughput": 317511.27855350025}, "default_policy": {"vf_loss": 0.10185413807630539, "total_loss": -0.05254727974534035, "vf_loss_unclipped": 38.91197967529297, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.11524400860071182, "num_module_steps_trained_lifetime": 114000, "entropy": 0.5988801717758179, "mean_kl_loss": 4.5508480980060995e-05, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.04448277875781059, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 19.0, "curr_kl_coeff": 1.423828734914423e-06, "vf_explained_var": 0.0010715723037719727, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 317796.77407960186}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1056282489469846e-05, "add_observations_from_episodes_to_batch": 3.3465786377779246e-06, "add_time_dim_to_batch_and_zero_pad": 2.7677038659267232e-06, "batch_individual_items": 7.291308730939459e-06, "add_states_from_episodes_to_batch": 1.7895211865994128e-06}}, "connector_pipeline_timer": 5.121193730884709e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.3428560642687407e-05, "tensor_to_numpy": 1.6574418678062272e-05, "remove_single_ts_time_rank_from_batch": 6.665799506280665e-07, "normalize_and_clip_actions": 1.1156539524584603e-05, "get_actions": 5.01402094393699e-05, "un_batch_to_individual_items": 6.817971434612945e-06}}, "connector_pipeline_timer": 0.00012897415503345048}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 380, "episode_len_max": 20, "env_step_timer": 1.7285378318407076e-05, "rlmodule_inference_timer": 3.39476996511094e-05, "num_env_steps_sampled": 400, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.1275750370370393, "agent_episode_returns_mean": {"default_agent": 2.5}, "episode_return_mean": 2.5, "env_reset_timer": 0.0001632553128418584, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_duration_sec_mean": 0.005051236625295132, "module_episode_returns_mean": {"default_policy": 2.5}, "num_env_steps_sampled_lifetime": 95400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.3758985838571904}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "468f1_00000", "date": "2025-08-11_19-36-01", "timestamp": 1754933761, "time_this_iter_s": 1.994636058807373, "time_total_s": 41.06969904899597, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.06969904899597, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 42.70000000000001, "ram_util_percent": 76.73333333333333}}
{"timers": {"training_iteration": 2.577124913080843, "restore_env_runners": 1.084671495946239e-05, "training_step": 2.576946899836447, "env_runner_sampling_timer": 2.36269363969984, "learner_update_timer": 0.21035731075842756, "synch_weights": 0.0008896975646169049, "restore_eval_env_runners": 1.0088747567503204e-05, "evaluation_iteration": 0.13464399697814108, "synch_eval_env_connectors": 0.00014346014155478193, "synch_env_connectors": 4.7834387852915456e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.955142211363388e-06, "numpy_to_tensor": 1.0543764588224428e-05, "add_observations_from_episodes_to_batch": 3.426716909755606e-06, "add_time_dim_to_batch_and_zero_pad": 2.964753255728302e-06, "batch_individual_items": 7.692465613002549e-06}}, "connector_pipeline_timer": 5.163728390679301e-05}, "rlmodule_inference_timer": 3.425586214422828e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.294334753808597e-06, "normalize_and_clip_actions": 1.1325259396084288e-05, "tensor_to_numpy": 1.5949186889541978e-05, "remove_single_ts_time_rank_from_batch": 6.75041105182054e-07, "get_actions": 4.98792113965622e-05, "listify_data_for_vector_env": 1.3092912340565401e-05}}, "connector_pipeline_timer": 0.00012915645564457557}, "time_between_sampling": 0.002153443991731277, "agent_episode_returns_mean": {"default_agent": 12.5}, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.7169708880029998e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_max": 14.5, "weights_seq_no": 19.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005651499368716032, "sample": 0.005835149162753466, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -555250.0, "episode_return_mean": 12.5, "env_reset_timer": 4.849159344111409e-05, "num_episodes": 250.0, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 12.5}, "num_env_steps_sampled_lifetime_throughput": 3230.106931554771}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.544168185572302e-05, "batch_individual_items": 0.050937304030385606, "add_states_from_episodes_to_batch": 3.9607667358707935e-06, "add_one_ts_to_episodes_and_truncate": 0.010958122265411362, "general_advantage_estimation": 0.010332870878892042, "numpy_to_tensor": 8.235057285768057e-05, "add_observations_from_episodes_to_batch": 0.0008330930905945881, "add_columns_from_episodes_to_train_batch": 0.04818918448157134}}, "connector_pipeline_timer": 0.12157479268071092}, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained_lifetime": 120000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1679062.5268852795, "num_module_steps_trained_throughput": 320517.44309359905, "num_module_steps_trained_lifetime_throughput": 320187.301850783}, "default_policy": {"vf_loss": 0.10185357928276062, "total_loss": 0.01072325836867094, "vf_loss_unclipped": 38.9202995300293, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.05196285992860794, "num_module_steps_trained_lifetime": 120000, "entropy": 0.6000101566314697, "mean_kl_loss": 8.406594133703038e-05, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.03812684118747711, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 20.0, "curr_kl_coeff": 7.119143674572115e-07, "vf_explained_var": 0.0011566877365112305, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 320433.1515224941}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.05206227141496e-06, "add_observations_from_episodes_to_batch": 3.069141133385467e-06, "add_time_dim_to_batch_and_zero_pad": 2.4362355993456484e-06, "batch_individual_items": 6.508124192697755e-06, "add_states_from_episodes_to_batch": 1.6166112512293475e-06}}, "connector_pipeline_timer": 4.4886553593534725e-05}, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.183116025417029e-05, "tensor_to_numpy": 1.4071902551071958e-05, "remove_single_ts_time_rank_from_batch": 6.300790491676081e-07, "normalize_and_clip_actions": 9.971523014397484e-06, "get_actions": 4.0377879726157755e-05, "un_batch_to_individual_items": 5.691897337936844e-06}}, "connector_pipeline_timer": 0.0001093158439045224}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "num_episodes_lifetime": 400, "episode_len_max": 20, "env_step_timer": 1.550835124622433e-05, "rlmodule_inference_timer": 3.008086946123183e-05, "num_env_steps_sampled": 400, "weights_seq_no": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "sample": 0.12737437708686847, "agent_episode_returns_mean": {"default_agent": 2.9}, "episode_return_mean": 2.9, "env_reset_timer": 0.00016247692919766772, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_duration_sec_mean": 0.005145509127760306, "module_episode_returns_mean": {"default_policy": 2.9}, "num_env_steps_sampled_lifetime": 100400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "time_between_sampling": 2.370351334677905}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "468f1_00000", "date": "2025-08-11_19-36-03", "timestamp": 1754933763, "time_this_iter_s": 1.9177610874176025, "time_total_s": 42.987460136413574, "pid": 27747, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x384eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.987460136413574, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.7, "ram_util_percent": 75.93333333333334}}
