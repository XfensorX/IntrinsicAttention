{"timers": {"training_iteration": 1.737494625034742, "restore_env_runners": 1.0041985660791397e-05, "training_step": 1.7373376250034198, "env_runner_sampling_timer": 1.6279873750172555, "learner_update_timer": 0.10608737508300692, "synch_weights": 0.0005817499477416277}, "env_runners": {"env_step_timer": 1.6996242960018926e-05, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8388806559240057e-06, "numpy_to_tensor": 1.1330467564909985e-05, "batch_individual_items": 7.132547369292067e-06, "add_observations_from_episodes_to_batch": 3.372212872218467e-06, "add_time_dim_to_batch_and_zero_pad": 2.687012038553538e-06}}, "connector_pipeline_timer": 5.120346974503254e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5112083298363965e-05, "normalize_and_clip_actions": 1.5505166209989966e-05, "listify_data_for_vector_env": 1.2424815790702255e-05, "remove_single_ts_time_rank_from_batch": 6.57461258167518e-07, "get_actions": 4.925422586195891e-05, "un_batch_to_individual_items": 5.989951643821069e-06}}, "connector_pipeline_timer": 0.00012906071613982877}, "env_reset_timer": 9.416926679187291e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "time_between_sampling": 0.0007021408053888196, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_mean": 0.8199999999999998, "env_to_module_sum_episodes_length_out": 10.191744832559449, "rlmodule_inference_timer": 5.328889088863601e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_max": 20, "weights_seq_no": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "sample": 0.007163987061914133, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.005397617662325501, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime_throughput": 3176.7281690818854}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000807874952442944, "add_time_dim_to_batch_and_zero_pad": 1.4249933883547783e-05, "add_columns_from_episodes_to_train_batch": 0.03460929205175489, "numpy_to_tensor": 7.24999699741602e-05, "general_advantage_estimation": 0.007066291989758611, "batch_individual_items": 0.03030270803719759, "add_one_ts_to_episodes_and_truncate": 0.00747733295429498, "add_states_from_episodes_to_batch": 1.4959019608795643e-05}}, "connector_pipeline_timer": 0.08050079201348126}, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2461655.9389287187, "num_module_steps_trained_throughput": 471870.13487558893, "num_module_steps_trained_lifetime_throughput": 470725.0604308559}, "default_policy": {"total_loss": -0.2051759511232376, "curr_kl_coeff": 0.3732481598854065, "gradients_default_optimizer_global_norm": 0.07857398688793182, "vf_loss_unclipped": 28.039243698120117, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009175658226013184, "num_module_steps_trained": 6000, "entropy": 0.6600642800331116, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.2681262493133545, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 6000, "mean_kl_loss": 0.00025177394854836166, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 473339.4959554657}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 400}, "rlmodule_inference_timer": 2.9897327634026817e-05, "weights_seq_no": 1.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0963864110996698e-05, "get_actions": 4.080850462297646e-05, "remove_single_ts_time_rank_from_batch": 5.985475053810829e-07, "tensor_to_numpy": 1.4780593820679846e-05, "listify_data_for_vector_env": 1.1100513778080715e-05, "un_batch_to_individual_items": 5.542934766927166e-06}}, "connector_pipeline_timer": 0.00010971959806134548}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00019383407197892666, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.376256442326861e-06, "add_observations_from_episodes_to_batch": 2.932001508016695e-06, "add_time_dim_to_batch_and_zero_pad": 2.3103644665971125e-06, "add_states_from_episodes_to_batch": 1.6017318501157189e-06, "numpy_to_tensor": 8.431450405820914e-06}}, "connector_pipeline_timer": 4.477571335256407e-05}, "episode_return_mean": -3.2, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.0046221791591960935, "num_episodes_lifetime": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_env_steps_sampled_lifetime": 5400, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_len_max": 20, "sample": 0.10117312509100884, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -3.2}, "episode_return_min": -12.5, "env_step_timer": 1.4693638731409043e-05, "module_episode_returns_mean": {"default_policy": -3.2}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-19", "timestamp": 1754933059, "time_this_iter_s": 1.8476600646972656, "time_total_s": 1.8476600646972656, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.8476600646972656, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.9, "ram_util_percent": 77.5}}
{"timers": {"training_iteration": 1.7363016800349578, "restore_env_runners": 1.0005736257880926e-05, "training_step": 1.736144439583877, "env_runner_sampling_timer": 1.6260411866777575, "learner_update_timer": 0.10684272883227094, "synch_weights": 0.0005811582785099744, "restore_eval_env_runners": 7.875030860304832e-06, "evaluation_iteration": 0.10843804094474763, "synch_eval_env_connectors": 0.00013220799155533314, "synch_env_connectors": 4.749977961182594e-06}, "env_runners": {"env_step_timer": 1.4390136981932573e-05, "agent_episode_returns_mean": {"default_agent": 1.2200000000000002}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7676356118215713e-06, "numpy_to_tensor": 8.971529824964432e-06, "batch_individual_items": 6.4645392116727955e-06, "add_observations_from_episodes_to_batch": 3.0188634975778917e-06, "add_time_dim_to_batch_and_zero_pad": 2.442158717870468e-06}}, "connector_pipeline_timer": 4.474332225991133e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3515366426375221e-05, "normalize_and_clip_actions": 9.720738500356132e-06, "listify_data_for_vector_env": 1.1397407595735144e-05, "remove_single_ts_time_rank_from_batch": 6.000016396280981e-07, "get_actions": 4.005547676120469e-05, "un_batch_to_individual_items": 5.556323919940458e-06}}, "connector_pipeline_timer": 0.0001068464268117104}, "env_reset_timer": 4.9751116252507734e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.2200000000000002}, "time_between_sampling": 0.001583602623286149, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_mean": 1.2200000000000002, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.8975894550481646e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_max": 20, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "sample": 0.0055698017377790714, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.0046826645177789035, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime_throughput": 3593.338358660672}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008079424523748458, "add_time_dim_to_batch_and_zero_pad": 1.4245774364098907e-05, "add_columns_from_episodes_to_train_batch": 0.034603877471527086, "numpy_to_tensor": 7.242206018418074e-05, "general_advantage_estimation": 0.007048988649621606, "batch_individual_items": 0.031191043036524205, "add_one_ts_to_episodes_and_truncate": 0.007476162544917316, "add_states_from_episodes_to_batch": 1.4846099074929953e-05}}, "connector_pipeline_timer": 0.08136477076332085}, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2456222.2398978374, "num_module_steps_trained_throughput": 470797.7445730171, "num_module_steps_trained_lifetime_throughput": 469666.157562608}, "default_policy": {"total_loss": 0.05995207279920578, "curr_kl_coeff": 0.18662407994270325, "gradients_default_optimizer_global_norm": 0.04126502946019173, "vf_loss_unclipped": 28.439332962036133, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.012158751487731934, "num_module_steps_trained": 6000, "entropy": 0.6536862254142761, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.003029095707461238, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 12000, "mean_kl_loss": 0.0004314855032134801, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 472241.6109468891}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 800}, "rlmodule_inference_timer": 2.675643961097858e-05, "weights_seq_no": 2.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.35128110314445e-06, "get_actions": 3.574224214564694e-05, "remove_single_ts_time_rank_from_batch": 5.866395258699272e-07, "tensor_to_numpy": 1.2817270318396103e-05, "listify_data_for_vector_env": 1.088308165309808e-05, "un_batch_to_individual_items": 5.3491828003803684e-06}}, "connector_pipeline_timer": 0.00010010332908783623}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00019271490164101125, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.101765277441647e-06, "add_observations_from_episodes_to_batch": 2.7913924498713497e-06, "add_time_dim_to_batch_and_zero_pad": 2.178526722501275e-06, "add_states_from_episodes_to_batch": 1.5676745659951252e-06, "numpy_to_tensor": 8.326273900941835e-06}}, "connector_pipeline_timer": 4.220975126121749e-05}, "episode_return_mean": -0.7, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004538151100859977, "num_episodes_lifetime": 40, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_env_steps_sampled_lifetime": 10400, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_len_max": 20, "sample": 0.10113405717071146, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.7}, "episode_return_min": -12.5, "env_step_timer": 1.3975414703098773e-05, "module_episode_returns_mean": {"default_policy": -0.7}, "time_between_sampling": 1.6533141660038382}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-21", "timestamp": 1754933061, "time_this_iter_s": 1.7225110530853271, "time_total_s": 3.5701711177825928, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.5701711177825928, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.70000000000001, "ram_util_percent": 77.96666666666667}}
{"timers": {"training_iteration": 1.7338614082342478, "restore_env_runners": 9.977758605964482e-06, "training_step": 1.7337037631074315, "env_runner_sampling_timer": 1.6237501081504626, "learner_update_timer": 0.10669337821390945, "synch_weights": 0.0005808666958473622, "restore_eval_env_runners": 7.872950518503784e-06, "evaluation_iteration": 0.10837644970510156, "synch_eval_env_connectors": 0.00013192966114729642, "synch_env_connectors": 4.744977923110128e-06}, "env_runners": {"env_step_timer": 1.4016252483182171e-05, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7391085312383169e-06, "numpy_to_tensor": 8.68622940172368e-06, "batch_individual_items": 6.333279046668507e-06, "add_observations_from_episodes_to_batch": 2.98506441619919e-06, "add_time_dim_to_batch_and_zero_pad": 2.3861751816172395e-06}}, "connector_pipeline_timer": 4.385749191222987e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3199567577206046e-05, "normalize_and_clip_actions": 9.541827285611322e-06, "listify_data_for_vector_env": 1.1136397272446281e-05, "remove_single_ts_time_rank_from_batch": 5.872506742315177e-07, "get_actions": 3.8784954281170686e-05, "un_batch_to_individual_items": 5.497906543659272e-06}}, "connector_pipeline_timer": 0.00010430342549653617}, "env_reset_timer": 4.08295116616906e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "time_between_sampling": 0.0018504211269213847, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_mean": 1.0600000000000005, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.8172514931424202e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_max": 20, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "sample": 0.0050345675533903355, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004579860162921249, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime_throughput": 3667.4777319404457}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008084501072065906, "add_time_dim_to_batch_and_zero_pad": 1.4233317610342056e-05, "add_columns_from_episodes_to_train_batch": 0.034598254106112294, "numpy_to_tensor": 7.229408975690603e-05, "general_advantage_estimation": 0.007035190433450043, "batch_individual_items": 0.031175398026197218, "add_one_ts_to_episodes_and_truncate": 0.007482387579209172, "add_states_from_episodes_to_batch": 1.472805857192725e-05}}, "connector_pipeline_timer": 0.08133582722517896}, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2450223.884288373, "num_module_steps_trained_throughput": 469594.3908301833, "num_module_steps_trained_lifetime_throughput": 468483.97076814214}, "default_policy": {"total_loss": 0.10348828136920929, "curr_kl_coeff": 0.09331203997135162, "gradients_default_optimizer_global_norm": 0.039692364633083344, "vf_loss_unclipped": 28.58755874633789, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.012941598892211914, "num_module_steps_trained": 6000, "entropy": 0.6424447298049927, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.04044210910797119, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 18000, "mean_kl_loss": 0.0006657454650849104, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 470989.9786883493}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 1200}, "rlmodule_inference_timer": 2.8452046001525944e-05, "weights_seq_no": 3.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.630758091593919e-06, "get_actions": 3.8185555140142705e-05, "remove_single_ts_time_rank_from_batch": 6.090532108595837e-07, "tensor_to_numpy": 1.3424998448942304e-05, "listify_data_for_vector_env": 1.195045004352908e-05, "un_batch_to_individual_items": 5.601630323637458e-06}}, "connector_pipeline_timer": 0.00010539656761736059}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00019163400353863836, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.3736257385069046e-06, "add_observations_from_episodes_to_batch": 2.8902112706888083e-06, "add_time_dim_to_batch_and_zero_pad": 2.3082156788458137e-06, "add_states_from_episodes_to_batch": 1.5969493803565158e-06, "numpy_to_tensor": 8.732016743803083e-06}}, "connector_pipeline_timer": 4.3454650147130754e-05}, "episode_return_mean": -0.5333333333333333, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004577391645095001, "num_episodes_lifetime": 60, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_env_steps_sampled_lifetime": 15400, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_len_max": 20, "sample": 0.10114276867927983, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.5333333333333333}, "episode_return_min": -12.5, "env_step_timer": 1.4760550511609649e-05, "module_episode_returns_mean": {"default_policy": -0.5333333333333333}, "time_between_sampling": 1.6518723189237061}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-22", "timestamp": 1754933062, "time_this_iter_s": 1.6011810302734375, "time_total_s": 5.17135214805603, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.17135214805603, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.3, "ram_util_percent": 77.85}}
{"timers": {"training_iteration": 1.733072105401888, "restore_env_runners": 9.957981629064305e-06, "training_step": 1.7329141038059173, "env_runner_sampling_timer": 1.6231009812289554, "learner_update_timer": 0.10655358193260966, "synch_weights": 0.0005811692791478708, "restore_eval_env_runners": 7.882551138754933e-06, "evaluation_iteration": 0.10836102478872055, "synch_eval_env_connectors": 0.00013160036508925259, "synch_env_connectors": 4.7454481828026476e-06}, "env_runners": {"env_step_timer": 1.4797256508818998e-05, "agent_episode_returns_mean": {"default_agent": 0.7399999999999999}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.797467293107624e-06, "numpy_to_tensor": 9.211255275324437e-06, "batch_individual_items": 6.582056241178979e-06, "add_observations_from_episodes_to_batch": 3.156335783380258e-06, "add_time_dim_to_batch_and_zero_pad": 2.511154259778955e-06}}, "connector_pipeline_timer": 4.5665410386047116e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.384106495516381e-05, "normalize_and_clip_actions": 9.922757212757243e-06, "listify_data_for_vector_env": 1.157672331525908e-05, "remove_single_ts_time_rank_from_batch": 6.032499658186392e-07, "get_actions": 4.103867349746905e-05, "un_batch_to_individual_items": 5.6795332589238704e-06}}, "connector_pipeline_timer": 0.0001089969333128238}, "env_reset_timer": 4.503000518024987e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.7399999999999999}, "time_between_sampling": 0.001856140710984407, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_mean": 0.7399999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.9303768722461365e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_max": 20, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "sample": 0.005064275412541866, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004791156165767461, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime_throughput": 3515.2233921142283}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008087514359948692, "add_time_dim_to_batch_and_zero_pad": 1.4208073800778948e-05, "add_columns_from_episodes_to_train_batch": 0.03459984365515539, "numpy_to_tensor": 7.219780904427171e-05, "general_advantage_estimation": 0.007020746859366074, "batch_individual_items": 0.03116116654539411, "add_one_ts_to_episodes_and_truncate": 0.007487431622392732, "add_states_from_episodes_to_batch": 1.4624528028303757e-05}}, "connector_pipeline_timer": 0.08131361437286193}, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2444081.3385794647, "num_module_steps_trained_throughput": 468332.6830837311, "num_module_steps_trained_lifetime_throughput": 467249.95245568885}, "default_policy": {"total_loss": 0.13474135100841522, "curr_kl_coeff": 0.04665601998567581, "gradients_default_optimizer_global_norm": 0.0398266464471817, "vf_loss_unclipped": 28.65396499633789, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.013248324394226074, "num_module_steps_trained": 6000, "entropy": 0.6283105611801147, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.07163538783788681, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 24000, "mean_kl_loss": 0.0006002793088555336, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 469662.8407134035}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 1600}, "rlmodule_inference_timer": 2.7295034905043247e-05, "weights_seq_no": 4.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.476300166001452e-06, "get_actions": 3.668316811911882e-05, "remove_single_ts_time_rank_from_batch": 5.83856956579822e-07, "tensor_to_numpy": 1.3067852965083532e-05, "listify_data_for_vector_env": 1.1019651911895259e-05, "un_batch_to_individual_items": 5.452395070152121e-06}}, "connector_pipeline_timer": 0.00010188888155755009}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00019053183384705336, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.310221486757963e-06, "add_observations_from_episodes_to_batch": 2.820629717992036e-06, "add_time_dim_to_batch_and_zero_pad": 2.2016539618782823e-06, "add_states_from_episodes_to_batch": 1.5817732407842777e-06, "numpy_to_tensor": 8.59166852247362e-06}}, "connector_pipeline_timer": 4.332191126828546e-05}, "episode_return_mean": -0.2, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004572437483875547, "num_episodes_lifetime": 80, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_env_steps_sampled_lifetime": 20400, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_len_max": 20, "sample": 0.10112563724218775, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.2}, "episode_return_min": -12.5, "env_step_timer": 1.4681422988471144e-05, "module_episode_returns_mean": {"default_policy": -0.2}, "time_between_sampling": 1.6520740965638658}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-24", "timestamp": 1754933064, "time_this_iter_s": 1.7613708972930908, "time_total_s": 6.932723045349121, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.932723045349121, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 50.85, "ram_util_percent": 77.9}}
{"timers": {"training_iteration": 1.7315571172577011, "restore_env_runners": 9.912992449637966e-06, "training_step": 1.7313988844275774, "env_runner_sampling_timer": 1.6217492643368976, "learner_update_timer": 0.10639127778366507, "synch_weights": 0.0005809638362625148, "restore_eval_env_runners": 7.901225787703878e-06, "evaluation_iteration": 0.1083205466210642, "synch_eval_env_connectors": 0.00013136353147169574, "synch_env_connectors": 4.739243141957559e-06}, "env_runners": {"env_step_timer": 1.3955305244435825e-05, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.725264948688033e-06, "numpy_to_tensor": 8.72993705008334e-06, "batch_individual_items": 6.2588264321442026e-06, "add_observations_from_episodes_to_batch": 2.947686252928532e-06, "add_time_dim_to_batch_and_zero_pad": 2.3999207438752502e-06}}, "connector_pipeline_timer": 4.380962323847182e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.321038460312741e-05, "normalize_and_clip_actions": 9.57395458137728e-06, "listify_data_for_vector_env": 1.104233577274993e-05, "remove_single_ts_time_rank_from_batch": 5.97836759114811e-07, "get_actions": 3.908653182725734e-05, "un_batch_to_individual_items": 5.502899378815754e-06}}, "connector_pipeline_timer": 0.00010464489956382107}, "env_reset_timer": 4.1935906106859016e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "time_between_sampling": 0.0016311250927455603, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_mean": 2.8199999999999994, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.6077202559341085e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_max": 20, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "sample": 0.005064889728423896, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004935282558668405, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime_throughput": 3654.3816473204583}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008087180807509205, "add_time_dim_to_batch_and_zero_pad": 1.4165992660067278e-05, "add_columns_from_episodes_to_train_batch": 0.034591643548605375, "numpy_to_tensor": 7.209791019584984e-05, "general_advantage_estimation": 0.007002596480987799, "batch_individual_items": 0.031144909879774838, "add_one_ts_to_episodes_and_truncate": 0.007488723136419634, "add_states_from_episodes_to_batch": 1.4506612416587304e-05}}, "connector_pipeline_timer": 0.08127165114890961}, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2437749.3800810915, "num_module_steps_trained_throughput": 467029.0000964113, "num_module_steps_trained_lifetime_throughput": 465977.4707084294}, "default_policy": {"total_loss": 0.10586991161108017, "curr_kl_coeff": 0.023328009992837906, "gradients_default_optimizer_global_norm": 0.029085060581564903, "vf_loss_unclipped": 28.329936981201172, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010551810264587402, "num_module_steps_trained": 6000, "entropy": 0.6176988482475281, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.042711563408374786, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 30000, "mean_kl_loss": 0.0002633107651490718, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 468286.63274828123}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 2000}, "rlmodule_inference_timer": 2.705030322065578e-05, "weights_seq_no": 5.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.35694041078437e-06, "get_actions": 3.617408363851244e-05, "remove_single_ts_time_rank_from_batch": 5.888407108278223e-07, "tensor_to_numpy": 1.289505946948834e-05, "listify_data_for_vector_env": 1.085231471667868e-05, "un_batch_to_individual_items": 5.383424653434433e-06}}, "connector_pipeline_timer": 0.00010084303744178453}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0001894381747738924, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.116412311851169e-06, "add_observations_from_episodes_to_batch": 2.800285479408333e-06, "add_time_dim_to_batch_and_zero_pad": 2.1901652891506503e-06, "add_states_from_episodes_to_batch": 1.573525442842993e-06, "numpy_to_tensor": 8.301392691549887e-06}}, "connector_pipeline_timer": 4.2379424987597e-05}, "episode_return_mean": -0.4, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004549844968132675, "num_episodes_lifetime": 100, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_env_steps_sampled_lifetime": 25400, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_max": 20, "sample": 0.10108672003027341, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.4}, "episode_return_min": -14.5, "env_step_timer": 1.4046080894578134e-05, "module_episode_returns_mean": {"default_policy": -0.4}, "time_between_sampling": 1.6515444326778976}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-26", "timestamp": 1754933066, "time_this_iter_s": 1.68576979637146, "time_total_s": 8.618492841720581, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.618492841720581, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 42.53333333333334, "ram_util_percent": 77.43333333333332}}
{"timers": {"training_iteration": 1.7300482948357436, "restore_env_runners": 9.865532301581253e-06, "training_step": 1.7298898776732048, "env_runner_sampling_timer": 1.6195080541930265, "learner_update_timer": 0.10712444542648454, "synch_weights": 0.0005807741976196733, "restore_eval_env_runners": 7.885553942279655e-06, "evaluation_iteration": 0.10825820365457119, "synch_eval_env_connectors": 0.00013108406584766226, "synch_env_connectors": 4.733100151520921e-06}, "env_runners": {"env_step_timer": 1.3964771171084663e-05, "agent_episode_returns_mean": {"default_agent": 2.34}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7287166111043327e-06, "numpy_to_tensor": 8.651736295215679e-06, "batch_individual_items": 6.245017858615015e-06, "add_observations_from_episodes_to_batch": 2.9478355396442853e-06, "add_time_dim_to_batch_and_zero_pad": 2.3785707232846744e-06}}, "connector_pipeline_timer": 4.3671992473707366e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3160933612311478e-05, "normalize_and_clip_actions": 9.546326636188952e-06, "listify_data_for_vector_env": 1.1085424314647286e-05, "remove_single_ts_time_rank_from_batch": 5.886327479719205e-07, "get_actions": 3.885277771406818e-05, "un_batch_to_individual_items": 5.493361451589726e-06}}, "connector_pipeline_timer": 0.00010433573991795074}, "env_reset_timer": 3.842807764038837e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.34}, "time_between_sampling": 0.0015288226058531346, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_mean": 2.34, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.82874250901606e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_max": 20, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "sample": 0.00518069542593325, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004577332198154183, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime_throughput": 3672.7385578230837}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008090788199156523, "add_time_dim_to_batch_and_zero_pad": 1.4127662973120193e-05, "add_columns_from_episodes_to_train_batch": 0.03458638295265566, "numpy_to_tensor": 7.203318172532804e-05, "general_advantage_estimation": 0.0069852130159731044, "batch_individual_items": 0.032017986202099176, "add_one_ts_to_episodes_and_truncate": 0.00748951715536501, "add_states_from_episodes_to_batch": 1.4391956302789063e-05}}, "connector_pipeline_timer": 0.08212265422654402}, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2431180.4850170584, "num_module_steps_trained_throughput": 465673.13060946565, "num_module_steps_trained_lifetime_throughput": 464657.0311131837}, "default_policy": {"total_loss": -0.1386224329471588, "curr_kl_coeff": 0.011664004996418953, "gradients_default_optimizer_global_norm": 0.044034115970134735, "vf_loss_unclipped": 28.01873207092285, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.0063784122467041016, "num_module_steps_trained": 6000, "entropy": 0.6058812141418457, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.2018829733133316, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 36000, "mean_kl_loss": 0.0003197113692294806, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 466849.6487188622}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 2400}, "rlmodule_inference_timer": 2.690837380333615e-05, "weights_seq_no": 6.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.424491355535068e-06, "get_actions": 3.606064936120557e-05, "remove_single_ts_time_rank_from_batch": 5.960875126470329e-07, "tensor_to_numpy": 1.3074893438909402e-05, "listify_data_for_vector_env": 1.105332524276476e-05, "un_batch_to_individual_items": 5.4732492796280556e-06}}, "connector_pipeline_timer": 0.00010122534443660944}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0001883512927720142, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.2715901654279e-06, "add_observations_from_episodes_to_batch": 2.8062415223061084e-06, "add_time_dim_to_batch_and_zero_pad": 2.2029323981746325e-06, "add_states_from_episodes_to_batch": 1.5852716736919164e-06, "numpy_to_tensor": 8.522035224644708e-06}}, "connector_pipeline_timer": 4.2932131301027825e-05}, "episode_return_mean": 0.8, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004532231658231467, "num_episodes_lifetime": 120, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_env_steps_sampled_lifetime": 30400, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_len_max": 20, "sample": 0.10106608908018869, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.8}, "episode_return_min": -14.5, "env_step_timer": 1.4217811766380232e-05, "module_episode_returns_mean": {"default_policy": 0.8}, "time_between_sampling": 1.6510372633510315}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-28", "timestamp": 1754933068, "time_this_iter_s": 1.6867539882659912, "time_total_s": 10.305246829986572, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.305246829986572, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.2, "ram_util_percent": 77.55}}
{"timers": {"training_iteration": 1.727500966476948, "restore_env_runners": 9.827296530593619e-06, "training_step": 1.7273423388961184, "env_runner_sampling_timer": 1.6170992432415876, "learner_update_timer": 0.1069868888919705, "synch_weights": 0.0005805506157422826, "restore_eval_env_runners": 7.878778113519223e-06, "evaluation_iteration": 0.1082152228669473, "synch_eval_env_connectors": 0.00013116863511595777, "synch_env_connectors": 4.728268891545071e-06}, "env_runners": {"env_step_timer": 1.3736150897922963e-05, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.73152690123104e-06, "numpy_to_tensor": 8.598292259657211e-06, "batch_individual_items": 6.216815502032484e-06, "add_observations_from_episodes_to_batch": 2.9320294882707514e-06, "add_time_dim_to_batch_and_zero_pad": 2.3688405668972934e-06}}, "connector_pipeline_timer": 4.345644683982213e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3034417716396934e-05, "normalize_and_clip_actions": 9.40711891764186e-06, "listify_data_for_vector_env": 1.098117065695475e-05, "remove_single_ts_time_rank_from_batch": 5.827694336566422e-07, "get_actions": 3.8250073549633006e-05, "un_batch_to_individual_items": 5.38644798434345e-06}}, "connector_pipeline_timer": 0.00010309075173055185}, "env_reset_timer": 3.7118529018941676e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "time_between_sampling": 0.0018324223358842915, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_mean": 2.259999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7624424781139498e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_max": 20, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "sample": 0.004883757215884975, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004525351455435158, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime_throughput": 3728.209741492389}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008093955322889983, "add_time_dim_to_batch_and_zero_pad": 1.410471553310676e-05, "add_columns_from_episodes_to_train_batch": 0.03458934203300208, "numpy_to_tensor": 7.195369064336123e-05, "general_advantage_estimation": 0.0069682871363139776, "batch_individual_items": 0.03199704509009078, "add_one_ts_to_episodes_and_truncate": 0.007502021154545348, "add_states_from_episodes_to_batch": 1.428011730999702e-05}}, "connector_pipeline_timer": 0.0821001385250328}, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2424164.976585878, "num_module_steps_trained_throughput": 464234.09705037536, "num_module_steps_trained_lifetime_throughput": 463252.7253470566}, "default_policy": {"total_loss": 0.03697100281715393, "curr_kl_coeff": 0.0058320024982094765, "gradients_default_optimizer_global_norm": 0.013988404534757137, "vf_loss_unclipped": 28.27447509765625, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.008970975875854492, "num_module_steps_trained": 6000, "entropy": 0.5972712635993958, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.02636248804628849, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 42000, "mean_kl_loss": 0.00020801420032512397, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 465327.54428979655}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 2800}, "rlmodule_inference_timer": 2.7517024516371285e-05, "weights_seq_no": 7.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.566401260455106e-06, "get_actions": 3.73440700755004e-05, "remove_single_ts_time_rank_from_batch": 5.956148110015546e-07, "tensor_to_numpy": 1.3195032364044485e-05, "listify_data_for_vector_env": 1.1245990754866626e-05, "un_batch_to_individual_items": 5.492361984567266e-06}}, "connector_pipeline_timer": 0.00010317055587529184}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00018722360981371507, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.250777131928007e-06, "add_observations_from_episodes_to_batch": 2.8522889548352407e-06, "add_time_dim_to_batch_and_zero_pad": 2.2226526754583946e-06, "add_states_from_episodes_to_batch": 1.5903505879711907e-06, "numpy_to_tensor": 8.667286318794744e-06}}, "connector_pipeline_timer": 4.322781699620921e-05}, "episode_return_mean": 0.6, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004564208302181214, "num_episodes_lifetime": 140, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_env_steps_sampled_lifetime": 35400, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_len_max": 20, "sample": 0.10106801193922124, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.6}, "episode_return_min": -14.5, "env_step_timer": 1.4433882052753425e-05, "module_episode_returns_mean": {"default_policy": 0.6}, "time_between_sampling": 1.649449422798194}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-29", "timestamp": 1754933069, "time_this_iter_s": 1.5839347839355469, "time_total_s": 11.88918161392212, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.88918161392212, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.166666666666664, "ram_util_percent": 77.76666666666667}}
{"timers": {"training_iteration": 1.7263525988915038, "restore_env_runners": 9.784443079243395e-06, "training_step": 1.7261937034268464, "env_runner_sampling_timer": 1.616109819149803, "learner_update_timer": 0.10682855042346777, "synch_weights": 0.0005805467800709672, "restore_eval_env_runners": 7.863740526769678e-06, "evaluation_iteration": 0.10819626063840955, "synch_eval_env_connectors": 0.0001314819483326645, "synch_env_connectors": 4.716405564295465e-06}, "env_runners": {"env_step_timer": 1.4355904570492313e-05, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7567856410561678e-06, "numpy_to_tensor": 8.852950818705026e-06, "batch_individual_items": 6.4427777710607936e-06, "add_observations_from_episodes_to_batch": 3.0941635760808717e-06, "add_time_dim_to_batch_and_zero_pad": 2.4069580262726434e-06}}, "connector_pipeline_timer": 4.447426160828611e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3437969673676038e-05, "normalize_and_clip_actions": 9.692912292474576e-06, "listify_data_for_vector_env": 1.131419091273692e-05, "remove_single_ts_time_rank_from_batch": 6.033391897398109e-07, "get_actions": 4.0300783423946474e-05, "un_batch_to_individual_items": 5.557844282100717e-06}}, "connector_pipeline_timer": 0.00010680118317316831}, "env_reset_timer": 4.014069933672544e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "time_between_sampling": 0.00155728361976848, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_mean": 2.899999999999998, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.4264624520988616e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_max": 20, "weights_seq_no": 7.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "sample": 0.005223314453122888, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.005032344345003366, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime_throughput": 3604.569163601125}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008123844960477814, "add_time_dim_to_batch_and_zero_pad": 1.4061587633270763e-05, "add_columns_from_episodes_to_train_batch": 0.034579030692969234, "numpy_to_tensor": 7.190998309718918e-05, "general_advantage_estimation": 0.006951670515353317, "batch_individual_items": 0.03197706463939312, "add_one_ts_to_episodes_and_truncate": 0.007505325523099329, "add_states_from_episodes_to_batch": 1.417315575787469e-05}}, "connector_pipeline_timer": 0.08205907463968375}, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2417917.244080662, "num_module_steps_trained_throughput": 462942.7895576943, "num_module_steps_trained_lifetime_throughput": 461996.0242353204}, "default_policy": {"total_loss": -0.009110665880143642, "curr_kl_coeff": 0.0029160012491047382, "gradients_default_optimizer_global_norm": 0.025655152276158333, "vf_loss_unclipped": 28.120574951171875, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.0067958831787109375, "num_module_steps_trained": 6000, "entropy": 0.5958549976348877, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07245510071516037, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 48000, "mean_kl_loss": 9.257249621441588e-05, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 463952.15540788666}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 3200}, "rlmodule_inference_timer": 2.717668140168372e-05, "weights_seq_no": 8.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.400773558022113e-06, "get_actions": 3.605083745314176e-05, "remove_single_ts_time_rank_from_batch": 6.029070975670452e-07, "tensor_to_numpy": 1.296986108613022e-05, "listify_data_for_vector_env": 1.091366694486236e-05, "un_batch_to_individual_items": 5.504303759218013e-06}}, "connector_pipeline_timer": 0.00010096165134936606}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00018610012330512544, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.222687265472022e-06, "add_observations_from_episodes_to_batch": 2.799036180880249e-06, "add_time_dim_to_batch_and_zero_pad": 2.18550979261185e-06, "add_states_from_episodes_to_batch": 1.6914900193608413e-06, "numpy_to_tensor": 8.557973924781335e-06}}, "connector_pipeline_timer": 4.3107685346394876e-05}, "episode_return_mean": 0.8, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.0045375158439856025, "num_episodes_lifetime": 160, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_env_steps_sampled_lifetime": 40400, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_len_max": 20, "sample": 0.10104343182085683, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.8}, "episode_return_min": -14.5, "env_step_timer": 1.425202572139911e-05, "module_episode_returns_mean": {"default_policy": 0.8}, "time_between_sampling": 1.6492493502402392}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-31", "timestamp": 1754933071, "time_this_iter_s": 1.7184162139892578, "time_total_s": 13.607597827911377, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.607597827911377, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.400000000000006, "ram_util_percent": 77.7}}
{"timers": {"training_iteration": 1.7250841687323009, "restore_env_runners": 9.755348880909075e-06, "training_step": 1.7249249001433222, "env_runner_sampling_timer": 1.6140993022075736, "learner_update_timer": 0.1075705032491596, "synch_weights": 0.0005806633922878839, "restore_eval_env_runners": 7.849272411046207e-06, "evaluation_iteration": 0.10815003928182332, "synch_eval_env_connectors": 0.00013121754895479518, "synch_env_connectors": 4.705082293783369e-06}, "env_runners": {"env_step_timer": 1.4146404179137146e-05, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.748628881312626e-06, "numpy_to_tensor": 8.796916910873588e-06, "batch_individual_items": 6.344615398690384e-06, "add_observations_from_episodes_to_batch": 2.968503751327379e-06, "add_time_dim_to_batch_and_zero_pad": 2.43033996206044e-06}}, "connector_pipeline_timer": 4.4170546130875494e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3370007455982775e-05, "normalize_and_clip_actions": 9.571035811989705e-06, "listify_data_for_vector_env": 1.1175610578871426e-05, "remove_single_ts_time_rank_from_batch": 5.905688734519065e-07, "get_actions": 3.9816606688469854e-05, "un_batch_to_individual_items": 5.488019937228724e-06}}, "connector_pipeline_timer": 0.00010573566582582784}, "env_reset_timer": 4.273649341332046e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "time_between_sampling": 0.00153508964202038, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_mean": 4.740000000000002, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.8841288542039512e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_max": 20, "weights_seq_no": 8.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "sample": 0.005092862219586136, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004643243168480694, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime_throughput": 3619.898155040075}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008127260706107215, "add_time_dim_to_batch_and_zero_pad": 1.4025552297148064e-05, "add_columns_from_episodes_to_train_batch": 0.03456952454618789, "numpy_to_tensor": 7.185838311020213e-05, "general_advantage_estimation": 0.006935137140296834, "batch_individual_items": 0.031962669823502377, "add_one_ts_to_episodes_and_truncate": 0.008401525187275896, "add_states_from_episodes_to_batch": 1.4064344125002163e-05}}, "connector_pipeline_timer": 0.08291479431402171}, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2411385.166787934, "num_module_steps_trained_throughput": 461601.0454323112, "num_module_steps_trained_lifetime_throughput": 460687.65981024667}, "default_policy": {"total_loss": -0.09930161386728287, "curr_kl_coeff": 0.0014580006245523691, "gradients_default_optimizer_global_norm": 0.05536004900932312, "vf_loss_unclipped": 27.78199577331543, "vf_loss": 0.10278083384037018, "vf_explained_var": 0.0010166168212890625, "num_module_steps_trained": 6000, "entropy": 0.5808447599411011, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.16278362274169922, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 54000, "mean_kl_loss": 0.0007413393468596041, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 462529.4456887158}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 3600}, "rlmodule_inference_timer": 2.707588314404973e-05, "weights_seq_no": 9.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.547889100502782e-06, "get_actions": 3.6428248662116916e-05, "remove_single_ts_time_rank_from_batch": 5.963792377525121e-07, "tensor_to_numpy": 1.3127737998292809e-05, "listify_data_for_vector_env": 1.1060385010185507e-05, "un_batch_to_individual_items": 5.406959133179853e-06}}, "connector_pipeline_timer": 0.00010185898621106224}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0001849803721865896, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.14924921571248e-06, "add_observations_from_episodes_to_batch": 2.8426873947554718e-06, "add_time_dim_to_batch_and_zero_pad": 2.1883524864442424e-06, "add_states_from_episodes_to_batch": 1.5870379025109121e-06, "numpy_to_tensor": 8.410226344355874e-06}}, "connector_pipeline_timer": 4.258536004953568e-05}, "episode_return_mean": 1.0, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004547107074176893, "num_episodes_lifetime": 180, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 45400, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_len_max": 20, "sample": 0.10103891084197068, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.0}, "episode_return_min": -14.5, "env_step_timer": 1.4239209223954953e-05, "module_episode_returns_mean": {"default_policy": 1.0}, "time_between_sampling": 1.6489285654886081}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-33", "timestamp": 1754933073, "time_this_iter_s": 1.7069461345672607, "time_total_s": 15.314543962478638, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.314543962478638, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.45, "ram_util_percent": 77.55}}
{"timers": {"training_iteration": 1.7241455070446368, "restore_env_runners": 9.7115455103407e-06, "training_step": 1.7239861298922723, "env_runner_sampling_timer": 1.6124115237647596, "learner_update_timer": 0.10832106321694053, "synch_weights": 0.0005802680079504547, "restore_eval_env_runners": 7.834939663254223e-06, "evaluation_iteration": 0.10812075596856442, "synch_eval_env_connectors": 0.00013091787360792586, "synch_env_connectors": 4.6972017341806444e-06}, "env_runners": {"env_step_timer": 1.4578027578938272e-05, "agent_episode_returns_mean": {"default_agent": 3.7}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.789043730651618e-06, "numpy_to_tensor": 8.994923992139636e-06, "batch_individual_items": 6.468675618244348e-06, "add_observations_from_episodes_to_batch": 3.0885599217181477e-06, "add_time_dim_to_batch_and_zero_pad": 2.4488058687086136e-06}}, "connector_pipeline_timer": 4.495466318696467e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.366090111510173e-05, "normalize_and_clip_actions": 9.751476620606218e-06, "listify_data_for_vector_env": 1.1460752379268378e-05, "remove_single_ts_time_rank_from_batch": 6.007104084508081e-07, "get_actions": 4.073002785144803e-05, "un_batch_to_individual_items": 5.571486161897082e-06}}, "connector_pipeline_timer": 0.00010788341123811448}, "env_reset_timer": 4.1718347613781844e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.7}, "time_between_sampling": 0.001866587140109206, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_mean": 3.7, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.897497369835632e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_max": 20, "weights_seq_no": 9.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "sample": 0.005065908716595133, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004739503330085426, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime_throughput": 3577.4665400380463}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008138042199287655, "add_time_dim_to_batch_and_zero_pad": 1.3991126450789796e-05, "add_columns_from_episodes_to_train_batch": 0.03457543972076493, "numpy_to_tensor": 7.17793792364512e-05, "general_advantage_estimation": 0.006919495768086372, "batch_individual_items": 0.032838668125667825, "add_one_ts_to_episodes_and_truncate": 0.008397024094991282, "add_states_from_episodes_to_batch": 1.3957040867770157e-05}}, "connector_pipeline_timer": 0.08377718470035053}, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2405633.4225459523, "num_module_steps_trained_throughput": 460414.4120994768, "num_module_steps_trained_lifetime_throughput": 459533.04881909897}, "default_policy": {"total_loss": 0.045452482998371124, "curr_kl_coeff": 0.0007290003122761846, "gradients_default_optimizer_global_norm": 0.05242887884378433, "vf_loss_unclipped": 28.12540626525879, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.005507946014404297, "num_module_steps_trained": 6000, "entropy": 0.5488011240959167, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.01831967383623123, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 60000, "mean_kl_loss": 0.001431760611012578, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 461261.3099653678}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 4000}, "rlmodule_inference_timer": 2.7327887650410763e-05, "weights_seq_no": 10.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.51572293012588e-06, "get_actions": 3.65776231672576e-05, "remove_single_ts_time_rank_from_batch": 6.019109415402842e-07, "tensor_to_numpy": 1.3149801020075191e-05, "listify_data_for_vector_env": 1.107547337338329e-05, "un_batch_to_individual_items": 5.528286813838072e-06}}, "connector_pipeline_timer": 0.00010213314031004632}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00018384765774334718, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.2842903357519504e-06, "add_observations_from_episodes_to_batch": 2.8290704273440374e-06, "add_time_dim_to_batch_and_zero_pad": 2.2026354938172904e-06, "add_states_from_episodes_to_batch": 1.588884713441021e-06, "numpy_to_tensor": 8.541385972239165e-06}}, "connector_pipeline_timer": 4.322383465782075e-05}, "episode_return_mean": 1.2, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004563864185474813, "num_episodes_lifetime": 200, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 50400, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_max": 20, "sample": 0.10101943673398966, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.2}, "episode_return_min": -14.5, "env_step_timer": 1.4273343548384777e-05, "module_episode_returns_mean": {"default_policy": 1.2}, "time_between_sampling": 1.6489529635830849}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-34", "timestamp": 1754933074, "time_this_iter_s": 1.7376399040222168, "time_total_s": 17.052183866500854, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.052183866500854, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 45.1, "ram_util_percent": 77.73333333333333}}
{"timers": {"training_iteration": 1.721831352804795, "restore_env_runners": 9.675259389198303e-06, "training_step": 1.7216716623442407, "env_runner_sampling_timer": 1.6102541326965525, "learner_update_timer": 0.10816561258511177, "synch_weights": 0.0005801669975956082, "restore_eval_env_runners": 7.826590799636217e-06, "evaluation_iteration": 0.10808136174914967, "synch_eval_env_connectors": 0.0001309253556541689, "synch_env_connectors": 4.68772942030573e-06}, "env_runners": {"env_step_timer": 1.402922838175031e-05, "agent_episode_returns_mean": {"default_agent": 5.14}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.737890125236429e-06, "numpy_to_tensor": 8.648670795143492e-06, "batch_individual_items": 6.331227586786935e-06, "add_observations_from_episodes_to_batch": 2.976546682241374e-06, "add_time_dim_to_batch_and_zero_pad": 2.3953787648624104e-06}}, "connector_pipeline_timer": 4.3791157599813504e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3197690969815906e-05, "normalize_and_clip_actions": 9.482335204628652e-06, "listify_data_for_vector_env": 1.108273635408754e-05, "remove_single_ts_time_rank_from_batch": 5.872642171011117e-07, "get_actions": 3.8736756954134434e-05, "un_batch_to_individual_items": 5.518833710366212e-06}}, "connector_pipeline_timer": 0.00010410982833124026}, "env_reset_timer": 3.9050392171285084e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.14}, "time_between_sampling": 0.0018787613517010613, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_mean": 5.14, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.856913010458136e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_max": 20, "weights_seq_no": 10.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "sample": 0.004951893324880399, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.00459310572547838, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime_throughput": 3683.270698957322}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008143003470826501, "add_time_dim_to_batch_and_zero_pad": 1.3957466286360123e-05, "add_columns_from_episodes_to_train_batch": 0.034585816993389674, "numpy_to_tensor": 7.170533539826562e-05, "general_advantage_estimation": 0.006902423310897767, "batch_individual_items": 0.03280907435517328, "add_one_ts_to_episodes_and_truncate": 0.008388363014206857, "add_states_from_episodes_to_batch": 1.3850390383798675e-05}}, "connector_pipeline_timer": 0.08373220327300195}, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2399443.3084103796, "num_module_steps_trained_throughput": 459146.5720035444, "num_module_steps_trained_lifetime_throughput": 458296.3008625921}, "default_policy": {"total_loss": 0.02990320324897766, "curr_kl_coeff": 0.0003645001561380923, "gradients_default_optimizer_global_norm": 0.034589968621730804, "vf_loss_unclipped": 27.9683895111084, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.0021424293518066406, "num_module_steps_trained": 6000, "entropy": 0.5197477340698242, "weights_seq_no": 11.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03413091599941254, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 66000, "mean_kl_loss": 0.0012500360608100891, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 459915.78258265794}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 4400}, "rlmodule_inference_timer": 2.6407699386198545e-05, "weights_seq_no": 11.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.369032595200705e-06, "get_actions": 3.535337550579998e-05, "remove_single_ts_time_rank_from_batch": 5.838238234857198e-07, "tensor_to_numpy": 1.2730022570249113e-05, "listify_data_for_vector_env": 1.0850392430085418e-05, "un_batch_to_individual_items": 5.3902179352770365e-06}}, "connector_pipeline_timer": 9.978840182302421e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00018278084129079677, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.0522686617841155e-06, "add_observations_from_episodes_to_batch": 2.79531768677484e-06, "add_time_dim_to_batch_and_zero_pad": 2.1829340114645723e-06, "add_states_from_episodes_to_batch": 1.577837477398856e-06, "numpy_to_tensor": 8.24084041929421e-06}}, "connector_pipeline_timer": 4.2462108710108536e-05}, "episode_return_mean": 0.8, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.0045546033536083995, "num_episodes_lifetime": 220, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 55400, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_len_max": 20, "sample": 0.10098692361672837, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.8}, "episode_return_min": -14.5, "env_step_timer": 1.390958390726508e-05, "module_episode_returns_mean": {"default_policy": 0.8}, "time_between_sampling": 1.6475829835269395}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-36", "timestamp": 1754933076, "time_this_iter_s": 1.5975680351257324, "time_total_s": 18.649751901626587, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.649751901626587, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 41.8, "ram_util_percent": 77.3}}
{"timers": {"training_iteration": 1.7203700955267511, "restore_env_runners": 9.63308695479166e-06, "training_step": 1.7202102273915159, "env_runner_sampling_timer": 1.6089689280392443, "learner_update_timer": 0.1079883897895488, "synch_weights": 0.0005798011571361524, "restore_eval_env_runners": 7.812075086025502e-06, "evaluation_iteration": 0.108026523961347, "synch_eval_env_connectors": 0.00013142193191319375, "synch_env_connectors": 4.680022389437782e-06}, "env_runners": {"env_step_timer": 1.3992520393143293e-05, "agent_episode_returns_mean": {"default_agent": 4.980000000000002}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7359950940042332e-06, "numpy_to_tensor": 8.683966053062654e-06, "batch_individual_items": 6.365634234293547e-06, "add_observations_from_episodes_to_batch": 3.0283995945473486e-06, "add_time_dim_to_batch_and_zero_pad": 2.383815830916159e-06}}, "connector_pipeline_timer": 4.398218224621747e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3204365439676867e-05, "normalize_and_clip_actions": 9.538576307928245e-06, "listify_data_for_vector_env": 1.1114651786500888e-05, "remove_single_ts_time_rank_from_batch": 5.905407462394575e-07, "get_actions": 3.885013883846813e-05, "un_batch_to_individual_items": 5.508446701351636e-06}}, "connector_pipeline_timer": 0.00010435577381130884}, "env_reset_timer": 3.867489409232255e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.980000000000002}, "time_between_sampling": 0.0018308747346269443, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_mean": 4.980000000000002, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.8065662060653228e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_max": 20, "weights_seq_no": 11.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "sample": 0.00492034598328399, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.00458964934758842, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime_throughput": 3661.17277948695}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008143006733718832, "add_time_dim_to_batch_and_zero_pad": 1.3902472011416662e-05, "add_columns_from_episodes_to_train_batch": 0.034575774233818336, "numpy_to_tensor": 7.159828203251103e-05, "general_advantage_estimation": 0.00688759240778615, "batch_individual_items": 0.032775946111377914, "add_one_ts_to_episodes_and_truncate": 0.008380216474147629, "add_states_from_episodes_to_batch": 1.3739386107282646e-05}}, "connector_pipeline_timer": 0.08366536332009636}, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2393672.891126385, "num_module_steps_trained_throughput": 457962.4106485761, "num_module_steps_trained_lifetime_throughput": 457141.4860536542}, "default_policy": {"total_loss": -0.030171997845172882, "curr_kl_coeff": 0.00018225007806904614, "gradients_default_optimizer_global_norm": 0.06014768406748772, "vf_loss_unclipped": 27.940900802612305, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.00040781497955322266, "num_module_steps_trained": 6000, "entropy": 0.4981132447719574, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.09440136700868607, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 72000, "mean_kl_loss": 0.0005731904529966414, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 458659.8192918074}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 4800}, "rlmodule_inference_timer": 2.684585524907005e-05, "weights_seq_no": 12.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.364635579329446e-06, "get_actions": 3.526073192255336e-05, "remove_single_ts_time_rank_from_batch": 5.813784253202364e-07, "tensor_to_numpy": 1.2822899851000898e-05, "listify_data_for_vector_env": 1.090864762109557e-05, "un_batch_to_individual_items": 5.410575122771555e-06}}, "connector_pipeline_timer": 9.996129837864281e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0001817747026967223, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.180118681969771e-06, "add_observations_from_episodes_to_batch": 2.8018848859878936e-06, "add_time_dim_to_batch_and_zero_pad": 2.200546480505778e-06, "add_states_from_episodes_to_batch": 1.590025064701361e-06, "numpy_to_tensor": 8.389645998453381e-06}}, "connector_pipeline_timer": 4.280685812570151e-05}, "episode_return_mean": 0.8, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004530141672585159, "num_episodes_lifetime": 240, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 60400, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_len_max": 20, "sample": 0.10095631688016546, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.8}, "episode_return_min": -13.5, "env_step_timer": 1.4084975862590974e-05, "module_episode_returns_mean": {"default_policy": 0.8}, "time_between_sampling": 1.6470571211917253}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-38", "timestamp": 1754933078, "time_this_iter_s": 1.6806678771972656, "time_total_s": 20.330419778823853, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.330419778823853, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.06666666666666, "ram_util_percent": 77.39999999999999}}
{"timers": {"training_iteration": 1.7191748920713446, "restore_env_runners": 9.588005602371615e-06, "training_step": 1.7190150321979007, "env_runner_sampling_timer": 1.6079235270890975, "learner_update_timer": 0.10783950922169591, "synch_weights": 0.0005796223152433299, "restore_eval_env_runners": 7.80104332098089e-06, "evaluation_iteration": 0.10797178122201011, "synch_eval_env_connectors": 0.00013110437326805267, "synch_env_connectors": 4.671132815096346e-06}, "env_runners": {"env_step_timer": 1.405178715736106e-05, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7438591118448624e-06, "numpy_to_tensor": 8.787970436405348e-06, "batch_individual_items": 6.325933340101374e-06, "add_observations_from_episodes_to_batch": 2.9747461267402313e-06, "add_time_dim_to_batch_and_zero_pad": 2.409182200410135e-06}}, "connector_pipeline_timer": 4.397923661701182e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3251593918244812e-05, "normalize_and_clip_actions": 9.578082533779177e-06, "listify_data_for_vector_env": 1.1163407706354637e-05, "remove_single_ts_time_rank_from_batch": 6.006842137177461e-07, "get_actions": 3.964013712960437e-05, "un_batch_to_individual_items": 5.499750608480845e-06}}, "connector_pipeline_timer": 0.00010532312780220574}, "env_reset_timer": 4.047905272488265e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "time_between_sampling": 0.00171048737115109, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_mean": 5.619999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.8059408270535438e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_max": 20, "weights_seq_no": 12.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "sample": 0.004935434867514422, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004621077842079103, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime_throughput": 3636.0108263575535}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008143376672245996, "add_time_dim_to_batch_and_zero_pad": 1.3862618011507206e-05, "add_columns_from_episodes_to_train_batch": 0.034571594411378706, "numpy_to_tensor": 7.153437868264157e-05, "general_advantage_estimation": 0.006873269823431786, "batch_individual_items": 0.03275434456937673, "add_one_ts_to_episodes_and_truncate": 0.008373701809431856, "add_states_from_episodes_to_batch": 1.3631162433399995e-05}}, "connector_pipeline_timer": 0.08361828051626079}, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2387354.378758742, "num_module_steps_trained_throughput": 456676.8673512288, "num_module_steps_trained_lifetime_throughput": 455884.4793937611}, "default_policy": {"total_loss": 0.13146176934242249, "curr_kl_coeff": 9.112503903452307e-05, "gradients_default_optimizer_global_norm": 0.030830301344394684, "vf_loss_unclipped": 28.0755558013916, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.003191232681274414, "num_module_steps_trained": 6000, "entropy": 0.47185197472572327, "weights_seq_no": 13.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06699463725090027, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 78000, "mean_kl_loss": 0.00074898696038872, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 457304.7346971033}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 5200}, "rlmodule_inference_timer": 2.789175202811465e-05, "weights_seq_no": 13.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.571742289145215e-06, "get_actions": 3.727811324176659e-05, "remove_single_ts_time_rank_from_batch": 5.906697097945242e-07, "tensor_to_numpy": 1.3349291281737056e-05, "listify_data_for_vector_env": 1.1325107818247866e-05, "un_batch_to_individual_items": 5.603948245631353e-06}}, "connector_pipeline_timer": 0.00010387877904170563}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00018077445549176068, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.357457902920943e-06, "add_observations_from_episodes_to_batch": 2.897939449615499e-06, "add_time_dim_to_batch_and_zero_pad": 2.2477261177459394e-06, "add_states_from_episodes_to_batch": 1.5886555421525574e-06, "numpy_to_tensor": 8.71432759202048e-06}}, "connector_pipeline_timer": 4.365826223678322e-05}, "episode_return_mean": 0.8, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004559422064339742, "num_episodes_lifetime": 260, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 65400, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_len_max": 20, "sample": 0.10096649454130655, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.8}, "episode_return_min": -14.5, "env_step_timer": 1.4663747689287228e-05, "module_episode_returns_mean": {"default_policy": 0.8}, "time_between_sampling": 1.6467689924805298}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-39", "timestamp": 1754933079, "time_this_iter_s": 1.710630178451538, "time_total_s": 22.04104995727539, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.04104995727539, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 41.3, "ram_util_percent": 77.5}}
{"timers": {"training_iteration": 1.7179105810705217, "restore_env_runners": 9.622545631390613e-06, "training_step": 1.7177504635360432, "env_runner_sampling_timer": 1.605902597647737, "learner_update_timer": 0.10859500912964241, "synch_weights": 0.0005795273427203962, "restore_eval_env_runners": 7.792611997320603e-06, "evaluation_iteration": 0.10796690883045232, "synch_eval_env_connectors": 0.0001310262388068657, "synch_env_connectors": 4.664001532213322e-06}, "env_runners": {"env_step_timer": 1.4116022565962623e-05, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7308239440439873e-06, "numpy_to_tensor": 8.74014205492249e-06, "batch_individual_items": 6.346114989817136e-06, "add_observations_from_episodes_to_batch": 2.9476202524141184e-06, "add_time_dim_to_batch_and_zero_pad": 2.388181852277639e-06}}, "connector_pipeline_timer": 4.3880581252485535e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3251493288171868e-05, "normalize_and_clip_actions": 9.584067229776801e-06, "listify_data_for_vector_env": 1.1277306373782634e-05, "remove_single_ts_time_rank_from_batch": 5.913938423366378e-07, "get_actions": 3.9140315041549354e-05, "un_batch_to_individual_items": 5.460587548155789e-06}}, "connector_pipeline_timer": 0.00010493315032555884}, "env_reset_timer": 4.1207328103472e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "time_between_sampling": 0.0017427753045884862, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_mean": 5.299999999999998, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.8561301306684535e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_max": 20, "weights_seq_no": 13.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "sample": 0.0049667063595204555, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004609288299921901, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime_throughput": 3651.1192022859673}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008146905403454511, "add_time_dim_to_batch_and_zero_pad": 1.3835662064701404e-05, "add_columns_from_episodes_to_train_batch": 0.0345651959671577, "numpy_to_tensor": 7.146986522986759e-05, "general_advantage_estimation": 0.006856663375427244, "batch_individual_items": 0.033640109043362176, "add_one_ts_to_episodes_and_truncate": 0.008367413541717965, "add_states_from_episodes_to_batch": 1.3527770733772215e-05}}, "connector_pipeline_timer": 0.08447469812199547}, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2379674.584277054, "num_module_steps_trained_throughput": 455135.74404806853, "num_module_steps_trained_lifetime_throughput": 454370.69839368336}, "default_policy": {"total_loss": -0.043898805975914, "curr_kl_coeff": 4.5562519517261535e-05, "gradients_default_optimizer_global_norm": 0.011624989099800587, "vf_loss_unclipped": 27.947935104370117, "vf_loss": 0.10278083384037018, "vf_explained_var": 0.001467287540435791, "num_module_steps_trained": 6000, "entropy": 0.4444359540939331, "weights_seq_no": 14.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.10861422121524811, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 84000, "mean_kl_loss": 0.000890470459125936, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 455698.2631473356}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 5600}, "rlmodule_inference_timer": 2.846986462354177e-05, "weights_seq_no": 14.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.698611924465437e-06, "get_actions": 3.711170904275266e-05, "remove_single_ts_time_rank_from_batch": 5.96867913328258e-07, "tensor_to_numpy": 1.3597045237970139e-05, "listify_data_for_vector_env": 1.1175265305328319e-05, "un_batch_to_individual_items": 5.576549031705634e-06}}, "connector_pipeline_timer": 0.00010353161168031216}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00017972755142171555, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.30551996864155e-06, "add_observations_from_episodes_to_batch": 3.101289274411763e-06, "add_time_dim_to_batch_and_zero_pad": 2.2499815342617562e-06, "add_states_from_episodes_to_batch": 1.6185494852900244e-06, "numpy_to_tensor": 8.851346108664214e-06}}, "connector_pipeline_timer": 4.3959670923516556e-05}, "episode_return_mean": 0.2, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004573350015562028, "num_episodes_lifetime": 280, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 70400, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_len_max": 20, "sample": 0.1009802762561495, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.2}, "episode_return_min": -14.5, "env_step_timer": 1.4398838060572153e-05, "module_episode_returns_mean": {"default_policy": 0.2}, "time_between_sampling": 1.6463991842263002}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-41", "timestamp": 1754933081, "time_this_iter_s": 1.702436923980713, "time_total_s": 23.743486881256104, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.743486881256104, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.7, "ram_util_percent": 77.1}}
{"timers": {"training_iteration": 1.7170122519202404, "restore_env_runners": 9.57965934723137e-06, "training_step": 1.7168518068199943, "env_runner_sampling_timer": 1.6042774091716605, "learner_update_timer": 0.10932240570742385, "synch_weights": 0.0005795449889918477, "restore_eval_env_runners": 7.777185771176623e-06, "evaluation_iteration": 0.10796074390230613, "synch_eval_env_connectors": 0.00013079514645213274, "synch_env_connectors": 4.6602722045165966e-06}, "env_runners": {"env_step_timer": 1.4604591236982017e-05, "agent_episode_returns_mean": {"default_agent": 6.74}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7934995849511564e-06, "numpy_to_tensor": 9.023079347394914e-06, "batch_individual_items": 6.529547098306152e-06, "add_observations_from_episodes_to_batch": 3.1006243308945227e-06, "add_time_dim_to_batch_and_zero_pad": 2.440312937502031e-06}}, "connector_pipeline_timer": 4.497378097433012e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3690378402989555e-05, "normalize_and_clip_actions": 9.72104638226141e-06, "listify_data_for_vector_env": 1.1423303675329424e-05, "remove_single_ts_time_rank_from_batch": 6.134218258456456e-07, "get_actions": 4.046558780285056e-05, "un_batch_to_individual_items": 5.616914954539916e-06}}, "connector_pipeline_timer": 0.0001075561262676254}, "env_reset_timer": 4.1777056423957754e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.74}, "time_between_sampling": 0.001909185355620829, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_mean": 6.74, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.883027299315403e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_max": 20, "weights_seq_no": 14.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "sample": 0.00504007589779752, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004726163506507875, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime_throughput": 3575.882473808434}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008152457151731565, "add_time_dim_to_batch_and_zero_pad": 1.3799805642463352e-05, "add_columns_from_episodes_to_train_batch": 0.03455583275672646, "numpy_to_tensor": 7.144974695371714e-05, "general_advantage_estimation": 0.006841928822121018, "batch_individual_items": 0.034509408373470246, "add_one_ts_to_episodes_and_truncate": 0.008358795656507911, "add_states_from_episodes_to_batch": 1.3421663213624668e-05}}, "connector_pipeline_timer": 0.08531140864144748}, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2374202.206002153, "num_module_steps_trained_throughput": 454017.35332539043, "num_module_steps_trained_lifetime_throughput": 453278.8867865924}, "default_policy": {"total_loss": 0.06253442168235779, "curr_kl_coeff": 2.2781259758630767e-05, "gradients_default_optimizer_global_norm": 0.04951922968029976, "vf_loss_unclipped": 27.907155990600586, "vf_loss": 0.10278083384037018, "vf_explained_var": 0.004027366638183594, "num_module_steps_trained": 6000, "entropy": 0.4242554008960724, "weights_seq_no": 15.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0023636831901967525, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 90000, "mean_kl_loss": 0.00040324131259694695, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 454514.5339914271}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 6000}, "rlmodule_inference_timer": 2.85260535345869e-05, "weights_seq_no": 15.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.54013746839566e-06, "get_actions": 3.642711335411055e-05, "remove_single_ts_time_rank_from_batch": 6.000380074603258e-07, "tensor_to_numpy": 1.296121873874386e-05, "listify_data_for_vector_env": 1.1014166886239692e-05, "un_batch_to_individual_items": 5.894404166956218e-06}}, "connector_pipeline_timer": 0.0001022905255747653}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00017872277670329492, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.565721376342567e-06, "add_observations_from_episodes_to_batch": 2.830703781994931e-06, "add_time_dim_to_batch_and_zero_pad": 2.2621465434004398e-06, "add_states_from_episodes_to_batch": 1.797960549667582e-06, "numpy_to_tensor": 8.859624618145862e-06}}, "connector_pipeline_timer": 4.460907548096062e-05}, "episode_return_mean": 0.2, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004570007936563343, "num_episodes_lifetime": 300, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 75400, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_max": 20, "sample": 0.10095679099336158, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.2}, "episode_return_min": -14.5, "env_step_timer": 1.4316937950362439e-05, "module_episode_returns_mean": {"default_policy": 0.2}, "time_between_sampling": 1.6464058728047897}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-43", "timestamp": 1754933083, "time_this_iter_s": 1.7346141338348389, "time_total_s": 25.478101015090942, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.478101015090942, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 42.43333333333333, "ram_util_percent": 77.26666666666667}}
{"timers": {"training_iteration": 1.7165281798109548, "restore_env_runners": 9.545533770496875e-06, "training_step": 1.7163671433324184, "env_runner_sampling_timer": 1.603810572579469, "learner_update_timer": 0.1092717445702513, "synch_weights": 0.00060459703941314, "restore_eval_env_runners": 7.771493624127222e-06, "evaluation_iteration": 0.10792303563307828, "synch_eval_env_connectors": 0.00013051427498519564, "synch_env_connectors": 4.654499828295791e-06}, "env_runners": {"env_step_timer": 1.563167669069003e-05, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8174190966111567e-06, "numpy_to_tensor": 9.73913980723846e-06, "batch_individual_items": 7.120126992559529e-06, "add_observations_from_episodes_to_batch": 3.2073106186089137e-06, "add_time_dim_to_batch_and_zero_pad": 2.6258003697167714e-06}}, "connector_pipeline_timer": 4.7664745586817495e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4568064254628902e-05, "normalize_and_clip_actions": 1.0425138737829948e-05, "listify_data_for_vector_env": 1.2183315783083627e-05, "remove_single_ts_time_rank_from_batch": 6.633621139489733e-07, "get_actions": 4.4373354258760914e-05, "un_batch_to_individual_items": 6.011529407133223e-06}}, "connector_pipeline_timer": 0.00011604148326112398}, "env_reset_timer": 4.4658018446878145e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "time_between_sampling": 0.001903945190325093, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_mean": 7.059999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.144962048020386e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_max": 20, "weights_seq_no": 15.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "sample": 0.005165596323167265, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.0050953729967586694, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime_throughput": 3433.2302502212215}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008166007576566445, "add_time_dim_to_batch_and_zero_pad": 1.3831807716349371e-05, "add_columns_from_episodes_to_train_batch": 0.034568713599681805, "numpy_to_tensor": 7.178774993143833e-05, "general_advantage_estimation": 0.006839637862808043, "batch_individual_items": 0.03448865053934968, "add_one_ts_to_episodes_and_truncate": 0.008360825619628151, "add_states_from_episodes_to_batch": 1.3319946246882847e-05}}, "connector_pipeline_timer": 0.08530577789521815}, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2363050.2197445827, "num_module_steps_trained_throughput": 451817.48181278375, "num_module_steps_trained_lifetime_throughput": 451106.25258172996}, "default_policy": {"total_loss": -0.009013228118419647, "curr_kl_coeff": 1.1390629879315384e-05, "gradients_default_optimizer_global_norm": 0.09217683970928192, "vf_loss_unclipped": 27.8068904876709, "vf_loss": 0.10278083384037018, "vf_explained_var": 0.010698795318603516, "num_module_steps_trained": 6000, "entropy": 0.4163439869880676, "weights_seq_no": 16.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07398297637701035, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 96000, "mean_kl_loss": 6.271064921747893e-05, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 452254.1739537669}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 6400}, "rlmodule_inference_timer": 3.49155107042707e-05, "weights_seq_no": 16.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0801215294602938e-05, "get_actions": 4.660514996386527e-05, "remove_single_ts_time_rank_from_batch": 6.543359867191283e-07, "tensor_to_numpy": 1.590382087258775e-05, "listify_data_for_vector_env": 1.240571498622038e-05, "un_batch_to_individual_items": 6.326698925006292e-06}}, "connector_pipeline_timer": 0.00012199152349477412}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00017848596935650632, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.998619231498522e-06, "add_observations_from_episodes_to_batch": 3.2926107326623984e-06, "add_time_dim_to_batch_and_zero_pad": 2.490499562836526e-06, "add_states_from_episodes_to_batch": 1.6699838466696536e-06, "numpy_to_tensor": 1.0364970931411545e-05}}, "connector_pipeline_timer": 4.848235151122744e-05}, "episode_return_mean": 0.0, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004734800816513598, "num_episodes_lifetime": 320, "episode_len_min": 20, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 80400, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_len_max": 20, "sample": 0.10111752433337723, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.0}, "episode_return_min": -14.5, "env_step_timer": 1.815558658329644e-05, "module_episode_returns_mean": {"default_policy": 0.0}, "time_between_sampling": 1.6468231790763135}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-45", "timestamp": 1754933085, "time_this_iter_s": 1.795914888381958, "time_total_s": 27.2740159034729, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.2740159034729, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 48.36666666666667, "ram_util_percent": 78.63333333333334}}
{"timers": {"training_iteration": 1.7198471188535807, "restore_env_runners": 9.505499110900838e-06, "training_step": 1.7196856489792152, "env_runner_sampling_timer": 1.6072316076934279, "learner_update_timer": 0.10916717421450511, "synch_weights": 0.0006051027289178411, "restore_eval_env_runners": 8.247938902846525e-06, "evaluation_iteration": 0.10808806610731937, "synch_eval_env_connectors": 0.0001311262120249077, "synch_env_connectors": 4.713785670779264e-06}, "env_runners": {"env_step_timer": 1.7987274659494095e-05, "agent_episode_returns_mean": {"default_agent": 6.9}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9770505293382356e-06, "numpy_to_tensor": 1.1246750670594216e-05, "batch_individual_items": 8.44341773996505e-06, "add_observations_from_episodes_to_batch": 3.5926293568150688e-06, "add_time_dim_to_batch_and_zero_pad": 2.834976585783662e-06}}, "connector_pipeline_timer": 5.3385664950182174e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7359556561182674e-05, "normalize_and_clip_actions": 1.1692297658684285e-05, "listify_data_for_vector_env": 1.3833140398723105e-05, "remove_single_ts_time_rank_from_batch": 7.120767662497987e-07, "get_actions": 5.544277995941142e-05, "un_batch_to_individual_items": 6.530231425511029e-06}}, "connector_pipeline_timer": 0.00013703428544877905}, "env_reset_timer": 5.932782723191568e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.9}, "time_between_sampling": 0.0018718025379305366, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_mean": 6.9, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 6.026937754925927e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_max": 20, "weights_seq_no": 16.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "sample": 0.006714342588654321, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.006374029648955912, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime_throughput": 3105.3253189858187}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008208097500130229, "add_time_dim_to_batch_and_zero_pad": 1.3796410096906634e-05, "add_columns_from_episodes_to_train_batch": 0.03457991855374294, "numpy_to_tensor": 7.176987194150321e-05, "general_advantage_estimation": 0.006826881074316669, "batch_individual_items": 0.034463101113956146, "add_one_ts_to_episodes_and_truncate": 0.008362029033671885, "add_states_from_episodes_to_batch": 1.3218826190496648e-05}}, "connector_pipeline_timer": 0.08528377136625434}, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2349431.0697465693, "num_module_steps_trained_throughput": 449141.8948293113, "num_module_steps_trained_lifetime_throughput": 448457.2576788886}, "default_policy": {"total_loss": -0.027786191552877426, "curr_kl_coeff": 5.695314939657692e-06, "gradients_default_optimizer_global_norm": 0.06734903156757355, "vf_loss_unclipped": 27.776878356933594, "vf_loss": 0.10278083384037018, "vf_explained_var": 0.011242687702178955, "num_module_steps_trained": 6000, "entropy": 0.4231090247631073, "weights_seq_no": 17.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.09269465506076813, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 102000, "mean_kl_loss": 8.43530724523589e-05, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 449502.914568332}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 6800}, "rlmodule_inference_timer": 2.6353579452280165e-05, "weights_seq_no": 17.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.314106323521021e-06, "get_actions": 3.476505625327148e-05, "remove_single_ts_time_rank_from_batch": 5.69426015932605e-07, "tensor_to_numpy": 1.2603225020422747e-05, "listify_data_for_vector_env": 1.0827261786738381e-05, "un_batch_to_individual_items": 5.373403867001625e-06}}, "connector_pipeline_timer": 9.894537911708512e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00017742777992255107, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.02628044961663e-06, "add_observations_from_episodes_to_batch": 2.7863551565431286e-06, "add_time_dim_to_batch_and_zero_pad": 2.16044056275722e-06, "add_states_from_episodes_to_batch": 1.56232835144933e-06, "numpy_to_tensor": 8.1142415816375e-06}}, "connector_pipeline_timer": 4.188883274569208e-05}, "episode_return_mean": -0.2, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.0047365733457263555, "num_episodes_lifetime": 340, "episode_len_min": 20, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 85400, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_len_max": 20, "sample": 0.10108676159025543, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.2}, "episode_return_min": -14.5, "env_step_timer": 1.37681026816723e-05, "module_episode_returns_mean": {"default_policy": -0.2}, "time_between_sampling": 1.651129163535834}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-47", "timestamp": 1754933087, "time_this_iter_s": 2.1540679931640625, "time_total_s": 29.428083896636963, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.428083896636963, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.70000000000001, "ram_util_percent": 80.33333333333334}}
{"timers": {"training_iteration": 1.7238490497448935, "restore_env_runners": 9.465024279277168e-06, "training_step": 1.7236872787397826, "env_runner_sampling_timer": 1.610241086616732, "learner_update_timer": 0.11014480664337836, "synch_weights": 0.0006049900308969096, "restore_eval_env_runners": 8.247549778004322e-06, "evaluation_iteration": 0.10803782669562718, "synch_eval_env_connectors": 0.00013088454012116118, "synch_env_connectors": 4.704978722936208e-06}, "env_runners": {"env_step_timer": 1.8197421295585215e-05, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0053011795690975e-06, "numpy_to_tensor": 1.2300329801941022e-05, "batch_individual_items": 7.99831523455639e-06, "add_observations_from_episodes_to_batch": 6.343734192254862e-06, "add_time_dim_to_batch_and_zero_pad": 3.082533941814043e-06}}, "connector_pipeline_timer": 5.7043372431620424e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1984198004692833e-05, "normalize_and_clip_actions": 1.2203980288078888e-05, "listify_data_for_vector_env": 1.5353155845680267e-05, "remove_single_ts_time_rank_from_batch": 7.259556398439698e-07, "get_actions": 5.940006512256266e-05, "un_batch_to_individual_items": 9.188226901884555e-06}}, "connector_pipeline_timer": 0.00014977398878901713}, "env_reset_timer": 5.100957874090182e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "time_between_sampling": 0.0016759909908248105, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_mean": 7.059999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.840528890363862e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_max": 20, "weights_seq_no": 17.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "sample": 0.006446357360184797, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.006373954314738513, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime_throughput": 3300.127374311286}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008218083128376003, "add_time_dim_to_batch_and_zero_pad": 1.3783445783596021e-05, "add_columns_from_episodes_to_train_batch": 0.03460544727831214, "numpy_to_tensor": 7.16867531413668e-05, "general_advantage_estimation": 0.006821721853546967, "batch_individual_items": 0.03552498969276226, "add_one_ts_to_episodes_and_truncate": 0.008353995822962604, "add_states_from_episodes_to_batch": 1.311830755274148e-05}}, "connector_pipeline_timer": 0.08635871073199147}, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2338065.975319756, "num_module_steps_trained_throughput": 446901.1349888835, "num_module_steps_trained_lifetime_throughput": 446242.24035277136}, "default_policy": {"total_loss": -0.06480350345373154, "curr_kl_coeff": 2.847657469828846e-06, "gradients_default_optimizer_global_norm": 0.08864210546016693, "vf_loss_unclipped": 27.705440521240234, "vf_loss": 0.10278083384037018, "vf_explained_var": 0.01639944314956665, "num_module_steps_trained": 6000, "entropy": 0.43428218364715576, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.1296107918024063, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 108000, "mean_kl_loss": 0.00011860190716106445, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 447192.9421633056}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 7200}, "rlmodule_inference_timer": 2.797382372308269e-05, "weights_seq_no": 18.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.726033204565446e-06, "get_actions": 3.6407049122387756e-05, "remove_single_ts_time_rank_from_batch": 6.040155195732552e-07, "tensor_to_numpy": 1.3299085156513667e-05, "listify_data_for_vector_env": 1.1222195882577821e-05, "un_batch_to_individual_items": 5.689007706437648e-06}}, "connector_pipeline_timer": 0.00010301874638026743}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00017642892246310364, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.235535135279066e-06, "add_observations_from_episodes_to_batch": 2.869688622526949e-06, "add_time_dim_to_batch_and_zero_pad": 2.259618345811641e-06, "add_states_from_episodes_to_batch": 1.6169185233146163e-06, "numpy_to_tensor": 8.552230766391185e-06}}, "connector_pipeline_timer": 4.334269037191764e-05}, "episode_return_mean": -0.4, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.004773742944234982, "num_episodes_lifetime": 360, "episode_len_min": 20, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 90400, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_len_max": 20, "sample": 0.10113704481460364, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.4}, "episode_return_min": -12.5, "env_step_timer": 1.4414620918247697e-05, "module_episode_returns_mean": {"default_policy": -0.4}, "time_between_sampling": 1.656024608570072}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-49", "timestamp": 1754933089, "time_this_iter_s": 2.236039876937866, "time_total_s": 31.66412377357483, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.66412377357483, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 61.4, "ram_util_percent": 79.89999999999999}}
{"timers": {"training_iteration": 1.7229492309168084, "restore_env_runners": 9.42704385099653e-06, "training_step": 1.7227870713620017, "env_runner_sampling_timer": 1.6085825236706117, "learner_update_timer": 0.11090473816706288, "synch_weights": 0.0006046297105814269, "restore_eval_env_runners": 8.230074775166349e-06, "evaluation_iteration": 0.1080908171785409, "synch_eval_env_connectors": 0.0001329436051143946, "synch_env_connectors": 4.695429803326956e-06}, "env_runners": {"env_step_timer": 1.4864118337206176e-05, "agent_episode_returns_mean": {"default_agent": 6.74}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8233609300312834e-06, "numpy_to_tensor": 9.122055536749638e-06, "batch_individual_items": 6.567277865977069e-06, "add_observations_from_episodes_to_batch": 3.11298483346899e-06, "add_time_dim_to_batch_and_zero_pad": 2.487492915378098e-06}}, "connector_pipeline_timer": 4.560390287337154e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.379344383277248e-05, "normalize_and_clip_actions": 9.908628040462605e-06, "listify_data_for_vector_env": 1.1699895357681386e-05, "remove_single_ts_time_rank_from_batch": 6.100844330486519e-07, "get_actions": 4.172201952639937e-05, "un_batch_to_individual_items": 5.701143671465301e-06}}, "connector_pipeline_timer": 0.00011010763075505417}, "env_reset_timer": 4.4456134661624356e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.74}, "time_between_sampling": 0.002052246392273851, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_mean": 6.74, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.990160320099349e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_max": 20, "weights_seq_no": 18.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "sample": 0.005837351531664838, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.004756656980607661, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime_throughput": 3540.964594887771}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008217598192734285, "add_time_dim_to_batch_and_zero_pad": 1.3807702199105794e-05, "add_columns_from_episodes_to_train_batch": 0.03460806738481969, "numpy_to_tensor": 7.16452958750561e-05, "general_advantage_estimation": 0.006806955054811853, "batch_individual_items": 0.03640932187599583, "add_one_ts_to_episodes_and_truncate": 0.008346717114802343, "add_states_from_episodes_to_batch": 1.3019203883296695e-05}}, "connector_pipeline_timer": 0.08722321362477758}, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2329821.8651392316, "num_module_steps_trained_throughput": 445261.0438462715, "num_module_steps_trained_lifetime_throughput": 444625.8095376848}, "default_policy": {"total_loss": 0.005777741316705942, "curr_kl_coeff": 1.423828734914423e-06, "gradients_default_optimizer_global_norm": 0.13775816559791565, "vf_loss_unclipped": 27.868133544921875, "vf_loss": 0.10278083384037018, "vf_explained_var": 0.007687926292419434, "num_module_steps_trained": 6000, "entropy": 0.41222673654556274, "weights_seq_no": 19.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.059229280799627304, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 114000, "mean_kl_loss": 0.000583978951908648, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 445489.7635348241}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 7600}, "rlmodule_inference_timer": 2.9985538854444e-05, "weights_seq_no": 19.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0354655770500137e-05, "get_actions": 4.1136870027365195e-05, "remove_single_ts_time_rank_from_batch": 6.140187087079619e-07, "tensor_to_numpy": 1.432012475104392e-05, "listify_data_for_vector_env": 1.1809376423463673e-05, "un_batch_to_individual_items": 5.841027140751883e-06}}, "connector_pipeline_timer": 0.00011119145229155986}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00017610046372913625, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.680527032517815e-06, "add_observations_from_episodes_to_batch": 3.1173943964181285e-06, "add_time_dim_to_batch_and_zero_pad": 2.373850287979712e-06, "add_states_from_episodes_to_batch": 1.6369376573916734e-06, "numpy_to_tensor": 9.790399876774564e-06}}, "connector_pipeline_timer": 4.643678534585876e-05}, "episode_return_mean": -0.4, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.0048171162430662665, "num_episodes_lifetime": 380, "episode_len_min": 20, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 95400, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_len_max": 20, "sample": 0.10119701519582443, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.4}, "episode_return_min": -14.5, "env_step_timer": 1.666977324832145e-05, "module_episode_returns_mean": {"default_policy": -0.4}, "time_between_sampling": 1.6560152612342183}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-51", "timestamp": 1754933091, "time_this_iter_s": 1.7494137287139893, "time_total_s": 33.41353750228882, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.41353750228882, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 54.55, "ram_util_percent": 80.75}}
{"timers": {"training_iteration": 1.7543667523578006, "restore_env_runners": 9.392364087423336e-06, "training_step": 1.7542024977381112, "env_runner_sampling_timer": 1.6378796367642001, "learner_update_timer": 0.11295999912544812, "synch_weights": 0.0006254238332169601, "restore_eval_env_runners": 8.214023658759957e-06, "evaluation_iteration": 0.10814080233614674, "synch_eval_env_connectors": 0.00013263249812109313, "synch_env_connectors": 4.692645806701262e-06}, "env_runners": {"env_step_timer": 4.438952999381724e-05, "agent_episode_returns_mean": {"default_agent": 6.5}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 5.179062569817918e-06, "numpy_to_tensor": 3.350094889171809e-05, "batch_individual_items": 1.8226885124931917e-05, "add_observations_from_episodes_to_batch": 8.967718569784349e-06, "add_time_dim_to_batch_and_zero_pad": 6.888438166928011e-06}}, "connector_pipeline_timer": 0.00013248587815606135}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.313577345209245e-05, "normalize_and_clip_actions": 2.8342467578504968e-05, "listify_data_for_vector_env": 3.0091955037278123e-05, "remove_single_ts_time_rank_from_batch": 1.4177167162281937e-06, "get_actions": 0.0001557653261522911, "un_batch_to_individual_items": 1.3071980439815593e-05}}, "connector_pipeline_timer": 0.0003446342666345951}, "env_reset_timer": 9.640217911114938e-05, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.5}, "time_between_sampling": 0.0023597157963096017, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_mean": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 9.603434066999967e-05, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_max": 20, "weights_seq_no": 19.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "sample": 0.010347689703916753, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "episode_return_min": -11.5, "episode_duration_sec_mean": 0.015296812961343678, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime_throughput": 1921.6227721505263}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010458851404154634, "add_time_dim_to_batch_and_zero_pad": 1.4331704723715317e-05, "add_columns_from_episodes_to_train_batch": 0.03541513921101791, "numpy_to_tensor": 7.199842265542913e-05, "general_advantage_estimation": 0.006933284253417795, "batch_individual_items": 0.03658990448682338, "add_one_ts_to_episodes_and_truncate": 0.008852642444351024, "add_states_from_episodes_to_batch": 1.319485235720136e-05}}, "connector_pipeline_timer": 0.0890709181585668}, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2302417.3306529154, "num_module_steps_trained_throughput": 439985.14835729805, "num_module_steps_trained_lifetime_throughput": 439370.63165802986}, "default_policy": {"total_loss": 0.03251373767852783, "curr_kl_coeff": 7.119143674572115e-07, "gradients_default_optimizer_global_norm": 0.04194527864456177, "vf_loss_unclipped": 27.988771438598633, "vf_loss": 0.10278083384037018, "vf_explained_var": 0.004387497901916504, "num_module_steps_trained": 6000, "entropy": 0.37009090185165405, "weights_seq_no": 20.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0328749418258667, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 120000, "mean_kl_loss": 0.001483448431827128, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 440165.7234801439}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 8000}, "rlmodule_inference_timer": 0.00012394460814536002, "weights_seq_no": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.104115530592504e-05, "get_actions": 0.00015879521727989504, "remove_single_ts_time_rank_from_batch": 1.4392731737046782e-06, "tensor_to_numpy": 4.476223683638715e-05, "listify_data_for_vector_env": 3.380891890926819e-05, "un_batch_to_individual_items": 1.4075930191662918e-05}}, "connector_pipeline_timer": 0.00035299944531378503}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00018040029918816957, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.7527009131282105e-05, "add_observations_from_episodes_to_batch": 9.369410892142215e-06, "add_time_dim_to_batch_and_zero_pad": 9.591082082947019e-06, "add_states_from_episodes_to_batch": 4.38420699558088e-06, "numpy_to_tensor": 6.0752606422137675e-05}}, "connector_pipeline_timer": 0.00019569452153937934}, "episode_return_mean": -0.6, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.007344614551402629, "num_episodes_lifetime": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 100400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_max": 20, "sample": 0.10398979504399285, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.6}, "episode_return_min": -14.5, "env_step_timer": 5.5651896178247876e-05, "module_episode_returns_mean": {"default_policy": -0.6}, "time_between_sampling": 1.688747652371201}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "43c26_00000", "date": "2025-08-11_19-24-56", "timestamp": 1754933096, "time_this_iter_s": 5.3047308921813965, "time_total_s": 38.718268394470215, "pid": 14500, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x148a49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.718268394470215, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 90.0375, "ram_util_percent": 82.78750000000001}}
