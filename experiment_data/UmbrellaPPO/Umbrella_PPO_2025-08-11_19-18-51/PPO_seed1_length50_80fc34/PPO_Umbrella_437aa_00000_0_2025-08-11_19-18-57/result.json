{"timers": {"training_iteration": 1.7863994169747457, "restore_env_runners": 1.3291952200233936e-05, "training_step": 1.7862440419849008, "env_runner_sampling_timer": 1.650366083951667, "learner_update_timer": 0.13230787497013807, "synch_weights": 0.000823916052468121}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.973976466773112e-06, "add_observations_from_episodes_to_batch": 3.5340322785976367e-06, "add_time_dim_to_batch_and_zero_pad": 2.9436984279227346e-06, "numpy_to_tensor": 1.0217911845651278e-05, "batch_individual_items": 7.455339792506309e-06}}, "connector_pipeline_timer": 5.155095634795604e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_min": 20, "num_env_steps_sampled_lifetime": 627500.0, "time_between_sampling": 0.0006940390630701234, "env_step_timer": 1.688020703287448e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4850651556122986e-05, "un_batch_to_individual_items": 6.1541351710019065e-06, "remove_single_ts_time_rank_from_batch": 6.496043001865955e-07, "normalize_and_clip_actions": 1.3955214872662788e-05, "listify_data_for_vector_env": 1.2450351568652677e-05, "get_actions": 5.293002718589009e-05}}, "connector_pipeline_timer": 0.0001299958679931236}, "module_episode_returns_mean": {"default_policy": -0.09999999999999998}, "episode_duration_sec_mean": 0.005523697334807366, "episode_len_mean": 20.0, "episode_return_mean": -0.09999999999999998, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "rlmodule_inference_timer": 5.540042901561915e-05, "env_reset_timer": 8.338617858091829e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 31375.0, "agent_episode_returns_mean": {"default_agent": -0.09999999999999998}, "sample": 0.0063417040808928194, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3116.127515022735}, "learners": {"default_policy": {"mean_kl_loss": 6.952471449039876e-05, "total_loss": 0.015051513910293579, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0474664680659771, "vf_explained_var": -0.011646151542663574, "entropy": 0.6927757263183594, "gradients_default_optimizer_global_norm": 0.026657981798052788, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 6000, "weights_seq_no": 1.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.3732481598854065, "vf_loss_unclipped": 28.586095809936523, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 368911.21485593513}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.042056389153004e-06, "add_one_ts_to_episodes_and_truncate": 0.008363250060938299, "add_time_dim_to_batch_and_zero_pad": 1.4209072105586529e-05, "add_columns_from_episodes_to_train_batch": 0.03680670796893537, "numpy_to_tensor": 0.0001236669486388564, "general_advantage_estimation": 0.010416709003038704, "batch_individual_items": 0.03634612506721169, "add_observations_from_episodes_to_batch": 0.0009672080632299185}}, "connector_pipeline_timer": 0.09326795802917331}, "learner_connector_sum_episodes_length_out": 5250, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1923760.2659116383, "num_module_steps_trained_throughput": 367920.69475342944, "num_module_steps_trained_lifetime_throughput": 367437.323318725}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -1.8}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011860307614857912, "timers": {"connectors": {"tensor_to_numpy": 1.5933927322540433e-05, "remove_single_ts_time_rank_from_batch": 5.999289850026928e-07, "un_batch_to_individual_items": 5.6413018722447795e-06, "listify_data_for_vector_env": 1.2389890835278162e-05, "get_actions": 4.4694626158894404e-05, "normalize_and_clip_actions": 1.1485556710916898e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.634673440856593e-06, "add_observations_from_episodes_to_batch": 3.2677907774509e-06, "add_states_from_episodes_to_batch": 1.71449345012574e-06, "add_time_dim_to_batch_and_zero_pad": 2.5311597628292545e-06, "numpy_to_tensor": 9.269577868973834e-06}}, "connector_pipeline_timer": 4.8482826607862157e-05}, "num_env_steps_sampled_lifetime": 5400, "num_episodes": 20, "episode_return_max": 11.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_step_timer": 1.5794417240456593e-05, "num_env_steps_sampled": 400, "episode_return_mean": -1.8, "rlmodule_inference_timer": 3.2085509022745085e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "sample": 0.1125015839934349, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005142443685326725, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "env_reset_timer": 0.00017504196148365736, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.216013141322508, "module_episode_returns_mean": {"default_policy": -1.8}, "num_episodes_lifetime": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-08", "timestamp": 1754932808, "time_this_iter_s": 1.9078409671783447, "time_total_s": 1.9078409671783447, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.9078409671783447, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.266666666666666, "ram_util_percent": 81.43333333333334}}
{"timers": {"training_iteration": 1.7853386253048666, "restore_env_runners": 1.3252781936898827e-05, "training_step": 1.7851825919852127, "env_runner_sampling_timer": 1.6486869276931975, "learner_update_timer": 0.13292731830035334, "synch_weights": 0.0008218652219511569, "restore_eval_env_runners": 1.0707997716963291e-05, "evaluation_iteration": 0.1197494170628488, "synch_eval_env_connectors": 0.00013445806689560413, "synch_env_connectors": 7.6249707490205765e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.838217789093074e-06, "add_observations_from_episodes_to_batch": 3.10383358774257e-06, "add_time_dim_to_batch_and_zero_pad": 2.6810176914326464e-06, "numpy_to_tensor": 9.109055770477058e-06, "batch_individual_items": 8.312407558289728e-06}}, "connector_pipeline_timer": 4.7697205551967775e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": 10000.0, "time_between_sampling": 0.0018523989476403973, "env_step_timer": 1.4986060451839996e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3764041167867303e-05, "un_batch_to_individual_items": 5.692838530511679e-06, "remove_single_ts_time_rank_from_batch": 6.185159313307798e-07, "normalize_and_clip_actions": 9.980393956691672e-06, "listify_data_for_vector_env": 1.1816583757164085e-05, "get_actions": 4.29925656871436e-05}}, "connector_pipeline_timer": 0.00011189143938087737}, "module_episode_returns_mean": {"default_policy": -0.8199999999999998}, "episode_duration_sec_mean": 0.004875714004039764, "episode_len_mean": 20.0, "episode_return_mean": -0.8199999999999998, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "rlmodule_inference_timer": 2.9540229418395e-05, "env_reset_timer": 4.758445430954215e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 500.0, "agent_episode_returns_mean": {"default_agent": -0.8199999999999998}, "sample": 0.005766754488758498, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3585.201959194951}, "learners": {"default_policy": {"mean_kl_loss": 0.0015428205952048302, "total_loss": 0.08293826133012772, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.01986965350806713, "vf_explained_var": -0.012287616729736328, "entropy": 0.6898306608200073, "gradients_default_optimizer_global_norm": 0.09095917642116547, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 12000, "weights_seq_no": 2.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.18662407994270325, "vf_loss_unclipped": 28.918132781982422, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 368860.5331285726}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.037464968860149e-06, "add_one_ts_to_episodes_and_truncate": 0.00835443880991079, "add_time_dim_to_batch_and_zero_pad": 1.418073195964098e-05, "add_columns_from_episodes_to_train_batch": 0.03677689421921969, "numpy_to_tensor": 0.00012303485884331168, "general_advantage_estimation": 0.010366839412599803, "batch_individual_items": 0.037292300066910686, "add_observations_from_episodes_to_batch": 0.0009654180728830397}}, "connector_pipeline_timer": 0.09412188802845775}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1923698.8476867378, "num_module_steps_trained_throughput": 367892.15133568016, "num_module_steps_trained_lifetime_throughput": 367413.08959597186}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -2.3}, "module_to_env_connector": {"connector_pipeline_timer": 9.982281149416923e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2984659461880758e-05, "remove_single_ts_time_rank_from_batch": 5.73106561999919e-07, "un_batch_to_individual_items": 5.260354569033411e-06, "listify_data_for_vector_env": 1.0692601459159431e-05, "get_actions": 3.5704396069205206e-05, "normalize_and_clip_actions": 9.35702461554268e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.035237624909984e-06, "add_observations_from_episodes_to_batch": 2.8006748085700055e-06, "add_states_from_episodes_to_batch": 1.5918281855040384e-06, "add_time_dim_to_batch_and_zero_pad": 2.1799930518343446e-06, "numpy_to_tensor": 8.241846112302922e-06}}, "connector_pipeline_timer": 4.232418192524497e-05}, "num_env_steps_sampled_lifetime": 10400, "num_episodes": 20, "episode_return_max": 11.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_step_timer": 1.3711934628008467e-05, "num_env_steps_sampled": 400, "episode_return_mean": -2.3, "rlmodule_inference_timer": 2.704386990317919e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "sample": 0.11235994523391127, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004824585365713574, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "env_reset_timer": 0.00017444988247007132, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.366003441359926, "module_episode_returns_mean": {"default_policy": -2.3}, "num_episodes_lifetime": 40, "time_between_sampling": 1.748420082964003}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-10", "timestamp": 1754932810, "time_this_iter_s": 1.7860889434814453, "time_total_s": 3.69392991065979, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.69392991065979, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 48.26666666666667, "ram_util_percent": 81.16666666666666}}
{"timers": {"training_iteration": 1.7842863511318108, "restore_env_runners": 1.318525344831869e-05, "training_step": 1.7841298798158183, "env_runner_sampling_timer": 1.647781498416362, "learner_update_timer": 0.13278004219791617, "synch_weights": 0.000820421990356408, "restore_eval_env_runners": 1.0708417976275086e-05, "evaluation_iteration": 0.11958899164223112, "synch_eval_env_connectors": 0.00013413807610049842, "synch_env_connectors": 7.59163056500256e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.908103682951748e-06, "add_observations_from_episodes_to_batch": 3.3128984391171913e-06, "add_time_dim_to_batch_and_zero_pad": 2.8141099238110387e-06, "numpy_to_tensor": 9.78360549092941e-06, "batch_individual_items": 7.155726488978958e-06}}, "connector_pipeline_timer": 4.872116206088773e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -607500.0, "time_between_sampling": 0.0019578816352971433, "env_step_timer": 1.5762755044464305e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4523781945951743e-05, "un_batch_to_individual_items": 5.946001387781403e-06, "remove_single_ts_time_rank_from_batch": 6.607123306391085e-07, "normalize_and_clip_actions": 1.054962435423236e-05, "listify_data_for_vector_env": 1.2290552998529758e-05, "get_actions": 4.3939300120400896e-05}}, "connector_pipeline_timer": 0.00011576417411864833}, "module_episode_returns_mean": {"default_policy": 0.22}, "episode_duration_sec_mean": 0.00509226449439302, "episode_len_mean": 20.0, "episode_return_mean": 0.22, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "rlmodule_inference_timer": 3.0935569113686544e-05, "env_reset_timer": 4.6949387359245964e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -30375.0, "agent_episode_returns_mean": {"default_agent": 0.22}, "sample": 0.005389010225896298, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3343.7227727923305}, "learners": {"default_policy": {"mean_kl_loss": 0.0014687618240714073, "total_loss": 0.11864931136369705, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.05581562593579292, "vf_explained_var": -0.014024496078491211, "entropy": 0.6824526190757751, "gradients_default_optimizer_global_norm": 0.04352671653032303, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 18000, "weights_seq_no": 3.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.09331203997135162, "vf_loss_unclipped": 28.84691619873047, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 367992.01913256105}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.034169763326645e-06, "add_one_ts_to_episodes_and_truncate": 0.008352137762203348, "add_time_dim_to_batch_and_zero_pad": 1.43064237665385e-05, "add_columns_from_episodes_to_train_batch": 0.036784206106280914, "numpy_to_tensor": 0.00012348242058651522, "general_advantage_estimation": 0.010350613109208644, "batch_individual_items": 0.0373140533159487, "add_observations_from_episodes_to_batch": 0.0009652634720550849}}, "connector_pipeline_timer": 0.09413217831887304}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1919483.0883297606, "num_module_steps_trained_throughput": 367057.1487264112, "num_module_steps_trained_lifetime_throughput": 366587.1962234595}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -2.1333333333333333}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010632983169247185, "timers": {"connectors": {"tensor_to_numpy": 1.3716836137833052e-05, "remove_single_ts_time_rank_from_batch": 5.829958018097544e-07, "un_batch_to_individual_items": 5.4681144948955074e-06, "listify_data_for_vector_env": 1.1204870784388347e-05, "get_actions": 3.911886847718258e-05, "normalize_and_clip_actions": 9.753028937934432e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.398745528513155e-06, "add_observations_from_episodes_to_batch": 2.880147529244088e-06, "add_states_from_episodes_to_batch": 1.5854576527067156e-06, "add_time_dim_to_batch_and_zero_pad": 2.250831088777489e-06, "numpy_to_tensor": 8.821036725512126e-06}}, "connector_pipeline_timer": 4.4011696400824014e-05}, "num_env_steps_sampled_lifetime": 15400, "num_episodes": 20, "episode_return_max": 11.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_step_timer": 1.51530794404717e-05, "num_env_steps_sampled": 400, "episode_return_mean": -2.1333333333333333, "rlmodule_inference_timer": 2.9329241348205045e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "sample": 0.11229511953154578, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004829069405483703, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "env_reset_timer": 0.00017353205350227656, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.368205581254823, "module_episode_returns_mean": {"default_policy": -2.1333333333333333}, "num_episodes_lifetime": 60, "time_between_sampling": 1.7479241408850066}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-12", "timestamp": 1754932812, "time_this_iter_s": 1.7933869361877441, "time_total_s": 5.487316846847534, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.487316846847534, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.8, "ram_util_percent": 81.35}}
{"timers": {"training_iteration": 1.786257832210324, "restore_env_runners": 1.312132110504899e-05, "training_step": 1.78610106768764, "env_runner_sampling_timer": 1.65014081676156, "learner_update_timer": 0.13239620802657082, "synch_weights": 0.0008177294305816758, "restore_eval_env_runners": 1.0736753919627518e-05, "evaluation_iteration": 0.11950470297582214, "synch_eval_env_connectors": 0.00013384377548936754, "synch_env_connectors": 7.560294342692941e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.051937119190802e-06, "add_observations_from_episodes_to_batch": 3.748647307935147e-06, "add_time_dim_to_batch_and_zero_pad": 3.1177040176951073e-06, "numpy_to_tensor": 1.123820262438724e-05, "batch_individual_items": 8.111019126546313e-06}}, "connector_pipeline_timer": 5.419715449233344e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -1225000.0, "time_between_sampling": 0.002180106987025759, "env_step_timer": 1.7959502732199673e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.657488570135223e-05, "un_batch_to_individual_items": 6.470001299269026e-06, "remove_single_ts_time_rank_from_batch": 7.31613707265687e-07, "normalize_and_clip_actions": 1.1562285658426757e-05, "listify_data_for_vector_env": 1.3599692027981433e-05, "get_actions": 5.197521071644952e-05}}, "connector_pipeline_timer": 0.00013191683280979562}, "module_episode_returns_mean": {"default_policy": 1.8199999999999996}, "episode_duration_sec_mean": 0.005785296994261445, "episode_len_mean": 20.0, "episode_return_mean": 1.8199999999999996, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "rlmodule_inference_timer": 3.592481598532546e-05, "env_reset_timer": 5.777832809511238e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -61250.0, "agent_episode_returns_mean": {"default_agent": 1.8199999999999996}, "sample": 0.006015085688984538, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3013.2268076334844}, "learners": {"default_policy": {"mean_kl_loss": 0.0022027352824807167, "total_loss": 0.10210534930229187, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.03923654928803444, "vf_explained_var": -0.01594841480255127, "entropy": 0.6710050106048584, "gradients_default_optimizer_global_norm": 0.13250532746315002, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 24000, "weights_seq_no": 4.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.04665601998567581, "vf_loss_unclipped": 28.459375381469727, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 368581.4369451279}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.0388272441923615e-06, "add_one_ts_to_episodes_and_truncate": 0.008346005134504871, "add_time_dim_to_batch_and_zero_pad": 1.429085991764441e-05, "add_columns_from_episodes_to_train_batch": 0.036768339045448704, "numpy_to_tensor": 0.0001229434258932015, "general_advantage_estimation": 0.010311815728113056, "batch_individual_items": 0.03724274611251149, "add_observations_from_episodes_to_batch": 0.0009638129172509069}}, "connector_pipeline_timer": 0.09399692695517836}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1923021.7785080867, "num_module_steps_trained_throughput": 367692.8095607028, "num_module_steps_trained_lifetime_throughput": 367233.48764558777}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -1.05}, "module_to_env_connector": {"connector_pipeline_timer": 9.935779485054383e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2821917436080808e-05, "remove_single_ts_time_rank_from_batch": 6.255187565434543e-07, "un_batch_to_individual_items": 5.2645900731019364e-06, "listify_data_for_vector_env": 1.0623345086618211e-05, "get_actions": 3.562336723376211e-05, "normalize_and_clip_actions": 9.325357915026945e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.010324565254206e-06, "add_observations_from_episodes_to_batch": 2.7512187920093614e-06, "add_states_from_episodes_to_batch": 1.5306797426801033e-06, "add_time_dim_to_batch_and_zero_pad": 2.1219500658565445e-06, "numpy_to_tensor": 8.254623218814975e-06}}, "connector_pipeline_timer": 4.1887432211853236e-05}, "num_env_steps_sampled_lifetime": 20400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_step_timer": 1.3659040395124675e-05, "num_env_steps_sampled": 400, "episode_return_mean": -1.05, "rlmodule_inference_timer": 2.695775227504739e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "sample": 0.11215154417546372, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004744735907297582, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "env_reset_timer": 0.00017251882228394973, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.368237912813044, "module_episode_returns_mean": {"default_policy": -1.05}, "num_episodes_lifetime": 80, "time_between_sampling": 1.7504443628061794}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-14", "timestamp": 1754932814, "time_this_iter_s": 2.0867960453033447, "time_total_s": 7.574112892150879, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.574112892150879, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.13333333333333, "ram_util_percent": 82.3}}
{"timers": {"training_iteration": 1.7846131505587894, "restore_env_runners": 1.305510838894057e-05, "training_step": 1.784456223679801, "env_runner_sampling_timer": 1.648911979423783, "learner_update_timer": 0.1319848051172795, "synch_weights": 0.000815842966481985, "restore_eval_env_runners": 1.0723135639098474e-05, "evaluation_iteration": 0.11934226552591576, "synch_eval_env_connectors": 0.00013355783818173221, "synch_env_connectors": 7.528861700673587e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.780856714267766e-06, "add_observations_from_episodes_to_batch": 3.0746473606985888e-06, "add_time_dim_to_batch_and_zero_pad": 2.560413944453203e-06, "numpy_to_tensor": 9.076067693586797e-06, "batch_individual_items": 6.641208578444362e-06}}, "connector_pipeline_timer": 4.573286129218389e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -1842500.0, "time_between_sampling": 0.0017209252549286428, "env_step_timer": 1.4518797546412988e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3392576167404694e-05, "un_batch_to_individual_items": 5.548461734216013e-06, "remove_single_ts_time_rank_from_batch": 6.027523777869537e-07, "normalize_and_clip_actions": 9.75565023733988e-06, "listify_data_for_vector_env": 1.128338140976754e-05, "get_actions": 3.954187505667259e-05}}, "connector_pipeline_timer": 0.00010652901073916225}, "module_episode_returns_mean": {"default_policy": 3.66}, "episode_duration_sec_mean": 0.005073025458026678, "episode_len_mean": 20.0, "episode_return_mean": 3.66, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "rlmodule_inference_timer": 4.7936600473573645e-05, "env_reset_timer": 4.532007203427866e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -92125.0, "agent_episode_returns_mean": {"default_agent": 3.66}, "sample": 0.005426248571747335, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3574.2999601046968}, "learners": {"default_policy": {"mean_kl_loss": 0.003353710984811187, "total_loss": -0.026010937988758087, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08898680657148361, "vf_explained_var": -0.01769888401031494, "entropy": 0.6537670493125916, "gradients_default_optimizer_global_norm": 0.3231657147407532, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 30000, "weights_seq_no": 5.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.023328009992837906, "vf_loss_unclipped": 27.58094024658203, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 370273.0224460043}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.030518377833068e-06, "add_one_ts_to_episodes_and_truncate": 0.008336905083595086, "add_time_dim_to_batch_and_zero_pad": 1.4271701969723215e-05, "add_columns_from_episodes_to_train_batch": 0.036744170654834624, "numpy_to_tensor": 0.00012238190242434035, "general_advantage_estimation": 0.010272060491023065, "batch_individual_items": 0.03716444573151025, "add_observations_from_episodes_to_batch": 0.0009619260380194639}}, "connector_pipeline_timer": 0.09384185143514118}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1932408.1488934373, "num_module_steps_trained_throughput": 369439.1639748043, "num_module_steps_trained_lifetime_throughput": 368990.7131328094}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010695828260894523, "timers": {"connectors": {"tensor_to_numpy": 1.3728157139067534e-05, "remove_single_ts_time_rank_from_batch": 5.880471160651978e-07, "un_batch_to_individual_items": 5.5590528995502565e-06, "listify_data_for_vector_env": 1.1143942668353214e-05, "get_actions": 3.993700302796003e-05, "normalize_and_clip_actions": 9.969498350928616e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.271852871578139e-06, "add_observations_from_episodes_to_batch": 2.9705326466339337e-06, "add_states_from_episodes_to_batch": 1.5813382903446494e-06, "add_time_dim_to_batch_and_zero_pad": 2.2188203505161774e-06, "numpy_to_tensor": 8.67970376111099e-06}}, "connector_pipeline_timer": 4.34467121051394e-05}, "num_env_steps_sampled_lifetime": 25400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_step_timer": 1.4797883838665537e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.0, "rlmodule_inference_timer": 2.906574693172021e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "sample": 0.11205693706409559, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004731626636348665, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "env_reset_timer": 0.00017160447492670737, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.368238387501162, "module_episode_returns_mean": {"default_policy": 0.0}, "num_episodes_lifetime": 100, "time_between_sampling": 1.7493518991775108}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-16", "timestamp": 1754932816, "time_this_iter_s": 1.7316269874572754, "time_total_s": 9.305739879608154, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.305739879608154, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 57.666666666666664, "ram_util_percent": 81.60000000000001}}
{"timers": {"training_iteration": 1.7827124328026336, "restore_env_runners": 1.297914677776225e-05, "training_step": 1.782555096442793, "env_runner_sampling_timer": 1.6463589300498587, "learner_update_timer": 0.13263798914667507, "synch_weights": 0.0008139641178107431, "restore_eval_env_runners": 1.067465443902067e-05, "evaluation_iteration": 0.11922592704061254, "synch_eval_env_connectors": 0.00013316017963081828, "synch_env_connectors": 7.493573388246586e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7412531511407565e-06, "add_observations_from_episodes_to_batch": 2.960064659430549e-06, "add_time_dim_to_batch_and_zero_pad": 2.473715028289699e-06, "numpy_to_tensor": 8.625676250621429e-06, "batch_individual_items": 6.371881977334129e-06}}, "connector_pipeline_timer": 4.4228554916331416e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -2460000.0, "time_between_sampling": 0.0015425597007630864, "env_step_timer": 1.4031913299681355e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2948756157426974e-05, "un_batch_to_individual_items": 5.384478924133013e-06, "remove_single_ts_time_rank_from_batch": 5.881413100662257e-07, "normalize_and_clip_actions": 9.597684952105556e-06, "listify_data_for_vector_env": 1.1033055826482118e-05, "get_actions": 3.826641337182717e-05}}, "connector_pipeline_timer": 0.00010362388104881684}, "module_episode_returns_mean": {"default_policy": 3.98}, "episode_duration_sec_mean": 0.0045698653548024585, "episode_len_mean": 20.0, "episode_return_mean": 3.98, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "rlmodule_inference_timer": 2.8015723777740268e-05, "env_reset_timer": 3.733762874846994e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -123000.0, "agent_episode_returns_mean": {"default_agent": 3.98}, "sample": 0.0052264907817671106, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3698.6082057035455}, "learners": {"default_policy": {"mean_kl_loss": 0.00046910226228646934, "total_loss": -0.015575570054352283, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07849463820457458, "vf_explained_var": -0.018162131309509277, "entropy": 0.6439688205718994, "gradients_default_optimizer_global_norm": 0.053384359925985336, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 36000, "weights_seq_no": 6.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.011664004996418953, "vf_loss_unclipped": 27.55246925354004, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 371939.4767538085}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.026052815032377e-06, "add_one_ts_to_episodes_and_truncate": 0.008339673112392906, "add_time_dim_to_batch_and_zero_pad": 1.4283984966119238e-05, "add_columns_from_episodes_to_train_batch": 0.03673684644939984, "numpy_to_tensor": 0.00012193475404043144, "general_advantage_estimation": 0.010244106555535223, "batch_individual_items": 0.038089158364081596, "add_observations_from_episodes_to_batch": 0.0009611009482107603}}, "connector_pipeline_timer": 0.09473189542091492}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1941692.662993837, "num_module_steps_trained_throughput": 371164.8768014664, "num_module_steps_trained_lifetime_throughput": 370726.70356233115}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.2}, "module_to_env_connector": {"connector_pipeline_timer": 9.998931066337489e-05, "timers": {"connectors": {"tensor_to_numpy": 1.282940749390169e-05, "remove_single_ts_time_rank_from_batch": 5.647130168307142e-07, "un_batch_to_individual_items": 5.174273643757619e-06, "listify_data_for_vector_env": 1.0728287158634795e-05, "get_actions": 3.579819471594069e-05, "normalize_and_clip_actions": 9.396348200925256e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.015523152533772e-06, "add_observations_from_episodes_to_batch": 2.7421470747586788e-06, "add_states_from_episodes_to_batch": 1.5590038599268401e-06, "add_time_dim_to_batch_and_zero_pad": 2.1641391507290426e-06, "numpy_to_tensor": 8.139773192314573e-06}}, "connector_pipeline_timer": 4.199866122975171e-05}, "num_env_steps_sampled_lifetime": 30400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_step_timer": 1.384817072106866e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.2, "rlmodule_inference_timer": 2.6879437293107098e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "sample": 0.1119131756027738, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004595694541931153, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "env_reset_timer": 0.00017150927022585772, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.368238394470474, "module_episode_returns_mean": {"default_policy": -0.2}, "num_episodes_lifetime": 120, "time_between_sampling": 1.7480040293550745}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-18", "timestamp": 1754932818, "time_this_iter_s": 1.7009682655334473, "time_total_s": 11.006708145141602, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.006708145141602, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 50.15, "ram_util_percent": 81.35}}
{"timers": {"training_iteration": 1.7817657297242688, "restore_env_runners": 1.2911436108655277e-05, "training_step": 1.781608052147674, "env_runner_sampling_timer": 1.6457574515792723, "learner_update_timer": 0.13229630967514838, "synch_weights": 0.0008117940564298737, "restore_eval_env_runners": 1.0640407864604624e-05, "evaluation_iteration": 0.11907563818967104, "synch_eval_env_connectors": 0.0001329989976895534, "synch_env_connectors": 7.460298041433107e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.941449006707271e-06, "add_observations_from_episodes_to_batch": 3.355517464981396e-06, "add_time_dim_to_batch_and_zero_pad": 2.8540535344966435e-06, "numpy_to_tensor": 1.0159232156114164e-05, "batch_individual_items": 7.3781538469951456e-06}}, "connector_pipeline_timer": 4.980704853315307e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -3077500.0, "time_between_sampling": 0.001953780740432915, "env_step_timer": 1.614097631443268e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.508111461795636e-05, "un_batch_to_individual_items": 6.1023940329142295e-06, "remove_single_ts_time_rank_from_batch": 6.475168868657436e-07, "normalize_and_clip_actions": 1.0803415505381234e-05, "listify_data_for_vector_env": 1.2495009931754363e-05, "get_actions": 4.4805938473554763e-05}}, "connector_pipeline_timer": 0.00011849834614585256}, "module_episode_returns_mean": {"default_policy": 3.98}, "episode_duration_sec_mean": 0.005217290639877318, "episode_len_mean": 20.0, "episode_return_mean": 3.98, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "rlmodule_inference_timer": 3.177977722641186e-05, "env_reset_timer": 4.099885063380369e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -153875.0, "agent_episode_returns_mean": {"default_agent": 3.98}, "sample": 0.00523621327022291, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3375.7522691652484}, "learners": {"default_policy": {"mean_kl_loss": 0.0006850841455161572, "total_loss": 0.04111754521727562, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.02193720079958439, "vf_explained_var": -0.018402576446533203, "entropy": 0.6286616325378418, "gradients_default_optimizer_global_norm": 0.07997886091470718, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 42000, "weights_seq_no": 7.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0058320024982094765, "vf_loss_unclipped": 27.66732406616211, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 373569.95641181315}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.0195422528329e-06, "add_one_ts_to_episodes_and_truncate": 0.008341938471255703, "add_time_dim_to_batch_and_zero_pad": 1.4302394307026969e-05, "add_columns_from_episodes_to_train_batch": 0.03673553048580945, "numpy_to_tensor": 0.00012137915660649592, "general_advantage_estimation": 0.01019822923965644, "batch_individual_items": 0.03802736553033729, "add_observations_from_episodes_to_batch": 0.000959915768893577}}, "connector_pipeline_timer": 0.09462232605640603}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1950855.7037914179, "num_module_steps_trained_throughput": 372864.3274537877, "num_module_steps_trained_lifetime_throughput": 372436.6475595413}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.4}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010334291279184023, "timers": {"connectors": {"tensor_to_numpy": 1.3473945825548585e-05, "remove_single_ts_time_rank_from_batch": 5.774381556464157e-07, "un_batch_to_individual_items": 5.4266799741021645e-06, "listify_data_for_vector_env": 1.0851978745299644e-05, "get_actions": 3.7709282552080604e-05, "normalize_and_clip_actions": 9.601821135569222e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.119080152074629e-06, "add_observations_from_episodes_to_batch": 2.8020617145894905e-06, "add_states_from_episodes_to_batch": 1.5616126958574987e-06, "add_time_dim_to_batch_and_zero_pad": 2.218659690963119e-06, "numpy_to_tensor": 8.407119518715611e-06}}, "connector_pipeline_timer": 4.2599939447555525e-05}, "num_env_steps_sampled_lifetime": 35400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_step_timer": 1.4227128235149197e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.4, "rlmodule_inference_timer": 2.8045025571317985e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "sample": 0.11178326509738444, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004595637483289465, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "env_reset_timer": 0.0001706279277603786, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.368238394572801, "module_episode_returns_mean": {"default_policy": 0.4}, "num_episodes_lifetime": 140, "time_between_sampling": 1.7475969057315277}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-19", "timestamp": 1754932819, "time_this_iter_s": 1.7941241264343262, "time_total_s": 12.800832271575928, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.800832271575928, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 51.03333333333334, "ram_util_percent": 81.96666666666667}}
{"timers": {"training_iteration": 1.7801356436769284, "restore_env_runners": 1.2839411821392653e-05, "training_step": 1.7799776249569557, "env_runner_sampling_timer": 1.6444373262229994, "learner_update_timer": 0.13198878991810795, "synch_weights": 0.000810880276658328, "restore_eval_env_runners": 1.0677753425350477e-05, "evaluation_iteration": 0.11892346721776205, "synch_eval_env_connectors": 0.0001327310972899751, "synch_env_connectors": 7.427354283934545e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.802959350696738e-06, "add_observations_from_episodes_to_batch": 3.072688342869657e-06, "add_time_dim_to_batch_and_zero_pad": 2.534832015531344e-06, "numpy_to_tensor": 8.983696043119567e-06, "batch_individual_items": 6.5680698732871265e-06}}, "connector_pipeline_timer": 4.558622683131459e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -3695000.0, "time_between_sampling": 0.001613263690244954, "env_step_timer": 1.4421223052420599e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3420869691006592e-05, "un_batch_to_individual_items": 5.588514407506215e-06, "remove_single_ts_time_rank_from_batch": 6.139603525614475e-07, "normalize_and_clip_actions": 9.840372321089663e-06, "listify_data_for_vector_env": 1.1410010438233898e-05, "get_actions": 3.989113000039597e-05}}, "connector_pipeline_timer": 0.00010735721687845059}, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "episode_duration_sec_mean": 0.00504749129479751, "episode_len_mean": 20.0, "episode_return_mean": 3.339999999999999, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "rlmodule_inference_timer": 4.407590010267014e-05, "env_reset_timer": 4.229870310784833e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -184750.0, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "sample": 0.005548816000500515, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3611.8678885812333}, "learners": {"default_policy": {"mean_kl_loss": 0.0005429149605333805, "total_loss": -0.014293914660811424, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07748422771692276, "vf_explained_var": -0.018987655639648438, "entropy": 0.6131623983383179, "gradients_default_optimizer_global_norm": 0.016191862523555756, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 48000, "weights_seq_no": 8.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0029160012491047382, "vf_loss_unclipped": 27.65814781188965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 375108.50705149473}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.0122562776318275e-06, "add_one_ts_to_episodes_and_truncate": 0.008335500747220267, "add_time_dim_to_batch_and_zero_pad": 1.4278960331609855e-05, "add_columns_from_episodes_to_train_batch": 0.036709951020866854, "numpy_to_tensor": 0.00012131119448704475, "general_advantage_estimation": 0.01015223236773652, "batch_individual_items": 0.038020446035726456, "add_observations_from_episodes_to_batch": 0.0009612203601211033}}, "connector_pipeline_timer": 0.09453819154526}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1959532.531533279, "num_module_steps_trained_throughput": 374468.18233967765, "num_module_steps_trained_lifetime_throughput": 374053.0182875601}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.2}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011489473222438932, "timers": {"connectors": {"tensor_to_numpy": 1.4739418367920691e-05, "remove_single_ts_time_rank_from_batch": 6.088419404525339e-07, "un_batch_to_individual_items": 5.940387577787224e-06, "listify_data_for_vector_env": 1.185465421694223e-05, "get_actions": 4.305542309755637e-05, "normalize_and_clip_actions": 1.0509137573061508e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.616940839299818e-06, "add_observations_from_episodes_to_batch": 3.1355404215791125e-06, "add_states_from_episodes_to_batch": 1.625007224804035e-06, "add_time_dim_to_batch_and_zero_pad": 2.390718900032486e-06, "numpy_to_tensor": 9.694695219354905e-06}}, "connector_pipeline_timer": 4.6763693854709744e-05}, "num_env_steps_sampled_lifetime": 40400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_step_timer": 1.6704374513454436e-05, "num_env_steps_sampled": 400, "episode_return_mean": 1.2, "rlmodule_inference_timer": 3.257066074693551e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "sample": 0.1117706199456078, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004641614982392639, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "env_reset_timer": 0.00016975539871955428, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.3682383945743, "module_episode_returns_mean": {"default_policy": 1.2}, "num_episodes_lifetime": 160, "time_between_sampling": 1.746486892084505}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-21", "timestamp": 1754932821, "time_this_iter_s": 1.7368228435516357, "time_total_s": 14.537655115127563, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.537655115127563, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 40.1, "ram_util_percent": 81.1}}
{"timers": {"training_iteration": 1.7788228297398783, "restore_env_runners": 1.277101699589511e-05, "training_step": 1.778664383707535, "env_runner_sampling_timer": 1.6426221246307184, "learner_update_timer": 0.13249045284942707, "synch_weights": 0.0008093639746137805, "restore_eval_env_runners": 1.1149315568401001e-05, "evaluation_iteration": 0.1188918679656796, "synch_eval_env_connectors": 0.00013277628687266514, "synch_env_connectors": 7.403081121819868e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.78521519236034e-06, "add_observations_from_episodes_to_batch": 3.0506220093971727e-06, "add_time_dim_to_batch_and_zero_pad": 2.575927257564733e-06, "numpy_to_tensor": 9.345143776915071e-06, "batch_individual_items": 7.116337001673653e-06}}, "connector_pipeline_timer": 4.633045640369127e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -4312500.0, "time_between_sampling": 0.001628319653705614, "env_step_timer": 1.4525972383218025e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4021658371597835e-05, "un_batch_to_individual_items": 5.7737392935503245e-06, "remove_single_ts_time_rank_from_batch": 6.06132847462054e-07, "normalize_and_clip_actions": 9.719936130112909e-06, "listify_data_for_vector_env": 1.1357369818514069e-05, "get_actions": 4.075662957960439e-05}}, "connector_pipeline_timer": 0.00010855033668218594}, "module_episode_returns_mean": {"default_policy": 5.259999999999999}, "episode_duration_sec_mean": 0.00480987503193319, "episode_len_mean": 20.0, "episode_return_mean": 5.259999999999999, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "rlmodule_inference_timer": 3.0800482794321065e-05, "env_reset_timer": 4.034704268222038e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -215625.0, "agent_episode_returns_mean": {"default_agent": 5.259999999999999}, "sample": 0.005257334952551632, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3622.0009428395224}, "learners": {"default_policy": {"mean_kl_loss": 0.0004298215499147773, "total_loss": 0.12476349622011185, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06147141009569168, "vf_explained_var": -0.019598960876464844, "entropy": 0.6017114520072937, "gradients_default_optimizer_global_norm": 0.05883348360657692, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 54000, "weights_seq_no": 9.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0014580006245523691, "vf_loss_unclipped": 27.53458595275879, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 376510.65769390535}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.006723035276728e-06, "add_one_ts_to_episodes_and_truncate": 0.009214863659358506, "add_time_dim_to_batch_and_zero_pad": 1.4260329997328619e-05, "add_columns_from_episodes_to_train_batch": 0.036689000680730936, "numpy_to_tensor": 0.0001208139122070156, "general_advantage_estimation": 0.010105634624094886, "batch_individual_items": 0.03794430866482439, "add_observations_from_episodes_to_batch": 0.00095971774679138}}, "connector_pipeline_timer": 0.09527077629947492}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1967488.7248944463, "num_module_steps_trained_throughput": 375936.34731774486, "num_module_steps_trained_lifetime_throughput": 375533.1360240736}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.0}, "module_to_env_connector": {"connector_pipeline_timer": 9.985553443015823e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2714013252791905e-05, "remove_single_ts_time_rank_from_batch": 5.495468228421264e-07, "un_batch_to_individual_items": 5.193929157311486e-06, "listify_data_for_vector_env": 1.0661671327159309e-05, "get_actions": 3.6495231255348884e-05, "normalize_and_clip_actions": 9.26562465648711e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.95089836282121e-06, "add_observations_from_episodes_to_batch": 2.749245848957943e-06, "add_states_from_episodes_to_batch": 1.5395558179999778e-06, "add_time_dim_to_batch_and_zero_pad": 2.148903550452148e-06, "numpy_to_tensor": 8.08537218796016e-06}}, "connector_pipeline_timer": 4.1679018947729255e-05}, "num_env_steps_sampled_lifetime": 45400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_step_timer": 1.3646273087476578e-05, "num_env_steps_sampled": 400, "episode_return_mean": 1.0, "rlmodule_inference_timer": 2.6484319051194504e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "sample": 0.1116196299953923, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004630005849758163, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.00016888868458609253, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.0}, "num_episodes_lifetime": 180, "time_between_sampling": 1.7457125598231036}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-23", "timestamp": 1754932823, "time_this_iter_s": 1.7526659965515137, "time_total_s": 16.290321111679077, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.290321111679077, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.333333333333332, "ram_util_percent": 81.5}}
{"timers": {"training_iteration": 1.7772295168623895, "restore_env_runners": 1.2702476077407917e-05, "training_step": 1.7770706869610633, "env_runner_sampling_timer": 1.6405127429741486, "learner_update_timer": 0.1330073637411264, "synch_weights": 0.00080726366571884, "restore_eval_env_runners": 1.1110322382691152e-05, "evaluation_iteration": 0.11871852886542084, "synch_eval_env_connectors": 0.00013251811422044103, "synch_env_connectors": 7.371970311452823e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7707936405450842e-06, "add_observations_from_episodes_to_batch": 3.1693377771847667e-06, "add_time_dim_to_batch_and_zero_pad": 2.521554244823646e-06, "numpy_to_tensor": 9.110182444524477e-06, "batch_individual_items": 6.678894329495597e-06}}, "connector_pipeline_timer": 4.567083444641747e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -4930000.0, "time_between_sampling": 0.0018787989399175586, "env_step_timer": 1.4357695459828472e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3257457303343155e-05, "un_batch_to_individual_items": 5.613009638370978e-06, "remove_single_ts_time_rank_from_batch": 6.108557244420677e-07, "normalize_and_clip_actions": 9.66015656763872e-06, "listify_data_for_vector_env": 1.124773086756935e-05, "get_actions": 3.880362978985908e-05}}, "connector_pipeline_timer": 0.00010556337098413545}, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "episode_duration_sec_mean": 0.004694318813737483, "episode_len_mean": 20.0, "episode_return_mean": 5.100000000000001, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "rlmodule_inference_timer": 2.853002266471153e-05, "env_reset_timer": 3.8544701580605164e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -246500.0, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "sample": 0.0051197492632062145, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3686.5277453593067}, "learners": {"default_policy": {"mean_kl_loss": 5.7940360420616344e-05, "total_loss": 0.10759363323450089, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.044248078018426895, "vf_explained_var": -0.02006387710571289, "entropy": 0.5956794023513794, "gradients_default_optimizer_global_norm": 0.018817108124494553, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 60000, "weights_seq_no": 10.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0007290003122761846, "vf_loss_unclipped": 27.54096031188965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 377937.0731805685}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.9974860746033885e-06, "add_one_ts_to_episodes_and_truncate": 0.009200684602489516, "add_time_dim_to_batch_and_zero_pad": 1.4223557538121762e-05, "add_columns_from_episodes_to_train_batch": 0.03666540651377163, "numpy_to_tensor": 0.00012117036241400933, "general_advantage_estimation": 0.010064334948233947, "batch_individual_items": 0.038772273908113754, "add_observations_from_episodes_to_batch": 0.0009584822301988463}}, "connector_pipeline_timer": 0.09601759228647429}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1975540.514086205, "num_module_steps_trained_throughput": 377425.3580822901, "num_module_steps_trained_lifetime_throughput": 377032.9975026875}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010273237872674955, "timers": {"connectors": {"tensor_to_numpy": 1.3171506443833622e-05, "remove_single_ts_time_rank_from_batch": 5.679264556345854e-07, "un_batch_to_individual_items": 5.368640697634842e-06, "listify_data_for_vector_env": 1.0888946942930708e-05, "get_actions": 3.7821846186549307e-05, "normalize_and_clip_actions": 9.557738078838646e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.456829765043348e-06, "add_observations_from_episodes_to_batch": 2.9389924499536987e-06, "add_states_from_episodes_to_batch": 1.68409722133502e-06, "add_time_dim_to_batch_and_zero_pad": 2.2477800720233417e-06, "numpy_to_tensor": 8.681154805156514e-06}}, "connector_pipeline_timer": 4.390567899385203e-05}, "num_env_steps_sampled_lifetime": 50400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_step_timer": 1.541053788506652e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.0, "rlmodule_inference_timer": 2.793760280674683e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "sample": 0.11151335161589371, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004613188786897808, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.00016818479825558827, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.0}, "num_episodes_lifetime": 200, "time_between_sampling": 1.7446316346444903}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-25", "timestamp": 1754932825, "time_this_iter_s": 1.728041172027588, "time_total_s": 18.018362283706665, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.018362283706665, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 61.8, "ram_util_percent": 80.94999999999999}}
{"timers": {"training_iteration": 1.7747873516941315, "restore_env_runners": 1.2640861593508737e-05, "training_step": 1.7746278088414669, "env_runner_sampling_timer": 1.6383098147047614, "learner_update_timer": 0.13276344968386947, "synch_weights": 0.0008115564387003842, "restore_eval_env_runners": 1.1071300033679824e-05, "evaluation_iteration": 0.1185943110757862, "synch_eval_env_connectors": 0.00013227502280784372, "synch_env_connectors": 7.34534060601729e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7693856371366286e-06, "add_observations_from_episodes_to_batch": 3.012852276510766e-06, "add_time_dim_to_batch_and_zero_pad": 2.5269891820234586e-06, "numpy_to_tensor": 8.725665885643055e-06, "batch_individual_items": 6.4189972786862885e-06}}, "connector_pipeline_timer": 4.4519264922520755e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -5547500.0, "time_between_sampling": 0.0018920156333752409, "env_step_timer": 1.4097960628794497e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.306623620269716e-05, "un_batch_to_individual_items": 5.474089883342381e-06, "remove_single_ts_time_rank_from_batch": 5.994762926245436e-07, "normalize_and_clip_actions": 9.583220372788395e-06, "listify_data_for_vector_env": 1.116253870018008e-05, "get_actions": 3.821861863483789e-05}}, "connector_pipeline_timer": 0.00010419539161304055}, "module_episode_returns_mean": {"default_policy": 5.980000000000002}, "episode_duration_sec_mean": 0.004619966838508844, "episode_len_mean": 20.0, "episode_return_mean": 5.980000000000002, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "rlmodule_inference_timer": 2.8101307899623424e-05, "env_reset_timer": 3.707438053994097e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -277375.0, "agent_episode_returns_mean": {"default_agent": 5.980000000000002}, "sample": 0.004938077835108897, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3705.1691316468773}, "learners": {"default_policy": {"mean_kl_loss": 8.655712736072019e-05, "total_loss": 0.06442416459321976, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0011768140830099583, "vf_explained_var": -0.020464658737182617, "entropy": 0.6065216660499573, "gradients_default_optimizer_global_norm": 0.06588909029960632, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 66000, "weights_seq_no": 11.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0003645001561380923, "vf_loss_unclipped": 27.205020904541016, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 378638.2922800407}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.003760692912759e-06, "add_one_ts_to_episodes_and_truncate": 0.009194289425811311, "add_time_dim_to_batch_and_zero_pad": 1.4282152362730625e-05, "add_columns_from_episodes_to_train_batch": 0.036676604528325274, "numpy_to_tensor": 0.00012065365942532925, "general_advantage_estimation": 0.010026795768427688, "batch_individual_items": 0.03875216200892666, "add_observations_from_episodes_to_batch": 0.000957876157289412}}, "connector_pipeline_timer": 0.09596276511297519}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1979757.8813853709, "num_module_steps_trained_throughput": 378183.50595665333, "num_module_steps_trained_lifetime_throughput": 377802.7827438735}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.2}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010330802388012972, "timers": {"connectors": {"tensor_to_numpy": 1.3288710946653384e-05, "remove_single_ts_time_rank_from_batch": 5.743095872850824e-07, "un_batch_to_individual_items": 5.356603713085079e-06, "listify_data_for_vector_env": 1.108042289356331e-05, "get_actions": 3.77358245153561e-05, "normalize_and_clip_actions": 9.69328721133367e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.255346968946911e-06, "add_observations_from_episodes_to_batch": 2.835811244210072e-06, "add_states_from_episodes_to_batch": 1.5651519647385042e-06, "add_time_dim_to_batch_and_zero_pad": 2.2951792860272415e-06, "numpy_to_tensor": 8.657278694670579e-06}}, "connector_pipeline_timer": 4.326475980550906e-05}, "num_env_steps_sampled_lifetime": 55400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_step_timer": 1.465251661028847e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.2, "rlmodule_inference_timer": 2.7775856577574185e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "sample": 0.11143888017978429, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00466399337281473, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.00017130504038887759, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.2}, "num_episodes_lifetime": 220, "time_between_sampling": 1.7427517037073745}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-26", "timestamp": 1754932826, "time_this_iter_s": 1.6490271091461182, "time_total_s": 19.667389392852783, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.667389392852783, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 76.13333333333334, "ram_util_percent": 81.60000000000001}}
{"timers": {"training_iteration": 1.773798141926978, "restore_env_runners": 1.2574043652510421e-05, "training_step": 1.773638017423399, "env_runner_sampling_timer": 1.637525856147763, "learner_update_timer": 0.13255415351744676, "synch_weights": 0.0008091275346105954, "restore_eval_env_runners": 1.1157667695817063e-05, "evaluation_iteration": 0.11854433171486732, "synch_eval_env_connectors": 0.00013205018198745544, "synch_env_connectors": 7.309388067577227e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7747543389586343e-06, "add_observations_from_episodes_to_batch": 3.122026214959965e-06, "add_time_dim_to_batch_and_zero_pad": 2.5358330165846732e-06, "numpy_to_tensor": 8.799788109486278e-06, "batch_individual_items": 6.53278129444734e-06}}, "connector_pipeline_timer": 4.503359781893096e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -6165000.0, "time_between_sampling": 0.0022282141202389296, "env_step_timer": 1.4106987559539765e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3164733078991048e-05, "un_batch_to_individual_items": 5.481761718715725e-06, "remove_single_ts_time_rank_from_batch": 5.982877782088438e-07, "normalize_and_clip_actions": 9.60382718428323e-06, "listify_data_for_vector_env": 1.1179122625204676e-05, "get_actions": 3.872583300022533e-05}}, "connector_pipeline_timer": 0.00010487056486599468}, "module_episode_returns_mean": {"default_policy": 5.740000000000001}, "episode_duration_sec_mean": 0.004609276192728431, "episode_len_mean": 20.0, "episode_return_mean": 5.740000000000001, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "rlmodule_inference_timer": 2.7877454752537223e-05, "env_reset_timer": 3.840699560660735e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -308250.0, "agent_episode_returns_mean": {"default_agent": 5.740000000000001}, "sample": 0.004955649329707807, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3635.140777385551}, "learners": {"default_policy": {"mean_kl_loss": 1.5084176993696019e-05, "total_loss": -0.13557009398937225, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.19873479008674622, "vf_explained_var": -0.020839571952819824, "entropy": 0.6156450510025024, "gradients_default_optimizer_global_norm": 0.020691007375717163, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 72000, "weights_seq_no": 12.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.00018225007806904614, "vf_loss_unclipped": 26.743595123291016, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 377783.0709437762}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.99539387428665e-06, "add_one_ts_to_episodes_and_truncate": 0.009197558611603459, "add_time_dim_to_batch_and_zero_pad": 1.4269331828987456e-05, "add_columns_from_episodes_to_train_batch": 0.036669409733197586, "numpy_to_tensor": 0.00012019753366726594, "general_advantage_estimation": 0.010000360311236564, "batch_individual_items": 0.03873347788882845, "add_observations_from_episodes_to_batch": 0.0009583882257538883}}, "connector_pipeline_timer": 0.09591290204110989}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1975767.757070729, "num_module_steps_trained_throughput": 377379.721621003, "num_module_steps_trained_lifetime_throughput": 377010.6381957632}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010257754234203851, "timers": {"connectors": {"tensor_to_numpy": 1.3152609161050006e-05, "remove_single_ts_time_rank_from_batch": 5.75380624239156e-07, "un_batch_to_individual_items": 5.408433107556192e-06, "listify_data_for_vector_env": 1.0799874746630654e-05, "get_actions": 3.746473972838674e-05, "normalize_and_clip_actions": 9.505411874287273e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.1671267352424885e-06, "add_observations_from_episodes_to_batch": 2.8437111955041214e-06, "add_states_from_episodes_to_batch": 1.5851272469184349e-06, "add_time_dim_to_batch_and_zero_pad": 2.221530861427688e-06, "numpy_to_tensor": 8.437359189571518e-06}}, "connector_pipeline_timer": 4.348118315602662e-05}, "num_env_steps_sampled_lifetime": 60400, "num_episodes": 20, "episode_return_max": 11.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_step_timer": 1.4196335224898192e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.0, "rlmodule_inference_timer": 2.7263356758074383e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "sample": 0.11134173429717444, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004696433783974499, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.0001709403203914609, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.0}, "num_episodes_lifetime": 240, "time_between_sampling": 1.742338997079465}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-28", "timestamp": 1754932828, "time_this_iter_s": 1.790722131729126, "time_total_s": 21.45811152458191, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.45811152458191, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 80.15, "ram_util_percent": 82.6}}
{"timers": {"training_iteration": 1.7776295800982316, "restore_env_runners": 1.251580314788701e-05, "training_step": 1.7774691351684786, "env_runner_sampling_timer": 1.6416569950859883, "learner_update_timer": 0.13225535282244283, "synch_weights": 0.0008080741685002947, "restore_eval_env_runners": 1.112568184608553e-05, "evaluation_iteration": 0.11848308172731553, "synch_eval_env_connectors": 0.00013492926045700437, "synch_env_connectors": 7.278793928440814e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.1195458825147622e-06, "add_observations_from_episodes_to_batch": 3.702430286365038e-06, "add_time_dim_to_batch_and_zero_pad": 3.1801898622434215e-06, "numpy_to_tensor": 1.1419174816850224e-05, "batch_individual_items": 8.20119218038072e-06}}, "connector_pipeline_timer": 5.488046447087368e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -6782500.0, "time_between_sampling": 0.0021067727209821818, "env_step_timer": 1.9840295234206758e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.0928142004439278e-05, "un_batch_to_individual_items": 6.9415022752898405e-06, "remove_single_ts_time_rank_from_batch": 7.606058973388633e-07, "normalize_and_clip_actions": 1.2073650369681849e-05, "listify_data_for_vector_env": 1.464860978131713e-05, "get_actions": 6.474929866421405e-05}}, "connector_pipeline_timer": 0.0001534612083763904}, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "episode_duration_sec_mean": 0.0063381638219580025, "episode_len_mean": 20.0, "episode_return_mean": 6.940000000000001, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "rlmodule_inference_timer": 3.823113677882147e-05, "env_reset_timer": 5.1762543295770694e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -339125.0, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "sample": 0.006282538306766636, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3088.7785420373257}, "learners": {"default_policy": {"mean_kl_loss": 7.769689545966685e-05, "total_loss": 0.02526637353003025, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.037887606769800186, "vf_explained_var": -0.02140367031097412, "entropy": 0.6168266534805298, "gradients_default_optimizer_global_norm": 0.05055728554725647, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 78000, "weights_seq_no": 13.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 9.112503903452307e-05, "vf_loss_unclipped": 26.886669158935547, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 378397.12306595204}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.988350547024257e-06, "add_one_ts_to_episodes_and_truncate": 0.009189305945877269, "add_time_dim_to_batch_and_zero_pad": 1.4245389123880365e-05, "add_columns_from_episodes_to_train_batch": 0.0366612460468967, "numpy_to_tensor": 0.00012071555862183646, "general_advantage_estimation": 0.009983192128159025, "batch_individual_items": 0.038694509769540454, "add_observations_from_episodes_to_batch": 0.000958048093742591}}, "connector_pipeline_timer": 0.09584008011168531}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1979488.9911352496, "num_module_steps_trained_throughput": 378045.2224000829, "num_module_steps_trained_lifetime_throughput": 377687.52961941884}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.6}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010153980171852421, "timers": {"connectors": {"tensor_to_numpy": 1.2922921757083542e-05, "remove_single_ts_time_rank_from_batch": 5.702281862285905e-07, "un_batch_to_individual_items": 5.280166152634776e-06, "listify_data_for_vector_env": 1.089661745486327e-05, "get_actions": 3.669953933903076e-05, "normalize_and_clip_actions": 9.45879217010296e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.129936375018349e-06, "add_observations_from_episodes_to_batch": 2.7746568749717437e-06, "add_states_from_episodes_to_batch": 1.559239820536823e-06, "add_time_dim_to_batch_and_zero_pad": 2.1892393071351607e-06, "numpy_to_tensor": 8.413758248395887e-06}}, "connector_pipeline_timer": 4.266512869594374e-05}, "num_env_steps_sampled_lifetime": 65400, "num_episodes": 20, "episode_return_max": 11.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_step_timer": 1.3903979910920197e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.6, "rlmodule_inference_timer": 2.7203002405704718e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "sample": 0.11123295279369291, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004597565437434241, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.00017238758732392352, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.6}, "num_episodes_lifetime": 260, "time_between_sampling": 1.7467145337797059}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-30", "timestamp": 1754932830, "time_this_iter_s": 2.2672739028930664, "time_total_s": 23.725385427474976, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.725385427474976, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.066666666666666, "ram_util_percent": 83.43333333333332}}
{"timers": {"training_iteration": 1.7765319630468441, "restore_env_runners": 1.2453145010237366e-05, "training_step": 1.7763710975672675, "env_runner_sampling_timer": 1.6398447188857275, "learner_update_timer": 0.1329628213745076, "synch_weights": 0.0008074696758265252, "restore_eval_env_runners": 1.1104004289464064e-05, "evaluation_iteration": 0.11837791133011558, "synch_eval_env_connectors": 0.00013450121700925213, "synch_env_connectors": 7.242255392066877e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8568769582890447e-06, "add_observations_from_episodes_to_batch": 3.0778185194665224e-06, "add_time_dim_to_batch_and_zero_pad": 2.5803716678458726e-06, "numpy_to_tensor": 9.27820390395746e-06, "batch_individual_items": 6.8489488408074095e-06}}, "connector_pipeline_timer": 4.6498069067896585e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -7400000.0, "time_between_sampling": 0.0019853720154883593, "env_step_timer": 1.4803615250386264e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3606658828341234e-05, "un_batch_to_individual_items": 5.606891462137226e-06, "remove_single_ts_time_rank_from_batch": 6.10728280295384e-07, "normalize_and_clip_actions": 1.0045872184096506e-05, "listify_data_for_vector_env": 1.1671859998776306e-05, "get_actions": 4.1082715266341745e-05}}, "connector_pipeline_timer": 0.00010937694274653556}, "module_episode_returns_mean": {"default_policy": 6.62}, "episode_duration_sec_mean": 0.0048058057869784536, "episode_len_mean": 20.0, "episode_return_mean": 6.62, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "rlmodule_inference_timer": 2.942791590765078e-05, "env_reset_timer": 4.732080620603359e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -370000.0, "agent_episode_returns_mean": {"default_agent": 6.62}, "sample": 0.005543670115518925, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3525.713051350982}, "learners": {"default_policy": {"mean_kl_loss": 6.392585055436939e-05, "total_loss": 0.08509045839309692, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.021915465593338013, "vf_explained_var": -0.022045254707336426, "entropy": 0.6145032048225403, "gradients_default_optimizer_global_norm": 0.02799815684556961, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 84000, "weights_seq_no": 14.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 4.5562519517261535e-05, "vf_loss_unclipped": 27.137771606445312, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 378361.9685680033}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.97763722874419e-06, "add_one_ts_to_episodes_and_truncate": 0.009175385795621296, "add_time_dim_to_batch_and_zero_pad": 1.4207936032163364e-05, "add_columns_from_episodes_to_train_batch": 0.036635798996782466, "numpy_to_tensor": 0.00012038382297269229, "general_advantage_estimation": 0.009948581456701824, "batch_individual_items": 0.03967147009213908, "add_observations_from_episodes_to_batch": 0.0009570396932105942}}, "connector_pipeline_timer": 0.09674068681044769}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1979506.781344085, "num_module_steps_trained_throughput": 378031.65695459425, "num_module_steps_trained_lifetime_throughput": 377684.280435168}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -1.2}, "module_to_env_connector": {"connector_pipeline_timer": 0.00013006462152750814, "timers": {"connectors": {"tensor_to_numpy": 1.6576773684682454e-05, "remove_single_ts_time_rank_from_batch": 7.79713539728858e-07, "un_batch_to_individual_items": 6.247485562655956e-06, "listify_data_for_vector_env": 1.413177766732258e-05, "get_actions": 5.030023283499061e-05, "normalize_and_clip_actions": 1.0968655082056089e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.181780368530382e-06, "add_observations_from_episodes_to_batch": 3.316687285613074e-06, "add_states_from_episodes_to_batch": 1.805350571514081e-06, "add_time_dim_to_batch_and_zero_pad": 3.0501664747129177e-06, "numpy_to_tensor": 1.0534388239206852e-05}}, "connector_pipeline_timer": 5.211239004528311e-05}, "num_env_steps_sampled_lifetime": 70400, "num_episodes": 20, "episode_return_max": 11.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_step_timer": 1.7715265237402516e-05, "num_env_steps_sampled": 400, "episode_return_mean": -1.2, "rlmodule_inference_timer": 3.592337293723071e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "sample": 0.11141140618630654, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004896170380525291, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.0001715278810110571, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -1.2}, "num_episodes_lifetime": 280, "time_between_sampling": 1.7461561742719278}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-32", "timestamp": 1754932832, "time_this_iter_s": 1.8061258792877197, "time_total_s": 25.531511306762695, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.531511306762695, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 52.800000000000004, "ram_util_percent": 82.73333333333333}}
{"timers": {"training_iteration": 1.783414963416063, "restore_env_runners": 1.2381523159752118e-05, "training_step": 1.7832536028418524, "env_runner_sampling_timer": 1.6452391246173503, "learner_update_timer": 0.13444914024056073, "synch_weights": 0.0008067945685900703, "restore_eval_env_runners": 1.1068374599589258e-05, "evaluation_iteration": 0.11854890055705744, "synch_eval_env_connectors": 0.0001346137037136749, "synch_env_connectors": 7.220663260115502e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.1995626021184276e-06, "add_observations_from_episodes_to_batch": 4.144873581563905e-06, "add_time_dim_to_batch_and_zero_pad": 3.818914053116423e-06, "numpy_to_tensor": 1.2882984843560862e-05, "batch_individual_items": 9.48254722613611e-06}}, "connector_pipeline_timer": 6.14222082576815e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -8017500.0, "time_between_sampling": 0.002270904564702375, "env_step_timer": 3.1655799129881566e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.8670424928712916e-05, "un_batch_to_individual_items": 7.905053715711446e-06, "remove_single_ts_time_rank_from_batch": 7.680751503439204e-07, "normalize_and_clip_actions": 1.5083363428079725e-05, "listify_data_for_vector_env": 1.4689537107198139e-05, "get_actions": 6.169744045196243e-05}}, "connector_pipeline_timer": 0.00016015341961081315}, "module_episode_returns_mean": {"default_policy": 6.46}, "episode_duration_sec_mean": 0.007176879306323825, "episode_len_mean": 20.0, "episode_return_mean": 6.46, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "rlmodule_inference_timer": 4.5691753328063355e-05, "env_reset_timer": 6.335283211249084e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -400875.0, "agent_episode_returns_mean": {"default_agent": 6.46}, "sample": 0.00708641947780054, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3054.0835041809464}, "learners": {"default_policy": {"mean_kl_loss": 2.6270066882716492e-05, "total_loss": 0.20799577236175537, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.14473199844360352, "vf_explained_var": -0.022460103034973145, "entropy": 0.6047009825706482, "gradients_default_optimizer_global_norm": 0.07249045372009277, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 90000, "weights_seq_no": 15.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 2.2781259758630767e-05, "vf_loss_unclipped": 27.49070930480957, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 378139.5443257763}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.970770303784005e-06, "add_one_ts_to_episodes_and_truncate": 0.00916873277774375, "add_time_dim_to_batch_and_zero_pad": 1.437418730831324e-05, "add_columns_from_episodes_to_train_batch": 0.03662131767684365, "numpy_to_tensor": 0.0001199762341121247, "general_advantage_estimation": 0.009908925642526037, "batch_individual_items": 0.041406522891176786, "add_observations_from_episodes_to_batch": 0.0009562880456168767}}, "connector_pipeline_timer": 0.09841301911231522}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1978615.242698385, "num_module_steps_trained_throughput": 377838.62852802186, "num_module_steps_trained_lifetime_throughput": 377501.6085786936}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.8}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011694649418622912, "timers": {"connectors": {"tensor_to_numpy": 1.58757087887816e-05, "remove_single_ts_time_rank_from_batch": 6.732978055026453e-07, "un_batch_to_individual_items": 5.889087736082065e-06, "listify_data_for_vector_env": 1.293082859333428e-05, "get_actions": 4.2053803700852e-05, "normalize_and_clip_actions": 1.1478083191819779e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.383863940931674e-06, "add_observations_from_episodes_to_batch": 3.308037951679336e-06, "add_states_from_episodes_to_batch": 1.632309510022441e-06, "add_time_dim_to_batch_and_zero_pad": 2.380903492089965e-06, "numpy_to_tensor": 9.397039561331648e-06}}, "connector_pipeline_timer": 4.737032580474535e-05}, "num_env_steps_sampled_lifetime": 75400, "num_episodes": 20, "episode_return_max": 11.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_step_timer": 1.674242782916256e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.8, "rlmodule_inference_timer": 3.1532723586749684e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "sample": 0.11151051546489892, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005060065807774663, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.0001728776022563043, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.8}, "num_episodes_lifetime": 300, "time_between_sampling": 1.7535772471093438}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-35", "timestamp": 1754932835, "time_this_iter_s": 2.598083257675171, "time_total_s": 28.129594564437866, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.129594564437866, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 49.833333333333336, "ram_util_percent": 83.8}}
{"timers": {"training_iteration": 1.7803000525311419, "restore_env_runners": 1.2317297438938148e-05, "training_step": 1.7801385843132458, "env_runner_sampling_timer": 1.6425488842006017, "learner_update_timer": 0.13402843383849614, "synch_weights": 0.0008058341228910566, "restore_eval_env_runners": 1.1045190937784924e-05, "evaluation_iteration": 0.11867164114155451, "synch_eval_env_connectors": 0.00013462173647555307, "synch_env_connectors": 7.188455767940863e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7525113132916347e-06, "add_observations_from_episodes_to_batch": 2.977254089650408e-06, "add_time_dim_to_batch_and_zero_pad": 2.4779318649001186e-06, "numpy_to_tensor": 8.603300843682733e-06, "batch_individual_items": 6.347299631366696e-06}}, "connector_pipeline_timer": 4.4164952863323366e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -8635000.0, "time_between_sampling": 0.0024598193969754276, "env_step_timer": 1.3850330448934881e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3226128113865628e-05, "un_batch_to_individual_items": 5.389279500125441e-06, "remove_single_ts_time_rank_from_batch": 5.954871247672206e-07, "normalize_and_clip_actions": 9.544188615553152e-06, "listify_data_for_vector_env": 1.1036289334619298e-05, "get_actions": 3.800313901917486e-05}}, "connector_pipeline_timer": 0.00010372827904086053}, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "episode_duration_sec_mean": 0.00454120350209996, "episode_len_mean": 20.0, "episode_return_mean": 6.7799999999999985, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "rlmodule_inference_timer": 2.738995115483122e-05, "env_reset_timer": 4.622328883117174e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -431750.0, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "sample": 0.005646238158523184, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3701.4674868279526}, "learners": {"default_policy": {"mean_kl_loss": 7.574491610284895e-05, "total_loss": 0.15125392377376556, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.08797918260097504, "vf_explained_var": -0.022913694381713867, "entropy": 0.6034906506538391, "gradients_default_optimizer_global_norm": 0.0359240286052227, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 96000, "weights_seq_no": 16.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 1.1390629879315384e-05, "vf_loss_unclipped": 27.252580642700195, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 378660.95481230336}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.964812566697012e-06, "add_one_ts_to_episodes_and_truncate": 0.009154931280508385, "add_time_dim_to_batch_and_zero_pad": 1.4374615333933802e-05, "add_columns_from_episodes_to_train_batch": 0.036599159910316925, "numpy_to_tensor": 0.00011943105184257194, "general_advantage_estimation": 0.009863205545678192, "batch_individual_items": 0.04129160266185479, "add_observations_from_episodes_to_batch": 0.0009548643260880931}}, "connector_pipeline_timer": 0.09821349017138979}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1981673.982528145, "num_module_steps_trained_throughput": 378394.85375916975, "num_module_steps_trained_lifetime_throughput": 378067.24654702464}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.4}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001136912283603971, "timers": {"connectors": {"tensor_to_numpy": 1.5382987860755263e-05, "remove_single_ts_time_rank_from_batch": 6.304325821556833e-07, "un_batch_to_individual_items": 5.751304410214127e-06, "listify_data_for_vector_env": 1.2135637914305562e-05, "get_actions": 4.104559543133848e-05, "normalize_and_clip_actions": 1.009526068255173e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.9139295347275706e-06, "add_observations_from_episodes_to_batch": 3.1484353237130176e-06, "add_states_from_episodes_to_batch": 1.7501735911643272e-06, "add_time_dim_to_batch_and_zero_pad": 2.3543923505594964e-06, "numpy_to_tensor": 9.14305178663934e-06}}, "connector_pipeline_timer": 4.706886872939817e-05}, "num_env_steps_sampled_lifetime": 80400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_step_timer": 1.629756239025908e-05, "num_env_steps_sampled": 400, "episode_return_mean": -0.4, "rlmodule_inference_timer": 2.9441650614929233e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "sample": 0.11142514821980722, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005053260850254446, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.00017198965685039422, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.4}, "num_episodes_lifetime": 320, "time_between_sampling": 1.75102979005801}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-36", "timestamp": 1754932836, "time_this_iter_s": 1.5826733112335205, "time_total_s": 29.712267875671387, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.712267875671387, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 49.06666666666666, "ram_util_percent": 82.39999999999999}}
{"timers": {"training_iteration": 1.7781980970062905, "restore_env_runners": 1.225745439962262e-05, "training_step": 1.7780360972202378, "env_runner_sampling_timer": 1.6408679899388567, "learner_update_timer": 0.13360876033076463, "synch_weights": 0.0008041262013790555, "restore_eval_env_runners": 1.1004318137956597e-05, "evaluation_iteration": 0.11856806514993508, "synch_eval_env_connectors": 0.00013421176838183274, "synch_env_connectors": 7.165741549741497e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.750204159442291e-06, "add_observations_from_episodes_to_batch": 3.0541875623361606e-06, "add_time_dim_to_batch_and_zero_pad": 2.4738850203357186e-06, "numpy_to_tensor": 8.567599252969717e-06, "batch_individual_items": 6.37157413919023e-06}}, "connector_pipeline_timer": 4.422702433814869e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -9252500.0, "time_between_sampling": 0.001592993543264748, "env_step_timer": 1.38832166096912e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2929433117457929e-05, "un_batch_to_individual_items": 5.415333649640672e-06, "remove_single_ts_time_rank_from_batch": 5.91333621982909e-07, "normalize_and_clip_actions": 9.489695939651144e-06, "listify_data_for_vector_env": 1.1023843874758188e-05, "get_actions": 3.80801332032037e-05}}, "connector_pipeline_timer": 0.00010345207352903785}, "module_episode_returns_mean": {"default_policy": 6.62}, "episode_duration_sec_mean": 0.004917334113270044, "episode_len_mean": 20.0, "episode_return_mean": 6.62, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "rlmodule_inference_timer": 4.379599266326213e-05, "env_reset_timer": 3.5755126867071094e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -462625.0, "agent_episode_returns_mean": {"default_agent": 6.62}, "sample": 0.00514169601369286, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3710.6819154740074}, "learners": {"default_policy": {"mean_kl_loss": 0.0002801602240651846, "total_loss": -0.007574191316962242, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07086284458637238, "vf_explained_var": -0.023396968841552734, "entropy": 0.6019554734230042, "gradients_default_optimizer_global_norm": 0.03156490996479988, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 102000, "weights_seq_no": 17.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 5.695314939657692e-06, "vf_loss_unclipped": 26.885883331298828, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 379764.2154012501}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.955574451397674e-06, "add_one_ts_to_episodes_and_truncate": 0.009139860307900656, "add_time_dim_to_batch_and_zero_pad": 1.4338369417075893e-05, "add_columns_from_episodes_to_train_batch": 0.036572851652076147, "numpy_to_tensor": 0.00011887841210067732, "general_advantage_estimation": 0.009820360160639864, "batch_individual_items": 0.0411778595558768, "add_observations_from_episodes_to_batch": 0.0009564119326273875}}, "connector_pipeline_timer": 0.09801537193917093}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1987797.030178311, "num_module_steps_trained_throughput": 379534.377711139, "num_module_steps_trained_lifetime_throughput": 379215.00448480056}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010088582611991043, "timers": {"connectors": {"tensor_to_numpy": 1.2882776160325994e-05, "remove_single_ts_time_rank_from_batch": 5.70278785285544e-07, "un_batch_to_individual_items": 5.23664826462682e-06, "listify_data_for_vector_env": 1.074380179558455e-05, "get_actions": 3.659370312992549e-05, "normalize_and_clip_actions": 9.37124343953986e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.028071907633471e-06, "add_observations_from_episodes_to_batch": 2.7553827724875836e-06, "add_states_from_episodes_to_batch": 1.5385506437226057e-06, "add_time_dim_to_batch_and_zero_pad": 2.154055212093704e-06, "numpy_to_tensor": 8.148294106456906e-06}}, "connector_pipeline_timer": 4.170394312107256e-05}, "num_env_steps_sampled_lifetime": 85400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_step_timer": 1.3772398231632583e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.0, "rlmodule_inference_timer": 2.716553626520775e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "sample": 0.11129851548710475, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005020860010990873, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.00017099143050342764, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.0}, "num_episodes_lifetime": 340, "time_between_sampling": 1.749420386747152}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-38", "timestamp": 1754932838, "time_this_iter_s": 1.6773109436035156, "time_total_s": 31.389578819274902, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.389578819274902, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 47.25, "ram_util_percent": 82.15}}
{"timers": {"training_iteration": 1.7762426535358975, "restore_env_runners": 1.2194880312495995e-05, "training_step": 1.7760804249978888, "env_runner_sampling_timer": 1.6384424733701721, "learner_update_timer": 0.1340815006473425, "synch_weights": 0.0008018282694769921, "restore_eval_env_runners": 1.0971354705311862e-05, "evaluation_iteration": 0.11841829324776279, "synch_eval_env_connectors": 0.00013406840022162428, "synch_env_connectors": 7.137833012186645e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7583500371361662e-06, "add_observations_from_episodes_to_batch": 3.0232765302472723e-06, "add_time_dim_to_batch_and_zero_pad": 2.5029169516441626e-06, "numpy_to_tensor": 8.676193144284798e-06, "batch_individual_items": 6.466367270638568e-06}}, "connector_pipeline_timer": 4.461553800359263e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -9870000.0, "time_between_sampling": 0.0015186260515628193, "env_step_timer": 1.4011964731626247e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.304837781690422e-05, "un_batch_to_individual_items": 5.4282948349706e-06, "remove_single_ts_time_rank_from_batch": 5.957946334654994e-07, "normalize_and_clip_actions": 9.524216608836706e-06, "listify_data_for_vector_env": 1.1074557342123958e-05, "get_actions": 3.831224262250132e-05}}, "connector_pipeline_timer": 0.00010388640710612357}, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "episode_duration_sec_mean": 0.00460060011735186, "episode_len_mean": 20.0, "episode_return_mean": 6.7799999999999985, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "rlmodule_inference_timer": 2.798538243359073e-05, "env_reset_timer": 3.6448358263348784e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -493500.0, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "sample": 0.004981554448593318, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3715.402583108912}, "learners": {"default_policy": {"mean_kl_loss": 0.0001861961354734376, "total_loss": -0.08611404895782471, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.1494331955909729, "vf_explained_var": -0.02406442165374756, "entropy": 0.5985884666442871, "gradients_default_optimizer_global_norm": 0.02470725029706955, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 108000, "weights_seq_no": 18.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 2.847657469828846e-06, "vf_loss_unclipped": 26.647491455078125, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 381552.558607608}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.947689495186715e-06, "add_one_ts_to_episodes_and_truncate": 0.009125590453929591, "add_time_dim_to_batch_and_zero_pad": 1.4305395178279017e-05, "add_columns_from_episodes_to_train_batch": 0.03655225813608974, "numpy_to_tensor": 0.0001183625388078139, "general_advantage_estimation": 0.009774614899102745, "batch_individual_items": 0.04195971846013661, "add_observations_from_episodes_to_batch": 0.0009550228126853231}}, "connector_pipeline_timer": 0.09871360864005402}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1997565.16488965, "num_module_steps_trained_throughput": 381364.6119112737, "num_module_steps_trained_lifetime_throughput": 381053.5658011226}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010040599592004805, "timers": {"connectors": {"tensor_to_numpy": 1.2696238243376082e-05, "remove_single_ts_time_rank_from_batch": 5.649926924829899e-07, "un_batch_to_individual_items": 5.181717433128725e-06, "listify_data_for_vector_env": 1.063389948839816e-05, "get_actions": 3.669852335443063e-05, "normalize_and_clip_actions": 9.232884902842026e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.952455519054166e-06, "add_observations_from_episodes_to_batch": 2.7218427692754318e-06, "add_states_from_episodes_to_batch": 1.5215566536217846e-06, "add_time_dim_to_batch_and_zero_pad": 2.1271416546838745e-06, "numpy_to_tensor": 8.039215773637905e-06}}, "connector_pipeline_timer": 4.1584850818679596e-05}, "num_env_steps_sampled_lifetime": 90400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_step_timer": 1.3421741209847484e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.0, "rlmodule_inference_timer": 2.641612110010095e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "sample": 0.11114842908209184, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004992279199650511, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.00016997942605274582, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.0}, "num_episodes_lifetime": 360, "time_between_sampling": 1.747949320380423}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-40", "timestamp": 1754932840, "time_this_iter_s": 1.686117172241211, "time_total_s": 33.07569599151611, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.07569599151611, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.566666666666666, "ram_util_percent": 81.63333333333333}}
{"timers": {"training_iteration": 1.774279055750223, "restore_env_runners": 1.2129182228724591e-05, "training_step": 1.7741165328380644, "env_runner_sampling_timer": 1.6358329173857853, "learner_update_timer": 0.1347298448011627, "synch_weights": 0.0008006049861358097, "restore_eval_env_runners": 1.0922891915684766e-05, "evaluation_iteration": 0.11824447822519718, "synch_eval_env_connectors": 0.0001337560465175487, "synch_env_connectors": 7.103124344287044e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7431995207681691e-06, "add_observations_from_episodes_to_batch": 2.9826450689398322e-06, "add_time_dim_to_batch_and_zero_pad": 2.483244627777826e-06, "numpy_to_tensor": 8.518726425225774e-06, "batch_individual_items": 6.334359337663181e-06}}, "connector_pipeline_timer": 4.395399770819512e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -10487500.0, "time_between_sampling": 0.0018224449721326282, "env_step_timer": 1.3883171931657251e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2820202114933777e-05, "un_batch_to_individual_items": 5.396188199885813e-06, "remove_single_ts_time_rank_from_batch": 5.845408731005698e-07, "normalize_and_clip_actions": 9.446120370269745e-06, "listify_data_for_vector_env": 1.0947436713345644e-05, "get_actions": 3.763619495939992e-05}}, "connector_pipeline_timer": 0.00010256054763229294}, "module_episode_returns_mean": {"default_policy": 7.1}, "episode_duration_sec_mean": 0.00452581417746842, "episode_len_mean": 20.0, "episode_return_mean": 7.1, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "rlmodule_inference_timer": 2.7683368138173916e-05, "env_reset_timer": 3.728333581129937e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -524375.0, "agent_episode_returns_mean": {"default_agent": 7.1}, "sample": 0.004916514661521937, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3717.1619151853097}, "learners": {"default_policy": {"mean_kl_loss": 0.00044902059016749263, "total_loss": 0.04370664060115814, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.019801601767539978, "vf_explained_var": -0.024727582931518555, "entropy": 0.577710747718811, "gradients_default_optimizer_global_norm": 0.021649973466992378, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 114000, "weights_seq_no": 19.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 1.423828734914423e-06, "vf_loss_unclipped": 26.865428924560547, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 383021.7555736373}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.952372424263459e-06, "add_one_ts_to_episodes_and_truncate": 0.009115097458882773, "add_time_dim_to_batch_and_zero_pad": 1.4319841843702324e-05, "add_columns_from_episodes_to_train_batch": 0.03653876514559631, "numpy_to_tensor": 0.00011785474394415055, "general_advantage_estimation": 0.009731495000751276, "batch_individual_items": 0.042885322945727423, "add_observations_from_episodes_to_batch": 0.0009540684148537049}}, "connector_pipeline_timer": 0.09956973005351222}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2005648.3257480394, "num_module_steps_trained_throughput": 382874.7006978093, "num_module_steps_trained_lifetime_throughput": 382571.068147092}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011264110299091494, "timers": {"connectors": {"tensor_to_numpy": 1.423697663108731e-05, "remove_single_ts_time_rank_from_batch": 5.969542543104925e-07, "un_batch_to_individual_items": 5.6962377568088664e-06, "listify_data_for_vector_env": 1.177475467006907e-05, "get_actions": 4.20755763233587e-05, "normalize_and_clip_actions": 1.048209095011693e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.818131772429198e-06, "add_observations_from_episodes_to_batch": 3.3671883703638024e-06, "add_states_from_episodes_to_batch": 1.6289975354942277e-06, "add_time_dim_to_batch_and_zero_pad": 2.41986841955651e-06, "numpy_to_tensor": 9.259008732367276e-06}}, "connector_pipeline_timer": 4.671759959318776e-05}, "num_env_steps_sampled_lifetime": 95400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_step_timer": 1.612603168852672e-05, "num_env_steps_sampled": 400, "episode_return_mean": 0.0, "rlmodule_inference_timer": 3.018682148855849e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "sample": 0.11114964396116933, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004821062564151362, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.0001689983823174843, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.0}, "num_episodes_lifetime": 380, "time_between_sampling": 1.7464374163463594}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-41", "timestamp": 1754932841, "time_this_iter_s": 1.699295997619629, "time_total_s": 34.77499198913574, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.77499198913574, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 22.2, "ram_util_percent": 81.7}}
{"timers": {"training_iteration": 1.7713593539422654, "restore_env_runners": 1.2074140037782617e-05, "training_step": 1.7711965679293666, "env_runner_sampling_timer": 1.6333550865513495, "learner_update_timer": 0.13429134802287165, "synch_weights": 0.0007981897762844242, "restore_eval_env_runners": 1.0904913982388743e-05, "evaluation_iteration": 0.1182310009423429, "synch_eval_env_connectors": 0.0001334380758881511, "synch_env_connectors": 7.0725125005824856e-06}, "env_runners": {"episode_return_min": -10.5, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.752371775302463e-06, "add_observations_from_episodes_to_batch": 3.0026122320816846e-06, "add_time_dim_to_batch_and_zero_pad": 2.500665525611709e-06, "numpy_to_tensor": 8.605061751221163e-06, "batch_individual_items": 6.4004208178357845e-06}}, "connector_pipeline_timer": 4.4260834018207964e-05}, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_env_steps_sampled_lifetime": -11105000.0, "time_between_sampling": 0.001982248108829852, "env_step_timer": 1.3905831607159906e-05, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2964714269059438e-05, "un_batch_to_individual_items": 5.444698448554446e-06, "remove_single_ts_time_rank_from_batch": 5.945521405117123e-07, "normalize_and_clip_actions": 9.5707852504197e-06, "listify_data_for_vector_env": 1.1012504909834822e-05, "get_actions": 3.817230809526859e-05}}, "connector_pipeline_timer": 0.00010361276913289283}, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "episode_duration_sec_mean": 0.0045623593106865895, "episode_len_mean": 20.0, "episode_return_mean": 6.940000000000001, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "rlmodule_inference_timer": 2.76225754698115e-05, "env_reset_timer": 3.685367648111215e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -555250.0, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "sample": 0.0048662008603258654, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 3701.9458498199356}, "learners": {"default_policy": {"mean_kl_loss": 0.0002637100697029382, "total_loss": -0.021787814795970917, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08537109941244125, "vf_explained_var": -0.02492392063140869, "entropy": 0.5694254040718079, "gradients_default_optimizer_global_norm": 0.0137735391035676, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 120000, "weights_seq_no": 20.0, "num_trainable_parameters": 6003, "curr_kl_coeff": 7.119143674572115e-07, "vf_loss_unclipped": 26.72565269470215, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime_throughput": 384854.0924531572}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.94534836541525e-06, "add_one_ts_to_episodes_and_truncate": 0.009099128984589287, "add_time_dim_to_batch_and_zero_pad": 1.4298313734719503e-05, "add_columns_from_episodes_to_train_batch": 0.03651419165502191, "numpy_to_tensor": 0.00011727619641679218, "general_advantage_estimation": 0.009687854630574602, "batch_individual_items": 0.042752481376518194, "add_observations_from_episodes_to_batch": 0.0009527948099523296}}, "connector_pipeline_timer": 0.09934965900351979}, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2015620.6646309574, "num_module_steps_trained_throughput": 384745.3777427969, "num_module_steps_trained_lifetime_throughput": 384447.9521459113}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -1.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010062053237154031, "timers": {"connectors": {"tensor_to_numpy": 1.2894112125663106e-05, "remove_single_ts_time_rank_from_batch": 5.691263212141e-07, "un_batch_to_individual_items": 5.25316989935725e-06, "listify_data_for_vector_env": 1.0793579051066277e-05, "get_actions": 3.657524101836697e-05, "normalize_and_clip_actions": 9.406993070923731e-06}}}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.089902152747657e-06, "add_observations_from_episodes_to_batch": 2.7779836379790864e-06, "add_states_from_episodes_to_batch": 1.545631405876661e-06, "add_time_dim_to_batch_and_zero_pad": 2.301913043698919e-06, "numpy_to_tensor": 8.381955849683788e-06}}, "connector_pipeline_timer": 4.243308017273725e-05}, "num_env_steps_sampled_lifetime": 100400, "num_episodes": 20, "episode_return_max": 12.5, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_step_timer": 1.3760951203719564e-05, "num_env_steps_sampled": 400, "episode_return_mean": -1.0, "rlmodule_inference_timer": 2.704586576672864e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "sample": 0.1109926250210296, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004615751702804118, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_reset_timer": 0.00016807631935905542, "weights_seq_no": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -1.0}, "num_episodes_lifetime": 400, "time_between_sampling": 1.7439825830122375}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "437aa_00000", "date": "2025-08-11_19-20-43", "timestamp": 1754932843, "time_this_iter_s": 1.5849790573120117, "time_total_s": 36.359971046447754, "pid": 14175, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13f825b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.359971046447754, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 48.2, "ram_util_percent": 80.94999999999999}}
