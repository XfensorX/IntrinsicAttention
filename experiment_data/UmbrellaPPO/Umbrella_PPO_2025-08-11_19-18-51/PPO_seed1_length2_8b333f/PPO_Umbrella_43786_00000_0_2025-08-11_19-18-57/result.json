{"timers": {"training_iteration": 1.8040013330755755, "restore_env_runners": 1.1915923096239567e-05, "training_step": 1.803867874899879, "env_runner_sampling_timer": 1.6624629580182955, "learner_update_timer": 0.13807758293114603, "synch_weights": 0.0007261659484356642}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.2569802642308033e-05, "un_batch_to_individual_items": 6.065378115443102e-06, "remove_single_ts_time_rank_from_batch": 6.302475799564544e-07, "get_actions": 6.50917779145715e-05, "normalize_and_clip_actions": 1.3481057943659994e-05, "tensor_to_numpy": 1.5490845986666167e-05}}, "connector_pipeline_timer": 0.0001415569191626448}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0409342408067081e-05, "batch_individual_items": 7.297613858201521e-06, "add_observations_from_episodes_to_batch": 3.4453805142284743e-06, "add_states_from_episodes_to_batch": 1.931330718232085e-06, "add_time_dim_to_batch_and_zero_pad": 2.864534830120136e-06}}, "connector_pipeline_timer": 5.1086744697902816e-05}, "num_episodes_lifetime": 31375.0, "module_episode_returns_mean": {"default_policy": -0.09999999999999998}, "env_step_timer": 1.6360314319172848e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "sample": 0.006571392073737883, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": 627500.0, "agent_episode_returns_mean": {"default_agent": -0.09999999999999998}, "episode_return_mean": -0.09999999999999998, "env_to_module_sum_episodes_length_in": 10.191744832559449, "weights_seq_no": 0.0, "time_between_sampling": 0.0005810200352111334, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.005540042995940895, "rlmodule_inference_timer": 6.747501306223958e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 8.317792682872128e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled_lifetime_throughput": 3083.558100994343}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008509580511599779, "add_columns_from_episodes_to_train_batch": 0.03766474989242852, "add_states_from_episodes_to_batch": 3.832974471151829e-06, "numpy_to_tensor": 0.0001360829919576645, "add_time_dim_to_batch_and_zero_pad": 1.6874982975423336e-05, "general_advantage_estimation": 0.007359124952927232, "batch_individual_items": 0.05148300004657358, "add_one_ts_to_episodes_and_truncate": 0.008241625037044287}}, "connector_pipeline_timer": 0.10595458396710455}, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime_throughput": 1703724.4277902928, "num_module_steps_trained_throughput": 325335.19789607916, "num_module_steps_trained_lifetime_throughput": 324809.4530805205}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.0474664680659771, "curr_kl_coeff": 0.3732481598854065, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 6.952471449039876e-05, "vf_loss_unclipped": 28.586095809936523, "gradients_default_optimizer_global_norm": 0.026657981798052788, "num_module_steps_trained": 6000, "weights_seq_no": 1.0, "total_loss": 0.015051513910293579, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 6000, "vf_explained_var": -0.011646151542663574, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6927757263183594, "num_module_steps_trained_lifetime_throughput": 326101.1637488414}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.214602132913566e-07, "listify_data_for_vector_env": 1.2368342835884401e-05, "get_actions": 4.551588887381921e-05, "tensor_to_numpy": 1.798444733091551e-05, "normalize_and_clip_actions": 1.1788102506331085e-05, "un_batch_to_individual_items": 6.042456556428508e-06}}, "connector_pipeline_timer": 0.00012162863899498832}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_connector": {"connector_pipeline_timer": 4.735257662770434e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5564672905560074e-06, "batch_individual_items": 6.720261520980166e-06, "add_observations_from_episodes_to_batch": 3.2505277875449972e-06, "add_states_from_episodes_to_batch": 1.685144966207425e-06, "numpy_to_tensor": 9.421205848766594e-06}}}, "rlmodule_inference_timer": 3.2914888710152395e-05, "num_episodes": 20, "env_reset_timer": 0.00016687496099621058, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_step_timer": 1.6241764242202436e-05, "episode_len_min": 20, "sample": 0.11231279198545963, "weights_seq_no": 1.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.005099995754426346, "num_episodes_lifetime": 20, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 5.2}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 5400, "episode_return_mean": 5.2, "agent_episode_returns_mean": {"default_agent": 5.2}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_agent_steps_sampled_lifetime": {"default_agent": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "43786_00000", "date": "2025-08-11_19-20-08", "timestamp": 1754932808, "time_this_iter_s": 1.9248459339141846, "time_total_s": 1.9248459339141846, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.9248459339141846, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.199999999999996, "ram_util_percent": 81.43333333333334}}
{"timers": {"training_iteration": 1.802884228915209, "restore_env_runners": 1.1884683044627308e-05, "training_step": 1.8027497582416983, "env_runner_sampling_timer": 1.6607171680277677, "learner_update_timer": 0.13870754543226213, "synch_weights": 0.0007242755382321775, "restore_eval_env_runners": 1.3166922144591808e-05, "evaluation_iteration": 0.11920129205100238, "synch_eval_env_connectors": 0.00012204202357679605, "synch_env_connectors": 4.458008334040642e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1725368030999685e-05, "un_batch_to_individual_items": 5.607159096869565e-06, "remove_single_ts_time_rank_from_batch": 5.903221077879769e-07, "get_actions": 4.264328046977489e-05, "normalize_and_clip_actions": 1.0218351921993331e-05, "tensor_to_numpy": 1.4105164499620883e-05}}, "connector_pipeline_timer": 0.0001119457257546918}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.314950107822483e-06, "batch_individual_items": 6.668447993724556e-06, "add_observations_from_episodes_to_batch": 3.060148405407812e-06, "add_states_from_episodes_to_batch": 1.7828515103179562e-06, "add_time_dim_to_batch_and_zero_pad": 3.0346963666384194e-06}}, "connector_pipeline_timer": 4.790015080448444e-05}, "num_episodes_lifetime": 500.0, "module_episode_returns_mean": {"default_policy": -0.8199999999999998}, "env_step_timer": 1.5797758738488147e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "sample": 0.005789359845105802, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": 10000.0, "agent_episode_returns_mean": {"default_agent": -0.8199999999999998}, "episode_return_mean": -0.8199999999999998, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 1.0, "time_between_sampling": 0.0019061568768452867, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.0049188220142386855, "rlmodule_inference_timer": 3.106806248151146e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 4.605935348921691e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3555.0108584220984}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008506297203712166, "add_columns_from_episodes_to_train_batch": 0.037632315304363145, "add_states_from_episodes_to_batch": 3.8283946923911576e-06, "numpy_to_tensor": 0.00013536049169488251, "add_time_dim_to_batch_and_zero_pad": 1.683873240835965e-05, "general_advantage_estimation": 0.007339177863905206, "batch_individual_items": 0.05235486545599997, "add_one_ts_to_episodes_and_truncate": 0.008237257957225665}}, "connector_pipeline_timer": 0.10676762854680419}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 63000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1710992.029956757, "num_module_steps_trained_throughput": 326711.40263122495, "num_module_steps_trained_lifetime_throughput": 326190.2949339359}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": 0.01986965350806713, "curr_kl_coeff": 0.18662407994270325, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0015428205952048302, "vf_loss_unclipped": 28.918132781982422, "gradients_default_optimizer_global_norm": 0.09095917642116547, "num_module_steps_trained": 6000, "weights_seq_no": 2.0, "total_loss": 0.08293826133012772, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 12000, "vf_explained_var": -0.012287616729736328, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6898306608200073, "num_module_steps_trained_lifetime_throughput": 327456.5122826012}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.837658189529397e-07, "listify_data_for_vector_env": 1.0712659323697986e-05, "get_actions": 3.596357333616317e-05, "tensor_to_numpy": 1.3125051150180773e-05, "normalize_and_clip_actions": 9.415231144520544e-06, "un_batch_to_individual_items": 5.234692168115938e-06}}, "connector_pipeline_timer": 0.00010009850205134958}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_connector": {"connector_pipeline_timer": 4.1870016162444434e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2456270256106572e-06, "batch_individual_items": 5.9878865901102224e-06, "add_observations_from_episodes_to_batch": 2.766918885619014e-06, "add_states_from_episodes_to_batch": 1.61166061119991e-06, "numpy_to_tensor": 8.23021609645436e-06}}}, "rlmodule_inference_timer": 2.678738558934971e-05, "num_episodes": 20, "env_reset_timer": 0.0001663307915441692, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_step_timer": 1.3578170326856405e-05, "episode_len_min": 20, "sample": 0.11216053490526974, "weights_seq_no": 2.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004776585404761136, "num_episodes_lifetime": 40, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 2.7}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 10400, "episode_return_mean": 2.7, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "time_between_sampling": 1.7716014169855043}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "43786_00000", "date": "2025-08-11_19-20-10", "timestamp": 1754932810, "time_this_iter_s": 1.7965729236602783, "time_total_s": 3.721418857574463, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.721418857574463, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 48.333333333333336, "ram_util_percent": 81.13333333333334}}
{"timers": {"training_iteration": 1.801793587875634, "restore_env_runners": 1.1833336146082728e-05, "training_step": 1.8016585477394518, "env_runner_sampling_timer": 1.6599467555175418, "learner_update_timer": 0.1383842137273401, "synch_weights": 0.0007247569534229115, "restore_eval_env_runners": 1.3109003193676471e-05, "evaluation_iteration": 0.11903203163063154, "synch_eval_env_connectors": 0.0001218566030729562, "synch_env_connectors": 4.452178254723549e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.2456850966295612e-05, "un_batch_to_individual_items": 6.031709411790163e-06, "remove_single_ts_time_rank_from_batch": 6.223581114788016e-07, "get_actions": 4.568747073973555e-05, "normalize_and_clip_actions": 1.0620095806945871e-05, "tensor_to_numpy": 1.5134153880465959e-05}}, "connector_pipeline_timer": 0.00011827992746135405}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0129114484252767e-05, "batch_individual_items": 7.138452363624145e-06, "add_observations_from_episodes_to_batch": 3.3177924636931073e-06, "add_states_from_episodes_to_batch": 1.8782013303614483e-06, "add_time_dim_to_batch_and_zero_pad": 2.7617886942233078e-06}}, "connector_pipeline_timer": 4.9154160966356e-05}, "num_episodes_lifetime": -30375.0, "module_episode_returns_mean": {"default_policy": 0.22}, "env_step_timer": 1.5806331881779783e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "sample": 0.00545802827435149, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -607500.0, "agent_episode_returns_mean": {"default_agent": 0.22}, "episode_return_mean": 0.22, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 2.0, "time_between_sampling": 0.0019845730255709155, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.005172349008265882, "rlmodule_inference_timer": 3.177248108863242e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 4.437638502151345e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3298.7092605262583}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008541280035162344, "add_columns_from_episodes_to_train_batch": 0.03764697048113448, "add_states_from_episodes_to_batch": 3.834279882721604e-06, "numpy_to_tensor": 0.00013478021746268497, "add_time_dim_to_batch_and_zero_pad": 1.6894095332827422e-05, "general_advantage_estimation": 0.007321056084695737, "batch_individual_items": 0.052143077220721167, "add_one_ts_to_episodes_and_truncate": 0.008278084538097027}}, "connector_pipeline_timer": 0.10659546601148322}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 94500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1717961.9334553392, "num_module_steps_trained_throughput": 328026.4401080266, "num_module_steps_trained_lifetime_throughput": 327512.60727021366}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": 0.05581562593579292, "curr_kl_coeff": 0.09331203997135162, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0014687618240714073, "vf_loss_unclipped": 28.84691619873047, "gradients_default_optimizer_global_norm": 0.04352671653032303, "num_module_steps_trained": 6000, "weights_seq_no": 3.0, "total_loss": 0.11864931136369705, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 18000, "vf_explained_var": -0.014024496078491211, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6824526190757751, "num_module_steps_trained_lifetime_throughput": 328739.7570590905}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.748416629458442e-07, "listify_data_for_vector_env": 1.2958869265640695e-05, "get_actions": 4.663637667141491e-05, "tensor_to_numpy": 1.4894540769314739e-05, "normalize_and_clip_actions": 1.095830360384046e-05, "un_batch_to_individual_items": 6.5972127356577645e-06}}, "connector_pipeline_timer": 0.00011970801757791299}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_connector": {"connector_pipeline_timer": 4.693876113665294e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.8889064182416142e-06, "batch_individual_items": 6.990499823959875e-06, "add_observations_from_episodes_to_batch": 3.0929611284990836e-06, "add_states_from_episodes_to_batch": 1.690277939138837e-06, "numpy_to_tensor": 9.735583201247756e-06}}}, "rlmodule_inference_timer": 3.253580765129352e-05, "num_episodes": 20, "env_reset_timer": 0.00016554665330331775, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_step_timer": 1.6595479224690014e-05, "episode_len_min": 20, "sample": 0.11211068871589377, "weights_seq_no": 3.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004817920119967312, "num_episodes_lifetime": 60, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.8666666666666667}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 15400, "episode_return_mean": 1.8666666666666667, "agent_episode_returns_mean": {"default_agent": 1.8666666666666667}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "time_between_sampling": 1.7710067040647846}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "43786_00000", "date": "2025-08-11_19-20-12", "timestamp": 1754932812, "time_this_iter_s": 1.8103277683258057, "time_total_s": 5.5317466259002686, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.5317466259002686, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.699999999999996, "ram_util_percent": 81.73333333333333}}
{"timers": {"training_iteration": 1.8034295340773336, "restore_env_runners": 1.1791672751423901e-05, "training_step": 1.8032938681016215, "env_runner_sampling_timer": 1.662009963371944, "learner_update_timer": 0.13795849075987562, "synch_weights": 0.0007227839642146137, "restore_eval_env_runners": 1.3113322807475925e-05, "evaluation_iteration": 0.11898596090490464, "synch_eval_env_connectors": 0.00012215887749334798, "synch_env_connectors": 4.450996732339263e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.3893515737637129e-05, "un_batch_to_individual_items": 6.554013765284195e-06, "remove_single_ts_time_rank_from_batch": 6.998354742334528e-07, "get_actions": 5.351862241851165e-05, "normalize_and_clip_actions": 1.1485883234478078e-05, "tensor_to_numpy": 1.6853486076251057e-05}}, "connector_pipeline_timer": 0.00013348555046509652}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1179874696287503e-05, "batch_individual_items": 8.079632503399055e-06, "add_observations_from_episodes_to_batch": 3.7163977142519263e-06, "add_states_from_episodes_to_batch": 2.031031260874428e-06, "add_time_dim_to_batch_and_zero_pad": 3.109835601877278e-06}}, "connector_pipeline_timer": 5.351213082103948e-05}, "num_episodes_lifetime": -61250.0, "module_episode_returns_mean": {"default_policy": 1.8199999999999996}, "env_step_timer": 1.7664642336132908e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "sample": 0.006033774074441833, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -1225000.0, "agent_episode_returns_mean": {"default_agent": 1.8199999999999996}, "episode_return_mean": 1.8199999999999996, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 3.0, "time_between_sampling": 0.0021515604493437435, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.005757471169345082, "rlmodule_inference_timer": 3.563150932810468e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 5.6662091273796776e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3005.0788431196593}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008537583829096983, "add_columns_from_episodes_to_train_batch": 0.0376327320257785, "add_states_from_episodes_to_batch": 3.832606746116654e-06, "numpy_to_tensor": 0.00013402116598759315, "add_time_dim_to_batch_and_zero_pad": 1.6830154014867733e-05, "general_advantage_estimation": 0.007300390103224315, "batch_individual_items": 0.05192510352866771, "add_one_ts_to_episodes_and_truncate": 0.008270972032566437}}, "connector_pipeline_timer": 0.10633326302095968}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 126000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1728133.0801671406, "num_module_steps_trained_throughput": 329947.0119654481, "num_module_steps_trained_lifetime_throughput": 329443.40888614964}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": 0.03923654928803444, "curr_kl_coeff": 0.04665601998567581, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0022027352824807167, "vf_loss_unclipped": 28.459375381469727, "gradients_default_optimizer_global_norm": 0.13250532746315002, "num_module_steps_trained": 6000, "weights_seq_no": 4.0, "total_loss": 0.10210534930229187, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 24000, "vf_explained_var": -0.01594841480255127, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6710050106048584, "num_module_steps_trained_lifetime_throughput": 330621.932511817}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.568076272986562e-07, "listify_data_for_vector_env": 1.2808363378275307e-05, "get_actions": 4.22274836345134e-05, "tensor_to_numpy": 1.4477556452842272e-05, "normalize_and_clip_actions": 1.0467801216701617e-05, "un_batch_to_individual_items": 6.500541206928209e-06}}, "connector_pipeline_timer": 0.00011556396834034528}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_connector": {"connector_pipeline_timer": 4.5425245364195724e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3785157496574094e-06, "batch_individual_items": 6.603995247575748e-06, "add_observations_from_episodes_to_batch": 3.001566164837414e-06, "add_states_from_episodes_to_batch": 1.6922901856582013e-06, "numpy_to_tensor": 9.672576269955967e-06}}}, "rlmodule_inference_timer": 3.0127679625609457e-05, "num_episodes": 20, "env_reset_timer": 0.00016468285636068322, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_step_timer": 1.5863621282235118e-05, "episode_len_min": 20, "sample": 0.11204779349875915, "weights_seq_no": 4.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004825728102878202, "num_episodes_lifetime": 80, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 2.2}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 20400, "episode_return_mean": 2.2, "agent_episode_returns_mean": {"default_agent": 2.2}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "time_between_sampling": 1.7731939520245534}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "43786_00000", "date": "2025-08-11_19-20-14", "timestamp": 1754932814, "time_this_iter_s": 2.078104019165039, "time_total_s": 7.609850645065308, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.609850645065308, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.23333333333333, "ram_util_percent": 82.06666666666666}}
{"timers": {"training_iteration": 1.801681083327308, "restore_env_runners": 1.1732915962155674e-05, "training_step": 1.8015447427502516, "env_runner_sampling_timer": 1.6606995283173331, "learner_update_timer": 0.13751663043256665, "synch_weights": 0.0007216736240059254, "restore_eval_env_runners": 1.3078850385267287e-05, "evaluation_iteration": 0.11890223254612717, "synch_eval_env_connectors": 0.00012198062844399829, "synch_env_connectors": 4.448986506555229e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1415450580981656e-05, "un_batch_to_individual_items": 5.505710665894279e-06, "remove_single_ts_time_rank_from_batch": 5.837542553476567e-07, "get_actions": 4.1557132041257575e-05, "normalize_and_clip_actions": 9.730817259980597e-06, "tensor_to_numpy": 1.3787933816094941e-05}}, "connector_pipeline_timer": 0.00010880298711933279}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.95896283950739e-06, "batch_individual_items": 6.521348802904148e-06, "add_observations_from_episodes_to_batch": 3.01691299932149e-06, "add_states_from_episodes_to_batch": 1.7357352189918542e-06, "add_time_dim_to_batch_and_zero_pad": 2.534527530554004e-06}}, "connector_pipeline_timer": 4.502486860261692e-05}, "num_episodes_lifetime": -92125.0, "module_episode_returns_mean": {"default_policy": 3.66}, "env_step_timer": 1.4196797838625553e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "sample": 0.005428296185328302, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -1842500.0, "agent_episode_returns_mean": {"default_agent": 3.66}, "episode_return_mean": 3.66, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 4.0, "time_between_sampling": 0.0017342544029770016, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.005102878186851741, "rlmodule_inference_timer": 4.8528665312388766e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 4.3471172800592755e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3568.0440482196614}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008531737187761276, "add_columns_from_episodes_to_train_batch": 0.03759934011538326, "add_states_from_episodes_to_batch": 3.821780305977446e-06, "numpy_to_tensor": 0.0001332288642040489, "add_time_dim_to_batch_and_zero_pad": 1.6748932299598822e-05, "general_advantage_estimation": 0.007282119951903958, "batch_individual_items": 0.051705375413194206, "add_one_ts_to_episodes_and_truncate": 0.008262049812391275}}, "connector_pipeline_timer": 0.10605041664104632}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 157500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1737544.8350076464, "num_module_steps_trained_throughput": 331720.9594378618, "num_module_steps_trained_lifetime_throughput": 331228.4715999048}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.08898680657148361, "curr_kl_coeff": 0.023328009992837906, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.003353710984811187, "vf_loss_unclipped": 27.58094024658203, "gradients_default_optimizer_global_norm": 0.3231657147407532, "num_module_steps_trained": 6000, "weights_seq_no": 5.0, "total_loss": -0.026010937988758087, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 30000, "vf_explained_var": -0.01769888401031494, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6537670493125916, "num_module_steps_trained_lifetime_throughput": 332350.04519810743}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.766287219621445e-07, "listify_data_for_vector_env": 1.0984549867254079e-05, "get_actions": 3.759605511123974e-05, "tensor_to_numpy": 1.3470744581249618e-05, "normalize_and_clip_actions": 9.516385041745109e-06, "un_batch_to_individual_items": 5.407287802265991e-06}}, "connector_pipeline_timer": 0.00010293213164852721}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_connector": {"connector_pipeline_timer": 4.36781881951558e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.231215437907688e-06, "batch_individual_items": 6.37899892748533e-06, "add_observations_from_episodes_to_batch": 2.8184422469128154e-06, "add_states_from_episodes_to_batch": 2.3452422816194335e-06, "numpy_to_tensor": 8.4349763825631e-06}}}, "rlmodule_inference_timer": 2.7679248275747858e-05, "num_episodes": 20, "env_reset_timer": 0.00016383227833038894, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_step_timer": 1.4014229930122422e-05, "episode_len_min": 20, "sample": 0.11193013056285461, "weights_seq_no": 5.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.0047798004176002, "num_episodes_lifetime": 100, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 2.6}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 25400, "episode_return_mean": 2.6, "agent_episode_returns_mean": {"default_agent": 2.6}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "time_between_sampling": 1.7719553183336616}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "43786_00000", "date": "2025-08-11_19-20-16", "timestamp": 1754932816, "time_this_iter_s": 1.7377169132232666, "time_total_s": 9.347567558288574, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.347567558288574, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 61.400000000000006, "ram_util_percent": 81.5}}
{"timers": {"training_iteration": 1.7996982524941008, "restore_env_runners": 1.167225661704625e-05, "training_step": 1.799561527403801, "env_runner_sampling_timer": 1.6581538009549295, "learner_update_timer": 0.13808203120840531, "synch_weights": 0.0007198014779380377, "restore_eval_env_runners": 1.3026812190017664e-05, "evaluation_iteration": 0.11878297564106365, "synch_eval_env_connectors": 0.00012227415265826858, "synch_env_connectors": 4.446166341784411e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.115591219613965e-05, "un_batch_to_individual_items": 5.381350811830345e-06, "remove_single_ts_time_rank_from_batch": 5.899501487585217e-07, "get_actions": 4.001646860524257e-05, "normalize_and_clip_actions": 9.501058006442287e-06, "tensor_to_numpy": 1.3429360409108846e-05}}, "connector_pipeline_timer": 0.00010580340844983314}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.766692119757557e-06, "batch_individual_items": 6.349097509893673e-06, "add_observations_from_episodes_to_batch": 2.982911822264407e-06, "add_states_from_episodes_to_batch": 1.7311299225579067e-06, "add_time_dim_to_batch_and_zero_pad": 2.497513583578479e-06}}, "connector_pipeline_timer": 4.432055383871298e-05}, "num_episodes_lifetime": -123000.0, "module_episode_returns_mean": {"default_policy": 3.98}, "env_step_timer": 1.3910901971279569e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "sample": 0.005245510539107454, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -2460000.0, "agent_episode_returns_mean": {"default_agent": 3.98}, "episode_return_mean": 3.98, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 5.0, "time_between_sampling": 0.0015467545296350283, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.004619446821045132, "rlmodule_inference_timer": 2.8280236448194236e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 3.578545641864626e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3677.074521325065}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008535836515367655, "add_columns_from_episodes_to_train_batch": 0.037574003803377144, "add_states_from_episodes_to_batch": 3.813561567199254e-06, "numpy_to_tensor": 0.00013260407571057296, "add_time_dim_to_batch_and_zero_pad": 1.6727282271021526e-05, "general_advantage_estimation": 0.007264335831531049, "batch_individual_items": 0.05249888957892565, "add_one_ts_to_episodes_and_truncate": 0.008256613064958255}}, "connector_pipeline_timer": 0.10679436206432606}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 189000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1751395.1772393403, "num_module_steps_trained_throughput": 334340.4512845688, "num_module_steps_trained_lifetime_throughput": 333859.2159106437}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.07849463820457458, "curr_kl_coeff": 0.011664004996418953, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00046910226228646934, "vf_loss_unclipped": 27.55246925354004, "gradients_default_optimizer_global_norm": 0.053384359925985336, "num_module_steps_trained": 6000, "weights_seq_no": 6.0, "total_loss": -0.015575570054352283, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 36000, "vf_explained_var": -0.018162131309509277, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6439688205718994, "num_module_steps_trained_lifetime_throughput": 334917.5608745044}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.627051352423936e-07, "listify_data_for_vector_env": 1.0984425051383419e-05, "get_actions": 3.6843121508414556e-05, "tensor_to_numpy": 1.3212883752475524e-05, "normalize_and_clip_actions": 9.550554591831626e-06, "un_batch_to_individual_items": 5.299803068528191e-06}}, "connector_pipeline_timer": 0.00010179413747202969}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_connector": {"connector_pipeline_timer": 4.227307785935063e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2262302175209513e-06, "batch_individual_items": 6.079373190309609e-06, "add_observations_from_episodes_to_batch": 2.819934687942863e-06, "add_states_from_episodes_to_batch": 1.6053777883058312e-06, "numpy_to_tensor": 8.33628591969809e-06}}}, "rlmodule_inference_timer": 2.7177599368354418e-05, "num_episodes": 20, "env_reset_timer": 0.0001634356250715461, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_step_timer": 1.3679473565693625e-05, "episode_len_min": 20, "sample": 0.11179002134651549, "weights_seq_no": 6.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004657398753333836, "num_episodes_lifetime": 120, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.0}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 30400, "episode_return_mean": 1.0, "agent_episode_returns_mean": {"default_agent": 1.0}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "time_between_sampling": 1.7704512822404928}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "43786_00000", "date": "2025-08-11_19-20-18", "timestamp": 1754932818, "time_this_iter_s": 1.7088661193847656, "time_total_s": 11.05643367767334, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.05643367767334, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 50.15, "ram_util_percent": 81.35}}
{"timers": {"training_iteration": 1.798765607469065, "restore_env_runners": 1.1611783606076124e-05, "training_step": 1.798628332960825, "env_runner_sampling_timer": 1.6576683204460705, "learner_update_timer": 0.13763374881662863, "synch_weights": 0.0007199542921229206, "restore_eval_env_runners": 1.2958634180013884e-05, "evaluation_iteration": 0.1186282308848886, "synch_eval_env_connectors": 0.0001221672415140181, "synch_env_connectors": 4.444205584059144e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.2818448881800348e-05, "un_batch_to_individual_items": 6.1169864121958724e-06, "remove_single_ts_time_rank_from_batch": 6.444430774500149e-07, "get_actions": 4.766269541078046e-05, "normalize_and_clip_actions": 1.0582754800595329e-05, "tensor_to_numpy": 1.5504963141652786e-05}}, "connector_pipeline_timer": 0.00012185495044773484}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0251688374008407e-05, "batch_individual_items": 7.312340801954822e-06, "add_observations_from_episodes_to_batch": 3.4058769551497925e-06, "add_states_from_episodes_to_batch": 1.8886658100384221e-06, "add_time_dim_to_batch_and_zero_pad": 2.870340564187244e-06}}, "connector_pipeline_timer": 4.9766323870633136e-05}, "num_episodes_lifetime": -153875.0, "module_episode_returns_mean": {"default_policy": 3.98}, "env_step_timer": 1.64546417925711e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "sample": 0.005371033827871203, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -3077500.0, "agent_episode_returns_mean": {"default_agent": 3.98}, "episode_return_mean": 3.98, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 6.0, "time_between_sampling": 0.0019350331006037684, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.0053038854985497895, "rlmodule_inference_timer": 3.24756873951322e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 4.05250879546707e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3293.726148179442}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008541257339700035, "add_columns_from_episodes_to_train_batch": 0.03754789917616444, "add_states_from_episodes_to_batch": 3.8087568223195315e-06, "numpy_to_tensor": 0.000131924285508759, "add_time_dim_to_batch_and_zero_pad": 1.6744179651594742e-05, "general_advantage_estimation": 0.007246388723224158, "batch_individual_items": 0.05227534151278037, "add_one_ts_to_episodes_and_truncate": 0.008255731934640746}}, "connector_pipeline_timer": 0.10652493552393952}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 220500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1768564.057874939, "num_module_steps_trained_throughput": 337591.29705537274, "num_module_steps_trained_lifetime_throughput": 337121.72200492723}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.02193720079958439, "curr_kl_coeff": 0.0058320024982094765, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0006850841455161572, "vf_loss_unclipped": 27.66732406616211, "gradients_default_optimizer_global_norm": 0.07997886091470718, "num_module_steps_trained": 6000, "weights_seq_no": 7.0, "total_loss": 0.04111754521727562, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 42000, "vf_explained_var": -0.018402576446533203, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6286616325378418, "num_module_steps_trained_lifetime_throughput": 338113.9317842544}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.028269441817103e-07, "listify_data_for_vector_env": 1.2200502058789636e-05, "get_actions": 4.252541395756917e-05, "tensor_to_numpy": 1.5185597642088949e-05, "normalize_and_clip_actions": 1.027558952528813e-05, "un_batch_to_individual_items": 5.742084365979641e-06}}, "connector_pipeline_timer": 0.00011409110340128758}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_connector": {"connector_pipeline_timer": 4.6100924018884156e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.8087397490520277e-06, "batch_individual_items": 6.729334874806688e-06, "add_observations_from_episodes_to_batch": 3.040506209334906e-06, "add_states_from_episodes_to_batch": 1.66419307949023e-06, "numpy_to_tensor": 9.356005463206508e-06}}}, "rlmodule_inference_timer": 3.0220913736768437e-05, "num_episodes": 20, "env_reset_timer": 0.0001626525186087871, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_step_timer": 1.6466497728492347e-05, "episode_len_min": 20, "sample": 0.11176311696306841, "weights_seq_no": 7.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004767486244672909, "num_episodes_lifetime": 140, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.4}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 35400, "episode_return_mean": 1.4, "agent_episode_returns_mean": {"default_agent": 1.4}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "time_between_sampling": 1.7699935448286916}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "43786_00000", "date": "2025-08-11_19-20-19", "timestamp": 1754932819, "time_this_iter_s": 1.8228161334991455, "time_total_s": 12.879249811172485, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.879249811172485, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 51.06666666666667, "ram_util_percent": 81.96666666666667}}
{"timers": {"training_iteration": 1.7971542305538233, "restore_env_runners": 1.1559825746333843e-05, "training_step": 1.7970161408811074, "env_runner_sampling_timer": 1.656428036821729, "learner_update_timer": 0.13725869007836228, "synch_weights": 0.0007194405789230826, "restore_eval_env_runners": 1.293862841649622e-05, "evaluation_iteration": 0.11858385648639042, "synch_eval_env_connectors": 0.00012204681846215131, "synch_env_connectors": 4.448513608386799e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1466199630647225e-05, "un_batch_to_individual_items": 5.594179767473619e-06, "remove_single_ts_time_rank_from_batch": 6.018846951565895e-07, "get_actions": 4.138952661680228e-05, "normalize_and_clip_actions": 9.694178777324552e-06, "tensor_to_numpy": 1.3874891307566972e-05}}, "connector_pipeline_timer": 0.0001088248331284593}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.961509390988518e-06, "batch_individual_items": 6.611272781755293e-06, "add_observations_from_episodes_to_batch": 3.1408660283934335e-06, "add_states_from_episodes_to_batch": 1.7616747949050833e-06, "add_time_dim_to_batch_and_zero_pad": 2.562049019578752e-06}}, "connector_pipeline_timer": 4.573420530574528e-05}, "num_episodes_lifetime": -184750.0, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "env_step_timer": 1.4383625063780572e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "sample": 0.005576564011614639, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -3695000.0, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "episode_return_mean": 3.339999999999999, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 7.0, "time_between_sampling": 0.0016286468404684072, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.005124952532351018, "rlmodule_inference_timer": 4.4423267801274684e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 4.026673961466823e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3578.3712185419827}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008576953162281844, "add_columns_from_episodes_to_train_batch": 0.03754245018474299, "add_states_from_episodes_to_batch": 3.8039989607353876e-06, "numpy_to_tensor": 0.00013178170236996463, "add_time_dim_to_batch_and_zero_pad": 1.693131797060571e-05, "general_advantage_estimation": 0.007232423166173381, "batch_individual_items": 0.052076550598204284, "add_one_ts_to_episodes_and_truncate": 0.008254832955353559}}, "connector_pipeline_timer": 0.10630874825897407}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1784354.5310089365, "num_module_steps_trained_throughput": 340577.2171665328, "num_module_steps_trained_lifetime_throughput": 340120.3988821859}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.07748422771692276, "curr_kl_coeff": 0.0029160012491047382, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0005429149605333805, "vf_loss_unclipped": 27.65814781188965, "gradients_default_optimizer_global_norm": 0.016191862523555756, "num_module_steps_trained": 6000, "weights_seq_no": 8.0, "total_loss": -0.014293914660811424, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 48000, "vf_explained_var": -0.018987655639648438, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6131623983383179, "num_module_steps_trained_lifetime_throughput": 341050.2411870186}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.84169378509763e-07, "listify_data_for_vector_env": 1.1077129247421089e-05, "get_actions": 3.8335993258220604e-05, "tensor_to_numpy": 1.3867958651874571e-05, "normalize_and_clip_actions": 9.747307488791733e-06, "un_batch_to_individual_items": 5.467988019927798e-06}}, "connector_pipeline_timer": 0.00010519097533759361}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_connector": {"connector_pipeline_timer": 4.321141951213599e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2997761427505682e-06, "batch_individual_items": 6.277152521246767e-06, "add_observations_from_episodes_to_batch": 2.932189104394303e-06, "add_states_from_episodes_to_batch": 1.6216893674171357e-06, "numpy_to_tensor": 8.708914536074034e-06}}}, "rlmodule_inference_timer": 2.877001077383196e-05, "num_episodes": 20, "env_reset_timer": 0.00016199890304273093, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_step_timer": 1.4121234287619215e-05, "episode_len_min": 20, "sample": 0.11172645871360964, "weights_seq_no": 8.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004776795823127031, "num_episodes_lifetime": 160, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.0}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 40400, "episode_return_mean": 1.0, "agent_episode_returns_mean": {"default_agent": 1.0}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "time_between_sampling": 1.768853084799749}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "43786_00000", "date": "2025-08-11_19-20-21", "timestamp": 1754932821, "time_this_iter_s": 1.7533888816833496, "time_total_s": 14.632638692855835, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.632638692855835, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.666666666666668, "ram_util_percent": 81.36666666666666}}
{"timers": {"training_iteration": 1.795779522828699, "restore_env_runners": 1.1493807610283377e-05, "training_step": 1.7956413032216487, "env_runner_sampling_timer": 1.6545797247936813, "learner_update_timer": 0.13773337442744105, "synch_weights": 0.0007181274228056536, "restore_eval_env_runners": 1.3337581428910619e-05, "evaluation_iteration": 0.11853044709148311, "synch_eval_env_connectors": 0.00012205343063385948, "synch_env_connectors": 4.4431987356380405e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1875216736251839e-05, "un_batch_to_individual_items": 5.4688796661428555e-06, "remove_single_ts_time_rank_from_batch": 5.854883871039618e-07, "get_actions": 4.234434466883319e-05, "normalize_and_clip_actions": 9.613155558207677e-06, "tensor_to_numpy": 1.4299776730311811e-05}}, "connector_pipeline_timer": 0.00011038988650247081}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.178750700290746e-06, "batch_individual_items": 6.484417358565227e-06, "add_observations_from_episodes_to_batch": 3.0902766414494113e-06, "add_states_from_episodes_to_batch": 1.750535600843628e-06, "add_time_dim_to_batch_and_zero_pad": 2.9051711073713994e-06}}, "connector_pipeline_timer": 4.603543504902014e-05}, "num_episodes_lifetime": -215625.0, "module_episode_returns_mean": {"default_policy": 5.259999999999999}, "env_step_timer": 1.5293091035109153e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "sample": 0.005341694015977645, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -4312500.0, "agent_episode_returns_mean": {"default_agent": 5.259999999999999}, "episode_return_mean": 5.259999999999999, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 8.0, "time_between_sampling": 0.0015950398579409378, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.004883347170893102, "rlmodule_inference_timer": 2.932718303630245e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 3.8068125925716986e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3620.44495699701}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008576241926758329, "add_columns_from_episodes_to_train_batch": 0.03750745235188596, "add_states_from_episodes_to_batch": 3.798039541363882e-06, "numpy_to_tensor": 0.00013113347600942984, "add_time_dim_to_batch_and_zero_pad": 1.6870754163784285e-05, "general_advantage_estimation": 0.007214263933676288, "batch_individual_items": 0.051857028842367904, "add_one_ts_to_episodes_and_truncate": 0.009173390036778221}}, "connector_pipeline_timer": 0.10695302702614122}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 283500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1800857.4405869439, "num_module_steps_trained_throughput": 343699.37067604304, "num_module_steps_trained_lifetime_throughput": 343255.2590912598}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": 0.06147141009569168, "curr_kl_coeff": 0.0014580006245523691, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0004298215499147773, "vf_loss_unclipped": 27.53458595275879, "gradients_default_optimizer_global_norm": 0.05883348360657692, "num_module_steps_trained": 6000, "weights_seq_no": 9.0, "total_loss": 0.12476349622011185, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 54000, "vf_explained_var": -0.019598960876464844, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6017114520072937, "num_module_steps_trained_lifetime_throughput": 344124.06019045407}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.74087435471041e-07, "listify_data_for_vector_env": 1.098272459056096e-05, "get_actions": 3.67592858645743e-05, "tensor_to_numpy": 1.333593697158416e-05, "normalize_and_clip_actions": 9.556766070519537e-06, "un_batch_to_individual_items": 5.419459079948235e-06}}, "connector_pipeline_timer": 0.00010212804873728058}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_connector": {"connector_pipeline_timer": 4.2236527239416256e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2381625154781396e-06, "batch_individual_items": 5.972819585384673e-06, "add_observations_from_episodes_to_batch": 2.8002415787600504e-06, "add_states_from_episodes_to_batch": 1.6033911164886858e-06, "numpy_to_tensor": 8.429567984005091e-06}}}, "rlmodule_inference_timer": 2.7222926150880984e-05, "num_episodes": 20, "env_reset_timer": 0.0001612022543910053, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3802172862176497e-05, "episode_len_min": 20, "sample": 0.11157982454637978, "weights_seq_no": 9.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.00469937999965623, "num_episodes_lifetime": 180, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 0.4}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 45400, "episode_return_mean": 0.4, "agent_episode_returns_mean": {"default_agent": 0.4}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "time_between_sampling": 1.76792605062183}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "43786_00000", "date": "2025-08-11_19-20-23", "timestamp": 1754932823, "time_this_iter_s": 1.763617992401123, "time_total_s": 16.396256685256958, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.396256685256958, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.0, "ram_util_percent": 81.3}}
{"timers": {"training_iteration": 1.7942181330108993, "restore_env_runners": 1.1435959608004471e-05, "training_step": 1.7940794010197192, "env_runner_sampling_timer": 1.652462883386157, "learner_update_timer": 0.13829076776310015, "synch_weights": 0.0007161140680215172, "restore_eval_env_runners": 1.3261705470378272e-05, "evaluation_iteration": 0.11836253721029416, "synch_eval_env_connectors": 0.00012187123601503221, "synch_env_connectors": 4.443767090933862e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1182036450848735e-05, "un_batch_to_individual_items": 5.4043413094562855e-06, "remove_single_ts_time_rank_from_batch": 5.76404686659613e-07, "get_actions": 4.132872275183193e-05, "normalize_and_clip_actions": 9.539463506541785e-06, "tensor_to_numpy": 1.3476972249194074e-05}}, "connector_pipeline_timer": 0.00010859553853466719}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.949305425992394e-06, "batch_individual_items": 6.5535457700283805e-06, "add_observations_from_episodes_to_batch": 3.0582591051856372e-06, "add_states_from_episodes_to_batch": 1.7531413414004928e-06, "add_time_dim_to_batch_and_zero_pad": 2.528001340706136e-06}}, "connector_pipeline_timer": 4.511791436715171e-05}, "num_episodes_lifetime": -246500.0, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "env_step_timer": 1.4322600235293402e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "sample": 0.005194492999706577, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -4930000.0, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "episode_return_mean": 5.100000000000001, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 9.0, "time_between_sampling": 0.0018559987679070105, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.004771479208953677, "rlmodule_inference_timer": 2.8380740397781096e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 3.722892281985313e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3668.8926250600375}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008578408710200094, "add_columns_from_episodes_to_train_batch": 0.03749224365818132, "add_states_from_episodes_to_batch": 3.792559975497887e-06, "numpy_to_tensor": 0.00013052630144231689, "add_time_dim_to_batch_and_zero_pad": 1.6822466631044222e-05, "general_advantage_estimation": 0.007195758793562056, "batch_individual_items": 0.052626231473694066, "add_one_ts_to_episodes_and_truncate": 0.009164486556407192}}, "connector_pipeline_timer": 0.1076783017552518}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 315000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1817936.2535814964, "num_module_steps_trained_throughput": 346931.8560935896, "num_module_steps_trained_lifetime_throughput": 346500.13113995944}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": 0.044248078018426895, "curr_kl_coeff": 0.0007290003122761846, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 5.7940360420616344e-05, "vf_loss_unclipped": 27.54096031188965, "gradients_default_optimizer_global_norm": 0.018817108124494553, "num_module_steps_trained": 6000, "weights_seq_no": 10.0, "total_loss": 0.10759363323450089, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 60000, "vf_explained_var": -0.02006387710571289, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.5956794023513794, "num_module_steps_trained_lifetime_throughput": 347307.94568859925}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.749782262900423e-07, "listify_data_for_vector_env": 1.0785935511641245e-05, "get_actions": 3.612182112695502e-05, "tensor_to_numpy": 1.3126080803270004e-05, "normalize_and_clip_actions": 9.28781620832338e-06, "un_batch_to_individual_items": 5.2460424150541284e-06}}, "connector_pipeline_timer": 0.00010048395520620891}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_connector": {"connector_pipeline_timer": 4.1940513556382195e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2120184306646137e-06, "batch_individual_items": 5.9661707561950615e-06, "add_observations_from_episodes_to_batch": 2.8414161672378052e-06, "add_states_from_episodes_to_batch": 1.6068480991909861e-06, "numpy_to_tensor": 8.30998407080115e-06}}}, "rlmodule_inference_timer": 2.678334228021905e-05, "num_episodes": 20, "env_reset_timer": 0.00016039857211157954, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3528625111475414e-05, "episode_len_min": 20, "sample": 0.11143310421074694, "weights_seq_no": 10.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004670804563211277, "num_episodes_lifetime": 200, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -0.4}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 50400, "episode_return_mean": -0.4, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "time_between_sampling": 1.7668189776154533}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "43786_00000", "date": "2025-08-11_19-20-25", "timestamp": 1754932825, "time_this_iter_s": 1.7434720993041992, "time_total_s": 18.139728784561157, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.139728784561157, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 63.23333333333333, "ram_util_percent": 80.56666666666666}}
{"timers": {"training_iteration": 1.7916815308400593, "restore_env_runners": 1.1375350130165141e-05, "training_step": 1.791542272009862, "env_runner_sampling_timer": 1.6502968887128941, "learner_update_timer": 0.13791468466572318, "synch_weights": 0.000720463757713874, "restore_eval_env_runners": 1.3185337970874828e-05, "evaluation_iteration": 0.1181953685080862, "synch_eval_env_connectors": 0.00012153627310823279, "synch_env_connectors": 4.432659126663575e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1444016183839682e-05, "un_batch_to_individual_items": 5.462752658578166e-06, "remove_single_ts_time_rank_from_batch": 5.888598906872648e-07, "get_actions": 4.056406131573635e-05, "normalize_and_clip_actions": 9.670262424345518e-06, "tensor_to_numpy": 1.363639123660071e-05}}, "connector_pipeline_timer": 0.00010739537992842402}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.897096922903258e-06, "batch_individual_items": 6.483247622017822e-06, "add_observations_from_episodes_to_batch": 3.075156947691542e-06, "add_states_from_episodes_to_batch": 1.7571406410235996e-06, "add_time_dim_to_batch_and_zero_pad": 2.572211642467095e-06}}, "connector_pipeline_timer": 4.512133465100064e-05}, "num_episodes_lifetime": -277375.0, "module_episode_returns_mean": {"default_policy": 5.980000000000002}, "env_step_timer": 1.4167690969412148e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "sample": 0.00498684466051899, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -5547500.0, "agent_episode_returns_mean": {"default_agent": 5.980000000000002}, "episode_return_mean": 5.980000000000002, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 10.0, "time_between_sampling": 0.0019057094746673573, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.004718332646414637, "rlmodule_inference_timer": 2.9056328252399682e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 3.586792626415085e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3639.351230653044}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008586728820440041, "add_columns_from_episodes_to_train_batch": 0.03747797497126662, "add_states_from_episodes_to_batch": 3.7887941236265854e-06, "numpy_to_tensor": 0.0001299831175717904, "add_time_dim_to_batch_and_zero_pad": 1.6825082613668025e-05, "general_advantage_estimation": 0.007182341625767507, "batch_individual_items": 0.05240756665946205, "add_one_ts_to_episodes_and_truncate": 0.009152699190647469}}, "connector_pipeline_timer": 0.10741971915758905}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 346500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1830379.6215308201, "num_module_steps_trained_throughput": 349279.8217550952, "num_module_steps_trained_lifetime_throughput": 348861.3454605804}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": 0.0011768140830099583, "curr_kl_coeff": 0.0003645001561380923, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 8.655712736072019e-05, "vf_loss_unclipped": 27.205020904541016, "gradients_default_optimizer_global_norm": 0.06588909029960632, "num_module_steps_trained": 6000, "weights_seq_no": 11.0, "total_loss": 0.06442416459321976, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 66000, "vf_explained_var": -0.020464658737182617, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6065216660499573, "num_module_steps_trained_lifetime_throughput": 349611.6996951301}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.657718206387041e-07, "listify_data_for_vector_env": 1.0707832405777647e-05, "get_actions": 3.603610520264248e-05, "tensor_to_numpy": 1.3085779462169835e-05, "normalize_and_clip_actions": 9.256016628067029e-06, "un_batch_to_individual_items": 5.2803618191738865e-06}}, "connector_pipeline_timer": 0.00010012512526486297}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_connector": {"connector_pipeline_timer": 4.183109490279534e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.287417007641843e-06, "batch_individual_items": 5.9211609930111194e-06, "add_observations_from_episodes_to_batch": 2.7904170383442064e-06, "add_states_from_episodes_to_batch": 1.615296753401501e-06, "numpy_to_tensor": 8.210405839294887e-06}}}, "rlmodule_inference_timer": 2.7034540564851293e-05, "num_episodes": 20, "env_reset_timer": 0.00016283625628074828, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3501679234761665e-05, "episode_len_min": 20, "sample": 0.11130165691933334, "weights_seq_no": 11.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004668519184924662, "num_episodes_lifetime": 220, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 55400, "episode_return_mean": 0.0, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "time_between_sampling": 1.7647596240899113}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "43786_00000", "date": "2025-08-11_19-20-26", "timestamp": 1754932826, "time_this_iter_s": 1.6486468315124512, "time_total_s": 19.78837561607361, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.78837561607361, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 79.85, "ram_util_percent": 82.25}}
{"timers": {"training_iteration": 1.7906093634414062, "restore_env_runners": 1.1312846145991362e-05, "training_step": 1.7904696601296435, "env_runner_sampling_timer": 1.6496431639849458, "learner_update_timer": 0.13749431074006935, "synch_weights": 0.000719483700711516, "restore_eval_env_runners": 1.3279734276677072e-05, "evaluation_iteration": 0.11807034649259632, "synch_eval_env_connectors": 0.00012140258101159898, "synch_env_connectors": 4.425832238863832e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.141992138673114e-05, "un_batch_to_individual_items": 5.511117089117175e-06, "remove_single_ts_time_rank_from_batch": 5.880219751438713e-07, "get_actions": 4.0750861492888224e-05, "normalize_and_clip_actions": 9.60549581232377e-06, "tensor_to_numpy": 1.3701853612916208e-05}}, "connector_pipeline_timer": 0.00010751984553181443}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.958310976633983e-06, "batch_individual_items": 6.552314009050954e-06, "add_observations_from_episodes_to_batch": 3.1329877021420237e-06, "add_states_from_episodes_to_batch": 1.7531870033986016e-06, "add_time_dim_to_batch_and_zero_pad": 2.543900905842194e-06}}, "connector_pipeline_timer": 4.543177563526128e-05}, "num_episodes_lifetime": -308250.0, "module_episode_returns_mean": {"default_policy": 5.740000000000001}, "env_step_timer": 1.418955108971168e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "sample": 0.005049013945313239, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -6165000.0, "agent_episode_returns_mean": {"default_agent": 5.740000000000001}, "episode_return_mean": 5.740000000000001, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 11.0, "time_between_sampling": 0.002118723140963941, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.0047063576630316665, "rlmodule_inference_timer": 2.8559764841678932e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 3.8464457005335454e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3583.8857707695215}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008584682438237715, "add_columns_from_episodes_to_train_batch": 0.037446291471989294, "add_states_from_episodes_to_batch": 3.8017366043596144e-06, "numpy_to_tensor": 0.00012939703688326598, "add_time_dim_to_batch_and_zero_pad": 1.674767182730612e-05, "general_advantage_estimation": 0.007171185289616046, "batch_individual_items": 0.05218822141333394, "add_one_ts_to_episodes_and_truncate": 0.00913980135857523}}, "connector_pipeline_timer": 0.1071428840456242}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 378000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1842899.6526057476, "num_module_steps_trained_throughput": 351646.6017849363, "num_module_steps_trained_lifetime_throughput": 351241.1274445196}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.19873479008674622, "curr_kl_coeff": 0.00018225007806904614, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 1.5084176993696019e-05, "vf_loss_unclipped": 26.743595123291016, "gradients_default_optimizer_global_norm": 0.020691007375717163, "num_module_steps_trained": 6000, "weights_seq_no": 12.0, "total_loss": -0.13557009398937225, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 72000, "vf_explained_var": -0.020839571952819824, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6156450510025024, "num_module_steps_trained_lifetime_throughput": 351935.00878998695}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.848932877742831e-07, "listify_data_for_vector_env": 1.0879640585615364e-05, "get_actions": 3.632074805939765e-05, "tensor_to_numpy": 1.3210303957650332e-05, "normalize_and_clip_actions": 9.48506329344946e-06, "un_batch_to_individual_items": 5.319582284592944e-06}}, "connector_pipeline_timer": 0.000101238137246947}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_connector": {"connector_pipeline_timer": 4.2202621624053e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.295338545601739e-06, "batch_individual_items": 6.109078221757847e-06, "add_observations_from_episodes_to_batch": 2.83918845759524e-06, "add_states_from_episodes_to_batch": 1.613817474099887e-06, "numpy_to_tensor": 8.345715080239309e-06}}}, "rlmodule_inference_timer": 2.7097421232336282e-05, "num_episodes": 20, "env_reset_timer": 0.0001623778944778255, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.361813120156002e-05, "episode_len_min": 20, "sample": 0.11120392077010062, "weights_seq_no": 12.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004594222924206406, "num_episodes_lifetime": 240, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -0.8}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 60400, "episode_return_mean": -0.8, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "time_between_sampling": 1.764161236599262}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "43786_00000", "date": "2025-08-11_19-20-28", "timestamp": 1754932828, "time_this_iter_s": 1.7946431636810303, "time_total_s": 21.58301877975464, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.58301877975464, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 80.35, "ram_util_percent": 82.6}}
{"timers": {"training_iteration": 1.7942681531371307, "restore_env_runners": 1.1266387575188516e-05, "training_step": 1.7941280231076953, "env_runner_sampling_timer": 1.6536933340158906, "learner_update_timer": 0.13710201346304102, "synch_weights": 0.0007191651139677043, "restore_eval_env_runners": 1.3217766344016244e-05, "evaluation_iteration": 0.11796792969688741, "synch_eval_env_connectors": 0.00012132563487250827, "synch_env_connectors": 4.417824483538883e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.4830163233955495e-05, "un_batch_to_individual_items": 6.978144105953693e-06, "remove_single_ts_time_rank_from_batch": 7.098954969006149e-07, "get_actions": 5.635188894376912e-05, "normalize_and_clip_actions": 1.2253854095892495e-05, "tensor_to_numpy": 1.7737907087367546e-05}}, "connector_pipeline_timer": 0.0001405415478856736}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2050166010280775e-05, "batch_individual_items": 8.189382043371887e-06, "add_observations_from_episodes_to_batch": 3.665784400559856e-06, "add_states_from_episodes_to_batch": 2.0766883966468848e-06, "add_time_dim_to_batch_and_zero_pad": 3.2199764501700165e-06}}, "connector_pipeline_timer": 5.5841086757754385e-05}, "num_episodes_lifetime": -339125.0, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "env_step_timer": 1.8805194450182227e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "sample": 0.006187411585437406, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -6782500.0, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "episode_return_mean": 6.940000000000001, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 12.0, "time_between_sampling": 0.0022998126101073106, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.006077522174920885, "rlmodule_inference_timer": 3.864070103600691e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 5.417322053265875e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2996.4632404600306}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008583560612888253, "add_columns_from_episodes_to_train_batch": 0.03741896105729764, "add_states_from_episodes_to_batch": 3.7899697292347737e-06, "numpy_to_tensor": 0.0001288643156170854, "add_time_dim_to_batch_and_zero_pad": 1.667019463018424e-05, "general_advantage_estimation": 0.00715542551584836, "batch_individual_items": 0.05197908960972201, "add_one_ts_to_episodes_and_truncate": 0.00912464209430544}}, "connector_pipeline_timer": 0.10687377270551524}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 409500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1850142.1850403086, "num_module_steps_trained_throughput": 353008.7776137079, "num_module_steps_trained_lifetime_throughput": 352615.27719091024}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.037887606769800186, "curr_kl_coeff": 9.112503903452307e-05, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 7.769689545966685e-05, "vf_loss_unclipped": 26.886669158935547, "gradients_default_optimizer_global_norm": 0.05055728554725647, "num_module_steps_trained": 6000, "weights_seq_no": 13.0, "total_loss": 0.02526637353003025, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 78000, "vf_explained_var": -0.02140367031097412, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6168266534805298, "num_module_steps_trained_lifetime_throughput": 353257.1489950899}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.766214075102099e-07, "listify_data_for_vector_env": 1.0741438984018133e-05, "get_actions": 3.5924386941415795e-05, "tensor_to_numpy": 1.2897032421752949e-05, "normalize_and_clip_actions": 9.228788100984025e-06, "un_batch_to_individual_items": 5.226022042803079e-06}}, "connector_pipeline_timer": 9.975931435952956e-05}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_connector": {"connector_pipeline_timer": 4.185672658539742e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.298767346576355e-06, "batch_individual_items": 5.912615699713049e-06, "add_observations_from_episodes_to_batch": 2.7824747262234173e-06, "add_states_from_episodes_to_batch": 1.6334583329042491e-06, "numpy_to_tensor": 8.200091018129373e-06}}}, "rlmodule_inference_timer": 2.708444081517538e-05, "num_episodes": 20, "env_reset_timer": 0.00016376494637500579, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3419454636787235e-05, "episode_len_min": 20, "sample": 0.11112424156177131, "weights_seq_no": 13.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004544970875140279, "num_episodes_lifetime": 260, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 65400, "episode_return_mean": -0.6, "agent_episode_returns_mean": {"default_agent": -0.6}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "time_between_sampling": 1.7682952729843326}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "43786_00000", "date": "2025-08-11_19-20-30", "timestamp": 1754932830, "time_this_iter_s": 2.2697348594665527, "time_total_s": 23.85275363922119, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.85275363922119, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.2, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 1.7937184707665614, "restore_env_runners": 1.1209552995325174e-05, "training_step": 1.7935778974564365, "env_runner_sampling_timer": 1.6523055548452168, "learner_update_timer": 0.13793774665894865, "synch_weights": 0.0007199580428344776, "restore_eval_env_runners": 1.3179758198555108e-05, "evaluation_iteration": 0.11789761914981274, "synch_eval_env_connectors": 0.00012107362914933392, "synch_env_connectors": 4.409487023834353e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1988152946455218e-05, "un_batch_to_individual_items": 5.677051941467802e-06, "remove_single_ts_time_rank_from_batch": 6.036519237938567e-07, "get_actions": 4.3562105876149936e-05, "normalize_and_clip_actions": 1.0037453874277642e-05, "tensor_to_numpy": 1.4353752882659561e-05}}, "connector_pipeline_timer": 0.00011313676890007875}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.561857041992861e-06, "batch_individual_items": 7.06789209685261e-06, "add_observations_from_episodes_to_batch": 3.185335669984585e-06, "add_states_from_episodes_to_batch": 1.8087821268908105e-06, "add_time_dim_to_batch_and_zero_pad": 2.6593612600173824e-06}}, "connector_pipeline_timer": 4.745803037262526e-05}, "num_episodes_lifetime": -370000.0, "module_episode_returns_mean": {"default_policy": 6.62}, "env_step_timer": 1.5050482402084977e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "sample": 0.0055669245779321344, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -7400000.0, "agent_episode_returns_mean": {"default_agent": 6.62}, "episode_return_mean": 6.62, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 13.0, "time_between_sampling": 0.0019580663864302936, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.004968790160026401, "rlmodule_inference_timer": 3.088779312899856e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 4.719595045050403e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3454.724953147666}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008590320903908664, "add_columns_from_episodes_to_train_batch": 0.03746167686685851, "add_states_from_episodes_to_batch": 3.7912391311243165e-06, "numpy_to_tensor": 0.00012826942163166494, "add_time_dim_to_batch_and_zero_pad": 1.666182334233312e-05, "general_advantage_estimation": 0.007147102930754727, "batch_individual_items": 0.05289508704331548, "add_one_ts_to_episodes_and_truncate": 0.009123483593324048}}, "connector_pipeline_timer": 0.10782262455896058}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 441000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1852199.937275323, "num_module_steps_trained_throughput": 353384.840723166, "num_module_steps_trained_lifetime_throughput": 353003.22045515466}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": 0.021915465593338013, "curr_kl_coeff": 4.5562519517261535e-05, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 6.392585055436939e-05, "vf_loss_unclipped": 27.137771606445312, "gradients_default_optimizer_global_norm": 0.02799815684556961, "num_module_steps_trained": 6000, "weights_seq_no": 14.0, "total_loss": 0.08509045839309692, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 84000, "vf_explained_var": -0.022045254707336426, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6145032048225403, "num_module_steps_trained_lifetime_throughput": 353595.5525986432}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.785209145973214e-07, "listify_data_for_vector_env": 1.0765563811276806e-05, "get_actions": 3.615329281152e-05, "tensor_to_numpy": 1.311113853453396e-05, "normalize_and_clip_actions": 9.347512417833116e-06, "un_batch_to_individual_items": 5.280532037170344e-06}}, "connector_pipeline_timer": 0.00010039890199870877}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_connector": {"connector_pipeline_timer": 4.197159360800743e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2523010132803414e-06, "batch_individual_items": 5.932419201868015e-06, "add_observations_from_episodes_to_batch": 2.819437361454738e-06, "add_states_from_episodes_to_batch": 1.6197535371145966e-06, "numpy_to_tensor": 8.266863343419924e-06}}}, "rlmodule_inference_timer": 2.701279038347613e-05, "num_episodes": 20, "env_reset_timer": 0.00016300020693399132, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3683229865553593e-05, "episode_len_min": 20, "sample": 0.1110200770566253, "weights_seq_no": 14.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004574132530251518, "num_episodes_lifetime": 280, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -1.0}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 70400, "episode_return_mean": -1.0, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "time_between_sampling": 1.768267271504204}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "43786_00000", "date": "2025-08-11_19-20-32", "timestamp": 1754932832, "time_this_iter_s": 1.8483738899230957, "time_total_s": 25.701127529144287, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.701127529144287, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 48.8, "ram_util_percent": 82.55}}
{"timers": {"training_iteration": 1.8020999493989576, "restore_env_runners": 1.1149117928585843e-05, "training_step": 1.8019590322311962, "env_runner_sampling_timer": 1.6592944734668702, "learner_update_timer": 0.13932937003236184, "synch_weights": 0.0007197013825600935, "restore_eval_env_runners": 1.3114630507226624e-05, "evaluation_iteration": 0.11778080962818627, "synch_eval_env_connectors": 0.00012137206267294877, "synch_env_connectors": 4.403301638995732e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.8113147015659565e-05, "un_batch_to_individual_items": 8.136345533445589e-06, "remove_single_ts_time_rank_from_batch": 7.746622754804813e-07, "get_actions": 6.964915650216783e-05, "normalize_and_clip_actions": 1.3986599585382598e-05, "tensor_to_numpy": 2.5627862962778704e-05}}, "connector_pipeline_timer": 0.0001784467425238407}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.545738494706753e-05, "batch_individual_items": 9.437091504313556e-06, "add_observations_from_episodes_to_batch": 4.528068735981577e-06, "add_states_from_episodes_to_batch": 2.166742766124007e-06, "add_time_dim_to_batch_and_zero_pad": 3.645686991857689e-06}}, "connector_pipeline_timer": 6.51408449687767e-05}, "num_episodes_lifetime": -400875.0, "module_episode_returns_mean": {"default_policy": 6.46}, "env_step_timer": 3.07680776231804e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "sample": 0.007682825989605757, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -8017500.0, "agent_episode_returns_mean": {"default_agent": 6.46}, "episode_return_mean": 6.46, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 14.0, "time_between_sampling": 0.002298331649437642, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.007809105320367962, "rlmodule_inference_timer": 4.88433814268146e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 6.627785111941906e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2837.962323303747}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008605025992958933, "add_columns_from_episodes_to_train_batch": 0.037463953007597535, "add_states_from_episodes_to_batch": 3.7862466645192936e-06, "numpy_to_tensor": 0.0001276821471459669, "add_time_dim_to_batch_and_zero_pad": 1.682436477476257e-05, "general_advantage_estimation": 0.007132200651161822, "batch_individual_items": 0.054438972002922595, "add_one_ts_to_episodes_and_truncate": 0.00912129042724384}}, "connector_pipeline_timer": 0.10935206539279918}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 472500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1855231.4585844264, "num_module_steps_trained_throughput": 353946.90962603176, "num_module_steps_trained_lifetime_throughput": 353576.125190326}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": 0.14473199844360352, "curr_kl_coeff": 2.2781259758630767e-05, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 2.6270066882716492e-05, "vf_loss_unclipped": 27.49070930480957, "gradients_default_optimizer_global_norm": 0.07249045372009277, "num_module_steps_trained": 6000, "weights_seq_no": 15.0, "total_loss": 0.20799577236175537, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 90000, "vf_explained_var": -0.022460103034973145, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6047009825706482, "num_module_steps_trained_lifetime_throughput": 354120.3955379191}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.747185339084229e-07, "listify_data_for_vector_env": 1.0906739249047583e-05, "get_actions": 3.680077212939438e-05, "tensor_to_numpy": 1.328044674203481e-05, "normalize_and_clip_actions": 9.315962918964286e-06, "un_batch_to_individual_items": 5.370974039695029e-06}}, "connector_pipeline_timer": 0.00010160574238317902}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_connector": {"connector_pipeline_timer": 4.213829928567521e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.230758724949778e-06, "batch_individual_items": 5.979921766950139e-06, "add_observations_from_episodes_to_batch": 2.853114883181609e-06, "add_states_from_episodes_to_batch": 1.606934287353337e-06, "numpy_to_tensor": 8.291611362952912e-06}}}, "rlmodule_inference_timer": 2.7953144390451152e-05, "num_episodes": 20, "env_reset_timer": 0.00016428436442336483, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.371778282942252e-05, "episode_len_min": 20, "sample": 0.1109006942065967, "weights_seq_no": 15.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004582224611658603, "num_episodes_lifetime": 300, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -1.2}, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 75400, "episode_return_mean": -1.2, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "time_between_sampling": 1.7771058142093783}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "43786_00000", "date": "2025-08-11_19-20-35", "timestamp": 1754932835, "time_this_iter_s": 2.742069959640503, "time_total_s": 28.44319748878479, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.44319748878479, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 51.25, "ram_util_percent": 83.6}}
{"timers": {"training_iteration": 1.7989752769944864, "restore_env_runners": 1.1098046301328163e-05, "training_step": 1.798833980658825, "env_runner_sampling_timer": 1.656642434142765, "learner_update_timer": 0.13885882050140383, "synch_weights": 0.0007180672783804523, "restore_eval_env_runners": 1.3094324394219002e-05, "evaluation_iteration": 0.1176813440315815, "synch_eval_env_connectors": 0.00012121000197485404, "synch_env_connectors": 4.3992689271855095e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1166638347599973e-05, "un_batch_to_individual_items": 5.399486661636078e-06, "remove_single_ts_time_rank_from_batch": 5.822284303767069e-07, "get_actions": 3.961990666769617e-05, "normalize_and_clip_actions": 9.43822146673914e-06, "tensor_to_numpy": 1.3358462143804789e-05}}, "connector_pipeline_timer": 0.0001051689985478191}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.69802765207339e-06, "batch_individual_items": 6.436121496983841e-06, "add_observations_from_episodes_to_batch": 3.025234448331713e-06, "add_states_from_episodes_to_batch": 1.7438451267826618e-06, "add_time_dim_to_batch_and_zero_pad": 2.4963953313107595e-06}}, "connector_pipeline_timer": 4.439636101651577e-05}, "num_episodes_lifetime": -431750.0, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "env_step_timer": 1.3915663585868903e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "sample": 0.005697558970057125, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -8635000.0, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "episode_return_mean": 6.7799999999999985, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 15.0, "time_between_sampling": 0.0023953397888665084, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.004589253977406769, "rlmodule_inference_timer": 2.7693512195949998e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 4.354159188298545e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3662.82431614406}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008603475736169763, "add_columns_from_episodes_to_train_batch": 0.03743168056757356, "add_states_from_episodes_to_batch": 3.776713866440685e-06, "numpy_to_tensor": 0.0001269919960322412, "add_time_dim_to_batch_and_zero_pad": 1.674612064816613e-05, "general_advantage_estimation": 0.007114049894688054, "batch_individual_items": 0.05419530895226823, "add_one_ts_to_episodes_and_truncate": 0.009109758773470963}}, "connector_pipeline_timer": 0.1090445397389132}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1862029.3619614395, "num_module_steps_trained_throughput": 355226.43707258155, "num_module_steps_trained_lifetime_throughput": 354865.6760635352}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": 0.08797918260097504, "curr_kl_coeff": 1.1390629879315384e-05, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 7.574491610284895e-05, "vf_loss_unclipped": 27.252580642700195, "gradients_default_optimizer_global_norm": 0.0359240286052227, "num_module_steps_trained": 6000, "weights_seq_no": 16.0, "total_loss": 0.15125392377376556, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 96000, "vf_explained_var": -0.022913694381713867, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6034906506538391, "num_module_steps_trained_lifetime_throughput": 355361.68754164677}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.733403240550579e-07, "listify_data_for_vector_env": 1.0652510491016579e-05, "get_actions": 3.552859274640683e-05, "tensor_to_numpy": 1.290476220400811e-05, "normalize_and_clip_actions": 9.154244150449924e-06, "un_batch_to_individual_items": 5.207761863606266e-06}}, "connector_pipeline_timer": 9.924953342608161e-05}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_connector": {"connector_pipeline_timer": 4.187603463170594e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.203849696790895e-06, "batch_individual_items": 5.86015521569231e-06, "add_observations_from_episodes_to_batch": 2.770855125244301e-06, "add_states_from_episodes_to_batch": 1.590272807316745e-06, "numpy_to_tensor": 8.190532700835963e-06}}}, "rlmodule_inference_timer": 2.6632410099630295e-05, "num_episodes": 20, "env_reset_timer": 0.00016343944070815875, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3315081386638162e-05, "episode_len_min": 20, "sample": 0.11075502684428805, "weights_seq_no": 16.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004572458316106349, "num_episodes_lifetime": 320, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -1.0}, "episode_return_max": 11.5, "num_env_steps_sampled_lifetime": 80400, "episode_return_mean": -1.0, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "time_between_sampling": 1.7744822373171627}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "43786_00000", "date": "2025-08-11_19-20-37", "timestamp": 1754932837, "time_this_iter_s": 1.5934069156646729, "time_total_s": 30.036604404449463, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.036604404449463, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 45.35, "ram_util_percent": 82.2}}
{"timers": {"training_iteration": 1.796896553383866, "restore_env_runners": 1.1034985877238504e-05, "training_step": 1.7967550662624459, "env_runner_sampling_timer": 1.655037697721487, "learner_update_timer": 0.13838665437570707, "synch_weights": 0.0007165670248684596, "restore_eval_env_runners": 1.3027961385907086e-05, "evaluation_iteration": 0.11751924809192253, "synch_eval_env_connectors": 0.00012090165156074626, "synch_env_connectors": 4.393196200692342e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1325311964285478e-05, "un_batch_to_individual_items": 5.455904148378455e-06, "remove_single_ts_time_rank_from_batch": 5.934766042301844e-07, "get_actions": 3.996818826743055e-05, "normalize_and_clip_actions": 9.630598111107741e-06, "tensor_to_numpy": 1.3462089320544895e-05}}, "connector_pipeline_timer": 0.00010626018626776696}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.775469800203112e-06, "batch_individual_items": 6.494364223428648e-06, "add_observations_from_episodes_to_batch": 3.10712403630955e-06, "add_states_from_episodes_to_batch": 1.7386981127758446e-06, "add_time_dim_to_batch_and_zero_pad": 2.5045864580108305e-06}}, "connector_pipeline_timer": 4.4669334874440185e-05}, "num_episodes_lifetime": -462625.0, "module_episode_returns_mean": {"default_policy": 6.62}, "env_step_timer": 1.404364872762738e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "sample": 0.005258297335025681, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -9252500.0, "agent_episode_returns_mean": {"default_agent": 6.62}, "episode_return_mean": 6.62, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 16.0, "time_between_sampling": 0.0015774839950516211, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.0049877678160555675, "rlmodule_inference_timer": 4.407249605451753e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 3.705903671685651e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3623.9171601800454}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008623140968752761, "add_columns_from_episodes_to_train_batch": 0.03740124960158176, "add_states_from_episodes_to_batch": 3.7664463550982365e-06, "numpy_to_tensor": 0.00012625665639390127, "add_time_dim_to_batch_and_zero_pad": 1.6661989529048187e-05, "general_advantage_estimation": 0.007095035235024863, "batch_individual_items": 0.05395608336342079, "add_one_ts_to_episodes_and_truncate": 0.009095157435266718}}, "connector_pipeline_timer": 0.10874140601166164}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 535500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1873528.4358152205, "num_module_steps_trained_throughput": 357403.4952642314, "num_module_steps_trained_lifetime_throughput": 357051.12386998854}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.07086284458637238, "curr_kl_coeff": 5.695314939657692e-06, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0002801602240651846, "vf_loss_unclipped": 26.885883331298828, "gradients_default_optimizer_global_norm": 0.03156490996479988, "num_module_steps_trained": 6000, "weights_seq_no": 17.0, "total_loss": -0.007574191316962242, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 102000, "vf_explained_var": -0.023396968841552734, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6019554734230042, "num_module_steps_trained_lifetime_throughput": 357500.86110112077}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.681148819549558e-07, "listify_data_for_vector_env": 1.0744212916679776e-05, "get_actions": 3.5864311308778026e-05, "tensor_to_numpy": 1.3065447260188686e-05, "normalize_and_clip_actions": 9.276588726489919e-06, "un_batch_to_individual_items": 5.326801093632332e-06}}, "connector_pipeline_timer": 0.00010028368977581644}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_connector": {"connector_pipeline_timer": 4.189785457084338e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2694741000696766e-06, "batch_individual_items": 5.9499677343273535e-06, "add_observations_from_episodes_to_batch": 2.7924938226119387e-06, "add_states_from_episodes_to_batch": 1.6045829043212517e-06, "numpy_to_tensor": 8.133984741130181e-06}}}, "rlmodule_inference_timer": 2.6599227626287574e-05, "num_episodes": 20, "env_reset_timer": 0.00016253046626013055, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.333734623554229e-05, "episode_len_min": 20, "sample": 0.1106144211562772, "weights_seq_no": 17.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004534957478754222, "num_episodes_lifetime": 340, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -1.0}, "episode_return_max": 11.5, "num_env_steps_sampled_lifetime": 85400, "episode_return_mean": -1.0, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "time_between_sampling": 1.7728173182739466}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "43786_00000", "date": "2025-08-11_19-20-38", "timestamp": 1754932838, "time_this_iter_s": 1.6951498985290527, "time_total_s": 31.731754302978516, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.731754302978516, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 46.9, "ram_util_percent": 82.2}}
{"timers": {"training_iteration": 1.794952784099857, "restore_env_runners": 1.0979216177951458e-05, "training_step": 1.7948109514392732, "env_runner_sampling_timer": 1.6526530649145859, "learner_update_timer": 0.13882993616258074, "synch_weights": 0.0007147096849116571, "restore_eval_env_runners": 1.2953090808624762e-05, "evaluation_iteration": 0.11736075644108106, "synch_eval_env_connectors": 0.00012073930541308005, "synch_env_connectors": 4.3900945845097795e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1332992658020033e-05, "un_batch_to_individual_items": 5.417119566065981e-06, "remove_single_ts_time_rank_from_batch": 5.814076008743116e-07, "get_actions": 4.041912341086696e-05, "normalize_and_clip_actions": 9.527268421971904e-06, "tensor_to_numpy": 1.3562046744788485e-05}}, "connector_pipeline_timer": 0.00010660450961828439}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.850448915137419e-06, "batch_individual_items": 6.50939529293005e-06, "add_observations_from_episodes_to_batch": 3.043698387216868e-06, "add_states_from_episodes_to_batch": 1.7570912217202352e-06, "add_time_dim_to_batch_and_zero_pad": 2.520868386148545e-06}}, "connector_pipeline_timer": 4.486417818692322e-05}, "num_episodes_lifetime": -493500.0, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "env_step_timer": 1.4128031642790167e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "sample": 0.005093937933929196, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -9870000.0, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "episode_return_mean": 6.7799999999999985, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 17.0, "time_between_sampling": 0.001506304999124668, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.004665617841761559, "rlmodule_inference_timer": 2.8504007059406154e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 3.7045378975975623e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3632.960725592695}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008630513659467678, "add_columns_from_episodes_to_train_batch": 0.03738711335571562, "add_states_from_episodes_to_batch": 3.7591919019148863e-06, "numpy_to_tensor": 0.00012562617031228125, "add_time_dim_to_batch_and_zero_pad": 1.660161956968271e-05, "general_advantage_estimation": 0.00707873779242287, "batch_individual_items": 0.054601652109176044, "add_one_ts_to_episodes_and_truncate": 0.009084031281312317}}, "connector_pipeline_timer": 0.10934477362100341}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 567000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1886577.0228064938, "num_module_steps_trained_throughput": 359876.36874962813, "num_module_steps_trained_lifetime_throughput": 359531.63064035535}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.1494331955909729, "curr_kl_coeff": 2.847657469828846e-06, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0001861961354734376, "vf_loss_unclipped": 26.647491455078125, "gradients_default_optimizer_global_norm": 0.02470725029706955, "num_module_steps_trained": 6000, "weights_seq_no": 18.0, "total_loss": -0.08611404895782471, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 108000, "vf_explained_var": -0.02406442165374756, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.5985884666442871, "num_module_steps_trained_lifetime_throughput": 359938.46198391105}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.658092000666756e-07, "listify_data_for_vector_env": 1.0872642932246942e-05, "get_actions": 3.6289563429134136e-05, "tensor_to_numpy": 1.3091739279063479e-05, "normalize_and_clip_actions": 9.263875445928184e-06, "un_batch_to_individual_items": 5.269884461438767e-06}}, "connector_pipeline_timer": 0.00010061613009448133}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_connector": {"connector_pipeline_timer": 4.2161320496273596e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.311289329997195e-06, "batch_individual_items": 6.023137320506031e-06, "add_observations_from_episodes_to_batch": 2.7924471839390604e-06, "add_states_from_episodes_to_batch": 1.617923909900307e-06, "numpy_to_tensor": 8.21456966724138e-06}}}, "rlmodule_inference_timer": 2.6971921009607924e-05, "num_episodes": 20, "env_reset_timer": 0.0001616255815185102, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3587346771902636e-05, "episode_len_min": 20, "sample": 0.1104833048556138, "weights_seq_no": 18.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.004490901206154376, "num_episodes_lifetime": 360, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -1.0}, "episode_return_max": 11.5, "num_env_steps_sampled_lifetime": 90400, "episode_return_mean": -1.0, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "time_between_sampling": 1.7712869880013944}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "43786_00000", "date": "2025-08-11_19-20-40", "timestamp": 1754932840, "time_this_iter_s": 1.7072460651397705, "time_total_s": 33.439000368118286, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.439000368118286, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 43.85, "ram_util_percent": 81.3}}
{"timers": {"training_iteration": 1.793226554177772, "restore_env_runners": 1.0924424434969078e-05, "training_step": 1.7930844127642873, "env_runner_sampling_timer": 1.6504713751044797, "learner_update_timer": 0.13928707805085264, "synch_weights": 0.0007132413379386373, "restore_eval_env_runners": 1.2883560357408116e-05, "evaluation_iteration": 0.11721024054702879, "synch_eval_env_connectors": 0.00012049149242463177, "synch_env_connectors": 4.382022782263357e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1382062915612806e-05, "un_batch_to_individual_items": 5.511353199035269e-06, "remove_single_ts_time_rank_from_batch": 5.935640905052786e-07, "get_actions": 4.0821619606546085e-05, "normalize_and_clip_actions": 9.664033147307293e-06, "tensor_to_numpy": 1.364117390997575e-05}}, "connector_pipeline_timer": 0.00010767252517934119}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.977487580618659e-06, "batch_individual_items": 6.545332097219626e-06, "add_observations_from_episodes_to_batch": 3.0709625481646043e-06, "add_states_from_episodes_to_batch": 1.7509504167774157e-06, "add_time_dim_to_batch_and_zero_pad": 2.5433367161481025e-06}}, "connector_pipeline_timer": 4.5290746728395116e-05}, "num_episodes_lifetime": -524375.0, "module_episode_returns_mean": {"default_policy": 7.1}, "env_step_timer": 1.4205005711930947e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "sample": 0.005011460931681078, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -10487500.0, "agent_episode_returns_mean": {"default_agent": 7.1}, "episode_return_mean": 7.1, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 18.0, "time_between_sampling": 0.0018438875655466314, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.004727296174969524, "rlmodule_inference_timer": 2.9551023890997574e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 3.732958249606417e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3609.652379881131}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008627466828549283, "add_columns_from_episodes_to_train_batch": 0.03736414805243187, "add_states_from_episodes_to_batch": 3.7495198695294915e-06, "numpy_to_tensor": 0.00012492907933957045, "add_time_dim_to_batch_and_zero_pad": 1.658435421560347e-05, "general_advantage_estimation": 0.007060502494513362, "batch_individual_items": 0.05527795558919099, "add_one_ts_to_episodes_and_truncate": 0.009071075969000022}}, "connector_pipeline_timer": 0.10996496338369925}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 598500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1901838.9646916348, "num_module_steps_trained_throughput": 362773.09514572116, "num_module_steps_trained_lifetime_throughput": 362434.70964215323}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.019801601767539978, "curr_kl_coeff": 1.423828734914423e-06, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00044902059016749263, "vf_loss_unclipped": 26.865428924560547, "gradients_default_optimizer_global_norm": 0.021649973466992378, "num_module_steps_trained": 6000, "weights_seq_no": 19.0, "total_loss": 0.04370664060115814, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 114000, "vf_explained_var": -0.024727582931518555, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.577710747718811, "num_module_steps_trained_lifetime_throughput": 362803.22088475147}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.714776542074582e-07, "listify_data_for_vector_env": 1.076381585650628e-05, "get_actions": 3.5775880344304584e-05, "tensor_to_numpy": 1.2901576541960843e-05, "normalize_and_clip_actions": 9.217193408368902e-06, "un_batch_to_individual_items": 5.248763720248311e-06}}, "connector_pipeline_timer": 9.950317728929755e-05}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_connector": {"connector_pipeline_timer": 4.190096441282742e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2674607523993246e-06, "batch_individual_items": 5.929377283941069e-06, "add_observations_from_episodes_to_batch": 2.771730344704022e-06, "add_states_from_episodes_to_batch": 1.6189759142169166e-06, "numpy_to_tensor": 8.254215499141434e-06}}}, "rlmodule_inference_timer": 2.6876832600513113e-05, "num_episodes": 20, "env_reset_timer": 0.0001607655759320579, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3493906361193009e-05, "episode_len_min": 20, "sample": 0.11035775888659309, "weights_seq_no": 19.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.00446550956577994, "num_episodes_lifetime": 380, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_return_max": 11.5, "num_env_steps_sampled_lifetime": 95400, "episode_return_mean": -0.6, "agent_episode_returns_mean": {"default_agent": -0.6}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "time_between_sampling": 1.7699846722915233}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "43786_00000", "date": "2025-08-11_19-20-42", "timestamp": 1754932842, "time_this_iter_s": 1.727855920791626, "time_total_s": 35.16685628890991, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.16685628890991, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 32.03333333333333, "ram_util_percent": 81.6}}
{"timers": {"training_iteration": 1.7905093328054482, "restore_env_runners": 1.0866849967059054e-05, "training_step": 1.790366735307518, "env_runner_sampling_timer": 1.6482042221928273, "learner_update_timer": 0.13883832102035482, "synch_weights": 0.0007124151751389062, "restore_eval_env_runners": 1.2815144305862214e-05, "evaluation_iteration": 0.11706910230143089, "synch_eval_env_connectors": 0.00012029074696263414, "synch_env_connectors": 4.37861264095329e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1277013301666255e-05, "un_batch_to_individual_items": 5.477374834245574e-06, "remove_single_ts_time_rank_from_batch": 5.807578857839109e-07, "get_actions": 4.0308970953799405e-05, "normalize_and_clip_actions": 9.504183991220843e-06, "tensor_to_numpy": 1.3535962396629347e-05}}, "connector_pipeline_timer": 0.00010638240477001702}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.802995445007068e-06, "batch_individual_items": 6.4766600771287415e-06, "add_observations_from_episodes_to_batch": 3.0608555543123948e-06, "add_states_from_episodes_to_batch": 1.736243909669659e-06, "add_time_dim_to_batch_and_zero_pad": 2.493022995858863e-06}}, "connector_pipeline_timer": 4.462482924792262e-05}, "num_episodes_lifetime": -555250.0, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "env_step_timer": 1.4080409517476329e-05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "sample": 0.00502634973272812, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -11105000.0, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "episode_return_mean": 6.940000000000001, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 19.0, "time_between_sampling": 0.0018811559858958298, "episode_len_max": 20, "episode_return_max": 9.5, "episode_duration_sec_mean": 0.004684765500947832, "rlmodule_inference_timer": 2.7935380284374777e-05, "num_episodes": 250.0, "episode_len_mean": 20.0, "env_reset_timer": 3.90239862815143e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3647.012093022234}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008624079659856988, "add_columns_from_episodes_to_train_batch": 0.03733431699192524, "add_states_from_episodes_to_batch": 3.761193846161021e-06, "numpy_to_tensor": 0.00012454936909070608, "add_time_dim_to_batch_and_zero_pad": 1.652892129297454e-05, "general_advantage_estimation": 0.00704322787914162, "batch_individual_items": 0.05503619770306688, "add_one_ts_to_episodes_and_truncate": 0.009056653539911549}}, "connector_pipeline_timer": 0.10966014459017606}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 630000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1914867.3243928563, "num_module_steps_trained_throughput": 365242.24943573336, "num_module_steps_trained_lifetime_throughput": 364911.2463048521}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "policy_loss": -0.08537109941244125, "curr_kl_coeff": 7.119143674572115e-07, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0002637100697029382, "vf_loss_unclipped": 26.72565269470215, "gradients_default_optimizer_global_norm": 0.0137735391035676, "num_module_steps_trained": 6000, "weights_seq_no": 20.0, "total_loss": -0.021787814795970917, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime": 120000, "vf_explained_var": -0.02492392063140869, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.5694254040718079, "num_module_steps_trained_lifetime_throughput": 365237.3202992964}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.812847487701937e-07, "listify_data_for_vector_env": 1.1197301199254519e-05, "get_actions": 3.8017583838425216e-05, "tensor_to_numpy": 1.3515450882733761e-05, "normalize_and_clip_actions": 9.927532150834637e-06, "un_batch_to_individual_items": 5.7198645741774954e-06}}, "connector_pipeline_timer": 0.00010485674027879282}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_connector": {"connector_pipeline_timer": 4.300410719347171e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.377625760849489e-06, "batch_individual_items": 6.070743019819401e-06, "add_observations_from_episodes_to_batch": 2.8505444057516868e-06, "add_states_from_episodes_to_batch": 1.6478322141818606e-06, "numpy_to_tensor": 8.572267887065443e-06}}}, "rlmodule_inference_timer": 2.8089693596849888e-05, "num_episodes": 20, "env_reset_timer": 0.00016000166932150848, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.4250150467164604e-05, "episode_len_min": 20, "sample": 0.1102318317070587, "weights_seq_no": 20.0, "episode_len_max": 20, "episode_duration_sec_mean": 0.00446266915416345, "num_episodes_lifetime": 400, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_return_max": 11.5, "num_env_steps_sampled_lifetime": 100400, "episode_return_mean": -0.6, "agent_episode_returns_mean": {"default_agent": -0.6}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "time_between_sampling": 1.767670288908816}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "43786_00000", "date": "2025-08-11_19-20-43", "timestamp": 1754932843, "time_this_iter_s": 1.6263771057128906, "time_total_s": 36.7932333946228, "pid": 14176, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15dc49b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.7932333946228, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 40.9, "ram_util_percent": 80.1}}
