{"timers": {"training_iteration": 1.5446640830487013, "restore_env_runners": 1.2082979083061218e-05, "training_step": 1.5445362080354244, "env_runner_sampling_timer": 1.437245084089227, "learner_update_timer": 0.10425729199778289, "synch_weights": 0.000592124997638166}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3444331023708216e-05, "normalize_and_clip_actions": 1.2445023272804789e-05, "get_actions": 4.90935098404969e-05, "un_batch_to_individual_items": 5.451253152012417e-06, "remove_single_ts_time_rank_from_batch": 5.817593189588048e-07, "listify_data_for_vector_env": 1.095059739392723e-05}}, "connector_pipeline_timer": 0.00011814929157461613}, "env_to_module_connector": {"connector_pipeline_timer": 4.5903888902612295e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4502602416830408e-06, "add_observations_from_episodes_to_batch": 3.1136190079816305e-06, "numpy_to_tensor": 8.850588034286803e-06, "add_states_from_episodes_to_batch": 1.7547667996647742e-06, "batch_individual_items": 6.368865872755331e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004843370650894942, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "sample": 0.005716821530394412, "num_episodes_lifetime": 31375.0, "weights_seq_no": 0.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -4.459999999999999}, "num_env_steps_sampled_lifetime": 627500.0, "time_between_sampling": 0.0005021444458592776, "episode_return_mean": -4.459999999999999, "env_reset_timer": 8.734023297248786e-05, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4477818985125352e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "module_episode_returns_mean": {"default_policy": -4.459999999999999}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 4.8782270165155806e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3546.3885426920465}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.035620804876089096, "mean_kl_loss": 0.0003655994951259345, "vf_loss": 0.1004081591963768, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6885641813278198, "curr_kl_coeff": 0.3732481598854065, "num_module_steps_trained": 6000, "vf_loss_unclipped": 30.21761131286621, "num_module_steps_trained_lifetime": 6000, "policy_loss": -0.02556947059929371, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.013725519180297852, "weights_seq_no": 1.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.01337447576224804, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 452833.67380645534}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.500026650726795e-06, "batch_individual_items": 0.03044025006238371, "add_one_ts_to_episodes_and_truncate": 0.007544457912445068, "numpy_to_tensor": 5.691708065569401e-05, "general_advantage_estimation": 0.00651674997061491, "add_time_dim_to_batch_and_zero_pad": 1.066701952368021e-05, "add_observations_from_episodes_to_batch": 0.0008044579299166799, "add_columns_from_episodes_to_train_batch": 0.034106167033314705}}, "connector_pipeline_timer": 0.07960641698446125}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_out": 5250, "learner_connector_sum_episodes_length_in": 5000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2356160.115260839, "num_module_steps_trained_throughput": 451258.91341768845, "num_module_steps_trained_lifetime_throughput": 450342.3097670653}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_episodes_lifetime": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.240107540242655e-06, "add_time_dim_to_batch_and_zero_pad": 2.262796517932582e-06, "add_observations_from_episodes_to_batch": 2.8524722825424325e-06, "add_states_from_episodes_to_batch": 1.5732047784394257e-06, "batch_individual_items": 6.207980487728654e-06}}, "connector_pipeline_timer": 4.376174696249162e-05}, "episode_return_mean": -2.4, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.184236160122892e-07, "tensor_to_numpy": 1.4153641344643413e-05, "normalize_and_clip_actions": 1.0420552940580413e-05, "listify_data_for_vector_env": 1.0868516890850043e-05, "get_actions": 3.874511130936663e-05, "un_batch_to_individual_items": 5.426576566913878e-06}}, "connector_pipeline_timer": 0.00010583807910839792}, "env_reset_timer": 0.0001415410079061985, "env_step_timer": 1.3941098222454403e-05, "episode_len_mean": 20.0, "sample": 0.09752083290368319, "weights_seq_no": 1.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.4}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "module_episode_returns_mean": {"default_policy": -2.4}, "num_episodes": 20, "episode_duration_sec_mean": 0.004469185555353761, "num_env_steps_sampled_lifetime": 5400, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "rlmodule_inference_timer": 2.9124647355396848e-05, "episode_return_max": 13.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-01", "timestamp": 1754932981, "time_this_iter_s": 1.6498332023620605, "time_total_s": 1.6498332023620605, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.6498332023620605, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.333333333333332, "ram_util_percent": 78.66666666666667}}
{"timers": {"training_iteration": 1.544883078468265, "restore_env_runners": 1.2027148623019457e-05, "training_step": 1.5447545276244636, "env_runner_sampling_timer": 1.4367088432481978, "learner_update_timer": 0.1050123432476539, "synch_weights": 0.0005916354071814566, "restore_eval_env_runners": 7.707974873483181e-06, "evaluation_iteration": 0.10356937500182539, "synch_eval_env_connectors": 0.000122333993203938, "synch_env_connectors": 4.66697383671999e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.331092941951074e-05, "normalize_and_clip_actions": 9.382918944044109e-06, "get_actions": 3.931603114429686e-05, "un_batch_to_individual_items": 5.325653683798907e-06, "remove_single_ts_time_rank_from_batch": 5.72809992846915e-07, "listify_data_for_vector_env": 1.0832158653934819e-05}}, "connector_pipeline_timer": 0.00010419148418434426}, "env_to_module_connector": {"connector_pipeline_timer": 4.358952866310785e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3352236667373652e-06, "add_observations_from_episodes_to_batch": 2.9265107813035214e-06, "numpy_to_tensor": 8.649562218921746e-06, "add_states_from_episodes_to_batch": 1.754149768967635e-06, "batch_individual_items": 6.277015591136921e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004546226228587328, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "sample": 0.005209141430808948, "num_episodes_lifetime": 500.0, "weights_seq_no": 1.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -5.5}, "num_env_steps_sampled_lifetime": 10000.0, "time_between_sampling": 0.001521437279094798, "episode_return_mean": -5.5, "env_reset_timer": 4.1117434956068334e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3844042980591955e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.8135288345258746e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3710.6335063438028}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": -0.05691200867295265, "mean_kl_loss": 0.0015927486820146441, "vf_loss": 0.10040832310914993, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6920790672302246, "curr_kl_coeff": 0.18662407994270325, "num_module_steps_trained": 6000, "vf_loss_unclipped": 30.189531326293945, "num_module_steps_trained_lifetime": 12000, "policy_loss": -0.11839213222265244, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.013575196266174316, "weights_seq_no": 2.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.0885528028011322, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 452604.29336511163}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.50044691003859e-06, "batch_individual_items": 0.03131914839148522, "add_one_ts_to_episodes_and_truncate": 0.007543253332842142, "numpy_to_tensor": 5.6866239756345745e-05, "general_advantage_estimation": 0.0065045349707361306, "add_time_dim_to_batch_and_zero_pad": 1.0685769375413658e-05, "add_observations_from_episodes_to_batch": 0.0008045533508993685, "add_columns_from_episodes_to_train_batch": 0.034108739112271}}, "connector_pipeline_timer": 0.08047428156482056}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2355286.092862154, "num_module_steps_trained_throughput": 451062.47274332837, "num_module_steps_trained_lifetime_throughput": 450155.52413320163}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 40, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.128669955052778e-06, "add_time_dim_to_batch_and_zero_pad": 2.2788622761737704e-06, "add_observations_from_episodes_to_batch": 2.7506421043316547e-06, "add_states_from_episodes_to_batch": 1.598193010960858e-06, "batch_individual_items": 6.0153237607832815e-06}}, "connector_pipeline_timer": 4.187367438992114e-05}, "episode_return_mean": -1.4, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.591537887926171e-07, "tensor_to_numpy": 1.2629840494726781e-05, "normalize_and_clip_actions": 9.069995714389772e-06, "listify_data_for_vector_env": 1.0577691713988392e-05, "get_actions": 3.467738764855089e-05, "un_batch_to_individual_items": 5.338003324074619e-06}}, "connector_pipeline_timer": 9.793810670690171e-05}, "env_reset_timer": 0.00014093642705120146, "env_step_timer": 1.3407964123625922e-05, "episode_len_mean": 20.0, "sample": 0.097502710823901, "weights_seq_no": 2.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.4}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "module_episode_returns_mean": {"default_policy": -1.4}, "num_episodes": 20, "episode_duration_sec_mean": 0.004431082252995111, "num_env_steps_sampled_lifetime": 10400, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "rlmodule_inference_timer": 2.6610778974424937e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6092530839378014}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-02", "timestamp": 1754932982, "time_this_iter_s": 1.6688728332519531, "time_total_s": 3.3187060356140137, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.3187060356140137, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.0, "ram_util_percent": 78.35}}
{"timers": {"training_iteration": 1.543999567683402, "restore_env_runners": 1.1968546989373862e-05, "training_step": 1.5438704231788987, "env_runner_sampling_timer": 1.435957972735341, "learner_update_timer": 0.10487867147562792, "synch_weights": 0.0005916423834278247, "restore_eval_env_runners": 7.708806078881025e-06, "evaluation_iteration": 0.10353663625195622, "synch_eval_env_connectors": 0.0001221602433361113, "synch_env_connectors": 4.659463884308934e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3046384961870658e-05, "normalize_and_clip_actions": 9.332374207503873e-06, "get_actions": 3.8532149843328714e-05, "un_batch_to_individual_items": 5.3304640492820835e-06, "remove_single_ts_time_rank_from_batch": 5.729369648188128e-07, "listify_data_for_vector_env": 1.0734560085652325e-05}}, "connector_pipeline_timer": 0.00010299489369354481}, "env_to_module_connector": {"connector_pipeline_timer": 4.320950734042722e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.308465675503218e-06, "add_observations_from_episodes_to_batch": 2.9158518400620923e-06, "numpy_to_tensor": 8.456825364992558e-06, "add_states_from_episodes_to_batch": 1.7431573830451627e-06, "batch_individual_items": 6.181568928117675e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004501192688941955, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "sample": 0.004842359286959552, "num_episodes_lifetime": -30375.0, "weights_seq_no": 2.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -3.100000000000002}, "num_env_steps_sampled_lifetime": -607500.0, "time_between_sampling": 0.0017911746405751283, "episode_return_mean": -3.100000000000002, "env_reset_timer": 3.2869949641471674e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3647937538806263e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "module_episode_returns_mean": {"default_policy": -3.100000000000002}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.7290881475741338e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3770.344628140487}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": -0.01838073693215847, "mean_kl_loss": 0.004396282602101564, "vf_loss": 0.09986981749534607, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6908020377159119, "curr_kl_coeff": 0.09331203997135162, "num_module_steps_trained": 6000, "vf_loss_unclipped": 28.8149471282959, "num_module_steps_trained_lifetime": 18000, "policy_loss": -0.07973822951316833, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012913346290588379, "weights_seq_no": 3.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.024950962513685226, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 452462.50855272805}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.49878262495622e-06, "batch_individual_items": 0.03130066398745403, "add_one_ts_to_episodes_and_truncate": 0.007543924139183946, "numpy_to_tensor": 5.694132731296122e-05, "general_advantage_estimation": 0.006492720460577401, "add_time_dim_to_batch_and_zero_pad": 1.0708501725457609e-05, "add_observations_from_episodes_to_batch": 0.000804917817399837, "add_columns_from_episodes_to_train_batch": 0.034120486300683116}}, "connector_pipeline_timer": 0.08045660667007323}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2355080.010025276, "num_module_steps_trained_throughput": 450973.7518544546, "num_module_steps_trained_lifetime_throughput": 450083.05269167514}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 60, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.026072295913047e-06, "add_time_dim_to_batch_and_zero_pad": 2.2891551675668117e-06, "add_observations_from_episodes_to_batch": 2.7236512132524398e-06, "add_states_from_episodes_to_batch": 1.6109132638646235e-06, "batch_individual_items": 6.10201901448199e-06}}, "connector_pipeline_timer": 4.173678380995526e-05}, "episode_return_mean": 0.26666666666666666, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.559769831177144e-07, "tensor_to_numpy": 1.2516856791884706e-05, "normalize_and_clip_actions": 9.157850226033995e-06, "listify_data_for_vector_env": 1.0660575734574637e-05, "get_actions": 3.4560624563479325e-05, "un_batch_to_individual_items": 5.318796698421493e-06}}, "connector_pipeline_timer": 9.773517346544945e-05}, "env_reset_timer": 0.00014035456267884, "env_step_timer": 1.3423529798982139e-05, "episode_len_mean": 20.0, "sample": 0.09748462579501793, "weights_seq_no": 3.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 0.26666666666666666}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "module_episode_returns_mean": {"default_policy": 0.26666666666666666}, "num_episodes": 20, "episode_duration_sec_mean": 0.00441931452951394, "num_env_steps_sampled_lifetime": 15400, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "rlmodule_inference_timer": 2.6685463657593716e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6079012180981227}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-04", "timestamp": 1754932984, "time_this_iter_s": 1.5593187808990479, "time_total_s": 4.8780248165130615, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.8780248165130615, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.066666666666668, "ram_util_percent": 78.43333333333332}}
{"timers": {"training_iteration": 1.5447259482568982, "restore_env_runners": 1.190928223566152e-05, "training_step": 1.544596105607203, "env_runner_sampling_timer": 1.4367937855085968, "learner_update_timer": 0.10476269767046731, "synch_weights": 0.0005922051299997838, "restore_eval_env_runners": 7.717137760482728e-06, "evaluation_iteration": 0.10350812738845123, "synch_eval_env_connectors": 0.00012194531096611172, "synch_env_connectors": 4.659118724521249e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.371707987386093e-05, "normalize_and_clip_actions": 9.577266353583456e-06, "get_actions": 4.1691978063614824e-05, "un_batch_to_individual_items": 5.481591757643576e-06, "remove_single_ts_time_rank_from_batch": 6.031697054133508e-07, "listify_data_for_vector_env": 1.1002406684383337e-05}}, "connector_pipeline_timer": 0.00010834994618518434}, "env_to_module_connector": {"connector_pipeline_timer": 4.435754474698149e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.376163676038729e-06, "add_observations_from_episodes_to_batch": 3.060001377848329e-06, "numpy_to_tensor": 8.752893593366629e-06, "add_states_from_episodes_to_batch": 1.7693143820080024e-06, "batch_individual_items": 6.378641731980724e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004766935806255788, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "sample": 0.004855342058794559, "num_episodes_lifetime": -61250.0, "weights_seq_no": 3.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "num_env_steps_sampled_lifetime": -1225000.0, "time_between_sampling": 0.0017556249444462657, "episode_return_mean": -1.9799999999999998, "env_reset_timer": 3.269918475215618e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4420282372844127e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.919986035453824e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3707.5332213014976}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.15422971546649933, "mean_kl_loss": 0.005344749428331852, "vf_loss": 0.1000857725739479, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6751035451889038, "curr_kl_coeff": 0.04665601998567581, "num_module_steps_trained": 6000, "vf_loss_unclipped": 29.42681121826172, "num_module_steps_trained_lifetime": 24000, "policy_loss": 0.09290732443332672, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.01295316219329834, "weights_seq_no": 4.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.022418634966015816, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 451751.1408032215}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5012956663267684e-06, "batch_individual_items": 0.031293864007459024, "add_one_ts_to_episodes_and_truncate": 0.0075462503188026605, "numpy_to_tensor": 5.712274397118017e-05, "general_advantage_estimation": 0.0064816211757360714, "add_time_dim_to_batch_and_zero_pad": 1.072558645461686e-05, "add_observations_from_episodes_to_batch": 0.0008058782188880723, "add_columns_from_episodes_to_train_batch": 0.034122222686931374}}, "connector_pipeline_timer": 0.08044376060393382}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2352036.5896556643, "num_module_steps_trained_throughput": 450329.5078065747, "num_module_steps_trained_lifetime_throughput": 449460.6441364694}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 80, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.223920228614732e-06, "add_time_dim_to_batch_and_zero_pad": 2.2766256602564895e-06, "add_observations_from_episodes_to_batch": 2.782160660232969e-06, "add_states_from_episodes_to_batch": 1.626876550178123e-06, "batch_individual_items": 6.1387881052692615e-06}}, "connector_pipeline_timer": 4.244100385647882e-05}, "episode_return_mean": 1.35, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.711601080065683e-07, "tensor_to_numpy": 1.2668625460823655e-05, "normalize_and_clip_actions": 9.24110971766347e-06, "listify_data_for_vector_env": 1.084169253129658e-05, "get_actions": 3.498819933094585e-05, "un_batch_to_individual_items": 5.392318665158634e-06}}, "connector_pipeline_timer": 9.910973283291854e-05}, "env_reset_timer": 0.00013989976700034455, "env_step_timer": 1.358982628359899e-05, "episode_len_mean": 20.0, "sample": 0.09749377869672049, "weights_seq_no": 4.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 1.35}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "module_episode_returns_mean": {"default_policy": 1.35}, "num_episodes": 20, "episode_duration_sec_mean": 0.004442284304241184, "num_env_steps_sampled_lifetime": 20400, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "rlmodule_inference_timer": 2.699396623157532e-05, "episode_return_max": 13.5, "time_between_sampling": 1.608187011757563}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-06", "timestamp": 1754932986, "time_this_iter_s": 1.7218880653381348, "time_total_s": 6.599912881851196, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.599912881851196, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.55, "ram_util_percent": 78.65}}
{"timers": {"training_iteration": 1.5446097187733991, "restore_env_runners": 1.1860188782166221e-05, "training_step": 1.5444795095514927, "env_runner_sampling_timer": 1.4368188043141055, "learner_update_timer": 0.10462098444393803, "synch_weights": 0.0005916889091520046, "restore_eval_env_runners": 7.749546961160376e-06, "evaluation_iteration": 0.10350422111422845, "synch_eval_env_connectors": 0.00012174877717043273, "synch_env_connectors": 4.652118059922941e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3030141206595186e-05, "normalize_and_clip_actions": 9.263089082513709e-06, "get_actions": 3.8709037238214294e-05, "un_batch_to_individual_items": 5.263297305032954e-06, "remove_single_ts_time_rank_from_batch": 5.761159824582075e-07, "listify_data_for_vector_env": 1.0650614834930277e-05}}, "connector_pipeline_timer": 0.0001027970640030463}, "env_to_module_connector": {"connector_pipeline_timer": 4.29959835511734e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.302964017138938e-06, "add_observations_from_episodes_to_batch": 2.907015034818253e-06, "numpy_to_tensor": 8.427701900653426e-06, "add_states_from_episodes_to_batch": 1.7254660339462459e-06, "batch_individual_items": 6.131061439046971e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004808467318769543, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "sample": 0.005044842173692869, "num_episodes_lifetime": -92125.0, "weights_seq_no": 4.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -2.6200000000000006}, "num_env_steps_sampled_lifetime": -1842500.0, "time_between_sampling": 0.0015831855812207004, "episode_return_mean": -2.6200000000000006, "env_reset_timer": 3.3898332077754854e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3600819431490056e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "module_episode_returns_mean": {"default_policy": -2.6200000000000006}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 4.499685290912115e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3750.090755284094}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": -0.028190553188323975, "mean_kl_loss": 0.006403516978025436, "vf_loss": 0.09976178407669067, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6418144702911377, "curr_kl_coeff": 0.023328009992837906, "num_module_steps_trained": 6000, "vf_loss_unclipped": 28.310836791992188, "num_module_steps_trained_lifetime": 30000, "policy_loss": -0.08939778804779053, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012333512306213379, "weights_seq_no": 5.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.3873364329338074, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 451479.740993624}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4925332005822566e-06, "batch_individual_items": 0.03128005036682192, "add_one_ts_to_episodes_and_truncate": 0.00754776239591188, "numpy_to_tensor": 5.7047767108739355e-05, "general_advantage_estimation": 0.00646915579333413, "add_time_dim_to_batch_and_zero_pad": 1.0692080860601272e-05, "add_observations_from_episodes_to_batch": 0.0008062769376524188, "add_columns_from_episodes_to_train_batch": 0.03412385004971351}}, "connector_pipeline_timer": 0.08042050966795941}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2351433.7549254578, "num_module_steps_trained_throughput": 450140.4542983141, "num_module_steps_trained_lifetime_throughput": 449295.9471903127}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 100, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.175502395684549e-06, "add_time_dim_to_batch_and_zero_pad": 2.270246875440348e-06, "add_observations_from_episodes_to_batch": 2.7292328751115076e-06, "add_states_from_episodes_to_batch": 1.6178537987242694e-06, "batch_individual_items": 6.05105781014958e-06}}, "connector_pipeline_timer": 4.200469431941776e-05}, "episode_return_mean": 1.8, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.559546683295544e-07, "tensor_to_numpy": 1.2612962146679127e-05, "normalize_and_clip_actions": 9.077756869088392e-06, "listify_data_for_vector_env": 1.0774992787432588e-05, "get_actions": 3.467097046630413e-05, "un_batch_to_individual_items": 5.354934659238376e-06}}, "connector_pipeline_timer": 9.818808105449996e-05}, "env_reset_timer": 0.0001392390985844319, "env_step_timer": 1.3421265525725118e-05, "episode_len_mean": 20.0, "sample": 0.09747506590914383, "weights_seq_no": 5.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 1.8}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "module_episode_returns_mean": {"default_policy": 1.8}, "num_episodes": 20, "episode_duration_sec_mean": 0.004431683712173253, "num_env_steps_sampled_lifetime": 25400, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "rlmodule_inference_timer": 2.667082366644837e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6076111720600617}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-07", "timestamp": 1754932987, "time_this_iter_s": 1.635472297668457, "time_total_s": 8.235385179519653, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.235385179519653, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.65, "ram_util_percent": 78.55000000000001}}
{"timers": {"training_iteration": 1.5445823428356908, "restore_env_runners": 1.1795337012585275e-05, "training_step": 1.544451749455678, "env_runner_sampling_timer": 1.4360236021105288, "learner_update_timer": 0.1053878191801296, "synch_weights": 0.0005912361792455513, "restore_eval_env_runners": 7.734551385377998e-06, "evaluation_iteration": 0.10347182265290251, "synch_eval_env_connectors": 0.00012144795994093874, "synch_env_connectors": 4.639767104586353e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.300887836978728e-05, "normalize_and_clip_actions": 9.319270087175225e-06, "get_actions": 3.837712455156107e-05, "un_batch_to_individual_items": 5.280627082600502e-06, "remove_single_ts_time_rank_from_batch": 5.725862538176337e-07, "listify_data_for_vector_env": 1.0684084163363024e-05}}, "connector_pipeline_timer": 0.00010258387199156438}, "env_to_module_connector": {"connector_pipeline_timer": 4.301696128754404e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3141466639705337e-06, "add_observations_from_episodes_to_batch": 2.889756580420116e-06, "numpy_to_tensor": 8.417437191300007e-06, "add_states_from_episodes_to_batch": 1.7340246198095207e-06, "batch_individual_items": 6.139796782403045e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004480300834402442, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "sample": 0.005056659805854489, "num_episodes_lifetime": -123000.0, "weights_seq_no": 5.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 0.26}, "num_env_steps_sampled_lifetime": -2460000.0, "time_between_sampling": 0.001470207799210588, "episode_return_mean": 0.26, "env_reset_timer": 3.215702832044894e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3577955377462404e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "module_episode_returns_mean": {"default_policy": 0.26}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.7450461356038916e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3777.7881075652817}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": -0.017150528728961945, "mean_kl_loss": 0.00032041617669165134, "vf_loss": 0.0991143062710762, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6319625973701477, "curr_kl_coeff": 0.011664004996418953, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.507795333862305, "num_module_steps_trained_lifetime": 36000, "policy_loss": -0.07772266864776611, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.010851740837097168, "weights_seq_no": 6.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.12068164348602295, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 451165.4302414107}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.490107533970859e-06, "batch_individual_items": 0.032164934453159946, "add_one_ts_to_episodes_and_truncate": 0.0075493581015467475, "numpy_to_tensor": 5.70231189721826e-05, "general_advantage_estimation": 0.006457901735428729, "add_time_dim_to_batch_and_zero_pad": 1.0673080395498616e-05, "add_observations_from_episodes_to_batch": 0.0008068041673276593, "add_columns_from_episodes_to_train_batch": 0.03412480321884067}}, "connector_pipeline_timer": 0.08129692082107581}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2350649.909259586, "num_module_steps_trained_throughput": 449912.64270130685, "num_module_steps_trained_lifetime_throughput": 449093.72732708836}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 120, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.162788120981766e-06, "add_time_dim_to_batch_and_zero_pad": 2.2653764384027432e-06, "add_observations_from_episodes_to_batch": 2.7371269641321117e-06, "add_states_from_episodes_to_batch": 1.6269482794328503e-06, "batch_individual_items": 6.0497946794775825e-06}}, "connector_pipeline_timer": 4.2273444890296884e-05}, "episode_return_mean": 2.8, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.663465350945878e-07, "tensor_to_numpy": 1.263309026128955e-05, "normalize_and_clip_actions": 9.19287820569085e-06, "listify_data_for_vector_env": 1.0719392991582141e-05, "get_actions": 3.494111187177169e-05, "un_batch_to_individual_items": 5.317734307375334e-06}}, "connector_pipeline_timer": 9.880008566086442e-05}, "env_reset_timer": 0.00013855295861074892, "env_step_timer": 1.3562896233749093e-05, "episode_len_mean": 20.0, "sample": 0.09746428565999145, "weights_seq_no": 6.0, "episode_len_min": 20, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 2.8}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "module_episode_returns_mean": {"default_policy": 2.8}, "num_episodes": 20, "episode_duration_sec_mean": 0.004424152860883624, "num_env_steps_sampled_lifetime": 30400, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "rlmodule_inference_timer": 2.6836230185975897e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6071094274195779}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-09", "timestamp": 1754932989, "time_this_iter_s": 1.6450676918029785, "time_total_s": 9.880452871322632, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.880452871322632, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.26666666666667, "ram_util_percent": 78.26666666666667}}
{"timers": {"training_iteration": 1.543782112747144, "restore_env_runners": 1.1732382897103339e-05, "training_step": 1.543651076130453, "env_runner_sampling_timer": 1.4353657298396225, "learner_update_timer": 0.10524576931788214, "synch_weights": 0.0005904496469374095, "restore_eval_env_runners": 7.718875724108819e-06, "evaluation_iteration": 0.10344759567715484, "synch_eval_env_connectors": 0.00012122348089495849, "synch_env_connectors": 4.628779481980588e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.31502352418279e-05, "normalize_and_clip_actions": 9.36039582517759e-06, "get_actions": 3.889499905572004e-05, "un_batch_to_individual_items": 5.3700651187100876e-06, "remove_single_ts_time_rank_from_batch": 5.842759360623803e-07, "listify_data_for_vector_env": 1.084615360376528e-05}}, "connector_pipeline_timer": 0.00010367325713461764}, "env_to_module_connector": {"connector_pipeline_timer": 4.3398276083228104e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3233967452396735e-06, "add_observations_from_episodes_to_batch": 2.9243447506513976e-06, "numpy_to_tensor": 8.558230700992996e-06, "add_states_from_episodes_to_batch": 1.7506776493798845e-06, "batch_individual_items": 6.238958939429968e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004531256027985364, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "sample": 0.004838859346052935, "num_episodes_lifetime": -153875.0, "weights_seq_no": 6.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "num_env_steps_sampled_lifetime": -3077500.0, "time_between_sampling": 0.0018016494026977068, "episode_return_mean": 0.17999999999999997, "env_reset_timer": 3.2189866792755166e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3701509124687833e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.747729511430722e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3753.7369929159536}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.1733374446630478, "mean_kl_loss": 0.00022236791846808046, "vf_loss": 0.09954539686441422, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6225767731666565, "curr_kl_coeff": 0.0058320024982094765, "num_module_steps_trained": 6000, "vf_loss_unclipped": 27.996871948242188, "num_module_steps_trained_lifetime": 42000, "policy_loss": 0.11239685118198395, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012020707130432129, "weights_seq_no": 7.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.1225818544626236, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 450921.5845925186}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.482707250106327e-06, "batch_individual_items": 0.03214004427864276, "add_one_ts_to_episodes_and_truncate": 0.007551645351437984, "numpy_to_tensor": 5.694538745806249e-05, "general_advantage_estimation": 0.0064471418880632965, "add_time_dim_to_batch_and_zero_pad": 1.0648019596418096e-05, "add_observations_from_episodes_to_batch": 0.0008074640361171496, "add_columns_from_episodes_to_train_batch": 0.034126559765842425}}, "connector_pipeline_timer": 0.08126552453266965}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2350265.528791121, "num_module_steps_trained_throughput": 449758.3580835449, "num_module_steps_trained_lifetime_throughput": 448965.9595246863}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 140, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.172514817082689e-06, "add_time_dim_to_batch_and_zero_pad": 2.2428179453596474e-06, "add_observations_from_episodes_to_batch": 2.8098714128473345e-06, "add_states_from_episodes_to_batch": 1.6013038702078992e-06, "batch_individual_items": 6.035589420876974e-06}}, "connector_pipeline_timer": 4.221522701764992e-05}, "episode_return_mean": 3.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.632001671625818e-07, "tensor_to_numpy": 1.2527085626049734e-05, "normalize_and_clip_actions": 9.186230698815455e-06, "listify_data_for_vector_env": 1.074403633827547e-05, "get_actions": 3.48018848542616e-05, "un_batch_to_individual_items": 5.303784672763565e-06}}, "connector_pipeline_timer": 9.883383249354465e-05}, "env_reset_timer": 0.00013788700842699877, "env_step_timer": 1.3530279727226373e-05, "episode_len_mean": 20.0, "sample": 0.0974516548829359, "weights_seq_no": 7.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.0}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "module_episode_returns_mean": {"default_policy": 3.0}, "num_episodes": 20, "episode_duration_sec_mean": 0.004428017071913928, "num_env_steps_sampled_lifetime": 35400, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "rlmodule_inference_timer": 2.6419509876531908e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6058562506460048}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-11", "timestamp": 1754932991, "time_this_iter_s": 1.5676143169403076, "time_total_s": 11.44806718826294, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.44806718826294, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.05, "ram_util_percent": 78.6}}
{"timers": {"training_iteration": 1.5435863866202488, "restore_env_runners": 1.1671309787485863e-05, "training_step": 1.543454987869213, "env_runner_sampling_timer": 1.4353116500414318, "learner_update_timer": 0.10510383745423457, "synch_weights": 0.0005900484903938163, "restore_eval_env_runners": 7.707516338901207e-06, "evaluation_iteration": 0.10342228222065114, "synch_eval_env_connectors": 0.00012097999618659174, "synch_env_connectors": 4.624161387455515e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2902448148816518e-05, "normalize_and_clip_actions": 9.26717488452643e-06, "get_actions": 3.8069949346942954e-05, "un_batch_to_individual_items": 5.276740182876449e-06, "remove_single_ts_time_rank_from_batch": 5.752521977862468e-07, "listify_data_for_vector_env": 1.0647863547026944e-05}}, "connector_pipeline_timer": 0.00010196045221608937}, "env_to_module_connector": {"connector_pipeline_timer": 4.285416360249217e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.298738999372459e-06, "add_observations_from_episodes_to_batch": 2.9743599715218303e-06, "numpy_to_tensor": 8.302913128780755e-06, "add_states_from_episodes_to_batch": 1.7299575244744401e-06, "batch_individual_items": 6.1383376054017275e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.0047939186594448974, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "sample": 0.005054224561681247, "num_episodes_lifetime": -184750.0, "weights_seq_no": 7.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "num_env_steps_sampled_lifetime": -3695000.0, "time_between_sampling": 0.0014822793697550868, "episode_return_mean": 1.0600000000000005, "env_reset_timer": 3.120422316219971e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3527755924222422e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 4.219167300579905e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3790.6007889320003}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.09643588215112686, "mean_kl_loss": 4.653878204408102e-05, "vf_loss": 0.09922180324792862, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6227813363075256, "curr_kl_coeff": 0.0029160012491047382, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.816692352294922, "num_module_steps_trained_lifetime": 48000, "policy_loss": 0.03571588546037674, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.011062145233154297, "weights_seq_no": 8.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.04937148466706276, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 451009.25264012587}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4803810071529076e-06, "batch_individual_items": 0.03211671883544767, "add_one_ts_to_episodes_and_truncate": 0.007551544317338244, "numpy_to_tensor": 5.711426283757265e-05, "general_advantage_estimation": 0.006435961309188165, "add_time_dim_to_batch_and_zero_pad": 1.064986851402675e-05, "add_observations_from_episodes_to_batch": 0.0008099668965537863, "add_columns_from_episodes_to_train_batch": 0.03413049416804915}}, "connector_pipeline_timer": 0.08123730928835012}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2351607.1166070485, "num_module_steps_trained_throughput": 449933.93630843534, "num_module_steps_trained_lifetime_throughput": 449167.37891358114}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 160, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.083117326275313e-06, "add_time_dim_to_batch_and_zero_pad": 2.163391092048163e-06, "add_observations_from_episodes_to_batch": 2.747469878769988e-06, "add_states_from_episodes_to_batch": 1.5893955732744026e-06, "batch_individual_items": 6.071780495220085e-06}}, "connector_pipeline_timer": 4.18631473829683e-05}, "episode_return_mean": 3.2, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.653931784675883e-07, "tensor_to_numpy": 1.2533237069363621e-05, "normalize_and_clip_actions": 9.153338932990957e-06, "listify_data_for_vector_env": 1.063213987919136e-05, "get_actions": 3.405658342442527e-05, "un_batch_to_individual_items": 5.35497625241304e-06}}, "connector_pipeline_timer": 9.771879393907382e-05}, "env_reset_timer": 0.00013725688793227628, "env_step_timer": 1.352157299426458e-05, "episode_len_mean": 20.0, "sample": 0.09743349583392392, "weights_seq_no": 8.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.2}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "module_episode_returns_mean": {"default_policy": 3.2}, "num_episodes": 20, "episode_duration_sec_mean": 0.004427762506529689, "num_env_steps_sampled_lifetime": 40400, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "rlmodule_inference_timer": 2.635508977514229e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6052034435597602}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-12", "timestamp": 1754932992, "time_this_iter_s": 1.6268839836120605, "time_total_s": 13.074951171875, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.074951171875, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.05, "ram_util_percent": 78.6}}
{"timers": {"training_iteration": 1.5437618327545777, "restore_env_runners": 1.1619176925241278e-05, "training_step": 1.5436299117395849, "env_runner_sampling_timer": 1.434668766040306, "learner_update_timer": 0.10592111657944904, "synch_weights": 0.0005896913352428598, "restore_eval_env_runners": 7.702531363553523e-06, "evaluation_iteration": 0.1033926585589594, "synch_eval_env_connectors": 0.00012078560558629689, "synch_env_connectors": 4.622920116233162e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3096314088661444e-05, "normalize_and_clip_actions": 9.317055100455845e-06, "get_actions": 3.883653268809723e-05, "un_batch_to_individual_items": 5.301382600576372e-06, "remove_single_ts_time_rank_from_batch": 5.719195677710226e-07, "listify_data_for_vector_env": 1.0720496153748895e-05}}, "connector_pipeline_timer": 0.00010322297125739368}, "env_to_module_connector": {"connector_pipeline_timer": 4.3136628845891045e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3236674887581683e-06, "add_observations_from_episodes_to_batch": 2.901851612846331e-06, "numpy_to_tensor": 8.495445062520132e-06, "add_states_from_episodes_to_batch": 1.741557521527634e-06, "batch_individual_items": 6.169021872018596e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004522988481912762, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "sample": 0.004850499565163633, "num_episodes_lifetime": -215625.0, "weights_seq_no": 8.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 1.5399999999999994}, "num_env_steps_sampled_lifetime": -4312500.0, "time_between_sampling": 0.001453090154926772, "episode_return_mean": 1.5399999999999994, "env_reset_timer": 3.1469229403075474e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3670114768063071e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "module_episode_returns_mean": {"default_policy": 1.5399999999999994}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.76645864878084e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3779.490747862416}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.05899802967905998, "mean_kl_loss": 2.5744730010046624e-05, "vf_loss": 0.09900609403848648, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6220744848251343, "curr_kl_coeff": 0.0014580006245523691, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.217327117919922, "num_module_steps_trained_lifetime": 54000, "policy_loss": -0.0015838929684832692, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.010414361953735352, "weights_seq_no": 9.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.059552472084760666, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 451049.5805414814}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4793283271854433e-06, "batch_individual_items": 0.03209720373678585, "add_one_ts_to_episodes_and_truncate": 0.008504293874951493, "numpy_to_tensor": 5.726646099060249e-05, "general_advantage_estimation": 0.006423047525545505, "add_time_dim_to_batch_and_zero_pad": 1.0656698980531786e-05, "add_observations_from_episodes_to_batch": 0.0008100872273151101, "add_columns_from_episodes_to_train_batch": 0.03413398714633866}}, "connector_pipeline_timer": 0.08216129494537967}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2352700.9374427916, "num_module_steps_trained_throughput": 450062.3213281674, "num_module_steps_trained_lifetime_throughput": 449321.4956831575}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 180, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.102130851128242e-06, "add_time_dim_to_batch_and_zero_pad": 2.159061473308825e-06, "add_observations_from_episodes_to_batch": 2.7954055226528696e-06, "add_states_from_episodes_to_batch": 1.5848436147058674e-06, "batch_individual_items": 6.035694167880515e-06}}, "connector_pipeline_timer": 4.1828849131796106e-05}, "episode_return_mean": 2.4, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.621699632220505e-07, "tensor_to_numpy": 1.262568424694117e-05, "normalize_and_clip_actions": 9.254650143646013e-06, "listify_data_for_vector_env": 1.071608219587882e-05, "get_actions": 3.4925586016740134e-05, "un_batch_to_individual_items": 5.310529921176603e-06}}, "connector_pipeline_timer": 9.873409349778947e-05}, "env_reset_timer": 0.00013664973931658663, "env_step_timer": 1.3503616883895387e-05, "episode_len_mean": 20.0, "sample": 0.09742107670526927, "weights_seq_no": 9.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.4}, "num_episodes": 20, "episode_duration_sec_mean": 0.004409450467210263, "num_env_steps_sampled_lifetime": 45400, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "rlmodule_inference_timer": 2.669871315322881e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6049297207839772}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-14", "timestamp": 1754932994, "time_this_iter_s": 1.6640570163726807, "time_total_s": 14.73900818824768, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.73900818824768, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.066666666666668, "ram_util_percent": 78.56666666666668}}
{"timers": {"training_iteration": 1.5441517869264338, "restore_env_runners": 1.1557565315474204e-05, "training_step": 1.5440195242928794, "env_runner_sampling_timer": 1.4342436637900378, "learner_update_timer": 0.10673479416358556, "synch_weights": 0.0005895306716222847, "restore_eval_env_runners": 7.690506544860057e-06, "evaluation_iteration": 0.10336660947316625, "synch_eval_env_connectors": 0.00012049359003139963, "synch_env_connectors": 4.612940317981301e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3297182341935716e-05, "normalize_and_clip_actions": 9.462645827753122e-06, "get_actions": 3.9853860538250493e-05, "un_batch_to_individual_items": 5.323726302557801e-06, "remove_single_ts_time_rank_from_batch": 5.757699074244258e-07, "listify_data_for_vector_env": 1.0858117265964837e-05}}, "connector_pipeline_timer": 0.00010483060165929328}, "env_to_module_connector": {"connector_pipeline_timer": 4.357626333655667e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.338494416243944e-06, "add_observations_from_episodes_to_batch": 3.029322100946507e-06, "numpy_to_tensor": 8.614179630631273e-06, "add_states_from_episodes_to_batch": 1.7458172449957374e-06, "batch_individual_items": 6.268548536470499e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.0045734958238899705, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "sample": 0.004897085434189267, "num_episodes_lifetime": -246500.0, "weights_seq_no": 9.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 0.58}, "num_env_steps_sampled_lifetime": -4930000.0, "time_between_sampling": 0.001841340581185035, "episode_return_mean": 0.58, "env_reset_timer": 3.7462514327246044e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3908233453317292e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "module_episode_returns_mean": {"default_policy": 0.58}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.792903869201821e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3688.373115062677}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": -0.027369648218154907, "mean_kl_loss": 0.0007112051243893802, "vf_loss": 0.09900609403848648, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6069930195808411, "curr_kl_coeff": 0.0007290003122761846, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.218334197998047, "num_module_steps_trained_lifetime": 60000, "policy_loss": -0.08808911591768265, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.010382890701293945, "weights_seq_no": 10.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.019865432754158974, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 450757.9353360171}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.474115013036595e-06, "batch_individual_items": 0.03302742336041265, "add_one_ts_to_episodes_and_truncate": 0.008496606775514054, "numpy_to_tensor": 5.7379206721944386e-05, "general_advantage_estimation": 0.006413059139680805, "add_time_dim_to_batch_and_zero_pad": 1.0667631139199611e-05, "add_observations_from_episodes_to_batch": 0.0008106730148995897, "add_columns_from_episodes_to_train_batch": 0.03413603769402319}}, "connector_pipeline_timer": 0.08307645990619009}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2352014.2775906464, "num_module_steps_trained_throughput": 449854.4779922244, "num_module_steps_trained_lifetime_throughput": 449138.6392186627}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 200, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.148536699488937e-06, "add_time_dim_to_batch_and_zero_pad": 2.1611973912662925e-06, "add_observations_from_episodes_to_batch": 2.7429454993494684e-06, "add_states_from_episodes_to_batch": 1.5557022100532588e-06, "batch_individual_items": 6.04497758916315e-06}}, "connector_pipeline_timer": 4.1755122222141597e-05}, "episode_return_mean": 2.2, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.684545663738624e-07, "tensor_to_numpy": 1.2622842850274289e-05, "normalize_and_clip_actions": 9.15809208189311e-06, "listify_data_for_vector_env": 1.0630819293907705e-05, "get_actions": 3.462150218902742e-05, "un_batch_to_individual_items": 5.352456397913631e-06}}, "connector_pipeline_timer": 9.816642310844036e-05}, "env_reset_timer": 0.0001360332418135247, "env_step_timer": 1.3481723248372884e-05, "episode_len_mean": 20.0, "sample": 0.09740550802818886, "weights_seq_no": 10.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.2}, "num_episodes": 20, "episode_duration_sec_mean": 0.004413262525340542, "num_env_steps_sampled_lifetime": 50400, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "rlmodule_inference_timer": 2.6639906368880892e-05, "episode_return_max": 13.5, "time_between_sampling": 1.60487933816601}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-16", "timestamp": 1754932996, "time_this_iter_s": 1.6861839294433594, "time_total_s": 16.42519211769104, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.42519211769104, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 47.3, "ram_util_percent": 77.45}}
{"timers": {"training_iteration": 1.5431603598978612, "restore_env_runners": 1.1497830599740188e-05, "training_step": 1.5430276740508062, "env_runner_sampling_timer": 1.4333992850730888, "learner_update_timer": 0.10658772872181439, "synch_weights": 0.0005892628652650309, "restore_eval_env_runners": 7.681931452557776e-06, "evaluation_iteration": 0.1033451287981114, "synch_eval_env_connectors": 0.00012059448479601837, "synch_env_connectors": 4.612219875233302e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2921099424407296e-05, "normalize_and_clip_actions": 9.275621724875294e-06, "get_actions": 3.8070228039915584e-05, "un_batch_to_individual_items": 5.271778168412919e-06, "remove_single_ts_time_rank_from_batch": 5.758220444795115e-07, "listify_data_for_vector_env": 1.0661682708713679e-05}}, "connector_pipeline_timer": 0.0001019646537989719}, "env_to_module_connector": {"connector_pipeline_timer": 4.289225662061387e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.292198406933505e-06, "add_observations_from_episodes_to_batch": 2.9023692456539277e-06, "numpy_to_tensor": 8.415017252933384e-06, "add_states_from_episodes_to_batch": 1.7319269773060834e-06, "batch_individual_items": 6.137551722874919e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004473006361629814, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "sample": 0.004822642275934694, "num_episodes_lifetime": -277375.0, "weights_seq_no": 10.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 2.42}, "num_env_steps_sampled_lifetime": -5547500.0, "time_between_sampling": 0.0018431541003655543, "episode_return_mean": 2.42, "env_reset_timer": 3.315198273701683e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3513764082747391e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "module_episode_returns_mean": {"default_policy": 2.42}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.748664659667336e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3795.227147838712}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.015427875332534313, "mean_kl_loss": 0.0006328527233563364, "vf_loss": 0.09868254512548447, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5904287099838257, "curr_kl_coeff": 0.0003645001561380923, "num_module_steps_trained": 6000, "vf_loss_unclipped": 25.318986892700195, "num_module_steps_trained_lifetime": 66000, "policy_loss": -0.04522467032074928, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.009004473686218262, "weights_seq_no": 11.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.04201570525765419, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 450213.41443081875}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4660446131367796e-06, "batch_individual_items": 0.032996017457236904, "add_one_ts_to_episodes_and_truncate": 0.008486532787915045, "numpy_to_tensor": 5.731082362536405e-05, "general_advantage_estimation": 0.006404375209128605, "add_time_dim_to_batch_and_zero_pad": 1.0641365218899916e-05, "add_observations_from_episodes_to_batch": 0.0008107229545423817, "add_columns_from_episodes_to_train_batch": 0.03414215273706808}}, "connector_pipeline_timer": 0.08303195822772017}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2349975.5205996945, "num_module_steps_trained_throughput": 449391.2548727143, "num_module_steps_trained_lifetime_throughput": 448699.6592425307}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 220, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.148261308192766e-06, "add_time_dim_to_batch_and_zero_pad": 2.2099375055967366e-06, "add_observations_from_episodes_to_batch": 2.781670360674973e-06, "add_states_from_episodes_to_batch": 1.5943210519973044e-06, "batch_individual_items": 6.047232478939278e-06}}, "connector_pipeline_timer": 4.215593839648316e-05}, "episode_return_mean": 2.8, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.720400421498429e-07, "tensor_to_numpy": 1.2593141538058573e-05, "normalize_and_clip_actions": 9.070954459759898e-06, "listify_data_for_vector_env": 1.0809483120196295e-05, "get_actions": 3.488632587126817e-05, "un_batch_to_individual_items": 5.379143981709669e-06}}, "connector_pipeline_timer": 9.879223689289714e-05}, "env_reset_timer": 0.00013543207932039368, "env_step_timer": 1.3557211997145423e-05, "episode_len_mean": 20.0, "sample": 0.09739474336780217, "weights_seq_no": 11.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.8}, "num_episodes": 20, "episode_duration_sec_mean": 0.004413020407082513, "num_env_steps_sampled_lifetime": 55400, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "rlmodule_inference_timer": 2.6854855314472382e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6034488331246297}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-17", "timestamp": 1754932997, "time_this_iter_s": 1.548196792602539, "time_total_s": 17.97338891029358, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.97338891029358, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 39.9, "ram_util_percent": 77.3}}
{"timers": {"training_iteration": 1.543083285048477, "restore_env_runners": 1.1437432453228125e-05, "training_step": 1.5429503456497213, "env_runner_sampling_timer": 1.4334750488921326, "learner_update_timer": 0.10643531060427464, "synch_weights": 0.0005885473167779754, "restore_eval_env_runners": 7.667202249928593e-06, "evaluation_iteration": 0.1033214575098614, "synch_eval_env_connectors": 0.00012030938048709637, "synch_env_connectors": 4.603597379947862e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2988194472700023e-05, "normalize_and_clip_actions": 9.276797190580183e-06, "get_actions": 3.8124555974062066e-05, "un_batch_to_individual_items": 5.301206221582238e-06, "remove_single_ts_time_rank_from_batch": 5.786262922491007e-07, "listify_data_for_vector_env": 1.0742914984077593e-05}}, "connector_pipeline_timer": 0.00010234587786236299}, "env_to_module_connector": {"connector_pipeline_timer": 4.314509841908339e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.301714196338832e-06, "add_observations_from_episodes_to_batch": 2.9582230862453427e-06, "numpy_to_tensor": 8.408654556812845e-06, "add_states_from_episodes_to_batch": 1.734484771414416e-06, "batch_individual_items": 6.196233077444323e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.0044837786834687, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "sample": 0.004790613544951411, "num_episodes_lifetime": -308250.0, "weights_seq_no": 11.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "num_env_steps_sampled_lifetime": -6165000.0, "time_between_sampling": 0.0017756112030649855, "episode_return_mean": 1.8600000000000003, "env_reset_timer": 3.194319907090883e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.358400251512048e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.7178016544354784e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3774.0539272215274}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.0880821943283081, "mean_kl_loss": 0.0027911753859370947, "vf_loss": 0.09889824688434601, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.548987865447998, "curr_kl_coeff": 0.00018225007806904614, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.199382781982422, "num_module_steps_trained_lifetime": 72000, "policy_loss": 0.026909515261650085, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.010240793228149414, "weights_seq_no": 12.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.22185371816158295, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 450037.04012922023}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.460545040969841e-06, "batch_individual_items": 0.03297100395157626, "add_one_ts_to_episodes_and_truncate": 0.008478524550497893, "numpy_to_tensor": 5.726438528997477e-05, "general_advantage_estimation": 0.006392252706870278, "add_time_dim_to_batch_and_zero_pad": 1.0621621609657852e-05, "add_observations_from_episodes_to_batch": 0.0008110503049374707, "add_columns_from_episodes_to_train_batch": 0.03414376037929599}}, "connector_pipeline_timer": 0.08298842822545842}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2349812.9903678847, "num_module_steps_trained_throughput": 449292.61254602985, "num_module_steps_trained_lifetime_throughput": 448621.98457894725}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 240, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.318818159658624e-06, "add_time_dim_to_batch_and_zero_pad": 2.1825558598238693e-06, "add_observations_from_episodes_to_batch": 2.7581774945843807e-06, "add_states_from_episodes_to_batch": 1.5846359252359764e-06, "batch_individual_items": 6.126110897621265e-06}}, "connector_pipeline_timer": 4.202205413943158e-05}, "episode_return_mean": 3.2, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.692466148651079e-07, "tensor_to_numpy": 1.2851600074735202e-05, "normalize_and_clip_actions": 9.269686719018287e-06, "listify_data_for_vector_env": 1.0768908775169435e-05, "get_actions": 3.578489524799746e-05, "un_batch_to_individual_items": 5.413414544296608e-06}}, "connector_pipeline_timer": 9.993474278003748e-05}, "env_reset_timer": 0.0001347969188343885, "env_step_timer": 1.3811848143853747e-05, "episode_len_mean": 20.0, "sample": 0.09738428760351449, "weights_seq_no": 12.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.2}, "num_episodes": 20, "episode_duration_sec_mean": 0.004416091243037954, "num_env_steps_sampled_lifetime": 60400, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "rlmodule_inference_timer": 2.7128093018388502e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6029289985433803}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-19", "timestamp": 1754932999, "time_this_iter_s": 1.6387128829956055, "time_total_s": 19.612101793289185, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.612101793289185, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.86666666666667, "ram_util_percent": 77.46666666666667}}
{"timers": {"training_iteration": 1.5430959713679226, "restore_env_runners": 1.142889828268802e-05, "training_step": 1.5429625638640192, "env_runner_sampling_timer": 1.4336470421537462, "learner_update_timer": 0.10627489707737973, "synch_weights": 0.0005883118435584141, "restore_eval_env_runners": 7.655940504304206e-06, "evaluation_iteration": 0.10329845751521857, "synch_eval_env_connectors": 0.0001200354567375403, "synch_env_connectors": 4.599642052529166e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3048280332009675e-05, "normalize_and_clip_actions": 9.304638286921321e-06, "get_actions": 3.8760163285548014e-05, "un_batch_to_individual_items": 5.290991753264568e-06, "remove_single_ts_time_rank_from_batch": 5.783785495515987e-07, "listify_data_for_vector_env": 1.0717431167211429e-05}}, "connector_pipeline_timer": 0.00010310458793729219}, "env_to_module_connector": {"connector_pipeline_timer": 4.2995969525269323e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2943543773975015e-06, "add_observations_from_episodes_to_batch": 2.8913004871162963e-06, "numpy_to_tensor": 8.433598857249928e-06, "add_states_from_episodes_to_batch": 1.7331232458016385e-06, "batch_individual_items": 6.147333744425745e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004496947871521113, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "sample": 0.0047793822517986475, "num_episodes_lifetime": -339125.0, "weights_seq_no": 12.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "num_env_steps_sampled_lifetime": -6782500.0, "time_between_sampling": 0.0016607540346068295, "episode_return_mean": 2.899999999999998, "env_reset_timer": 3.13861316342748e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3620340695740664e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.7112142784346227e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3768.0148346183087}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.06440390646457672, "mean_kl_loss": 0.000769394391681999, "vf_loss": 0.09868254512548447, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.527543842792511, "curr_kl_coeff": 9.112503903452307e-05, "num_module_steps_trained": 6000, "vf_loss_unclipped": 25.324901580810547, "num_module_steps_trained_lifetime": 78000, "policy_loss": 0.0031821199227124453, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.009009599685668945, "weights_seq_no": 13.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.05305613577365875, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 449995.46680022945}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4517686580138843e-06, "batch_individual_items": 0.03294702558229299, "add_one_ts_to_episodes_and_truncate": 0.008468485975427166, "numpy_to_tensor": 5.717549133708823e-05, "general_advantage_estimation": 0.006380057679614417, "add_time_dim_to_batch_and_zero_pad": 1.0595404838567525e-05, "add_observations_from_episodes_to_batch": 0.0008111460518012968, "add_columns_from_episodes_to_train_batch": 0.034135901105967696}}, "connector_pipeline_timer": 0.08293395394297301}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2350344.9034431707, "num_module_steps_trained_throughput": 449327.20223243395, "num_module_steps_trained_lifetime_throughput": 448677.5490617595}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 260, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.170792590316649e-06, "add_time_dim_to_batch_and_zero_pad": 2.176888448894086e-06, "add_observations_from_episodes_to_batch": 2.76163062411335e-06, "add_states_from_episodes_to_batch": 1.5815231802665406e-06, "batch_individual_items": 6.098951276264471e-06}}, "connector_pipeline_timer": 4.206296223801382e-05}, "episode_return_mean": 3.2, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.671126665410614e-07, "tensor_to_numpy": 1.2588394706944443e-05, "normalize_and_clip_actions": 9.09020164968293e-06, "listify_data_for_vector_env": 1.073466868844542e-05, "get_actions": 3.518835194308803e-05, "un_batch_to_individual_items": 5.320281685458829e-06}}, "connector_pipeline_timer": 9.881495478558772e-05}, "env_reset_timer": 0.0001342143594322988, "env_step_timer": 1.35551291061178e-05, "episode_len_mean": 20.0, "sample": 0.09737371722756405, "weights_seq_no": 13.0, "episode_len_min": 20, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 3.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.2}, "num_episodes": 20, "episode_duration_sec_mean": 0.004422624161234126, "num_env_steps_sampled_lifetime": 65400, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "rlmodule_inference_timer": 2.6925714010990168e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6025087248076013}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-21", "timestamp": 1754933001, "time_this_iter_s": 1.6476149559020996, "time_total_s": 21.259716749191284, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.259716749191284, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.099999999999994, "ram_util_percent": 77.45}}
{"timers": {"training_iteration": 1.543379272074307, "restore_env_runners": 1.1370860019214697e-05, "training_step": 1.5432457123849987, "env_runner_sampling_timer": 1.4331413333925649, "learner_update_timer": 0.10706420726603381, "synch_weights": 0.0005878128848628905, "restore_eval_env_runners": 7.643551552958607e-06, "evaluation_iteration": 0.10327476335981817, "synch_eval_env_connectors": 0.00011971593192724437, "synch_env_connectors": 4.594895072986812e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3263541470691635e-05, "normalize_and_clip_actions": 9.380063542884428e-06, "get_actions": 3.9476496745204635e-05, "un_batch_to_individual_items": 5.336370190670609e-06, "remove_single_ts_time_rank_from_batch": 5.769530109314249e-07, "listify_data_for_vector_env": 1.0910386681102391e-05}}, "connector_pipeline_timer": 0.00010441993444606976}, "env_to_module_connector": {"connector_pipeline_timer": 4.355701473620059e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3332728844009376e-06, "add_observations_from_episodes_to_batch": 2.927787438624188e-06, "numpy_to_tensor": 8.648070865189123e-06, "add_states_from_episodes_to_batch": 1.743892325090959e-06, "batch_individual_items": 6.300340534050767e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00457109932648018, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "sample": 0.004869043719555615, "num_episodes_lifetime": -370000.0, "weights_seq_no": 13.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.9399999999999995}, "num_env_steps_sampled_lifetime": -7400000.0, "time_between_sampling": 0.0016687925787611233, "episode_return_mean": 3.9399999999999995, "env_reset_timer": 3.404767560446137e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.391413300286699e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "module_episode_returns_mean": {"default_policy": 3.9399999999999995}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.8218573713431705e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3718.21937261476}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.032381489872932434, "mean_kl_loss": 0.0006089486996643245, "vf_loss": 0.09835900366306305, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5081238746643066, "curr_kl_coeff": 4.5562519517261535e-05, "num_module_steps_trained": 6000, "vf_loss_unclipped": 24.430038452148438, "num_module_steps_trained_lifetime": 84000, "policy_loss": -0.02879970334470272, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.007025957107543945, "weights_seq_no": 14.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.06801996380090714, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 450123.37754414504}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4497506368281704e-06, "batch_individual_items": 0.03383883949663944, "add_one_ts_to_episodes_and_truncate": 0.008459488616321096, "numpy_to_tensor": 5.725123611541232e-05, "general_advantage_estimation": 0.006368588353444867, "add_time_dim_to_batch_and_zero_pad": 1.0619030356600974e-05, "add_observations_from_episodes_to_batch": 0.0008115287514213544, "add_columns_from_episodes_to_train_batch": 0.034159589174884666}}, "connector_pipeline_timer": 0.08382934024299236}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2351742.0383933266, "num_module_steps_trained_throughput": 449528.24674900493, "num_module_steps_trained_lifetime_throughput": 448899.55269408424}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 280, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.242656979360622e-06, "add_time_dim_to_batch_and_zero_pad": 2.1940603319815126e-06, "add_observations_from_episodes_to_batch": 2.7796926342901677e-06, "add_states_from_episodes_to_batch": 1.6027955393006666e-06, "batch_individual_items": 6.176081234035671e-06}}, "connector_pipeline_timer": 4.242165349324825e-05}, "episode_return_mean": 3.6, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.803736161674525e-07, "tensor_to_numpy": 1.2668485923403702e-05, "normalize_and_clip_actions": 9.227961453231374e-06, "listify_data_for_vector_env": 1.0787444613362795e-05, "get_actions": 3.539937538360735e-05, "un_batch_to_individual_items": 5.360168429242576e-06}}, "connector_pipeline_timer": 9.963932162302899e-05}, "env_reset_timer": 0.0001336355557598079, "env_step_timer": 1.3637624646728175e-05, "episode_len_mean": 20.0, "sample": 0.09736332755478005, "weights_seq_no": 14.0, "episode_len_min": 20, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 3.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.6}, "num_episodes": 20, "episode_duration_sec_mean": 0.004424991216510534, "num_env_steps_sampled_lifetime": 70400, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "rlmodule_inference_timer": 2.685632616354712e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6023628900589604}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-22", "timestamp": 1754933002, "time_this_iter_s": 1.6746280193328857, "time_total_s": 22.93434476852417, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.93434476852417, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 40.9, "ram_util_percent": 77.9}}
{"timers": {"training_iteration": 1.5435942343540023, "restore_env_runners": 1.1302991116145123e-05, "training_step": 1.5434605044305636, "env_runner_sampling_timer": 1.4325874300585664, "learner_update_timer": 0.10783269686437748, "synch_weights": 0.000587740586019818, "restore_eval_env_runners": 7.625866193742202e-06, "evaluation_iteration": 0.10325069989688519, "synch_eval_env_connectors": 0.00011972169329256286, "synch_env_connectors": 4.588105908213087e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.326389985569936e-05, "normalize_and_clip_actions": 9.36503514740495e-06, "get_actions": 3.925136559548347e-05, "un_batch_to_individual_items": 5.366998837379976e-06, "remove_single_ts_time_rank_from_batch": 5.788286353184992e-07, "listify_data_for_vector_env": 1.0839178629653303e-05}}, "connector_pipeline_timer": 0.00010420659114505517}, "env_to_module_connector": {"connector_pipeline_timer": 4.3450954729464736e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3298205392104756e-06, "add_observations_from_episodes_to_batch": 2.9925628780518504e-06, "numpy_to_tensor": 8.535574345818103e-06, "add_states_from_episodes_to_batch": 1.749117864523236e-06, "batch_individual_items": 6.25748273431426e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004552134332247078, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "sample": 0.004829310132656944, "num_episodes_lifetime": -400875.0, "weights_seq_no": 14.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_env_steps_sampled_lifetime": -8017500.0, "time_between_sampling": 0.001824625772981669, "episode_return_mean": 3.7, "env_reset_timer": 3.247973793481007e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3811515206459847e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "module_episode_returns_mean": {"default_policy": 3.7}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.7609625256204833e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3754.4413525110836}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": -0.03771353140473366, "mean_kl_loss": 3.665469921543263e-05, "vf_loss": 0.09825114160776138, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5022678375244141, "curr_kl_coeff": 2.2781259758630767e-05, "num_module_steps_trained": 6000, "vf_loss_unclipped": 24.126394271850586, "num_module_steps_trained_lifetime": 90000, "policy_loss": -0.09887556731700897, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0060272216796875, "weights_seq_no": 15.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.09681214392185211, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 450324.8060539855}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4440030583382684e-06, "batch_individual_items": 0.034733776942112694, "add_one_ts_to_episodes_and_truncate": 0.008451764150174233, "numpy_to_tensor": 5.725038468454902e-05, "general_advantage_estimation": 0.006357577879152929, "add_time_dim_to_batch_and_zero_pad": 1.0605340175298992e-05, "add_observations_from_episodes_to_batch": 0.000811644714010704, "add_columns_from_episodes_to_train_batch": 0.034157138283461334}}, "connector_pipeline_timer": 0.08470293017128012}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2353485.951802567, "num_module_steps_trained_throughput": 449798.62545505597, "num_module_steps_trained_lifetime_throughput": 449189.7652973024}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 300, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.26345403306153e-06, "add_time_dim_to_batch_and_zero_pad": 2.1779075875448214e-06, "add_observations_from_episodes_to_batch": 2.7495272082381197e-06, "add_states_from_episodes_to_batch": 1.5937153577949614e-06, "batch_individual_items": 6.0512269498305895e-06}}, "connector_pipeline_timer": 4.21112331048634e-05}, "episode_return_mean": 3.4, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.664155136287056e-07, "tensor_to_numpy": 1.2713182904667123e-05, "normalize_and_clip_actions": 9.357462024591446e-06, "listify_data_for_vector_env": 1.0645330599822079e-05, "get_actions": 3.508365982543781e-05, "un_batch_to_individual_items": 5.42324463708663e-06}}, "connector_pipeline_timer": 9.915568165193528e-05}, "env_reset_timer": 0.00013309461953012455, "env_step_timer": 1.3641261967810182e-05, "episode_len_mean": 20.0, "sample": 0.09736046427878103, "weights_seq_no": 15.0, "episode_len_min": 20, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 3.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.4}, "num_episodes": 20, "episode_duration_sec_mean": 0.00443525662063621, "num_env_steps_sampled_lifetime": 75400, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "rlmodule_inference_timer": 2.735146517832551e-05, "episode_return_max": 13.5, "time_between_sampling": 1.602153702408775}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-24", "timestamp": 1754933004, "time_this_iter_s": 1.6691436767578125, "time_total_s": 24.603488445281982, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.603488445281982, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.96666666666667, "ram_util_percent": 78.33333333333333}}
{"timers": {"training_iteration": 1.5443782574301945, "restore_env_runners": 1.1247870842673263e-05, "training_step": 1.544244128556448, "env_runner_sampling_timer": 1.4335137882583326, "learner_update_timer": 0.10768945031619238, "synch_weights": 0.0005874081793083164, "restore_eval_env_runners": 7.613776821349005e-06, "evaluation_iteration": 0.10323725122790088, "synch_eval_env_connectors": 0.00011960739613048896, "synch_env_connectors": 4.584724590670316e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4556223281968551e-05, "normalize_and_clip_actions": 1.0015391889775564e-05, "get_actions": 4.465571302636364e-05, "un_batch_to_individual_items": 5.768519969010371e-06, "remove_single_ts_time_rank_from_batch": 6.203187583375424e-07, "listify_data_for_vector_env": 1.1744174287350102e-05}}, "connector_pipeline_timer": 0.00011469243826640986}, "env_to_module_connector": {"connector_pipeline_timer": 4.670158180551186e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4956547814119014e-06, "add_observations_from_episodes_to_batch": 3.1471520837831638e-06, "numpy_to_tensor": 9.482730130666638e-06, "add_states_from_episodes_to_batch": 1.8287854268375877e-06, "batch_individual_items": 6.9321227509507875e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005022916139103474, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "sample": 0.005187421241314626, "num_episodes_lifetime": -431750.0, "weights_seq_no": 15.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_env_steps_sampled_lifetime": -8635000.0, "time_between_sampling": 0.001888088702237322, "episode_return_mean": 3.8600000000000008, "env_reset_timer": 4.043200844353863e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.642496568690302e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.1015793283871305e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3450.7029934033862}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.12026922404766083, "mean_kl_loss": 5.30047582287807e-05, "vf_loss": 0.098574697971344, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5057782530784607, "curr_kl_coeff": 1.1390629879315384e-05, "num_module_steps_trained": 6000, "vf_loss_unclipped": 25.01618003845215, "num_module_steps_trained_lifetime": 96000, "policy_loss": 0.05892258882522583, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00821065902709961, "weights_seq_no": 16.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.04237082600593567, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 449988.7242021084}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4428938985471555e-06, "batch_individual_items": 0.03469291167277926, "add_one_ts_to_episodes_and_truncate": 0.008447051088399844, "numpy_to_tensor": 5.7314550412008947e-05, "general_advantage_estimation": 0.0063483691813907405, "add_time_dim_to_batch_and_zero_pad": 1.0667206562055609e-05, "add_observations_from_episodes_to_batch": 0.0008117761760067135, "add_columns_from_episodes_to_train_batch": 0.03415582773017041}}, "connector_pipeline_timer": 0.08464695045058838}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2352375.9472900536, "num_module_steps_trained_throughput": 449526.03316770226, "num_module_steps_trained_lifetime_throughput": 448937.5309739106}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 320, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.120105315770321e-06, "add_time_dim_to_batch_and_zero_pad": 2.1868055967246248e-06, "add_observations_from_episodes_to_batch": 2.8413181784644547e-06, "add_states_from_episodes_to_batch": 1.5934861491006556e-06, "batch_individual_items": 6.107781557071264e-06}}, "connector_pipeline_timer": 4.2080303864390305e-05}, "episode_return_mean": 3.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.677285529970295e-07, "tensor_to_numpy": 1.2735743220686645e-05, "normalize_and_clip_actions": 9.179386747188263e-06, "listify_data_for_vector_env": 1.0735538522900836e-05, "get_actions": 3.557825713215336e-05, "un_batch_to_individual_items": 5.35371221985948e-06}}, "connector_pipeline_timer": 9.946348471886222e-05}, "env_reset_timer": 0.0001330832526492638, "env_step_timer": 1.3650867606799441e-05, "episode_len_mean": 20.0, "sample": 0.09735444046574024, "weights_seq_no": 16.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.0}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.0}, "num_episodes": 20, "episode_duration_sec_mean": 0.004437122917734087, "num_env_steps_sampled_lifetime": 80400, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "rlmodule_inference_timer": 2.6897178698268324e-05, "episode_return_max": 13.5, "time_between_sampling": 1.602527047475077}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-26", "timestamp": 1754933006, "time_this_iter_s": 1.7268023490905762, "time_total_s": 26.33029079437256, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.33029079437256, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 23.35, "ram_util_percent": 78.55000000000001}}
{"timers": {"training_iteration": 1.5487615598558897, "restore_env_runners": 1.119330177193612e-05, "training_step": 1.5486270897714571, "env_runner_sampling_timer": 1.438018365795785, "learner_update_timer": 0.10756461498326168, "synch_weights": 0.0005879007676469167, "restore_eval_env_runners": 7.656389666318299e-06, "evaluation_iteration": 0.10322934705536868, "synch_eval_env_connectors": 0.0001203354823386216, "synch_env_connectors": 4.5830464820179705e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7092959074805127e-05, "normalize_and_clip_actions": 1.1686669030845922e-05, "get_actions": 5.457040300951223e-05, "un_batch_to_individual_items": 6.538597060303468e-06, "remove_single_ts_time_rank_from_batch": 7.082938397239266e-07, "listify_data_for_vector_env": 1.397757673301674e-05}}, "connector_pipeline_timer": 0.00013552241371317077}, "env_to_module_connector": {"connector_pipeline_timer": 5.363175413054764e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.884851698218083e-06, "add_observations_from_episodes_to_batch": 3.6842408394724325e-06, "numpy_to_tensor": 1.1422121426159936e-05, "add_states_from_episodes_to_batch": 2.107121838299742e-06, "batch_individual_items": 8.096067208766838e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.006321624003350738, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "sample": 0.006474749974671355, "num_episodes_lifetime": -462625.0, "weights_seq_no": 16.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_env_steps_sampled_lifetime": -9252500.0, "time_between_sampling": 0.0016602565981992182, "episode_return_mean": 3.8600000000000008, "env_reset_timer": 5.557199547369821e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.8328491357411276e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 5.824919058677291e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3031.8402523403406}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.07174283266067505, "mean_kl_loss": 8.060758409556001e-05, "vf_loss": 0.09846686571836472, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5125570893287659, "curr_kl_coeff": 5.695314939657692e-06, "num_module_steps_trained": 6000, "vf_loss_unclipped": 24.70703125, "num_module_steps_trained_lifetime": 102000, "policy_loss": 0.010529711842536926, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.007464289665222168, "weights_seq_no": 17.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.12520335614681244, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 448896.4127034919}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.444715526625373e-06, "batch_individual_items": 0.03465995964529635, "add_one_ts_to_episodes_and_truncate": 0.008438614747858455, "numpy_to_tensor": 5.7380564605928155e-05, "general_advantage_estimation": 0.006341849660230206, "add_time_dim_to_batch_and_zero_pad": 1.0709285338052636e-05, "add_observations_from_episodes_to_batch": 0.0008143813352437147, "add_columns_from_episodes_to_train_batch": 0.034154552782001656}}, "connector_pipeline_timer": 0.08460027136548783}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2347273.649352195, "num_module_steps_trained_throughput": 448494.9550661624, "num_module_steps_trained_lifetime_throughput": 447926.3342563619}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 340, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.245539005729638e-06, "add_time_dim_to_batch_and_zero_pad": 2.2102786835568806e-06, "add_observations_from_episodes_to_batch": 2.8253303832551353e-06, "add_states_from_episodes_to_batch": 1.5826589954143657e-06, "batch_individual_items": 6.148521241578071e-06}}, "connector_pipeline_timer": 4.233199175145135e-05}, "episode_return_mean": 3.2, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.661118217164231e-07, "tensor_to_numpy": 1.2815554924819268e-05, "normalize_and_clip_actions": 9.278863847744874e-06, "listify_data_for_vector_env": 1.0869778406715636e-05, "get_actions": 3.495341670567923e-05, "un_batch_to_individual_items": 5.4349086656171175e-06}}, "connector_pipeline_timer": 9.945693012129005e-05}, "env_reset_timer": 0.00013256325051098932, "env_step_timer": 1.3946425653427981e-05, "episode_len_mean": 20.0, "sample": 0.09736848314211843, "weights_seq_no": 17.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 3.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.2}, "num_episodes": 20, "episode_duration_sec_mean": 0.004454617081210017, "num_env_steps_sampled_lifetime": 85400, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "rlmodule_inference_timer": 2.7335305446971672e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6065078203408714}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-28", "timestamp": 1754933008, "time_this_iter_s": 2.0892651081085205, "time_total_s": 28.41955590248108, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.41955590248108, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 52.833333333333336, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 1.5496742492574647, "restore_env_runners": 1.1139698651218145e-05, "training_step": 1.549539233874619, "env_runner_sampling_timer": 1.4379045275479694, "learner_update_timer": 0.10858684925347127, "synch_weights": 0.000588728850622064, "restore_eval_env_runners": 7.653576040185696e-06, "evaluation_iteration": 0.10323796191586647, "synch_eval_env_connectors": 0.00012027087774612888, "synch_env_connectors": 4.578046363022152e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3699209147099779e-05, "normalize_and_clip_actions": 9.539592020014424e-06, "get_actions": 4.120522453781225e-05, "un_batch_to_individual_items": 5.500462790612295e-06, "remove_single_ts_time_rank_from_batch": 5.831633006209481e-07, "listify_data_for_vector_env": 1.1121728854264043e-05}}, "connector_pipeline_timer": 0.00010766968584147182}, "env_to_module_connector": {"connector_pipeline_timer": 4.42860599375139e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3882360059712697e-06, "add_observations_from_episodes_to_batch": 3.0081950525710507e-06, "numpy_to_tensor": 8.834026744086833e-06, "add_states_from_episodes_to_batch": 1.7534537474536688e-06, "batch_individual_items": 6.397412570908699e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004688873150385915, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "sample": 0.0053877217809000085, "num_episodes_lifetime": -493500.0, "weights_seq_no": 17.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "num_env_steps_sampled_lifetime": -9870000.0, "time_between_sampling": 0.0015600615803900617, "episode_return_mean": 2.8199999999999994, "env_reset_timer": 4.377411890426638e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.425089103698695e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.884057935744595e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3622.0528700070236}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.23265135288238525, "mean_kl_loss": 0.0007358924485743046, "vf_loss": 0.09911397844552994, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5282083749771118, "curr_kl_coeff": 2.847657469828846e-06, "num_module_steps_trained": 6000, "vf_loss_unclipped": 26.49570655822754, "num_module_steps_trained_lifetime": 108000, "policy_loss": 0.1711471825838089, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.009949445724487305, "weights_seq_no": 18.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.06099133938550949, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 447098.01964158646}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4411091184175104e-06, "batch_individual_items": 0.03577301629834233, "add_one_ts_to_episodes_and_truncate": 0.008430513180079728, "numpy_to_tensor": 5.7423009286725843e-05, "general_advantage_estimation": 0.006331808242939662, "add_time_dim_to_batch_and_zero_pad": 1.071844249674205e-05, "add_observations_from_episodes_to_batch": 0.0008147546018779095, "add_columns_from_episodes_to_train_batch": 0.03415821266386679}}, "connector_pipeline_timer": 0.08569911782281019}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2338412.948483304, "num_module_steps_trained_throughput": 446751.45523946104, "num_module_steps_trained_lifetime_throughput": 446201.5159068845}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 360, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.703324488507654e-06, "add_time_dim_to_batch_and_zero_pad": 2.244142143169738e-06, "add_observations_from_episodes_to_batch": 2.87626700070837e-06, "add_states_from_episodes_to_batch": 1.6285911182610737e-06, "batch_individual_items": 6.2625813054354955e-06}}, "connector_pipeline_timer": 4.3365795354063537e-05}, "episode_return_mean": 2.6, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.866007522825576e-07, "tensor_to_numpy": 1.322302174567314e-05, "normalize_and_clip_actions": 9.55349788471337e-06, "listify_data_for_vector_env": 1.1595806583707751e-05, "get_actions": 3.660915179457533e-05, "un_batch_to_individual_items": 5.617408444861006e-06}}, "connector_pipeline_timer": 0.00010324519084408849}, "env_reset_timer": 0.00013198095777542166, "env_step_timer": 1.4357957900024505e-05, "episode_len_mean": 20.0, "sample": 0.09738392165139334, "weights_seq_no": 18.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.6}, "num_episodes": 20, "episode_duration_sec_mean": 0.004477269981289282, "num_env_steps_sampled_lifetime": 90400, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "rlmodule_inference_timer": 2.7980682439551358e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6070531508875925}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-30", "timestamp": 1754933010, "time_this_iter_s": 1.7466301918029785, "time_total_s": 30.166186094284058, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.166186094284058, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 50.93333333333334, "ram_util_percent": 78.26666666666667}}
{"timers": {"training_iteration": 1.549766757184179, "restore_env_runners": 1.1088300957422347e-05, "training_step": 1.5496313432061066, "env_runner_sampling_timer": 1.437247681022382, "learner_update_timer": 0.10933562076095206, "synch_weights": 0.0005883607321970862, "restore_eval_env_runners": 7.65371024658584e-06, "evaluation_iteration": 0.10324678813642742, "synch_eval_env_connectors": 0.00012041608842905364, "synch_env_connectors": 4.571015903415244e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3119961542103947e-05, "normalize_and_clip_actions": 9.39300557084709e-06, "get_actions": 3.9010591334948585e-05, "un_batch_to_individual_items": 5.349238310989321e-06, "remove_single_ts_time_rank_from_batch": 5.782476664985196e-07, "listify_data_for_vector_env": 1.0816906245058635e-05}}, "connector_pipeline_timer": 0.00010370714386119298}, "env_to_module_connector": {"connector_pipeline_timer": 4.325661299651323e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3120448136841505e-06, "add_observations_from_episodes_to_batch": 2.9416693112901993e-06, "numpy_to_tensor": 8.51763423494535e-06, "add_states_from_episodes_to_batch": 1.7312031964286666e-06, "batch_individual_items": 6.21095417382282e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004536579512991011, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "sample": 0.004967679504957989, "num_episodes_lifetime": -524375.0, "weights_seq_no": 18.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_env_steps_sampled_lifetime": -10487500.0, "time_between_sampling": 0.0019379560703352968, "episode_return_mean": 3.8600000000000008, "env_reset_timer": 3.811703551557496e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3773366713283881e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.8009446119059052e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3721.9785585918}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": -0.024771621450781822, "mean_kl_loss": 3.7580906791845337e-05, "vf_loss": 0.09814337641000748, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5417179465293884, "curr_kl_coeff": 1.423828734914423e-06, "num_module_steps_trained": 6000, "vf_loss_unclipped": 24.051631927490234, "num_module_steps_trained_lifetime": 114000, "policy_loss": -0.08550427854061127, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.005461335182189941, "weights_seq_no": 19.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.11087688058614731, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 445879.3795077986}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.434197654555294e-06, "batch_individual_items": 0.03664010113567317, "add_one_ts_to_episodes_and_truncate": 0.008423593887819441, "numpy_to_tensor": 5.7375029999564375e-05, "general_advantage_estimation": 0.006320233490478569, "add_time_dim_to_batch_and_zero_pad": 1.0695008418450146e-05, "add_observations_from_episodes_to_batch": 0.0008149866365449992, "add_columns_from_episodes_to_train_batch": 0.03415800053703359}}, "connector_pipeline_timer": 0.08654732247385435}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2332566.104637968, "num_module_steps_trained_throughput": 445584.60244861624, "num_module_steps_trained_lifetime_throughput": 445052.46163314156}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 380, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.209462912895591e-06, "add_time_dim_to_batch_and_zero_pad": 2.173756945740358e-06, "add_observations_from_episodes_to_batch": 2.770391369603531e-06, "add_states_from_episodes_to_batch": 1.5694768311142363e-06, "batch_individual_items": 6.0832676814314504e-06}}, "connector_pipeline_timer": 4.204767361114027e-05}, "episode_return_mean": 2.4, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.653487355910607e-07, "tensor_to_numpy": 1.2682609744932896e-05, "normalize_and_clip_actions": 9.230789422380551e-06, "listify_data_for_vector_env": 1.0836064614832815e-05, "get_actions": 3.516152277944485e-05, "un_batch_to_individual_items": 5.351141120646523e-06}}, "connector_pipeline_timer": 9.920045063902859e-05}, "env_reset_timer": 0.00013137364722015128, "env_step_timer": 1.3621023416952976e-05, "episode_len_mean": 20.0, "sample": 0.09737474993510896, "weights_seq_no": 19.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.4}, "num_episodes": 20, "episode_duration_sec_mean": 0.004477532501332462, "num_env_steps_sampled_lifetime": 95400, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "rlmodule_inference_timer": 2.6868726016115903e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6067433868793315}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-31", "timestamp": 1754933011, "time_this_iter_s": 1.6628320217132568, "time_total_s": 31.829018115997314, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.829018115997314, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 42.6, "ram_util_percent": 78.1}}
{"timers": {"training_iteration": 1.5488694296122252, "restore_env_runners": 1.1043668743346614e-05, "training_step": 1.548733590613704, "env_runner_sampling_timer": 1.436511895462298, "learner_update_timer": 0.10917292330334574, "synch_weights": 0.0005880600346733649, "restore_eval_env_runners": 7.641343597817425e-06, "evaluation_iteration": 0.10322859733443861, "synch_eval_env_connectors": 0.00012016233757554532, "synch_env_connectors": 4.566555185364029e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3053239184298463e-05, "normalize_and_clip_actions": 9.351059828817387e-06, "get_actions": 3.865022958651269e-05, "un_batch_to_individual_items": 5.2875837427611325e-06, "remove_single_ts_time_rank_from_batch": 5.733045427119732e-07, "listify_data_for_vector_env": 1.0770086399748587e-05}}, "connector_pipeline_timer": 0.00010296389585344291}, "env_to_module_connector": {"connector_pipeline_timer": 4.309536987381142e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3109326212888482e-06, "add_observations_from_episodes_to_batch": 2.9323515011815444e-06, "numpy_to_tensor": 8.452657346647258e-06, "add_states_from_episodes_to_batch": 1.7209671077765085e-06, "batch_individual_items": 6.205710130486759e-06}}}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004507004821673037, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "sample": 0.0048310095826401295, "num_episodes_lifetime": -555250.0, "weights_seq_no": 19.0, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.62}, "num_env_steps_sampled_lifetime": -11105000.0, "time_between_sampling": 0.0018427719169278735, "episode_return_mean": 3.62, "env_reset_timer": 3.2976308019176284e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3692090203522986e-05, "episode_return_min": -13.5, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "module_episode_returns_mean": {"default_policy": 3.62}, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 2.7382026896393126e-05, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3778.1802227070475}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "total_loss": 0.1188291683793068, "mean_kl_loss": 3.7657540815416723e-05, "vf_loss": 0.09868261218070984, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5321364998817444, "curr_kl_coeff": 7.119143674572115e-07, "num_module_steps_trained": 6000, "vf_loss_unclipped": 25.19484519958496, "num_module_steps_trained_lifetime": 120000, "policy_loss": 0.05764909088611603, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.007982969284057617, "weights_seq_no": 20.0, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.08247192203998566, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 444427.54728878103}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.429435647132747e-06, "batch_individual_items": 0.03657786804457434, "add_one_ts_to_episodes_and_truncate": 0.008415526278629036, "numpy_to_tensor": 5.7457940112938264e-05, "general_advantage_estimation": 0.006312008245904578, "add_time_dim_to_batch_and_zero_pad": 1.0692638874475653e-05, "add_observations_from_episodes_to_batch": 0.0008161942710009012, "add_columns_from_episodes_to_train_batch": 0.03415507594153206}}, "connector_pipeline_timer": 0.08646706049930178}, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2325466.235495631, "num_module_steps_trained_throughput": 444179.1142681359, "num_module_steps_trained_lifetime_throughput": 443665.20527284243}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 400, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.2992105960618e-06, "add_time_dim_to_batch_and_zero_pad": 2.2104220125560113e-06, "add_observations_from_episodes_to_batch": 2.7741050458115747e-06, "add_states_from_episodes_to_batch": 1.6323208225077323e-06, "batch_individual_items": 6.201284465540483e-06}}, "connector_pipeline_timer": 4.21357152062273e-05}, "episode_return_mean": 2.8, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.687665815838904e-07, "tensor_to_numpy": 1.3507423386983047e-05, "normalize_and_clip_actions": 9.33080710859546e-06, "listify_data_for_vector_env": 1.087769438776876e-05, "get_actions": 3.6149915453911484e-05, "un_batch_to_individual_items": 5.422205369781861e-06}}, "connector_pipeline_timer": 0.0001011925421255864}, "env_reset_timer": 0.00013086908105367867, "env_step_timer": 1.3903797303028877e-05, "episode_len_mean": 20.0, "sample": 0.09737021576571195, "weights_seq_no": 20.0, "episode_len_min": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 2.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.8}, "num_episodes": 20, "episode_duration_sec_mean": 0.0044739000219851735, "num_env_steps_sampled_lifetime": 100400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "rlmodule_inference_timer": 2.7480412803342993e-05, "episode_return_max": 13.5, "time_between_sampling": 1.6054470105105765}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "43b26_00000", "date": "2025-08-11_19-23-33", "timestamp": 1754933013, "time_this_iter_s": 1.5643260478973389, "time_total_s": 33.39334416389465, "pid": 14403, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385cbd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.39334416389465, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 36.099999999999994, "ram_util_percent": 77.44999999999999}}
