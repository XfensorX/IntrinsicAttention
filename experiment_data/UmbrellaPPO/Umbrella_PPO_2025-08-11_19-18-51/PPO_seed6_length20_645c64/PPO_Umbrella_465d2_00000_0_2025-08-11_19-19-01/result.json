{"timers": {"training_iteration": 2.540180291980505, "restore_env_runners": 1.950003206729889e-05, "training_step": 2.5399626250145957, "env_runner_sampling_timer": 2.3843392078997567, "learner_update_timer": 0.14972700004000217, "synch_weights": 0.002118582953698933}, "env_runners": {"sample": 0.012975282801181261, "rlmodule_inference_timer": 7.531343011246363e-05, "num_episodes": 250.0, "num_episodes_lifetime": 31375.0, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.6574453501447845e-05, "add_observations_from_episodes_to_batch": 5.093790781653076e-06, "add_time_dim_to_batch_and_zero_pad": 5.032647764245585e-06, "add_states_from_episodes_to_batch": 2.7943984377658965e-06, "batch_individual_items": 1.1180363416870337e-05}}, "connector_pipeline_timer": 7.713509307375996e-05}, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_step_timer": 2.7185639830323565e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.7483762085565542e-05, "tensor_to_numpy": 2.373392237195658e-05, "get_actions": 8.443259317449751e-05, "remove_single_ts_time_rank_from_batch": 9.517142237815731e-07, "listify_data_for_vector_env": 1.952910589770506e-05, "un_batch_to_individual_items": 8.660108616903242e-06}}, "connector_pipeline_timer": 0.0002105620718472229}, "env_reset_timer": 0.00017522303943911046, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_env_steps_sampled": 5000.0, "weights_seq_no": 0.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.001091996874605486, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_mean": -0.14000000000000007, "num_env_steps_sampled_lifetime": 627500.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.008019612895790488, "num_env_steps_sampled_lifetime_throughput": 2343.0110614198625}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.00878600007854402, "add_observations_from_episodes_to_batch": 0.0011478340020403266, "batch_individual_items": 0.038212375016883016, "add_columns_from_episodes_to_train_batch": 0.04497704096138477, "add_one_ts_to_episodes_and_truncate": 0.015789000084623694, "add_time_dim_to_batch_and_zero_pad": 1.3917102478444576e-05, "add_states_from_episodes_to_batch": 4.041008651256561e-06, "numpy_to_tensor": 8.883303962647915e-05}}, "connector_pipeline_timer": 0.1093793329782784}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained_lifetime_throughput": 1505340.6241363478, "num_module_steps_trained_throughput": 288012.4492144854, "num_module_steps_trained_lifetime_throughput": 287440.31817796}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00010375812416896224, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 6000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.3732481598854065, "gradients_default_optimizer_global_norm": 0.025468185544013977, "vf_loss_unclipped": 28.37276268005371, "weights_seq_no": 1.0, "vf_explained_var": -0.011374115943908691, "policy_loss": 0.06390514224767685, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.12644556164741516, "entropy": 0.6931197643280029, "num_module_steps_trained_lifetime_throughput": 289575.6449653261}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_reset_timer": 0.00018212490249425173, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3790430826180732e-05, "get_actions": 6.951743731810498e-05, "remove_single_ts_time_rank_from_batch": 8.889601484176085e-07, "tensor_to_numpy": 2.2490358601130364e-05, "un_batch_to_individual_items": 7.471623782030669e-06, "listify_data_for_vector_env": 1.4643674763317299e-05}}, "connector_pipeline_timer": 0.0001620346151571447}, "episode_return_max": 13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "sample": 0.16618995799217373, "rlmodule_inference_timer": 5.4143004829142796e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "weights_seq_no": 1.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.93925182316271e-06, "add_time_dim_to_batch_and_zero_pad": 3.3616613707644762e-06, "numpy_to_tensor": 1.5064730954595054e-05, "batch_individual_items": 8.498905026313886e-06, "add_observations_from_episodes_to_batch": 3.964938877638156e-06}}, "connector_pipeline_timer": 6.065917700909427e-05}, "agent_episode_returns_mean": {"default_agent": 0.65}, "episode_return_mean": 0.65, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007645581307588145, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 2.1796677838023893e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 0.65}, "num_env_steps_sampled_lifetime": 5400, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes_lifetime": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-21", "timestamp": 1754933721, "time_this_iter_s": 2.7203571796417236, "time_total_s": 2.7203571796417236, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.7203571796417236, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.4, "ram_util_percent": 76.25}}
{"timers": {"training_iteration": 2.540488762810128, "restore_env_runners": 1.951503101736307e-05, "training_step": 2.540268828343833, "env_runner_sampling_timer": 2.3837700320698785, "learner_update_timer": 0.15062769087962805, "synch_weights": 0.002104132124222815, "restore_eval_env_runners": 1.0624993592500687e-05, "evaluation_iteration": 0.17797929199878126, "synch_eval_env_connectors": 0.00018450000789016485, "synch_env_connectors": 5.375011824071407e-06}, "env_runners": {"sample": 0.009016737593992163, "rlmodule_inference_timer": 5.0912212005249236e-05, "num_episodes": 250.0, "num_episodes_lifetime": 500.0, "module_episode_returns_mean": {"default_policy": 1.6200000000000008}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.5655806252659526e-05, "add_observations_from_episodes_to_batch": 4.6655526263508094e-06, "add_time_dim_to_batch_and_zero_pad": 4.013475072349035e-06, "add_states_from_episodes_to_batch": 2.5923643088118e-06, "batch_individual_items": 1.0584885786834727e-05}}, "connector_pipeline_timer": 6.933485076923979e-05}, "agent_episode_returns_mean": {"default_agent": 1.6200000000000008}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_step_timer": 2.421816679048422e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4799778912682944e-05, "tensor_to_numpy": 2.2609557575965172e-05, "get_actions": 7.732069683426757e-05, "remove_single_ts_time_rank_from_batch": 9.686041188414777e-07, "listify_data_for_vector_env": 1.7980987843318834e-05, "un_batch_to_individual_items": 8.512855987696598e-06}}, "connector_pipeline_timer": 0.0001817695888823937}, "env_reset_timer": 8.040774152295406e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 1.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0023699471970687353, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_mean": 1.6200000000000008, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007778066806960848, "num_env_steps_sampled_lifetime_throughput": 2423.437740732142}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008773627578048036, "add_observations_from_episodes_to_batch": 0.001144542741822079, "batch_individual_items": 0.039408312516752635, "add_columns_from_episodes_to_train_batch": 0.044984102221205836, "add_one_ts_to_episodes_and_truncate": 0.015718755923444405, "add_time_dim_to_batch_and_zero_pad": 1.390043064020574e-05, "add_states_from_episodes_to_batch": 4.040178610011935e-06, "numpy_to_tensor": 8.866720949299634e-05}}, "connector_pipeline_timer": 0.110493897148408}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained_lifetime_throughput": 1507638.6608473842, "num_module_steps_trained_throughput": 288434.32588588435, "num_module_steps_trained_lifetime_throughput": 287868.686469642}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00020176632096990943, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 12000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.18662407994270325, "gradients_default_optimizer_global_norm": 0.01637868583202362, "vf_loss_unclipped": 28.881858825683594, "weights_seq_no": 2.0, "vf_explained_var": -0.0108109712600708, "policy_loss": -0.027911582961678505, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.03462845832109451, "entropy": 0.6929256319999695, "num_module_steps_trained_lifetime_throughput": 289971.53786066256}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00018115115351974965, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.181554119916137e-05, "get_actions": 5.139756653586992e-05, "remove_single_ts_time_rank_from_batch": 6.503238508279044e-07, "tensor_to_numpy": 1.6835730806870068e-05, "un_batch_to_individual_items": 6.226341634876819e-06, "listify_data_for_vector_env": 1.3452348168242034e-05}}, "connector_pipeline_timer": 0.0001307814289627966}, "episode_return_max": 13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.366003441359926, "sample": 0.16585675633279606, "rlmodule_inference_timer": 3.423719313127859e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "weights_seq_no": 2.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0212766761156167e-06, "add_time_dim_to_batch_and_zero_pad": 2.8151034321442223e-06, "numpy_to_tensor": 1.1005963475025194e-05, "batch_individual_items": 7.69766656296243e-06, "add_observations_from_episodes_to_batch": 3.368404245798962e-06}}, "connector_pipeline_timer": 5.1577205562509476e-05}, "agent_episode_returns_mean": {"default_agent": 0.65}, "episode_return_mean": 0.65, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006828129210043698, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.790048682258628e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "module_episode_returns_mean": {"default_policy": 0.65}, "num_env_steps_sampled_lifetime": 10400, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes_lifetime": 40, "time_between_sampling": 2.6211121659725904}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-24", "timestamp": 1754933724, "time_this_iter_s": 2.7152082920074463, "time_total_s": 5.43556547164917, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.43556547164917, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 70.325, "ram_util_percent": 75.3}}
{"timers": {"training_iteration": 2.5385882285117987, "restore_env_runners": 1.9396970933303238e-05, "training_step": 2.538368379649974, "env_runner_sampling_timer": 2.382069059669913, "learner_update_timer": 0.15045169147034174, "synch_weights": 0.0020901520534884186, "restore_eval_env_runners": 1.0724993189796804e-05, "evaluation_iteration": 0.17761775365914217, "synch_eval_env_connectors": 0.0001875312568154186, "synch_env_connectors": 5.370011785998941e-06}, "env_runners": {"sample": 0.008009460820720404, "rlmodule_inference_timer": 4.7570729375820646e-05, "num_episodes": 250.0, "num_episodes_lifetime": -30375.0, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4500873272177613e-05, "add_observations_from_episodes_to_batch": 4.497509297574993e-06, "add_time_dim_to_batch_and_zero_pad": 3.820009248182997e-06, "add_states_from_episodes_to_batch": 2.5194262948335586e-06, "batch_individual_items": 1.010132309397917e-05}}, "connector_pipeline_timer": 6.609421486280877e-05}, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_step_timer": 2.256021152886492e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4176634299813008e-05, "tensor_to_numpy": 2.138011397344731e-05, "get_actions": 7.23352570706495e-05, "remove_single_ts_time_rank_from_batch": 8.959463409681618e-07, "listify_data_for_vector_env": 1.6909790219093056e-05, "un_batch_to_individual_items": 8.003509709102197e-06}}, "connector_pipeline_timer": 0.0001718848949811634}, "env_reset_timer": 7.192173599124727e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 2.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.002560736771606885, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_mean": 0.3400000000000001, "num_env_steps_sampled_lifetime": -607500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007362634344492108, "num_env_steps_sampled_lifetime_throughput": 2497.413897663742}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008745865052298178, "add_observations_from_episodes_to_batch": 0.001145366064400878, "batch_individual_items": 0.039492399391136135, "add_columns_from_episodes_to_train_batch": 0.04506752244923264, "add_one_ts_to_episodes_and_truncate": 0.015656682944099883, "add_time_dim_to_batch_and_zero_pad": 1.3921006128657609e-05, "add_states_from_episodes_to_batch": 4.03936734655872e-06, "numpy_to_tensor": 8.849803762277589e-05}}, "connector_pipeline_timer": 0.11057035609693266}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained_lifetime_throughput": 1516110.919812223, "num_module_steps_trained_throughput": 290023.16978455265, "num_module_steps_trained_lifetime_throughput": 289467.3441531607}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0011100023984909058, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 18000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.09331203997135162, "gradients_default_optimizer_global_norm": 0.05247271806001663, "vf_loss_unclipped": 28.72089958190918, "weights_seq_no": 3.0, "vf_explained_var": -0.011661171913146973, "policy_loss": -0.06263282895088196, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 6.134508294053376e-05, "entropy": 0.6904634833335876, "num_module_steps_trained_lifetime_throughput": 291515.28831655445}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00018015006142668426, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2494097570213835e-05, "get_actions": 5.874400663613507e-05, "remove_single_ts_time_rank_from_batch": 7.711314632657363e-07, "tensor_to_numpy": 1.8916765041980446e-05, "un_batch_to_individual_items": 8.140907617611201e-06, "listify_data_for_vector_env": 1.6855098084868665e-05}}, "connector_pipeline_timer": 0.00014990156122831098}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368205581254823, "sample": 0.1658853087696014, "rlmodule_inference_timer": 3.966274683008389e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "weights_seq_no": 3.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.935010354147778e-06, "add_time_dim_to_batch_and_zero_pad": 3.2064330876317254e-06, "numpy_to_tensor": 1.217423568218755e-05, "batch_individual_items": 8.275768643302986e-06, "add_observations_from_episodes_to_batch": 3.703976282418165e-06}}, "connector_pipeline_timer": 5.552560158980783e-05}, "agent_episode_returns_mean": {"default_agent": 0.9833333333333333}, "episode_return_mean": 0.9833333333333333, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007146295125130564, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 2.086866100271874e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "module_episode_returns_mean": {"default_policy": 0.9833333333333333}, "num_env_steps_sampled_lifetime": 15400, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes_lifetime": 60, "time_between_sampling": 2.6186711889028085}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-26", "timestamp": 1754933726, "time_this_iter_s": 2.5287768840789795, "time_total_s": 7.964342355728149, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.964342355728149, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.825, "ram_util_percent": 75.225}}
{"timers": {"training_iteration": 2.537808587066611, "restore_env_runners": 1.9378001392353324e-05, "training_step": 2.5375843933537086, "env_runner_sampling_timer": 2.3816436536539793, "learner_update_timer": 0.15010906913505634, "synch_weights": 0.0020765884526227603, "restore_eval_env_runners": 1.0711493680719285e-05, "evaluation_iteration": 0.1776018298728042, "synch_eval_env_connectors": 0.00019014219377422705, "synch_env_connectors": 5.3609010647051035e-06}, "env_runners": {"sample": 0.007617347710013908, "rlmodule_inference_timer": 4.663059378830993e-05, "num_episodes": 250.0, "num_episodes_lifetime": -61250.0, "module_episode_returns_mean": {"default_policy": 1.94}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3761105666836938e-05, "add_observations_from_episodes_to_batch": 4.414463722512934e-06, "add_time_dim_to_batch_and_zero_pad": 3.5863920810075717e-06, "add_states_from_episodes_to_batch": 2.3247740679407226e-06, "batch_individual_items": 9.906223113373408e-06}}, "connector_pipeline_timer": 6.339159686537358e-05}, "agent_episode_returns_mean": {"default_agent": 1.94}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_step_timer": 2.2626434966211297e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.452910264891412e-05, "tensor_to_numpy": 2.0738646729259044e-05, "get_actions": 7.092991616808779e-05, "remove_single_ts_time_rank_from_batch": 8.567953804328632e-07, "listify_data_for_vector_env": 1.9165685501410373e-05, "un_batch_to_individual_items": 7.732775870183853e-06}}, "connector_pipeline_timer": 0.00017071535737469195}, "env_reset_timer": 6.82908082376275e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 3.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0026311956561660215, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_mean": 1.94, "num_env_steps_sampled_lifetime": -1225000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0073232179940678176, "num_env_steps_sampled_lifetime_throughput": 2581.0277141419347}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008719688902167023, "add_observations_from_episodes_to_batch": 0.001143380323346821, "batch_individual_items": 0.03945403705752571, "add_columns_from_episodes_to_train_batch": 0.04505684931550362, "add_one_ts_to_episodes_and_truncate": 0.015594364453959859, "add_time_dim_to_batch_and_zero_pad": 1.3902216076268813e-05, "add_states_from_episodes_to_batch": 4.0456340982345854e-06, "numpy_to_tensor": 8.82993069422664e-05}}, "connector_pipeline_timer": 0.11042824586503347}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained_lifetime_throughput": 1521516.5565775372, "num_module_steps_trained_throughput": 291020.98988721916, "num_module_steps_trained_lifetime_throughput": 290477.5567607035}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0017774610314518213, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 24000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.04665601998567581, "gradients_default_optimizer_global_norm": 0.08418809622526169, "vf_loss_unclipped": 28.880634307861328, "weights_seq_no": 4.0, "vf_explained_var": -0.011780023574829102, "policy_loss": -0.004411409143358469, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.0583021305501461, "entropy": 0.6837658882141113, "num_module_steps_trained_lifetime_throughput": 292455.769985738}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00017923023108812049, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3622303105399203e-05, "get_actions": 6.611601710085669e-05, "remove_single_ts_time_rank_from_batch": 7.61292375317059e-07, "tensor_to_numpy": 1.8972826272790884e-05, "un_batch_to_individual_items": 8.063580108400136e-06, "listify_data_for_vector_env": 1.8263496971427204e-05}}, "connector_pipeline_timer": 0.00016204469438180428}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368237912813044, "sample": 0.16595025651198278, "rlmodule_inference_timer": 4.606067903217135e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "weights_seq_no": 4.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.068335341774273e-06, "add_time_dim_to_batch_and_zero_pad": 3.447186196962759e-06, "numpy_to_tensor": 1.5498923090330746e-05, "batch_individual_items": 9.692816889072463e-06, "add_observations_from_episodes_to_batch": 3.892079839500247e-06}}, "connector_pipeline_timer": 6.611472366019336e-05}, "agent_episode_returns_mean": {"default_agent": 1.9}, "episode_return_mean": 1.9, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007328060381405521, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 2.3832671081727702e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "module_episode_returns_mean": {"default_policy": 1.9}, "num_env_steps_sampled_lifetime": 20400, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes_lifetime": 80, "time_between_sampling": 2.617298758674145}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-29", "timestamp": 1754933729, "time_this_iter_s": 2.6419458389282227, "time_total_s": 10.606288194656372, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.606288194656372, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 67.64999999999999, "ram_util_percent": 75.875}}
{"timers": {"training_iteration": 2.536766651195817, "restore_env_runners": 1.9246311490326186e-05, "training_step": 2.5365411448400086, "env_runner_sampling_timer": 2.3807357433666696, "learner_update_timer": 0.14994351719398732, "synch_weights": 0.0020716013180449, "restore_eval_env_runners": 1.0718548414180985e-05, "evaluation_iteration": 0.1776169611544617, "synch_eval_env_connectors": 0.00018948827260441612, "synch_env_connectors": 5.491451779962517e-06}, "env_runners": {"sample": 0.008083986198942673, "rlmodule_inference_timer": 7.482034365697154e-05, "num_episodes": 250.0, "num_episodes_lifetime": -92125.0, "module_episode_returns_mean": {"default_policy": 3.7}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4137265542536973e-05, "add_observations_from_episodes_to_batch": 4.338431435849286e-06, "add_time_dim_to_batch_and_zero_pad": 3.741096213819638e-06, "add_states_from_episodes_to_batch": 2.3331086835919668e-06, "batch_individual_items": 9.839092057255321e-06}}, "connector_pipeline_timer": 6.44082338484712e-05}, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_step_timer": 2.2011804573633808e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4165590717055211e-05, "tensor_to_numpy": 2.1161148731629395e-05, "get_actions": 7.135931986987553e-05, "remove_single_ts_time_rank_from_batch": 8.845890125135043e-07, "listify_data_for_vector_env": 1.753585605943411e-05, "un_batch_to_individual_items": 7.98498971361908e-06}}, "connector_pipeline_timer": 0.00017072697211254422}, "env_reset_timer": 7.050569157695975e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 4.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.002440501565318204, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_mean": 3.7, "num_env_steps_sampled_lifetime": -1842500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007736173518467696, "num_env_steps_sampled_lifetime_throughput": 2536.117503493091}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.00869998368421581, "add_observations_from_episodes_to_batch": 0.0011400231904601344, "batch_individual_items": 0.03953219459710469, "add_columns_from_episodes_to_train_batch": 0.045002949572675664, "add_one_ts_to_episodes_and_truncate": 0.015516057059482174, "add_time_dim_to_batch_and_zero_pad": 1.387569419006002e-05, "add_states_from_episodes_to_batch": 4.034767039600991e-06, "numpy_to_tensor": 8.812756375892435e-05}}, "connector_pipeline_timer": 0.11034852173633787}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained_lifetime_throughput": 1518240.5365751556, "num_module_steps_trained_throughput": 290363.12161545473, "num_module_steps_trained_lifetime_throughput": 289832.0207648586}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0009778609964996576, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 30000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.023328009992837906, "gradients_default_optimizer_global_norm": 0.03668160364031792, "vf_loss_unclipped": 28.88611602783203, "weights_seq_no": 5.0, "vf_explained_var": -0.012585759162902832, "policy_loss": 0.17475159466266632, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.23743394017219543, "entropy": 0.6739362478256226, "num_module_steps_trained_lifetime_throughput": 291734.3428793065}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0001784958390445029, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3050747727887753e-05, "get_actions": 6.000473052832996e-05, "remove_single_ts_time_rank_from_batch": 7.695792365302345e-07, "tensor_to_numpy": 1.828592296475443e-05, "un_batch_to_individual_items": 7.231885072030624e-06, "listify_data_for_vector_env": 1.5649360345978305e-05}}, "connector_pipeline_timer": 0.00014945473869584886}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238387501162, "sample": 0.16586912685701607, "rlmodule_inference_timer": 3.872167249908034e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "weights_seq_no": 5.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8610047677130608e-06, "add_time_dim_to_batch_and_zero_pad": 3.195440274684912e-06, "numpy_to_tensor": 1.2400507627058655e-05, "batch_individual_items": 8.642791217598122e-06, "add_observations_from_episodes_to_batch": 3.657426607872148e-06}}, "connector_pipeline_timer": 5.68299879875993e-05}, "agent_episode_returns_mean": {"default_agent": 1.85}, "episode_return_mean": 1.85, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007299020815407857, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.885288191725054e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "module_episode_returns_mean": {"default_policy": 1.85}, "num_env_steps_sampled_lifetime": 25400, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes_lifetime": 100, "time_between_sampling": 2.61579696900751}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-32", "timestamp": 1754933732, "time_this_iter_s": 2.605774164199829, "time_total_s": 13.212062358856201, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.212062358856201, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 68.06666666666666, "ram_util_percent": 75.7}}
{"timers": {"training_iteration": 2.5358309313537966, "restore_env_runners": 1.91130187910479e-05, "training_step": 2.535605605062045, "env_runner_sampling_timer": 2.3790897863535942, "learner_update_timer": 0.15067932785126273, "synch_weights": 0.002057427804041609, "restore_eval_env_runners": 1.0684283159325131e-05, "evaluation_iteration": 0.1774938827938359, "synch_eval_env_connectors": 0.0001894983904141432, "synch_env_connectors": 5.476537566742626e-06}, "env_runners": {"sample": 0.008188507073215088, "rlmodule_inference_timer": 4.741379610733243e-05, "num_episodes": 250.0, "num_episodes_lifetime": -123000.0, "module_episode_returns_mean": {"default_policy": 3.06}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4535126469788835e-05, "add_observations_from_episodes_to_batch": 4.5653511635596825e-06, "add_time_dim_to_batch_and_zero_pad": 3.789800546138483e-06, "add_states_from_episodes_to_batch": 2.413437519774059e-06, "batch_individual_items": 9.993727264708724e-06}}, "connector_pipeline_timer": 6.587452911019343e-05}, "agent_episode_returns_mean": {"default_agent": 3.06}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_step_timer": 2.2959630850777305e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4094809427838145e-05, "tensor_to_numpy": 2.1514978352103288e-05, "get_actions": 7.222757044632636e-05, "remove_single_ts_time_rank_from_batch": 8.929659841981902e-07, "listify_data_for_vector_env": 1.7472775435035503e-05, "un_batch_to_individual_items": 7.95182796789152e-06}}, "connector_pipeline_timer": 0.00017170456078107737}, "env_reset_timer": 6.86392188709769e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 5.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0022644766715737724, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_mean": 3.06, "num_env_steps_sampled_lifetime": -2460000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007350809500552709, "num_env_steps_sampled_lifetime_throughput": 2517.0449758331965}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008674672597657444, "add_observations_from_episodes_to_batch": 0.0011433233685118095, "batch_individual_items": 0.04058098515130948, "add_columns_from_episodes_to_train_batch": 0.04498172882636948, "add_one_ts_to_episodes_and_truncate": 0.015467194408879711, "add_time_dim_to_batch_and_zero_pad": 1.3989857683900963e-05, "add_states_from_episodes_to_batch": 4.04441974992965e-06, "numpy_to_tensor": 8.801336730330428e-05}}, "connector_pipeline_timer": 0.111303673608769}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 1519200.6214431624, "num_module_steps_trained_throughput": 290510.5477966874, "num_module_steps_trained_lifetime_throughput": 289992.39880146337}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 9.713070176076144e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 36000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.011664004996418953, "gradients_default_optimizer_global_norm": 0.07187046110630035, "vf_loss_unclipped": 29.362754821777344, "weights_seq_no": 6.0, "vf_explained_var": -0.011776924133300781, "policy_loss": -0.1344889998435974, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": -0.0718490481376648, "entropy": 0.6738317012786865, "num_module_steps_trained_lifetime_throughput": 291811.5507404865}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0001774583811072022, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4094946439320482e-05, "get_actions": 7.231106484049284e-05, "remove_single_ts_time_rank_from_batch": 7.754813063329584e-07, "tensor_to_numpy": 2.216004044016963e-05, "un_batch_to_individual_items": 7.879054699575416e-06, "listify_data_for_vector_env": 1.8033879890169008e-05}}, "connector_pipeline_timer": 0.00017496667147572325}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394470474, "sample": 0.16626543641772348, "rlmodule_inference_timer": 5.0002030450780704e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "weights_seq_no": 6.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.529201576561587e-06, "add_time_dim_to_batch_and_zero_pad": 3.50132692277481e-06, "numpy_to_tensor": 1.4149376856575137e-05, "batch_individual_items": 1.0434407604999199e-05, "add_observations_from_episodes_to_batch": 4.011661718791476e-06}}, "connector_pipeline_timer": 6.616936547378888e-05}, "agent_episode_returns_mean": {"default_agent": 1.45}, "episode_return_mean": 1.45, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0076520228735171255, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 2.4202408511746098e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "module_episode_returns_mean": {"default_policy": 1.45}, "num_env_steps_sampled_lifetime": 30400, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes_lifetime": 120, "time_between_sampling": 2.614276281817478}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-34", "timestamp": 1754933734, "time_this_iter_s": 2.65632700920105, "time_total_s": 15.868389368057251, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.868389368057251, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 67.47500000000001, "ram_util_percent": 75.60000000000001}}
{"timers": {"training_iteration": 2.533127376210475, "restore_env_runners": 1.8996057968826576e-05, "training_step": 2.5329022802616974, "env_runner_sampling_timer": 2.3763258730794656, "learner_update_timer": 0.15075281707253096, "synch_weights": 0.002046334776309647, "restore_eval_env_runners": 1.0654940335778507e-05, "evaluation_iteration": 0.17782815062584972, "synch_eval_env_connectors": 0.00018858340582313273, "synch_env_connectors": 5.465101973859184e-06}, "env_runners": {"sample": 0.0075598230664511564, "rlmodule_inference_timer": 4.516276427105523e-05, "num_episodes": 250.0, "num_episodes_lifetime": -153875.0, "module_episode_returns_mean": {"default_policy": 4.5}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3616670962867523e-05, "add_observations_from_episodes_to_batch": 4.531197058543813e-06, "add_time_dim_to_batch_and_zero_pad": 3.6002612791152455e-06, "add_states_from_episodes_to_batch": 2.334496092485033e-06, "batch_individual_items": 9.545567977760597e-06}}, "connector_pipeline_timer": 6.299277716624662e-05}, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_step_timer": 2.110496439037423e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3569514350136464e-05, "tensor_to_numpy": 2.0202508409555077e-05, "get_actions": 6.738250780598513e-05, "remove_single_ts_time_rank_from_batch": 7.980266141483029e-07, "listify_data_for_vector_env": 1.599340617476904e-05, "un_batch_to_individual_items": 7.57004068088232e-06}}, "connector_pipeline_timer": 0.00016117866575563367}, "env_reset_timer": 6.571644259625203e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 6.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0027500983880753786, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_mean": 4.5, "num_env_steps_sampled_lifetime": -3077500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006983116698451339, "num_env_steps_sampled_lifetime_throughput": 2618.8455567285123}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.00869889295178969, "add_observations_from_episodes_to_batch": 0.001147379294677095, "batch_individual_items": 0.0407056598897773, "add_columns_from_episodes_to_train_batch": 0.044914805707412166, "add_one_ts_to_episodes_and_truncate": 0.01541834037530755, "add_time_dim_to_batch_and_zero_pad": 1.3973289499005407e-05, "add_states_from_episodes_to_batch": 4.044396116321883e-06, "numpy_to_tensor": 8.848989355302004e-05}}, "connector_pipeline_timer": 0.11133973020328626}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained_lifetime_throughput": 1510555.6598142884, "num_module_steps_trained_throughput": 288818.1994822726, "num_module_steps_trained_lifetime_throughput": 288316.66745417955}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0001997690269490704, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 42000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0058320024982094765, "gradients_default_optimizer_global_norm": 0.118752621114254, "vf_loss_unclipped": 29.43939208984375, "weights_seq_no": 7.0, "vf_explained_var": -0.012065649032592773, "policy_loss": -0.04945483058691025, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.013212400488555431, "entropy": 0.6708225607872009, "num_module_steps_trained_lifetime_throughput": 290036.7526435214}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0001765258770491863, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.1852343118473674e-05, "get_actions": 5.703929377903247e-05, "remove_single_ts_time_rank_from_batch": 7.688189873669057e-07, "tensor_to_numpy": 1.923939985564876e-05, "un_batch_to_individual_items": 6.754754155213526e-06, "listify_data_for_vector_env": 1.4934852222489548e-05}}, "connector_pipeline_timer": 0.00014281613712333464}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394572801, "sample": 0.16607952747391463, "rlmodule_inference_timer": 3.892844527098205e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "weights_seq_no": 7.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0330501962422483e-06, "add_time_dim_to_batch_and_zero_pad": 3.1879408008538077e-06, "numpy_to_tensor": 1.1372336895994728e-05, "batch_individual_items": 8.277146197046223e-06, "add_observations_from_episodes_to_batch": 3.5744472776935107e-06}}, "connector_pipeline_timer": 5.565460246089703e-05}, "agent_episode_returns_mean": {"default_agent": 2.05}, "episode_return_mean": 2.05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00780388243845664, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.8813561525396545e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "module_episode_returns_mean": {"default_policy": 2.05}, "num_env_steps_sampled_lifetime": 35400, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes_lifetime": 140, "time_between_sampling": 2.611022961078771}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-37", "timestamp": 1754933737, "time_this_iter_s": 2.4239938259124756, "time_total_s": 18.292383193969727, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.292383193969727, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 66.02499999999999, "ram_util_percent": 75.425}}
{"timers": {"training_iteration": 2.5327532453688364, "restore_env_runners": 1.8864847545451492e-05, "training_step": 2.5325277620393174, "env_runner_sampling_timer": 2.375942285598675, "learner_update_timer": 0.1507724843116773, "synch_weights": 0.0020340722593265204, "restore_eval_env_runners": 1.0623391503507725e-05, "evaluation_iteration": 0.17760561994945737, "synch_eval_env_connectors": 0.00018796090152414154, "synch_env_connectors": 5.456701597329216e-06}, "env_runners": {"sample": 0.008011990180217596, "rlmodule_inference_timer": 6.542410207101596e-05, "num_episodes": 250.0, "num_episodes_lifetime": -184750.0, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4541143758167868e-05, "add_observations_from_episodes_to_batch": 4.687498261964679e-06, "add_time_dim_to_batch_and_zero_pad": 3.6668880242593663e-06, "add_states_from_episodes_to_batch": 2.45817316765355e-06, "batch_individual_items": 1.0178910081475102e-05}}, "connector_pipeline_timer": 6.62360827773357e-05}, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_step_timer": 2.2614634376236065e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4177817954878383e-05, "tensor_to_numpy": 2.143455552266423e-05, "get_actions": 7.097558772546112e-05, "remove_single_ts_time_rank_from_batch": 8.557478969798683e-07, "listify_data_for_vector_env": 1.654664774540649e-05, "un_batch_to_individual_items": 8.175884258541603e-06}}, "connector_pipeline_timer": 0.00016962129680399664}, "env_reset_timer": 6.764843523853453e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 7.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.002303305239992245, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_mean": 3.4599999999999995, "num_env_steps_sampled_lifetime": -3695000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00787013515038416, "num_env_steps_sampled_lifetime_throughput": 2528.9931785807667}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008761279022309047, "add_observations_from_episodes_to_batch": 0.0011473684120639725, "batch_individual_items": 0.04080503621110822, "add_columns_from_episodes_to_train_batch": 0.044871779729922796, "add_one_ts_to_episodes_and_truncate": 0.015347996971997636, "add_time_dim_to_batch_and_zero_pad": 1.3943146495523574e-05, "add_states_from_episodes_to_batch": 4.036451820553089e-06, "numpy_to_tensor": 8.939708393262115e-05}}, "connector_pipeline_timer": 0.1113871841514232}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained_lifetime_throughput": 1495982.0863747566, "num_module_steps_trained_throughput": 285992.04970028973, "num_module_steps_trained_lifetime_throughput": 285509.39070510765}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0009722818504087627, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 48000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0029160012491047382, "gradients_default_optimizer_global_norm": 0.023772811517119408, "vf_loss_unclipped": 29.270179748535156, "weights_seq_no": 8.0, "vf_explained_var": -0.013218998908996582, "policy_loss": -0.044244833290576935, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.018546825274825096, "entropy": 0.6574549674987793, "num_module_steps_trained_lifetime_throughput": 287124.7412929528}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00017556061738536983, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.214019467135683e-05, "get_actions": 5.934577642400168e-05, "remove_single_ts_time_rank_from_batch": 9.672195127546012e-07, "tensor_to_numpy": 1.730831625865447e-05, "un_batch_to_individual_items": 6.89605568447311e-06, "listify_data_for_vector_env": 1.4146549463911327e-05}}, "connector_pipeline_timer": 0.0001437250122549192}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.3682383945743, "sample": 0.1659736976191031, "rlmodule_inference_timer": 3.9702349620177936e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "weights_seq_no": 8.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.1429517708046976e-06, "add_time_dim_to_batch_and_zero_pad": 3.0832603655224333e-06, "numpy_to_tensor": 1.1636364250817087e-05, "batch_individual_items": 8.299974583799504e-06, "add_observations_from_episodes_to_batch": 3.7832637022738437e-06}}, "connector_pipeline_timer": 5.6495339739901393e-05}, "agent_episode_returns_mean": {"default_agent": 2.05}, "episode_return_mean": 2.05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007670257479185238, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.9489228411108796e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "module_episode_returns_mean": {"default_policy": 2.05}, "num_env_steps_sampled_lifetime": 40400, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes_lifetime": 160, "time_between_sampling": 2.6101099381279242}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-39", "timestamp": 1754933739, "time_this_iter_s": 2.662332773208618, "time_total_s": 20.954715967178345, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.954715967178345, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 67.76666666666667, "ram_util_percent": 75.46666666666665}}
{"timers": {"training_iteration": 2.5310104612447426, "restore_env_runners": 1.8739119223138e-05, "training_step": 2.5307851881695047, "env_runner_sampling_timer": 2.3733837769125827, "learner_update_timer": 0.15160712529853307, "synch_weights": 0.0020207294561418597, "restore_eval_env_runners": 1.059090669485001e-05, "evaluation_iteration": 0.17745538666984934, "synch_eval_env_connectors": 0.00018937713250590858, "synch_env_connectors": 5.4425551452474535e-06}, "env_runners": {"sample": 0.007879039054818402, "rlmodule_inference_timer": 4.6448243427637876e-05, "num_episodes": 250.0, "num_episodes_lifetime": -215625.0, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4351249805649225e-05, "add_observations_from_episodes_to_batch": 4.480530093226855e-06, "add_time_dim_to_batch_and_zero_pad": 3.5828391444159727e-06, "add_states_from_episodes_to_batch": 2.3546857168080266e-06, "batch_individual_items": 9.768399529963328e-06}}, "connector_pipeline_timer": 6.496968342988959e-05}, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_step_timer": 2.302976108517244e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4291652536928706e-05, "tensor_to_numpy": 2.199889954027607e-05, "get_actions": 7.114538908807103e-05, "remove_single_ts_time_rank_from_batch": 9.323030629189768e-07, "listify_data_for_vector_env": 1.6500509848948784e-05, "un_batch_to_individual_items": 7.971536042618996e-06}}, "connector_pipeline_timer": 0.00017009939061736219}, "env_reset_timer": 6.598615421737826e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 8.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0023161789348059435, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_mean": 5.460000000000001, "num_env_steps_sampled_lifetime": -4312500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0070430896836332964, "num_env_steps_sampled_lifetime_throughput": 2589.6187581202353}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008737552061963064, "add_observations_from_episodes_to_batch": 0.0011441155577114391, "batch_individual_items": 0.040751378348427236, "add_columns_from_episodes_to_train_batch": 0.044844191092718574, "add_one_ts_to_episodes_and_truncate": 0.016443749501672225, "add_time_dim_to_batch_and_zero_pad": 1.3938305112438894e-05, "add_states_from_episodes_to_batch": 4.0352470883037024e-06, "numpy_to_tensor": 8.919936402931137e-05}}, "connector_pipeline_timer": 0.11237256272059241}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained_lifetime_throughput": 1482744.142489918, "num_module_steps_trained_throughput": 283417.8278359756, "num_module_steps_trained_lifetime_throughput": 282953.160339119}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0005018218071199954, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 54000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0014580006245523691, "gradients_default_optimizer_global_norm": 0.04388493672013283, "vf_loss_unclipped": 29.713878631591797, "weights_seq_no": 9.0, "vf_explained_var": -0.012197732925415039, "policy_loss": -0.10784247517585754, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": -0.044999025762081146, "entropy": 0.6512721180915833, "num_module_steps_trained_lifetime_throughput": 284472.8514399701}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00017457668181377817, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.083555978982752e-05, "get_actions": 4.9532404706188354e-05, "remove_single_ts_time_rank_from_batch": 6.447003440419192e-07, "tensor_to_numpy": 1.589640846998214e-05, "un_batch_to_individual_items": 6.323855320896784e-06, "listify_data_for_vector_env": 1.3680018654374479e-05}}, "connector_pipeline_timer": 0.00012692226537967338}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16556566314365212, "rlmodule_inference_timer": 3.440095753091355e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 9.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7282063909999604e-06, "add_time_dim_to_batch_and_zero_pad": 2.740827089757477e-06, "numpy_to_tensor": 1.0877187549215015e-05, "batch_individual_items": 7.3848991077145295e-06, "add_observations_from_episodes_to_batch": 3.402901114898225e-06}}, "connector_pipeline_timer": 5.046125821292882e-05}, "agent_episode_returns_mean": {"default_agent": 1.45}, "episode_return_mean": 1.45, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00724534916691482, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.7748777007670712e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "module_episode_returns_mean": {"default_policy": 1.45}, "num_env_steps_sampled_lifetime": 45400, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes_lifetime": 180, "time_between_sampling": 2.607806733746961}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-42", "timestamp": 1754933742, "time_this_iter_s": 2.4932239055633545, "time_total_s": 23.4479398727417, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.4479398727417, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 68.35, "ram_util_percent": 75.475}}
{"timers": {"training_iteration": 2.526706067472986, "restore_env_runners": 1.8612558529020848e-05, "training_step": 2.526481335037466, "env_runner_sampling_timer": 2.3688169378937545, "learner_update_timer": 0.15189790612501, "synch_weights": 0.0020061259120496043, "restore_eval_env_runners": 1.055332760104783e-05, "evaluation_iteration": 0.17698694696267528, "synch_eval_env_connectors": 0.00018855086174232523, "synch_env_connectors": 5.4302090760225425e-06}, "env_runners": {"sample": 0.0073998913618186, "rlmodule_inference_timer": 4.077714195220617e-05, "num_episodes": 250.0, "num_episodes_lifetime": -246500.0, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2536837044925677e-05, "add_observations_from_episodes_to_batch": 4.0951509925964225e-06, "add_time_dim_to_batch_and_zero_pad": 3.24639280052348e-06, "add_states_from_episodes_to_batch": 2.1456982061700826e-06, "batch_individual_items": 8.676436967226508e-06}}, "connector_pipeline_timer": 5.789712213500666e-05}, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_step_timer": 1.9615351883307483e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.242898422363056e-05, "tensor_to_numpy": 1.832022673248966e-05, "get_actions": 6.0820636673516795e-05, "remove_single_ts_time_rank_from_batch": 7.982125269330074e-07, "listify_data_for_vector_env": 1.4636185434320057e-05, "un_batch_to_individual_items": 7.131001968276001e-06}}, "connector_pipeline_timer": 0.00014807547652457163}, "env_reset_timer": 6.611903780751246e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 9.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0024565174153215255, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_mean": 6.659999999999997, "num_env_steps_sampled_lifetime": -4930000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006352186973206699, "num_env_steps_sampled_lifetime_throughput": 2840.767140799964}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.00870266779086004, "add_observations_from_episodes_to_batch": 0.0011407702414279984, "batch_individual_items": 0.04153218956447283, "add_columns_from_episodes_to_train_batch": 0.04474184293235018, "add_one_ts_to_episodes_and_truncate": 0.01635792700572999, "add_time_dim_to_batch_and_zero_pad": 1.389683316773705e-05, "add_states_from_episodes_to_batch": 4.02698450088226e-06, "numpy_to_tensor": 8.891195007986209e-05}}, "connector_pipeline_timer": 0.11292419042301519}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained_lifetime_throughput": 1484838.9558942227, "num_module_steps_trained_throughput": 283772.05307227554, "num_module_steps_trained_lifetime_throughput": 283322.7432198698}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00037937649176456034, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 60000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0007290003122761846, "gradients_default_optimizer_global_norm": 0.04102873429656029, "vf_loss_unclipped": 29.858129501342773, "weights_seq_no": 10.0, "vf_explained_var": -0.01230764389038086, "policy_loss": -0.08268185704946518, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": -0.019771618768572807, "entropy": 0.6437965035438538, "num_module_steps_trained_lifetime_throughput": 284752.7380016485}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00017359924447816596, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.140146909814333e-06, "get_actions": 3.777113313311221e-05, "remove_single_ts_time_rank_from_batch": 5.571118569047718e-07, "tensor_to_numpy": 1.344507585009652e-05, "un_batch_to_individual_items": 5.216852146187062e-06, "listify_data_for_vector_env": 1.067074255266463e-05}}, "connector_pipeline_timer": 0.00010194677743251312}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.1648825869318361, "rlmodule_inference_timer": 2.7333854505572028e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 10.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5475826456227884e-06, "add_time_dim_to_batch_and_zero_pad": 2.2206540440712904e-06, "numpy_to_tensor": 8.115322399445054e-06, "batch_individual_items": 5.998214281845373e-06, "add_observations_from_episodes_to_batch": 2.754955810523088e-06}}, "connector_pipeline_timer": 4.183742959213104e-05}, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_return_mean": 0.85, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00670468415832147, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.3511545530358718e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "module_episode_returns_mean": {"default_policy": 0.85}, "num_env_steps_sampled_lifetime": 50400, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes_lifetime": 200, "time_between_sampling": 2.6029145818202433}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-44", "timestamp": 1754933744, "time_this_iter_s": 2.204674243927002, "time_total_s": 25.6526141166687, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.6526141166687, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 60.96666666666666, "ram_util_percent": 75.3}}
{"timers": {"training_iteration": 2.51616397971805, "restore_env_runners": 1.847976280265956e-05, "training_step": 2.5159399591877434, "env_runner_sampling_timer": 2.358879150184778, "learner_update_timer": 0.15132101206374776, "synch_weights": 0.001992188402701195, "restore_eval_env_runners": 1.0509873959554783e-05, "evaluation_iteration": 0.17623590416352755, "synch_eval_env_connectors": 0.00018764785303914582, "synch_env_connectors": 5.415066771218461e-06}, "env_runners": {"sample": 0.005325770241960041, "rlmodule_inference_timer": 2.844398525071469e-05, "num_episodes": 250.0, "num_episodes_lifetime": -277375.0, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.4947206418956e-06, "add_observations_from_episodes_to_batch": 2.971547014292427e-06, "add_time_dim_to_batch_and_zero_pad": 2.403870364136132e-06, "add_states_from_episodes_to_batch": 1.7393043272617465e-06, "batch_individual_items": 6.228810194862396e-06}}, "connector_pipeline_timer": 4.3438152964621675e-05}, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_step_timer": 1.3469631123200509e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.417427155248794e-06, "tensor_to_numpy": 1.3194082797520243e-05, "get_actions": 3.988405219420955e-05, "remove_single_ts_time_rank_from_batch": 5.891184778298293e-07, "listify_data_for_vector_env": 1.0968823001588023e-05, "un_batch_to_individual_items": 5.417065034927699e-06}}, "connector_pipeline_timer": 0.00010492098907131503}, "env_reset_timer": 3.8011012386671264e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 10.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0019003235067932848, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_mean": 5.940000000000001, "num_env_steps_sampled_lifetime": -5547500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004567726677749307, "num_env_steps_sampled_lifetime_throughput": 3735.5761877666355}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008686301942029845, "add_observations_from_episodes_to_batch": 0.0011375017092543293, "batch_individual_items": 0.04141932141887407, "add_columns_from_episodes_to_train_batch": 0.04464422741337694, "add_one_ts_to_episodes_and_truncate": 0.016269860234988356, "add_time_dim_to_batch_and_zero_pad": 1.3849114657767285e-05, "add_states_from_episodes_to_batch": 4.013794023883601e-06, "numpy_to_tensor": 8.853491131179648e-05}}, "connector_pipeline_timer": 0.112603045188865}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained_lifetime_throughput": 1497752.6835292857, "num_module_steps_trained_throughput": 286192.5906388451, "num_module_steps_trained_lifetime_throughput": 285756.81073943444}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00017876990023069084, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 66000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0003645001561380923, "gradients_default_optimizer_global_norm": 0.044992342591285706, "vf_loss_unclipped": 29.646411895751953, "weights_seq_no": 11.0, "vf_explained_var": -0.014516830444335938, "policy_loss": -0.03828921541571617, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.024718768894672394, "entropy": 0.6329572796821594, "num_module_steps_trained_lifetime_throughput": 287097.6686810156}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00017252950274096595, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.180790920751932e-06, "get_actions": 3.811106656046076e-05, "remove_single_ts_time_rank_from_batch": 5.587328105404034e-07, "tensor_to_numpy": 1.3057537115003768e-05, "un_batch_to_individual_items": 5.3032864386701875e-06, "listify_data_for_vector_env": 1.075669535440607e-05}}, "connector_pipeline_timer": 0.00010266566843453044}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16420374023299478, "rlmodule_inference_timer": 2.7355245687112112e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 11.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5717319259843965e-06, "add_time_dim_to_batch_and_zero_pad": 2.2752501441209267e-06, "numpy_to_tensor": 8.283278475827391e-06, "batch_individual_items": 5.989496784587996e-06, "add_observations_from_episodes_to_batch": 2.810074818337837e-06}}, "connector_pipeline_timer": 4.231546316344588e-05}, "agent_episode_returns_mean": {"default_agent": 2.65}, "episode_return_mean": 2.65, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005715356267755851, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.375436743839176e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "module_episode_returns_mean": {"default_policy": 2.65}, "num_env_steps_sampled_lifetime": 55400, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes_lifetime": 220, "time_between_sampling": 2.5917763860017216}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-46", "timestamp": 1754933746, "time_this_iter_s": 1.576158046722412, "time_total_s": 27.228772163391113, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.228772163391113, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.2, "ram_util_percent": 74.85}}
{"timers": {"training_iteration": 2.5070700732512887, "restore_env_runners": 1.8348295033561883e-05, "training_step": 2.5068469116864316, "env_runner_sampling_timer": 2.3504305274335886, "learner_update_timer": 0.15070395319287289, "synch_weights": 0.0019777331784603626, "restore_eval_env_runners": 1.0469355455589509e-05, "evaluation_iteration": 0.17548782595100526, "synch_eval_env_connectors": 0.00018671220472270343, "synch_env_connectors": 5.402576490575263e-06}, "env_runners": {"sample": 0.005045428641309734, "rlmodule_inference_timer": 2.9142216378767737e-05, "num_episodes": 250.0, "num_episodes_lifetime": -308250.0, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.88012381908892e-06, "add_observations_from_episodes_to_batch": 3.2720140926288877e-06, "add_time_dim_to_batch_and_zero_pad": 2.5004966692552433e-06, "add_states_from_episodes_to_batch": 1.7817824925405943e-06, "batch_individual_items": 6.417067490163555e-06}}, "connector_pipeline_timer": 4.5068569578157875e-05}, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_step_timer": 1.4107529842622788e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.678144552526834e-06, "tensor_to_numpy": 1.3770576783234669e-05, "get_actions": 4.20233712006977e-05, "remove_single_ts_time_rank_from_batch": 6.115669139171153e-07, "listify_data_for_vector_env": 1.1232648245800855e-05, "un_batch_to_individual_items": 5.639014375197238e-06}}, "connector_pipeline_timer": 0.00010901100215165563}, "env_reset_timer": 4.2138642659462534e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 11.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0018043941369952387, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_mean": 6.659999999999997, "num_env_steps_sampled_lifetime": -6165000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004736694134771825, "num_env_steps_sampled_lifetime_throughput": 3628.698973656055}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008650620172628546, "add_observations_from_episodes_to_batch": 0.001134257111462655, "batch_individual_items": 0.04130222528414118, "add_columns_from_episodes_to_train_batch": 0.044533625559109315, "add_one_ts_to_episodes_and_truncate": 0.016182556632805663, "add_time_dim_to_batch_and_zero_pad": 1.3801453073585423e-05, "add_states_from_episodes_to_batch": 4.001985752211349e-06, "numpy_to_tensor": 8.828414211795714e-05}}, "connector_pipeline_timer": 0.11224622390722472}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 1519001.0793468934, "num_module_steps_trained_throughput": 290205.24761135556, "num_module_steps_trained_lifetime_throughput": 289781.35777079884}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 3.76364951080177e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 72000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.00018225007806904614, "gradients_default_optimizer_global_norm": 0.04603158310055733, "vf_loss_unclipped": 29.652629852294922, "weights_seq_no": 12.0, "vf_explained_var": -0.015211820602416992, "policy_loss": 0.05211615562438965, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.11514448374509811, "entropy": 0.6306999921798706, "num_module_steps_trained_lifetime_throughput": 291035.2014735503}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0001714979580484599, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.10935272269112e-06, "get_actions": 3.729890471968139e-05, "remove_single_ts_time_rank_from_batch": 5.608727357632236e-07, "tensor_to_numpy": 1.2740110871534459e-05, "un_batch_to_individual_items": 5.236198033999664e-06, "listify_data_for_vector_env": 1.0648826479562843e-05}}, "connector_pipeline_timer": 0.00010070362756883555}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16354739158059844, "rlmodule_inference_timer": 2.683676695964347e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 12.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.532201602846516e-06, "add_time_dim_to_batch_and_zero_pad": 2.2139078854184167e-06, "numpy_to_tensor": 8.108512161716231e-06, "batch_individual_items": 5.934702756300151e-06, "add_observations_from_episodes_to_batch": 2.760513098569117e-06}}, "connector_pipeline_timer": 4.185134783070044e-05}, "agent_episode_returns_mean": {"default_agent": 2.25}, "episode_return_mean": 2.25, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005266697133192793, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.353166026421133e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "module_episode_returns_mean": {"default_policy": 2.25}, "num_env_steps_sampled_lifetime": 60400, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes_lifetime": 240, "time_between_sampling": 2.5820874129720597}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-47", "timestamp": 1754933747, "time_this_iter_s": 1.7122888565063477, "time_total_s": 28.94106101989746, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.94106101989746, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.36666666666667, "ram_util_percent": 74.86666666666666}}
{"timers": {"training_iteration": 2.497487632518323, "restore_env_runners": 1.8220642543268024e-05, "training_step": 2.497264145068849, "env_runner_sampling_timer": 2.341396909238263, "learner_update_timer": 0.15017303698996332, "synch_weights": 0.001964667096846824, "restore_eval_env_runners": 1.0425081453061792e-05, "evaluation_iteration": 0.17476584894178682, "synch_eval_env_connectors": 0.0001857317518250987, "synch_env_connectors": 5.387300729692824e-06}, "env_runners": {"sample": 0.004902008775904772, "rlmodule_inference_timer": 2.7278063548905293e-05, "num_episodes": 250.0, "num_episodes_lifetime": -339125.0, "module_episode_returns_mean": {"default_policy": 7.46}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.486519017419147e-06, "add_observations_from_episodes_to_batch": 2.9332264240987516e-06, "add_time_dim_to_batch_and_zero_pad": 2.4035344202937085e-06, "add_states_from_episodes_to_batch": 1.7541173248373908e-06, "batch_individual_items": 6.253337704235574e-06}}, "connector_pipeline_timer": 4.344184810261159e-05}, "agent_episode_returns_mean": {"default_agent": 7.46}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_step_timer": 1.3480232391880617e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.371708482331969e-06, "tensor_to_numpy": 1.3120033355414215e-05, "get_actions": 3.9143810032953515e-05, "remove_single_ts_time_rank_from_batch": 5.931031747154087e-07, "listify_data_for_vector_env": 1.0850016875407855e-05, "un_batch_to_individual_items": 5.412198912330095e-06}}, "connector_pipeline_timer": 0.00010394916416987056}, "env_reset_timer": 3.5860098226872415e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 12.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0016533241378798378, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_mean": 7.46, "num_env_steps_sampled_lifetime": -6782500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004523017451167108, "num_env_steps_sampled_lifetime_throughput": 3748.910275503972}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008620555640487445, "add_observations_from_episodes_to_batch": 0.0011308741201641163, "batch_individual_items": 0.04120811511155604, "add_columns_from_episodes_to_train_batch": 0.044426840964052215, "add_one_ts_to_episodes_and_truncate": 0.016095932316624678, "add_time_dim_to_batch_and_zero_pad": 1.3755938665113596e-05, "add_states_from_episodes_to_batch": 3.98696608505157e-06, "numpy_to_tensor": 8.838464112964498e-05}}, "connector_pipeline_timer": 0.11192288958775187}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained_lifetime_throughput": 1535835.1961682632, "num_module_steps_trained_throughput": 293379.1282216157, "num_module_steps_trained_lifetime_throughput": 292966.9774879421}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0001085606127162464, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 78000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 9.112503903452307e-05, "gradients_default_optimizer_global_norm": 0.12169253826141357, "vf_loss_unclipped": 30.071489334106445, "weights_seq_no": 13.0, "vf_explained_var": -0.012235283851623535, "policy_loss": -0.14317864179611206, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": -0.08020195364952087, "entropy": 0.6363987922668457, "num_module_steps_trained_lifetime_throughput": 294132.59489595745}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00017080088843065923, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.466893000695228e-06, "get_actions": 4.06671403484421e-05, "remove_single_ts_time_rank_from_batch": 5.765966700981352e-07, "tensor_to_numpy": 1.3472893580168602e-05, "un_batch_to_individual_items": 5.443234851955777e-06, "listify_data_for_vector_env": 1.0971560898920641e-05}}, "connector_pipeline_timer": 0.00010626483804013537}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16295212974490791, "rlmodule_inference_timer": 2.8596136620136233e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 13.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5691186822875185e-06, "add_time_dim_to_batch_and_zero_pad": 2.2951310714002426e-06, "numpy_to_tensor": 8.915921216671935e-06, "batch_individual_items": 6.326171604044461e-06, "add_observations_from_episodes_to_batch": 2.8494696022703196e-06}}, "connector_pipeline_timer": 4.458432145683941e-05}, "agent_episode_returns_mean": {"default_agent": 2.25}, "episode_return_mean": 2.25, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004795701269758865, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.4363305909307354e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "module_episode_returns_mean": {"default_policy": 2.25}, "num_env_steps_sampled_lifetime": 65400, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes_lifetime": 260, "time_between_sampling": 2.5719253425921687}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-49", "timestamp": 1754933749, "time_this_iter_s": 1.6602039337158203, "time_total_s": 30.60126495361328, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.60126495361328, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.0, "ram_util_percent": 74.7}}
{"timers": {"training_iteration": 2.489121066192714, "restore_env_runners": 1.8114266730166972e-05, "training_step": 2.4888976823686773, "env_runner_sampling_timer": 2.3326478618063224, "learner_update_timer": 0.15058101454092232, "synch_weights": 0.0019505404260008435, "restore_eval_env_runners": 1.0398330646577801e-05, "evaluation_iteration": 0.17410800170293636, "synch_eval_env_connectors": 0.0001851560936585095, "synch_env_connectors": 5.3684279889031646e-06}, "env_runners": {"sample": 0.005053317601971814, "rlmodule_inference_timer": 3.0164823668169214e-05, "num_episodes": 250.0, "num_episodes_lifetime": -370000.0, "module_episode_returns_mean": {"default_policy": 7.54}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.18918597139832e-06, "add_observations_from_episodes_to_batch": 3.0363113150979544e-06, "add_time_dim_to_batch_and_zero_pad": 2.5010446968834234e-06, "add_states_from_episodes_to_batch": 1.7775098901165187e-06, "batch_individual_items": 6.58857626071821e-06}}, "connector_pipeline_timer": 4.539129011840644e-05}, "agent_episode_returns_mean": {"default_agent": 7.54}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_step_timer": 1.4363273395200712e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.889899321723004e-06, "tensor_to_numpy": 1.4034100495697982e-05, "get_actions": 4.414075449715235e-05, "remove_single_ts_time_rank_from_batch": 6.029571228945778e-07, "listify_data_for_vector_env": 1.1428101401350734e-05, "un_batch_to_individual_items": 5.606814475024778e-06}}, "connector_pipeline_timer": 0.00011242337215570169}, "env_reset_timer": 3.696437995605928e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 13.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0017248986481352062, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_mean": 7.54, "num_env_steps_sampled_lifetime": -7400000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004850099347997456, "num_env_steps_sampled_lifetime_throughput": 3528.2705481330095}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008588860084710059, "add_observations_from_episodes_to_batch": 0.0011276720390603126, "batch_individual_items": 0.04205335438055853, "add_columns_from_episodes_to_train_batch": 0.044340129634399296, "add_one_ts_to_episodes_and_truncate": 0.016011862993367758, "add_time_dim_to_batch_and_zero_pad": 1.3733378989975979e-05, "add_states_from_episodes_to_batch": 3.977937171259445e-06, "numpy_to_tensor": 8.831121532463386e-05}}, "connector_pipeline_timer": 0.11256008652124579}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained_lifetime_throughput": 1553876.5434633119, "num_module_steps_trained_throughput": 296783.7267627813, "num_module_steps_trained_lifetime_throughput": 296383.6408746104}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0007894618902355433, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 84000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 4.5562519517261535e-05, "gradients_default_optimizer_global_norm": 0.08184441179037094, "vf_loss_unclipped": 29.760150909423828, "weights_seq_no": 14.0, "vf_explained_var": -0.015738248825073242, "policy_loss": 0.05362187325954437, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.11680866777896881, "entropy": 0.6132097840309143, "num_module_steps_trained_lifetime_throughput": 297465.45131493337}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0001698907994753802, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.143966626689741e-06, "get_actions": 3.744241812424296e-05, "remove_single_ts_time_rank_from_batch": 5.736570797497726e-07, "tensor_to_numpy": 1.272530740564171e-05, "un_batch_to_individual_items": 5.25289986932578e-06, "listify_data_for_vector_env": 1.060378441529602e-05}}, "connector_pipeline_timer": 0.00010072466711078495}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16230896760761948, "rlmodule_inference_timer": 2.6747477729911182e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 14.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5575755091633703e-06, "add_time_dim_to_batch_and_zero_pad": 2.293690019348653e-06, "numpy_to_tensor": 8.148335612525163e-06, "batch_individual_items": 6.0008136457462475e-06, "add_observations_from_episodes_to_batch": 2.7432594741733116e-06}}, "connector_pipeline_timer": 4.189535186921484e-05}, "agent_episode_returns_mean": {"default_agent": 2.05}, "episode_return_mean": 2.05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004553478751331568, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.3500116768890016e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "module_episode_returns_mean": {"default_policy": 2.05}, "num_env_steps_sampled_lifetime": 70400, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes_lifetime": 280, "time_between_sampling": 2.562979577915997}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-51", "timestamp": 1754933751, "time_this_iter_s": 1.766540765762329, "time_total_s": 32.36780571937561, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.36780571937561, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.76666666666667, "ram_util_percent": 74.56666666666666}}
{"timers": {"training_iteration": 2.4815208401103814, "restore_env_runners": 1.7991874219178484e-05, "training_step": 2.4812981151253983, "env_runner_sampling_timer": 2.323456182347624, "learner_update_timer": 0.15219877772574408, "synch_weights": 0.0019374600217695198, "restore_eval_env_runners": 1.0354766892140203e-05, "evaluation_iteration": 0.1734005596053702, "synch_eval_env_connectors": 0.00018427328165835405, "synch_env_connectors": 5.3534937130374465e-06}, "env_runners": {"sample": 0.0050669818426664825, "rlmodule_inference_timer": 2.8401117624313638e-05, "num_episodes": 250.0, "num_episodes_lifetime": -400875.0, "module_episode_returns_mean": {"default_policy": 7.46}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.795860606356994e-06, "add_observations_from_episodes_to_batch": 3.0979011335387886e-06, "add_time_dim_to_batch_and_zero_pad": 2.433198548612912e-06, "add_states_from_episodes_to_batch": 1.747107881360921e-06, "batch_individual_items": 6.3743715726605655e-06}}, "connector_pipeline_timer": 4.443091789022815e-05}, "agent_episode_returns_mean": {"default_agent": 7.46}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_step_timer": 1.3953324698788663e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.583574957286011e-06, "tensor_to_numpy": 1.3599686062210043e-05, "get_actions": 4.134586568141224e-05, "remove_single_ts_time_rank_from_batch": 6.020027203825103e-07, "listify_data_for_vector_env": 1.1207261177872184e-05, "un_batch_to_individual_items": 5.519241510958669e-06}}, "connector_pipeline_timer": 0.00010790278011979329}, "env_reset_timer": 3.7253813527255155e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 14.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0018855596007650262, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_mean": 7.46, "num_env_steps_sampled_lifetime": -8017500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0046726879808120445, "num_env_steps_sampled_lifetime_throughput": 3639.9138174874975}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008555574823872186, "add_observations_from_episodes_to_batch": 0.001125029068927723, "batch_individual_items": 0.04347859166657581, "add_columns_from_episodes_to_train_batch": 0.044890408338593306, "add_one_ts_to_episodes_and_truncate": 0.0159297956143277, "add_time_dim_to_batch_and_zero_pad": 1.3759794991757986e-05, "add_states_from_episodes_to_batch": 4.034827918638719e-06, "numpy_to_tensor": 8.817601340646466e-05}}, "connector_pipeline_timer": 0.11441553107678057}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained_lifetime_throughput": 1574395.8961799897, "num_module_steps_trained_throughput": 300662.18685400457, "num_module_steps_trained_lifetime_throughput": 300273.24552255316}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0018565247301012278, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 90000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 2.2781259758630767e-05, "gradients_default_optimizer_global_norm": 0.04784759134054184, "vf_loss_unclipped": 29.84295654296875, "weights_seq_no": 15.0, "vf_explained_var": -0.01546335220336914, "policy_loss": -0.051738157868385315, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.01164228841662407, "entropy": 0.5918295383453369, "num_module_steps_trained_lifetime_throughput": 301275.9613703343}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00016939064100423627, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4284876528735703e-05, "get_actions": 7.179698221022772e-05, "remove_single_ts_time_rank_from_batch": 1.0715701680404378e-06, "tensor_to_numpy": 2.329564567193239e-05, "un_batch_to_individual_items": 8.070711026541786e-06, "listify_data_for_vector_env": 1.605754060568345e-05}}, "connector_pipeline_timer": 0.00019190624592836666}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16237295960076772, "rlmodule_inference_timer": 4.9826688481509346e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 15.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8470346311046713e-06, "add_time_dim_to_batch_and_zero_pad": 3.711200760884805e-06, "numpy_to_tensor": 1.3548149635810253e-05, "batch_individual_items": 9.173898627457586e-06, "add_observations_from_episodes_to_batch": 4.154428627809587e-06}}, "connector_pipeline_timer": 6.12080037477709e-05}, "agent_episode_returns_mean": {"default_agent": 2.45}, "episode_return_mean": 2.45, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0052058391727041456, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 2.6448593180810638e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "module_episode_returns_mean": {"default_policy": 2.45}, "num_env_steps_sampled_lifetime": 75400, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes_lifetime": 300, "time_between_sampling": 2.554811792556532}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-53", "timestamp": 1754933753, "time_this_iter_s": 1.9079632759094238, "time_total_s": 34.275768995285034, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.275768995285034, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.15, "ram_util_percent": 74.8}}
{"timers": {"training_iteration": 2.47211555670839, "restore_env_runners": 1.7890285526277955e-05, "training_step": 2.4718929485637062, "env_runner_sampling_timer": 2.3146847192741316, "learner_update_timer": 0.15159163369913856, "synch_weights": 0.0019236991720971326, "restore_eval_env_runners": 1.031330002188945e-05, "evaluation_iteration": 0.17343253733986802, "synch_eval_env_connectors": 0.0001833967983412405, "synch_env_connectors": 5.3403793397986016e-06}, "env_runners": {"sample": 0.005059047403050413, "rlmodule_inference_timer": 2.9535467419729178e-05, "num_episodes": 250.0, "num_episodes_lifetime": -431750.0, "module_episode_returns_mean": {"default_policy": 8.1}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.152356079471916e-06, "add_observations_from_episodes_to_batch": 3.078668217468329e-06, "add_time_dim_to_batch_and_zero_pad": 2.4921460903143686e-06, "add_states_from_episodes_to_batch": 1.8021848831227444e-06, "batch_individual_items": 6.470695874537646e-06}}, "connector_pipeline_timer": 4.5271653166827266e-05}, "agent_episode_returns_mean": {"default_agent": 8.1}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_step_timer": 1.4323700246841442e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.742867372751083e-06, "tensor_to_numpy": 1.4003937585882631e-05, "get_actions": 4.2885209279749163e-05, "remove_single_ts_time_rank_from_batch": 6.05693809915339e-07, "listify_data_for_vector_env": 1.1290532394602395e-05, "un_batch_to_individual_items": 5.548382502485543e-06}}, "connector_pipeline_timer": 0.00011041641317828658}, "env_reset_timer": 3.7234147036087085e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 15.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0026486182021966042, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_mean": 8.1, "num_env_steps_sampled_lifetime": -8635000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004786911884322762, "num_env_steps_sampled_lifetime_throughput": 3606.5412142528858}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008522130325749023, "add_observations_from_episodes_to_batch": 0.0011217029491702468, "batch_individual_items": 0.04335416074987511, "add_columns_from_episodes_to_train_batch": 0.04478010342483421, "add_one_ts_to_episodes_and_truncate": 0.01584802098771247, "add_time_dim_to_batch_and_zero_pad": 1.3707197689072343e-05, "add_states_from_episodes_to_batch": 4.0228104721721354e-06, "numpy_to_tensor": 8.793550378961933e-05}}, "connector_pipeline_timer": 0.11405948367620626}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained_lifetime_throughput": 1600127.2693943158, "num_module_steps_trained_throughput": 305536.8328831252, "num_module_steps_trained_lifetime_throughput": 305157.750980452}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.000879815430380404, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 96000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 1.1390629879315384e-05, "gradients_default_optimizer_global_norm": 0.027136243879795074, "vf_loss_unclipped": 29.875362396240234, "weights_seq_no": 16.0, "vf_explained_var": -0.015216827392578125, "policy_loss": -0.028655797243118286, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.03488733619451523, "entropy": 0.5738593339920044, "num_module_steps_trained_lifetime_throughput": 306085.8293350857}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00016838965488785287, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.352208480625973e-06, "get_actions": 3.8159893125944605e-05, "remove_single_ts_time_rank_from_batch": 5.682093721983853e-07, "tensor_to_numpy": 1.2961717493312881e-05, "un_batch_to_individual_items": 5.307365534875615e-06, "listify_data_for_vector_env": 1.0737292408500952e-05}}, "connector_pipeline_timer": 0.00010267324347021596}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16172093083444664, "rlmodule_inference_timer": 2.7517924107259686e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 16.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5493236621889625e-06, "add_time_dim_to_batch_and_zero_pad": 2.248138420867134e-06, "numpy_to_tensor": 8.218669800981062e-06, "batch_individual_items": 6.0415516195164926e-06, "add_observations_from_episodes_to_batch": 2.793403809587201e-06}}, "connector_pipeline_timer": 4.2162992042220385e-05}, "agent_episode_returns_mean": {"default_agent": 1.25}, "episode_return_mean": 1.25, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0052073908422607925, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.3747256431414259e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "module_episode_returns_mean": {"default_policy": 1.25}, "num_env_steps_sampled_lifetime": 80400, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes_lifetime": 320, "time_between_sampling": 2.5449363100507263}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-54", "timestamp": 1754933754, "time_this_iter_s": 1.645341157913208, "time_total_s": 35.92111015319824, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.92111015319824, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 48.333333333333336, "ram_util_percent": 76.56666666666668}}
{"timers": {"training_iteration": 2.462807346551077, "restore_env_runners": 1.7766383089812313e-05, "training_step": 2.4625854461584678, "env_runner_sampling_timer": 2.3060260041709992, "learner_update_timer": 0.15096865486217698, "synch_weights": 0.0019102509299256992, "restore_eval_env_runners": 1.0272246656187987e-05, "evaluation_iteration": 0.17271823696621266, "synch_eval_env_connectors": 0.00018295366981906528, "synch_env_connectors": 5.323224949311086e-06}, "env_runners": {"sample": 0.005152858559539101, "rlmodule_inference_timer": 4.3010937619482126e-05, "num_episodes": 250.0, "num_episodes_lifetime": -462625.0, "module_episode_returns_mean": {"default_policy": 7.940000000000001}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.504551036383239e-06, "add_observations_from_episodes_to_batch": 3.035303042410234e-06, "add_time_dim_to_batch_and_zero_pad": 2.411460736399221e-06, "add_states_from_episodes_to_batch": 1.7429997026895245e-06, "batch_individual_items": 6.237377055105582e-06}}, "connector_pipeline_timer": 4.360027832638661e-05}, "agent_episode_returns_mean": {"default_agent": 7.940000000000001}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_step_timer": 1.346642950381485e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.379346017329999e-06, "tensor_to_numpy": 1.3132202678147181e-05, "get_actions": 3.9009041607096185e-05, "remove_single_ts_time_rank_from_batch": 5.93493193549392e-07, "listify_data_for_vector_env": 1.0831708056500186e-05, "un_batch_to_individual_items": 5.4239012440616646e-06}}, "connector_pipeline_timer": 0.00010382784084903902}, "env_reset_timer": 3.2754686471918696e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 16.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0015627886806392462, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_mean": 7.940000000000001, "num_env_steps_sampled_lifetime": -9252500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004869100833777339, "num_env_steps_sampled_lifetime_throughput": 3740.712276108024}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008489076942421602, "add_observations_from_episodes_to_batch": 0.001120560089519208, "batch_individual_items": 0.04321698456201191, "add_columns_from_episodes_to_train_batch": 0.044668154890869956, "add_one_ts_to_episodes_and_truncate": 0.01576561452705907, "add_time_dim_to_batch_and_zero_pad": 1.3651375457744292e-05, "add_states_from_episodes_to_batch": 4.010922513395963e-06, "numpy_to_tensor": 8.75919886874878e-05}}, "connector_pipeline_timer": 0.1136908700890076}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained_lifetime_throughput": 1630669.3387212509, "num_module_steps_trained_throughput": 311331.18798576854, "num_module_steps_trained_lifetime_throughput": 310960.5598488187}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0022154797334223986, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 102000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 5.695314939657692e-06, "gradients_default_optimizer_global_norm": 0.2044783979654312, "vf_loss_unclipped": 29.69392204284668, "weights_seq_no": 17.0, "vf_explained_var": -0.017306208610534668, "policy_loss": 0.0521533340215683, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": 0.11605548858642578, "entropy": 0.5342195630073547, "num_module_steps_trained_lifetime_throughput": 311819.10563103517}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0001674149278832539, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.058973386225198e-06, "get_actions": 3.6910925618593665e-05, "remove_single_ts_time_rank_from_batch": 5.706703596146435e-07, "tensor_to_numpy": 1.2707715952537662e-05, "un_batch_to_individual_items": 5.221526996065738e-06, "listify_data_for_vector_env": 1.0575139707922276e-05}}, "connector_pipeline_timer": 0.0001000408004589357}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16106860860658345, "rlmodule_inference_timer": 2.6768376350979032e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 17.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5638086030457514e-06, "add_time_dim_to_batch_and_zero_pad": 2.259312163847256e-06, "numpy_to_tensor": 8.07221094119899e-06, "batch_individual_items": 5.907941338585572e-06, "add_observations_from_episodes_to_batch": 2.7895534405018463e-06}}, "connector_pipeline_timer": 4.175062378993798e-05}, "agent_episode_returns_mean": {"default_agent": 1.05}, "episode_return_mean": 1.05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005190581639762968, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.3455365973795872e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "module_episode_returns_mean": {"default_policy": 1.05}, "num_env_steps_sampled_lifetime": 85400, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes_lifetime": 340, "time_between_sampling": 2.5350655515305878}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-56", "timestamp": 1754933756, "time_this_iter_s": 1.6446058750152588, "time_total_s": 37.5657160282135, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.5657160282135, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.55, "ram_util_percent": 75.0}}
{"timers": {"training_iteration": 2.457211968495408, "restore_env_runners": 1.7639968776042062e-05, "training_step": 2.456990269607079, "env_runner_sampling_timer": 2.299289472038765, "learner_update_timer": 0.15212015373413915, "synch_weights": 0.0019022292605304673, "restore_eval_env_runners": 1.0223274307866821e-05, "evaluation_iteration": 0.17200116043694666, "synch_eval_env_connectors": 0.00018209954334201918, "synch_env_connectors": 5.308332921908458e-06}, "env_runners": {"sample": 0.005453955660453289, "rlmodule_inference_timer": 3.3411914642676595e-05, "num_episodes": 250.0, "num_episodes_lifetime": -493500.0, "module_episode_returns_mean": {"default_policy": 8.5}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0858113217627963e-05, "add_observations_from_episodes_to_batch": 3.329119408604208e-06, "add_time_dim_to_batch_and_zero_pad": 2.779952410093964e-06, "add_states_from_episodes_to_batch": 1.885454464715475e-06, "batch_individual_items": 7.54555380365239e-06}}, "connector_pipeline_timer": 5.191024809664451e-05}, "agent_episode_returns_mean": {"default_agent": 8.5}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_step_timer": 1.6051137330024766e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0684202287586534e-05, "tensor_to_numpy": 1.537606865853478e-05, "get_actions": 5.021756708144489e-05, "remove_single_ts_time_rank_from_batch": 6.415783314910242e-07, "listify_data_for_vector_env": 1.2425718774369634e-05, "un_batch_to_individual_items": 5.978995147338134e-06}}, "connector_pipeline_timer": 0.00012410741950178897}, "env_reset_timer": 4.006770101962718e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 17.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.0014930047986927582, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_mean": 8.5, "num_env_steps_sampled_lifetime": -9870000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0054487833138555306, "num_env_steps_sampled_lifetime_throughput": 3390.5290957392203}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.00847593950282763, "add_observations_from_episodes_to_batch": 0.0011173986488280242, "batch_individual_items": 0.044754084296832385, "add_columns_from_episodes_to_train_batch": 0.044565882922536555, "add_one_ts_to_episodes_and_truncate": 0.015685599631888467, "add_time_dim_to_batch_and_zero_pad": 1.3597361749285943e-05, "add_states_from_episodes_to_batch": 3.997892656272167e-06, "numpy_to_tensor": 8.742397873111034e-05}}, "connector_pipeline_timer": 0.11502686179760181}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 1652924.5483459404, "num_module_steps_trained_throughput": 315546.7105725801, "num_module_steps_trained_lifetime_throughput": 315185.12232997856}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00045499237603507936, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 108000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 2.847657469828846e-06, "gradients_default_optimizer_global_norm": 0.031843796372413635, "vf_loss_unclipped": 29.967670440673828, "weights_seq_no": 18.0, "vf_explained_var": -0.013191699981689453, "policy_loss": -0.13860587775707245, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": -0.07469553500413895, "entropy": 0.5333104133605957, "num_module_steps_trained_lifetime_throughput": 315979.62985397753}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.000166544528612766, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.1513955156675705e-05, "get_actions": 5.1468954846839626e-05, "remove_single_ts_time_rank_from_batch": 8.515879780242266e-07, "tensor_to_numpy": 1.8477488264979164e-05, "un_batch_to_individual_items": 6.180751352366991e-06, "listify_data_for_vector_env": 1.4685566169418633e-05}}, "connector_pipeline_timer": 0.00013379335039412444}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16079702669026447, "rlmodule_inference_timer": 3.58883908473247e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 18.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.76672921364657e-06, "add_time_dim_to_batch_and_zero_pad": 2.6936679795815768e-06, "numpy_to_tensor": 1.1440626451390637e-05, "batch_individual_items": 8.492457703748933e-06, "add_observations_from_episodes_to_batch": 3.45833611454965e-06}}, "connector_pipeline_timer": 5.27759663063035e-05}, "agent_episode_returns_mean": {"default_agent": 0.45}, "episode_return_mean": 0.45, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005471089570783079, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 1.8025439967385086e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "module_episode_returns_mean": {"default_policy": 0.45}, "num_env_steps_sampled_lifetime": 90400, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes_lifetime": 360, "time_between_sampling": 2.5289190085150013}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "465d2_00000", "date": "2025-08-11_19-35-58", "timestamp": 1754933758, "time_this_iter_s": 2.0463578701019287, "time_total_s": 39.61207389831543, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.61207389831543, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.73333333333333, "ram_util_percent": 77.33333333333333}}
{"timers": {"training_iteration": 2.451233064230132, "restore_env_runners": 1.7522729026527652e-05, "training_step": 2.4510115023311463, "env_runner_sampling_timer": 2.2923579102380125, "learner_update_timer": 0.15309616969714726, "synch_weights": 0.0018894428081898706, "restore_eval_env_runners": 1.0193131752829482e-05, "evaluation_iteration": 0.17168044841178404, "synch_eval_env_connectors": 0.00018288688790933273, "synch_env_connectors": 5.2989996347851535e-06}, "env_runners": {"sample": 0.0058776940803136075, "rlmodule_inference_timer": 3.39892495294867e-05, "num_episodes": 250.0, "num_episodes_lifetime": -524375.0, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0131482498097776e-05, "add_observations_from_episodes_to_batch": 3.4147952164510183e-06, "add_time_dim_to_batch_and_zero_pad": 2.7689476186988014e-06, "add_states_from_episodes_to_batch": 1.8945941590826201e-06, "batch_individual_items": 7.218346005437612e-06}}, "connector_pipeline_timer": 4.919130362732394e-05}, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_step_timer": 1.5966454497382698e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0669918803168667e-05, "tensor_to_numpy": 1.548819274862769e-05, "get_actions": 4.914005620670056e-05, "remove_single_ts_time_rank_from_batch": 6.664271711028349e-07, "listify_data_for_vector_env": 1.2458230140889073e-05, "un_batch_to_individual_items": 6.150956285030783e-06}}, "connector_pipeline_timer": 0.00012321157102884763}, "env_reset_timer": 4.9384391935592535e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 18.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.002378087086809429, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_mean": 8.980000000000004, "num_env_steps_sampled_lifetime": -10487500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005325555209070442, "num_env_steps_sampled_lifetime_throughput": 3239.5807020953957}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008446454688171852, "add_observations_from_episodes_to_batch": 0.0011247900726222067, "batch_individual_items": 0.04563113095428539, "add_columns_from_episodes_to_train_batch": 0.044987761593182296, "add_one_ts_to_episodes_and_truncate": 0.015615194055191125, "add_time_dim_to_batch_and_zero_pad": 1.3670968307371678e-05, "add_states_from_episodes_to_batch": 4.029163399127184e-06, "numpy_to_tensor": 8.730931981488952e-05}}, "connector_pipeline_timer": 0.11623191984984778}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained_lifetime_throughput": 1675646.0574287947, "num_module_steps_trained_throughput": 319851.86494993715, "num_module_steps_trained_lifetime_throughput": 319498.91117145296}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0012530607637017965, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 114000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 1.423828734914423e-06, "gradients_default_optimizer_global_norm": 0.018438857048749924, "vf_loss_unclipped": 29.897029876708984, "weights_seq_no": 19.0, "vf_explained_var": -0.013711333274841309, "policy_loss": -0.08715296536684036, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": -0.02297934889793396, "entropy": 0.5042437314987183, "num_module_steps_trained_lifetime_throughput": 320231.06430189684}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00016571908273789346, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2993916187296135e-05, "get_actions": 6.592303770856247e-05, "remove_single_ts_time_rank_from_batch": 8.826393702504232e-07, "tensor_to_numpy": 2.0058672176377496e-05, "un_batch_to_individual_items": 8.21714455635977e-06, "listify_data_for_vector_env": 1.5475451074760365e-05}}, "connector_pipeline_timer": 0.00016156906323839485}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16055870933328703, "rlmodule_inference_timer": 4.559945898756652e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 19.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0970026529061096e-06, "add_time_dim_to_batch_and_zero_pad": 3.131589365677024e-06, "numpy_to_tensor": 1.3734052350701112e-05, "batch_individual_items": 1.0105709584442208e-05, "add_observations_from_episodes_to_batch": 4.13956295202998e-06}}, "connector_pipeline_timer": 6.212507517290044e-05}, "agent_episode_returns_mean": {"default_agent": 0.65}, "episode_return_mean": 0.65, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005810957511421293, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 2.1747912166370808e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "module_episode_returns_mean": {"default_policy": 0.65}, "num_env_steps_sampled_lifetime": 95400, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes_lifetime": 380, "time_between_sampling": 2.5224824334300657}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "465d2_00000", "date": "2025-08-11_19-36-00", "timestamp": 1754933760, "time_this_iter_s": 2.0045950412750244, "time_total_s": 41.616668939590454, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.616668939590454, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 48.13333333333333, "ram_util_percent": 76.76666666666667}}
{"timers": {"training_iteration": 2.44368607191715, "restore_env_runners": 1.742334166181975e-05, "training_step": 2.443464541478497, "env_runner_sampling_timer": 2.285407451555872, "learner_update_timer": 0.15252332591968415, "synch_weights": 0.0018762821304028658, "restore_eval_env_runners": 1.0156200930243258e-05, "evaluation_iteration": 0.17139111600777024, "synch_eval_env_connectors": 0.00018209301876216753, "synch_env_connectors": 5.286429038175613e-06}, "env_runners": {"sample": 0.005582517779889894, "rlmodule_inference_timer": 3.2858188681529943e-05, "num_episodes": 250.0, "num_episodes_lifetime": -555250.0, "module_episode_returns_mean": {"default_policy": 8.580000000000002}, "episode_return_min": -9.5, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.952899728215077e-06, "add_observations_from_episodes_to_batch": 3.3273753480643157e-06, "add_time_dim_to_batch_and_zero_pad": 2.6974622180838516e-06, "add_states_from_episodes_to_batch": 1.8959561937831878e-06, "batch_individual_items": 7.144715937044017e-06}}, "connector_pipeline_timer": 4.8681050668630516e-05}, "agent_episode_returns_mean": {"default_agent": 8.580000000000002}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_step_timer": 1.5767664295942547e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0615974651896106e-05, "tensor_to_numpy": 1.5228148199263949e-05, "get_actions": 4.873341149749567e-05, "remove_single_ts_time_rank_from_batch": 6.693637038522689e-07, "listify_data_for_vector_env": 1.2362463693473456e-05, "un_batch_to_individual_items": 6.0456496319269364e-06}}, "connector_pipeline_timer": 0.00012214598719961908}, "env_reset_timer": 4.468881862151594e-05, "episode_return_max": 10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "weights_seq_no": 19.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 0.002351281219603533, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_mean": 8.580000000000002, "num_env_steps_sampled_lifetime": -11105000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005276280165184292, "num_env_steps_sampled_lifetime_throughput": 3307.231299938385}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.008418005970612994, "add_observations_from_episodes_to_batch": 0.0011220659224805572, "batch_individual_items": 0.0454833646448952, "add_columns_from_episodes_to_train_batch": 0.04489868563724058, "add_one_ts_to_episodes_and_truncate": 0.015536882113633237, "add_time_dim_to_batch_and_zero_pad": 1.364341894326864e-05, "add_states_from_episodes_to_batch": 4.023041990398554e-06, "numpy_to_tensor": 8.708122687147598e-05}}, "connector_pipeline_timer": 0.11588318898140582}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained_lifetime_throughput": 1699123.73348234, "num_module_steps_trained_throughput": 324300.52673147176, "num_module_steps_trained_lifetime_throughput": 323956.95405078336}, "default_policy": {"curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 4.868659016210586e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 120000, "vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "curr_kl_coeff": 7.119143674572115e-07, "gradients_default_optimizer_global_norm": 0.11064177006483078, "vf_loss_unclipped": 29.854867935180664, "weights_seq_no": 20.0, "vf_explained_var": -0.015539288520812988, "policy_loss": -0.07692054659128189, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 6003, "total_loss": -0.012637391686439514, "entropy": 0.4921499788761139, "num_module_steps_trained_lifetime_throughput": 324628.22657435614}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00016476481228031844, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.617740128267624e-05, "get_actions": 0.00014856847035514865, "remove_single_ts_time_rank_from_batch": 1.3475268216043777e-06, "tensor_to_numpy": 2.2982510153686508e-05, "un_batch_to_individual_items": 8.39760760852206e-06, "listify_data_for_vector_env": 2.013611294863599e-05}}, "connector_pipeline_timer": 0.0002700120089235616}, "episode_return_max": 14.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.16122184849057658, "rlmodule_inference_timer": 5.1583111467888926e-05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 20.0, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 6.564518587575403e-06, "add_time_dim_to_batch_and_zero_pad": 4.41224608262847e-06, "numpy_to_tensor": 5.817023259510702e-05, "batch_individual_items": 1.0633718487163018e-05, "add_observations_from_episodes_to_batch": 5.920596806362382e-06}}, "connector_pipeline_timer": 0.00012277821145294357}, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_return_mean": 0.85, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0062814446084666995, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes": 20, "episode_return_min": -13.5, "env_step_timer": 2.9164577950623703e-05, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "module_episode_returns_mean": {"default_policy": 0.85}, "num_env_steps_sampled_lifetime": 100400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes_lifetime": 400, "time_between_sampling": 2.514417409515815}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "465d2_00000", "date": "2025-08-11_19-36-02", "timestamp": 1754933762, "time_this_iter_s": 1.9320898056030273, "time_total_s": 43.54875874519348, "pid": 27720, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152905b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.54875874519348, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 45.1, "ram_util_percent": 76.69999999999999}}
