{"timers": {"training_iteration": 1.5391386660048738, "restore_env_runners": 1.1708005331456661e-05, "training_step": 1.5390024170046672, "env_runner_sampling_timer": 1.4371471659978852, "learner_update_timer": 0.0986085410695523, "synch_weights": 0.0005937080131843686}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3183083869493535e-05, "normalize_and_clip_actions": 1.2616390829315253e-05, "listify_data_for_vector_env": 1.1251648672506254e-05, "remove_single_ts_time_rank_from_batch": 5.908691313688212e-07, "get_actions": 4.41404184180601e-05, "un_batch_to_individual_items": 5.517319947830848e-06}}, "connector_pipeline_timer": 0.00011342480575511712}, "sample": 0.005910119028869413, "module_episode_returns_mean": {"default_policy": -4.459999999999999}, "env_step_timer": 1.469312821260392e-05, "weights_seq_no": 0.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.458751828681962e-06, "add_time_dim_to_batch_and_zero_pad": 2.5202845477638486e-06, "add_states_from_episodes_to_batch": 1.7393812542127103e-06, "numpy_to_tensor": 8.958370448223623e-06, "add_observations_from_episodes_to_batch": 3.211777298802296e-06}}, "connector_pipeline_timer": 4.6366540617681125e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -4.459999999999999}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled_lifetime": 627500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0005101362910782404, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_mean": 20.0, "num_episodes_lifetime": 31375.0, "episode_duration_sec_mean": 0.00484523813566193, "episode_return_mean": -4.459999999999999, "env_reset_timer": 9.520545380385376e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 4.8543441208032666e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_env_steps_sampled_lifetime_throughput": 3542.456385763443}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 6000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007338667055591941, "add_time_dim_to_batch_and_zero_pad": 1.1165975593030453e-05, "add_states_from_episodes_to_batch": 2.9159709811210632e-06, "numpy_to_tensor": 5.7124998420476913e-05, "add_columns_from_episodes_to_train_batch": 0.033008750062435865, "general_advantage_estimation": 0.006321166991256177, "add_observations_from_episodes_to_batch": 0.0007704579038545489, "batch_individual_items": 0.029116583988070488}}, "connector_pipeline_timer": 0.07673116598743945}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 31500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2490479.846989529, "num_module_steps_trained_throughput": 477409.3630513461, "num_module_steps_trained_lifetime_throughput": 476289.1835829019}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 6000, "weights_seq_no": 1.0, "vf_loss_unclipped": 30.21761131286621, "num_module_steps_trained": 6000, "policy_loss": -0.02556947059929371, "vf_explained_var": -0.013725519180297852, "mean_kl_loss": 0.0003655994951259345, "curr_kl_coeff": 0.3732481598854065, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.01337447576224804, "module_train_batch_size_mean": 1000.0, "total_loss": 0.035620804876089096, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.1004081591963768, "entropy": 0.6885641813278198, "num_module_steps_trained_lifetime_throughput": 479030.9641625004}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"sample": 0.0985605000751093, "env_step_timer": 1.7058972946274916e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 4.6}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4296026855585957e-05, "remove_single_ts_time_rank_from_batch": 5.85689009847644e-07, "get_actions": 4.0967434812337166e-05, "normalize_and_clip_actions": 1.0548825316957249e-05, "un_batch_to_individual_items": 5.438841860013801e-06, "listify_data_for_vector_env": 1.0865933881784921e-05}}, "connector_pipeline_timer": 0.00010777556602353141}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.950196147407201e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.241202743737311e-06, "add_states_from_episodes_to_batch": 1.5701675275083952e-06, "numpy_to_tensor": 8.25138999871364e-06, "add_observations_from_episodes_to_batch": 2.8934043338136442e-06, "batch_individual_items": 6.244705079927835e-06}}, "connector_pipeline_timer": 4.3232398255739424e-05}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 4.6, "agent_episode_returns_mean": {"default_agent": 4.6}, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 5400, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "num_episodes_lifetime": 20, "env_reset_timer": 0.00024270801804959774, "episode_duration_sec_mean": 0.004511674994137138, "num_env_steps_sampled": 400, "episode_len_min": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "5034a_00000", "date": "2025-08-11_19-36-59", "timestamp": 1754933819, "time_this_iter_s": 1.6470370292663574, "time_total_s": 1.6470370292663574, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.6470370292663574, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.166666666666668, "ram_util_percent": 78.53333333333335}}
{"timers": {"training_iteration": 1.5396443376748357, "restore_env_runners": 1.1655505513772368e-05, "training_step": 1.539507247004658, "env_runner_sampling_timer": 1.4366642247582786, "learner_update_timer": 0.09959699440863914, "synch_weights": 0.0005945638532284648, "restore_eval_env_runners": 9.541050530970097e-06, "evaluation_iteration": 0.10624391597229987, "synch_eval_env_connectors": 0.00011866597924381495, "synch_env_connectors": 4.66697383671999e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3026705193225075e-05, "normalize_and_clip_actions": 9.524521599374995e-06, "listify_data_for_vector_env": 1.113887916730421e-05, "remove_single_ts_time_rank_from_batch": 5.73381534349203e-07, "get_actions": 3.794266235674024e-05, "un_batch_to_individual_items": 5.375816170002014e-06}}, "connector_pipeline_timer": 0.00010330710107313617}, "sample": 0.005098699487377126, "module_episode_returns_mean": {"default_policy": -5.5}, "env_step_timer": 1.3996478039333254e-05, "weights_seq_no": 1.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.291631187820746e-06, "add_time_dim_to_batch_and_zero_pad": 2.4057501259368487e-06, "add_states_from_episodes_to_batch": 1.734947534696976e-06, "numpy_to_tensor": 8.536876865349422e-06, "add_observations_from_episodes_to_batch": 2.953575080932687e-06}}, "connector_pipeline_timer": 4.349736083628024e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -5.5}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": 10000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0014381386698909065, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": 500.0, "episode_duration_sec_mean": 0.004535645044874401, "episode_return_mean": -5.5, "env_reset_timer": 3.6230845709873995e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.768873198289216e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 3780.7597390549886}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 12000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0073422487254720175, "add_time_dim_to_batch_and_zero_pad": 1.1218895670026541e-05, "add_states_from_episodes_to_batch": 2.925972221419215e-06, "numpy_to_tensor": 5.7537087704986335e-05, "add_columns_from_episodes_to_train_batch": 0.03302944256109185, "general_advantage_estimation": 0.0063128536508884284, "add_observations_from_episodes_to_batch": 0.0007718666642904282, "batch_individual_items": 0.03017483522882685}}, "connector_pipeline_timer": 0.07780758765758947}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 63000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2489331.6762210405, "num_module_steps_trained_throughput": 477155.3495657707, "num_module_steps_trained_lifetime_throughput": 476046.25663335976}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 12000, "weights_seq_no": 2.0, "vf_loss_unclipped": 30.189531326293945, "num_module_steps_trained": 6000, "policy_loss": -0.11839213222265244, "vf_explained_var": -0.013575196266174316, "mean_kl_loss": 0.0015927486820146441, "curr_kl_coeff": 0.18662407994270325, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.0885528028011322, "module_train_batch_size_mean": 1000.0, "total_loss": -0.05691200867295265, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10040832310914993, "entropy": 0.6920790672302246, "num_module_steps_trained_lifetime_throughput": 478743.3232653948}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09872324382420629, "env_step_timer": 1.6283478837163317e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.6}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5027817783318086e-05, "remove_single_ts_time_rank_from_batch": 6.429078846251804e-07, "get_actions": 4.279210184030307e-05, "normalize_and_clip_actions": 1.3740497387623017e-05, "un_batch_to_individual_items": 6.125857544096614e-06, "listify_data_for_vector_env": 1.2608537305833474e-05}}, "connector_pipeline_timer": 0.00011986334408435789}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.271094172115187e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.9701741707529196e-06, "add_states_from_episodes_to_batch": 1.711705506133823e-06, "numpy_to_tensor": 9.717579017462673e-06, "add_observations_from_episodes_to_batch": 3.0333948826576172e-06, "batch_individual_items": 6.841365568322223e-06}}, "connector_pipeline_timer": 4.7052629489679935e-05}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.6, "agent_episode_returns_mean": {"default_agent": 1.6}, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": 10400, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "num_episodes_lifetime": 40, "env_reset_timer": 0.00024110218742862344, "episode_duration_sec_mean": 0.004876009398140013, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6196631249040365}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-00", "timestamp": 1754933820, "time_this_iter_s": 1.7116928100585938, "time_total_s": 3.358729839324951, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.358729839324951, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.25, "ram_util_percent": 78.25}}
{"timers": {"training_iteration": 1.5393571038782015, "restore_env_runners": 1.1613120988477021e-05, "training_step": 1.5392194474445655, "env_runner_sampling_timer": 1.436473408341012, "learner_update_timer": 0.09950095780481351, "synch_weights": 0.0005948157147387974, "restore_eval_env_runners": 9.524389170110225e-06, "evaluation_iteration": 0.10638098848285153, "synch_eval_env_connectors": 0.00011853889911435545, "synch_env_connectors": 4.663633881136775e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3359054718353663e-05, "normalize_and_clip_actions": 9.812829449333489e-06, "listify_data_for_vector_env": 1.1413891260388782e-05, "remove_single_ts_time_rank_from_batch": 5.873175850875936e-07, "get_actions": 3.9503924441828654e-05, "un_batch_to_individual_items": 5.585510568399416e-06}}, "connector_pipeline_timer": 0.00010663468164395884}, "sample": 0.005039564862776401, "module_episode_returns_mean": {"default_policy": -3.100000000000002}, "env_step_timer": 1.4386991492809784e-05, "weights_seq_no": 2.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.4828853985519665e-06, "add_time_dim_to_batch_and_zero_pad": 2.472998148173729e-06, "add_states_from_episodes_to_batch": 1.7582177749774956e-06, "numpy_to_tensor": 8.867459823219882e-06, "add_observations_from_episodes_to_batch": 3.0590431659303565e-06}}, "connector_pipeline_timer": 4.474296431413877e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -3.100000000000002}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -607500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0020071554097063006, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -30375.0, "episode_duration_sec_mean": 0.004670372650027275, "episode_return_mean": -3.100000000000002, "env_reset_timer": 3.953251884066345e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.8362834663722785e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_env_steps_sampled_lifetime_throughput": 3622.1471482924703}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 18000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007346792077517602, "add_time_dim_to_batch_and_zero_pad": 1.1228796117939056e-05, "add_states_from_episodes_to_batch": 2.9238023445941507e-06, "numpy_to_tensor": 5.758171689230949e-05, "add_columns_from_episodes_to_train_batch": 0.03304384230495198, "general_advantage_estimation": 0.006301685954735149, "add_observations_from_episodes_to_batch": 0.0007724525882396847, "batch_individual_items": 0.03016365187598858}}, "connector_pipeline_timer": 0.07780454886176158}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 94500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2488465.5357896015, "num_module_steps_trained_throughput": 476930.1988061944, "num_module_steps_trained_lifetime_throughput": 475840.3272240821}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 18000, "weights_seq_no": 3.0, "vf_loss_unclipped": 28.8149471282959, "num_module_steps_trained": 6000, "policy_loss": -0.07973822951316833, "vf_explained_var": -0.012913346290588379, "mean_kl_loss": 0.004396282602101564, "curr_kl_coeff": 0.09331203997135162, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.024950962513685226, "module_train_batch_size_mean": 1000.0, "total_loss": -0.01838073693215847, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09986981749534607, "entropy": 0.6908020377159119, "num_module_steps_trained_lifetime_throughput": 478463.7896995016}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09873091346565634, "env_step_timer": 1.4144383736572233e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.6}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3209455171009055e-05, "remove_single_ts_time_rank_from_batch": 5.772479436317254e-07, "get_actions": 3.705641686337264e-05, "normalize_and_clip_actions": 9.489454520212453e-06, "un_batch_to_individual_items": 5.4758083549587775e-06, "listify_data_for_vector_env": 1.0980882769975984e-05}}, "connector_pipeline_timer": 0.00010184490607545899}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.7890452974690847e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2666791473608717e-06, "add_states_from_episodes_to_batch": 1.5899940087821376e-06, "numpy_to_tensor": 8.46386199808964e-06, "add_observations_from_episodes_to_batch": 2.8406500240404464e-06, "batch_individual_items": 6.149214123621136e-06}}, "connector_pipeline_timer": 4.2330433271462825e-05}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.6, "agent_episode_returns_mean": {"default_agent": 1.6}, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": 15400, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "num_episodes_lifetime": 60, "env_reset_timer": 0.0002395557460607961, "episode_duration_sec_mean": 0.004764696532705178, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.61877413199516}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-02", "timestamp": 1754933822, "time_this_iter_s": 1.6171042919158936, "time_total_s": 4.975834131240845, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.975834131240845, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.23333333333333, "ram_util_percent": 79.10000000000001}}
{"timers": {"training_iteration": 1.5410807315904946, "restore_env_runners": 1.156406945118215e-05, "training_step": 1.5409426567203326, "env_runner_sampling_timer": 1.438316813427796, "learner_update_timer": 0.0993834278163096, "synch_weights": 0.0005944583882881562, "restore_eval_env_runners": 9.513725666329263e-06, "evaluation_iteration": 0.10635866859823, "synch_eval_env_connectors": 0.00011842351012164726, "synch_env_connectors": 4.6703378786332905e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4436395829470674e-05, "normalize_and_clip_actions": 1.0492249822316214e-05, "listify_data_for_vector_env": 1.2438894102000972e-05, "remove_single_ts_time_rank_from_batch": 6.333767548233084e-07, "get_actions": 4.308196146973659e-05, "un_batch_to_individual_items": 5.904313355580052e-06}}, "connector_pipeline_timer": 0.00011499457120021644}, "sample": 0.005354660231850051, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "env_step_timer": 1.5731117747951738e-05, "weights_seq_no": 3.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.973212617182643e-06, "add_time_dim_to_batch_and_zero_pad": 2.6878575499299746e-06, "add_states_from_episodes_to_batch": 1.868379536225278e-06, "numpy_to_tensor": 9.607584584251938e-06, "add_observations_from_episodes_to_batch": 3.4010220082204496e-06}}, "connector_pipeline_timer": 4.7711978613866725e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -1225000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018504821603516736, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -61250.0, "episode_duration_sec_mean": 0.005032372822985054, "episode_return_mean": -1.9799999999999998, "env_reset_timer": 4.842038379837525e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 3.029463609335873e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_env_steps_sampled_lifetime_throughput": 3383.6988043382926}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 24000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007348387906424584, "add_time_dim_to_batch_and_zero_pad": 1.1212337757227943e-05, "add_states_from_episodes_to_batch": 2.9304039421258492e-06, "numpy_to_tensor": 5.764381959824823e-05, "add_columns_from_episodes_to_train_batch": 0.03304369304180389, "general_advantage_estimation": 0.006290202005626052, "add_observations_from_episodes_to_batch": 0.0007725201531215571, "batch_individual_items": 0.03015011493744026}}, "connector_pipeline_timer": 0.07778078837387428}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 126000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2488069.99644381, "num_module_steps_trained_throughput": 476777.1284146883, "num_module_steps_trained_lifetime_throughput": 475712.0659424395}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 24000, "weights_seq_no": 4.0, "vf_loss_unclipped": 29.42681121826172, "num_module_steps_trained": 6000, "policy_loss": 0.09290732443332672, "vf_explained_var": -0.01295316219329834, "mean_kl_loss": 0.005344749428331852, "curr_kl_coeff": 0.04665601998567581, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.022418634966015816, "module_train_batch_size_mean": 1000.0, "total_loss": 0.15422971546649933, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.1000857725739479, "entropy": 0.6751035451889038, "num_module_steps_trained_lifetime_throughput": 478237.64609703416}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09870219892119243, "env_step_timer": 1.3407243914059457e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.1}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.23747775387485e-05, "remove_single_ts_time_rank_from_batch": 5.729951296548947e-07, "get_actions": 3.448500432440092e-05, "normalize_and_clip_actions": 9.172890171377726e-06, "un_batch_to_individual_items": 5.292707229455681e-06, "listify_data_for_vector_env": 1.073603522866362e-05}}, "connector_pipeline_timer": 9.723674491397591e-05}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.6169571397601848e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.211207495221546e-06, "add_states_from_episodes_to_batch": 1.6075379072003614e-06, "numpy_to_tensor": 8.108987873991966e-06, "add_observations_from_episodes_to_batch": 2.7560171775057743e-06, "batch_individual_items": 6.027614274504661e-06}}, "connector_pipeline_timer": 4.142637066219443e-05}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.1, "agent_episode_returns_mean": {"default_agent": 1.1}, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": 20400, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "num_episodes_lifetime": 80, "env_reset_timer": 0.00023796435770369136, "episode_duration_sec_mean": 0.004673870824626647, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.619870062764897}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-04", "timestamp": 1754933824, "time_this_iter_s": 1.8143548965454102, "time_total_s": 6.790189027786255, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.790189027786255, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 46.7, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 1.543359116774555, "restore_env_runners": 1.1503018229381415e-05, "training_step": 1.5432199955729142, "env_runner_sampling_timer": 1.4405523598740633, "learner_update_timer": 0.09942190228800106, "synch_weights": 0.0005962321437348601, "restore_eval_env_runners": 9.519008266273884e-06, "evaluation_iteration": 0.10630104649177403, "synch_eval_env_connectors": 0.00011827719444863033, "synch_env_connectors": 4.664474158897064e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.438983777856671e-05, "normalize_and_clip_actions": 1.0303287598404841e-05, "listify_data_for_vector_env": 1.186931378985347e-05, "remove_single_ts_time_rank_from_batch": 6.341767070786908e-07, "get_actions": 4.31619458079339e-05, "un_batch_to_individual_items": 5.824827046284167e-06}}, "connector_pipeline_timer": 0.00011381249097730178}, "sample": 0.0052288689094946335, "module_episode_returns_mean": {"default_policy": -2.6200000000000006}, "env_step_timer": 1.634670980799219e-05, "weights_seq_no": 4.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.727136375215836e-06, "add_time_dim_to_batch_and_zero_pad": 2.5192384725014695e-06, "add_states_from_episodes_to_batch": 1.7931542769076856e-06, "numpy_to_tensor": 1.4755839326948926e-05, "add_observations_from_episodes_to_batch": 3.1115940939566026e-06}}, "connector_pipeline_timer": 5.166525463357729e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.6200000000000006}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -1842500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0015731025925816262, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -92125.0, "episode_duration_sec_mean": 0.00558278800128028, "episode_return_mean": -2.6200000000000006, "env_reset_timer": 4.093049903911955e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 5.4436927173929957e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_env_steps_sampled_lifetime_throughput": 3719.8677076043464}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 30000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0073516140270632096, "add_time_dim_to_batch_and_zero_pad": 1.1245634578915778e-05, "add_states_from_episodes_to_batch": 2.938189824238652e-06, "numpy_to_tensor": 5.891738151923986e-05, "add_columns_from_episodes_to_train_batch": 0.03308250195092391, "general_advantage_estimation": 0.006287356235646532, "add_observations_from_episodes_to_batch": 0.0007728074514834257, "batch_individual_items": 0.030189990868251193}}, "connector_pipeline_timer": 0.077861787991053}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 157500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2478820.832985103, "num_module_steps_trained_throughput": 474923.5233644055, "num_module_steps_trained_lifetime_throughput": 473888.8688394968}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 30000, "weights_seq_no": 5.0, "vf_loss_unclipped": 28.310836791992188, "num_module_steps_trained": 6000, "policy_loss": -0.08939778804779053, "vf_explained_var": -0.012333512306213379, "mean_kl_loss": 0.006403516978025436, "curr_kl_coeff": 0.023328009992837906, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.3873364329338074, "module_train_batch_size_mean": 1000.0, "total_loss": -0.028190553188323975, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09976178407669067, "entropy": 0.6418144702911377, "num_module_steps_trained_lifetime_throughput": 476301.97194087127}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09894402443215015, "env_step_timer": 1.630254805623154e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.8}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4688159636894235e-05, "remove_single_ts_time_rank_from_batch": 6.447854561451025e-07, "get_actions": 4.101331087462972e-05, "normalize_and_clip_actions": 1.0812332840650465e-05, "un_batch_to_individual_items": 5.969614170849243e-06, "listify_data_for_vector_env": 1.1842154197876382e-05}}, "connector_pipeline_timer": 0.00011289157112307067}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.292693670756699e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5740417588822944e-06, "add_states_from_episodes_to_batch": 1.8280651681108266e-06, "numpy_to_tensor": 9.284852747457931e-06, "add_observations_from_episodes_to_batch": 3.0782997119160345e-06, "batch_individual_items": 6.924311519281852e-06}}, "connector_pipeline_timer": 4.64490713187256e-05}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.8, "agent_episode_returns_mean": {"default_agent": 1.8}, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": 25400, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "num_episodes_lifetime": 100, "env_reset_timer": 0.0002366076334406366, "episode_duration_sec_mean": 0.0048629604082088915, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.621539117557987}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-06", "timestamp": 1754933826, "time_this_iter_s": 1.900162935256958, "time_total_s": 8.690351963043213, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.690351963043213, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.23333333333333, "ram_util_percent": 78.96666666666667}}
{"timers": {"training_iteration": 1.5464016693562401, "restore_env_runners": 1.1443408725196531e-05, "training_step": 1.5462621843672222, "env_runner_sampling_timer": 1.4427198175250966, "learner_update_timer": 0.1002964486751569, "synch_weights": 0.0005969260720497797, "restore_eval_env_runners": 9.499228536630978e-06, "evaluation_iteration": 0.10652509685736558, "synch_eval_env_connectors": 0.00011919359215519041, "synch_env_connectors": 4.665329196919919e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5308439576604845e-05, "normalize_and_clip_actions": 1.1409222145777288e-05, "listify_data_for_vector_env": 1.3047650100602436e-05, "remove_single_ts_time_rank_from_batch": 6.518176122778719e-07, "get_actions": 4.678722329516936e-05, "un_batch_to_individual_items": 6.132717959455277e-06}}, "connector_pipeline_timer": 0.0001225400490560736}, "sample": 0.006313991043644151, "module_episode_returns_mean": {"default_policy": 0.26}, "env_step_timer": 1.6889191420006108e-05, "weights_seq_no": 5.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.444894705468171e-06, "add_time_dim_to_batch_and_zero_pad": 2.811758245890213e-06, "add_states_from_episodes_to_batch": 1.9311604916073745e-06, "numpy_to_tensor": 1.0538824097116165e-05, "add_observations_from_episodes_to_batch": 3.419607013698755e-06}}, "connector_pipeline_timer": 5.574595114083381e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 0.26}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -2460000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0017701042913232188, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -123000.0, "episode_duration_sec_mean": 0.005463556169066577, "episode_return_mean": 0.26, "env_reset_timer": 5.5123225165615374e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 3.375059984352594e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_env_steps_sampled_lifetime_throughput": 3230.4441772955834}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 36000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007353922886741541, "add_time_dim_to_batch_and_zero_pad": 1.1253177982712605e-05, "add_states_from_episodes_to_batch": 2.9392272495896436e-06, "numpy_to_tensor": 5.923195730968823e-05, "add_columns_from_episodes_to_train_batch": 0.03309220901098653, "general_advantage_estimation": 0.006279269343078949, "add_observations_from_episodes_to_batch": 0.000772986877226307, "batch_individual_items": 0.031135080119413495}}, "connector_pipeline_timer": 0.07881133136091792}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 189000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2468236.45714782, "num_module_steps_trained_throughput": 472810.99197844486, "num_module_steps_trained_lifetime_throughput": 471808.4389905444}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 36000, "weights_seq_no": 6.0, "vf_loss_unclipped": 26.507795333862305, "num_module_steps_trained": 6000, "policy_loss": -0.07772266864776611, "vf_explained_var": -0.010851740837097168, "mean_kl_loss": 0.00032041617669165134, "curr_kl_coeff": 0.011664004996418953, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.12068164348602295, "module_train_batch_size_mean": 1000.0, "total_loss": -0.017150528728961945, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.0991143062710762, "entropy": 0.6319625973701477, "num_module_steps_trained_lifetime_throughput": 474100.7041034818}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09903008960885992, "env_step_timer": 1.5699043125788503e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.0}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3764379429591227e-05, "remove_single_ts_time_rank_from_batch": 5.805748492665918e-07, "get_actions": 4.018641024666412e-05, "normalize_and_clip_actions": 9.739115948647777e-06, "un_batch_to_individual_items": 5.6180687156133736e-06, "listify_data_for_vector_env": 1.1322101154610629e-05}}, "connector_pipeline_timer": 0.00010704727541707916}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.971550612322989e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3826764416631485e-06, "add_states_from_episodes_to_batch": 1.662759250948356e-06, "numpy_to_tensor": 9.158022546713634e-06, "add_observations_from_episodes_to_batch": 2.922941736395962e-06, "batch_individual_items": 6.676237031402886e-06}}, "connector_pipeline_timer": 4.467457068012934e-05}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.0, "agent_episode_returns_mean": {"default_agent": 1.0}, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": 30400, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "num_episodes_lifetime": 120, "env_reset_timer": 0.0002350273966173118, "episode_duration_sec_mean": 0.0049428862717468295, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.623986193463274}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-08", "timestamp": 1754933828, "time_this_iter_s": 1.9623668193817139, "time_total_s": 10.652718782424927, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.652718782424927, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.76666666666667, "ram_util_percent": 80.06666666666666}}
{"timers": {"training_iteration": 1.5455722876617703, "restore_env_runners": 1.1386474493701325e-05, "training_step": 1.5454321866935945, "env_runner_sampling_timer": 1.4419485485089858, "learner_update_timer": 0.10023994251738629, "synch_weights": 0.0005974418118148363, "restore_eval_env_runners": 9.47089682869599e-06, "evaluation_iteration": 0.10658600213903965, "synch_eval_env_connectors": 0.00011901915641438959, "synch_env_connectors": 4.659515564000826e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3412627314861757e-05, "normalize_and_clip_actions": 9.41233191997123e-06, "listify_data_for_vector_env": 1.105068535879893e-05, "remove_single_ts_time_rank_from_batch": 5.845325151405461e-07, "get_actions": 3.769154554397982e-05, "un_batch_to_individual_items": 5.384232436198647e-06}}, "connector_pipeline_timer": 0.00010295345290897786}, "sample": 0.005194602590835101, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "env_step_timer": 1.3908815427124723e-05, "weights_seq_no": 6.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.30218635116893e-06, "add_time_dim_to_batch_and_zero_pad": 2.6497329951316956e-06, "add_states_from_episodes_to_batch": 1.7602246546095907e-06, "numpy_to_tensor": 8.445781028584204e-06, "add_observations_from_episodes_to_batch": 3.082395331121007e-06}}, "connector_pipeline_timer": 4.369490186724903e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -3077500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001922738106697213, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -153875.0, "episode_duration_sec_mean": 0.0045217213174328225, "episode_return_mean": 0.17999999999999997, "env_reset_timer": 4.08335423141869e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.7204075185658517e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_env_steps_sampled_lifetime_throughput": 3784.786002820191}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 42000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00736553948789421, "add_time_dim_to_batch_and_zero_pad": 1.1268985946127146e-05, "add_states_from_episodes_to_batch": 2.9423346424881725e-06, "numpy_to_tensor": 5.951546745559836e-05, "add_columns_from_episodes_to_train_batch": 0.03310098734103092, "general_advantage_estimation": 0.006269711229621082, "add_observations_from_episodes_to_batch": 0.0007734107585495604, "batch_individual_items": 0.03113612181798288}}, "connector_pipeline_timer": 0.07882402345698049}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 220500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2456388.6309292275, "num_module_steps_trained_throughput": 470454.3642251994, "num_module_steps_trained_lifetime_throughput": 469485.5370436604}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 42000, "weights_seq_no": 7.0, "vf_loss_unclipped": 27.996871948242188, "num_module_steps_trained": 6000, "policy_loss": 0.11239685118198395, "vf_explained_var": -0.012020707130432129, "mean_kl_loss": 0.00022236791846808046, "curr_kl_coeff": 0.0058320024982094765, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.1225818544626236, "module_train_batch_size_mean": 1000.0, "total_loss": 0.1733374446630478, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09954539686441422, "entropy": 0.6225767731666565, "num_module_steps_trained_lifetime_throughput": 471655.8950398131}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.0990429537133553, "env_step_timer": 1.4409333074427162e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.6}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3006692803002159e-05, "remove_single_ts_time_rank_from_batch": 5.748908083591908e-07, "get_actions": 3.78134469497668e-05, "normalize_and_clip_actions": 9.378322186316543e-06, "un_batch_to_individual_items": 5.555049495380381e-06, "listify_data_for_vector_env": 1.0992718887708362e-05}}, "connector_pipeline_timer": 0.00010213900186960476}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.8089777357791823e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2372566986208163e-06, "add_states_from_episodes_to_batch": 1.5769845350991465e-06, "numpy_to_tensor": 8.59681730973259e-06, "add_observations_from_episodes_to_batch": 2.790185408270638e-06, "batch_individual_items": 6.257785098145234e-06}}, "connector_pipeline_timer": 4.270367056238099e-05}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.6, "agent_episode_returns_mean": {"default_agent": 1.6}, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": 35400, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "num_episodes_lifetime": 140, "env_reset_timer": 0.0002335517032337425, "episode_duration_sec_mean": 0.00481063334736973, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6225549969378599}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-09", "timestamp": 1754933829, "time_this_iter_s": 1.5708069801330566, "time_total_s": 12.223525762557983, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.223525762557983, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.7, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 1.5453832160355747, "restore_env_runners": 1.1335109642593536e-05, "training_step": 1.5452425527361704, "env_runner_sampling_timer": 1.441815144684435, "learner_update_timer": 0.10018065393237467, "synch_weights": 0.0005979344732076002, "restore_eval_env_runners": 9.447027747893938e-06, "evaluation_iteration": 0.10657186878835218, "synch_eval_env_connectors": 0.00011896230409698067, "synch_env_connectors": 4.665420226045111e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2634963411607747e-05, "normalize_and_clip_actions": 9.371327180365104e-06, "listify_data_for_vector_env": 1.089155809155859e-05, "remove_single_ts_time_rank_from_batch": 5.71513825781962e-07, "get_actions": 3.6939753874395215e-05, "un_batch_to_individual_items": 5.290554403156624e-06}}, "connector_pipeline_timer": 0.00010088302542080762}, "sample": 0.005032720564473705, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "env_step_timer": 1.3622406145450446e-05, "weights_seq_no": 7.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.1274032990650345e-06, "add_time_dim_to_batch_and_zero_pad": 2.340117042277626e-06, "add_states_from_episodes_to_batch": 1.6933281654016196e-06, "numpy_to_tensor": 8.279906793147545e-06, "add_observations_from_episodes_to_batch": 2.975586631407265e-06}}, "connector_pipeline_timer": 4.258304924209642e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -3695000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001519551818740085, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -184750.0, "episode_duration_sec_mean": 0.004778235300909726, "episode_return_mean": 1.0600000000000005, "env_reset_timer": 3.311251847312144e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 4.256505659612954e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_env_steps_sampled_lifetime_throughput": 3819.7254297150516}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 48000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007366389503172413, "add_time_dim_to_batch_and_zero_pad": 1.1320875919592267e-05, "add_states_from_episodes_to_batch": 2.94458092021309e-06, "numpy_to_tensor": 5.968489252605192e-05, "add_columns_from_episodes_to_train_batch": 0.033117852047804604, "general_advantage_estimation": 0.006260630777040643, "add_observations_from_episodes_to_batch": 0.0007757324807349278, "batch_individual_items": 0.0311327668496369}}, "connector_pipeline_timer": 0.0788318036422132}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 252000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2443481.6579294363, "num_module_steps_trained_throughput": 467896.404575687, "num_module_steps_trained_lifetime_throughput": 466961.3161888867}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 48000, "weights_seq_no": 8.0, "vf_loss_unclipped": 26.816692352294922, "num_module_steps_trained": 6000, "policy_loss": 0.03571588546037674, "vf_explained_var": -0.011062145233154297, "mean_kl_loss": 4.653878204408102e-05, "curr_kl_coeff": 0.0029160012491047382, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.04937148466706276, "module_train_batch_size_mean": 1000.0, "total_loss": 0.09643588215112686, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09922180324792862, "entropy": 0.6227813363075256, "num_module_steps_trained_lifetime_throughput": 469009.7949051651}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09926409709665965, "env_step_timer": 1.4874835450876139e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.4}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3303758956090897e-05, "remove_single_ts_time_rank_from_batch": 5.835532252901374e-07, "get_actions": 4.00096733172059e-05, "normalize_and_clip_actions": 9.497039437736286e-06, "un_batch_to_individual_items": 5.467393564268091e-06, "listify_data_for_vector_env": 1.1138105541690575e-05}}, "connector_pipeline_timer": 0.0001051741204598372}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.882785700989256e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3086209805054492e-06, "add_states_from_episodes_to_batch": 1.5909146868836188e-06, "numpy_to_tensor": 8.791694873382236e-06, "add_observations_from_episodes_to_batch": 2.8614376278077917e-06, "batch_individual_items": 6.405441205538458e-06}}, "connector_pipeline_timer": 4.319998830659285e-05}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.4, "agent_episode_returns_mean": {"default_agent": 1.4}, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": 40400, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "num_episodes_lifetime": 160, "env_reset_timer": 0.00023205827643184022, "episode_duration_sec_mean": 0.004979795437538997, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6217758802979703}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-11", "timestamp": 1754933831, "time_this_iter_s": 1.655350923538208, "time_total_s": 13.878876686096191, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.878876686096191, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.55, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 1.5456345063758772, "restore_env_runners": 1.1280508702480783e-05, "training_step": 1.545493437207889, "env_runner_sampling_timer": 1.4412087340685968, "learner_update_timer": 0.10103876530265636, "synch_weights": 0.0005982126278108579, "restore_eval_env_runners": 9.455056504670743e-06, "evaluation_iteration": 0.10677024385039229, "synch_eval_env_connectors": 0.00011963852064167274, "synch_env_connectors": 4.66251606588044e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.290767589668611e-05, "normalize_and_clip_actions": 9.53842548903845e-06, "listify_data_for_vector_env": 1.1034096554428083e-05, "remove_single_ts_time_rank_from_batch": 5.71461353327883e-07, "get_actions": 3.831932253436629e-05, "un_batch_to_individual_items": 5.343678660151737e-06}}, "connector_pipeline_timer": 0.00010325324123413848}, "sample": 0.004851285723179459, "module_episode_returns_mean": {"default_policy": 1.5399999999999994}, "env_step_timer": 1.4060106889785959e-05, "weights_seq_no": 8.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.249974128799639e-06, "add_time_dim_to_batch_and_zero_pad": 2.41458650833192e-06, "add_states_from_episodes_to_batch": 1.73039588809806e-06, "numpy_to_tensor": 8.496575450573377e-06, "add_observations_from_episodes_to_batch": 2.9746159069839776e-06}}, "connector_pipeline_timer": 4.337643732344636e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 1.5399999999999994}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -4312500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0015814127681237813, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -215625.0, "episode_duration_sec_mean": 0.004542944633401929, "episode_return_mean": 1.5399999999999994, "env_reset_timer": 3.414941608924166e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.7628381206569726e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_env_steps_sampled_lifetime_throughput": 3758.8796016953106}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 54000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008317930608910036, "add_time_dim_to_batch_and_zero_pad": 1.1325997514267331e-05, "add_states_from_episodes_to_batch": 2.946794257781794e-06, "numpy_to_tensor": 5.994096278446288e-05, "add_columns_from_episodes_to_train_batch": 0.03311928643716884, "general_advantage_estimation": 0.006250319889589079, "add_observations_from_episodes_to_batch": 0.0007763668251804659, "batch_individual_items": 0.031127984590980134}}, "connector_pipeline_timer": 0.07977071268663727}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 283500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2432392.3881778126, "num_module_steps_trained_throughput": 465686.4619886681, "num_module_steps_trained_lifetime_throughput": 464784.20327629324}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 54000, "weights_seq_no": 9.0, "vf_loss_unclipped": 26.217327117919922, "num_module_steps_trained": 6000, "policy_loss": -0.0015838929684832692, "vf_explained_var": -0.010414361953735352, "mean_kl_loss": 2.5744730010046624e-05, "curr_kl_coeff": 0.0014580006245523691, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.059552472084760666, "module_train_batch_size_mean": 1000.0, "total_loss": 0.05899802967905998, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09900609403848648, "entropy": 0.6220744848251343, "num_module_steps_trained_lifetime_throughput": 466711.69113778125}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09923624445571343, "env_step_timer": 1.3814072482016307e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.6}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2651551633327067e-05, "remove_single_ts_time_rank_from_batch": 5.667637982417827e-07, "get_actions": 3.523638511916062e-05, "normalize_and_clip_actions": 9.20607497317278e-06, "un_batch_to_individual_items": 5.378467243517908e-06, "listify_data_for_vector_env": 1.0924334395779629e-05}}, "connector_pipeline_timer": 9.874908005863633e-05}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.6877273741427018e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2948577030329765e-06, "add_states_from_episodes_to_batch": 1.6367672529665304e-06, "numpy_to_tensor": 8.229140814693117e-06, "add_observations_from_episodes_to_batch": 2.7992780887291473e-06, "batch_individual_items": 6.11007284238344e-06}}, "connector_pipeline_timer": 4.229615729168486e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.6, "agent_episode_returns_mean": {"default_agent": 1.6}, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": 45400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 180, "env_reset_timer": 0.00023065603360544716, "episode_duration_sec_mean": 0.004985230887541547, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6214385139949572}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-13", "timestamp": 1754933833, "time_this_iter_s": 1.6735317707061768, "time_total_s": 15.552408456802368, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.552408456802368, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.93333333333333, "ram_util_percent": 79.16666666666667}}
{"timers": {"training_iteration": 1.5465595954828804, "restore_env_runners": 1.1220203433140268e-05, "training_step": 1.546418346165588, "env_runner_sampling_timer": 1.4412962800575986, "learner_update_timer": 0.10187895264991031, "synch_weights": 0.0005975817518254825, "restore_eval_env_runners": 9.423835874697887e-06, "evaluation_iteration": 0.1067118351622825, "synch_eval_env_connectors": 0.00011937172574988271, "synch_env_connectors": 4.6550600044035255e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.383110775919148e-05, "normalize_and_clip_actions": 9.818995382536215e-06, "listify_data_for_vector_env": 1.138640377436479e-05, "remove_single_ts_time_rank_from_batch": 5.853937134947979e-07, "get_actions": 4.1509467948619854e-05, "un_batch_to_individual_items": 5.459318501862091e-06}}, "connector_pipeline_timer": 0.00010905049894965928}, "sample": 0.005016648677340866, "module_episode_returns_mean": {"default_policy": 0.58}, "env_step_timer": 1.4453745209049275e-05, "weights_seq_no": 9.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.4555166323112495e-06, "add_time_dim_to_batch_and_zero_pad": 2.447413923871363e-06, "add_states_from_episodes_to_batch": 1.7424803916565877e-06, "numpy_to_tensor": 8.818240591191071e-06, "add_observations_from_episodes_to_batch": 3.102152072888928e-06}}, "connector_pipeline_timer": 4.509841233635558e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 0.58}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -4930000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018515203886605722, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -246500.0, "episode_duration_sec_mean": 0.004769943134859204, "episode_return_mean": 0.58, "env_reset_timer": 3.889706630681514e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.8928742191475827e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_env_steps_sampled_lifetime_throughput": 3631.5168452401076}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 60000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008316863802333667, "add_time_dim_to_batch_and_zero_pad": 1.1314817478221824e-05, "add_states_from_episodes_to_batch": 2.9464871891684055e-06, "numpy_to_tensor": 6.033905318507947e-05, "add_columns_from_episodes_to_train_batch": 0.033145515652920954, "general_advantage_estimation": 0.006240794190710921, "add_observations_from_episodes_to_batch": 0.0007774227467856733, "batch_individual_items": 0.03203492932500436}}, "connector_pipeline_timer": 0.0806948193095257}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 315000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2424415.641780973, "num_module_steps_trained_throughput": 464070.534261318, "num_module_steps_trained_lifetime_throughput": 463200.4421011893}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 60000, "weights_seq_no": 10.0, "vf_loss_unclipped": 26.218334197998047, "num_module_steps_trained": 6000, "policy_loss": -0.08808911591768265, "vf_explained_var": -0.010382890701293945, "mean_kl_loss": 0.0007112051243893802, "curr_kl_coeff": 0.0007290003122761846, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.019865432754158974, "module_train_batch_size_mean": 1000.0, "total_loss": -0.027369648218154907, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09900609403848648, "entropy": 0.6069930195808411, "num_module_steps_trained_lifetime_throughput": 465005.19847015315}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09918754660175158, "env_step_timer": 1.33607512041978e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.8}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2330546844776678e-05, "remove_single_ts_time_rank_from_batch": 5.594728771267467e-07, "get_actions": 3.367854013934717e-05, "normalize_and_clip_actions": 9.034624842964908e-06, "un_batch_to_individual_items": 5.266134964443899e-06, "listify_data_for_vector_env": 1.0581820511297965e-05}}, "connector_pipeline_timer": 9.562070421094629e-05}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.5703334510031058e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1734802942347055e-06, "add_states_from_episodes_to_batch": 1.546661882155451e-06, "numpy_to_tensor": 8.000165591634029e-06, "add_observations_from_episodes_to_batch": 2.7100109876568982e-06, "batch_individual_items": 5.94096959270147e-06}}, "connector_pipeline_timer": 4.101949116340288e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 0.8, "agent_episode_returns_mean": {"default_agent": 0.8}, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": 50400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 200, "env_reset_timer": 0.00022909781424116057, "episode_duration_sec_mean": 0.0047282763198018074, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6217668342747138}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-14", "timestamp": 1754933834, "time_this_iter_s": 1.73921799659729, "time_total_s": 17.291626453399658, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.291626453399658, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.9, "ram_util_percent": 77.7}}
{"timers": {"training_iteration": 1.5455813070269815, "restore_env_runners": 1.115758035606852e-05, "training_step": 1.5454397610338526, "env_runner_sampling_timer": 1.4404480464271978, "learner_update_timer": 0.10175048396323723, "synch_weights": 0.0005975559342114877, "restore_eval_env_runners": 9.393347710336557e-06, "evaluation_iteration": 0.10663374639161972, "synch_eval_env_connectors": 0.00011912425900371723, "synch_env_connectors": 4.646839149071008e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2783438566497354e-05, "normalize_and_clip_actions": 9.423600816734996e-06, "listify_data_for_vector_env": 1.0950317395733316e-05, "remove_single_ts_time_rank_from_batch": 5.797365424481089e-07, "get_actions": 3.749529661453189e-05, "un_batch_to_individual_items": 5.429155521393742e-06}}, "connector_pipeline_timer": 0.00010243646561797784}, "sample": 0.004957838384918838, "module_episode_returns_mean": {"default_policy": 2.42}, "env_step_timer": 1.3774996001868282e-05, "weights_seq_no": 10.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.236484606645513e-06, "add_time_dim_to_batch_and_zero_pad": 2.3589594592202817e-06, "add_states_from_episodes_to_batch": 1.7078348745539154e-06, "numpy_to_tensor": 8.468728165175703e-06, "add_observations_from_episodes_to_batch": 2.949065040859e-06}}, "connector_pipeline_timer": 4.322832696618803e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 2.42}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -5547500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018476051160551048, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -277375.0, "episode_duration_sec_mean": 0.0044967740103602424, "episode_return_mean": 2.42, "env_reset_timer": 3.588195442800049e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.7682488050000485e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_env_steps_sampled_lifetime_throughput": 3763.6717923791784}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 66000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008307553493870938, "add_time_dim_to_batch_and_zero_pad": 1.1277509228996982e-05, "add_states_from_episodes_to_batch": 2.944102849440103e-06, "numpy_to_tensor": 6.039941275969747e-05, "add_columns_from_episodes_to_train_batch": 0.03315301715651715, "general_advantage_estimation": 0.006233964578869867, "add_observations_from_episodes_to_batch": 0.0007777005992561687, "batch_individual_items": 0.03200385962211513}}, "connector_pipeline_timer": 0.08065516986584564}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 346500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2420377.2162082284, "num_module_steps_trained_throughput": 463208.6819876305, "num_module_steps_trained_lifetime_throughput": 462369.3904618994}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 66000, "weights_seq_no": 11.0, "vf_loss_unclipped": 25.318986892700195, "num_module_steps_trained": 6000, "policy_loss": -0.04522467032074928, "vf_explained_var": -0.009004473686218262, "mean_kl_loss": 0.0006328527233563364, "curr_kl_coeff": 0.0003645001561380923, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.04201570525765419, "module_train_batch_size_mean": 1000.0, "total_loss": 0.015427875332534313, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09868254512548447, "entropy": 0.5904287099838257, "num_module_steps_trained_lifetime_throughput": 464058.51949199056}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09921250488649797, "env_step_timer": 1.4254728644971189e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.2}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2684345944412152e-05, "remove_single_ts_time_rank_from_batch": 5.6408430282933e-07, "get_actions": 3.566119629708411e-05, "normalize_and_clip_actions": 9.246393004049794e-06, "un_batch_to_individual_items": 5.284776167391293e-06, "listify_data_for_vector_env": 1.0751391491381232e-05}}, "connector_pipeline_timer": 9.873606618909001e-05}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.670012949877303e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.232503492271533e-06, "add_states_from_episodes_to_batch": 1.5914020450795373e-06, "numpy_to_tensor": 8.253492493288571e-06, "add_observations_from_episodes_to_batch": 2.766177945950572e-06, "batch_individual_items": 6.115237521215585e-06}}, "connector_pipeline_timer": 4.190785559218889e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.2, "agent_episode_returns_mean": {"default_agent": 1.2}, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": 55400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 220, "env_reset_timer": 0.00022756099667245499, "episode_duration_sec_mean": 0.004669912960380316, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6202049251023853}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-16", "timestamp": 1754933836, "time_this_iter_s": 1.557621955871582, "time_total_s": 18.84924840927124, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.84924840927124, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.099999999999994, "ram_util_percent": 76.45}}
{"timers": {"training_iteration": 1.5451807039568486, "restore_env_runners": 1.1097255233788927e-05, "training_step": 1.5450388434232836, "env_runner_sampling_timer": 1.4401228455528583, "learner_update_timer": 0.1016765716240121, "synch_weights": 0.000597106624166336, "restore_eval_env_runners": 9.373164503763772e-06, "evaluation_iteration": 0.10663501142709168, "synch_eval_env_connectors": 0.00011888926700115833, "synch_env_connectors": 4.640780844092864e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2467102822570848e-05, "normalize_and_clip_actions": 9.168678960958032e-06, "listify_data_for_vector_env": 1.0677824717205367e-05, "remove_single_ts_time_rank_from_batch": 5.680232254744986e-07, "get_actions": 3.6275875701955625e-05, "un_batch_to_individual_items": 5.216048454849484e-06}}, "connector_pipeline_timer": 9.921472136172964e-05}, "sample": 0.004710812842640052, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "env_step_timer": 1.3365221842493421e-05, "weights_seq_no": 11.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.072669920216264e-06, "add_time_dim_to_batch_and_zero_pad": 2.3297450462742087e-06, "add_states_from_episodes_to_batch": 1.6872896138107372e-06, "numpy_to_tensor": 8.140662100593842e-06, "add_observations_from_episodes_to_batch": 2.957726567706909e-06}}, "connector_pipeline_timer": 4.218434564768504e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -6165000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0017744583321635385, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -308250.0, "episode_duration_sec_mean": 0.004369278517551719, "episode_return_mean": 1.8600000000000003, "env_reset_timer": 3.1810488420847476e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.6349406665461855e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_env_steps_sampled_lifetime_throughput": 3881.816196031281}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 72000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00830788920873002, "add_time_dim_to_batch_and_zero_pad": 1.1262234297043506e-05, "add_states_from_episodes_to_batch": 2.943832008135877e-06, "numpy_to_tensor": 6.0667917708750044e-05, "add_columns_from_episodes_to_train_batch": 0.03317567906492818, "general_advantage_estimation": 0.006229236182002771, "add_observations_from_episodes_to_batch": 0.0007784560924596148, "batch_individual_items": 0.031986688946730416}}, "connector_pipeline_timer": 0.08065740857828885}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 378000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2416256.744846949, "num_module_steps_trained_throughput": 462335.3246495315, "num_module_steps_trained_lifetime_throughput": 461525.30484736874}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 72000, "weights_seq_no": 12.0, "vf_loss_unclipped": 26.199382781982422, "num_module_steps_trained": 6000, "policy_loss": 0.026909515261650085, "vf_explained_var": -0.010240793228149414, "mean_kl_loss": 0.0027911753859370947, "curr_kl_coeff": 0.00018225007806904614, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.22185371816158295, "module_train_batch_size_mean": 1000.0, "total_loss": 0.0880821943283081, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09889824688434601, "entropy": 0.548987865447998, "num_module_steps_trained_lifetime_throughput": 463103.2905484613}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09917205025752342, "env_step_timer": 1.3419089049687947e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.8}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2284572926583276e-05, "remove_single_ts_time_rank_from_batch": 5.599517956387632e-07, "get_actions": 3.391266537575886e-05, "normalize_and_clip_actions": 9.090761440423845e-06, "un_batch_to_individual_items": 5.252270031827562e-06, "listify_data_for_vector_env": 1.0486939253867888e-05}}, "connector_pipeline_timer": 9.579692447865959e-05}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.58415150458769e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.21126691063117e-06, "add_states_from_episodes_to_batch": 1.569634046391156e-06, "numpy_to_tensor": 8.038452308731393e-06, "add_observations_from_episodes_to_batch": 2.7159524703344214e-06, "batch_individual_items": 5.887115802035851e-06}}, "connector_pipeline_timer": 4.098893948443792e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.8, "agent_episode_returns_mean": {"default_agent": 1.8}, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": 60400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 240, "env_reset_timer": 0.00022608454762208867, "episode_duration_sec_mean": 0.004628427536226809, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6192258946007456}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-18", "timestamp": 1754933838, "time_this_iter_s": 1.6077039241790771, "time_total_s": 20.456952333450317, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.456952333450317, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.333333333333336, "ram_util_percent": 76.86666666666666}}
{"timers": {"training_iteration": 1.5451993389976846, "restore_env_runners": 1.1037952457890704e-05, "training_step": 1.5450571974884117, "env_runner_sampling_timer": 1.4402559162567523, "learner_update_timer": 0.10156410090755397, "synch_weights": 0.0005968518086683897, "restore_eval_env_runners": 9.351093474229922e-06, "evaluation_iteration": 0.10656693215273917, "synch_eval_env_connectors": 0.00011896495439094332, "synch_env_connectors": 4.633962394145621e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2578781498035134e-05, "normalize_and_clip_actions": 9.289186750919803e-06, "listify_data_for_vector_env": 1.075833408027635e-05, "remove_single_ts_time_rank_from_batch": 5.63522014375073e-07, "get_actions": 3.670835808166917e-05, "un_batch_to_individual_items": 5.257546873841609e-06}}, "connector_pipeline_timer": 0.00010021135843578521}, "sample": 0.0046450298408361665, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "env_step_timer": 1.3532230670421661e-05, "weights_seq_no": 12.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.109343901279632e-06, "add_time_dim_to_batch_and_zero_pad": 2.3220402700596605e-06, "add_states_from_episodes_to_batch": 1.69583921076103e-06, "numpy_to_tensor": 8.274625805523637e-06, "add_observations_from_episodes_to_batch": 2.891118643699849e-06}}, "connector_pipeline_timer": 4.2401309121788425e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -6782500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0016599826668858805, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -339125.0, "episode_duration_sec_mean": 0.004411878382321446, "episode_return_mean": 2.899999999999998, "env_reset_timer": 2.9803961525355185e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.641117462061289e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_env_steps_sampled_lifetime_throughput": 3865.271923709772}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 78000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008301596156271148, "add_time_dim_to_batch_and_zero_pad": 1.1256282149309872e-05, "add_states_from_episodes_to_batch": 2.944393916489319e-06, "numpy_to_tensor": 6.087664869864138e-05, "add_columns_from_episodes_to_train_batch": 0.033184236855104986, "general_advantage_estimation": 0.006221051739750939, "add_observations_from_episodes_to_batch": 0.0007788294423141371, "batch_individual_items": 0.03196172997802414}}, "connector_pipeline_timer": 0.08062712283307265}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 409500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2413085.742807744, "num_module_steps_trained_throughput": 461645.6408454784, "num_module_steps_trained_lifetime_throughput": 460863.6058660603}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 78000, "weights_seq_no": 13.0, "vf_loss_unclipped": 25.324901580810547, "num_module_steps_trained": 6000, "policy_loss": 0.0031821199227124453, "vf_explained_var": -0.009009599685668945, "mean_kl_loss": 0.000769394391681999, "curr_kl_coeff": 9.112503903452307e-05, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.05305613577365875, "module_train_batch_size_mean": 1000.0, "total_loss": 0.06440390646457672, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09868254512548447, "entropy": 0.527543842792511, "num_module_steps_trained_lifetime_throughput": 462333.8775408528}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.0991798993439875, "env_step_timer": 1.4463070857910255e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.8}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3020968804945212e-05, "remove_single_ts_time_rank_from_batch": 6.405253702941213e-07, "get_actions": 3.774385627505525e-05, "normalize_and_clip_actions": 9.574696173986687e-06, "un_batch_to_individual_items": 5.447429835037868e-06, "listify_data_for_vector_env": 1.13487132075103e-05}}, "connector_pipeline_timer": 0.000103212022658377}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.863226123511951e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3268411233646495e-06, "add_states_from_episodes_to_batch": 1.5988668681508394e-06, "numpy_to_tensor": 8.970509880017447e-06, "add_observations_from_episodes_to_batch": 3.057193749247688e-06, "batch_individual_items": 6.31895810792788e-06}}, "connector_pipeline_timer": 4.445372265747653e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.8, "agent_episode_returns_mean": {"default_agent": 1.8}, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": 65400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 260, "env_reset_timer": 0.000224579122333356, "episode_duration_sec_mean": 0.004470519603928551, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6186696252355073}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-19", "timestamp": 1754933839, "time_this_iter_s": 1.6542048454284668, "time_total_s": 22.111157178878784, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.111157178878784, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.2, "ram_util_percent": 77.2}}
{"timers": {"training_iteration": 1.5447975218582233, "restore_env_runners": 1.0987151966716385e-05, "training_step": 1.5446553196829094, "env_runner_sampling_timer": 1.4389586458439783, "learner_update_timer": 0.10246175864877466, "synch_weights": 0.0005968178701124367, "restore_eval_env_runners": 9.343832323122762e-06, "evaluation_iteration": 0.106548219081423, "synch_eval_env_connectors": 0.00011893821474966611, "synch_env_connectors": 4.623032818644263e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2367997448311763e-05, "normalize_and_clip_actions": 9.122853583552853e-06, "listify_data_for_vector_env": 1.0588424015092563e-05, "remove_single_ts_time_rank_from_batch": 5.580646121426526e-07, "get_actions": 3.6011657752575074e-05, "un_batch_to_individual_items": 5.128439981254627e-06}}, "connector_pipeline_timer": 9.854976186381769e-05}, "sample": 0.004684249306257973, "module_episode_returns_mean": {"default_policy": 3.9399999999999995}, "env_step_timer": 1.3272034079180466e-05, "weights_seq_no": 13.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 5.990083958123358e-06, "add_time_dim_to_batch_and_zero_pad": 2.2945703941206285e-06, "add_states_from_episodes_to_batch": 1.6783825053414263e-06, "numpy_to_tensor": 8.081906078551814e-06, "add_observations_from_episodes_to_batch": 2.830150425935512e-06}}, "connector_pipeline_timer": 4.178933180514463e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 3.9399999999999995}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -7400000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0017629083127630896, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -370000.0, "episode_duration_sec_mean": 0.004339427144266666, "episode_return_mean": 3.9399999999999995, "env_reset_timer": 3.098520257863711e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.6400666632444184e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_env_steps_sampled_lifetime_throughput": 3910.215478265898}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 84000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008293873944977775, "add_time_dim_to_batch_and_zero_pad": 1.1254549042502453e-05, "add_states_from_episodes_to_batch": 2.9453704650710226e-06, "numpy_to_tensor": 6.121621306478935e-05, "add_columns_from_episodes_to_train_batch": 0.03320526364726011, "general_advantage_estimation": 0.006211864141808973, "add_observations_from_episodes_to_batch": 0.0007791332269697744, "batch_individual_items": 0.032935049348604986}}, "connector_pipeline_timer": 0.08160529451473515}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 441000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2410979.890217107, "num_module_steps_trained_throughput": 461160.9840903618, "num_module_steps_trained_lifetime_throughput": 460406.0430716517}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 84000, "weights_seq_no": 14.0, "vf_loss_unclipped": 24.430038452148438, "num_module_steps_trained": 6000, "policy_loss": -0.02879970334470272, "vf_explained_var": -0.007025957107543945, "mean_kl_loss": 0.0006089486996643245, "curr_kl_coeff": 4.5562519517261535e-05, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.06801996380090714, "module_train_batch_size_mean": 1000.0, "total_loss": 0.032381489872932434, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09835900366306305, "entropy": 0.5081238746643066, "num_module_steps_trained_lifetime_throughput": 461770.3320049718}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09914271744013954, "env_step_timer": 1.3804850665422126e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.0}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.259733367031069e-05, "remove_single_ts_time_rank_from_batch": 5.698857944164437e-07, "get_actions": 3.491787252168143e-05, "normalize_and_clip_actions": 9.123822390657134e-06, "un_batch_to_individual_items": 5.258047389235157e-06, "listify_data_for_vector_env": 1.0810004959343105e-05}}, "connector_pipeline_timer": 9.768743578501224e-05}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.6375585753189944e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1908859185180157e-06, "add_states_from_episodes_to_batch": 1.5572330212659446e-06, "numpy_to_tensor": 8.200072425283196e-06, "add_observations_from_episodes_to_batch": 2.7420131484682906e-06, "batch_individual_items": 6.052849908752188e-06}}, "connector_pipeline_timer": 4.149859420718361e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 2.0, "agent_episode_returns_mean": {"default_agent": 2.0}, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": 70400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 280, "env_reset_timer": 0.00022307458122453784, "episode_duration_sec_mean": 0.004462034972384572, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6177041010735391}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-21", "timestamp": 1754933841, "time_this_iter_s": 1.6072909832000732, "time_total_s": 23.718448162078857, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.718448162078857, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 33.35, "ram_util_percent": 76.5}}
{"timers": {"training_iteration": 1.5446305582997586, "restore_env_runners": 1.093020052404531e-05, "training_step": 1.5444879602359645, "env_runner_sampling_timer": 1.437995740636105, "learner_update_timer": 0.10325903314218413, "synch_weights": 0.0005969334408788193, "restore_eval_env_runners": 9.318734450416818e-06, "evaluation_iteration": 0.10648277356003817, "synch_eval_env_connectors": 0.00011874800202634567, "synch_env_connectors": 4.615971589639711e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2667420843935105e-05, "normalize_and_clip_actions": 9.30033183779342e-06, "listify_data_for_vector_env": 1.0875602806542963e-05, "remove_single_ts_time_rank_from_batch": 5.836248593520322e-07, "get_actions": 3.702831779577179e-05, "un_batch_to_individual_items": 5.3311121870039064e-06}}, "connector_pipeline_timer": 0.00010095874697273935}, "sample": 0.004663608996694716, "module_episode_returns_mean": {"default_policy": 3.7}, "env_step_timer": 1.3623932781519519e-05, "weights_seq_no": 14.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.182899999267324e-06, "add_time_dim_to_batch_and_zero_pad": 2.325275976307941e-06, "add_states_from_episodes_to_batch": 1.6986536029767511e-06, "numpy_to_tensor": 8.316181693813984e-06, "add_observations_from_episodes_to_batch": 2.977041464010721e-06}}, "connector_pipeline_timer": 4.2728842229946316e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 3.7}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -8017500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018421512627899378, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -400875.0, "episode_duration_sec_mean": 0.00443682964425534, "episode_return_mean": 3.7, "env_reset_timer": 2.9345471816053164e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.6735546538608188e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_env_steps_sampled_lifetime_throughput": 3850.2990015748624}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 90000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008285303115220225, "add_time_dim_to_batch_and_zero_pad": 1.1217834164409057e-05, "add_states_from_episodes_to_batch": 2.9400869095380204e-06, "numpy_to_tensor": 6.147072109562713e-05, "add_columns_from_episodes_to_train_batch": 0.03320129601071576, "general_advantage_estimation": 0.006203403420025017, "add_observations_from_episodes_to_batch": 0.0007793806450840796, "batch_individual_items": 0.033825960514592114}}, "connector_pipeline_timer": 0.08247551657027177}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 472500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2407374.082505214, "num_module_steps_trained_throughput": 460392.12063695356, "num_module_steps_trained_lifetime_throughput": 459664.0328634037}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 90000, "weights_seq_no": 15.0, "vf_loss_unclipped": 24.126394271850586, "num_module_steps_trained": 6000, "policy_loss": -0.09887556731700897, "vf_explained_var": -0.0060272216796875, "mean_kl_loss": 3.665469921543263e-05, "curr_kl_coeff": 2.2781259758630767e-05, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.09681214392185211, "module_train_batch_size_mean": 1000.0, "total_loss": -0.03771353140473366, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09825114160776138, "entropy": 0.5022678375244141, "num_module_steps_trained_lifetime_throughput": 460923.3059495834}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09909855443671077, "env_step_timer": 1.3261211552727758e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.6}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2319569120954043e-05, "remove_single_ts_time_rank_from_batch": 5.628679470151773e-07, "get_actions": 3.4089819990422376e-05, "normalize_and_clip_actions": 9.062415557644553e-06, "un_batch_to_individual_items": 5.2034476545913445e-06, "listify_data_for_vector_env": 1.057004926526236e-05}}, "connector_pipeline_timer": 9.615170535086248e-05}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.6142554667506066e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.171238847324623e-06, "add_states_from_episodes_to_batch": 1.5461248504183801e-06, "numpy_to_tensor": 7.930414396366924e-06, "add_observations_from_episodes_to_batch": 2.685351317057045e-06, "batch_individual_items": 5.8529026125571885e-06}}, "connector_pipeline_timer": 4.081731853239722e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 2.6, "agent_episode_returns_mean": {"default_agent": 2.6}, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": 75400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 300, "env_reset_timer": 0.00022174967467296003, "episode_duration_sec_mean": 0.004465448290575296, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.616976702563411}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-23", "timestamp": 1754933843, "time_this_iter_s": 1.6298649311065674, "time_total_s": 25.348313093185425, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.348313093185425, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.9, "ram_util_percent": 76.66666666666667}}
{"timers": {"training_iteration": 1.5435118389669078, "restore_env_runners": 1.087922957995946e-05, "training_step": 1.543368645634368, "env_runner_sampling_timer": 1.43699099906864, "learner_update_timer": 0.10314335781001446, "synch_weights": 0.0005979870260689979, "restore_eval_env_runners": 9.29929737644323e-06, "evaluation_iteration": 0.10641283957461363, "synch_eval_env_connectors": 0.00011871593126952913, "synch_env_connectors": 4.6098121783230484e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2554675731421908e-05, "normalize_and_clip_actions": 9.208675223769408e-06, "listify_data_for_vector_env": 1.07429488316726e-05, "remove_single_ts_time_rank_from_batch": 5.567701054422669e-07, "get_actions": 3.67481716961782e-05, "un_batch_to_individual_items": 5.187682429014328e-06}}, "connector_pipeline_timer": 0.00010011981290599765}, "sample": 0.004706284105032094, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "env_step_timer": 1.3508595968721042e-05, "weights_seq_no": 15.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.0291358931191895e-06, "add_time_dim_to_batch_and_zero_pad": 2.3476064318580464e-06, "add_states_from_episodes_to_batch": 1.6715036340644893e-06, "numpy_to_tensor": 8.185268344501603e-06, "add_observations_from_episodes_to_batch": 2.916673882876519e-06}}, "connector_pipeline_timer": 4.22718932253542e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -8635000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018161660105283938, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -431750.0, "episode_duration_sec_mean": 0.004409157850779595, "episode_return_mean": 3.8600000000000008, "env_reset_timer": 3.144743804749544e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.6491691569396514e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_env_steps_sampled_lifetime_throughput": 3891.945296660432}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 96000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008278990913681826, "add_time_dim_to_batch_and_zero_pad": 1.1229405309866998e-05, "add_states_from_episodes_to_batch": 2.9490157851541583e-06, "numpy_to_tensor": 6.178476368067396e-05, "add_columns_from_episodes_to_train_batch": 0.03322290763033811, "general_advantage_estimation": 0.006192088135232446, "add_observations_from_episodes_to_batch": 0.000779601418868124, "batch_individual_items": 0.033788204249995964}}, "connector_pipeline_timer": 0.08244238765354342}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 504000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2406512.466879505, "num_module_steps_trained_throughput": 460151.6263900102, "num_module_steps_trained_lifetime_throughput": 459448.3381499883}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 96000, "weights_seq_no": 16.0, "vf_loss_unclipped": 25.01618003845215, "num_module_steps_trained": 6000, "policy_loss": 0.05892258882522583, "vf_explained_var": -0.00821065902709961, "mean_kl_loss": 5.30047582287807e-05, "curr_kl_coeff": 1.1390629879315384e-05, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.04237082600593567, "module_train_batch_size_mean": 1000.0, "total_loss": 0.12026922404766083, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.098574697971344, "entropy": 0.5057782530784607, "num_module_steps_trained_lifetime_throughput": 460610.80013595143}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09909424056245084, "env_step_timer": 1.3959990808676942e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.6}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.290700982068445e-05, "remove_single_ts_time_rank_from_batch": 5.810833571006656e-07, "get_actions": 3.5584055855854566e-05, "normalize_and_clip_actions": 9.440369975253651e-06, "un_batch_to_individual_items": 5.482099382387634e-06, "listify_data_for_vector_env": 1.101289212457049e-05}}, "connector_pipeline_timer": 0.0001002785350521671}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.715630890478499e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2634540613574586e-06, "add_states_from_episodes_to_batch": 1.574748818259294e-06, "numpy_to_tensor": 8.402668279654471e-06, "add_observations_from_episodes_to_batch": 2.8596175579964324e-06, "batch_individual_items": 6.091860037807053e-06}}, "connector_pipeline_timer": 4.2222371243147094e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 2.6, "agent_episode_returns_mean": {"default_agent": 2.6}, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": 80400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 320, "env_reset_timer": 0.00022029717793055177, "episode_duration_sec_mean": 0.004447303267661482, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6153013776277032}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-24", "timestamp": 1754933844, "time_this_iter_s": 1.5388128757476807, "time_total_s": 26.887125968933105, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.887125968933105, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.95, "ram_util_percent": 76.55}}
{"timers": {"training_iteration": 1.5482167822479203, "restore_env_runners": 1.0825027921024168e-05, "training_step": 1.5480730687581723, "env_runner_sampling_timer": 1.4417665865783844, "learner_update_timer": 0.10304838632179934, "synch_weights": 0.0006212834055057399, "restore_eval_env_runners": 9.28046445514221e-06, "evaluation_iteration": 0.10638331992993724, "synch_eval_env_connectors": 0.00011845835179408157, "synch_env_connectors": 4.603714361119552e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5462863695334543e-05, "normalize_and_clip_actions": 1.0962693567469627e-05, "listify_data_for_vector_env": 1.3234785774463785e-05, "remove_single_ts_time_rank_from_batch": 6.672429988049956e-07, "get_actions": 4.874083291671897e-05, "un_batch_to_individual_items": 6.1118500398669505e-06}}, "connector_pipeline_timer": 0.00012443441270907545}, "sample": 0.005829957623239743, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "env_step_timer": 2.7167620097717484e-05, "weights_seq_no": 16.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.787501512391972e-06, "add_time_dim_to_batch_and_zero_pad": 2.7550320552603633e-06, "add_states_from_episodes_to_batch": 2.0575338135762953e-06, "numpy_to_tensor": 1.0683549505530785e-05, "add_observations_from_episodes_to_batch": 3.5943511971630646e-06}}, "connector_pipeline_timer": 5.097832631886462e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -9252500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0015671945417303644, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -462625.0, "episode_duration_sec_mean": 0.006523649972397834, "episode_return_mean": 3.8600000000000008, "env_reset_timer": 4.250706994056769e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 5.1108607338921944e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_env_steps_sampled_lifetime_throughput": 3383.7315019227985}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 102000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008274446004294595, "add_time_dim_to_batch_and_zero_pad": 1.1355441360225303e-05, "add_states_from_episodes_to_batch": 2.947435036557406e-06, "numpy_to_tensor": 6.192732579204892e-05, "add_columns_from_episodes_to_train_batch": 0.033224136053544406, "general_advantage_estimation": 0.006189874753920653, "add_observations_from_episodes_to_batch": 0.0007822241545594883, "batch_individual_items": 0.0337427126178187}}, "connector_pipeline_timer": 0.08239409794643567}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 535500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2405645.2732454813, "num_module_steps_trained_throughput": 459910.05181954027, "num_module_steps_trained_lifetime_throughput": 459230.96848196466}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 102000, "weights_seq_no": 17.0, "vf_loss_unclipped": 24.70703125, "num_module_steps_trained": 6000, "policy_loss": 0.010529711842536926, "vf_explained_var": -0.007464289665222168, "mean_kl_loss": 8.060758409556001e-05, "curr_kl_coeff": 5.695314939657692e-06, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.12520335614681244, "module_train_batch_size_mean": 1000.0, "total_loss": 0.07174283266067505, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09846686571836472, "entropy": 0.5125570893287659, "num_module_steps_trained_lifetime_throughput": 460298.0449846294}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09914574024693718, "env_step_timer": 1.4485363530672356e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.8}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3347263029821903e-05, "remove_single_ts_time_rank_from_batch": 5.790083257846795e-07, "get_actions": 3.867160306912173e-05, "normalize_and_clip_actions": 9.611151864113553e-06, "un_batch_to_individual_items": 5.5671623199949055e-06, "listify_data_for_vector_env": 1.1235225515964232e-05}}, "connector_pipeline_timer": 0.00010430747979174164}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.8649813199496473e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.320856547043358e-06, "add_states_from_episodes_to_batch": 1.6540973963151285e-06, "numpy_to_tensor": 8.672670664241007e-06, "add_observations_from_episodes_to_batch": 2.9205523625792153e-06, "batch_individual_items": 6.310108537553321e-06}}, "connector_pipeline_timer": 4.420516284300794e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 1.8, "agent_episode_returns_mean": {"default_agent": 1.8}, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": 85400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 340, "env_reset_timer": 0.00022782920577253324, "episode_duration_sec_mean": 0.004501724087167531, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.619523578850502}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-26", "timestamp": 1754933846, "time_this_iter_s": 2.133073329925537, "time_total_s": 29.020199298858643, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.020199298858643, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 52.73333333333333, "ram_util_percent": 78.99999999999999}}
{"timers": {"training_iteration": 1.5485864285948776, "restore_env_runners": 1.0821777277182512e-05, "training_step": 1.5484417543207207, "env_runner_sampling_timer": 1.4410640282117568, "learner_update_timer": 0.10411920370909498, "synch_weights": 0.0006211434919649531, "restore_eval_env_runners": 9.560159736606524e-06, "evaluation_iteration": 0.10648601382030072, "synch_eval_env_connectors": 0.00011835334809140928, "synch_env_connectors": 4.6610074571619436e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2861443822000042e-05, "normalize_and_clip_actions": 9.490741292191909e-06, "listify_data_for_vector_env": 1.0988345408703857e-05, "remove_single_ts_time_rank_from_batch": 5.791953668647098e-07, "get_actions": 3.787462848089493e-05, "un_batch_to_individual_items": 5.3271493627117824e-06}}, "connector_pipeline_timer": 0.00010251699240095824}, "sample": 0.005842390467458474, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "env_step_timer": 1.3821436740438816e-05, "weights_seq_no": 17.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.226061642143564e-06, "add_time_dim_to_batch_and_zero_pad": 2.409734621817077e-06, "add_states_from_episodes_to_batch": 1.722034125780545e-06, "numpy_to_tensor": 8.503134014978261e-06, "add_observations_from_episodes_to_batch": 2.9744090262463292e-06}}, "connector_pipeline_timer": 4.349094253281947e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -9870000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001644438881343216, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -493500.0, "episode_duration_sec_mean": 0.004514712331350893, "episode_return_mean": 2.8199999999999994, "env_reset_timer": 4.283994906891286e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.7381531025541344e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_env_steps_sampled_lifetime_throughput": 3744.608520817396}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 108000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008269648204127683, "add_time_dim_to_batch_and_zero_pad": 1.1317726872180425e-05, "add_states_from_episodes_to_batch": 2.9454603135137906e-06, "numpy_to_tensor": 6.212889347587049e-05, "add_columns_from_episodes_to_train_batch": 0.03321791302295156, "general_advantage_estimation": 0.0061813718367090915, "add_observations_from_episodes_to_batch": 0.0007818835834866643, "batch_individual_items": 0.034902414651620035}}, "connector_pipeline_timer": 0.08353388571709588}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 567000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2402482.778005615, "num_module_steps_trained_throughput": 459235.19958804094, "num_module_steps_trained_lifetime_throughput": 458579.6775334278}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 108000, "weights_seq_no": 18.0, "vf_loss_unclipped": 26.49570655822754, "num_module_steps_trained": 6000, "policy_loss": 0.1711471825838089, "vf_explained_var": -0.009949445724487305, "mean_kl_loss": 0.0007358924485743046, "curr_kl_coeff": 2.847657469828846e-06, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.06099133938550949, "module_train_batch_size_mean": 1000.0, "total_loss": 0.23265135288238525, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09911397844552994, "entropy": 0.5282083749771118, "num_module_steps_trained_lifetime_throughput": 459557.3242541062}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09910035492487322, "env_step_timer": 1.3654025700069912e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.2}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2582798980337146e-05, "remove_single_ts_time_rank_from_batch": 5.781672305991648e-07, "get_actions": 3.543541721592498e-05, "normalize_and_clip_actions": 9.26006172294335e-06, "un_batch_to_individual_items": 5.321510273433371e-06, "listify_data_for_vector_env": 1.0631341852904037e-05}}, "connector_pipeline_timer": 9.849388448171974e-05}, "episode_return_min": -13.5, "rlmodule_inference_timer": 2.6442848149104428e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.220539762210305e-06, "add_states_from_episodes_to_batch": 1.5776516595404191e-06, "numpy_to_tensor": 8.137942261767352e-06, "add_observations_from_episodes_to_batch": 2.7564107307073277e-06, "batch_individual_items": 6.019609621703435e-06}}, "connector_pipeline_timer": 4.160321691302943e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 2.2, "agent_episode_returns_mean": {"default_agent": 2.2}, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": 90400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 360, "env_reset_timer": 0.00022645050380099978, "episode_duration_sec_mean": 0.004449999935459346, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6194627226519271}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-28", "timestamp": 1754933848, "time_this_iter_s": 1.6870360374450684, "time_total_s": 30.70723533630371, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.70723533630371, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 43.2, "ram_util_percent": 80.25}}
{"timers": {"training_iteration": 1.5502115009785615, "restore_env_runners": 1.0768979018366399e-05, "training_step": 1.5500659476075505, "env_runner_sampling_timer": 1.4419070895901884, "learner_update_timer": 0.10490088459173301, "synch_weights": 0.0006208691360129941, "restore_eval_env_runners": 9.536228067969993e-06, "evaluation_iteration": 0.10641537993242957, "synch_eval_env_connectors": 0.00011855106494167348, "synch_env_connectors": 4.652306867990047e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.458101742042441e-05, "normalize_and_clip_actions": 1.0342921764532446e-05, "listify_data_for_vector_env": 1.2050287958208168e-05, "remove_single_ts_time_rank_from_batch": 6.317564352335996e-07, "get_actions": 4.2258282960875916e-05, "un_batch_to_individual_items": 5.765320258183885e-06}}, "connector_pipeline_timer": 0.0001131733996618105}, "sample": 0.005106405260704341, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "env_step_timer": 1.5945764856256357e-05, "weights_seq_no": 18.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.870175770054318e-06, "add_time_dim_to_batch_and_zero_pad": 2.5721540383420874e-06, "add_states_from_episodes_to_batch": 1.8648585030004035e-06, "numpy_to_tensor": 9.443107785939407e-06, "add_observations_from_episodes_to_batch": 3.1954213702412762e-06}}, "connector_pipeline_timer": 4.716706316719152e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -10487500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001932500204490305, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -524375.0, "episode_duration_sec_mean": 0.005021900016348808, "episode_return_mean": 3.8600000000000008, "env_reset_timer": 3.862518026138424e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_len_min": 20, "rlmodule_inference_timer": 3.0464019655364665e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_env_steps_sampled_lifetime_throughput": 3573.74588382907}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 114000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008276177143047563, "add_time_dim_to_batch_and_zero_pad": 1.1312470099251845e-05, "add_states_from_episodes_to_batch": 2.954335455090171e-06, "numpy_to_tensor": 6.237843422204633e-05, "add_columns_from_episodes_to_train_batch": 0.03324983431240543, "general_advantage_estimation": 0.006174076868745077, "add_observations_from_episodes_to_batch": 0.0007830118285843552, "batch_individual_items": 0.035728994674360824}}, "connector_pipeline_timer": 0.08439315477970546}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 598500, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2400685.38979951, "num_module_steps_trained_throughput": 458822.26901159174, "num_module_steps_trained_lifetime_throughput": 458189.9931228808}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 114000, "weights_seq_no": 19.0, "vf_loss_unclipped": 24.051631927490234, "num_module_steps_trained": 6000, "policy_loss": -0.08550427854061127, "vf_explained_var": -0.005461335182189941, "mean_kl_loss": 3.7580906791845337e-05, "curr_kl_coeff": 1.423828734914423e-06, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.11087688058614731, "module_train_batch_size_mean": 1000.0, "total_loss": -0.024771621450781822, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09814337641000748, "entropy": 0.5417179465293884, "num_module_steps_trained_lifetime_throughput": 459078.40730059723}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.0991250126250274, "env_step_timer": 1.4658349588909622e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 3.0}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3336761545942737e-05, "remove_single_ts_time_rank_from_batch": 5.841153325978473e-07, "get_actions": 3.842588372245501e-05, "normalize_and_clip_actions": 1.0070639116319282e-05, "un_batch_to_individual_items": 5.656411646015961e-06, "listify_data_for_vector_env": 1.1589965572813808e-05}}, "connector_pipeline_timer": 0.00010516347328287258}, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.898334835439857e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3166347577725908e-06, "add_states_from_episodes_to_batch": 1.5947679812531129e-06, "numpy_to_tensor": 8.705668274490853e-06, "add_observations_from_episodes_to_batch": 2.9185475713516207e-06, "batch_individual_items": 6.300860927462007e-06}}, "connector_pipeline_timer": 4.318258136815701e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 3.0, "agent_episode_returns_mean": {"default_agent": 3.0}, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": 95400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 380, "env_reset_timer": 0.00022495474850482716, "episode_duration_sec_mean": 0.004500169926322997, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6205532879248108}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-30", "timestamp": 1754933850, "time_this_iter_s": 1.8205208778381348, "time_total_s": 32.527756214141846, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.527756214141846, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.8, "ram_util_percent": 78.16666666666667}}
{"timers": {"training_iteration": 1.5494423247187243, "restore_env_runners": 1.0733789198156896e-05, "training_step": 1.5492961885515837, "env_runner_sampling_timer": 1.4411808070246588, "learner_update_timer": 0.10486007740640407, "synch_weights": 0.0006201658649204461, "restore_eval_env_runners": 9.519616095893342e-06, "evaluation_iteration": 0.10642037113317933, "synch_eval_env_connectors": 0.00011840763440405837, "synch_env_connectors": 4.661204477419077e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2830532644652318e-05, "normalize_and_clip_actions": 9.426130607478692e-06, "listify_data_for_vector_env": 1.094669942687543e-05, "remove_single_ts_time_rank_from_batch": 5.828947757762695e-07, "get_actions": 3.790246061717007e-05, "un_batch_to_individual_items": 5.3133220004255915e-06}}, "connector_pipeline_timer": 0.00010259259121701047}, "sample": 0.005108665293751698, "module_episode_returns_mean": {"default_policy": 3.62}, "env_step_timer": 1.3844859049121682e-05, "weights_seq_no": 19.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.190772115872094e-06, "add_time_dim_to_batch_and_zero_pad": 2.3847804963878403e-06, "add_states_from_episodes_to_batch": 1.7170937796196372e-06, "numpy_to_tensor": 8.440919290113705e-06, "add_observations_from_episodes_to_batch": 2.945044445340607e-06}}, "connector_pipeline_timer": 4.322988383823846e-05}, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": 3.62}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -11105000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0019104426886030167, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes_lifetime": -555250.0, "episode_duration_sec_mean": 0.004453674373216927, "episode_return_mean": 3.62, "env_reset_timer": 3.874367490766904e-05, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_len_min": 20, "rlmodule_inference_timer": 2.712192527830582e-05, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_env_steps_sampled_lifetime_throughput": 3753.199163984839}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 120000, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008323925782143854, "add_time_dim_to_batch_and_zero_pad": 1.1298514954310819e-05, "add_states_from_episodes_to_batch": 2.9560426295304918e-06, "numpy_to_tensor": 6.234964975383655e-05, "add_columns_from_episodes_to_train_batch": 0.03331829221907722, "general_advantage_estimation": 0.006162317760034392, "add_observations_from_episodes_to_batch": 0.0007839046300364318, "batch_individual_items": 0.035661164727966425}}, "connector_pipeline_timer": 0.08443072281131755}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 630000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2400400.8304509656, "num_module_steps_trained_throughput": 458703.74163375964, "num_module_steps_trained_lifetime_throughput": 458091.23086211993}, "default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 120000, "weights_seq_no": 20.0, "vf_loss_unclipped": 25.19484519958496, "num_module_steps_trained": 6000, "policy_loss": 0.05764909088611603, "vf_explained_var": -0.007982969284057617, "mean_kl_loss": 3.7657540815416723e-05, "curr_kl_coeff": 7.119143674572115e-07, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.08247192203998566, "module_train_batch_size_mean": 1000.0, "total_loss": 0.1188291683793068, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09868261218070984, "entropy": 0.5321364998817444, "num_module_steps_trained_lifetime_throughput": 458900.47202080995}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.09906912124964386, "env_step_timer": 1.368312720877727e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 3.0}, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2337763885968124e-05, "remove_single_ts_time_rank_from_batch": 5.621148542660466e-07, "get_actions": 3.464071906910408e-05, "normalize_and_clip_actions": 9.071062842029828e-06, "un_batch_to_individual_items": 5.251057531260916e-06, "listify_data_for_vector_env": 1.0568612652214016e-05}}, "connector_pipeline_timer": 9.672414168451092e-05}, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.6276398994857943e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1437027584025778e-06, "add_states_from_episodes_to_batch": 1.5487762526939994e-06, "numpy_to_tensor": 8.003478704730921e-06, "add_observations_from_episodes_to_batch": 2.7232714181442867e-06, "batch_individual_items": 5.933961680290996e-06}}, "connector_pipeline_timer": 4.1009317613032866e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "episode_return_mean": 3.0, "agent_episode_returns_mean": {"default_agent": 3.0}, "weights_seq_no": 20.0, "num_env_steps_sampled_lifetime": 100400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 400, "env_reset_timer": 0.00022342687124131625, "episode_duration_sec_mean": 0.004490447426214814, "num_env_steps_sampled": 400, "episode_len_min": 20, "time_between_sampling": 1.6192584296250043}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "5034a_00000", "date": "2025-08-11_19-37-31", "timestamp": 1754933851, "time_this_iter_s": 1.5736782550811768, "time_total_s": 34.10143446922302, "pid": 28379, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x142dedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.10143446922302, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 32.35, "ram_util_percent": 77.19999999999999}}
