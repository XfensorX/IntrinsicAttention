{"timers": {"training_iteration": 2.341164542012848, "restore_env_runners": 1.5749945305287838e-05, "training_step": 2.3410072090337053, "env_runner_sampling_timer": 2.132571667083539, "learner_update_timer": 0.2051960420794785, "synch_weights": 0.0006213750457391143}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.865528445596412e-06, "numpy_to_tensor": 1.145697809416217e-05, "add_observations_from_episodes_to_batch": 3.6734229816095695e-06, "add_states_from_episodes_to_batch": 1.9669996115819217e-06, "batch_individual_items": 7.790384282837009e-06}}, "connector_pipeline_timer": 5.4487865204320476e-05}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5904489033095295e-05, "get_actions": 6.430933429963184e-05, "un_batch_to_individual_items": 6.385980160474067e-06, "listify_data_for_vector_env": 1.3226801052173746e-05, "remove_single_ts_time_rank_from_batch": 6.755439860476555e-07, "normalize_and_clip_actions": 1.5238828443552415e-05}}, "connector_pipeline_timer": 0.0001474821111941057}, "episode_duration_sec_mean": 0.007331375141628086, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes_lifetime": 31375.0, "weights_seq_no": 0.0, "env_step_timer": 1.7945630893310445e-05, "env_reset_timer": 0.00011615853206035413, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": 627500.0, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "rlmodule_inference_timer": 0.00013507546737928633, "time_between_sampling": 0.0006156240433941712, "env_to_module_sum_episodes_length_out": 10.191744832559449, "sample": 0.007601296834903081, "episode_len_min": 20, "episode_return_mean": -0.14000000000000007, "num_env_steps_sampled_lifetime_throughput": 3037.542661878717}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.3732481598854065, "policy_loss": 0.06390514224767685, "total_loss": 0.12644556164741516, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.37276268005371, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6931197643280029, "mean_kl_loss": 0.00010375812416896224, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011374115943908691, "weights_seq_no": 1.0, "gradients_default_optimizer_global_norm": 0.025468185544013977, "num_module_steps_trained_lifetime_throughput": 377517.62862035853}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03774466703180224, "general_advantage_estimation": 0.013051374931819737, "numpy_to_tensor": 0.00017374998424202204, "add_states_from_episodes_to_batch": 7.916009053587914e-06, "add_time_dim_to_batch_and_zero_pad": 3.933301195502281e-05, "batch_individual_items": 0.11014054203405976, "add_one_ts_to_episodes_and_truncate": 0.007701250026002526, "add_observations_from_episodes_to_batch": 0.0008096250239759684}}, "connector_pipeline_timer": 0.17003475001547486}, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1966415.428884486, "num_module_steps_trained_throughput": 376471.35328412335, "num_module_steps_trained_lifetime_throughput": 375753.0505263873}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.809378177317892e-06, "tensor_to_numpy": 1.9438813432073007e-05, "get_actions": 6.083939327153367e-05, "normalize_and_clip_actions": 1.4480135624414774e-05, "listify_data_for_vector_env": 1.3834300779637684e-05, "remove_single_ts_time_rank_from_batch": 7.031528134889214e-07}}, "connector_pipeline_timer": 0.00014887726864815386}, "rlmodule_inference_timer": 4.531236546555183e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.159764932010404e-06, "numpy_to_tensor": 1.17551562632825e-05, "add_states_from_episodes_to_batch": 1.983670628423042e-06, "batch_individual_items": 8.326258151853435e-06, "add_time_dim_to_batch_and_zero_pad": 3.2623439252286257e-06}}, "connector_pipeline_timer": 5.9901632790934955e-05}, "env_step_timer": 2.4058145055089687e-05, "num_episodes": 20, "env_reset_timer": 0.0005780409555882215, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 5400, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "sample": 0.14508508297149092, "agent_episode_returns_mean": {"default_agent": 1.65}, "weights_seq_no": 1.0, "episode_return_min": -11.5, "episode_return_mean": 1.65, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_duration_sec_mean": 0.006644010287709534}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4db92_00000", "date": "2025-08-11_19-20-52", "timestamp": 1754932852, "time_this_iter_s": 2.5049729347229004, "time_total_s": 2.5049729347229004, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.5049729347229004, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 53.55, "ram_util_percent": 84.05000000000001}}
{"timers": {"training_iteration": 2.334757401592797, "restore_env_runners": 1.566286664456129e-05, "training_step": 2.3345991361129563, "env_runner_sampling_timer": 2.1260037308221214, "learner_update_timer": 0.2053450649988372, "synch_weights": 0.0006254983856342733, "restore_eval_env_runners": 1.3209064491093159e-05, "evaluation_iteration": 0.16202608298044652, "synch_eval_env_connectors": 0.00012845790479332209, "synch_env_connectors": 1.7708982340991497e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4945936827928033e-06, "numpy_to_tensor": 9.399238286963052e-06, "add_observations_from_episodes_to_batch": 3.0993110530966794e-06, "add_states_from_episodes_to_batch": 1.8217295990756987e-06, "batch_individual_items": 6.694748591623068e-06}}, "connector_pipeline_timer": 4.619179770499415e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3733320536978938e-05, "get_actions": 4.1675608093204754e-05, "un_batch_to_individual_items": 5.666648048998524e-06, "listify_data_for_vector_env": 1.1774823243486044e-05, "remove_single_ts_time_rank_from_batch": 5.996172330239116e-07, "normalize_and_clip_actions": 1.0087841325841548e-05}}, "connector_pipeline_timer": 0.00011041468694618812}, "episode_duration_sec_mean": 0.004827879675664007, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes_lifetime": 500.0, "weights_seq_no": 1.0, "env_step_timer": 1.4950512860904233e-05, "env_reset_timer": 5.618758449599621e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 1.6200000000000008}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": 10000.0, "module_episode_returns_mean": {"default_policy": 1.6200000000000008}, "rlmodule_inference_timer": 3.294599105324379e-05, "time_between_sampling": 0.002242623638104102, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.007174668897984042, "episode_len_min": 20, "episode_return_mean": 1.6200000000000008, "num_env_steps_sampled_lifetime_throughput": 3462.1020392730416}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.18662407994270325, "policy_loss": -0.027911582961678505, "total_loss": 0.03462845832109451, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.881858825683594, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6929256319999695, "mean_kl_loss": 0.00020176632096990943, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 12000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.0108109712600708, "weights_seq_no": 2.0, "gradients_default_optimizer_global_norm": 0.01637868583202362, "num_module_steps_trained_lifetime_throughput": 376247.40218464273}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03771616578102112, "general_advantage_estimation": 0.012989063262939452, "numpy_to_tensor": 0.0001728483149781823, "add_states_from_episodes_to_batch": 7.887259125709535e-06, "add_time_dim_to_batch_and_zero_pad": 3.922884119674563e-05, "batch_individual_items": 0.11047558078425937, "add_one_ts_to_episodes_and_truncate": 0.007726471684873104, "add_observations_from_episodes_to_batch": 0.0008102721138857305}}, "connector_pipeline_timer": 0.17030137751600705}, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1959969.294016229, "num_module_steps_trained_throughput": 375218.22882064583, "num_module_steps_trained_lifetime_throughput": 374509.06737678417}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.856957196635446e-06, "tensor_to_numpy": 1.4495993844317023e-05, "get_actions": 4.028676099728536e-05, "normalize_and_clip_actions": 1.031302774307627e-05, "listify_data_for_vector_env": 1.2713208522086791e-05, "remove_single_ts_time_rank_from_batch": 5.907277699205839e-07}}, "connector_pipeline_timer": 0.00011173081603303357}, "rlmodule_inference_timer": 3.0422290830954416e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0237788174386596e-06, "numpy_to_tensor": 9.554476567136682e-06, "add_states_from_episodes_to_batch": 1.7102781899053926e-06, "batch_individual_items": 6.807299671538396e-06, "add_time_dim_to_batch_and_zero_pad": 2.4784929110643528e-06}}, "connector_pipeline_timer": 4.688357394360502e-05}, "env_step_timer": 1.5650451921376204e-05, "num_episodes": 20, "env_reset_timer": 0.0005731809558346867, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 40, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "module_episode_returns_mean": {"default_policy": 1.15}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 10400, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "sample": 0.1448323700518813, "agent_episode_returns_mean": {"default_agent": 1.15}, "weights_seq_no": 2.0, "episode_return_min": -13.5, "episode_return_mean": 1.15, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_duration_sec_mean": 0.006051005085464567, "time_between_sampling": 1.7527182078920305}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4db92_00000", "date": "2025-08-11_19-20-54", "timestamp": 1754932854, "time_this_iter_s": 1.8280439376831055, "time_total_s": 4.333016872406006, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.333016872406006, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 53.79999999999999, "ram_util_percent": 83.03333333333335}}
{"timers": {"training_iteration": 2.3276686238277824, "restore_env_runners": 1.5584988286718726e-05, "training_step": 2.327509940582386, "env_runner_sampling_timer": 2.1199872864234375, "learner_update_timer": 0.20427128142894946, "synch_weights": 0.0006278096521040424, "restore_eval_env_runners": 1.3177803484722972e-05, "evaluation_iteration": 0.16165907257003712, "synch_eval_env_connectors": 0.00012840207549743354, "synch_env_connectors": 1.7578143160790206e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.587620525547277e-06, "numpy_to_tensor": 9.696236906464337e-06, "add_observations_from_episodes_to_batch": 3.2232226246637852e-06, "add_states_from_episodes_to_batch": 1.864192417069351e-06, "batch_individual_items": 6.901349435173267e-06}}, "connector_pipeline_timer": 4.750256533824637e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4070555026623034e-05, "get_actions": 4.282189939627994e-05, "un_batch_to_individual_items": 5.8139852160451734e-06, "listify_data_for_vector_env": 1.2018045024938279e-05, "remove_single_ts_time_rank_from_batch": 6.386778904295394e-07, "normalize_and_clip_actions": 1.0207755133588278e-05}}, "connector_pipeline_timer": 0.00011262776840152275}, "episode_duration_sec_mean": 0.004980141837149857, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes_lifetime": -30375.0, "weights_seq_no": 2.0, "env_step_timer": 1.5360816006123764e-05, "env_reset_timer": 4.8158860304324106e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -607500.0, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "rlmodule_inference_timer": 3.05437205776611e-05, "time_between_sampling": 0.0021826658928495147, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005421298274436893, "episode_len_min": 20, "episode_return_mean": 0.3400000000000001, "num_env_steps_sampled_lifetime_throughput": 3433.010298604329}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.09331203997135162, "policy_loss": -0.06263282895088196, "total_loss": 6.134508294053376e-05, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.72089958190918, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6904634833335876, "mean_kl_loss": 0.0011100023984909058, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 18000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011661171913146973, "weights_seq_no": 3.0, "gradients_default_optimizer_global_norm": 0.05247271806001663, "num_module_steps_trained_lifetime_throughput": 375609.61431898084}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03770129037308507, "general_advantage_estimation": 0.012915590129746123, "numpy_to_tensor": 0.00017177358185872435, "add_states_from_episodes_to_batch": 7.85213657654822e-06, "add_time_dim_to_batch_and_zero_pad": 3.903197336476296e-05, "batch_individual_items": 0.10968742747564102, "add_one_ts_to_episodes_and_truncate": 0.007729674877598881, "add_observations_from_episodes_to_batch": 0.0008119027322856709}}, "connector_pipeline_timer": 0.1694259304008563}, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1957006.9478057595, "num_module_steps_trained_throughput": 374613.1746547907, "num_module_steps_trained_lifetime_throughput": 373918.13824719435}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.383051514620514e-06, "tensor_to_numpy": 1.6857064424331495e-05, "get_actions": 5.36516676684236e-05, "normalize_and_clip_actions": 1.1878070770450852e-05, "listify_data_for_vector_env": 1.3764227318989831e-05, "remove_single_ts_time_rank_from_batch": 8.119311208886753e-07}}, "connector_pipeline_timer": 0.00013411175926269337}, "rlmodule_inference_timer": 3.602323260532928e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5856050783532183e-06, "numpy_to_tensor": 1.3752039560979346e-05, "add_states_from_episodes_to_batch": 2.2499092347524296e-06, "batch_individual_items": 8.349940671333642e-06, "add_time_dim_to_batch_and_zero_pad": 3.285486242976209e-06}}, "connector_pipeline_timer": 5.875185014176136e-05}, "env_step_timer": 2.01533344338117e-05, "num_episodes": 20, "env_reset_timer": 0.0005685633165761829, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 60, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 15400, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "sample": 0.14460690635076026, "agent_episode_returns_mean": {"default_agent": 1.65}, "weights_seq_no": 3.0, "episode_return_min": -13.5, "episode_return_mean": 1.65, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_duration_sec_mean": 0.005908611050108448, "time_between_sampling": 1.7516846383130178}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4db92_00000", "date": "2025-08-11_19-20-56", "timestamp": 1754932856, "time_this_iter_s": 1.7575650215148926, "time_total_s": 6.090581893920898, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.090581893920898, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 52.05, "ram_util_percent": 82.1}}
{"timers": {"training_iteration": 2.322139737590448, "restore_env_runners": 1.550705867120996e-05, "training_step": 2.321980350337012, "env_runner_sampling_timer": 2.1150755493990623, "learner_update_timer": 0.2036373090352529, "synch_weights": 0.0006309903051380533, "restore_eval_env_runners": 1.3124355499166996e-05, "evaluation_iteration": 0.16133784059367612, "synch_eval_env_connectors": 0.00012821638557361438, "synch_env_connectors": 1.7453612410463392e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.584276912694147e-06, "numpy_to_tensor": 9.720380581560217e-06, "add_observations_from_episodes_to_batch": 3.296104324148916e-06, "add_states_from_episodes_to_batch": 1.883448716473966e-06, "batch_individual_items": 6.970283005425997e-06}}, "connector_pipeline_timer": 4.779308285140634e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4419564007217456e-05, "get_actions": 4.369317287063215e-05, "un_batch_to_individual_items": 5.824988603306262e-06, "listify_data_for_vector_env": 1.2320764207712325e-05, "remove_single_ts_time_rank_from_batch": 6.252197099319192e-07, "normalize_and_clip_actions": 1.035977920512696e-05}}, "connector_pipeline_timer": 0.00011484952502487611}, "episode_duration_sec_mean": 0.005035263682715596, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes_lifetime": -61250.0, "weights_seq_no": 3.0, "env_step_timer": 1.554223740636716e-05, "env_reset_timer": 4.73550699577933e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 1.94}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -1225000.0, "module_episode_returns_mean": {"default_policy": 1.94}, "rlmodule_inference_timer": 3.0549089794133285e-05, "time_between_sampling": 0.002011939349026815, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005257091888783728, "episode_len_min": 20, "episode_return_mean": 1.94, "num_env_steps_sampled_lifetime_throughput": 3454.9619410129408}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.04665601998567581, "policy_loss": -0.004411409143358469, "total_loss": 0.0583021305501461, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.880634307861328, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6837658882141113, "mean_kl_loss": 0.0017774610314518213, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 24000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011780023574829102, "weights_seq_no": 4.0, "gradients_default_optimizer_global_norm": 0.08418809622526169, "num_module_steps_trained_lifetime_throughput": 373606.2088683354}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03783315496931458, "general_advantage_estimation": 0.01285339089777367, "numpy_to_tensor": 0.00017082709638308733, "add_states_from_episodes_to_batch": 7.819864689838141e-06, "add_time_dim_to_batch_and_zero_pad": 3.879540334665217e-05, "batch_individual_items": 0.10903857445166155, "add_one_ts_to_episodes_and_truncate": 0.007781146038305014, "add_observations_from_episodes_to_batch": 0.000819400375679368}}, "connector_pipeline_timer": 0.16890240567722112}, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1947150.7868718111, "num_module_steps_trained_throughput": 372666.19805415784, "num_module_steps_trained_lifetime_throughput": 371992.98299044784}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.368361622474243e-06, "tensor_to_numpy": 2.7419037368002596e-05, "get_actions": 7.899219564752687e-05, "normalize_and_clip_actions": 1.7114300076020553e-05, "listify_data_for_vector_env": 2.0744372809178477e-05, "remove_single_ts_time_rank_from_batch": 8.537420958939053e-07}}, "connector_pipeline_timer": 0.00020179220641704248}, "rlmodule_inference_timer": 4.9756989832942833e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.675345957394664e-06, "numpy_to_tensor": 1.6430511178745854e-05, "add_states_from_episodes_to_batch": 2.71381238033338e-06, "batch_individual_items": 1.1628286750854565e-05, "add_time_dim_to_batch_and_zero_pad": 4.516936842326309e-06}}, "connector_pipeline_timer": 7.56027891556587e-05}, "env_step_timer": 2.922100802698956e-05, "num_episodes": 20, "env_reset_timer": 0.0005638018534276635, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 80, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "module_episode_returns_mean": {"default_policy": 0.15}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 20400, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "sample": 0.14487471353768547, "agent_episode_returns_mean": {"default_agent": 0.15}, "weights_seq_no": 4.0, "episode_return_min": -13.5, "episode_return_mean": 0.15, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_duration_sec_mean": 0.006402464586426504, "time_between_sampling": 1.7521631394292694}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4db92_00000", "date": "2025-08-11_19-20-58", "timestamp": 1754932858, "time_this_iter_s": 1.956770896911621, "time_total_s": 8.04735279083252, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.04735279083252, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 50.199999999999996, "ram_util_percent": 82.03333333333335}}
{"timers": {"training_iteration": 2.316936589384234, "restore_env_runners": 1.543490838992875e-05, "training_step": 2.3167768772436697, "env_runner_sampling_timer": 2.110908817243954, "learner_update_timer": 0.20259973427544764, "synch_weights": 0.0006330691528074419, "restore_eval_env_runners": 1.3163942115730607e-05, "evaluation_iteration": 0.16151650176791688, "synch_eval_env_connectors": 0.00012865630235092248, "synch_env_connectors": 1.7340327043784784e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6165417084008198e-06, "numpy_to_tensor": 9.915917206002712e-06, "add_observations_from_episodes_to_batch": 3.1889296318394635e-06, "add_states_from_episodes_to_batch": 1.8795868239805939e-06, "batch_individual_items": 7.005101240615853e-06}}, "connector_pipeline_timer": 4.799435671512429e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4317878465680288e-05, "get_actions": 4.419121044169306e-05, "un_batch_to_individual_items": 5.904722977621044e-06, "listify_data_for_vector_env": 1.2250618320821456e-05, "remove_single_ts_time_rank_from_batch": 6.308532059584608e-07, "normalize_and_clip_actions": 1.0552571486232926e-05}}, "connector_pipeline_timer": 0.0001158726011171199}, "episode_duration_sec_mean": 0.005653129523154347, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes_lifetime": -92125.0, "weights_seq_no": 4.0, "env_step_timer": 1.570631543191911e-05, "env_reset_timer": 5.044769576046609e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -1842500.0, "module_episode_returns_mean": {"default_policy": 3.7}, "rlmodule_inference_timer": 6.252488708162943e-05, "time_between_sampling": 0.0022117300603311085, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.0057090063298708745, "episode_len_min": 20, "episode_return_mean": 3.7, "num_env_steps_sampled_lifetime_throughput": 3335.178046808021}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.023328009992837906, "policy_loss": 0.17475159466266632, "total_loss": 0.23743394017219543, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.88611602783203, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6739362478256226, "mean_kl_loss": 0.0009778609964996576, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 30000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.012585759162902832, "weights_seq_no": 5.0, "gradients_default_optimizer_global_norm": 0.03668160364031792, "num_module_steps_trained_lifetime_throughput": 372011.6749896676}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0378031392499639, "general_advantage_estimation": 0.012795506568661791, "numpy_to_tensor": 0.00017023549515605903, "add_states_from_episodes_to_batch": 7.773326353863814e-06, "add_time_dim_to_batch_and_zero_pad": 3.8630779302425225e-05, "batch_individual_items": 0.10826988661769406, "add_one_ts_to_episodes_and_truncate": 0.007784892498124577, "add_observations_from_episodes_to_batch": 0.0008192897012257644}}, "connector_pipeline_timer": 0.16804628495089607}, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1939462.54303009, "num_module_steps_trained_throughput": 371131.9393847277, "num_module_steps_trained_lifetime_throughput": 370481.01762614696}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.856885824564849e-06, "tensor_to_numpy": 1.4148772210846403e-05, "get_actions": 4.6436495639891346e-05, "normalize_and_clip_actions": 1.0316757976907535e-05, "listify_data_for_vector_env": 1.1961884311388e-05, "remove_single_ts_time_rank_from_batch": 5.86563811587459e-07}}, "connector_pipeline_timer": 0.0001163390532687913}, "rlmodule_inference_timer": 2.948365914980162e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9376736777770036e-06, "numpy_to_tensor": 9.055653246371115e-06, "add_states_from_episodes_to_batch": 1.8503177343901233e-06, "batch_individual_items": 6.654084711754536e-06, "add_time_dim_to_batch_and_zero_pad": 2.4126971075996485e-06}}, "connector_pipeline_timer": 4.529550777735087e-05}, "env_step_timer": 1.5681757126970146e-05, "num_episodes": 20, "env_reset_timer": 0.0005594955051031523, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 100, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 25400, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "sample": 0.1444848418224394, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 5.0, "episode_return_min": -13.5, "episode_return_mean": 0.05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_duration_sec_mean": 0.006085816267877817, "time_between_sampling": 1.7529197513752957}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-00", "timestamp": 1754932860, "time_this_iter_s": 1.9165318012237549, "time_total_s": 9.963884592056274, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.963884592056274, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 53.599999999999994, "ram_util_percent": 82.66666666666667}}
{"timers": {"training_iteration": 2.312045168489673, "restore_env_runners": 1.5349728633646154e-05, "training_step": 2.3118848955611844, "env_runner_sampling_timer": 2.10590122157168, "learner_update_timer": 0.20269466860276286, "synch_weights": 0.0006337355413335016, "restore_eval_env_runners": 1.3096471984117527e-05, "evaluation_iteration": 0.1610267142495033, "synch_eval_env_connectors": 0.0001284751598516677, "synch_env_connectors": 1.726276385119418e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.647929054900583e-06, "numpy_to_tensor": 1.0320528581088138e-05, "add_observations_from_episodes_to_batch": 3.283077059797834e-06, "add_states_from_episodes_to_batch": 1.9727126085647755e-06, "batch_individual_items": 7.470860108551032e-06}}, "connector_pipeline_timer": 4.977436135445226e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5322237817478075e-05, "get_actions": 4.6324816923604696e-05, "un_batch_to_individual_items": 6.195234247630391e-06, "listify_data_for_vector_env": 1.2663695963479401e-05, "remove_single_ts_time_rank_from_batch": 6.507142930217917e-07, "normalize_and_clip_actions": 1.0651968601200786e-05}}, "connector_pipeline_timer": 0.00012033224919151219}, "episode_duration_sec_mean": 0.005242262862622737, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes_lifetime": -123000.0, "weights_seq_no": 5.0, "env_step_timer": 1.6167554236483842e-05, "env_reset_timer": 4.876332439525367e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 3.06}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -2460000.0, "module_episode_returns_mean": {"default_policy": 3.06}, "rlmodule_inference_timer": 3.264269068673704e-05, "time_between_sampling": 0.0017444371481146813, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005981121898702496, "episode_len_min": 20, "episode_return_mean": 3.06, "num_env_steps_sampled_lifetime_throughput": 3262.2467340474045}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.011664004996418953, "policy_loss": -0.1344889998435974, "total_loss": -0.0718490481376648, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.362754821777344, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6738317012786865, "mean_kl_loss": 9.713070176076144e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 36000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011776924133300781, "weights_seq_no": 6.0, "gradients_default_optimizer_global_norm": 0.07187046110630035, "num_module_steps_trained_lifetime_throughput": 370731.0821789078}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03789491118795277, "general_advantage_estimation": 0.012729273173183672, "numpy_to_tensor": 0.00016918730001675512, "add_states_from_episodes_to_batch": 7.732672534480273e-06, "add_time_dim_to_batch_and_zero_pad": 3.8422380896676544e-05, "batch_individual_items": 0.10851556691177604, "add_one_ts_to_episodes_and_truncate": 0.007786535662714762, "add_observations_from_episodes_to_batch": 0.0008196555539004333}}, "connector_pipeline_timer": 0.16831578460117141}, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1933428.4093503826, "num_module_steps_trained_throughput": 369913.29719144676, "num_module_steps_trained_lifetime_throughput": 369284.53454303043}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.254815108656318e-06, "tensor_to_numpy": 1.5980674629056225e-05, "get_actions": 4.8265051730368415e-05, "normalize_and_clip_actions": 1.1567301215364642e-05, "listify_data_for_vector_env": 1.3499785593898406e-05, "remove_single_ts_time_rank_from_batch": 6.897075361399099e-07}}, "connector_pipeline_timer": 0.00012790991590391778}, "rlmodule_inference_timer": 3.554710902978267e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.863959470060113e-06, "numpy_to_tensor": 1.2008529538344032e-05, "add_states_from_episodes_to_batch": 2.1552888492057553e-06, "batch_individual_items": 8.32246880921814e-06, "add_time_dim_to_batch_and_zero_pad": 3.2743082611021767e-06}}, "connector_pipeline_timer": 5.6695582288983536e-05}, "env_step_timer": 1.869155514992643e-05, "num_episodes": 20, "env_reset_timer": 0.0005546634697146409, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 120, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 30400, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "sample": 0.14433218881398419, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 6.0, "episode_return_min": -13.5, "episode_return_mean": 0.05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_duration_sec_mean": 0.005930483778938651, "time_between_sampling": 1.7539068713615769}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-02", "timestamp": 1754932862, "time_this_iter_s": 1.9669578075408936, "time_total_s": 11.930842399597168, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.930842399597168, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.5, "ram_util_percent": 83.56666666666666}}
{"timers": {"training_iteration": 2.305706588895427, "restore_env_runners": 1.526331218405281e-05, "training_step": 2.3055461066055916, "env_runner_sampling_timer": 2.100578336436126, "learner_update_timer": 0.20167909858636565, "synch_weights": 0.0006338298553826389, "restore_eval_env_runners": 1.3065506861572471e-05, "evaluation_iteration": 0.1607746421066379, "synch_eval_env_connectors": 0.00013166498830825374, "synch_env_connectors": 1.7132226172288764e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6841821394596087e-06, "numpy_to_tensor": 1.00611906010723e-05, "add_observations_from_episodes_to_batch": 3.2789697346543185e-06, "add_states_from_episodes_to_batch": 1.9091808262345756e-06, "batch_individual_items": 7.296343446965575e-06}}, "connector_pipeline_timer": 4.90786991853e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4714313737107657e-05, "get_actions": 4.432943788301123e-05, "un_batch_to_individual_items": 6.040346413607543e-06, "listify_data_for_vector_env": 1.2444062898053583e-05, "remove_single_ts_time_rank_from_batch": 6.457591990292496e-07, "normalize_and_clip_actions": 1.0635341983605369e-05}}, "connector_pipeline_timer": 0.00011693014329090091}, "episode_duration_sec_mean": 0.0051547386785969155, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes_lifetime": -153875.0, "weights_seq_no": 6.0, "env_step_timer": 1.592287058574518e-05, "env_reset_timer": 5.026795371017338e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 4.5}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -3077500.0, "module_episode_returns_mean": {"default_policy": 4.5}, "rlmodule_inference_timer": 3.200231373256884e-05, "time_between_sampling": 0.002230933146914205, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005611267840439895, "episode_len_min": 20, "episode_return_mean": 4.5, "num_env_steps_sampled_lifetime_throughput": 3358.1326155452184}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.0058320024982094765, "policy_loss": -0.04945483058691025, "total_loss": 0.013212400488555431, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.43939208984375, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6708225607872009, "mean_kl_loss": 0.0001997690269490704, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 42000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.012065649032592773, "weights_seq_no": 7.0, "gradients_default_optimizer_global_norm": 0.118752621114254, "num_module_steps_trained_lifetime_throughput": 369850.41898784146}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03787879957577931, "general_advantage_estimation": 0.012658541690527292, "numpy_to_tensor": 0.00016825042694476396, "add_states_from_episodes_to_batch": 7.716176307249699e-06, "add_time_dim_to_batch_and_zero_pad": 3.8387747642543195e-05, "batch_individual_items": 0.1077646041633673, "add_one_ts_to_episodes_and_truncate": 0.007789698646006317, "add_observations_from_episodes_to_batch": 0.0008198523276968056}}, "connector_pipeline_timer": 0.1674780813441578}, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1929494.1522550262, "num_module_steps_trained_throughput": 369095.10492167843, "num_module_steps_trained_lifetime_throughput": 368488.9065446284}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.162529614505437e-06, "tensor_to_numpy": 1.4055269521066747e-05, "get_actions": 4.257635479893678e-05, "normalize_and_clip_actions": 1.0109305467991628e-05, "listify_data_for_vector_env": 1.138279841964456e-05, "remove_single_ts_time_rank_from_batch": 6.364905182303079e-07}}, "connector_pipeline_timer": 0.00011460774475030779}, "rlmodule_inference_timer": 2.988874891679216e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.897751009811165e-06, "numpy_to_tensor": 8.943115754075725e-06, "add_states_from_episodes_to_batch": 1.7794689133941584e-06, "batch_individual_items": 7.0314674397134885e-06, "add_time_dim_to_batch_and_zero_pad": 2.4565752161907508e-06}}, "connector_pipeline_timer": 4.6079638368643005e-05}, "env_step_timer": 1.606117129699251e-05, "num_episodes": 20, "env_reset_timer": 0.0005505372556120079, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 140, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 35400, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "sample": 0.14389630567608344, "agent_episode_returns_mean": {"default_agent": -0.15}, "weights_seq_no": 7.0, "episode_return_min": -13.5, "episode_return_mean": -0.15, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_duration_sec_mean": 0.005759749631397426, "time_between_sampling": 1.7534231468081416}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-03", "timestamp": 1754932863, "time_this_iter_s": 1.7884328365325928, "time_total_s": 13.71927523612976, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.71927523612976, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 52.4, "ram_util_percent": 83.5}}
{"timers": {"training_iteration": 2.300267129257042, "restore_env_runners": 1.5177758734802179e-05, "training_step": 2.300106254709706, "env_runner_sampling_timer": 2.096141585981812, "learner_update_timer": 0.20067445260077907, "synch_weights": 0.0006350340566355445, "restore_eval_env_runners": 1.3013181842248e-05, "evaluation_iteration": 0.1602469131851972, "synch_eval_env_connectors": 0.00013140041861311777, "synch_env_connectors": 1.701007425004592e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5220681991076273e-06, "numpy_to_tensor": 9.331804297674386e-06, "add_observations_from_episodes_to_batch": 3.2299097356478617e-06, "add_states_from_episodes_to_batch": 1.8256633629223306e-06, "batch_individual_items": 6.84005454530476e-06}}, "connector_pipeline_timer": 4.661967739593916e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3931476019461026e-05, "get_actions": 4.155149936646426e-05, "un_batch_to_individual_items": 5.699230456322492e-06, "listify_data_for_vector_env": 1.1766101232393339e-05, "remove_single_ts_time_rank_from_batch": 6.07334517571909e-07, "normalize_and_clip_actions": 1.0029549554705297e-05}}, "connector_pipeline_timer": 0.00011036434173549925}, "episode_duration_sec_mean": 0.005570939344819637, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes_lifetime": -184750.0, "weights_seq_no": 7.0, "env_step_timer": 1.48178288585116e-05, "env_reset_timer": 4.596145790541385e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -3695000.0, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "rlmodule_inference_timer": 6.23003062839419e-05, "time_between_sampling": 0.001677056059611464, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005851928515847481, "episode_len_min": 20, "episode_return_mean": 3.4599999999999995, "num_env_steps_sampled_lifetime_throughput": 3485.466834639785}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.0029160012491047382, "policy_loss": -0.044244833290576935, "total_loss": 0.018546825274825096, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.270179748535156, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6574549674987793, "mean_kl_loss": 0.0009722818504087627, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 48000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.013218998908996582, "weights_seq_no": 8.0, "gradients_default_optimizer_global_norm": 0.023772811517119408, "num_module_steps_trained_lifetime_throughput": 368510.65638298413}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.037844148240008785, "general_advantage_estimation": 0.012591966273055552, "numpy_to_tensor": 0.00016726000245035168, "add_states_from_episodes_to_batch": 7.66984481385663e-06, "add_time_dim_to_batch_and_zero_pad": 3.809845063018284e-05, "batch_individual_items": 0.10702329896100972, "add_one_ts_to_episodes_and_truncate": 0.007788294159339203, "add_observations_from_episodes_to_batch": 0.0008221842245331925}}, "connector_pipeline_timer": 0.16663272720139602}, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1923121.4452288237, "num_module_steps_trained_throughput": 367812.4956017856, "num_module_steps_trained_lifetime_throughput": 367229.6398661688}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.88020350392314e-06, "tensor_to_numpy": 1.3902164538437457e-05, "get_actions": 4.177219436251753e-05, "normalize_and_clip_actions": 1.0055294079649719e-05, "listify_data_for_vector_env": 1.1510733562768345e-05, "remove_single_ts_time_rank_from_batch": 5.946380207539342e-07}}, "connector_pipeline_timer": 0.00011146156474477649}, "rlmodule_inference_timer": 2.9960967214699145e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4873067447116347e-06, "numpy_to_tensor": 1.0008269197145118e-05, "add_states_from_episodes_to_batch": 1.7095869842617926e-06, "batch_individual_items": 6.893650864436821e-06, "add_time_dim_to_batch_and_zero_pad": 2.4313078717770487e-06}}, "connector_pipeline_timer": 4.735386946258068e-05}, "env_step_timer": 1.5050932269661336e-05, "num_episodes": 20, "env_reset_timer": 0.0005457281328277511, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 160, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 40400, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "sample": 0.14350909929025396, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 8.0, "episode_return_min": -13.5, "episode_return_mean": 0.05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_duration_sec_mean": 0.005597803388955071, "time_between_sampling": 1.7537230015905738}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-05", "timestamp": 1754932865, "time_this_iter_s": 1.8751890659332275, "time_total_s": 15.594464302062988, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.594464302062988, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.833333333333336, "ram_util_percent": 83.66666666666667}}
{"timers": {"training_iteration": 2.294428174214105, "restore_env_runners": 1.5093901338667644e-05, "training_step": 2.294266961333389, "env_runner_sampling_timer": 2.0902641963718183, "learner_update_timer": 0.200713206824711, "synch_weights": 0.0006361153756838563, "restore_eval_env_runners": 1.2960970291183942e-05, "evaluation_iteration": 0.15975502364365837, "synch_eval_env_connectors": 0.00013104475350533845, "synch_env_connectors": 1.6886644410065877e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.545431936199607e-06, "numpy_to_tensor": 9.459203324652527e-06, "add_observations_from_episodes_to_batch": 3.2234400374506683e-06, "add_states_from_episodes_to_batch": 1.866908592894513e-06, "batch_individual_items": 6.8652233528865554e-06}}, "connector_pipeline_timer": 4.728305608649784e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4128642304342703e-05, "get_actions": 4.275411279534554e-05, "un_batch_to_individual_items": 5.957310142038692e-06, "listify_data_for_vector_env": 1.2136440197337156e-05, "remove_single_ts_time_rank_from_batch": 6.244390870190785e-07, "normalize_and_clip_actions": 1.0194824728510085e-05}}, "connector_pipeline_timer": 0.00011331560883383904}, "episode_duration_sec_mean": 0.004957360480446369, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes_lifetime": -215625.0, "weights_seq_no": 8.0, "env_step_timer": 1.521339844589283e-05, "env_reset_timer": 4.530586726714055e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -4312500.0, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "rlmodule_inference_timer": 3.0386228767165296e-05, "time_between_sampling": 0.0016345216958834085, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005453755770533714, "episode_len_min": 20, "episode_return_mean": 5.460000000000001, "num_env_steps_sampled_lifetime_throughput": 3500.956101141312}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.0014580006245523691, "policy_loss": -0.10784247517585754, "total_loss": -0.044999025762081146, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.713878631591797, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6512721180915833, "mean_kl_loss": 0.0005018218071199954, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 54000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.012197732925415039, "weights_seq_no": 9.0, "gradients_default_optimizer_global_norm": 0.04388493672013283, "num_module_steps_trained_lifetime_throughput": 367182.3054200616}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03782185634725158, "general_advantage_estimation": 0.012523767860084195, "numpy_to_tensor": 0.00016632032185993366, "add_states_from_episodes_to_batch": 7.625646031112489e-06, "add_time_dim_to_batch_and_zero_pad": 3.782496636036244e-05, "batch_individual_items": 0.10626220472112574, "add_one_ts_to_episodes_and_truncate": 0.008846390797740265, "add_observations_from_episodes_to_batch": 0.0008227015431273288}}, "connector_pipeline_timer": 0.16683613867977462}, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1916806.5473429787, "num_module_steps_trained_throughput": 366543.60641558084, "num_module_steps_trained_lifetime_throughput": 365983.0737566253}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.3452017656016225e-06, "tensor_to_numpy": 1.2565439706261799e-05, "get_actions": 3.41397655265078e-05, "normalize_and_clip_actions": 9.193334539212148e-06, "listify_data_for_vector_env": 1.0690492971538771e-05, "remove_single_ts_time_rank_from_batch": 5.563429606899753e-07}}, "connector_pipeline_timer": 9.766657857669076e-05}, "rlmodule_inference_timer": 2.6110622820004408e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7555422676153134e-06, "numpy_to_tensor": 8.169913086021276e-06, "add_states_from_episodes_to_batch": 1.6127216949004133e-06, "batch_individual_items": 5.986259890545639e-06, "add_time_dim_to_batch_and_zero_pad": 2.239867176479042e-06}}, "connector_pipeline_timer": 4.222735472467381e-05}, "env_step_timer": 1.3558152725151663e-05, "num_episodes": 20, "env_reset_timer": 0.0005436896016291136, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 180, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 45400, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "sample": 0.14304882288765092, "agent_episode_returns_mean": {"default_agent": 0.65}, "weights_seq_no": 9.0, "episode_return_min": -13.5, "episode_return_mean": 0.65, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004907107969047502, "time_between_sampling": 1.7535866374146951}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-07", "timestamp": 1754932867, "time_this_iter_s": 1.8245360851287842, "time_total_s": 17.419000387191772, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.419000387191772, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 50.45, "ram_util_percent": 83.5}}
{"timers": {"training_iteration": 2.287658707892491, "restore_env_runners": 1.5010882516494455e-05, "training_step": 2.2874974179705605, "env_runner_sampling_timer": 2.0835746581578896, "learner_update_timer": 0.20063638559671665, "synch_weights": 0.00063536506208928, "restore_eval_env_runners": 1.2894271428187378e-05, "evaluation_iteration": 0.15921734006656502, "synch_eval_env_connectors": 0.00013063930587648223, "synch_env_connectors": 1.675944883041317e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4129353412147584e-06, "numpy_to_tensor": 8.976820292169698e-06, "add_observations_from_episodes_to_batch": 3.0729878428436874e-06, "add_states_from_episodes_to_batch": 1.787939314025283e-06, "batch_individual_items": 6.4992629145806535e-06}}, "connector_pipeline_timer": 4.495924602079636e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3356321150063859e-05, "get_actions": 3.9863551943384925e-05, "un_batch_to_individual_items": 5.460703537617318e-06, "listify_data_for_vector_env": 1.1437035755663256e-05, "remove_single_ts_time_rank_from_batch": 5.934782353543018e-07, "normalize_and_clip_actions": 9.649888890033674e-06}}, "connector_pipeline_timer": 0.00010648877373881847}, "episode_duration_sec_mean": 0.004659015319775792, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes_lifetime": -246500.0, "weights_seq_no": 9.0, "env_step_timer": 1.4118561288637245e-05, "env_reset_timer": 4.1219741134658005e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -4930000.0, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "rlmodule_inference_timer": 2.8427222600432123e-05, "time_between_sampling": 0.0020049850864299946, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.00512973266672889, "episode_len_min": 20, "episode_return_mean": 6.659999999999997, "num_env_steps_sampled_lifetime_throughput": 3628.6334091634135}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.0007290003122761846, "policy_loss": -0.08268185704946518, "total_loss": -0.019771618768572807, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.858129501342773, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6437965035438538, "mean_kl_loss": 0.00037937649176456034, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 60000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.01230764389038086, "weights_seq_no": 10.0, "gradients_default_optimizer_global_norm": 0.04102873429656029, "num_module_steps_trained_lifetime_throughput": 366243.7174201001}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03778822070327611, "general_advantage_estimation": 0.01245353935122023, "numpy_to_tensor": 0.00016540628849019364, "add_states_from_episodes_to_batch": 7.581890400349007e-06, "add_time_dim_to_batch_and_zero_pad": 3.765546683109279e-05, "batch_individual_items": 0.10648059892289129, "add_one_ts_to_episodes_and_truncate": 0.008837054389829397, "add_observations_from_episodes_to_batch": 0.0008229274477063689}}, "connector_pipeline_timer": 0.16693801229268942}, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1912529.677775097, "num_module_steps_trained_throughput": 365666.9868298503, "num_module_steps_trained_lifetime_throughput": 365126.7649300224}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.375837704444592e-06, "tensor_to_numpy": 1.272276352164047e-05, "get_actions": 3.4230480708052915e-05, "normalize_and_clip_actions": 9.264058094218536e-06, "listify_data_for_vector_env": 1.0763054865628447e-05, "remove_single_ts_time_rank_from_batch": 5.716234914488456e-07}}, "connector_pipeline_timer": 9.834206237559658e-05}, "rlmodule_inference_timer": 2.636998492175444e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7527587577829074e-06, "numpy_to_tensor": 8.228215372681398e-06, "add_states_from_episodes_to_batch": 1.6443380851472692e-06, "batch_individual_items": 5.982068833548292e-06, "add_time_dim_to_batch_and_zero_pad": 2.24176259178978e-06}}, "connector_pipeline_timer": 4.258383768070746e-05}, "env_step_timer": 1.3567410684790046e-05, "num_episodes": 20, "env_reset_timer": 0.000538938535049229, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 200, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 50400, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "sample": 0.14257871840810854, "agent_episode_returns_mean": {"default_agent": 0.85}, "weights_seq_no": 10.0, "episode_return_min": -13.5, "episode_return_mean": 0.85, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004825650857528671, "time_between_sampling": 1.752521075620255}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-09", "timestamp": 1754932869, "time_this_iter_s": 1.7212870121002197, "time_total_s": 19.140287399291992, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.140287399291992, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 48.53333333333333, "ram_util_percent": 83.83333333333333}}
{"timers": {"training_iteration": 2.2804153424838525, "restore_env_runners": 1.4922433066535146e-05, "training_step": 2.2802539608719106, "env_runner_sampling_timer": 2.0773918553271544, "learner_update_timer": 0.1995774125704281, "synch_weights": 0.0006344110008952027, "restore_eval_env_runners": 1.2832828645807198e-05, "evaluation_iteration": 0.15864026749543547, "synch_eval_env_connectors": 0.00013021916287218115, "synch_env_connectors": 1.6641434463521914e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.473038559841998e-06, "numpy_to_tensor": 9.832804010336256e-06, "add_observations_from_episodes_to_batch": 3.1353183901145844e-06, "add_states_from_episodes_to_batch": 1.8590538835593111e-06, "batch_individual_items": 6.643500150612892e-06}}, "connector_pipeline_timer": 4.692869937205115e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3860471066801102e-05, "get_actions": 4.176972131976886e-05, "un_batch_to_individual_items": 5.660668088978647e-06, "listify_data_for_vector_env": 1.1591916998651828e-05, "remove_single_ts_time_rank_from_batch": 6.284461613582325e-07, "normalize_and_clip_actions": 9.826423883121056e-06}}, "connector_pipeline_timer": 0.0001104774771262638}, "episode_duration_sec_mean": 0.004860822963528336, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes_lifetime": -277375.0, "weights_seq_no": 10.0, "env_step_timer": 1.4633665499361306e-05, "env_reset_timer": 3.770462155455486e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -5547500.0, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "rlmodule_inference_timer": 2.999992091129453e-05, "time_between_sampling": 0.0019205150752263384, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005167583924259991, "episode_len_min": 20, "episode_return_mean": 5.940000000000001, "num_env_steps_sampled_lifetime_throughput": 3671.6692398892064}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.0003645001561380923, "policy_loss": -0.03828921541571617, "total_loss": 0.024718768894672394, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.646411895751953, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6329572796821594, "mean_kl_loss": 0.00017876990023069084, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 66000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.014516830444335938, "weights_seq_no": 11.0, "gradients_default_optimizer_global_norm": 0.044992342591285706, "num_module_steps_trained_lifetime_throughput": 365831.00831546966}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0377546368256805, "general_advantage_estimation": 0.012383090207728218, "numpy_to_tensor": 0.00016435931521047414, "add_states_from_episodes_to_batch": 7.533991382979271e-06, "add_time_dim_to_batch_and_zero_pad": 3.737516202256194e-05, "batch_individual_items": 0.10572145710279882, "add_one_ts_to_episodes_and_truncate": 0.008825058846575579, "add_observations_from_episodes_to_batch": 0.0008227527526046169}}, "connector_pipeline_timer": 0.166058722999595}, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1910972.4531573916, "num_module_steps_trained_throughput": 365311.76633247576, "num_module_steps_trained_lifetime_throughput": 364791.067600641}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.338115989005059e-06, "tensor_to_numpy": 1.2684831915906242e-05, "get_actions": 3.436612732729979e-05, "normalize_and_clip_actions": 9.214831959345093e-06, "listify_data_for_vector_env": 1.071643390695514e-05, "remove_single_ts_time_rank_from_batch": 5.615905898161106e-07}}, "connector_pipeline_timer": 9.799947287900036e-05}, "rlmodule_inference_timer": 2.5990578067406134e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.787219148187727e-06, "numpy_to_tensor": 8.185932076216428e-06, "add_states_from_episodes_to_batch": 1.6000390361485057e-06, "batch_individual_items": 5.9553044645835105e-06, "add_time_dim_to_batch_and_zero_pad": 2.254718560936961e-06}}, "connector_pipeline_timer": 4.2195015739108366e-05}, "env_step_timer": 1.3522111652879007e-05, "num_episodes": 20, "env_reset_timer": 0.0005343491499695653, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 220, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 55400, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "sample": 0.1421112937239779, "agent_episode_returns_mean": {"default_agent": 0.65}, "weights_seq_no": 11.0, "episode_return_min": -13.5, "episode_return_mean": 0.65, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004532118400093168, "time_between_sampling": 1.7508117552733375}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-11", "timestamp": 1754932871, "time_this_iter_s": 1.6670308113098145, "time_total_s": 20.807318210601807, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.807318210601807, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.65, "ram_util_percent": 83.55}}
{"timers": {"training_iteration": 2.2730938390589177, "restore_env_runners": 1.4827368636043339e-05, "training_step": 2.272932472514018, "env_runner_sampling_timer": 2.0711382013537976, "learner_update_timer": 0.19851167594552624, "synch_weights": 0.0006338189800867921, "restore_eval_env_runners": 1.2775340246834033e-05, "evaluation_iteration": 0.1580672952414889, "synch_eval_env_connectors": 0.0001299273910443369, "synch_env_connectors": 1.651502042346643e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3661099996499687e-06, "numpy_to_tensor": 8.577155162444253e-06, "add_observations_from_episodes_to_batch": 2.998374735951238e-06, "add_states_from_episodes_to_batch": 1.7454008747231726e-06, "batch_individual_items": 6.28062260671961e-06}}, "connector_pipeline_timer": 4.386818545692468e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2819697370935813e-05, "get_actions": 3.7720372470253884e-05, "un_batch_to_individual_items": 5.386523781939649e-06, "listify_data_for_vector_env": 1.0948751854580189e-05, "remove_single_ts_time_rank_from_batch": 5.739995705794836e-07, "normalize_and_clip_actions": 9.432795917434496e-06}}, "connector_pipeline_timer": 0.00010243493062644005}, "episode_duration_sec_mean": 0.00451144232833758, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes_lifetime": -308250.0, "weights_seq_no": 11.0, "env_step_timer": 1.3755088082341545e-05, "env_reset_timer": 3.518236811052938e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -6165000.0, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "rlmodule_inference_timer": 2.7203865204289757e-05, "time_between_sampling": 0.001818919772071143, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.0048831876159831965, "episode_len_min": 20, "episode_return_mean": 6.659999999999997, "num_env_steps_sampled_lifetime_throughput": 3737.901237181825}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 0.00018225007806904614, "policy_loss": 0.05211615562438965, "total_loss": 0.11514448374509811, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.652629852294922, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6306999921798706, "mean_kl_loss": 3.76364951080177e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 72000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.015211820602416992, "weights_seq_no": 12.0, "gradients_default_optimizer_global_norm": 0.04603158310055733, "num_module_steps_trained_lifetime_throughput": 366107.5971200244}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03771812795760772, "general_advantage_estimation": 0.012315922224883556, "numpy_to_tensor": 0.0001632819720045017, "add_states_from_episodes_to_batch": 7.489901998140701e-06, "add_time_dim_to_batch_and_zero_pad": 3.708141101149579e-05, "batch_individual_items": 0.1049685546126142, "add_one_ts_to_episodes_and_truncate": 0.008813077837695466, "add_observations_from_episodes_to_batch": 0.0008225264745949536}}, "connector_pipeline_timer": 0.165185956189827}, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1913020.5787104813, "num_module_steps_trained_throughput": 365646.69185070327, "num_module_steps_trained_lifetime_throughput": 365143.9187225298}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.3182836131448114e-06, "tensor_to_numpy": 1.2619311794165147e-05, "get_actions": 3.462818707986804e-05, "normalize_and_clip_actions": 9.197622644949958e-06, "listify_data_for_vector_env": 1.0722985145738965e-05, "remove_single_ts_time_rank_from_batch": 5.676850035959654e-07}}, "connector_pipeline_timer": 9.825332554046164e-05}, "rlmodule_inference_timer": 2.6438838680666575e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7556667954730138e-06, "numpy_to_tensor": 8.273146171354897e-06, "add_states_from_episodes_to_batch": 1.6251971257949976e-06, "batch_individual_items": 5.999916527225064e-06, "add_time_dim_to_batch_and_zero_pad": 2.258424446692722e-06}}, "connector_pipeline_timer": 4.224176242013895e-05}, "env_step_timer": 1.3750374440481886e-05, "num_episodes": 20, "env_reset_timer": 0.000530294408678784, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 240, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 60400, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "sample": 0.14166518578710216, "agent_episode_returns_mean": {"default_agent": 0.85}, "weights_seq_no": 12.0, "episode_return_min": -13.5, "episode_return_mean": 0.85, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004499776300508529, "time_between_sampling": 1.748965693130816}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-12", "timestamp": 1754932872, "time_this_iter_s": 1.653937816619873, "time_total_s": 22.46125602722168, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.46125602722168, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.833333333333336, "ram_util_percent": 83.26666666666667}}
{"timers": {"training_iteration": 2.265856283997923, "restore_env_runners": 1.4745344581028177e-05, "training_step": 2.265694708208201, "env_runner_sampling_timer": 2.0649313522602233, "learner_update_timer": 0.19748051918684115, "synch_weights": 0.0006355886995201649, "restore_eval_env_runners": 1.275091708401928e-05, "evaluation_iteration": 0.15752036644915993, "synch_eval_env_connectors": 0.00012959561693391995, "synch_env_connectors": 1.6386530568228287e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3473489338597633e-06, "numpy_to_tensor": 8.456123790272454e-06, "add_observations_from_episodes_to_batch": 2.902071068606839e-06, "add_states_from_episodes_to_batch": 1.7377663187179338e-06, "batch_individual_items": 6.198166905843633e-06}}, "connector_pipeline_timer": 4.33152402567637e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2713255847255752e-05, "get_actions": 3.710036100294088e-05, "un_batch_to_individual_items": 5.319059541116704e-06, "listify_data_for_vector_env": 1.089518361547828e-05, "remove_single_ts_time_rank_from_batch": 5.740269144374432e-07, "normalize_and_clip_actions": 9.306218142685981e-06}}, "connector_pipeline_timer": 0.00010138263916130888}, "episode_duration_sec_mean": 0.004458224474918097, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes_lifetime": -339125.0, "weights_seq_no": 12.0, "env_step_timer": 1.35571552364898e-05, "env_reset_timer": 3.3802914887000644e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 7.46}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -6782500.0, "module_episode_returns_mean": {"default_policy": 7.46}, "rlmodule_inference_timer": 2.6695107954806682e-05, "time_between_sampling": 0.0017077780151066604, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.004794592249135926, "episode_len_min": 20, "episode_return_mean": 7.46, "num_env_steps_sampled_lifetime_throughput": 3778.489826354634}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 9.112503903452307e-05, "policy_loss": -0.14317864179611206, "total_loss": -0.08020195364952087, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 30.071489334106445, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6363987922668457, "mean_kl_loss": 0.0001085606127162464, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 78000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.012235283851623535, "weights_seq_no": 13.0, "gradients_default_optimizer_global_norm": 0.12169253826141357, "num_module_steps_trained_lifetime_throughput": 366323.60292139277}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03768090208848607, "general_advantage_estimation": 0.012250173842579799, "numpy_to_tensor": 0.0001621254027094378, "add_states_from_episodes_to_batch": 7.450833285911188e-06, "add_time_dim_to_batch_and_zero_pad": 3.678725639080387e-05, "batch_individual_items": 0.10422854406709603, "add_one_ts_to_episodes_and_truncate": 0.008800435808744369, "add_observations_from_episodes_to_batch": 0.0008221891302137416}}, "connector_pipeline_timer": 0.16432594078775908}, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1914719.5721814134, "num_module_steps_trained_throughput": 365919.69687384675, "num_module_steps_trained_lifetime_throughput": 365432.68231479893}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.694615678375175e-06, "tensor_to_numpy": 1.3915247034967325e-05, "get_actions": 3.9659837812178935e-05, "normalize_and_clip_actions": 9.758379322413537e-06, "listify_data_for_vector_env": 1.1265908185744578e-05, "remove_single_ts_time_rank_from_batch": 5.820269019175604e-07}}, "connector_pipeline_timer": 0.00010700570565941927}, "rlmodule_inference_timer": 3.068892080727831e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9090036716903758e-06, "numpy_to_tensor": 8.936149423044784e-06, "add_states_from_episodes_to_batch": 1.644692972575751e-06, "batch_individual_items": 6.302590169305595e-06, "add_time_dim_to_batch_and_zero_pad": 2.3480536223281813e-06}}, "connector_pipeline_timer": 4.4151427082834394e-05}, "env_step_timer": 1.4607497030659422e-05, "num_episodes": 20, "env_reset_timer": 0.0005257868850840642, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 260, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 65400, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "sample": 0.1412640105893356, "agent_episode_returns_mean": {"default_agent": 0.45}, "weights_seq_no": 13.0, "episode_return_min": -13.5, "episode_return_mean": 0.45, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004462337135337293, "time_between_sampling": 1.7471573824492745}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-14", "timestamp": 1754932874, "time_this_iter_s": 1.6584177017211914, "time_total_s": 24.11967372894287, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.11967372894287, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 42.349999999999994, "ram_util_percent": 82.25}}
{"timers": {"training_iteration": 2.2591086111578846, "restore_env_runners": 1.4661230383517494e-05, "training_step": 2.2589467719557557, "env_runner_sampling_timer": 2.0581867770776823, "learner_update_timer": 0.19747622024489972, "synch_weights": 0.0006365919826470353, "restore_eval_env_runners": 1.2691328104392575e-05, "evaluation_iteration": 0.15701286028477987, "synch_eval_env_connectors": 0.00012923591119976918, "synch_env_connectors": 1.6298494710724414e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6554277860204154e-06, "numpy_to_tensor": 8.713120895528195e-06, "add_observations_from_episodes_to_batch": 2.937987551294022e-06, "add_states_from_episodes_to_batch": 1.7798449421005295e-06, "batch_individual_items": 6.352625223446379e-06}}, "connector_pipeline_timer": 4.4440756816227914e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.29654972491864e-05, "get_actions": 3.826968165876718e-05, "un_batch_to_individual_items": 5.389144229414623e-06, "listify_data_for_vector_env": 1.1088910534644242e-05, "remove_single_ts_time_rank_from_batch": 5.798508805234614e-07, "normalize_and_clip_actions": 9.500471558046734e-06}}, "connector_pipeline_timer": 0.00010350835484311385}, "episode_duration_sec_mean": 0.004588383169844745, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes_lifetime": -370000.0, "weights_seq_no": 13.0, "env_step_timer": 1.38877988442184e-05, "env_reset_timer": 3.414372936995347e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 7.54}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -7400000.0, "module_episode_returns_mean": {"default_policy": 7.54}, "rlmodule_inference_timer": 2.8241000285260137e-05, "time_between_sampling": 0.0017306710724803455, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.004847169853533487, "episode_len_min": 20, "episode_return_mean": 7.54, "num_env_steps_sampled_lifetime_throughput": 3729.563164057491}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 4.5562519517261535e-05, "policy_loss": 0.05362187325954437, "total_loss": 0.11680866777896881, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.760150909423828, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.6132097840309143, "mean_kl_loss": 0.0007894618902355433, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 84000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.015738248825073242, "weights_seq_no": 14.0, "gradients_default_optimizer_global_norm": 0.08184441179037094, "num_module_steps_trained_lifetime_throughput": 366882.8796805307}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0376445326470508, "general_advantage_estimation": 0.01218351127439014, "numpy_to_tensor": 0.00016126747929094974, "add_states_from_episodes_to_batch": 7.406744276645455e-06, "add_time_dim_to_batch_and_zero_pad": 3.6531043582826136e-05, "batch_individual_items": 0.10452405529611128, "add_one_ts_to_episodes_and_truncate": 0.00879008812113044, "add_observations_from_episodes_to_batch": 0.0008230264091726295}}, "connector_pipeline_timer": 0.16450546887986808}, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1918185.0247701998, "num_module_steps_trained_throughput": 366530.31690555473, "num_module_steps_trained_lifetime_throughput": 366059.28966586257}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.420106863251547e-06, "tensor_to_numpy": 1.2829950016852387e-05, "get_actions": 3.502092327809333e-05, "normalize_and_clip_actions": 9.307235302737943e-06, "listify_data_for_vector_env": 1.0740878429863555e-05, "remove_single_ts_time_rank_from_batch": 5.734797796768611e-07}}, "connector_pipeline_timer": 9.94550366235942e-05}, "rlmodule_inference_timer": 2.6823685054143885e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.765490606082643e-06, "numpy_to_tensor": 8.36791378969551e-06, "add_states_from_episodes_to_batch": 1.6151854748930845e-06, "batch_individual_items": 6.0877924890314365e-06, "add_time_dim_to_batch_and_zero_pad": 2.223801938313162e-06}}, "connector_pipeline_timer": 4.264043740109235e-05}, "env_step_timer": 1.3652490989877076e-05, "num_episodes": 20, "env_reset_timer": 0.0005212656865689784, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 280, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "module_episode_returns_mean": {"default_policy": 1.25}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 70400, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "sample": 0.1408320763130123, "agent_episode_returns_mean": {"default_agent": 1.25}, "weights_seq_no": 14.0, "episode_return_min": -13.5, "episode_return_mean": 1.25, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004475927953608334, "time_between_sampling": 1.7457857277858426}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-16", "timestamp": 1754932876, "time_this_iter_s": 1.6970689296722412, "time_total_s": 25.816742658615112, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.816742658615112, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.75, "ram_util_percent": 83.1}}
{"timers": {"training_iteration": 2.252219015876703, "restore_env_runners": 1.4573788495307296e-05, "training_step": 2.2520570363267773, "env_runner_sampling_timer": 2.051347358057323, "learner_update_timer": 0.19742764304220725, "synch_weights": 0.0006363518929344528, "restore_eval_env_runners": 1.2631914755250344e-05, "evaluation_iteration": 0.15647977459239804, "synch_eval_env_connectors": 0.00012908647231549283, "synch_env_connectors": 1.6177179463911903e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3826797652892845e-06, "numpy_to_tensor": 8.625527607202749e-06, "add_observations_from_episodes_to_batch": 3.026606585142148e-06, "add_states_from_episodes_to_batch": 1.7497161423960335e-06, "batch_individual_items": 6.33726544045935e-06}}, "connector_pipeline_timer": 4.403751000153328e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.292193124138166e-05, "get_actions": 3.804433068645095e-05, "un_batch_to_individual_items": 5.455369420398139e-06, "listify_data_for_vector_env": 1.1062768736928528e-05, "remove_single_ts_time_rank_from_batch": 5.764103433893295e-07, "normalize_and_clip_actions": 9.44398607567627e-06}}, "connector_pipeline_timer": 0.00010313557140687817}, "episode_duration_sec_mean": 0.004524695309810341, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes_lifetime": -400875.0, "weights_seq_no": 14.0, "env_step_timer": 1.3794756832477293e-05, "env_reset_timer": 3.408459902854805e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 7.46}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -8017500.0, "module_episode_returns_mean": {"default_policy": 7.46}, "rlmodule_inference_timer": 2.7212835404101215e-05, "time_between_sampling": 0.0019005848976320152, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.004861343104350059, "episode_len_min": 20, "episode_return_mean": 7.46, "num_env_steps_sampled_lifetime_throughput": 3727.993870040523}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 2.2781259758630767e-05, "policy_loss": -0.051738157868385315, "total_loss": 0.01164228841662407, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.84295654296875, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.5918295383453369, "mean_kl_loss": 0.0018565247301012278, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 90000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.01546335220336914, "weights_seq_no": 15.0, "gradients_default_optimizer_global_norm": 0.04784759134054184, "num_module_steps_trained_lifetime_throughput": 367946.94955884374}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03761633982098769, "general_advantage_estimation": 0.012114392000765866, "numpy_to_tensor": 0.0001603989743088271, "add_states_from_episodes_to_batch": 7.3610169798245495e-06, "add_time_dim_to_batch_and_zero_pad": 3.62736536427911e-05, "batch_individual_items": 0.10477616099307141, "add_one_ts_to_episodes_and_truncate": 0.008778969739591982, "add_observations_from_episodes_to_batch": 0.0008232657252879233}}, "connector_pipeline_timer": 0.16464597461131805}, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1924262.889547982, "num_module_steps_trained_throughput": 367640.9451637414, "num_module_steps_trained_lifetime_throughput": 367185.1111215699}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.361257577918164e-06, "tensor_to_numpy": 1.2627846542914484e-05, "get_actions": 3.4424252607143374e-05, "normalize_and_clip_actions": 9.153750993758814e-06, "listify_data_for_vector_env": 1.078129747687785e-05, "remove_single_ts_time_rank_from_batch": 5.651421552461748e-07}}, "connector_pipeline_timer": 9.810788738067217e-05}, "rlmodule_inference_timer": 2.6552097465982794e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7669674588964254e-06, "numpy_to_tensor": 8.24631512849734e-06, "add_states_from_episodes_to_batch": 1.6283162769793805e-06, "batch_individual_items": 5.962665045537686e-06, "add_time_dim_to_batch_and_zero_pad": 2.23149196552379e-06}}, "connector_pipeline_timer": 4.223012857720998e-05}, "env_step_timer": 1.3731578704478826e-05, "num_episodes": 20, "env_reset_timer": 0.0005167563586908721, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 300, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 75400, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "sample": 0.14038100470957404, "agent_episode_returns_mean": {"default_agent": 1.05}, "weights_seq_no": 15.0, "episode_return_min": -13.5, "episode_return_mean": 1.05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004473189633572474, "time_between_sampling": 1.7442166809183812}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-17", "timestamp": 1754932877, "time_this_iter_s": 1.6745197772979736, "time_total_s": 27.491262435913086, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.491262435913086, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 42.53333333333334, "ram_util_percent": 83.0}}
{"timers": {"training_iteration": 2.2443808886277363, "restore_env_runners": 1.4485970725422778e-05, "training_step": 2.2442188122141387, "env_runner_sampling_timer": 2.044533012806504, "learner_update_timer": 0.19640512953179787, "synch_weights": 0.0006358800440123669, "restore_eval_env_runners": 1.2568506447613116e-05, "evaluation_iteration": 0.1559354472663727, "synch_eval_env_connectors": 0.0001288122672544654, "synch_env_connectors": 1.605832767012394e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3754969296665507e-06, "numpy_to_tensor": 8.587149538671147e-06, "add_observations_from_episodes_to_batch": 2.941586271441029e-06, "add_states_from_episodes_to_batch": 1.7601965969362607e-06, "batch_individual_items": 6.2547695129692464e-06}}, "connector_pipeline_timer": 4.3755829840468664e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2827974431336878e-05, "get_actions": 3.776326575155934e-05, "un_batch_to_individual_items": 5.349200265531518e-06, "listify_data_for_vector_env": 1.0931521298127065e-05, "remove_single_ts_time_rank_from_batch": 5.750469081406047e-07, "normalize_and_clip_actions": 9.38914039607994e-06}}, "connector_pipeline_timer": 0.000102403438552813}, "episode_duration_sec_mean": 0.004507503484841435, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes_lifetime": -431750.0, "weights_seq_no": 15.0, "env_step_timer": 1.3661095211799386e-05, "env_reset_timer": 3.5478566453523344e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 8.1}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -8635000.0, "module_episode_returns_mean": {"default_policy": 8.1}, "rlmodule_inference_timer": 2.717159050688583e-05, "time_between_sampling": 0.0018903216137016266, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.0048405020519570905, "episode_len_min": 20, "episode_return_mean": 8.1, "num_env_steps_sampled_lifetime_throughput": 3751.0240811628087}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 1.1390629879315384e-05, "policy_loss": -0.028655797243118286, "total_loss": 0.03488733619451523, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.875362396240234, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.5738593339920044, "mean_kl_loss": 0.000879815430380404, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 96000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.015216827392578125, "weights_seq_no": 16.0, "gradients_default_optimizer_global_norm": 0.027136243879795074, "num_module_steps_trained_lifetime_throughput": 369123.3451514785}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03758327267321315, "general_advantage_estimation": 0.012049288500489497, "numpy_to_tensor": 0.00015938040462291637, "add_states_from_episodes_to_batch": 7.317405874307887e-06, "add_time_dim_to_batch_and_zero_pad": 3.604216723265053e-05, "batch_individual_items": 0.10404094605287907, "add_one_ts_to_episodes_and_truncate": 0.008770472962614146, "add_observations_from_episodes_to_batch": 0.0008239443174956965}}, "connector_pipeline_timer": 0.16380112820535916}, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1930917.0235940192, "num_module_steps_trained_throughput": 368863.133968634, "num_module_steps_trained_lifetime_throughput": 368422.02059295867}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.381744712441275e-06, "tensor_to_numpy": 1.2837524153457377e-05, "get_actions": 3.509157083862114e-05, "normalize_and_clip_actions": 9.250680793379613e-06, "listify_data_for_vector_env": 1.1000459482517806e-05, "remove_single_ts_time_rank_from_batch": 5.64515523233382e-07}}, "connector_pipeline_timer": 9.945235593252368e-05}, "rlmodule_inference_timer": 2.707973275568355e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7630477014462557e-06, "numpy_to_tensor": 8.40496925805474e-06, "add_states_from_episodes_to_batch": 1.6442871737112527e-06, "batch_individual_items": 6.07166456863469e-06, "add_time_dim_to_batch_and_zero_pad": 2.258194784402532e-06}}, "connector_pipeline_timer": 4.2611894763058536e-05}, "env_step_timer": 1.3734861048733405e-05, "num_episodes": 20, "env_reset_timer": 0.0005123800444350503, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 320, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "module_episode_returns_mean": {"default_policy": 1.85}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 80400, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "sample": 0.13994083091271342, "agent_episode_returns_mean": {"default_agent": 1.85}, "weights_seq_no": 16.0, "episode_return_min": -13.5, "episode_return_mean": 1.85, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004477904620580375, "time_between_sampling": 1.741634275770116}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-19", "timestamp": 1754932879, "time_this_iter_s": 1.5731010437011719, "time_total_s": 29.064363479614258, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.064363479614258, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 44.45, "ram_util_percent": 83.2}}
{"timers": {"training_iteration": 2.2374722897422754, "restore_env_runners": 1.440611151311062e-05, "training_step": 2.2373100020113434, "env_runner_sampling_timer": 2.038657128928537, "learner_update_timer": 0.19537273073677403, "synch_weights": 0.0006369645738229236, "restore_eval_env_runners": 1.2510740410197255e-05, "evaluation_iteration": 0.1553991148744806, "synch_eval_env_connectors": 0.0001285166445723095, "synch_env_connectors": 1.5938994998558855e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3788670466794283e-06, "numpy_to_tensor": 8.511305669723398e-06, "add_observations_from_episodes_to_batch": 3.000237932347645e-06, "add_states_from_episodes_to_batch": 1.759872438117893e-06, "batch_individual_items": 6.280161285238642e-06}}, "connector_pipeline_timer": 4.378972062110778e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2774077871936628e-05, "get_actions": 3.7449254883171704e-05, "un_batch_to_individual_items": 5.377342114186244e-06, "listify_data_for_vector_env": 1.093768817388745e-05, "remove_single_ts_time_rank_from_batch": 5.778058583394319e-07, "normalize_and_clip_actions": 9.366604199944191e-06}}, "connector_pipeline_timer": 0.00010198497639126823}, "episode_duration_sec_mean": 0.00488479466829449, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes_lifetime": -462625.0, "weights_seq_no": 16.0, "env_step_timer": 1.3642116207637174e-05, "env_reset_timer": 3.308348950093401e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 7.940000000000001}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -9252500.0, "module_episode_returns_mean": {"default_policy": 7.940000000000001}, "rlmodule_inference_timer": 4.4729979913197465e-05, "time_between_sampling": 0.0015362743316656177, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005053306621183987, "episode_len_min": 20, "episode_return_mean": 7.940000000000001, "num_env_steps_sampled_lifetime_throughput": 3760.5305080041235}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 5.695314939657692e-06, "policy_loss": 0.0521533340215683, "total_loss": 0.11605548858642578, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.69392204284668, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.5342195630073547, "mean_kl_loss": 0.0022154797334223986, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 102000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.017306208610534668, "weights_seq_no": 17.0, "gradients_default_optimizer_global_norm": 0.2044783979654312, "num_module_steps_trained_lifetime_throughput": 370551.1246715302}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.037548407866391346, "general_advantage_estimation": 0.011985141865251249, "numpy_to_tensor": 0.00015833202032928504, "add_states_from_episodes_to_batch": 7.274232043999608e-06, "add_time_dim_to_batch_and_zero_pad": 3.576007560961527e-05, "batch_individual_items": 0.10330113450288674, "add_one_ts_to_episodes_and_truncate": 0.008758014482313578, "add_observations_from_episodes_to_batch": 0.000826053215049991}}, "connector_pipeline_timer": 0.1629481631733993}, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1938861.8623837102, "num_module_steps_trained_throughput": 370334.09751293843, "num_module_steps_trained_lifetime_throughput": 369906.5875108371}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.359981674605888e-06, "tensor_to_numpy": 1.2731067349792363e-05, "get_actions": 3.498864414317123e-05, "normalize_and_clip_actions": 9.343076244269582e-06, "listify_data_for_vector_env": 1.0800030446202932e-05, "remove_single_ts_time_rank_from_batch": 5.600290710215484e-07}}, "connector_pipeline_timer": 9.905415184602789e-05}, "rlmodule_inference_timer": 2.6491618170161053e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7760340229499717e-06, "numpy_to_tensor": 8.310724654743079e-06, "add_states_from_episodes_to_batch": 1.6163537447831845e-06, "batch_individual_items": 6.0469342574950574e-06, "add_time_dim_to_batch_and_zero_pad": 2.221363565641029e-06}}, "connector_pipeline_timer": 4.249849867924157e-05}, "env_step_timer": 1.3717554055486623e-05, "num_episodes": 20, "env_reset_timer": 0.0005086204138658595, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 340, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "module_episode_returns_mean": {"default_policy": 2.05}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 85400, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "sample": 0.13951440385396552, "agent_episode_returns_mean": {"default_agent": 2.05}, "weights_seq_no": 17.0, "episode_return_min": -13.5, "episode_return_mean": 2.05, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004481404655380174, "time_between_sampling": 1.7399860121822077}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-21", "timestamp": 1754932881, "time_this_iter_s": 1.6613099575042725, "time_total_s": 30.72567343711853, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.72567343711853, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 40.45, "ram_util_percent": 82.95}}
{"timers": {"training_iteration": 2.231505806844871, "restore_env_runners": 1.4321639908763067e-05, "training_step": 2.231343391580947, "env_runner_sampling_timer": 2.0326559780596916, "learner_update_timer": 0.1954089425991317, "synch_weights": 0.0006364374289166262, "restore_eval_env_runners": 1.2448973418548099e-05, "evaluation_iteration": 0.15489895622621033, "synch_eval_env_connectors": 0.00012828231849135548, "synch_env_connectors": 1.581710475204016e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4220463081341003e-06, "numpy_to_tensor": 9.843749613394763e-06, "add_observations_from_episodes_to_batch": 3.302578886959024e-06, "add_states_from_episodes_to_batch": 1.8600643885618907e-06, "batch_individual_items": 6.467244845526115e-06}}, "connector_pipeline_timer": 4.624309982068763e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.397112065400912e-05, "get_actions": 4.08256427437943e-05, "un_batch_to_individual_items": 5.585927143152368e-06, "listify_data_for_vector_env": 1.1314952091970251e-05, "remove_single_ts_time_rank_from_batch": 5.900739419242702e-07, "normalize_and_clip_actions": 9.758336512500996e-06}}, "connector_pipeline_timer": 0.00010865664378066243}, "episode_duration_sec_mean": 0.004773112060036511, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes_lifetime": -493500.0, "weights_seq_no": 17.0, "env_step_timer": 1.4188409922463792e-05, "env_reset_timer": 3.419193857450949e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 8.5}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -9870000.0, "module_episode_returns_mean": {"default_policy": 8.5}, "rlmodule_inference_timer": 2.9442256426768098e-05, "time_between_sampling": 0.0015034839248094585, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005036901391241272, "episode_len_min": 20, "episode_return_mean": 8.5, "num_env_steps_sampled_lifetime_throughput": 3719.890530499533}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 2.847657469828846e-06, "policy_loss": -0.13860587775707245, "total_loss": -0.07469553500413895, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.967670440673828, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.5333104133605957, "mean_kl_loss": 0.00045499237603507936, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 108000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.013191699981689453, "weights_seq_no": 18.0, "gradients_default_optimizer_global_norm": 0.031843796372413635, "num_module_steps_trained_lifetime_throughput": 372374.2795515122}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03751518878852711, "general_advantage_estimation": 0.011925587946475205, "numpy_to_tensor": 0.00015736412041160452, "add_states_from_episodes_to_batch": 7.234820594351882e-06, "add_time_dim_to_batch_and_zero_pad": 3.552955498297862e-05, "batch_individual_items": 0.1036250994078116, "add_one_ts_to_episodes_and_truncate": 0.008752803916958363, "add_observations_from_episodes_to_batch": 0.0008260589332695614}}, "connector_pipeline_timer": 0.16317070529220892}, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1948881.1020716692, "num_module_steps_trained_throughput": 372202.13529711514, "num_module_steps_trained_lifetime_throughput": 371787.4348164803}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.319010407785663e-06, "tensor_to_numpy": 1.2591550841897581e-05, "get_actions": 3.405274941557367e-05, "normalize_and_clip_actions": 9.214908132770435e-06, "listify_data_for_vector_env": 1.0723163767720551e-05, "remove_single_ts_time_rank_from_batch": 5.66556486382445e-07}}, "connector_pipeline_timer": 9.783595140258626e-05}, "rlmodule_inference_timer": 2.6107403442646498e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7681025800679717e-06, "numpy_to_tensor": 8.218867474009896e-06, "add_states_from_episodes_to_batch": 1.6281182371716573e-06, "batch_individual_items": 5.9697081596354495e-06, "add_time_dim_to_batch_and_zero_pad": 2.2501091961558055e-06}}, "connector_pipeline_timer": 4.260569221254632e-05}, "env_step_timer": 1.357107785650874e-05, "num_episodes": 20, "env_reset_timer": 0.0005042162894260913, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 360, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 90400, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "sample": 0.13907785814487866, "agent_episode_returns_mean": {"default_agent": 1.65}, "weights_seq_no": 18.0, "episode_return_min": -13.5, "episode_return_mean": 1.65, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004436707949498669, "time_between_sampling": 1.7391815679000782}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-22", "timestamp": 1754932882, "time_this_iter_s": 1.7445530891418457, "time_total_s": 32.470226526260376, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.470226526260376, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 46.53333333333333, "ram_util_percent": 83.0}}
{"timers": {"training_iteration": 2.2262371816871425, "restore_env_runners": 1.425675355896669e-05, "training_step": 2.2260745326653195, "env_runner_sampling_timer": 2.027439793279026, "learner_update_timer": 0.19535721150369378, "synch_weights": 0.0006368526347716716, "restore_eval_env_runners": 1.238781361943647e-05, "evaluation_iteration": 0.15436346375368254, "synch_eval_env_connectors": 0.0001279182450263001, "synch_env_connectors": 1.5704353142330537e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5683152053575254e-06, "numpy_to_tensor": 9.473657658394998e-06, "add_observations_from_episodes_to_batch": 3.2011527744744947e-06, "add_states_from_episodes_to_batch": 1.8790491521187167e-06, "batch_individual_items": 6.924341471357888e-06}}, "connector_pipeline_timer": 4.7156654573238556e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4187065798478126e-05, "get_actions": 4.2788932224261263e-05, "un_batch_to_individual_items": 5.783903877421997e-06, "listify_data_for_vector_env": 1.2080850320781775e-05, "remove_single_ts_time_rank_from_batch": 6.196753970712507e-07, "normalize_and_clip_actions": 1.035499645632444e-05}}, "connector_pipeline_timer": 0.00011319753838530966}, "episode_duration_sec_mean": 0.004966573667712511, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes_lifetime": -524375.0, "weights_seq_no": 18.0, "env_step_timer": 1.5105490271079773e-05, "env_reset_timer": 4.225655718882184e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -10487500.0, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "rlmodule_inference_timer": 3.098972024226608e-05, "time_between_sampling": 0.0019174306115905643, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.005325610296970702, "episode_len_min": 20, "episode_return_mean": 8.980000000000004, "num_env_steps_sampled_lifetime_throughput": 3497.347582153182}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 1.423828734914423e-06, "policy_loss": -0.08715296536684036, "total_loss": -0.02297934889793396, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.897029876708984, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.5042437314987183, "mean_kl_loss": 0.0012530607637017965, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 114000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.013711333274841309, "weights_seq_no": 19.0, "gradients_default_optimizer_global_norm": 0.018438857048749924, "num_module_steps_trained_lifetime_throughput": 374042.54825541744}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03748513273091286, "general_advantage_estimation": 0.01186374164734175, "numpy_to_tensor": 0.0001565325581990953, "add_states_from_episodes_to_batch": 7.1899720157303216e-06, "add_time_dim_to_batch_and_zero_pad": 3.526760007403645e-05, "batch_individual_items": 0.10385257550312364, "add_one_ts_to_episodes_and_truncate": 0.00874557670692925, "add_observations_from_episodes_to_batch": 0.0008269708445136897}}, "connector_pipeline_timer": 0.1632966807394611}, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1958061.1339731042, "num_module_steps_trained_throughput": 373911.5735278657, "num_module_steps_trained_lifetime_throughput": 373509.4298808133}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.791332360661658e-06, "tensor_to_numpy": 1.4131233833788108e-05, "get_actions": 4.069959395316736e-05, "normalize_and_clip_actions": 1.0199694359318188e-05, "listify_data_for_vector_env": 1.163560939824014e-05, "remove_single_ts_time_rank_from_batch": 6.156516662434487e-07}}, "connector_pipeline_timer": 0.00011094087973552781}, "rlmodule_inference_timer": 3.112302938118228e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.095060741970659e-06, "numpy_to_tensor": 9.410061312146391e-06, "add_states_from_episodes_to_batch": 1.6896246638672602e-06, "batch_individual_items": 7.520072255869271e-06, "add_time_dim_to_batch_and_zero_pad": 2.3027534478032486e-06}}, "connector_pipeline_timer": 4.72443511606775e-05}, "env_step_timer": 1.5546055778767184e-05, "num_episodes": 20, "env_reset_timer": 0.0004999316270611196, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 380, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "module_episode_returns_mean": {"default_policy": 1.45}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 95400, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "sample": 0.1388391424835849, "agent_episode_returns_mean": {"default_agent": 1.45}, "weights_seq_no": 19.0, "episode_return_min": -13.5, "episode_return_mean": 1.45, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004589088334469125, "time_between_sampling": 1.7390165709709915}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-24", "timestamp": 1754932884, "time_this_iter_s": 1.8281362056732178, "time_total_s": 34.298362731933594, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.298362731933594, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 50.03333333333333, "ram_util_percent": 83.83333333333333}}
{"timers": {"training_iteration": 2.2228162427795195, "restore_env_runners": 1.4182526473902306e-05, "training_step": 2.2226530635888855, "env_runner_sampling_timer": 2.0248900003463475, "learner_update_timer": 0.19447419104903438, "synch_weights": 0.0006455770289359159, "restore_eval_env_runners": 1.2351024621347617e-05, "evaluation_iteration": 0.15402989327655045, "synch_eval_env_connectors": 0.0001276290631294662, "synch_env_connectors": 1.5594809390519058e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.197738918582244e-06, "numpy_to_tensor": 1.1118862551383245e-05, "add_observations_from_episodes_to_batch": 3.469621205630452e-06, "add_states_from_episodes_to_batch": 1.9699587994279807e-06, "batch_individual_items": 7.658631043547195e-06}}, "connector_pipeline_timer": 5.427266221226447e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.569309884417861e-05, "get_actions": 5.3340084200832654e-05, "un_batch_to_individual_items": 6.510630696811756e-06, "listify_data_for_vector_env": 1.2913761606185629e-05, "remove_single_ts_time_rank_from_batch": 6.757467981410283e-07, "normalize_and_clip_actions": 1.2731393372974952e-05}}, "connector_pipeline_timer": 0.000133392222154061}, "episode_duration_sec_mean": 0.005826755661983044, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes_lifetime": -555250.0, "weights_seq_no": 19.0, "env_step_timer": 1.7466265693381977e-05, "env_reset_timer": 5.116594106259794e-05, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 8.580000000000002}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_max": 10.5, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -11105000.0, "module_episode_returns_mean": {"default_policy": 8.580000000000002}, "rlmodule_inference_timer": 3.719338658938744e-05, "time_between_sampling": 0.0021024201000854194, "env_to_module_sum_episodes_length_out": 10.36823839457432, "sample": 0.006159653068335149, "episode_len_min": 20, "episode_return_mean": 8.580000000000002, "num_env_steps_sampled_lifetime_throughput": 3301.4142512089766}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "curr_kl_coeff": 7.119143674572115e-07, "policy_loss": -0.07692054659128189, "total_loss": -0.012637391686439514, "vf_loss": 0.10278083384037018, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.854867935180664, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "entropy": 0.4921499788761139, "mean_kl_loss": 4.868659016210586e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 120000, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.015539288520812988, "weights_seq_no": 20.0, "gradients_default_optimizer_global_norm": 0.11064177006483078, "num_module_steps_trained_lifetime_throughput": 374719.992734329}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03748391682371381, "general_advantage_estimation": 0.011817807151165493, "numpy_to_tensor": 0.00015567598306622535, "add_states_from_episodes_to_batch": 7.905992148455643e-06, "add_time_dim_to_batch_and_zero_pad": 3.526867414757837e-05, "batch_individual_items": 0.10315088349799019, "add_one_ts_to_episodes_and_truncate": 0.0087483542695435, "add_observations_from_episodes_to_batch": 0.0008278857158991695}}, "connector_pipeline_timer": 0.16255052059263111}, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1962010.6558189737, "num_module_steps_trained_throughput": 374625.32397224347, "num_module_steps_trained_lifetime_throughput": 374236.2618340167}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.661465584318812e-06, "tensor_to_numpy": 1.3475909158773213e-05, "get_actions": 3.943508737400277e-05, "normalize_and_clip_actions": 1.0501534181775382e-05, "listify_data_for_vector_env": 1.1755916761940154e-05, "remove_single_ts_time_rank_from_batch": 6.008747259140642e-07}}, "connector_pipeline_timer": 0.0001078065603052448}, "rlmodule_inference_timer": 2.9162619221116778e-05, "episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8736849435070308e-06, "numpy_to_tensor": 8.996573347479402e-06, "add_states_from_episodes_to_batch": 1.6358461031315854e-06, "batch_individual_items": 6.438251897520918e-06, "add_time_dim_to_batch_and_zero_pad": 2.2882999435310427e-06}}, "connector_pipeline_timer": 4.445185496413084e-05}, "env_step_timer": 1.592162972481754e-05, "num_episodes": 20, "env_reset_timer": 0.0004981793902299697, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 100400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "sample": 0.13854448688867607, "agent_episode_returns_mean": {"default_agent": 1.65}, "weights_seq_no": 20.0, "episode_return_min": -13.5, "episode_return_mean": 1.65, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_duration_sec_mean": 0.004697502063354477, "time_between_sampling": 1.7407288390112217}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4db92_00000", "date": "2025-08-11_19-21-26", "timestamp": 1754932886, "time_this_iter_s": 2.0069665908813477, "time_total_s": 36.30532932281494, "pid": 14254, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3852f5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.30532932281494, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 60.800000000000004, "ram_util_percent": 85.30000000000001}}
