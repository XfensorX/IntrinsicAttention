{"timers": {"training_iteration": 6.956875249976292, "restore_env_runners": 1.9834027625620365e-05, "training_step": 6.956637665978633, "env_runner_sampling_timer": 6.6885852090781555, "learner_update_timer": 0.25405637500807643, "synch_weights": 0.008314791950397193}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00019037185655615014, "timers": {"connectors": {"batch_individual_items": 2.7322229025661466e-05, "add_states_from_episodes_to_batch": 5.509246620375806e-06, "add_observations_from_episodes_to_batch": 1.7171738027726767e-05, "numpy_to_tensor": 4.676722426833586e-05, "add_time_dim_to_batch_and_zero_pad": 1.0862677132217963e-05}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 4.704653488590707e-05, "get_actions": 0.00022881428075982802, "un_batch_to_individual_items": 2.1911130991248624e-05, "remove_single_ts_time_rank_from_batch": 1.942445318657195e-06, "tensor_to_numpy": 6.225371100956703e-05, "listify_data_for_vector_env": 5.518967116580878e-05}}, "connector_pipeline_timer": 0.0005354211466393179}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -3.7400000000000015}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.023343347670976074, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 31375.0, "env_step_timer": 6.781834985609507e-05, "env_reset_timer": 0.0002306606798884811, "module_episode_returns_mean": {"default_policy": -3.7400000000000015}, "episode_return_mean": -3.7400000000000015, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.000242540860438029, "weights_seq_no": 0.0, "sample": 0.026819012471810417, "time_between_sampling": 0.002473070365417205, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled_lifetime_throughput": 1577.4488682933868}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 6000, "gradients_default_optimizer_global_norm": 0.11001160740852356, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6923456788063049, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 1.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.12488927692174911, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.3732481598854065, "vf_explained_var": -0.009245157241821289, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.061082545667886734, "vf_loss_unclipped": 31.674436569213867, "mean_kl_loss": 0.0017906971042975783, "num_module_steps_trained_lifetime_throughput": 252475.8010745692}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.833905793726444e-06, "numpy_to_tensor": 0.0001842080382630229, "add_observations_from_episodes_to_batch": 0.0009276670170947909, "add_time_dim_to_batch_and_zero_pad": 1.6249949112534523e-05, "add_columns_from_episodes_to_train_batch": 0.05158045899588615, "batch_individual_items": 0.1060120000038296, "add_one_ts_to_episodes_and_truncate": 0.018318125046789646, "general_advantage_estimation": 0.009670375031419098}}, "connector_pipeline_timer": 0.18705312500242144}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1306698.3481417336, "num_module_steps_trained_throughput": 251389.70507934527, "num_module_steps_trained_lifetime_throughput": 250449.9526567659}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0005592638786475413, "timers": {"connectors": {"listify_data_for_vector_env": 9.983096138263966e-05, "un_batch_to_individual_items": 5.833314570235026e-05, "normalize_and_clip_actions": 2.9775877728136523e-05, "remove_single_ts_time_rank_from_batch": 1.4644682037400528e-06, "get_actions": 0.00023705754919914763, "tensor_to_numpy": 4.793645821967333e-05}}}, "num_env_steps_sampled_lifetime": 5400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": -1.3}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.0735721412926854e-06, "batch_individual_items": 2.948779300795039e-05, "add_states_from_episodes_to_batch": 3.1850289971837334e-06, "add_observations_from_episodes_to_batch": 7.0306469394588735e-06, "numpy_to_tensor": 3.0120308698060162e-05}}, "connector_pipeline_timer": 0.0001345711443355496}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 1.0, "sample": 0.3366734170122072, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -1.3, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.015661897894460708, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_episodes_lifetime": 20, "env_step_timer": 6.821156329709786e-05, "env_reset_timer": 0.002268292009830475, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "rlmodule_inference_timer": 0.0001484886592949768}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "497a3_00000", "date": "2025-08-11_19-25-25", "timestamp": 1754933125, "time_this_iter_s": 7.3483099937438965, "time_total_s": 7.3483099937438965, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.3483099937438965, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 84.88181818181819, "ram_util_percent": 80.23636363636365}}
{"timers": {"training_iteration": 6.948300287066958, "restore_env_runners": 1.976026687771082e-05, "training_step": 6.948062073478941, "env_runner_sampling_timer": 6.676305387397297, "learner_update_timer": 0.2578367858484853, "synch_weights": 0.008244647360406816, "restore_eval_env_runners": 1.3749930076301098e-05, "evaluation_iteration": 0.3878942499868572, "synch_eval_env_connectors": 0.0005805830005556345, "synch_env_connectors": 5.541020072996616e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00015232834424284947, "timers": {"connectors": {"batch_individual_items": 2.85097888514027e-05, "add_states_from_episodes_to_batch": 1.0146485728921715e-05, "add_observations_from_episodes_to_batch": 8.884651820964313e-06, "numpy_to_tensor": 4.158562946824221e-05, "add_time_dim_to_batch_and_zero_pad": 8.844013528928156e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.712986830221636e-05, "get_actions": 0.0002180752297014608, "un_batch_to_individual_items": 1.5336790502258403e-05, "remove_single_ts_time_rank_from_batch": 2.039767020129061e-06, "tensor_to_numpy": 5.0381922995806187e-05, "listify_data_for_vector_env": 4.435095511997754e-05}}, "connector_pipeline_timer": 0.0004562532392533124}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -3.8199999999999994}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.01874115298874676, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 500.0, "env_step_timer": 5.705596327651814e-05, "env_reset_timer": 0.00013414706570069723, "module_episode_returns_mean": {"default_policy": -3.8199999999999994}, "episode_return_mean": -3.8199999999999994, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00012196793030036729, "weights_seq_no": 1.0, "sample": 0.023339067979871765, "time_between_sampling": 0.004521167438431236, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 1742.5337331560609}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 12000, "gradients_default_optimizer_global_norm": 0.14527708292007446, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6920329928398132, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 2.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.06935101747512817, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.18662407994270325, "vf_explained_var": -0.011589646339416504, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.13185341656208038, "vf_loss_unclipped": 29.594585418701172, "mean_kl_loss": 7.931759319035336e-05, "num_module_steps_trained_lifetime_throughput": 251043.59282943196}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.839737037196755e-06, "numpy_to_tensor": 0.00018354303785599768, "add_observations_from_episodes_to_batch": 0.0009277745173312724, "add_time_dim_to_batch_and_zero_pad": 1.6309949569404125e-05, "add_columns_from_episodes_to_train_batch": 0.05251121606677771, "batch_individual_items": 0.10922105625271797, "add_one_ts_to_episodes_and_truncate": 0.01825594879570417, "general_advantage_estimation": 0.009648685031570493}}, "connector_pipeline_timer": 0.19110683167236858}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 12000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1299335.050471864, "num_module_steps_trained_throughput": 249967.53700070956, "num_module_steps_trained_lifetime_throughput": 249033.75181917936}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0004167531194582469, "timers": {"connectors": {"listify_data_for_vector_env": 2.93579318230623e-05, "un_batch_to_individual_items": 1.2404385105794666e-05, "normalize_and_clip_actions": 1.858660094374736e-05, "remove_single_ts_time_rank_from_batch": 8.569407979285757e-07, "get_actions": 0.00027222769424492153, "tensor_to_numpy": 3.4791478338916795e-05}}}, "num_env_steps_sampled_lifetime": 10400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": -0.8}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.909538970535502e-06, "batch_individual_items": 1.113814147469534e-05, "add_states_from_episodes_to_batch": 2.199948817473324e-06, "add_observations_from_episodes_to_batch": 4.582771729831104e-06, "numpy_to_tensor": 2.0508653090953602e-05}}, "connector_pipeline_timer": 7.354326336588894e-05}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 2.0, "sample": 0.33615232950192875, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.8, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.014319534369860776, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "agent_episode_returns_mean": {"default_agent": -0.8}, "num_episodes_lifetime": 40, "env_step_timer": 3.441507769306548e-05, "env_reset_timer": 0.0022464495094027368, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "rlmodule_inference_timer": 9.367596621088018e-05, "time_between_sampling": 6.157698750030249}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "497a3_00000", "date": "2025-08-11_19-25-31", "timestamp": 1754933131, "time_this_iter_s": 6.395258903503418, "time_total_s": 13.743568897247314, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.743568897247314, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 71.27777777777777, "ram_util_percent": 80.14444444444445}}
{"timers": {"training_iteration": 6.933856493785884, "restore_env_runners": 1.9690164597705006e-05, "training_step": 6.933587575663883, "env_runner_sampling_timer": 6.657775291022891, "learner_update_timer": 0.26133138090971625, "synch_weights": 0.008410031716851517, "restore_eval_env_runners": 1.3707431498914957e-05, "evaluation_iteration": 0.3869412720669061, "synch_eval_env_connectors": 0.0005759625905193388, "synch_env_connectors": 5.5589503608644005e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00012430794338420408, "timers": {"connectors": {"batch_individual_items": 2.07523079315827e-05, "add_states_from_episodes_to_batch": 4.343414402101067e-06, "add_observations_from_episodes_to_batch": 1.0691401981583333e-05, "numpy_to_tensor": 3.332667393568737e-05, "add_time_dim_to_batch_and_zero_pad": 6.171999806974087e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.1640502635926955e-05, "get_actions": 0.0001531315252029606, "un_batch_to_individual_items": 1.7767072453833136e-05, "remove_single_ts_time_rank_from_batch": 1.5194264032834854e-06, "tensor_to_numpy": 5.2044667310784747e-05, "listify_data_for_vector_env": 2.96570195583177e-05}}, "connector_pipeline_timer": 0.00035858375827479077}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -2.0599999999999996}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.015892093033995473, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -30375.0, "env_step_timer": 4.933070051672988e-05, "env_reset_timer": 0.000132188129315443, "module_episode_returns_mean": {"default_policy": -2.0599999999999996}, "episode_return_mean": -2.0599999999999996, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00011587383228451331, "weights_seq_no": 2.0, "sample": 0.01759364731694355, "time_between_sampling": 0.006077913608753523, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled_lifetime_throughput": 1924.3098586029844}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 18000, "gradients_default_optimizer_global_norm": 0.11601883918046951, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6897167563438416, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 3.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.2806500792503357, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.09331203997135162, "vf_explained_var": -0.009776949882507324, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.21789036691188812, "vf_loss_unclipped": 31.712276458740234, "mean_kl_loss": 0.0014248319203034043, "num_module_steps_trained_lifetime_throughput": 247654.14564778827}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.875510196667164e-06, "numpy_to_tensor": 0.00018276718714041633, "add_observations_from_episodes_to_batch": 0.0009296784428646788, "add_time_dim_to_batch_and_zero_pad": 1.648560003377497e-05, "add_columns_from_episodes_to_train_batch": 0.05339541099574417, "batch_individual_items": 0.11014970444110223, "add_one_ts_to_episodes_and_truncate": 0.01824986596816452, "general_advantage_estimation": 0.009930576930847018}}, "connector_pipeline_timer": 0.19319567294541048}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 18000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1281903.004120178, "num_module_steps_trained_throughput": 246597.96669802934, "num_module_steps_trained_lifetime_throughput": 245680.61433535075}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0007707470644806798, "timers": {"connectors": {"listify_data_for_vector_env": 3.41111647865017e-05, "un_batch_to_individual_items": 1.2771168918014808e-05, "normalize_and_clip_actions": 6.834025756048002e-05, "remove_single_ts_time_rank_from_batch": 1.4223674064449333e-06, "get_actions": 0.0005403260948857038, "tensor_to_numpy": 4.113745579842146e-05}}}, "num_env_steps_sampled_lifetime": 15400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": -2.3}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.081657896412974e-06, "batch_individual_items": 1.920256700135493e-05, "add_states_from_episodes_to_batch": 4.2474087933081195e-06, "add_observations_from_episodes_to_batch": 8.096312511792796e-06, "numpy_to_tensor": 3.3901988142527695e-05}}, "connector_pipeline_timer": 0.00015482645013016263}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 3.0, "sample": 0.3367399687071215, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -2.3, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.015795318064435074, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "agent_episode_returns_mean": {"default_agent": -2.3}, "num_episodes_lifetime": 60, "env_step_timer": 6.3578723342578e-05, "env_reset_timer": 0.0022270116846193557, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "rlmodule_inference_timer": 0.00012410185422263368, "time_between_sampling": 6.151916875450406}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "497a3_00000", "date": "2025-08-11_19-25-37", "timestamp": 1754933137, "time_this_iter_s": 5.927201986312866, "time_total_s": 19.67077088356018, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.67077088356018, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 79.475, "ram_util_percent": 79.675}}
{"timers": {"training_iteration": 6.923818945938936, "restore_env_runners": 1.967160307569429e-05, "training_step": 6.923546894486998, "env_runner_sampling_timer": 6.646600964782898, "learner_update_timer": 0.26251685376080974, "synch_weights": 0.008351270569343585, "restore_eval_env_runners": 1.443077700678259e-05, "evaluation_iteration": 0.3871402955963277, "synch_eval_env_connectors": 0.000575671304273419, "synch_env_connectors": 5.562111013568938e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00014746294747876974, "timers": {"connectors": {"batch_individual_items": 2.0582909426035533e-05, "add_states_from_episodes_to_batch": 3.719112684286278e-06, "add_observations_from_episodes_to_batch": 1.2133593728081728e-05, "numpy_to_tensor": 3.64414901054188e-05, "add_time_dim_to_batch_and_zero_pad": 5.91942748561162e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.591745175797804e-05, "get_actions": 0.000183301812527345, "un_batch_to_individual_items": 1.4410577593801422e-05, "remove_single_ts_time_rank_from_batch": 1.5266120448359103e-06, "tensor_to_numpy": 5.3143619739466935e-05, "listify_data_for_vector_env": 4.669604414088072e-05}}, "connector_pipeline_timer": 0.0003966452930384269}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -3.0199999999999996}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.01804477400146425, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -61250.0, "env_step_timer": 5.86612026417451e-05, "env_reset_timer": 0.0002166738991739148, "module_episode_returns_mean": {"default_policy": -3.0199999999999996}, "episode_return_mean": -3.0199999999999996, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00015002388145455946, "weights_seq_no": 3.0, "sample": 0.018422515658110206, "time_between_sampling": 0.007709011529712948, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled_lifetime_throughput": 1813.561744994636}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 24000, "gradients_default_optimizer_global_norm": 0.11352477222681046, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6764528751373291, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 4.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.23051778972148895, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.04665601998567581, "vf_explained_var": -0.01489114761352539, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.29342687129974365, "vf_loss_unclipped": 27.08785629272461, "mean_kl_loss": 0.003163272514939308, "num_module_steps_trained_lifetime_throughput": 243544.02070538624}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.9234146602684635e-06, "numpy_to_tensor": 0.00018170826501084954, "add_observations_from_episodes_to_batch": 0.0009445754084319342, "add_time_dim_to_batch_and_zero_pad": 1.6578244247939436e-05, "add_columns_from_episodes_to_train_batch": 0.05440577104533278, "batch_individual_items": 0.1096341603077515, "add_one_ts_to_episodes_and_truncate": 0.01850686938845401, "general_advantage_estimation": 0.009901821160902267}}, "connector_pipeline_timer": 0.19393185413534697}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 24000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1260814.3465945784, "num_module_steps_trained_throughput": 242518.49608335702, "num_module_steps_trained_lifetime_throughput": 241622.51853564417}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0002795255736442188, "timers": {"connectors": {"listify_data_for_vector_env": 3.156360824233247e-05, "un_batch_to_individual_items": 9.760497789727568e-06, "normalize_and_clip_actions": 2.5144642679095124e-05, "remove_single_ts_time_rank_from_batch": 2.2856782902603515e-06, "get_actions": 0.00011657576242723803, "tensor_to_numpy": 3.6170772436776604e-05}}}, "num_env_steps_sampled_lifetime": 20400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": -1.3}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.441645895820501e-06, "batch_individual_items": 2.084089306674734e-05, "add_states_from_episodes_to_batch": 5.4558283730416484e-06, "add_observations_from_episodes_to_batch": 6.024440311597302e-06, "numpy_to_tensor": 2.8955692605114702e-05}}, "connector_pipeline_timer": 0.00011055629930670255}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 4.0, "sample": 0.3373282940207558, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -1.3, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.016455270847654902, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_episodes_lifetime": 80, "env_step_timer": 8.40732459451851e-05, "env_reset_timer": 0.002207111148097901, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "rlmodule_inference_timer": 0.00010190172693301512, "time_between_sampling": 6.150534342525597}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "497a3_00000", "date": "2025-08-11_19-25-43", "timestamp": 1754933143, "time_this_iter_s": 6.384335041046143, "time_total_s": 26.055105924606323, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.055105924606323, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 91.62222222222222, "ram_util_percent": 79.88888888888889}}
{"timers": {"training_iteration": 6.93069962439956, "restore_env_runners": 1.9539886375726198e-05, "training_step": 6.930425716381888, "env_runner_sampling_timer": 6.650117738885235, "learner_update_timer": 0.2658979418829497, "synch_weights": 0.008300581193907239, "restore_eval_env_runners": 1.4511058839736506e-05, "evaluation_iteration": 0.38777588056039536, "synch_eval_env_connectors": 0.0005747375010626856, "synch_env_connectors": 5.568149278638885e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00017487373225986784, "timers": {"connectors": {"batch_individual_items": 2.0540865936763212e-05, "add_states_from_episodes_to_batch": 5.537925112485412e-06, "add_observations_from_episodes_to_batch": 1.1484906241622047e-05, "numpy_to_tensor": 6.5716856430879e-05, "add_time_dim_to_batch_and_zero_pad": 1.2746043178231025e-05}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.3359642183332e-05, "get_actions": 0.00023362799092149417, "un_batch_to_individual_items": 1.472353521660033e-05, "remove_single_ts_time_rank_from_batch": 1.5750420661156696e-06, "tensor_to_numpy": 0.00010401434470850826, "listify_data_for_vector_env": 4.314655735106826e-05}}, "connector_pipeline_timer": 0.0005173370355955098}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.02463124495884404, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -92125.0, "env_step_timer": 8.950837397552101e-05, "env_reset_timer": 0.00035204540688572655, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "episode_return_mean": -1.0199999999999996, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.0002829549367032546, "weights_seq_no": 4.0, "sample": 0.02300013805182519, "time_between_sampling": 0.005940790967843438, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled_lifetime_throughput": 1712.384185865598}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 30000, "gradients_default_optimizer_global_norm": 0.16659164428710938, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6639235019683838, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 5.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.17368201911449432, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.023328009992837906, "vf_explained_var": -0.012921690940856934, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.11087483167648315, "vf_loss_unclipped": 29.599639892578125, "mean_kl_loss": 0.0017101932317018509, "num_module_steps_trained_lifetime_throughput": 238570.33108277072}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.9229305176890924e-06, "numpy_to_tensor": 0.00023859535229349389, "add_observations_from_episodes_to_batch": 0.0009971121542488202, "add_time_dim_to_batch_and_zero_pad": 1.6758290981245224e-05, "add_columns_from_episodes_to_train_batch": 0.05617370500458273, "batch_individual_items": 0.11026293912454319, "add_one_ts_to_episodes_and_truncate": 0.01859036194440116, "general_advantage_estimation": 0.009983910449395615}}, "connector_pipeline_timer": 0.1966053668438266}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 30000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1235269.5398390405, "num_module_steps_trained_throughput": 237578.23207608738, "num_module_steps_trained_lifetime_throughput": 236708.58138563886}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0010712285855615366, "timers": {"connectors": {"listify_data_for_vector_env": 9.775736591071731e-05, "un_batch_to_individual_items": 7.581690553869489e-05, "normalize_and_clip_actions": 5.382899588156986e-05, "remove_single_ts_time_rank_from_batch": 2.3738877618229664e-06, "get_actions": 0.00044990611172621506, "tensor_to_numpy": 0.00012082574423206464}}}, "num_env_steps_sampled_lifetime": 25400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": -0.5}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1508655727568436e-05, "batch_individual_items": 9.05850329077026e-05, "add_states_from_episodes_to_batch": 6.953878617443508e-06, "add_observations_from_episodes_to_batch": 2.096230711729433e-05, "numpy_to_tensor": 8.269122665660291e-05}}, "connector_pipeline_timer": 0.00035797818309584193}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 5.0, "sample": 0.34632616483053946, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.5, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.025002729197731242, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "agent_episode_returns_mean": {"default_agent": -0.5}, "num_episodes_lifetime": 100, "env_step_timer": 0.00014632933869032264, "env_reset_timer": 0.0021931662870851164, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "rlmodule_inference_timer": 0.0002568676866877921, "time_between_sampling": 6.166774784510857}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "497a3_00000", "date": "2025-08-11_19-25-52", "timestamp": 1754933152, "time_this_iter_s": 8.91507625579834, "time_total_s": 34.97018218040466, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.97018218040466, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 95.20769230769231, "ram_util_percent": 81.0923076923077}}
{"timers": {"training_iteration": 6.966778124815002, "restore_env_runners": 1.952615711413952e-05, "training_step": 6.966502567138616, "env_runner_sampling_timer": 6.678242476496597, "learner_update_timer": 0.2738721966246068, "synch_weights": 0.008240207471644502, "restore_eval_env_runners": 1.4638028320746962e-05, "evaluation_iteration": 0.39683349009548663, "synch_eval_env_connectors": 0.0005767626264459708, "synch_env_connectors": 5.912467339190189e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.0002537986215462043, "timers": {"connectors": {"batch_individual_items": 5.5800125492135544e-05, "add_states_from_episodes_to_batch": 6.665005078851208e-06, "add_observations_from_episodes_to_batch": 2.2923585244709127e-05, "numpy_to_tensor": 6.781392335711287e-05, "add_time_dim_to_batch_and_zero_pad": 9.695444458902819e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 6.0021611048697386e-05, "get_actions": 0.00041872931372348866, "un_batch_to_individual_items": 2.61116964707083e-05, "remove_single_ts_time_rank_from_batch": 2.1371231574126726e-06, "tensor_to_numpy": 7.774922541378443e-05, "listify_data_for_vector_env": 7.075073906541279e-05}}, "connector_pipeline_timer": 0.0007840917498273318}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 0.5}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.032930294326972205, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -123000.0, "env_step_timer": 0.00010513268412813101, "env_reset_timer": 0.00020258981114817208, "module_episode_returns_mean": {"default_policy": 0.5}, "episode_return_mean": 0.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00019597453990444813, "weights_seq_no": 5.0, "sample": 0.03094128668063382, "time_between_sampling": 0.01107599045823218, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled_lifetime_throughput": 1266.792208933538}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 36000, "gradients_default_optimizer_global_norm": 0.017227962613105774, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6570912599563599, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 6.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.20755812525749207, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.011664004996418953, "vf_explained_var": -0.013740062713623047, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.14476658403873444, "vf_loss_unclipped": 28.372112274169922, "mean_kl_loss": 9.704682452138513e-05, "num_module_steps_trained_lifetime_throughput": 232905.02249737407}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.932041510747617e-06, "numpy_to_tensor": 0.00023724731819875847, "add_observations_from_episodes_to_batch": 0.0010157943719563453, "add_time_dim_to_batch_and_zero_pad": 1.6997378222711146e-05, "add_columns_from_episodes_to_train_batch": 0.05644722586519457, "batch_individual_items": 0.11613627098285229, "add_one_ts_to_episodes_and_truncate": 0.019351365824995075, "general_advantage_estimation": 0.010040766344797648}}, "connector_pipeline_timer": 0.20359221275644254}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1206156.059918722, "num_module_steps_trained_throughput": 231951.28256164648, "num_module_steps_trained_lifetime_throughput": 231111.22160267306}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0005598773781308217, "timers": {"connectors": {"listify_data_for_vector_env": 3.78818094628085e-05, "un_batch_to_individual_items": 2.7492463027167095e-05, "normalize_and_clip_actions": 2.749601179484075e-05, "remove_single_ts_time_rank_from_batch": 1.9792292882323365e-06, "get_actions": 0.00022923764302778526, "tensor_to_numpy": 0.0001391479024545131}}}, "num_env_steps_sampled_lifetime": 30400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": -0.1}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.532492246382119e-06, "batch_individual_items": 1.7130092939493463e-05, "add_states_from_episodes_to_batch": 3.244512948882474e-06, "add_observations_from_episodes_to_batch": 1.4086079947387625e-05, "numpy_to_tensor": 3.0748850881841234e-05}}, "connector_pipeline_timer": 0.0001327670995019029}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 6.0, "sample": 0.3487302486026449, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.1, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.02745814377674833, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "agent_episode_returns_mean": {"default_agent": -0.1}, "num_episodes_lifetime": 120, "env_step_timer": 7.608425609421745e-05, "env_reset_timer": 0.002179067953942138, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "rlmodule_inference_timer": 0.00040191825529279783, "time_between_sampling": 6.212220139995652}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "497a3_00000", "date": "2025-08-11_19-26-04", "timestamp": 1754933164, "time_this_iter_s": 11.161762952804565, "time_total_s": 46.13194513320923, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.13194513320923, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 96.625, "ram_util_percent": 83.60625}}
{"timers": {"training_iteration": 6.983857261896588, "restore_env_runners": 1.9460485586796216e-05, "training_step": 6.983524742717108, "env_runner_sampling_timer": 6.6938096496515955, "learner_update_timer": 0.2754109663186837, "synch_weights": 0.008178088317378028, "restore_eval_env_runners": 1.4715817381249439e-05, "evaluation_iteration": 0.39905807103460617, "synch_eval_env_connectors": 0.0005785304102951437, "synch_env_connectors": 5.897092707894068e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.0002443518014358659, "timers": {"connectors": {"batch_individual_items": 3.663051269932329e-05, "add_states_from_episodes_to_batch": 8.22941602924966e-06, "add_observations_from_episodes_to_batch": 1.4167781255542032e-05, "numpy_to_tensor": 7.087403172522947e-05, "add_time_dim_to_batch_and_zero_pad": 9.922941433868773e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.4974356412048245e-05, "get_actions": 0.00032354428699194626, "un_batch_to_individual_items": 2.0658469718225844e-05, "remove_single_ts_time_rank_from_batch": 2.7595595521725576e-06, "tensor_to_numpy": 9.09831598384264e-05, "listify_data_for_vector_env": 7.43979404730539e-05}}, "connector_pipeline_timer": 0.0006692747997768733}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 0.58}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.02900447982549668, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -153875.0, "env_step_timer": 0.00010700723749663187, "env_reset_timer": 0.0001448968223914318, "module_episode_returns_mean": {"default_policy": 0.58}, "episode_return_mean": 0.58, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00019957701656040945, "weights_seq_no": 6.0, "sample": 0.032318571775546756, "time_between_sampling": 0.010222871077437403, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled_lifetime_throughput": 1257.853815521139}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 42000, "gradients_default_optimizer_global_norm": 0.058299656957387924, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.640975832939148, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 7.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.040499333292245865, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0058320024982094765, "vf_explained_var": -0.016066908836364746, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.022446408867836, "vf_loss_unclipped": 26.70923614501953, "mean_kl_loss": 0.0009009736822918057, "num_module_steps_trained_lifetime_throughput": 229054.09925231038}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.931061317730623e-06, "numpy_to_tensor": 0.0002378660948015981, "add_observations_from_episodes_to_batch": 0.0010326260190790587, "add_time_dim_to_batch_and_zero_pad": 1.7158653761363612e-05, "add_columns_from_episodes_to_train_batch": 0.057759253606322836, "batch_individual_items": 0.11658466827316137, "add_one_ts_to_episodes_and_truncate": 0.019267164666152803, "general_advantage_estimation": 0.010189119520808226}}, "connector_pipeline_timer": 0.20543316271833675}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 42000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1186597.2874348802, "num_module_steps_trained_throughput": 228139.9354358548, "num_module_steps_trained_lifetime_throughput": 227331.32619367517}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0010720227106014617, "timers": {"connectors": {"listify_data_for_vector_env": 9.635658000115951e-05, "un_batch_to_individual_items": 3.36779819614518e-05, "normalize_and_clip_actions": 5.7157368423501405e-05, "remove_single_ts_time_rank_from_batch": 2.299159488126049e-06, "get_actions": 0.00044733918735596467, "tensor_to_numpy": 0.0003023314423711018}}}, "num_env_steps_sampled_lifetime": 35400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": -0.1}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.0482613034758654e-05, "batch_individual_items": 6.147473219030317e-05, "add_states_from_episodes_to_batch": 2.160105277036203e-05, "add_observations_from_episodes_to_batch": 1.1487118214348897e-05, "numpy_to_tensor": 9.294736186026542e-05}}, "connector_pipeline_timer": 0.00031082804686564654}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 7.0, "sample": 0.3540855306970343, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.1, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.03327409168938175, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "agent_episode_returns_mean": {"default_agent": -0.1}, "num_episodes_lifetime": 140, "env_step_timer": 0.00010985496456971878, "env_reset_timer": 0.002168722274239102, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "rlmodule_inference_timer": 0.00044692008564989474, "time_between_sampling": 6.239109318595269}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "497a3_00000", "date": "2025-08-11_19-26-14", "timestamp": 1754933174, "time_this_iter_s": 9.677364110946655, "time_total_s": 55.809309244155884, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.809309244155884, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 95.45384615384616, "ram_util_percent": 83.64615384615384}}
{"timers": {"training_iteration": 7.005095817607402, "restore_env_runners": 1.9569631588639094e-05, "training_step": 7.004760303620488, "env_runner_sampling_timer": 6.715709730235113, "learner_update_timer": 0.2748459362356269, "synch_weights": 0.008106416184052107, "restore_eval_env_runners": 1.5008249283421541e-05, "evaluation_iteration": 0.40503553407511056, "synch_eval_env_connectors": 0.0006392096961009112, "synch_env_connectors": 5.943121416183713e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00023886227569900877, "timers": {"connectors": {"batch_individual_items": 2.8981379281053774e-05, "add_states_from_episodes_to_batch": 5.923815153389278e-06, "add_observations_from_episodes_to_batch": 1.1496856176886947e-05, "numpy_to_tensor": 6.410742704777208e-05, "add_time_dim_to_batch_and_zero_pad": 2.7517146560785105e-05}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 6.153637217659986e-05, "get_actions": 0.00029923232907418183, "un_batch_to_individual_items": 2.127983737822384e-05, "remove_single_ts_time_rank_from_batch": 2.4473959090932794e-06, "tensor_to_numpy": 8.102350766079716e-05, "listify_data_for_vector_env": 5.847843550333831e-05}}, "connector_pipeline_timer": 0.0006563386347535582}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 0.26}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.031393163336440925, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -184750.0, "env_step_timer": 0.00011566164754971603, "env_reset_timer": 0.00013446521767563238, "module_episode_returns_mean": {"default_policy": 0.26}, "episode_return_mean": 0.26, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.0002902059045501012, "weights_seq_no": 7.0, "sample": 0.03207478005393196, "time_between_sampling": 0.009018279062902078, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled_lifetime_throughput": 1291.8916609954906}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 48000, "gradients_default_optimizer_global_norm": 0.0506206676363945, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6119840741157532, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 8.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.010954849421977997, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0029160012491047382, "vf_explained_var": -0.016090035438537598, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.0741666927933693, "vf_loss_unclipped": 26.320615768432617, "mean_kl_loss": 0.002404420170933008, "num_module_steps_trained_lifetime_throughput": 226479.7995820661}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.982170485016297e-06, "numpy_to_tensor": 0.00023678076384125708, "add_observations_from_episodes_to_batch": 0.0010394485087911126, "add_time_dim_to_batch_and_zero_pad": 1.774664693068705e-05, "add_columns_from_episodes_to_train_batch": 0.058290521481009515, "batch_individual_items": 0.11595526533987245, "add_one_ts_to_episodes_and_truncate": 0.01922521884937196, "general_advantage_estimation": 0.010197989995530215}}, "connector_pipeline_timer": 0.20530857609124195}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 48000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1173774.7555207172, "num_module_steps_trained_throughput": 225609.73439566273, "num_module_steps_trained_lifetime_throughput": 224832.92120644788}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00021401683145650375, "timers": {"connectors": {"listify_data_for_vector_env": 1.793888243385461e-05, "un_batch_to_individual_items": 8.291722685946745e-06, "normalize_and_clip_actions": 1.5286618371295767e-05, "remove_single_ts_time_rank_from_batch": 9.285755445262795e-07, "get_actions": 0.0001029274105013889, "tensor_to_numpy": 2.7351371559611833e-05}}}, "num_env_steps_sampled_lifetime": 40400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": 0.9}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.241106337760863e-06, "batch_individual_items": 1.0712677070051643e-05, "add_states_from_episodes_to_batch": 3.072791691201234e-06, "add_observations_from_episodes_to_batch": 4.4197451357140735e-06, "numpy_to_tensor": 1.7255105598028446e-05}}, "connector_pipeline_timer": 7.070513494934129e-05}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 8.0, "sample": 0.3533781099708892, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 0.9, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.03213175708777271, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "agent_episode_returns_mean": {"default_agent": 0.9}, "num_episodes_lifetime": 160, "env_step_timer": 2.7936857854274065e-05, "env_reset_timer": 0.002154189221221965, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "rlmodule_inference_timer": 5.5217777015993726e-05, "time_between_sampling": 6.270005949159425}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "497a3_00000", "date": "2025-08-11_19-26-23", "timestamp": 1754933183, "time_this_iter_s": 9.468106985092163, "time_total_s": 65.27741622924805, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.27741622924805, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 89.69230769230768, "ram_util_percent": 83.41538461538462}}
{"timers": {"training_iteration": 7.010746379430748, "restore_env_runners": 1.9442275723277988e-05, "training_step": 7.010404261833834, "env_runner_sampling_timer": 6.716175348342142, "learner_update_timer": 0.280114818543618, "synch_weights": 0.008038892851743435, "restore_eval_env_runners": 1.5019837404621263e-05, "evaluation_iteration": 0.404529821234706, "synch_eval_env_connectors": 0.0006345463492067338, "synch_env_connectors": 5.942020099023261e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.0002340023411047751, "timers": {"connectors": {"batch_individual_items": 2.6524750281375977e-05, "add_states_from_episodes_to_batch": 9.605752346628034e-06, "add_observations_from_episodes_to_batch": 1.0140438803094752e-05, "numpy_to_tensor": 8.549578787548776e-05, "add_time_dim_to_batch_and_zero_pad": 9.40132111237444e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 5.0856866372979396e-05, "get_actions": 0.0002710802459044018, "un_batch_to_individual_items": 1.874165552788231e-05, "remove_single_ts_time_rank_from_batch": 2.2488019894915594e-06, "tensor_to_numpy": 6.503150053107608e-05, "listify_data_for_vector_env": 3.817507467121266e-05}}, "connector_pipeline_timer": 0.0005443364697456048}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.023748123359866452, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -215625.0, "env_step_timer": 5.836096505183555e-05, "env_reset_timer": 0.0001303754094827319, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "episode_return_mean": 1.8600000000000003, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00015787307771497145, "weights_seq_no": 8.0, "sample": 0.025729008036860592, "time_between_sampling": 0.005598640256466055, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled_lifetime_throughput": 1583.8004542036226}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 54000, "gradients_default_optimizer_global_norm": 0.02396991103887558, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.5902684926986694, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 9.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.13819031417369843, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0014580006245523691, "vf_explained_var": -0.01631009578704834, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.07479322701692581, "vf_loss_unclipped": 26.345033645629883, "mean_kl_loss": 0.0008853764156810939, "num_module_steps_trained_lifetime_throughput": 225228.5561760414}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.980689002256617e-06, "numpy_to_tensor": 0.00023629503572590124, "add_observations_from_episodes_to_batch": 0.0010374236043129254, "add_time_dim_to_batch_and_zero_pad": 1.772585103734165e-05, "add_columns_from_episodes_to_train_batch": 0.0594529758564765, "batch_individual_items": 0.11576921102693699, "add_one_ts_to_episodes_and_truncate": 0.023877048740240363, "general_advantage_estimation": 0.010237610095781294}}, "connector_pipeline_timer": 0.2109723749096062}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 54000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1168033.253046583, "num_module_steps_trained_throughput": 224420.11652873893, "num_module_steps_trained_lifetime_throughput": 223675.62364170165}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00039652351219595077, "timers": {"connectors": {"listify_data_for_vector_env": 3.0989427894494696e-05, "un_batch_to_individual_items": 2.1026971795360445e-05, "normalize_and_clip_actions": 2.443764648630602e-05, "remove_single_ts_time_rank_from_batch": 1.6472311844646492e-06, "get_actions": 0.00015290382738530396, "tensor_to_numpy": 9.812881653658488e-05}}}, "num_env_steps_sampled_lifetime": 45400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": 1.1}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.986295497936868e-05, "batch_individual_items": 1.8959317410364644e-05, "add_states_from_episodes_to_batch": 4.455176663871679e-06, "add_observations_from_episodes_to_batch": 6.8300376427675675e-06, "numpy_to_tensor": 2.7880463053476995e-05}}, "connector_pipeline_timer": 0.00015081576066402883}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 9.0, "sample": 0.35433483137115557, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.1, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.032667040429078045, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "agent_episode_returns_mean": {"default_agent": 1.1}, "num_episodes_lifetime": 180, "env_step_timer": 6.281974851593352e-05, "env_reset_timer": 0.0021389331684910245, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "rlmodule_inference_timer": 0.0002202087785076083, "time_between_sampling": 6.284124452168243}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "497a3_00000", "date": "2025-08-11_19-26-31", "timestamp": 1754933191, "time_this_iter_s": 8.123931884765625, "time_total_s": 73.40134811401367, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.40134811401367, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 92.79166666666667, "ram_util_percent": 82.78333333333333}}
{"timers": {"training_iteration": 7.009163374806152, "restore_env_runners": 1.9325762756024664e-05, "training_step": 7.008822388805491, "env_runner_sampling_timer": 6.711611664018732, "learner_update_timer": 0.2831721866077547, "synch_weights": 0.007978570173807296, "restore_eval_env_runners": 1.4975058925255432e-05, "evaluation_iteration": 0.4059776588622925, "synch_eval_env_connectors": 0.000633138386640401, "synch_env_connectors": 5.973438773654586e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00019777641826950647, "timers": {"connectors": {"batch_individual_items": 3.441084440472158e-05, "add_states_from_episodes_to_batch": 6.218948090928184e-06, "add_observations_from_episodes_to_batch": 1.60740632469592e-05, "numpy_to_tensor": 4.4231511268809086e-05, "add_time_dim_to_batch_and_zero_pad": 1.8234531108121768e-05}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 5.1455265494966284e-05, "get_actions": 0.00020664874754476513, "un_batch_to_individual_items": 1.7376548290418646e-05, "remove_single_ts_time_rank_from_batch": 1.7926549121804565e-06, "tensor_to_numpy": 5.936202263994485e-05, "listify_data_for_vector_env": 4.572954686007721e-05}}, "connector_pipeline_timer": 0.00047614057808699283}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 2.1}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.02117799318954348, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -246500.0, "env_step_timer": 6.11139686477301e-05, "env_reset_timer": 0.00015240858886745673, "module_episode_returns_mean": {"default_policy": 2.1}, "episode_return_mean": 2.1, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.0001381556831081518, "weights_seq_no": 9.0, "sample": 0.024173718447212278, "time_between_sampling": 0.007747663487411639, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled_lifetime_throughput": 1730.8014768121873}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 60000, "gradients_default_optimizer_global_norm": 0.14334608614444733, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.5677953362464905, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 10.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.14046528935432434, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0007290003122761846, "vf_explained_var": -0.016974687576293945, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.07686588913202286, "vf_loss_unclipped": 26.331432342529297, "mean_kl_loss": 0.0009531740797683597, "num_module_steps_trained_lifetime_throughput": 223107.2397494912}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.974632078184898e-06, "numpy_to_tensor": 0.00023461833506436053, "add_observations_from_episodes_to_batch": 0.0010384468683265694, "add_time_dim_to_batch_and_zero_pad": 1.772234355894815e-05, "add_columns_from_episodes_to_train_batch": 0.060103011937790954, "batch_individual_items": 0.11860040141664743, "add_one_ts_to_episodes_and_truncate": 0.02373922283288256, "general_advantage_estimation": 0.010206377744924808}}, "connector_pipeline_timer": 0.21428177366038956}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 60000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1157685.0573500816, "num_module_steps_trained_throughput": 222355.47038552177, "num_module_steps_trained_lifetime_throughput": 221643.85859930108}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0003848894083925355, "timers": {"connectors": {"listify_data_for_vector_env": 4.025267754343369e-05, "un_batch_to_individual_items": 1.4823557137022923e-05, "normalize_and_clip_actions": 2.704230466376453e-05, "remove_single_ts_time_rank_from_batch": 1.381689545111091e-06, "get_actions": 0.0001679517795947857, "tensor_to_numpy": 3.4497794335072e-05}}}, "num_env_steps_sampled_lifetime": 50400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": 1.3}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.0059030358679508e-05, "batch_individual_items": 1.947532718781515e-05, "add_states_from_episodes_to_batch": 3.3565274418639637e-06, "add_observations_from_episodes_to_batch": 1.1199546849666645e-05, "numpy_to_tensor": 4.2283512723803276e-05}}, "connector_pipeline_timer": 0.00029839236449639354}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 10.0, "sample": 0.3540663784770435, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.3, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.023886097080539914, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "agent_episode_returns_mean": {"default_agent": 1.3}, "num_episodes_lifetime": 200, "env_step_timer": 5.885284852670055e-05, "env_reset_timer": 0.0021187775865962313, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "rlmodule_inference_timer": 9.019378338923408e-05, "time_between_sampling": 6.291123463065818}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "497a3_00000", "date": "2025-08-11_19-26-39", "timestamp": 1754933199, "time_this_iter_s": 7.193486213684082, "time_total_s": 80.59483432769775, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.59483432769775, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 92.24, "ram_util_percent": 82.2}}
{"timers": {"training_iteration": 6.99723434272741, "restore_env_runners": 1.925166552358003e-05, "training_step": 6.996892179497112, "env_runner_sampling_timer": 6.699133523627759, "learner_update_timer": 0.2837438414108344, "synch_weights": 0.00793080988123313, "restore_eval_env_runners": 1.4904888685850552e-05, "evaluation_iteration": 0.40529765519383104, "synch_eval_env_connectors": 0.0006296053325799523, "synch_env_connectors": 5.957454428013821e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00015996894935971912, "timers": {"connectors": {"batch_individual_items": 2.3158101649080325e-05, "add_states_from_episodes_to_batch": 8.210961178692528e-06, "add_observations_from_episodes_to_batch": 1.3023246792355498e-05, "numpy_to_tensor": 3.924417262417224e-05, "add_time_dim_to_batch_and_zero_pad": 9.387662786541757e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.5256104253966126e-05, "get_actions": 0.00023127663589809954, "un_batch_to_individual_items": 1.4796849703193823e-05, "remove_single_ts_time_rank_from_batch": 1.6109702895664074e-06, "tensor_to_numpy": 4.9596499695563665e-05, "listify_data_for_vector_env": 4.545238199348335e-05}}, "connector_pipeline_timer": 0.0004603629808435173}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.01926579178497195, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -277375.0, "env_step_timer": 5.152629815228876e-05, "env_reset_timer": 0.00017830366529463144, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "episode_return_mean": 2.899999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00013446414103955123, "weights_seq_no": 10.0, "sample": 0.020643582479447475, "time_between_sampling": 0.006317460188100926, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled_lifetime_throughput": 1728.9261377690875}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 66000, "gradients_default_optimizer_global_norm": 0.028718072921037674, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.5282582640647888, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 11.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.02838999032974243, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0003645001561380923, "vf_explained_var": -0.0189741849899292, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.03556709364056587, "vf_loss_unclipped": 24.314098358154297, "mean_kl_loss": 0.001295494264923036, "num_module_steps_trained_lifetime_throughput": 219657.16755624348}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.005725644887957e-06, "numpy_to_tensor": 0.00023337673171934777, "add_observations_from_episodes_to_batch": 0.0010365482395783233, "add_time_dim_to_batch_and_zero_pad": 1.7878040004106467e-05, "add_columns_from_episodes_to_train_batch": 0.06097027681937223, "batch_individual_items": 0.11799086949280534, "add_one_ts_to_episodes_and_truncate": 0.023599318523819135, "general_advantage_estimation": 0.010170278127496954}}, "connector_pipeline_timer": 0.2143589334237028}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1140343.9475728595, "num_module_steps_trained_throughput": 218958.7771898319, "num_module_steps_trained_lifetime_throughput": 218281.1190715306}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0003938902348820472, "timers": {"connectors": {"listify_data_for_vector_env": 3.515751009643297e-05, "un_batch_to_individual_items": 1.6578115741124654e-05, "normalize_and_clip_actions": 3.3419272240265284e-05, "remove_single_ts_time_rank_from_batch": 1.853237221716813e-06, "get_actions": 0.00015863885762526565, "tensor_to_numpy": 5.307247083279802e-05}}}, "num_env_steps_sampled_lifetime": 55400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": 1.3}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1766804330471927e-05, "batch_individual_items": 1.9002426607753316e-05, "add_states_from_episodes_to_batch": 3.559487066751598e-06, "add_observations_from_episodes_to_batch": 7.70299542040149e-06, "numpy_to_tensor": 7.047846515832107e-05}}, "connector_pipeline_timer": 0.00018148811889082708}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 11.0, "sample": 0.35427350636230304, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.3, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.021855242502642796, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "agent_episode_returns_mean": {"default_agent": 1.3}, "num_episodes_lifetime": 220, "env_step_timer": 4.7332095677850266e-05, "env_reset_timer": 0.0020994310599075014, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "rlmodule_inference_timer": 0.0001122782171586003, "time_between_sampling": 6.286903137595228}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "497a3_00000", "date": "2025-08-11_19-26-45", "timestamp": 1754933205, "time_this_iter_s": 6.207417964935303, "time_total_s": 86.80225229263306, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.80225229263306, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 90.16666666666669, "ram_util_percent": 82.46666666666667}}
{"timers": {"training_iteration": 6.979364366379487, "restore_env_runners": 1.9120398461617037e-05, "training_step": 6.979018529361923, "env_runner_sampling_timer": 6.68152633214213, "learner_update_timer": 0.2835096646572777, "synch_weights": 0.007873179691374077, "restore_eval_env_runners": 1.4902509134655365e-05, "evaluation_iteration": 0.4051048815613517, "synch_eval_env_connectors": 0.0006265042791352415, "synch_env_connectors": 5.956220258114032e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.0001443290654410508, "timers": {"connectors": {"batch_individual_items": 2.917045521791753e-05, "add_states_from_episodes_to_batch": 3.6483990364921054e-06, "add_observations_from_episodes_to_batch": 9.335183554793399e-06, "numpy_to_tensor": 4.178191154655751e-05, "add_time_dim_to_batch_and_zero_pad": 6.488261966370543e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.650192593893177e-05, "get_actions": 0.00016266868578968956, "un_batch_to_individual_items": 1.253638987713486e-05, "remove_single_ts_time_rank_from_batch": 1.5372020668494431e-06, "tensor_to_numpy": 5.354902256592528e-05, "listify_data_for_vector_env": 3.6115625199788576e-05}}, "connector_pipeline_timer": 0.00037494702626735503}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.38}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.015769438656512643, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -308250.0, "env_step_timer": 4.151898127630119e-05, "env_reset_timer": 0.0002171912742350663, "module_episode_returns_mean": {"default_policy": 3.38}, "episode_return_mean": 3.38, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010627542230025781, "weights_seq_no": 11.0, "sample": 0.018456631555093295, "time_between_sampling": 0.005710025024893707, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled_lifetime_throughput": 1910.1959742131996}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 72000, "gradients_default_optimizer_global_norm": 0.04764096066355705, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.493836909532547, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 12.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.010113202035427094, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.00018225007806904614, "vf_explained_var": -0.02031266689300537, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.0541551373898983, "vf_loss_unclipped": 23.894079208374023, "mean_kl_loss": 0.0012555166613310575, "num_module_steps_trained_lifetime_throughput": 216384.6718091043}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.23149811921801e-06, "numpy_to_tensor": 0.00023180962448896488, "add_observations_from_episodes_to_batch": 0.0011141110867769733, "add_time_dim_to_batch_and_zero_pad": 1.802467069655536e-05, "add_columns_from_episodes_to_train_batch": 0.06114817488067735, "batch_individual_items": 0.1172291953771424, "add_one_ts_to_episodes_and_truncate": 0.023585414089032745, "general_advantage_estimation": 0.010125415347128942}}, "connector_pipeline_timer": 0.21379341784018147}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1123816.0266087337, "num_module_steps_trained_throughput": 215733.13104037975, "num_module_steps_trained_lifetime_throughput": 215078.71851440458}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00023587079309052604, "timers": {"connectors": {"listify_data_for_vector_env": 2.8291284627889895e-05, "un_batch_to_individual_items": 1.4277736035892595e-05, "normalize_and_clip_actions": 1.9323205905014557e-05, "remove_single_ts_time_rank_from_batch": 1.2708858064148693e-06, "get_actions": 9.254597523293571e-05, "tensor_to_numpy": 3.298439772299164e-05}}}, "num_env_steps_sampled_lifetime": 60400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": 1.5}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.92072261818039e-06, "batch_individual_items": 1.3126866739536662e-05, "add_states_from_episodes_to_batch": 2.88280909143665e-06, "add_observations_from_episodes_to_batch": 6.191193817156146e-06, "numpy_to_tensor": 2.25840920351561e-05}}, "connector_pipeline_timer": 9.420578864513293e-05}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 12.0, "sample": 0.3531966775478064, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.5, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.015757738340180367, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "agent_episode_returns_mean": {"default_agent": 1.5}, "num_episodes_lifetime": 240, "env_step_timer": 4.073104126530206e-05, "env_reset_timer": 0.002080012579700966, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "rlmodule_inference_timer": 8.360651998392752e-05, "time_between_sampling": 6.276551632469142}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "497a3_00000", "date": "2025-08-11_19-26-50", "timestamp": 1754933210, "time_this_iter_s": 5.476259231567383, "time_total_s": 92.27851152420044, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.27851152420044, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 85.78571428571429, "ram_util_percent": 82.02857142857144}}
{"timers": {"training_iteration": 6.971854543966004, "restore_env_runners": 1.90529439641029e-05, "training_step": 6.971509996567527, "env_runner_sampling_timer": 6.674746735900209, "learner_update_timer": 0.28285961426093836, "synch_weights": 0.007811980394665898, "restore_eval_env_runners": 1.5210564357244687e-05, "evaluation_iteration": 0.4036022273261099, "synch_eval_env_connectors": 0.0006221538260097191, "synch_env_connectors": 5.940817879561503e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.0001552246473158404, "timers": {"connectors": {"batch_individual_items": 2.2205620769911473e-05, "add_states_from_episodes_to_batch": 6.186499343631961e-06, "add_observations_from_episodes_to_batch": 9.274964158799662e-06, "numpy_to_tensor": 3.745279834978275e-05, "add_time_dim_to_batch_and_zero_pad": 7.856591460935036e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 3.141226485257811e-05, "get_actions": 0.00020615005022563926, "un_batch_to_individual_items": 2.2181807143783017e-05, "remove_single_ts_time_rank_from_batch": 1.839757306132421e-06, "tensor_to_numpy": 6.440633328866314e-05, "listify_data_for_vector_env": 3.622167621791015e-05}}, "connector_pipeline_timer": 0.0004538923348097991}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.019440216659568244, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -339125.0, "env_step_timer": 6.522256080901452e-05, "env_reset_timer": 0.00013770382867746593, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "episode_return_mean": 3.7799999999999994, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00013885498256183565, "weights_seq_no": 12.0, "sample": 0.019492522832059274, "time_between_sampling": 0.0047844979659917635, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled_lifetime_throughput": 1640.5986105503873}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 78000, "gradients_default_optimizer_global_norm": 0.11829666048288345, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.47413647174835205, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 13.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.006881259847432375, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 9.112503903452307e-05, "vf_explained_var": -0.021043896675109863, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.0575651116669178, "vf_loss_unclipped": 23.493480682373047, "mean_kl_loss": 0.00026610048371367157, "num_module_steps_trained_lifetime_throughput": 212457.65715343255}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.222512844664881e-06, "numpy_to_tensor": 0.0002303744476561815, "add_observations_from_episodes_to_batch": 0.0011273374757729325, "add_time_dim_to_batch_and_zero_pad": 1.796650408097684e-05, "add_columns_from_episodes_to_train_batch": 0.06118746188221778, "batch_individual_items": 0.11656892967373336, "add_one_ts_to_episodes_and_truncate": 0.02350024202914516, "general_advantage_estimation": 0.010259189103169353}}, "connector_pipeline_timer": 0.2132339544923524}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 78000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1103824.5486024711, "num_module_steps_trained_throughput": 211848.34048115392, "num_module_steps_trained_lifetime_throughput": 211218.82450584785}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00026093027034627714, "timers": {"connectors": {"listify_data_for_vector_env": 3.055631531462873e-05, "un_batch_to_individual_items": 1.283543100424814e-05, "normalize_and_clip_actions": 2.1107824646234213e-05, "remove_single_ts_time_rank_from_batch": 1.1252313940491692e-06, "get_actions": 0.00010322864897662347, "tensor_to_numpy": 3.0449476009905845e-05}}}, "num_env_steps_sampled_lifetime": 65400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": 2.1}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.63824587369084e-06, "batch_individual_items": 1.4740997330497658e-05, "add_states_from_episodes_to_batch": 2.61390648001555e-06, "add_observations_from_episodes_to_batch": 5.697631687072584e-06, "numpy_to_tensor": 2.0573816301268853e-05}}, "connector_pipeline_timer": 8.844910986637952e-05}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 13.0, "sample": 0.35221762911240784, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 2.1, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0154487441747915, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_episodes_lifetime": 260, "env_step_timer": 3.236670746704015e-05, "env_reset_timer": 0.002060455373728974, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "rlmodule_inference_timer": 6.995951762501838e-05, "time_between_sampling": 6.276267809475371}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "497a3_00000", "date": "2025-08-11_19-26-57", "timestamp": 1754933217, "time_this_iter_s": 6.4931371212005615, "time_total_s": 98.771648645401, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.771648645401, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 91.77777777777777, "ram_util_percent": 82.38888888888889}}
{"timers": {"training_iteration": 6.95501922352704, "restore_env_runners": 1.8934084453191404e-05, "training_step": 6.954673695772573, "env_runner_sampling_timer": 6.654130227710447, "learner_update_timer": 0.286665420618096, "synch_weights": 0.007756042250888974, "restore_eval_env_runners": 1.514928827606805e-05, "evaluation_iteration": 0.40218611755264355, "synch_eval_env_connectors": 0.0006173164472996926, "synch_env_connectors": 5.925989784106295e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00013039258124828044, "timers": {"connectors": {"batch_individual_items": 1.905743286472395e-05, "add_states_from_episodes_to_batch": 3.4932706704752234e-06, "add_observations_from_episodes_to_batch": 8.329598941300315e-06, "numpy_to_tensor": 3.4919122338129145e-05, "add_time_dim_to_batch_and_zero_pad": 9.301429926939869e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.743073203168661e-05, "get_actions": 0.0001659429513707602, "un_batch_to_individual_items": 1.247462951552835e-05, "remove_single_ts_time_rank_from_batch": 1.3837364873436318e-06, "tensor_to_numpy": 4.0453299599996254e-05, "listify_data_for_vector_env": 3.2198015872958796e-05}}, "connector_pipeline_timer": 0.00035581399293438545}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 4.18}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.015509566455148161, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -370000.0, "env_step_timer": 4.5637719055618105e-05, "env_reset_timer": 0.0001636973631746648, "module_episode_returns_mean": {"default_policy": 4.18}, "episode_return_mean": 4.18, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010137951532503215, "weights_seq_no": 13.0, "sample": 0.018564061962419318, "time_between_sampling": 0.004654545476572881, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled_lifetime_throughput": 1795.5397084839258}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 84000, "gradients_default_optimizer_global_norm": 0.035817701369524, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.47302621603012085, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 14.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.11405530571937561, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 4.5562519517261535e-05, "vf_explained_var": -0.019382357597351074, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.04959893226623535, "vf_loss_unclipped": 23.913816452026367, "mean_kl_loss": 4.542641545413062e-05, "num_module_steps_trained_lifetime_throughput": 207720.4613345807}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.223617499002217e-06, "numpy_to_tensor": 0.0002288423737818817, "add_observations_from_episodes_to_batch": 0.0011429966006195028, "add_time_dim_to_batch_and_zero_pad": 1.794349913874958e-05, "add_columns_from_episodes_to_train_batch": 0.0613593501835778, "batch_individual_items": 0.11973585912762783, "add_one_ts_to_episodes_and_truncate": 0.02364369418905827, "general_advantage_estimation": 0.010237699291849514}}, "connector_pipeline_timer": 0.21670773035660196}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 84000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1079602.2114624293, "num_module_steps_trained_throughput": 207150.54344924682, "num_module_steps_trained_lifetime_throughput": 206546.15051932083}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00027845434088850685, "timers": {"connectors": {"listify_data_for_vector_env": 2.6169882213987308e-05, "un_batch_to_individual_items": 1.281365328756736e-05, "normalize_and_clip_actions": 2.1602082985344983e-05, "remove_single_ts_time_rank_from_batch": 1.2500753695106046e-06, "get_actions": 0.00013078697454019337, "tensor_to_numpy": 3.160481175559678e-05}}}, "num_env_steps_sampled_lifetime": 70400, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": 2.1}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.25006420854474e-06, "batch_individual_items": 1.3956656792231887e-05, "add_states_from_episodes_to_batch": 2.8042288864503667e-06, "add_observations_from_episodes_to_batch": 5.574895830696969e-06, "numpy_to_tensor": 2.200810852112715e-05}}, "connector_pipeline_timer": 9.255801472507719e-05}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 14.0, "sample": 0.3513520274011709, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 2.1, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.013677885393844917, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_episodes_lifetime": 280, "env_step_timer": 3.6916528566949124e-05, "env_reset_timer": 0.0020407603996766424, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "rlmodule_inference_timer": 7.742030512785095e-05, "time_between_sampling": 6.2667504784611365}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "497a3_00000", "date": "2025-08-11_19-27-02", "timestamp": 1754933222, "time_this_iter_s": 5.565440893173218, "time_total_s": 104.33708953857422, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 104.33708953857422, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 78.0625, "ram_util_percent": 82.26249999999999}}
{"timers": {"training_iteration": 6.94746725254202, "restore_env_runners": 1.8870573437562568e-05, "training_step": 6.947119626724792, "env_runner_sampling_timer": 6.64189548918232, "learner_update_timer": 0.29135055349192546, "synch_weights": 0.007725815997883386, "restore_eval_env_runners": 1.5470705862705274e-05, "evaluation_iteration": 0.40089106303776556, "synch_eval_env_connectors": 0.0006152903621342817, "synch_env_connectors": 5.909649887116386e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.0001497762938335859, "timers": {"connectors": {"batch_individual_items": 2.3415972285855392e-05, "add_states_from_episodes_to_batch": 3.949104570894631e-06, "add_observations_from_episodes_to_batch": 9.272857712656174e-06, "numpy_to_tensor": 3.556804240151886e-05, "add_time_dim_to_batch_and_zero_pad": 1.5210759011418097e-05}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.619664508955157e-05, "get_actions": 0.0002010061552189873, "un_batch_to_individual_items": 1.6972604579600744e-05, "remove_single_ts_time_rank_from_batch": 1.8425187473368179e-06, "tensor_to_numpy": 4.9235768813043866e-05, "listify_data_for_vector_env": 3.805894541002866e-05}}, "connector_pipeline_timer": 0.00040406354121411126}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.017704704504460097, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -400875.0, "env_step_timer": 5.605612419647037e-05, "env_reset_timer": 0.00015153196441654342, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "episode_return_mean": 4.019999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00012598989375074614, "weights_seq_no": 14.0, "sample": 0.018306645651650702, "time_between_sampling": 0.006569722095097928, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled_lifetime_throughput": 1711.6219366279367}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 90000, "gradients_default_optimizer_global_norm": 0.042700961232185364, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.452986478805542, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 15.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.004048810340464115, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 2.2781259758630767e-05, "vf_explained_var": -0.02093040943145752, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.06058907508850098, "vf_loss_unclipped": 23.113862991333008, "mean_kl_loss": 0.00023884468828327954, "num_module_steps_trained_lifetime_throughput": 203018.76354002825}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.255131594542776e-06, "numpy_to_tensor": 0.0002274943599987002, "add_observations_from_episodes_to_batch": 0.0011409778843887472, "add_time_dim_to_batch_and_zero_pad": 1.8468643435502023e-05, "add_columns_from_episodes_to_train_batch": 0.062185586681323, "batch_individual_items": 0.12373780220642415, "add_one_ts_to_episodes_and_truncate": 0.023486190997214103, "general_advantage_estimation": 0.010220346459729659}}, "connector_pipeline_timer": 0.2213564255531579}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 90000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1055511.8537916942, "num_module_steps_trained_throughput": 202487.10068562703, "num_module_steps_trained_lifetime_throughput": 201905.8346854327}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00024093607262912935, "timers": {"connectors": {"listify_data_for_vector_env": 2.3040053314423222e-05, "un_batch_to_individual_items": 1.0218080998142824e-05, "normalize_and_clip_actions": 1.7120859641269625e-05, "remove_single_ts_time_rank_from_batch": 1.0358905883335053e-06, "get_actions": 9.188334769669098e-05, "tensor_to_numpy": 3.234037681715478e-05}}}, "num_env_steps_sampled_lifetime": 75400, "episode_return_max": 12.5, "module_episode_returns_mean": {"default_policy": 1.5}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.758113195562053e-06, "batch_individual_items": 1.132091219093299e-05, "add_states_from_episodes_to_batch": 2.5924157862893996e-06, "add_observations_from_episodes_to_batch": 4.8869962323645e-06, "numpy_to_tensor": 1.78789291042137e-05}}, "connector_pipeline_timer": 7.72814264702051e-05}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 15.0, "sample": 0.350915128376943, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.5, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.013436955382348969, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "agent_episode_returns_mean": {"default_agent": 1.5}, "num_episodes_lifetime": 300, "env_step_timer": 3.218179807707277e-05, "env_reset_timer": 0.002024748625426376, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "rlmodule_inference_timer": 5.868479984543986e-05, "time_between_sampling": 6.266551663256507}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "497a3_00000", "date": "2025-08-11_19-27-09", "timestamp": 1754933229, "time_this_iter_s": 6.549680233001709, "time_total_s": 110.88676977157593, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 110.88676977157593, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 91.48888888888888, "ram_util_percent": 82.55555555555554}}
{"timers": {"training_iteration": 6.927404189596874, "restore_env_runners": 1.875519771440573e-05, "training_step": 6.9270560262866505, "env_runner_sampling_timer": 6.621745233040561, "learner_update_timer": 0.29153729337736156, "synch_weights": 0.007659354508007997, "restore_eval_env_runners": 1.545099866788161e-05, "evaluation_iteration": 0.4002670115769884, "synch_eval_env_connectors": 0.0006184045383896747, "synch_env_connectors": 5.89930346841347e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00012999658575632044, "timers": {"connectors": {"batch_individual_items": 2.023488920951707e-05, "add_states_from_episodes_to_batch": 4.3418346811692656e-06, "add_observations_from_episodes_to_batch": 8.787737861812691e-06, "numpy_to_tensor": 3.585519809875368e-05, "add_time_dim_to_batch_and_zero_pad": 6.736063211190213e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.795457986779734e-05, "get_actions": 0.00015681307783315895, "un_batch_to_individual_items": 1.4813941327044753e-05, "remove_single_ts_time_rank_from_batch": 2.765655506804868e-06, "tensor_to_numpy": 4.7146236654471755e-05, "listify_data_for_vector_env": 3.4487541583135947e-05}}, "connector_pipeline_timer": 0.00035557430142735703}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 4.66}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.015642907029949128, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -431750.0, "env_step_timer": 4.859911895057434e-05, "env_reset_timer": 0.00010716836209501493, "module_episode_returns_mean": {"default_policy": 4.66}, "episode_return_mean": 4.66, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010942539815484429, "weights_seq_no": 15.0, "sample": 0.016355398840089123, "time_between_sampling": 0.00656787161538189, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled_lifetime_throughput": 1865.284678134649}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 96000, "gradients_default_optimizer_global_norm": 0.11287917196750641, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.4430331587791443, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 16.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.21866542100906372, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 1.1390629879315384e-05, "vf_explained_var": -0.018616795539855957, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.1539374142885208, "vf_loss_unclipped": 24.324419021606445, "mean_kl_loss": 0.0002914517535828054, "num_module_steps_trained_lifetime_throughput": 199612.51292261737}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.272579571313733e-06, "numpy_to_tensor": 0.0002263735870031359, "add_observations_from_episodes_to_batch": 0.0011383918560854737, "add_time_dim_to_batch_and_zero_pad": 1.8990627108466954e-05, "add_columns_from_episodes_to_train_batch": 0.06204968289543569, "batch_individual_items": 0.12419552543502145, "add_one_ts_to_episodes_and_truncate": 0.023362642837045193, "general_advantage_estimation": 0.010578469244145086}}, "connector_pipeline_timer": 0.22191421754778579}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 96000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1038211.5367460634, "num_module_steps_trained_throughput": 199119.0173147038, "num_module_steps_trained_lifetime_throughput": 198561.93553052432}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0003627192492753495, "timers": {"connectors": {"listify_data_for_vector_env": 3.326922479334566e-05, "un_batch_to_individual_items": 2.1884255911429505e-05, "normalize_and_clip_actions": 2.7784034685371512e-05, "remove_single_ts_time_rank_from_batch": 2.317082205022243e-06, "get_actions": 0.00016799553348920536, "tensor_to_numpy": 4.2274787187128465e-05}}}, "num_env_steps_sampled_lifetime": 80400, "episode_return_max": 12.5, "module_episode_returns_mean": {"default_policy": 0.9}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.531709581301618e-06, "batch_individual_items": 2.079544022518662e-05, "add_states_from_episodes_to_batch": 3.920044545115187e-06, "add_observations_from_episodes_to_batch": 8.574187134319589e-06, "numpy_to_tensor": 3.594277738131972e-05}}, "connector_pipeline_timer": 0.00012928549913861277}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 16.0, "sample": 0.35121918126244694, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 0.9, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.01342003662022762, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "agent_episode_returns_mean": {"default_agent": 0.9}, "num_episodes_lifetime": 320, "env_step_timer": 6.686313455514162e-05, "env_reset_timer": 0.0020062848896577412, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "rlmodule_inference_timer": 9.526094079637953e-05, "time_between_sampling": 6.254224515794146}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "497a3_00000", "date": "2025-08-11_19-27-14", "timestamp": 1754933234, "time_this_iter_s": 5.337696075439453, "time_total_s": 116.22446584701538, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.22446584701538, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 87.53750000000001, "ram_util_percent": 82.2}}
{"timers": {"training_iteration": 6.909443173120273, "restore_env_runners": 1.8626395893574854e-05, "training_step": 6.909096360194094, "env_runner_sampling_timer": 6.604813770709926, "learner_update_timer": 0.29060134752395655, "synch_weights": 0.0075957588837856594, "restore_eval_env_runners": 1.5389829322090413e-05, "evaluation_iteration": 0.40020267313157915, "synch_eval_env_connectors": 0.0006162600720768824, "synch_env_connectors": 5.918640483020588e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00013862136856719788, "timers": {"connectors": {"batch_individual_items": 2.8508687544991906e-05, "add_states_from_episodes_to_batch": 4.143000641587299e-06, "add_observations_from_episodes_to_batch": 9.441489937648135e-06, "numpy_to_tensor": 3.5384913991942256e-05, "add_time_dim_to_batch_and_zero_pad": 7.51108548711823e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.656241070156901e-05, "get_actions": 0.00017246171960294535, "un_batch_to_individual_items": 1.5850593636858148e-05, "remove_single_ts_time_rank_from_batch": 1.572827605286734e-06, "tensor_to_numpy": 5.252482850249811e-05, "listify_data_for_vector_env": 3.9106774814692076e-05}}, "connector_pipeline_timer": 0.00037986357697681374}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 4.18}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.01705208751605824, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -462625.0, "env_step_timer": 6.245945251283805e-05, "env_reset_timer": 0.00012725996967564486, "module_episode_returns_mean": {"default_policy": 4.18}, "episode_return_mean": 4.18, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00014441471563263298, "weights_seq_no": 16.0, "sample": 0.018288425958143107, "time_between_sampling": 0.004999012202822925, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled_lifetime_throughput": 1779.081002113753}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 102000, "gradients_default_optimizer_global_norm": 0.03710363060235977, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.4135804772377014, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 17.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.11662331223487854, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 5.695314939657692e-06, "vf_explained_var": -0.019191503524780273, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.05162852257490158, "vf_loss_unclipped": 23.931560516357422, "mean_kl_loss": 0.0007178370142355561, "num_module_steps_trained_lifetime_throughput": 196531.4532865264}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.2694338208685345e-06, "numpy_to_tensor": 0.00023581527204441665, "add_observations_from_episodes_to_batch": 0.0011502725174652062, "add_time_dim_to_batch_and_zero_pad": 1.8919061668632237e-05, "add_columns_from_episodes_to_train_batch": 0.06185247939672233, "batch_individual_items": 0.1237851851811688, "add_one_ts_to_episodes_and_truncate": 0.023266298077978517, "general_advantage_estimation": 0.01059946330168553}}, "connector_pipeline_timer": 0.22125949078270177}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 102000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1023384.0352094559, "num_module_steps_trained_throughput": 196228.78246673118, "num_module_steps_trained_lifetime_throughput": 195696.60748318816}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00024515117601901396, "timers": {"connectors": {"listify_data_for_vector_env": 2.5578894785803473e-05, "un_batch_to_individual_items": 1.1143021224449315e-05, "normalize_and_clip_actions": 1.9177276843740135e-05, "remove_single_ts_time_rank_from_batch": 1.3694507055530733e-06, "get_actions": 0.00010604539488940746, "tensor_to_numpy": 3.147449898757076e-05}}}, "num_env_steps_sampled_lifetime": 85400, "episode_return_max": 12.5, "module_episode_returns_mean": {"default_policy": 1.1}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.805017642510578e-06, "batch_individual_items": 1.4411614026516972e-05, "add_states_from_episodes_to_batch": 3.028785570648144e-06, "add_observations_from_episodes_to_batch": 5.389278545134024e-06, "numpy_to_tensor": 2.0299294030555125e-05}}, "connector_pipeline_timer": 8.614420528519692e-05}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 17.0, "sample": 0.35013279112000123, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.1, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.013350751179968938, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "agent_episode_returns_mean": {"default_agent": 1.1}, "num_episodes_lifetime": 340, "env_step_timer": 3.056259844823154e-05, "env_reset_timer": 0.0019921253814044354, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "rlmodule_inference_timer": 6.32451972828636e-05, "time_between_sampling": 6.243343446885822}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "497a3_00000", "date": "2025-08-11_19-27-20", "timestamp": 1754933240, "time_this_iter_s": 5.387743949890137, "time_total_s": 121.61220979690552, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.61220979690552, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 89.75714285714285, "ram_util_percent": 82.55714285714285}}
{"timers": {"training_iteration": 6.886183208049233, "restore_env_runners": 1.8503880964871537e-05, "training_step": 6.885837754512162, "env_runner_sampling_timer": 6.578493505083229, "learner_update_timer": 0.2937070640493265, "synch_weights": 0.007529492544526994, "restore_eval_env_runners": 1.530968129940009e-05, "evaluation_iteration": 0.3987371755596696, "synch_eval_env_connectors": 0.0006114708007887948, "synch_env_connectors": 5.9015335604179455e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00011552467752495629, "timers": {"connectors": {"batch_individual_items": 1.8717734308918325e-05, "add_states_from_episodes_to_batch": 3.864579588597823e-06, "add_observations_from_episodes_to_batch": 7.810631059573127e-06, "numpy_to_tensor": 2.902641101370911e-05, "add_time_dim_to_batch_and_zero_pad": 5.540168394898914e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.397860185774595e-05, "get_actions": 0.00013230988941948074, "un_batch_to_individual_items": 1.2734326635004855e-05, "remove_single_ts_time_rank_from_batch": 1.2861889973252849e-06, "tensor_to_numpy": 4.022204166999411e-05, "listify_data_for_vector_env": 3.1239561143240906e-05}}, "connector_pipeline_timer": 0.0003060552106082305}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.013216992854606362, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -493500.0, "env_step_timer": 4.337087116393505e-05, "env_reset_timer": 0.00013908388848617943, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "episode_return_mean": 3.5400000000000005, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 8.674499905507057e-05, "weights_seq_no": 17.0, "sample": 0.015436490923650428, "time_between_sampling": 0.0036945670983884555, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled_lifetime_throughput": 1912.9461737554875}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 108000, "gradients_default_optimizer_global_norm": 0.08192838728427887, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.41199925541877747, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 18.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.271775484085083, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 2.847657469828846e-06, "vf_explained_var": -0.01664602756500244, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.20676639676094055, "vf_loss_unclipped": 25.955707550048828, "mean_kl_loss": 0.000187661949894391, "num_module_steps_trained_lifetime_throughput": 194041.29607322378}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.297159110832962e-06, "numpy_to_tensor": 0.00023509586870549979, "add_observations_from_episodes_to_batch": 0.001180048541994915, "add_time_dim_to_batch_and_zero_pad": 1.8968621414714684e-05, "add_columns_from_episodes_to_train_batch": 0.062352547102743267, "batch_individual_items": 0.1260362324983812, "add_one_ts_to_episodes_and_truncate": 0.02364509384740757, "general_advantage_estimation": 0.010883793668712633}}, "connector_pipeline_timer": 0.22470340462585547}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1011380.6317801854, "num_module_steps_trained_throughput": 193879.2874833877, "num_module_steps_trained_lifetime_throughput": 193371.58306105077}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00029082760377167096, "timers": {"connectors": {"listify_data_for_vector_env": 3.294392380375206e-05, "un_batch_to_individual_items": 1.2509585782761458e-05, "normalize_and_clip_actions": 2.4801414814642967e-05, "remove_single_ts_time_rank_from_batch": 1.8287476930531895e-06, "get_actions": 0.00011837103250526437, "tensor_to_numpy": 3.843421412907006e-05}}}, "num_env_steps_sampled_lifetime": 90400, "episode_return_max": 12.5, "module_episode_returns_mean": {"default_policy": 1.3}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.2276154042372956e-06, "batch_individual_items": 2.3135885371001748e-05, "add_states_from_episodes_to_batch": 4.249542588445675e-06, "add_observations_from_episodes_to_batch": 6.976961666448852e-06, "numpy_to_tensor": 2.4412829859843345e-05}}, "connector_pipeline_timer": 0.00011509437369468463}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 18.0, "sample": 0.3493240615391239, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.3, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.013529097875580192, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "agent_episode_returns_mean": {"default_agent": 1.3}, "num_episodes_lifetime": 360, "env_step_timer": 4.5479656812586906e-05, "env_reset_timer": 0.00197361079720709, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "rlmodule_inference_timer": 8.60705138702941e-05, "time_between_sampling": 6.226991778666808}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "497a3_00000", "date": "2025-08-11_19-27-25", "timestamp": 1754933245, "time_this_iter_s": 4.863539934158325, "time_total_s": 126.47574973106384, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.47574973106384, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 85.92857142857143, "ram_util_percent": 81.64285714285714}}
{"timers": {"training_iteration": 6.860411063468191, "restore_env_runners": 1.8395921903957653e-05, "training_step": 6.8600656419666235, "env_runner_sampling_timer": 6.551286858372174, "learner_update_timer": 0.2951713596584914, "synch_weights": 0.007475872619980265, "restore_eval_env_runners": 1.524200539294982e-05, "evaluation_iteration": 0.3975169221337208, "synch_eval_env_connectors": 0.0006078769233842232, "synch_env_connectors": 5.8866780488423775e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00011690237286277631, "timers": {"connectors": {"batch_individual_items": 1.8695164844248887e-05, "add_states_from_episodes_to_batch": 3.975789375357919e-06, "add_observations_from_episodes_to_batch": 7.513010029721576e-06, "numpy_to_tensor": 2.9149294118618822e-05, "add_time_dim_to_batch_and_zero_pad": 5.847481089340717e-06}}}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.371526991386863e-05, "get_actions": 0.00012774895341288001, "un_batch_to_individual_items": 1.3283258766967208e-05, "remove_single_ts_time_rank_from_batch": 1.2449385447879524e-06, "tensor_to_numpy": 3.574983938071666e-05, "listify_data_for_vector_env": 3.395764269094348e-05}}, "connector_pipeline_timer": 0.0002993099989588621}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 4.259999999999998}, "episode_len_min": 20, "num_episodes": 250.0, "episode_duration_sec_mean": 0.012855688989162449, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -524375.0, "env_step_timer": 3.915433522631056e-05, "env_reset_timer": 0.00010763804517550669, "module_episode_returns_mean": {"default_policy": 4.259999999999998}, "episode_return_mean": 4.259999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 8.963173102805517e-05, "weights_seq_no": 18.0, "sample": 0.013781326717659439, "time_between_sampling": 0.005350343073868354, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled_lifetime_throughput": 1907.256596297103}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 114000, "gradients_default_optimizer_global_norm": 0.08828224986791611, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.37992289662361145, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 19.0, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.12606894969940186, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 1.423828734914423e-06, "vf_explained_var": -0.019092679023742676, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.06076934561133385, "vf_loss_unclipped": 23.938852310180664, "mean_kl_loss": 0.00026499663363210857, "num_module_steps_trained_lifetime_throughput": 192293.3265522524}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.289187786231901e-06, "numpy_to_tensor": 0.0002350565795413412, "add_observations_from_episodes_to_batch": 0.001183739726339708, "add_time_dim_to_batch_and_zero_pad": 1.8908936190451675e-05, "add_columns_from_episodes_to_train_batch": 0.06231905496150629, "batch_individual_items": 0.1275501218332638, "add_one_ts_to_episodes_and_truncate": 0.023606012488624935, "general_advantage_estimation": 0.010919119481671903}}, "connector_pipeline_timer": 0.2261825934986643}, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 114000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1002950.9250226493, "num_module_steps_trained_throughput": 192214.67873593085, "num_module_steps_trained_lifetime_throughput": 191729.06703443927}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0004443075502800447, "timers": {"connectors": {"listify_data_for_vector_env": 4.218931759347455e-05, "un_batch_to_individual_items": 1.600978902335343e-05, "normalize_and_clip_actions": 2.2212010642918936e-05, "remove_single_ts_time_rank_from_batch": 1.3207426326771003e-06, "get_actions": 0.0002036018185043241, "tensor_to_numpy": 5.099719249315036e-05}}}, "num_env_steps_sampled_lifetime": 95400, "episode_return_max": 12.5, "module_episode_returns_mean": {"default_policy": 1.5}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.718458149712766e-06, "batch_individual_items": 1.7181450711803258e-05, "add_states_from_episodes_to_batch": 4.397582787887079e-06, "add_observations_from_episodes_to_batch": 6.183875513621633e-06, "numpy_to_tensor": 3.630439444349502e-05}}, "connector_pipeline_timer": 0.00012041433405915264}, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 19.0, "sample": 0.3502512788333148, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.5, "episode_return_min": -15.5, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.015212423737393692, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "agent_episode_returns_mean": {"default_agent": 1.5}, "num_episodes_lifetime": 380, "env_step_timer": 7.395446245905215e-05, "env_reset_timer": 0.0019567851083694423, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "rlmodule_inference_timer": 0.0001234576928177225, "time_between_sampling": 6.208107018380301}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "497a3_00000", "date": "2025-08-11_19-27-29", "timestamp": 1754933249, "time_this_iter_s": 4.773774862289429, "time_total_s": 131.24952459335327, "pid": 14988, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385fe9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 131.24952459335327, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 85.07142857142857, "ram_util_percent": 81.57142857142857}}
